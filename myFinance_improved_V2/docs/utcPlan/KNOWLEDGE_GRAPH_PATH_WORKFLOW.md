# Knowledge Graph Path Traversal Workflow

## Overview

AIê°€ ì‚¬ìš©ì ì§ˆë¬¸ì„ ë°›ìœ¼ë©´ Knowledge Graphë¥¼ íƒìƒ‰í•´ì„œ ê´€ë ¨ í…Œì´ë¸”ê³¼ SQLì„ ì°¾ìŠµë‹ˆë‹¤.

---

## Palantir Style Path (í•µì‹¬!)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Palantir Foundry Ontology Style                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  ì‚¬ìš©ì ì§ˆë¬¸: "ì˜¤ëŠ˜ ì²´í¬ì¸í•œ ì‚¬ëŒ"                                         â”‚
â”‚       â”‚                                                                  â”‚
â”‚       â–¼                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                       â”‚
â”‚  â”‚ Action Types â”‚  "ì²´í¬ì¸" â†’ check_in                                  â”‚
â”‚  â”‚ (í–‰ë™)       â”‚  ontology_action_types.action_name                    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                                                       â”‚
â”‚         â”‚ target_entity                                                  â”‚
â”‚         â–¼                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                       â”‚
â”‚  â”‚   Entities   â”‚  check_in.target_entity = "Shift"                     â”‚
â”‚  â”‚ (Object Type)â”‚  ontology_entities.entity_name                        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                                                       â”‚
â”‚         â”‚ table_name                                                     â”‚
â”‚         â–¼                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                       â”‚
â”‚  â”‚    Tables    â”‚  Shift.table_name = "shift_requests"                  â”‚
â”‚  â”‚ (ì‹¤ì œ ë°ì´í„°) â”‚  â†’ v_shift_request_ai (View ê¶Œì¥)                      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                       â”‚
â”‚                                                                          â”‚
â”‚  âœ… Path: Action â†’ Entity â†’ Table                                        â”‚
â”‚  âŒ Legacy: Action â†’ Table (ì§ì ‘)                                        â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## í•µì‹¬ í…Œì´ë¸” (14ê°œ + 1ê°œ ì‹ ê·œ)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Ontology Tables Overview                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ì–¸ì–´/ê°œë… ë ˆì´ì–´                                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ontology_synonyms        â”‚ "ë§¤ì¶œ" â†’ revenue (ë‹¤êµ­ì–´ ë™ì˜ì–´)              â”‚
â”‚  ontology_concepts        â”‚ revenue â†’ ì •ì˜, ê³„ì‚°ì‹, ë§¤í•‘ í…Œì´ë¸”           â”‚
â”‚  ontology_concept_relationsâ”‚ revenue â†” expense (ê°œë… ê°„ ê´€ê³„)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  í…Œì´ë¸”/ì»¬ëŸ¼ ë ˆì´ì–´                                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ontology_columns         â”‚ í…Œì´ë¸”ë³„ ì»¬ëŸ¼ ì •ì˜, deprecated í‘œì‹œ          â”‚
â”‚  ontology_relationships   â”‚ í…Œì´ë¸” ê°„ JOIN ê´€ê³„ (FK)                    â”‚
â”‚  ontology_constraints     â”‚ í…Œì´ë¸” ì‚¬ìš© ê·œì¹™, SQL íŒ¨í„´                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ê³„ì‚°/ê·œì¹™ ë ˆì´ì–´                                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ontology_calculation_rulesâ”‚ ë§¤ì¶œ = SUM(credit) WHERE account_type=incomeâ”‚
â”‚  ontology_kpi_rules       â”‚ KPI ê³„ì‚°ì‹ (ì´ìµë¥  = ì´ìµ/ë§¤ì¶œ)               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ê¶Œí•œ/í–‰ë™ ë ˆì´ì–´                                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  features (ê¸°ì¡´)          â”‚ UI í˜ì´ì§€/ê¶Œí•œ (Attendance, Debt Control)    â”‚
â”‚  role_permissions (ê¸°ì¡´)  â”‚ ì—­í• ë³„ ê¸°ëŠ¥ ì ‘ê·¼ ê¶Œí•œ                         â”‚
â”‚  ontology_action_types ğŸ†• â”‚ ì„¸ë¶€ í–‰ë™ (check_in, approve_shift)          â”‚
â”‚  ontology_event_types     â”‚ í–‰ë™ ê²°ê³¼ ì´ë²¤íŠ¸ (ShiftEvent)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Graph/Embedding ë ˆì´ì–´                                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ontology_embeddings      â”‚ ë²¡í„° ê²€ìƒ‰ìš© ì„ë² ë”©                            â”‚
â”‚  v_ontology_graph_nodes   â”‚ ëª¨ë“  ë…¸ë“œ í†µí•© ë·°                             â”‚
â”‚  v_ontology_graph_edges   â”‚ ëª¨ë“  ì—£ì§€ í†µí•© ë·°                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Path íƒìƒ‰ ì›Œí¬í”Œë¡œìš°

### Step 1: ì‚¬ìš©ì ì§ˆë¬¸ â†’ í‚¤ì›Œë“œ ì¶”ì¶œ

```
"ì´ë²ˆ ë‹¬ ì§€ê°í•œ ì§ì› ë³´ì—¬ì¤˜"
     â”‚
     â–¼
í‚¤ì›Œë“œ: ["ì§€ê°", "ì§ì›", "ì´ë²ˆ ë‹¬"]
```

### Step 2: ë™ì˜ì–´ â†’ ê°œë… ë§¤í•‘ (ontology_synonyms)

```sql
SELECT concept_name
FROM ontology_synonyms
WHERE synonym IN ('ì§€ê°', 'ì§ì›', 'late', 'employee');

ê²°ê³¼:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ synonym     â”‚ concept_name â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ì§€ê°        â”‚ late         â”‚
â”‚ ì§ì›        â”‚ employee     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Step 3: RPC í˜¸ì¶œ - get_ontology_paths_v2

```sql
SELECT get_ontology_paths_v2(ARRAY['late', 'employee'], 3);
```

ì´ RPCê°€ ë°˜í™˜í•˜ëŠ” ê²ƒ:
- `main_tables`: ê´€ë ¨ í…Œì´ë¸” ëª©ë¡
- `main_columns`: ì‚¬ìš©í•  ì»¬ëŸ¼ë“¤
- `deprecated_columns`: ì‚¬ìš©í•˜ë©´ ì•ˆ ë˜ëŠ” ì»¬ëŸ¼ë“¤
- `constraints`: SQL ì‘ì„± ê·œì¹™
- `join_paths`: í…Œì´ë¸” ì¡°ì¸ ë°©ë²•
- `calculation_rules`: ê³„ì‚° ê³µì‹

### Step 4: Graph Traversal (v_ontology_graph_edges)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Edge Types and Their Roles                                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  [synonym_to_concept] 732ê°œ                                              â”‚
â”‚  "ì§€ê°" â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ late (concept)                        â”‚
â”‚                                                                          â”‚
â”‚  [concept_maps_to_table] 127ê°œ                                           â”‚
â”‚  late â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ v_shift_request_ai (table)            â”‚
â”‚                                                                          â”‚
â”‚  [table_has_column] 292ê°œ                                                â”‚
â”‚  v_shift_request_ai â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ problem_details_v2 (column)           â”‚
â”‚                                                                          â”‚
â”‚  [table_joins_1:n] 36ê°œ                                                  â”‚
â”‚  v_shift_request_ai â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ users (via user_id)                   â”‚
â”‚                                                                          â”‚
â”‚  [broader] 25ê°œ                                                          â”‚
â”‚  late â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ domain_hr (ìƒìœ„ ê°œë…)                  â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Step 5: Path ê²°ê³¼ ì¡°í•©

```
ì§ˆë¬¸: "ì´ë²ˆ ë‹¬ ì§€ê°í•œ ì§ì›"
     â”‚
     â”œâ”€â–¶ ê°œë…: late, employee
     â”‚
     â”œâ”€â–¶ í…Œì´ë¸”: v_shift_request_ai
     â”‚
     â”œâ”€â–¶ ì»¬ëŸ¼: problem_details_v2 (ì§€ê° ì •ë³´)
     â”‚         full_name (ì§ì› ì´ë¦„)
     â”‚         start_time_utc (ë‚ ì§œ í•„í„°)
     â”‚
     â”œâ”€â–¶ ê³„ì‚° ê·œì¹™: problem_details_v2 LIKE '%LATE%'
     â”‚
     â””â”€â–¶ SQL ìƒì„±:
         SELECT full_name, start_time_utc, problem_details_v2
         FROM v_shift_request_ai
         WHERE company_id = $cid
           AND start_time_utc >= DATE_TRUNC('month', NOW())
           AND problem_details_v2 LIKE '%LATE%'
```

---

## ìƒˆë¡œìš´ Path: Action ê²½ë¡œ (ontology_action_types)

### ì§ˆë¬¸ ìœ í˜•: "ëˆ„ê°€ ë¬´ì—‡ì„ í–ˆì–´?"

```
"ì˜¤ëŠ˜ ì²´í¬ì¸í•œ ì§ì›"
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 1: Action ì°¾ê¸°                                                     â”‚
â”‚  SELECT * FROM ontology_action_types WHERE action_name = 'check_in'      â”‚
â”‚                                                                          â”‚
â”‚  ê²°ê³¼:                                                                    â”‚
â”‚  - target_table: shift_requests                                          â”‚
â”‚  - target_column: check_in_time                                          â”‚
â”‚  - creates_event: ShiftEvent                                             â”‚
â”‚  - affects_tables: [shift_requests, v_shift_request_ai]                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 2: Event â†’ Source Table                                            â”‚
â”‚  SELECT source_table FROM ontology_event_types                           â”‚
â”‚  WHERE event_name = 'ShiftEvent'                                         â”‚
â”‚                                                                          â”‚
â”‚  ê²°ê³¼: v_shift_request_ai                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 3: SQL ìƒì„±                                                        â”‚
â”‚  SELECT full_name, check_in_time                                         â”‚
â”‚  FROM v_shift_request_ai                                                 â”‚
â”‚  WHERE company_id = $cid                                                 â”‚
â”‚    AND DATE(check_in_time_utc) = CURRENT_DATE                            â”‚
â”‚    AND check_in_time IS NOT NULL                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ì „ì²´ Path ë‹¤ì´ì–´ê·¸ë¨

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Complete Path Structure                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                          ì‚¬ìš©ì ì§ˆë¬¸
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ontology_synonyms â”‚â”€â”€â”€â–¶â”‚ ontology_concepts â”‚
â”‚ "ë§¤ì¶œ" â†’ revenue  â”‚    â”‚ revenue = income  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â–¼                  â–¼                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ontology_columns â”‚   â”‚ontology_relation-â”‚   â”‚ontology_calculat-â”‚
â”‚ table.column     â”‚   â”‚ships (JOIN ê´€ê³„)  â”‚   â”‚ion_rules (ê³µì‹)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                      â”‚                      â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                      â”‚ontology_constrai-â”‚
                      â”‚nts (ê·œì¹™/íŒ¨í„´)   â”‚
                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â–¼                     â–¼                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    features      â”‚   â”‚ontology_action_  â”‚   â”‚ontology_event_   â”‚
â”‚  (UI í˜ì´ì§€)     â”‚   â”‚types (ì„¸ë¶€ í–‰ë™) â”‚   â”‚types (ê²°ê³¼ ê¸°ë¡) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                      â”‚                      â”‚
         â”‚                      â–¼                      â”‚
         â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚   target_table   â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚ (ì‹¤ì œ ë°ì´í„°)    â”‚
                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â–¼
                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                      â”‚    SQL ìƒì„±      â”‚
                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## í…Œì´ë¸”ë³„ ì—­í•  ìš”ì•½

| í…Œì´ë¸” | ì—­í•  | ì˜ˆì‹œ |
|--------|------|------|
| `ontology_synonyms` | ë‹¤êµ­ì–´ ë™ì˜ì–´ ë§¤í•‘ | "ë§¤ì¶œ" â†’ revenue |
| `ontology_concepts` | ê°œë… ì •ì˜, í…Œì´ë¸” ë§¤í•‘ | revenue â†’ journal_lines |
| `ontology_concept_relations` | ê°œë… ê°„ ê´€ê³„ | revenue â†” expense |
| `ontology_columns` | ì»¬ëŸ¼ ë©”íƒ€ë°ì´í„°, deprecated | users.name âŒ |
| `ontology_relationships` | í…Œì´ë¸” JOIN ê´€ê³„ | journal_entries â†’ journal_lines |
| `ontology_constraints` | SQL ì‘ì„± ê·œì¹™ | company_id í•„í„° í•„ìˆ˜ |
| `ontology_calculation_rules` | ê³„ì‚° ê³µì‹ | ë§¤ì¶œ = SUM(credit) |
| `ontology_kpi_rules` | KPI ê³µì‹ | ì´ìµë¥  = ì´ìµ/ë§¤ì¶œ |
| `features` | UI í˜ì´ì§€/ê¶Œí•œ | Attendance, Debt Control |
| `role_permissions` | ì—­í• ë³„ ê¶Œí•œ | admin â†’ Delete Transaction |
| `ontology_action_types` ğŸ†• | ì„¸ë¶€ í–‰ë™ ì •ì˜ | check_in, approve_shift |
| `ontology_event_types` | ì´ë²¤íŠ¸ ì •ì˜ | ShiftEvent, TransactionEvent |
| `ontology_embeddings` | ë²¡í„° ê²€ìƒ‰ | ì˜ë¯¸ ê¸°ë°˜ ê²€ìƒ‰ |
| `v_ontology_graph_nodes` | í†µí•© ë…¸ë“œ ë·° | ëª¨ë“  ë…¸ë“œ ì¡°íšŒ |
| `v_ontology_graph_edges` | í†µí•© ì—£ì§€ ë·° | ëª¨ë“  ê´€ê³„ ì¡°íšŒ |

---

## RPC Functions

| RPC | ì—­í•  |
|-----|------|
| `get_ontology_paths_v2(concepts[], depth)` | ê°œë… â†’ í…Œì´ë¸”/ì»¬ëŸ¼/ê·œì¹™ íƒìƒ‰ |
| `search_ontology_embeddings(query, limit)` | ë²¡í„° ìœ ì‚¬ë„ ê²€ìƒ‰ |

---

## ì§ˆë¬¸ ìœ í˜•ë³„ Path

### 1. ë°ì´í„° ì¡°íšŒ ì§ˆë¬¸
```
"ì´ë²ˆ ë‹¬ ë§¤ì¶œ" â†’ synonym â†’ concept â†’ table â†’ columns â†’ SQL
```

### 2. ê¶Œí•œ ì§ˆë¬¸
```
"ëˆ„ê°€ ê±°ë˜ ì‚­ì œ ê°€ëŠ¥?" â†’ features â†’ role_permissions â†’ roles
```

### 3. í–‰ë™ ì§ˆë¬¸ (NEW!)
```
"ì˜¤ëŠ˜ ì²´í¬ì¸í•œ ì‚¬ëŒ" â†’ ontology_action_types â†’ target_table â†’ SQL
```

### 4. ì´ë²¤íŠ¸ ì§ˆë¬¸
```
"ì–¸ì œ ë¬´ìŠ¨ ì¼ì´ ìˆì—ˆì–´?" â†’ ontology_event_types â†’ source_table â†’ SQL
```

---

## Version History

| Date | Changes |
|------|---------|
| 2025-12-16 | Initial version with ontology_action_types |
