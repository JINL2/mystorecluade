var kx=Object.defineProperty;var Nx=(t,e,r)=>e in t?kx(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var W=(t,e,r)=>Nx(t,typeof e!="symbol"?e+"":e,r);function Y_(t,e){for(var r=0;r<e.length;r++){const s=e[r];if(typeof s!="string"&&!Array.isArray(s)){for(const n in s)if(n!=="default"&&!(n in t)){const o=Object.getOwnPropertyDescriptor(s,n);o&&Object.defineProperty(t,n,o.get?o:{enumerable:!0,get:()=>s[n]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function r(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(n){if(n.ep)return;n.ep=!0;const o=r(n);fetch(n.href,o)}})();var dQ=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ix(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Ex(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var r=function s(){return this instanceof s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(s){var n=Object.getOwnPropertyDescriptor(t,s);Object.defineProperty(r,s,n.get?n:{enumerable:!0,get:function(){return t[s]}})}),r}var Q_={exports:{}},rd={},Z_={exports:{}},Pe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Hi=Symbol.for("react.element"),Tx=Symbol.for("react.portal"),Ax=Symbol.for("react.fragment"),Lx=Symbol.for("react.strict_mode"),Dx=Symbol.for("react.profiler"),Mx=Symbol.for("react.provider"),Rx=Symbol.for("react.context"),Ox=Symbol.for("react.forward_ref"),Px=Symbol.for("react.suspense"),$x=Symbol.for("react.memo"),Fx=Symbol.for("react.lazy"),jm=Symbol.iterator;function Bx(t){return t===null||typeof t!="object"?null:(t=jm&&t[jm]||t["@@iterator"],typeof t=="function"?t:null)}var X_={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},ey=Object.assign,ty={};function fa(t,e,r){this.props=t,this.context=e,this.refs=ty,this.updater=r||X_}fa.prototype.isReactComponent={};fa.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};fa.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function ry(){}ry.prototype=fa.prototype;function Jh(t,e,r){this.props=t,this.context=e,this.refs=ty,this.updater=r||X_}var Kh=Jh.prototype=new ry;Kh.constructor=Jh;ey(Kh,fa.prototype);Kh.isPureReactComponent=!0;var km=Array.isArray,sy=Object.prototype.hasOwnProperty,Yh={current:null},ny={key:!0,ref:!0,__self:!0,__source:!0};function oy(t,e,r){var s,n={},o=null,i=null;if(e!=null)for(s in e.ref!==void 0&&(i=e.ref),e.key!==void 0&&(o=""+e.key),e)sy.call(e,s)&&!ny.hasOwnProperty(s)&&(n[s]=e[s]);var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];n.children=c}if(t&&t.defaultProps)for(s in l=t.defaultProps,l)n[s]===void 0&&(n[s]=l[s]);return{$$typeof:Hi,type:t,key:o,ref:i,props:n,_owner:Yh.current}}function Hx(t,e){return{$$typeof:Hi,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Qh(t){return typeof t=="object"&&t!==null&&t.$$typeof===Hi}function Vx(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var Nm=/\/+/g;function Id(t,e){return typeof t=="object"&&t!==null&&t.key!=null?Vx(""+t.key):e.toString(36)}function Kl(t,e,r,s,n){var o=typeof t;(o==="undefined"||o==="boolean")&&(t=null);var i=!1;if(t===null)i=!0;else switch(o){case"string":case"number":i=!0;break;case"object":switch(t.$$typeof){case Hi:case Tx:i=!0}}if(i)return i=t,n=n(i),t=s===""?"."+Id(i,0):s,km(n)?(r="",t!=null&&(r=t.replace(Nm,"$&/")+"/"),Kl(n,e,r,"",function(d){return d})):n!=null&&(Qh(n)&&(n=Hx(n,r+(!n.key||i&&i.key===n.key?"":(""+n.key).replace(Nm,"$&/")+"/")+t)),e.push(n)),1;if(i=0,s=s===""?".":s+":",km(t))for(var l=0;l<t.length;l++){o=t[l];var c=s+Id(o,l);i+=Kl(o,e,r,c,n)}else if(c=Bx(t),typeof c=="function")for(t=c.call(t),l=0;!(o=t.next()).done;)o=o.value,c=s+Id(o,l++),i+=Kl(o,e,r,c,n);else if(o==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return i}function rl(t,e,r){if(t==null)return t;var s=[],n=0;return Kl(t,s,"","",function(o){return e.call(r,o,n++)}),s}function zx(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Dr={current:null},Yl={transition:null},Ux={ReactCurrentDispatcher:Dr,ReactCurrentBatchConfig:Yl,ReactCurrentOwner:Yh};function ay(){throw Error("act(...) is not supported in production builds of React.")}Pe.Children={map:rl,forEach:function(t,e,r){rl(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return rl(t,function(){e++}),e},toArray:function(t){return rl(t,function(e){return e})||[]},only:function(t){if(!Qh(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Pe.Component=fa;Pe.Fragment=Ax;Pe.Profiler=Dx;Pe.PureComponent=Jh;Pe.StrictMode=Lx;Pe.Suspense=Px;Pe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ux;Pe.act=ay;Pe.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var s=ey({},t.props),n=t.key,o=t.ref,i=t._owner;if(e!=null){if(e.ref!==void 0&&(o=e.ref,i=Yh.current),e.key!==void 0&&(n=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)sy.call(e,c)&&!ny.hasOwnProperty(c)&&(s[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)s.children=r;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];s.children=l}return{$$typeof:Hi,type:t.type,key:n,ref:o,props:s,_owner:i}};Pe.createContext=function(t){return t={$$typeof:Rx,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:Mx,_context:t},t.Consumer=t};Pe.createElement=oy;Pe.createFactory=function(t){var e=oy.bind(null,t);return e.type=t,e};Pe.createRef=function(){return{current:null}};Pe.forwardRef=function(t){return{$$typeof:Ox,render:t}};Pe.isValidElement=Qh;Pe.lazy=function(t){return{$$typeof:Fx,_payload:{_status:-1,_result:t},_init:zx}};Pe.memo=function(t,e){return{$$typeof:$x,type:t,compare:e===void 0?null:e}};Pe.startTransition=function(t){var e=Yl.transition;Yl.transition={};try{t()}finally{Yl.transition=e}};Pe.unstable_act=ay;Pe.useCallback=function(t,e){return Dr.current.useCallback(t,e)};Pe.useContext=function(t){return Dr.current.useContext(t)};Pe.useDebugValue=function(){};Pe.useDeferredValue=function(t){return Dr.current.useDeferredValue(t)};Pe.useEffect=function(t,e){return Dr.current.useEffect(t,e)};Pe.useId=function(){return Dr.current.useId()};Pe.useImperativeHandle=function(t,e,r){return Dr.current.useImperativeHandle(t,e,r)};Pe.useInsertionEffect=function(t,e){return Dr.current.useInsertionEffect(t,e)};Pe.useLayoutEffect=function(t,e){return Dr.current.useLayoutEffect(t,e)};Pe.useMemo=function(t,e){return Dr.current.useMemo(t,e)};Pe.useReducer=function(t,e,r){return Dr.current.useReducer(t,e,r)};Pe.useRef=function(t){return Dr.current.useRef(t)};Pe.useState=function(t){return Dr.current.useState(t)};Pe.useSyncExternalStore=function(t,e,r){return Dr.current.useSyncExternalStore(t,e,r)};Pe.useTransition=function(){return Dr.current.useTransition()};Pe.version="18.3.1";Z_.exports=Pe;var b=Z_.exports;const Ar=Ix(b),Wx=Y_({__proto__:null,default:Ar},[b]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qx=b,Gx=Symbol.for("react.element"),Jx=Symbol.for("react.fragment"),Kx=Object.prototype.hasOwnProperty,Yx=qx.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Qx={key:!0,ref:!0,__self:!0,__source:!0};function iy(t,e,r){var s,n={},o=null,i=null;r!==void 0&&(o=""+r),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(i=e.ref);for(s in e)Kx.call(e,s)&&!Qx.hasOwnProperty(s)&&(n[s]=e[s]);if(t&&t.defaultProps)for(s in e=t.defaultProps,e)n[s]===void 0&&(n[s]=e[s]);return{$$typeof:Gx,type:t,key:o,ref:i,props:n,_owner:Yx.current}}rd.Fragment=Jx;rd.jsx=iy;rd.jsxs=iy;Q_.exports=rd;var a=Q_.exports,Lu={},ly={exports:{}},ns={},cy={exports:{}},dy={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(D,P){var $=D.length;D.push(P);e:for(;0<$;){var U=$-1>>>1,A=D[U];if(0<n(A,P))D[U]=P,D[$]=A,$=U;else break e}}function r(D){return D.length===0?null:D[0]}function s(D){if(D.length===0)return null;var P=D[0],$=D.pop();if($!==P){D[0]=$;e:for(var U=0,A=D.length,Ae=A>>>1;U<Ae;){var ae=2*(U+1)-1,Ke=D[ae],Te=ae+1,At=D[Te];if(0>n(Ke,$))Te<A&&0>n(At,Ke)?(D[U]=At,D[Te]=$,U=Te):(D[U]=Ke,D[ae]=$,U=ae);else if(Te<A&&0>n(At,$))D[U]=At,D[Te]=$,U=Te;else break e}}return P}function n(D,P){var $=D.sortIndex-P.sortIndex;return $!==0?$:D.id-P.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var i=Date,l=i.now();t.unstable_now=function(){return i.now()-l}}var c=[],d=[],u=1,h=null,f=3,p=!1,g=!1,y=!1,x=typeof setTimeout=="function"?setTimeout:null,m=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v(D){for(var P=r(d);P!==null;){if(P.callback===null)s(d);else if(P.startTime<=D)s(d),P.sortIndex=P.expirationTime,e(c,P);else break;P=r(d)}}function w(D){if(y=!1,v(D),!g)if(r(c)!==null)g=!0,O(S);else{var P=r(d);P!==null&&z(w,P.startTime-D)}}function S(D,P){g=!1,y&&(y=!1,m(k),k=-1),p=!0;var $=f;try{for(v(P),h=r(c);h!==null&&(!(h.expirationTime>P)||D&&!L());){var U=h.callback;if(typeof U=="function"){h.callback=null,f=h.priorityLevel;var A=U(h.expirationTime<=P);P=t.unstable_now(),typeof A=="function"?h.callback=A:h===r(c)&&s(c),v(P)}else s(c);h=r(c)}if(h!==null)var Ae=!0;else{var ae=r(d);ae!==null&&z(w,ae.startTime-P),Ae=!1}return Ae}finally{h=null,f=$,p=!1}}var E=!1,C=null,k=-1,N=5,I=-1;function L(){return!(t.unstable_now()-I<N)}function T(){if(C!==null){var D=t.unstable_now();I=D;var P=!0;try{P=C(!0,D)}finally{P?j():(E=!1,C=null)}}else E=!1}var j;if(typeof _=="function")j=function(){_(T)};else if(typeof MessageChannel<"u"){var M=new MessageChannel,R=M.port2;M.port1.onmessage=T,j=function(){R.postMessage(null)}}else j=function(){x(T,0)};function O(D){C=D,E||(E=!0,j())}function z(D,P){k=x(function(){D(t.unstable_now())},P)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(D){D.callback=null},t.unstable_continueExecution=function(){g||p||(g=!0,O(S))},t.unstable_forceFrameRate=function(D){0>D||125<D?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<D?Math.floor(1e3/D):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(D){switch(f){case 1:case 2:case 3:var P=3;break;default:P=f}var $=f;f=P;try{return D()}finally{f=$}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(D,P){switch(D){case 1:case 2:case 3:case 4:case 5:break;default:D=3}var $=f;f=D;try{return P()}finally{f=$}},t.unstable_scheduleCallback=function(D,P,$){var U=t.unstable_now();switch(typeof $=="object"&&$!==null?($=$.delay,$=typeof $=="number"&&0<$?U+$:U):$=U,D){case 1:var A=-1;break;case 2:A=250;break;case 5:A=1073741823;break;case 4:A=1e4;break;default:A=5e3}return A=$+A,D={id:u++,callback:P,priorityLevel:D,startTime:$,expirationTime:A,sortIndex:-1},$>U?(D.sortIndex=$,e(d,D),r(c)===null&&D===r(d)&&(y?(m(k),k=-1):y=!0,z(w,$-U))):(D.sortIndex=A,e(c,D),g||p||(g=!0,O(S))),D},t.unstable_shouldYield=L,t.unstable_wrapCallback=function(D){var P=f;return function(){var $=f;f=P;try{return D.apply(this,arguments)}finally{f=$}}}})(dy);cy.exports=dy;var Zx=cy.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xx=b,ss=Zx;function q(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var uy=new Set,hi={};function bo(t,e){na(t,e),na(t+"Capture",e)}function na(t,e){for(hi[t]=e,t=0;t<e.length;t++)uy.add(e[t])}var Zs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Du=Object.prototype.hasOwnProperty,eb=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Im={},Em={};function tb(t){return Du.call(Em,t)?!0:Du.call(Im,t)?!1:eb.test(t)?Em[t]=!0:(Im[t]=!0,!1)}function rb(t,e,r,s){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return s?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function sb(t,e,r,s){if(e===null||typeof e>"u"||rb(t,e,r,s))return!0;if(s)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Mr(t,e,r,s,n,o,i){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=s,this.attributeNamespace=n,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=i}var mr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){mr[t]=new Mr(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];mr[e]=new Mr(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){mr[t]=new Mr(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){mr[t]=new Mr(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){mr[t]=new Mr(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){mr[t]=new Mr(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){mr[t]=new Mr(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){mr[t]=new Mr(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){mr[t]=new Mr(t,5,!1,t.toLowerCase(),null,!1,!1)});var Zh=/[\-:]([a-z])/g;function Xh(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Zh,Xh);mr[e]=new Mr(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Zh,Xh);mr[e]=new Mr(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Zh,Xh);mr[e]=new Mr(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){mr[t]=new Mr(t,1,!1,t.toLowerCase(),null,!1,!1)});mr.xlinkHref=new Mr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){mr[t]=new Mr(t,1,!1,t.toLowerCase(),null,!0,!0)});function ef(t,e,r,s){var n=mr.hasOwnProperty(e)?mr[e]:null;(n!==null?n.type!==0:s||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(sb(e,r,n,s)&&(r=null),s||n===null?tb(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):n.mustUseProperty?t[n.propertyName]=r===null?n.type===3?!1:"":r:(e=n.attributeName,s=n.attributeNamespace,r===null?t.removeAttribute(e):(n=n.type,r=n===3||n===4&&r===!0?"":""+r,s?t.setAttributeNS(s,e,r):t.setAttribute(e,r))))}var sn=Xx.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,sl=Symbol.for("react.element"),Po=Symbol.for("react.portal"),$o=Symbol.for("react.fragment"),tf=Symbol.for("react.strict_mode"),Mu=Symbol.for("react.profiler"),hy=Symbol.for("react.provider"),fy=Symbol.for("react.context"),rf=Symbol.for("react.forward_ref"),Ru=Symbol.for("react.suspense"),Ou=Symbol.for("react.suspense_list"),sf=Symbol.for("react.memo"),dn=Symbol.for("react.lazy"),my=Symbol.for("react.offscreen"),Tm=Symbol.iterator;function Sa(t){return t===null||typeof t!="object"?null:(t=Tm&&t[Tm]||t["@@iterator"],typeof t=="function"?t:null)}var Tt=Object.assign,Ed;function Oa(t){if(Ed===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);Ed=e&&e[1]||""}return`
`+Ed+t}var Td=!1;function Ad(t,e){if(!t||Td)return"";Td=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var s=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){s=d}t.call(e.prototype)}else{try{throw Error()}catch(d){s=d}t()}}catch(d){if(d&&s&&typeof d.stack=="string"){for(var n=d.stack.split(`
`),o=s.stack.split(`
`),i=n.length-1,l=o.length-1;1<=i&&0<=l&&n[i]!==o[l];)l--;for(;1<=i&&0<=l;i--,l--)if(n[i]!==o[l]){if(i!==1||l!==1)do if(i--,l--,0>l||n[i]!==o[l]){var c=`
`+n[i].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=i&&0<=l);break}}}finally{Td=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?Oa(t):""}function nb(t){switch(t.tag){case 5:return Oa(t.type);case 16:return Oa("Lazy");case 13:return Oa("Suspense");case 19:return Oa("SuspenseList");case 0:case 2:case 15:return t=Ad(t.type,!1),t;case 11:return t=Ad(t.type.render,!1),t;case 1:return t=Ad(t.type,!0),t;default:return""}}function Pu(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case $o:return"Fragment";case Po:return"Portal";case Mu:return"Profiler";case tf:return"StrictMode";case Ru:return"Suspense";case Ou:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case fy:return(t.displayName||"Context")+".Consumer";case hy:return(t._context.displayName||"Context")+".Provider";case rf:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case sf:return e=t.displayName||null,e!==null?e:Pu(t.type)||"Memo";case dn:e=t._payload,t=t._init;try{return Pu(t(e))}catch{}}return null}function ob(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Pu(e);case 8:return e===tf?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Ln(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function py(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function ab(t){var e=py(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),s=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var n=r.get,o=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return n.call(this)},set:function(i){s=""+i,o.call(this,i)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return s},setValue:function(i){s=""+i},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function nl(t){t._valueTracker||(t._valueTracker=ab(t))}function gy(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),s="";return t&&(s=py(t)?t.checked?"true":"false":t.value),t=s,t!==r?(e.setValue(t),!0):!1}function uc(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function $u(t,e){var r=e.checked;return Tt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function Am(t,e){var r=e.defaultValue==null?"":e.defaultValue,s=e.checked!=null?e.checked:e.defaultChecked;r=Ln(e.value!=null?e.value:r),t._wrapperState={initialChecked:s,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function _y(t,e){e=e.checked,e!=null&&ef(t,"checked",e,!1)}function Fu(t,e){_y(t,e);var r=Ln(e.value),s=e.type;if(r!=null)s==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(s==="submit"||s==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Bu(t,e.type,r):e.hasOwnProperty("defaultValue")&&Bu(t,e.type,Ln(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Lm(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var s=e.type;if(!(s!=="submit"&&s!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function Bu(t,e,r){(e!=="number"||uc(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var Pa=Array.isArray;function Ko(t,e,r,s){if(t=t.options,e){e={};for(var n=0;n<r.length;n++)e["$"+r[n]]=!0;for(r=0;r<t.length;r++)n=e.hasOwnProperty("$"+t[r].value),t[r].selected!==n&&(t[r].selected=n),n&&s&&(t[r].defaultSelected=!0)}else{for(r=""+Ln(r),e=null,n=0;n<t.length;n++){if(t[n].value===r){t[n].selected=!0,s&&(t[n].defaultSelected=!0);return}e!==null||t[n].disabled||(e=t[n])}e!==null&&(e.selected=!0)}}function Hu(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(q(91));return Tt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Dm(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(q(92));if(Pa(r)){if(1<r.length)throw Error(q(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:Ln(r)}}function yy(t,e){var r=Ln(e.value),s=Ln(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),s!=null&&(t.defaultValue=""+s)}function Mm(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function vy(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Vu(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?vy(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var ol,xy=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,s,n){MSApp.execUnsafeLocalFunction(function(){return t(e,r,s,n)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(ol=ol||document.createElement("div"),ol.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=ol.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function fi(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var Ja={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ib=["Webkit","ms","Moz","O"];Object.keys(Ja).forEach(function(t){ib.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Ja[e]=Ja[t]})});function by(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||Ja.hasOwnProperty(t)&&Ja[t]?(""+e).trim():e+"px"}function wy(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var s=r.indexOf("--")===0,n=by(r,e[r],s);r==="float"&&(r="cssFloat"),s?t.setProperty(r,n):t[r]=n}}var lb=Tt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function zu(t,e){if(e){if(lb[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(q(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(q(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(q(61))}if(e.style!=null&&typeof e.style!="object")throw Error(q(62))}}function Uu(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Wu=null;function nf(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var qu=null,Yo=null,Qo=null;function Rm(t){if(t=Ui(t)){if(typeof qu!="function")throw Error(q(280));var e=t.stateNode;e&&(e=id(e),qu(t.stateNode,t.type,e))}}function Sy(t){Yo?Qo?Qo.push(t):Qo=[t]:Yo=t}function Cy(){if(Yo){var t=Yo,e=Qo;if(Qo=Yo=null,Rm(t),e)for(t=0;t<e.length;t++)Rm(e[t])}}function jy(t,e){return t(e)}function ky(){}var Ld=!1;function Ny(t,e,r){if(Ld)return t(e,r);Ld=!0;try{return jy(t,e,r)}finally{Ld=!1,(Yo!==null||Qo!==null)&&(ky(),Cy())}}function mi(t,e){var r=t.stateNode;if(r===null)return null;var s=id(r);if(s===null)return null;r=s[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(t=t.type,s=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!s;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(q(231,e,typeof r));return r}var Gu=!1;if(Zs)try{var Ca={};Object.defineProperty(Ca,"passive",{get:function(){Gu=!0}}),window.addEventListener("test",Ca,Ca),window.removeEventListener("test",Ca,Ca)}catch{Gu=!1}function cb(t,e,r,s,n,o,i,l,c){var d=Array.prototype.slice.call(arguments,3);try{e.apply(r,d)}catch(u){this.onError(u)}}var Ka=!1,hc=null,fc=!1,Ju=null,db={onError:function(t){Ka=!0,hc=t}};function ub(t,e,r,s,n,o,i,l,c){Ka=!1,hc=null,cb.apply(db,arguments)}function hb(t,e,r,s,n,o,i,l,c){if(ub.apply(this,arguments),Ka){if(Ka){var d=hc;Ka=!1,hc=null}else throw Error(q(198));fc||(fc=!0,Ju=d)}}function wo(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function Iy(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Om(t){if(wo(t)!==t)throw Error(q(188))}function fb(t){var e=t.alternate;if(!e){if(e=wo(t),e===null)throw Error(q(188));return e!==t?null:t}for(var r=t,s=e;;){var n=r.return;if(n===null)break;var o=n.alternate;if(o===null){if(s=n.return,s!==null){r=s;continue}break}if(n.child===o.child){for(o=n.child;o;){if(o===r)return Om(n),t;if(o===s)return Om(n),e;o=o.sibling}throw Error(q(188))}if(r.return!==s.return)r=n,s=o;else{for(var i=!1,l=n.child;l;){if(l===r){i=!0,r=n,s=o;break}if(l===s){i=!0,s=n,r=o;break}l=l.sibling}if(!i){for(l=o.child;l;){if(l===r){i=!0,r=o,s=n;break}if(l===s){i=!0,s=o,r=n;break}l=l.sibling}if(!i)throw Error(q(189))}}if(r.alternate!==s)throw Error(q(190))}if(r.tag!==3)throw Error(q(188));return r.stateNode.current===r?t:e}function Ey(t){return t=fb(t),t!==null?Ty(t):null}function Ty(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Ty(t);if(e!==null)return e;t=t.sibling}return null}var Ay=ss.unstable_scheduleCallback,Pm=ss.unstable_cancelCallback,mb=ss.unstable_shouldYield,pb=ss.unstable_requestPaint,Pt=ss.unstable_now,gb=ss.unstable_getCurrentPriorityLevel,of=ss.unstable_ImmediatePriority,Ly=ss.unstable_UserBlockingPriority,mc=ss.unstable_NormalPriority,_b=ss.unstable_LowPriority,Dy=ss.unstable_IdlePriority,sd=null,Fs=null;function yb(t){if(Fs&&typeof Fs.onCommitFiberRoot=="function")try{Fs.onCommitFiberRoot(sd,t,void 0,(t.current.flags&128)===128)}catch{}}var js=Math.clz32?Math.clz32:bb,vb=Math.log,xb=Math.LN2;function bb(t){return t>>>=0,t===0?32:31-(vb(t)/xb|0)|0}var al=64,il=4194304;function $a(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function pc(t,e){var r=t.pendingLanes;if(r===0)return 0;var s=0,n=t.suspendedLanes,o=t.pingedLanes,i=r&268435455;if(i!==0){var l=i&~n;l!==0?s=$a(l):(o&=i,o!==0&&(s=$a(o)))}else i=r&~n,i!==0?s=$a(i):o!==0&&(s=$a(o));if(s===0)return 0;if(e!==0&&e!==s&&!(e&n)&&(n=s&-s,o=e&-e,n>=o||n===16&&(o&4194240)!==0))return e;if(s&4&&(s|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=s;0<e;)r=31-js(e),n=1<<r,s|=t[r],e&=~n;return s}function wb(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Sb(t,e){for(var r=t.suspendedLanes,s=t.pingedLanes,n=t.expirationTimes,o=t.pendingLanes;0<o;){var i=31-js(o),l=1<<i,c=n[i];c===-1?(!(l&r)||l&s)&&(n[i]=wb(l,e)):c<=e&&(t.expiredLanes|=l),o&=~l}}function Ku(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function My(){var t=al;return al<<=1,!(al&4194240)&&(al=64),t}function Dd(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function Vi(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-js(e),t[e]=r}function Cb(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var s=t.eventTimes;for(t=t.expirationTimes;0<r;){var n=31-js(r),o=1<<n;e[n]=0,s[n]=-1,t[n]=-1,r&=~o}}function af(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var s=31-js(r),n=1<<s;n&e|t[s]&e&&(t[s]|=e),r&=~n}}var et=0;function Ry(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Oy,lf,Py,$y,Fy,Yu=!1,ll=[],Sn=null,Cn=null,jn=null,pi=new Map,gi=new Map,hn=[],jb="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function $m(t,e){switch(t){case"focusin":case"focusout":Sn=null;break;case"dragenter":case"dragleave":Cn=null;break;case"mouseover":case"mouseout":jn=null;break;case"pointerover":case"pointerout":pi.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":gi.delete(e.pointerId)}}function ja(t,e,r,s,n,o){return t===null||t.nativeEvent!==o?(t={blockedOn:e,domEventName:r,eventSystemFlags:s,nativeEvent:o,targetContainers:[n]},e!==null&&(e=Ui(e),e!==null&&lf(e)),t):(t.eventSystemFlags|=s,e=t.targetContainers,n!==null&&e.indexOf(n)===-1&&e.push(n),t)}function kb(t,e,r,s,n){switch(e){case"focusin":return Sn=ja(Sn,t,e,r,s,n),!0;case"dragenter":return Cn=ja(Cn,t,e,r,s,n),!0;case"mouseover":return jn=ja(jn,t,e,r,s,n),!0;case"pointerover":var o=n.pointerId;return pi.set(o,ja(pi.get(o)||null,t,e,r,s,n)),!0;case"gotpointercapture":return o=n.pointerId,gi.set(o,ja(gi.get(o)||null,t,e,r,s,n)),!0}return!1}function By(t){var e=no(t.target);if(e!==null){var r=wo(e);if(r!==null){if(e=r.tag,e===13){if(e=Iy(r),e!==null){t.blockedOn=e,Fy(t.priority,function(){Py(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Ql(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=Qu(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var s=new r.constructor(r.type,r);Wu=s,r.target.dispatchEvent(s),Wu=null}else return e=Ui(r),e!==null&&lf(e),t.blockedOn=r,!1;e.shift()}return!0}function Fm(t,e,r){Ql(t)&&r.delete(e)}function Nb(){Yu=!1,Sn!==null&&Ql(Sn)&&(Sn=null),Cn!==null&&Ql(Cn)&&(Cn=null),jn!==null&&Ql(jn)&&(jn=null),pi.forEach(Fm),gi.forEach(Fm)}function ka(t,e){t.blockedOn===e&&(t.blockedOn=null,Yu||(Yu=!0,ss.unstable_scheduleCallback(ss.unstable_NormalPriority,Nb)))}function _i(t){function e(n){return ka(n,t)}if(0<ll.length){ka(ll[0],t);for(var r=1;r<ll.length;r++){var s=ll[r];s.blockedOn===t&&(s.blockedOn=null)}}for(Sn!==null&&ka(Sn,t),Cn!==null&&ka(Cn,t),jn!==null&&ka(jn,t),pi.forEach(e),gi.forEach(e),r=0;r<hn.length;r++)s=hn[r],s.blockedOn===t&&(s.blockedOn=null);for(;0<hn.length&&(r=hn[0],r.blockedOn===null);)By(r),r.blockedOn===null&&hn.shift()}var Zo=sn.ReactCurrentBatchConfig,gc=!0;function Ib(t,e,r,s){var n=et,o=Zo.transition;Zo.transition=null;try{et=1,cf(t,e,r,s)}finally{et=n,Zo.transition=o}}function Eb(t,e,r,s){var n=et,o=Zo.transition;Zo.transition=null;try{et=4,cf(t,e,r,s)}finally{et=n,Zo.transition=o}}function cf(t,e,r,s){if(gc){var n=Qu(t,e,r,s);if(n===null)zd(t,e,s,_c,r),$m(t,s);else if(kb(n,t,e,r,s))s.stopPropagation();else if($m(t,s),e&4&&-1<jb.indexOf(t)){for(;n!==null;){var o=Ui(n);if(o!==null&&Oy(o),o=Qu(t,e,r,s),o===null&&zd(t,e,s,_c,r),o===n)break;n=o}n!==null&&s.stopPropagation()}else zd(t,e,s,null,r)}}var _c=null;function Qu(t,e,r,s){if(_c=null,t=nf(s),t=no(t),t!==null)if(e=wo(t),e===null)t=null;else if(r=e.tag,r===13){if(t=Iy(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return _c=t,null}function Hy(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(gb()){case of:return 1;case Ly:return 4;case mc:case _b:return 16;case Dy:return 536870912;default:return 16}default:return 16}}var gn=null,df=null,Zl=null;function Vy(){if(Zl)return Zl;var t,e=df,r=e.length,s,n="value"in gn?gn.value:gn.textContent,o=n.length;for(t=0;t<r&&e[t]===n[t];t++);var i=r-t;for(s=1;s<=i&&e[r-s]===n[o-s];s++);return Zl=n.slice(t,1<s?1-s:void 0)}function Xl(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function cl(){return!0}function Bm(){return!1}function os(t){function e(r,s,n,o,i){this._reactName=r,this._targetInst=n,this.type=s,this.nativeEvent=o,this.target=i,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(r=t[l],this[l]=r?r(o):o[l]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?cl:Bm,this.isPropagationStopped=Bm,this}return Tt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=cl)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=cl)},persist:function(){},isPersistent:cl}),e}var ma={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},uf=os(ma),zi=Tt({},ma,{view:0,detail:0}),Tb=os(zi),Md,Rd,Na,nd=Tt({},zi,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:hf,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Na&&(Na&&t.type==="mousemove"?(Md=t.screenX-Na.screenX,Rd=t.screenY-Na.screenY):Rd=Md=0,Na=t),Md)},movementY:function(t){return"movementY"in t?t.movementY:Rd}}),Hm=os(nd),Ab=Tt({},nd,{dataTransfer:0}),Lb=os(Ab),Db=Tt({},zi,{relatedTarget:0}),Od=os(Db),Mb=Tt({},ma,{animationName:0,elapsedTime:0,pseudoElement:0}),Rb=os(Mb),Ob=Tt({},ma,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Pb=os(Ob),$b=Tt({},ma,{data:0}),Vm=os($b),Fb={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Bb={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Hb={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Vb(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=Hb[t])?!!e[t]:!1}function hf(){return Vb}var zb=Tt({},zi,{key:function(t){if(t.key){var e=Fb[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Xl(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Bb[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:hf,charCode:function(t){return t.type==="keypress"?Xl(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Xl(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),Ub=os(zb),Wb=Tt({},nd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),zm=os(Wb),qb=Tt({},zi,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:hf}),Gb=os(qb),Jb=Tt({},ma,{propertyName:0,elapsedTime:0,pseudoElement:0}),Kb=os(Jb),Yb=Tt({},nd,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Qb=os(Yb),Zb=[9,13,27,32],ff=Zs&&"CompositionEvent"in window,Ya=null;Zs&&"documentMode"in document&&(Ya=document.documentMode);var Xb=Zs&&"TextEvent"in window&&!Ya,zy=Zs&&(!ff||Ya&&8<Ya&&11>=Ya),Um=" ",Wm=!1;function Uy(t,e){switch(t){case"keyup":return Zb.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Wy(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Fo=!1;function ew(t,e){switch(t){case"compositionend":return Wy(e);case"keypress":return e.which!==32?null:(Wm=!0,Um);case"textInput":return t=e.data,t===Um&&Wm?null:t;default:return null}}function tw(t,e){if(Fo)return t==="compositionend"||!ff&&Uy(t,e)?(t=Vy(),Zl=df=gn=null,Fo=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return zy&&e.locale!=="ko"?null:e.data;default:return null}}var rw={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function qm(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!rw[t.type]:e==="textarea"}function qy(t,e,r,s){Sy(s),e=yc(e,"onChange"),0<e.length&&(r=new uf("onChange","change",null,r,s),t.push({event:r,listeners:e}))}var Qa=null,yi=null;function sw(t){s1(t,0)}function od(t){var e=Vo(t);if(gy(e))return t}function nw(t,e){if(t==="change")return e}var Gy=!1;if(Zs){var Pd;if(Zs){var $d="oninput"in document;if(!$d){var Gm=document.createElement("div");Gm.setAttribute("oninput","return;"),$d=typeof Gm.oninput=="function"}Pd=$d}else Pd=!1;Gy=Pd&&(!document.documentMode||9<document.documentMode)}function Jm(){Qa&&(Qa.detachEvent("onpropertychange",Jy),yi=Qa=null)}function Jy(t){if(t.propertyName==="value"&&od(yi)){var e=[];qy(e,yi,t,nf(t)),Ny(sw,e)}}function ow(t,e,r){t==="focusin"?(Jm(),Qa=e,yi=r,Qa.attachEvent("onpropertychange",Jy)):t==="focusout"&&Jm()}function aw(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return od(yi)}function iw(t,e){if(t==="click")return od(e)}function lw(t,e){if(t==="input"||t==="change")return od(e)}function cw(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Ns=typeof Object.is=="function"?Object.is:cw;function vi(t,e){if(Ns(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),s=Object.keys(e);if(r.length!==s.length)return!1;for(s=0;s<r.length;s++){var n=r[s];if(!Du.call(e,n)||!Ns(t[n],e[n]))return!1}return!0}function Km(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Ym(t,e){var r=Km(t);t=0;for(var s;r;){if(r.nodeType===3){if(s=t+r.textContent.length,t<=e&&s>=e)return{node:r,offset:e-t};t=s}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Km(r)}}function Ky(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Ky(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Yy(){for(var t=window,e=uc();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=uc(t.document)}return e}function mf(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function dw(t){var e=Yy(),r=t.focusedElem,s=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&Ky(r.ownerDocument.documentElement,r)){if(s!==null&&mf(r)){if(e=s.start,t=s.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var n=r.textContent.length,o=Math.min(s.start,n);s=s.end===void 0?o:Math.min(s.end,n),!t.extend&&o>s&&(n=s,s=o,o=n),n=Ym(r,o);var i=Ym(r,s);n&&i&&(t.rangeCount!==1||t.anchorNode!==n.node||t.anchorOffset!==n.offset||t.focusNode!==i.node||t.focusOffset!==i.offset)&&(e=e.createRange(),e.setStart(n.node,n.offset),t.removeAllRanges(),o>s?(t.addRange(e),t.extend(i.node,i.offset)):(e.setEnd(i.node,i.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var uw=Zs&&"documentMode"in document&&11>=document.documentMode,Bo=null,Zu=null,Za=null,Xu=!1;function Qm(t,e,r){var s=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Xu||Bo==null||Bo!==uc(s)||(s=Bo,"selectionStart"in s&&mf(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),Za&&vi(Za,s)||(Za=s,s=yc(Zu,"onSelect"),0<s.length&&(e=new uf("onSelect","select",null,e,r),t.push({event:e,listeners:s}),e.target=Bo)))}function dl(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var Ho={animationend:dl("Animation","AnimationEnd"),animationiteration:dl("Animation","AnimationIteration"),animationstart:dl("Animation","AnimationStart"),transitionend:dl("Transition","TransitionEnd")},Fd={},Qy={};Zs&&(Qy=document.createElement("div").style,"AnimationEvent"in window||(delete Ho.animationend.animation,delete Ho.animationiteration.animation,delete Ho.animationstart.animation),"TransitionEvent"in window||delete Ho.transitionend.transition);function ad(t){if(Fd[t])return Fd[t];if(!Ho[t])return t;var e=Ho[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in Qy)return Fd[t]=e[r];return t}var Zy=ad("animationend"),Xy=ad("animationiteration"),e1=ad("animationstart"),t1=ad("transitionend"),r1=new Map,Zm="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Rn(t,e){r1.set(t,e),bo(e,[t])}for(var Bd=0;Bd<Zm.length;Bd++){var Hd=Zm[Bd],hw=Hd.toLowerCase(),fw=Hd[0].toUpperCase()+Hd.slice(1);Rn(hw,"on"+fw)}Rn(Zy,"onAnimationEnd");Rn(Xy,"onAnimationIteration");Rn(e1,"onAnimationStart");Rn("dblclick","onDoubleClick");Rn("focusin","onFocus");Rn("focusout","onBlur");Rn(t1,"onTransitionEnd");na("onMouseEnter",["mouseout","mouseover"]);na("onMouseLeave",["mouseout","mouseover"]);na("onPointerEnter",["pointerout","pointerover"]);na("onPointerLeave",["pointerout","pointerover"]);bo("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));bo("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));bo("onBeforeInput",["compositionend","keypress","textInput","paste"]);bo("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));bo("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));bo("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Fa="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mw=new Set("cancel close invalid load scroll toggle".split(" ").concat(Fa));function Xm(t,e,r){var s=t.type||"unknown-event";t.currentTarget=r,hb(s,e,void 0,t),t.currentTarget=null}function s1(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var s=t[r],n=s.event;s=s.listeners;e:{var o=void 0;if(e)for(var i=s.length-1;0<=i;i--){var l=s[i],c=l.instance,d=l.currentTarget;if(l=l.listener,c!==o&&n.isPropagationStopped())break e;Xm(n,l,d),o=c}else for(i=0;i<s.length;i++){if(l=s[i],c=l.instance,d=l.currentTarget,l=l.listener,c!==o&&n.isPropagationStopped())break e;Xm(n,l,d),o=c}}}if(fc)throw t=Ju,fc=!1,Ju=null,t}function pt(t,e){var r=e[nh];r===void 0&&(r=e[nh]=new Set);var s=t+"__bubble";r.has(s)||(n1(e,t,2,!1),r.add(s))}function Vd(t,e,r){var s=0;e&&(s|=4),n1(r,t,s,e)}var ul="_reactListening"+Math.random().toString(36).slice(2);function xi(t){if(!t[ul]){t[ul]=!0,uy.forEach(function(r){r!=="selectionchange"&&(mw.has(r)||Vd(r,!1,t),Vd(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[ul]||(e[ul]=!0,Vd("selectionchange",!1,e))}}function n1(t,e,r,s){switch(Hy(e)){case 1:var n=Ib;break;case 4:n=Eb;break;default:n=cf}r=n.bind(null,e,r,t),n=void 0,!Gu||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(n=!0),s?n!==void 0?t.addEventListener(e,r,{capture:!0,passive:n}):t.addEventListener(e,r,!0):n!==void 0?t.addEventListener(e,r,{passive:n}):t.addEventListener(e,r,!1)}function zd(t,e,r,s,n){var o=s;if(!(e&1)&&!(e&2)&&s!==null)e:for(;;){if(s===null)return;var i=s.tag;if(i===3||i===4){var l=s.stateNode.containerInfo;if(l===n||l.nodeType===8&&l.parentNode===n)break;if(i===4)for(i=s.return;i!==null;){var c=i.tag;if((c===3||c===4)&&(c=i.stateNode.containerInfo,c===n||c.nodeType===8&&c.parentNode===n))return;i=i.return}for(;l!==null;){if(i=no(l),i===null)return;if(c=i.tag,c===5||c===6){s=o=i;continue e}l=l.parentNode}}s=s.return}Ny(function(){var d=o,u=nf(r),h=[];e:{var f=r1.get(t);if(f!==void 0){var p=uf,g=t;switch(t){case"keypress":if(Xl(r)===0)break e;case"keydown":case"keyup":p=Ub;break;case"focusin":g="focus",p=Od;break;case"focusout":g="blur",p=Od;break;case"beforeblur":case"afterblur":p=Od;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=Hm;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=Lb;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=Gb;break;case Zy:case Xy:case e1:p=Rb;break;case t1:p=Kb;break;case"scroll":p=Tb;break;case"wheel":p=Qb;break;case"copy":case"cut":case"paste":p=Pb;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=zm}var y=(e&4)!==0,x=!y&&t==="scroll",m=y?f!==null?f+"Capture":null:f;y=[];for(var _=d,v;_!==null;){v=_;var w=v.stateNode;if(v.tag===5&&w!==null&&(v=w,m!==null&&(w=mi(_,m),w!=null&&y.push(bi(_,w,v)))),x)break;_=_.return}0<y.length&&(f=new p(f,g,null,r,u),h.push({event:f,listeners:y}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",p=t==="mouseout"||t==="pointerout",f&&r!==Wu&&(g=r.relatedTarget||r.fromElement)&&(no(g)||g[Xs]))break e;if((p||f)&&(f=u.window===u?u:(f=u.ownerDocument)?f.defaultView||f.parentWindow:window,p?(g=r.relatedTarget||r.toElement,p=d,g=g?no(g):null,g!==null&&(x=wo(g),g!==x||g.tag!==5&&g.tag!==6)&&(g=null)):(p=null,g=d),p!==g)){if(y=Hm,w="onMouseLeave",m="onMouseEnter",_="mouse",(t==="pointerout"||t==="pointerover")&&(y=zm,w="onPointerLeave",m="onPointerEnter",_="pointer"),x=p==null?f:Vo(p),v=g==null?f:Vo(g),f=new y(w,_+"leave",p,r,u),f.target=x,f.relatedTarget=v,w=null,no(u)===d&&(y=new y(m,_+"enter",g,r,u),y.target=v,y.relatedTarget=x,w=y),x=w,p&&g)t:{for(y=p,m=g,_=0,v=y;v;v=Co(v))_++;for(v=0,w=m;w;w=Co(w))v++;for(;0<_-v;)y=Co(y),_--;for(;0<v-_;)m=Co(m),v--;for(;_--;){if(y===m||m!==null&&y===m.alternate)break t;y=Co(y),m=Co(m)}y=null}else y=null;p!==null&&ep(h,f,p,y,!1),g!==null&&x!==null&&ep(h,x,g,y,!0)}}e:{if(f=d?Vo(d):window,p=f.nodeName&&f.nodeName.toLowerCase(),p==="select"||p==="input"&&f.type==="file")var S=nw;else if(qm(f))if(Gy)S=lw;else{S=aw;var E=ow}else(p=f.nodeName)&&p.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(S=iw);if(S&&(S=S(t,d))){qy(h,S,r,u);break e}E&&E(t,f,d),t==="focusout"&&(E=f._wrapperState)&&E.controlled&&f.type==="number"&&Bu(f,"number",f.value)}switch(E=d?Vo(d):window,t){case"focusin":(qm(E)||E.contentEditable==="true")&&(Bo=E,Zu=d,Za=null);break;case"focusout":Za=Zu=Bo=null;break;case"mousedown":Xu=!0;break;case"contextmenu":case"mouseup":case"dragend":Xu=!1,Qm(h,r,u);break;case"selectionchange":if(uw)break;case"keydown":case"keyup":Qm(h,r,u)}var C;if(ff)e:{switch(t){case"compositionstart":var k="onCompositionStart";break e;case"compositionend":k="onCompositionEnd";break e;case"compositionupdate":k="onCompositionUpdate";break e}k=void 0}else Fo?Uy(t,r)&&(k="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(k="onCompositionStart");k&&(zy&&r.locale!=="ko"&&(Fo||k!=="onCompositionStart"?k==="onCompositionEnd"&&Fo&&(C=Vy()):(gn=u,df="value"in gn?gn.value:gn.textContent,Fo=!0)),E=yc(d,k),0<E.length&&(k=new Vm(k,t,null,r,u),h.push({event:k,listeners:E}),C?k.data=C:(C=Wy(r),C!==null&&(k.data=C)))),(C=Xb?ew(t,r):tw(t,r))&&(d=yc(d,"onBeforeInput"),0<d.length&&(u=new Vm("onBeforeInput","beforeinput",null,r,u),h.push({event:u,listeners:d}),u.data=C))}s1(h,e)})}function bi(t,e,r){return{instance:t,listener:e,currentTarget:r}}function yc(t,e){for(var r=e+"Capture",s=[];t!==null;){var n=t,o=n.stateNode;n.tag===5&&o!==null&&(n=o,o=mi(t,r),o!=null&&s.unshift(bi(t,o,n)),o=mi(t,e),o!=null&&s.push(bi(t,o,n))),t=t.return}return s}function Co(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function ep(t,e,r,s,n){for(var o=e._reactName,i=[];r!==null&&r!==s;){var l=r,c=l.alternate,d=l.stateNode;if(c!==null&&c===s)break;l.tag===5&&d!==null&&(l=d,n?(c=mi(r,o),c!=null&&i.unshift(bi(r,c,l))):n||(c=mi(r,o),c!=null&&i.push(bi(r,c,l)))),r=r.return}i.length!==0&&t.push({event:e,listeners:i})}var pw=/\r\n?/g,gw=/\u0000|\uFFFD/g;function tp(t){return(typeof t=="string"?t:""+t).replace(pw,`
`).replace(gw,"")}function hl(t,e,r){if(e=tp(e),tp(t)!==e&&r)throw Error(q(425))}function vc(){}var eh=null,th=null;function rh(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var sh=typeof setTimeout=="function"?setTimeout:void 0,_w=typeof clearTimeout=="function"?clearTimeout:void 0,rp=typeof Promise=="function"?Promise:void 0,yw=typeof queueMicrotask=="function"?queueMicrotask:typeof rp<"u"?function(t){return rp.resolve(null).then(t).catch(vw)}:sh;function vw(t){setTimeout(function(){throw t})}function Ud(t,e){var r=e,s=0;do{var n=r.nextSibling;if(t.removeChild(r),n&&n.nodeType===8)if(r=n.data,r==="/$"){if(s===0){t.removeChild(n),_i(e);return}s--}else r!=="$"&&r!=="$?"&&r!=="$!"||s++;r=n}while(r);_i(e)}function kn(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function sp(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var pa=Math.random().toString(36).slice(2),$s="__reactFiber$"+pa,wi="__reactProps$"+pa,Xs="__reactContainer$"+pa,nh="__reactEvents$"+pa,xw="__reactListeners$"+pa,bw="__reactHandles$"+pa;function no(t){var e=t[$s];if(e)return e;for(var r=t.parentNode;r;){if(e=r[Xs]||r[$s]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=sp(t);t!==null;){if(r=t[$s])return r;t=sp(t)}return e}t=r,r=t.parentNode}return null}function Ui(t){return t=t[$s]||t[Xs],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Vo(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(q(33))}function id(t){return t[wi]||null}var oh=[],zo=-1;function On(t){return{current:t}}function yt(t){0>zo||(t.current=oh[zo],oh[zo]=null,zo--)}function ut(t,e){zo++,oh[zo]=t.current,t.current=e}var Dn={},Sr=On(Dn),Gr=On(!1),mo=Dn;function oa(t,e){var r=t.type.contextTypes;if(!r)return Dn;var s=t.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===e)return s.__reactInternalMemoizedMaskedChildContext;var n={},o;for(o in r)n[o]=e[o];return s&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=n),n}function Jr(t){return t=t.childContextTypes,t!=null}function xc(){yt(Gr),yt(Sr)}function np(t,e,r){if(Sr.current!==Dn)throw Error(q(168));ut(Sr,e),ut(Gr,r)}function o1(t,e,r){var s=t.stateNode;if(e=e.childContextTypes,typeof s.getChildContext!="function")return r;s=s.getChildContext();for(var n in s)if(!(n in e))throw Error(q(108,ob(t)||"Unknown",n));return Tt({},r,s)}function bc(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Dn,mo=Sr.current,ut(Sr,t),ut(Gr,Gr.current),!0}function op(t,e,r){var s=t.stateNode;if(!s)throw Error(q(169));r?(t=o1(t,e,mo),s.__reactInternalMemoizedMergedChildContext=t,yt(Gr),yt(Sr),ut(Sr,t)):yt(Gr),ut(Gr,r)}var Gs=null,ld=!1,Wd=!1;function a1(t){Gs===null?Gs=[t]:Gs.push(t)}function ww(t){ld=!0,a1(t)}function Pn(){if(!Wd&&Gs!==null){Wd=!0;var t=0,e=et;try{var r=Gs;for(et=1;t<r.length;t++){var s=r[t];do s=s(!0);while(s!==null)}Gs=null,ld=!1}catch(n){throw Gs!==null&&(Gs=Gs.slice(t+1)),Ay(of,Pn),n}finally{et=e,Wd=!1}}return null}var Uo=[],Wo=0,wc=null,Sc=0,cs=[],ds=0,po=null,Ks=1,Ys="";function Yn(t,e){Uo[Wo++]=Sc,Uo[Wo++]=wc,wc=t,Sc=e}function i1(t,e,r){cs[ds++]=Ks,cs[ds++]=Ys,cs[ds++]=po,po=t;var s=Ks;t=Ys;var n=32-js(s)-1;s&=~(1<<n),r+=1;var o=32-js(e)+n;if(30<o){var i=n-n%5;o=(s&(1<<i)-1).toString(32),s>>=i,n-=i,Ks=1<<32-js(e)+n|r<<n|s,Ys=o+t}else Ks=1<<o|r<<n|s,Ys=t}function pf(t){t.return!==null&&(Yn(t,1),i1(t,1,0))}function gf(t){for(;t===wc;)wc=Uo[--Wo],Uo[Wo]=null,Sc=Uo[--Wo],Uo[Wo]=null;for(;t===po;)po=cs[--ds],cs[ds]=null,Ys=cs[--ds],cs[ds]=null,Ks=cs[--ds],cs[ds]=null}var rs=null,ts=null,wt=!1,Cs=null;function l1(t,e){var r=us(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function ap(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,rs=t,ts=kn(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,rs=t,ts=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=po!==null?{id:Ks,overflow:Ys}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=us(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,rs=t,ts=null,!0):!1;default:return!1}}function ah(t){return(t.mode&1)!==0&&(t.flags&128)===0}function ih(t){if(wt){var e=ts;if(e){var r=e;if(!ap(t,e)){if(ah(t))throw Error(q(418));e=kn(r.nextSibling);var s=rs;e&&ap(t,e)?l1(s,r):(t.flags=t.flags&-4097|2,wt=!1,rs=t)}}else{if(ah(t))throw Error(q(418));t.flags=t.flags&-4097|2,wt=!1,rs=t}}}function ip(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;rs=t}function fl(t){if(t!==rs)return!1;if(!wt)return ip(t),wt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!rh(t.type,t.memoizedProps)),e&&(e=ts)){if(ah(t))throw c1(),Error(q(418));for(;e;)l1(t,e),e=kn(e.nextSibling)}if(ip(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(q(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){ts=kn(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}ts=null}}else ts=rs?kn(t.stateNode.nextSibling):null;return!0}function c1(){for(var t=ts;t;)t=kn(t.nextSibling)}function aa(){ts=rs=null,wt=!1}function _f(t){Cs===null?Cs=[t]:Cs.push(t)}var Sw=sn.ReactCurrentBatchConfig;function Ia(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(q(309));var s=r.stateNode}if(!s)throw Error(q(147,t));var n=s,o=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===o?e.ref:(e=function(i){var l=n.refs;i===null?delete l[o]:l[o]=i},e._stringRef=o,e)}if(typeof t!="string")throw Error(q(284));if(!r._owner)throw Error(q(290,t))}return t}function ml(t,e){throw t=Object.prototype.toString.call(e),Error(q(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function lp(t){var e=t._init;return e(t._payload)}function d1(t){function e(m,_){if(t){var v=m.deletions;v===null?(m.deletions=[_],m.flags|=16):v.push(_)}}function r(m,_){if(!t)return null;for(;_!==null;)e(m,_),_=_.sibling;return null}function s(m,_){for(m=new Map;_!==null;)_.key!==null?m.set(_.key,_):m.set(_.index,_),_=_.sibling;return m}function n(m,_){return m=Tn(m,_),m.index=0,m.sibling=null,m}function o(m,_,v){return m.index=v,t?(v=m.alternate,v!==null?(v=v.index,v<_?(m.flags|=2,_):v):(m.flags|=2,_)):(m.flags|=1048576,_)}function i(m){return t&&m.alternate===null&&(m.flags|=2),m}function l(m,_,v,w){return _===null||_.tag!==6?(_=Zd(v,m.mode,w),_.return=m,_):(_=n(_,v),_.return=m,_)}function c(m,_,v,w){var S=v.type;return S===$o?u(m,_,v.props.children,w,v.key):_!==null&&(_.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===dn&&lp(S)===_.type)?(w=n(_,v.props),w.ref=Ia(m,_,v),w.return=m,w):(w=ac(v.type,v.key,v.props,null,m.mode,w),w.ref=Ia(m,_,v),w.return=m,w)}function d(m,_,v,w){return _===null||_.tag!==4||_.stateNode.containerInfo!==v.containerInfo||_.stateNode.implementation!==v.implementation?(_=Xd(v,m.mode,w),_.return=m,_):(_=n(_,v.children||[]),_.return=m,_)}function u(m,_,v,w,S){return _===null||_.tag!==7?(_=uo(v,m.mode,w,S),_.return=m,_):(_=n(_,v),_.return=m,_)}function h(m,_,v){if(typeof _=="string"&&_!==""||typeof _=="number")return _=Zd(""+_,m.mode,v),_.return=m,_;if(typeof _=="object"&&_!==null){switch(_.$$typeof){case sl:return v=ac(_.type,_.key,_.props,null,m.mode,v),v.ref=Ia(m,null,_),v.return=m,v;case Po:return _=Xd(_,m.mode,v),_.return=m,_;case dn:var w=_._init;return h(m,w(_._payload),v)}if(Pa(_)||Sa(_))return _=uo(_,m.mode,v,null),_.return=m,_;ml(m,_)}return null}function f(m,_,v,w){var S=_!==null?_.key:null;if(typeof v=="string"&&v!==""||typeof v=="number")return S!==null?null:l(m,_,""+v,w);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case sl:return v.key===S?c(m,_,v,w):null;case Po:return v.key===S?d(m,_,v,w):null;case dn:return S=v._init,f(m,_,S(v._payload),w)}if(Pa(v)||Sa(v))return S!==null?null:u(m,_,v,w,null);ml(m,v)}return null}function p(m,_,v,w,S){if(typeof w=="string"&&w!==""||typeof w=="number")return m=m.get(v)||null,l(_,m,""+w,S);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case sl:return m=m.get(w.key===null?v:w.key)||null,c(_,m,w,S);case Po:return m=m.get(w.key===null?v:w.key)||null,d(_,m,w,S);case dn:var E=w._init;return p(m,_,v,E(w._payload),S)}if(Pa(w)||Sa(w))return m=m.get(v)||null,u(_,m,w,S,null);ml(_,w)}return null}function g(m,_,v,w){for(var S=null,E=null,C=_,k=_=0,N=null;C!==null&&k<v.length;k++){C.index>k?(N=C,C=null):N=C.sibling;var I=f(m,C,v[k],w);if(I===null){C===null&&(C=N);break}t&&C&&I.alternate===null&&e(m,C),_=o(I,_,k),E===null?S=I:E.sibling=I,E=I,C=N}if(k===v.length)return r(m,C),wt&&Yn(m,k),S;if(C===null){for(;k<v.length;k++)C=h(m,v[k],w),C!==null&&(_=o(C,_,k),E===null?S=C:E.sibling=C,E=C);return wt&&Yn(m,k),S}for(C=s(m,C);k<v.length;k++)N=p(C,m,k,v[k],w),N!==null&&(t&&N.alternate!==null&&C.delete(N.key===null?k:N.key),_=o(N,_,k),E===null?S=N:E.sibling=N,E=N);return t&&C.forEach(function(L){return e(m,L)}),wt&&Yn(m,k),S}function y(m,_,v,w){var S=Sa(v);if(typeof S!="function")throw Error(q(150));if(v=S.call(v),v==null)throw Error(q(151));for(var E=S=null,C=_,k=_=0,N=null,I=v.next();C!==null&&!I.done;k++,I=v.next()){C.index>k?(N=C,C=null):N=C.sibling;var L=f(m,C,I.value,w);if(L===null){C===null&&(C=N);break}t&&C&&L.alternate===null&&e(m,C),_=o(L,_,k),E===null?S=L:E.sibling=L,E=L,C=N}if(I.done)return r(m,C),wt&&Yn(m,k),S;if(C===null){for(;!I.done;k++,I=v.next())I=h(m,I.value,w),I!==null&&(_=o(I,_,k),E===null?S=I:E.sibling=I,E=I);return wt&&Yn(m,k),S}for(C=s(m,C);!I.done;k++,I=v.next())I=p(C,m,k,I.value,w),I!==null&&(t&&I.alternate!==null&&C.delete(I.key===null?k:I.key),_=o(I,_,k),E===null?S=I:E.sibling=I,E=I);return t&&C.forEach(function(T){return e(m,T)}),wt&&Yn(m,k),S}function x(m,_,v,w){if(typeof v=="object"&&v!==null&&v.type===$o&&v.key===null&&(v=v.props.children),typeof v=="object"&&v!==null){switch(v.$$typeof){case sl:e:{for(var S=v.key,E=_;E!==null;){if(E.key===S){if(S=v.type,S===$o){if(E.tag===7){r(m,E.sibling),_=n(E,v.props.children),_.return=m,m=_;break e}}else if(E.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===dn&&lp(S)===E.type){r(m,E.sibling),_=n(E,v.props),_.ref=Ia(m,E,v),_.return=m,m=_;break e}r(m,E);break}else e(m,E);E=E.sibling}v.type===$o?(_=uo(v.props.children,m.mode,w,v.key),_.return=m,m=_):(w=ac(v.type,v.key,v.props,null,m.mode,w),w.ref=Ia(m,_,v),w.return=m,m=w)}return i(m);case Po:e:{for(E=v.key;_!==null;){if(_.key===E)if(_.tag===4&&_.stateNode.containerInfo===v.containerInfo&&_.stateNode.implementation===v.implementation){r(m,_.sibling),_=n(_,v.children||[]),_.return=m,m=_;break e}else{r(m,_);break}else e(m,_);_=_.sibling}_=Xd(v,m.mode,w),_.return=m,m=_}return i(m);case dn:return E=v._init,x(m,_,E(v._payload),w)}if(Pa(v))return g(m,_,v,w);if(Sa(v))return y(m,_,v,w);ml(m,v)}return typeof v=="string"&&v!==""||typeof v=="number"?(v=""+v,_!==null&&_.tag===6?(r(m,_.sibling),_=n(_,v),_.return=m,m=_):(r(m,_),_=Zd(v,m.mode,w),_.return=m,m=_),i(m)):r(m,_)}return x}var ia=d1(!0),u1=d1(!1),Cc=On(null),jc=null,qo=null,yf=null;function vf(){yf=qo=jc=null}function xf(t){var e=Cc.current;yt(Cc),t._currentValue=e}function lh(t,e,r){for(;t!==null;){var s=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,s!==null&&(s.childLanes|=e)):s!==null&&(s.childLanes&e)!==e&&(s.childLanes|=e),t===r)break;t=t.return}}function Xo(t,e){jc=t,yf=qo=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Wr=!0),t.firstContext=null)}function ms(t){var e=t._currentValue;if(yf!==t)if(t={context:t,memoizedValue:e,next:null},qo===null){if(jc===null)throw Error(q(308));qo=t,jc.dependencies={lanes:0,firstContext:t}}else qo=qo.next=t;return e}var oo=null;function bf(t){oo===null?oo=[t]:oo.push(t)}function h1(t,e,r,s){var n=e.interleaved;return n===null?(r.next=r,bf(e)):(r.next=n.next,n.next=r),e.interleaved=r,en(t,s)}function en(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var un=!1;function wf(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function f1(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Qs(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Nn(t,e,r){var s=t.updateQueue;if(s===null)return null;if(s=s.shared,qe&2){var n=s.pending;return n===null?e.next=e:(e.next=n.next,n.next=e),s.pending=e,en(t,r)}return n=s.interleaved,n===null?(e.next=e,bf(s)):(e.next=n.next,n.next=e),s.interleaved=e,en(t,r)}function ec(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var s=e.lanes;s&=t.pendingLanes,r|=s,e.lanes=r,af(t,r)}}function cp(t,e){var r=t.updateQueue,s=t.alternate;if(s!==null&&(s=s.updateQueue,r===s)){var n=null,o=null;if(r=r.firstBaseUpdate,r!==null){do{var i={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};o===null?n=o=i:o=o.next=i,r=r.next}while(r!==null);o===null?n=o=e:o=o.next=e}else n=o=e;r={baseState:s.baseState,firstBaseUpdate:n,lastBaseUpdate:o,shared:s.shared,effects:s.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function kc(t,e,r,s){var n=t.updateQueue;un=!1;var o=n.firstBaseUpdate,i=n.lastBaseUpdate,l=n.shared.pending;if(l!==null){n.shared.pending=null;var c=l,d=c.next;c.next=null,i===null?o=d:i.next=d,i=c;var u=t.alternate;u!==null&&(u=u.updateQueue,l=u.lastBaseUpdate,l!==i&&(l===null?u.firstBaseUpdate=d:l.next=d,u.lastBaseUpdate=c))}if(o!==null){var h=n.baseState;i=0,u=d=c=null,l=o;do{var f=l.lane,p=l.eventTime;if((s&f)===f){u!==null&&(u=u.next={eventTime:p,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var g=t,y=l;switch(f=e,p=r,y.tag){case 1:if(g=y.payload,typeof g=="function"){h=g.call(p,h,f);break e}h=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=y.payload,f=typeof g=="function"?g.call(p,h,f):g,f==null)break e;h=Tt({},h,f);break e;case 2:un=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,f=n.effects,f===null?n.effects=[l]:f.push(l))}else p={eventTime:p,lane:f,tag:l.tag,payload:l.payload,callback:l.callback,next:null},u===null?(d=u=p,c=h):u=u.next=p,i|=f;if(l=l.next,l===null){if(l=n.shared.pending,l===null)break;f=l,l=f.next,f.next=null,n.lastBaseUpdate=f,n.shared.pending=null}}while(!0);if(u===null&&(c=h),n.baseState=c,n.firstBaseUpdate=d,n.lastBaseUpdate=u,e=n.shared.interleaved,e!==null){n=e;do i|=n.lane,n=n.next;while(n!==e)}else o===null&&(n.shared.lanes=0);_o|=i,t.lanes=i,t.memoizedState=h}}function dp(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var s=t[e],n=s.callback;if(n!==null){if(s.callback=null,s=r,typeof n!="function")throw Error(q(191,n));n.call(s)}}}var Wi={},Bs=On(Wi),Si=On(Wi),Ci=On(Wi);function ao(t){if(t===Wi)throw Error(q(174));return t}function Sf(t,e){switch(ut(Ci,e),ut(Si,t),ut(Bs,Wi),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Vu(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Vu(e,t)}yt(Bs),ut(Bs,e)}function la(){yt(Bs),yt(Si),yt(Ci)}function m1(t){ao(Ci.current);var e=ao(Bs.current),r=Vu(e,t.type);e!==r&&(ut(Si,t),ut(Bs,r))}function Cf(t){Si.current===t&&(yt(Bs),yt(Si))}var It=On(0);function Nc(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var qd=[];function jf(){for(var t=0;t<qd.length;t++)qd[t]._workInProgressVersionPrimary=null;qd.length=0}var tc=sn.ReactCurrentDispatcher,Gd=sn.ReactCurrentBatchConfig,go=0,Et=null,er=null,ar=null,Ic=!1,Xa=!1,ji=0,Cw=0;function pr(){throw Error(q(321))}function kf(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!Ns(t[r],e[r]))return!1;return!0}function Nf(t,e,r,s,n,o){if(go=o,Et=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,tc.current=t===null||t.memoizedState===null?Iw:Ew,t=r(s,n),Xa){o=0;do{if(Xa=!1,ji=0,25<=o)throw Error(q(301));o+=1,ar=er=null,e.updateQueue=null,tc.current=Tw,t=r(s,n)}while(Xa)}if(tc.current=Ec,e=er!==null&&er.next!==null,go=0,ar=er=Et=null,Ic=!1,e)throw Error(q(300));return t}function If(){var t=ji!==0;return ji=0,t}function Rs(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ar===null?Et.memoizedState=ar=t:ar=ar.next=t,ar}function ps(){if(er===null){var t=Et.alternate;t=t!==null?t.memoizedState:null}else t=er.next;var e=ar===null?Et.memoizedState:ar.next;if(e!==null)ar=e,er=t;else{if(t===null)throw Error(q(310));er=t,t={memoizedState:er.memoizedState,baseState:er.baseState,baseQueue:er.baseQueue,queue:er.queue,next:null},ar===null?Et.memoizedState=ar=t:ar=ar.next=t}return ar}function ki(t,e){return typeof e=="function"?e(t):e}function Jd(t){var e=ps(),r=e.queue;if(r===null)throw Error(q(311));r.lastRenderedReducer=t;var s=er,n=s.baseQueue,o=r.pending;if(o!==null){if(n!==null){var i=n.next;n.next=o.next,o.next=i}s.baseQueue=n=o,r.pending=null}if(n!==null){o=n.next,s=s.baseState;var l=i=null,c=null,d=o;do{var u=d.lane;if((go&u)===u)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),s=d.hasEagerState?d.eagerState:t(s,d.action);else{var h={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(l=c=h,i=s):c=c.next=h,Et.lanes|=u,_o|=u}d=d.next}while(d!==null&&d!==o);c===null?i=s:c.next=l,Ns(s,e.memoizedState)||(Wr=!0),e.memoizedState=s,e.baseState=i,e.baseQueue=c,r.lastRenderedState=s}if(t=r.interleaved,t!==null){n=t;do o=n.lane,Et.lanes|=o,_o|=o,n=n.next;while(n!==t)}else n===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function Kd(t){var e=ps(),r=e.queue;if(r===null)throw Error(q(311));r.lastRenderedReducer=t;var s=r.dispatch,n=r.pending,o=e.memoizedState;if(n!==null){r.pending=null;var i=n=n.next;do o=t(o,i.action),i=i.next;while(i!==n);Ns(o,e.memoizedState)||(Wr=!0),e.memoizedState=o,e.baseQueue===null&&(e.baseState=o),r.lastRenderedState=o}return[o,s]}function p1(){}function g1(t,e){var r=Et,s=ps(),n=e(),o=!Ns(s.memoizedState,n);if(o&&(s.memoizedState=n,Wr=!0),s=s.queue,Ef(v1.bind(null,r,s,t),[t]),s.getSnapshot!==e||o||ar!==null&&ar.memoizedState.tag&1){if(r.flags|=2048,Ni(9,y1.bind(null,r,s,n,e),void 0,null),lr===null)throw Error(q(349));go&30||_1(r,e,n)}return n}function _1(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=Et.updateQueue,e===null?(e={lastEffect:null,stores:null},Et.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function y1(t,e,r,s){e.value=r,e.getSnapshot=s,x1(e)&&b1(t)}function v1(t,e,r){return r(function(){x1(e)&&b1(t)})}function x1(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!Ns(t,r)}catch{return!0}}function b1(t){var e=en(t,1);e!==null&&ks(e,t,1,-1)}function up(t){var e=Rs();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ki,lastRenderedState:t},e.queue=t,t=t.dispatch=Nw.bind(null,Et,t),[e.memoizedState,t]}function Ni(t,e,r,s){return t={tag:t,create:e,destroy:r,deps:s,next:null},e=Et.updateQueue,e===null?(e={lastEffect:null,stores:null},Et.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(s=r.next,r.next=t,t.next=s,e.lastEffect=t)),t}function w1(){return ps().memoizedState}function rc(t,e,r,s){var n=Rs();Et.flags|=t,n.memoizedState=Ni(1|e,r,void 0,s===void 0?null:s)}function cd(t,e,r,s){var n=ps();s=s===void 0?null:s;var o=void 0;if(er!==null){var i=er.memoizedState;if(o=i.destroy,s!==null&&kf(s,i.deps)){n.memoizedState=Ni(e,r,o,s);return}}Et.flags|=t,n.memoizedState=Ni(1|e,r,o,s)}function hp(t,e){return rc(8390656,8,t,e)}function Ef(t,e){return cd(2048,8,t,e)}function S1(t,e){return cd(4,2,t,e)}function C1(t,e){return cd(4,4,t,e)}function j1(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function k1(t,e,r){return r=r!=null?r.concat([t]):null,cd(4,4,j1.bind(null,e,t),r)}function Tf(){}function N1(t,e){var r=ps();e=e===void 0?null:e;var s=r.memoizedState;return s!==null&&e!==null&&kf(e,s[1])?s[0]:(r.memoizedState=[t,e],t)}function I1(t,e){var r=ps();e=e===void 0?null:e;var s=r.memoizedState;return s!==null&&e!==null&&kf(e,s[1])?s[0]:(t=t(),r.memoizedState=[t,e],t)}function E1(t,e,r){return go&21?(Ns(r,e)||(r=My(),Et.lanes|=r,_o|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Wr=!0),t.memoizedState=r)}function jw(t,e){var r=et;et=r!==0&&4>r?r:4,t(!0);var s=Gd.transition;Gd.transition={};try{t(!1),e()}finally{et=r,Gd.transition=s}}function T1(){return ps().memoizedState}function kw(t,e,r){var s=En(t);if(r={lane:s,action:r,hasEagerState:!1,eagerState:null,next:null},A1(t))L1(e,r);else if(r=h1(t,e,r,s),r!==null){var n=Lr();ks(r,t,s,n),D1(r,e,s)}}function Nw(t,e,r){var s=En(t),n={lane:s,action:r,hasEagerState:!1,eagerState:null,next:null};if(A1(t))L1(e,n);else{var o=t.alternate;if(t.lanes===0&&(o===null||o.lanes===0)&&(o=e.lastRenderedReducer,o!==null))try{var i=e.lastRenderedState,l=o(i,r);if(n.hasEagerState=!0,n.eagerState=l,Ns(l,i)){var c=e.interleaved;c===null?(n.next=n,bf(e)):(n.next=c.next,c.next=n),e.interleaved=n;return}}catch{}finally{}r=h1(t,e,n,s),r!==null&&(n=Lr(),ks(r,t,s,n),D1(r,e,s))}}function A1(t){var e=t.alternate;return t===Et||e!==null&&e===Et}function L1(t,e){Xa=Ic=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function D1(t,e,r){if(r&4194240){var s=e.lanes;s&=t.pendingLanes,r|=s,e.lanes=r,af(t,r)}}var Ec={readContext:ms,useCallback:pr,useContext:pr,useEffect:pr,useImperativeHandle:pr,useInsertionEffect:pr,useLayoutEffect:pr,useMemo:pr,useReducer:pr,useRef:pr,useState:pr,useDebugValue:pr,useDeferredValue:pr,useTransition:pr,useMutableSource:pr,useSyncExternalStore:pr,useId:pr,unstable_isNewReconciler:!1},Iw={readContext:ms,useCallback:function(t,e){return Rs().memoizedState=[t,e===void 0?null:e],t},useContext:ms,useEffect:hp,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,rc(4194308,4,j1.bind(null,e,t),r)},useLayoutEffect:function(t,e){return rc(4194308,4,t,e)},useInsertionEffect:function(t,e){return rc(4,2,t,e)},useMemo:function(t,e){var r=Rs();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var s=Rs();return e=r!==void 0?r(e):e,s.memoizedState=s.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},s.queue=t,t=t.dispatch=kw.bind(null,Et,t),[s.memoizedState,t]},useRef:function(t){var e=Rs();return t={current:t},e.memoizedState=t},useState:up,useDebugValue:Tf,useDeferredValue:function(t){return Rs().memoizedState=t},useTransition:function(){var t=up(!1),e=t[0];return t=jw.bind(null,t[1]),Rs().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var s=Et,n=Rs();if(wt){if(r===void 0)throw Error(q(407));r=r()}else{if(r=e(),lr===null)throw Error(q(349));go&30||_1(s,e,r)}n.memoizedState=r;var o={value:r,getSnapshot:e};return n.queue=o,hp(v1.bind(null,s,o,t),[t]),s.flags|=2048,Ni(9,y1.bind(null,s,o,r,e),void 0,null),r},useId:function(){var t=Rs(),e=lr.identifierPrefix;if(wt){var r=Ys,s=Ks;r=(s&~(1<<32-js(s)-1)).toString(32)+r,e=":"+e+"R"+r,r=ji++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=Cw++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},Ew={readContext:ms,useCallback:N1,useContext:ms,useEffect:Ef,useImperativeHandle:k1,useInsertionEffect:S1,useLayoutEffect:C1,useMemo:I1,useReducer:Jd,useRef:w1,useState:function(){return Jd(ki)},useDebugValue:Tf,useDeferredValue:function(t){var e=ps();return E1(e,er.memoizedState,t)},useTransition:function(){var t=Jd(ki)[0],e=ps().memoizedState;return[t,e]},useMutableSource:p1,useSyncExternalStore:g1,useId:T1,unstable_isNewReconciler:!1},Tw={readContext:ms,useCallback:N1,useContext:ms,useEffect:Ef,useImperativeHandle:k1,useInsertionEffect:S1,useLayoutEffect:C1,useMemo:I1,useReducer:Kd,useRef:w1,useState:function(){return Kd(ki)},useDebugValue:Tf,useDeferredValue:function(t){var e=ps();return er===null?e.memoizedState=t:E1(e,er.memoizedState,t)},useTransition:function(){var t=Kd(ki)[0],e=ps().memoizedState;return[t,e]},useMutableSource:p1,useSyncExternalStore:g1,useId:T1,unstable_isNewReconciler:!1};function xs(t,e){if(t&&t.defaultProps){e=Tt({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function ch(t,e,r,s){e=t.memoizedState,r=r(s,e),r=r==null?e:Tt({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var dd={isMounted:function(t){return(t=t._reactInternals)?wo(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var s=Lr(),n=En(t),o=Qs(s,n);o.payload=e,r!=null&&(o.callback=r),e=Nn(t,o,n),e!==null&&(ks(e,t,n,s),ec(e,t,n))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var s=Lr(),n=En(t),o=Qs(s,n);o.tag=1,o.payload=e,r!=null&&(o.callback=r),e=Nn(t,o,n),e!==null&&(ks(e,t,n,s),ec(e,t,n))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=Lr(),s=En(t),n=Qs(r,s);n.tag=2,e!=null&&(n.callback=e),e=Nn(t,n,s),e!==null&&(ks(e,t,s,r),ec(e,t,s))}};function fp(t,e,r,s,n,o,i){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(s,o,i):e.prototype&&e.prototype.isPureReactComponent?!vi(r,s)||!vi(n,o):!0}function M1(t,e,r){var s=!1,n=Dn,o=e.contextType;return typeof o=="object"&&o!==null?o=ms(o):(n=Jr(e)?mo:Sr.current,s=e.contextTypes,o=(s=s!=null)?oa(t,n):Dn),e=new e(r,o),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=dd,t.stateNode=e,e._reactInternals=t,s&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=n,t.__reactInternalMemoizedMaskedChildContext=o),e}function mp(t,e,r,s){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,s),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,s),e.state!==t&&dd.enqueueReplaceState(e,e.state,null)}function dh(t,e,r,s){var n=t.stateNode;n.props=r,n.state=t.memoizedState,n.refs={},wf(t);var o=e.contextType;typeof o=="object"&&o!==null?n.context=ms(o):(o=Jr(e)?mo:Sr.current,n.context=oa(t,o)),n.state=t.memoizedState,o=e.getDerivedStateFromProps,typeof o=="function"&&(ch(t,e,o,r),n.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof n.getSnapshotBeforeUpdate=="function"||typeof n.UNSAFE_componentWillMount!="function"&&typeof n.componentWillMount!="function"||(e=n.state,typeof n.componentWillMount=="function"&&n.componentWillMount(),typeof n.UNSAFE_componentWillMount=="function"&&n.UNSAFE_componentWillMount(),e!==n.state&&dd.enqueueReplaceState(n,n.state,null),kc(t,r,n,s),n.state=t.memoizedState),typeof n.componentDidMount=="function"&&(t.flags|=4194308)}function ca(t,e){try{var r="",s=e;do r+=nb(s),s=s.return;while(s);var n=r}catch(o){n=`
Error generating stack: `+o.message+`
`+o.stack}return{value:t,source:e,stack:n,digest:null}}function Yd(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function uh(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var Aw=typeof WeakMap=="function"?WeakMap:Map;function R1(t,e,r){r=Qs(-1,r),r.tag=3,r.payload={element:null};var s=e.value;return r.callback=function(){Ac||(Ac=!0,bh=s),uh(t,e)},r}function O1(t,e,r){r=Qs(-1,r),r.tag=3;var s=t.type.getDerivedStateFromError;if(typeof s=="function"){var n=e.value;r.payload=function(){return s(n)},r.callback=function(){uh(t,e)}}var o=t.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(r.callback=function(){uh(t,e),typeof s!="function"&&(In===null?In=new Set([this]):In.add(this));var i=e.stack;this.componentDidCatch(e.value,{componentStack:i!==null?i:""})}),r}function pp(t,e,r){var s=t.pingCache;if(s===null){s=t.pingCache=new Aw;var n=new Set;s.set(e,n)}else n=s.get(e),n===void 0&&(n=new Set,s.set(e,n));n.has(r)||(n.add(r),t=Ww.bind(null,t,e,r),e.then(t,t))}function gp(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function _p(t,e,r,s,n){return t.mode&1?(t.flags|=65536,t.lanes=n,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=Qs(-1,1),e.tag=2,Nn(r,e,1))),r.lanes|=1),t)}var Lw=sn.ReactCurrentOwner,Wr=!1;function Ir(t,e,r,s){e.child=t===null?u1(e,null,r,s):ia(e,t.child,r,s)}function yp(t,e,r,s,n){r=r.render;var o=e.ref;return Xo(e,n),s=Nf(t,e,r,s,o,n),r=If(),t!==null&&!Wr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~n,tn(t,e,n)):(wt&&r&&pf(e),e.flags|=1,Ir(t,e,s,n),e.child)}function vp(t,e,r,s,n){if(t===null){var o=r.type;return typeof o=="function"&&!$f(o)&&o.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=o,P1(t,e,o,s,n)):(t=ac(r.type,null,s,e,e.mode,n),t.ref=e.ref,t.return=e,e.child=t)}if(o=t.child,!(t.lanes&n)){var i=o.memoizedProps;if(r=r.compare,r=r!==null?r:vi,r(i,s)&&t.ref===e.ref)return tn(t,e,n)}return e.flags|=1,t=Tn(o,s),t.ref=e.ref,t.return=e,e.child=t}function P1(t,e,r,s,n){if(t!==null){var o=t.memoizedProps;if(vi(o,s)&&t.ref===e.ref)if(Wr=!1,e.pendingProps=s=o,(t.lanes&n)!==0)t.flags&131072&&(Wr=!0);else return e.lanes=t.lanes,tn(t,e,n)}return hh(t,e,r,s,n)}function $1(t,e,r){var s=e.pendingProps,n=s.children,o=t!==null?t.memoizedState:null;if(s.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ut(Jo,Zr),Zr|=r;else{if(!(r&1073741824))return t=o!==null?o.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,ut(Jo,Zr),Zr|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=o!==null?o.baseLanes:r,ut(Jo,Zr),Zr|=s}else o!==null?(s=o.baseLanes|r,e.memoizedState=null):s=r,ut(Jo,Zr),Zr|=s;return Ir(t,e,n,r),e.child}function F1(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function hh(t,e,r,s,n){var o=Jr(r)?mo:Sr.current;return o=oa(e,o),Xo(e,n),r=Nf(t,e,r,s,o,n),s=If(),t!==null&&!Wr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~n,tn(t,e,n)):(wt&&s&&pf(e),e.flags|=1,Ir(t,e,r,n),e.child)}function xp(t,e,r,s,n){if(Jr(r)){var o=!0;bc(e)}else o=!1;if(Xo(e,n),e.stateNode===null)sc(t,e),M1(e,r,s),dh(e,r,s,n),s=!0;else if(t===null){var i=e.stateNode,l=e.memoizedProps;i.props=l;var c=i.context,d=r.contextType;typeof d=="object"&&d!==null?d=ms(d):(d=Jr(r)?mo:Sr.current,d=oa(e,d));var u=r.getDerivedStateFromProps,h=typeof u=="function"||typeof i.getSnapshotBeforeUpdate=="function";h||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(l!==s||c!==d)&&mp(e,i,s,d),un=!1;var f=e.memoizedState;i.state=f,kc(e,s,i,n),c=e.memoizedState,l!==s||f!==c||Gr.current||un?(typeof u=="function"&&(ch(e,r,u,s),c=e.memoizedState),(l=un||fp(e,r,l,s,f,c,d))?(h||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(e.flags|=4194308)):(typeof i.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=s,e.memoizedState=c),i.props=s,i.state=c,i.context=d,s=l):(typeof i.componentDidMount=="function"&&(e.flags|=4194308),s=!1)}else{i=e.stateNode,f1(t,e),l=e.memoizedProps,d=e.type===e.elementType?l:xs(e.type,l),i.props=d,h=e.pendingProps,f=i.context,c=r.contextType,typeof c=="object"&&c!==null?c=ms(c):(c=Jr(r)?mo:Sr.current,c=oa(e,c));var p=r.getDerivedStateFromProps;(u=typeof p=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(l!==h||f!==c)&&mp(e,i,s,c),un=!1,f=e.memoizedState,i.state=f,kc(e,s,i,n);var g=e.memoizedState;l!==h||f!==g||Gr.current||un?(typeof p=="function"&&(ch(e,r,p,s),g=e.memoizedState),(d=un||fp(e,r,d,s,f,g,c)||!1)?(u||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(s,g,c),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(s,g,c)),typeof i.componentDidUpdate=="function"&&(e.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof i.componentDidUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=s,e.memoizedState=g),i.props=s,i.state=g,i.context=c,s=d):(typeof i.componentDidUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),s=!1)}return fh(t,e,r,s,o,n)}function fh(t,e,r,s,n,o){F1(t,e);var i=(e.flags&128)!==0;if(!s&&!i)return n&&op(e,r,!1),tn(t,e,o);s=e.stateNode,Lw.current=e;var l=i&&typeof r.getDerivedStateFromError!="function"?null:s.render();return e.flags|=1,t!==null&&i?(e.child=ia(e,t.child,null,o),e.child=ia(e,null,l,o)):Ir(t,e,l,o),e.memoizedState=s.state,n&&op(e,r,!0),e.child}function B1(t){var e=t.stateNode;e.pendingContext?np(t,e.pendingContext,e.pendingContext!==e.context):e.context&&np(t,e.context,!1),Sf(t,e.containerInfo)}function bp(t,e,r,s,n){return aa(),_f(n),e.flags|=256,Ir(t,e,r,s),e.child}var mh={dehydrated:null,treeContext:null,retryLane:0};function ph(t){return{baseLanes:t,cachePool:null,transitions:null}}function H1(t,e,r){var s=e.pendingProps,n=It.current,o=!1,i=(e.flags&128)!==0,l;if((l=i)||(l=t!==null&&t.memoizedState===null?!1:(n&2)!==0),l?(o=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(n|=1),ut(It,n&1),t===null)return ih(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(i=s.children,t=s.fallback,o?(s=e.mode,o=e.child,i={mode:"hidden",children:i},!(s&1)&&o!==null?(o.childLanes=0,o.pendingProps=i):o=fd(i,s,0,null),t=uo(t,s,r,null),o.return=e,t.return=e,o.sibling=t,e.child=o,e.child.memoizedState=ph(r),e.memoizedState=mh,t):Af(e,i));if(n=t.memoizedState,n!==null&&(l=n.dehydrated,l!==null))return Dw(t,e,i,s,l,n,r);if(o){o=s.fallback,i=e.mode,n=t.child,l=n.sibling;var c={mode:"hidden",children:s.children};return!(i&1)&&e.child!==n?(s=e.child,s.childLanes=0,s.pendingProps=c,e.deletions=null):(s=Tn(n,c),s.subtreeFlags=n.subtreeFlags&14680064),l!==null?o=Tn(l,o):(o=uo(o,i,r,null),o.flags|=2),o.return=e,s.return=e,s.sibling=o,e.child=s,s=o,o=e.child,i=t.child.memoizedState,i=i===null?ph(r):{baseLanes:i.baseLanes|r,cachePool:null,transitions:i.transitions},o.memoizedState=i,o.childLanes=t.childLanes&~r,e.memoizedState=mh,s}return o=t.child,t=o.sibling,s=Tn(o,{mode:"visible",children:s.children}),!(e.mode&1)&&(s.lanes=r),s.return=e,s.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=s,e.memoizedState=null,s}function Af(t,e){return e=fd({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function pl(t,e,r,s){return s!==null&&_f(s),ia(e,t.child,null,r),t=Af(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function Dw(t,e,r,s,n,o,i){if(r)return e.flags&256?(e.flags&=-257,s=Yd(Error(q(422))),pl(t,e,i,s)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(o=s.fallback,n=e.mode,s=fd({mode:"visible",children:s.children},n,0,null),o=uo(o,n,i,null),o.flags|=2,s.return=e,o.return=e,s.sibling=o,e.child=s,e.mode&1&&ia(e,t.child,null,i),e.child.memoizedState=ph(i),e.memoizedState=mh,o);if(!(e.mode&1))return pl(t,e,i,null);if(n.data==="$!"){if(s=n.nextSibling&&n.nextSibling.dataset,s)var l=s.dgst;return s=l,o=Error(q(419)),s=Yd(o,s,void 0),pl(t,e,i,s)}if(l=(i&t.childLanes)!==0,Wr||l){if(s=lr,s!==null){switch(i&-i){case 4:n=2;break;case 16:n=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:n=32;break;case 536870912:n=268435456;break;default:n=0}n=n&(s.suspendedLanes|i)?0:n,n!==0&&n!==o.retryLane&&(o.retryLane=n,en(t,n),ks(s,t,n,-1))}return Pf(),s=Yd(Error(q(421))),pl(t,e,i,s)}return n.data==="$?"?(e.flags|=128,e.child=t.child,e=qw.bind(null,t),n._reactRetry=e,null):(t=o.treeContext,ts=kn(n.nextSibling),rs=e,wt=!0,Cs=null,t!==null&&(cs[ds++]=Ks,cs[ds++]=Ys,cs[ds++]=po,Ks=t.id,Ys=t.overflow,po=e),e=Af(e,s.children),e.flags|=4096,e)}function wp(t,e,r){t.lanes|=e;var s=t.alternate;s!==null&&(s.lanes|=e),lh(t.return,e,r)}function Qd(t,e,r,s,n){var o=t.memoizedState;o===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:s,tail:r,tailMode:n}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=s,o.tail=r,o.tailMode=n)}function V1(t,e,r){var s=e.pendingProps,n=s.revealOrder,o=s.tail;if(Ir(t,e,s.children,r),s=It.current,s&2)s=s&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&wp(t,r,e);else if(t.tag===19)wp(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}s&=1}if(ut(It,s),!(e.mode&1))e.memoizedState=null;else switch(n){case"forwards":for(r=e.child,n=null;r!==null;)t=r.alternate,t!==null&&Nc(t)===null&&(n=r),r=r.sibling;r=n,r===null?(n=e.child,e.child=null):(n=r.sibling,r.sibling=null),Qd(e,!1,n,r,o);break;case"backwards":for(r=null,n=e.child,e.child=null;n!==null;){if(t=n.alternate,t!==null&&Nc(t)===null){e.child=n;break}t=n.sibling,n.sibling=r,r=n,n=t}Qd(e,!0,r,null,o);break;case"together":Qd(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function sc(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function tn(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),_o|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(q(153));if(e.child!==null){for(t=e.child,r=Tn(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=Tn(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function Mw(t,e,r){switch(e.tag){case 3:B1(e),aa();break;case 5:m1(e);break;case 1:Jr(e.type)&&bc(e);break;case 4:Sf(e,e.stateNode.containerInfo);break;case 10:var s=e.type._context,n=e.memoizedProps.value;ut(Cc,s._currentValue),s._currentValue=n;break;case 13:if(s=e.memoizedState,s!==null)return s.dehydrated!==null?(ut(It,It.current&1),e.flags|=128,null):r&e.child.childLanes?H1(t,e,r):(ut(It,It.current&1),t=tn(t,e,r),t!==null?t.sibling:null);ut(It,It.current&1);break;case 19:if(s=(r&e.childLanes)!==0,t.flags&128){if(s)return V1(t,e,r);e.flags|=128}if(n=e.memoizedState,n!==null&&(n.rendering=null,n.tail=null,n.lastEffect=null),ut(It,It.current),s)break;return null;case 22:case 23:return e.lanes=0,$1(t,e,r)}return tn(t,e,r)}var z1,gh,U1,W1;z1=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};gh=function(){};U1=function(t,e,r,s){var n=t.memoizedProps;if(n!==s){t=e.stateNode,ao(Bs.current);var o=null;switch(r){case"input":n=$u(t,n),s=$u(t,s),o=[];break;case"select":n=Tt({},n,{value:void 0}),s=Tt({},s,{value:void 0}),o=[];break;case"textarea":n=Hu(t,n),s=Hu(t,s),o=[];break;default:typeof n.onClick!="function"&&typeof s.onClick=="function"&&(t.onclick=vc)}zu(r,s);var i;r=null;for(d in n)if(!s.hasOwnProperty(d)&&n.hasOwnProperty(d)&&n[d]!=null)if(d==="style"){var l=n[d];for(i in l)l.hasOwnProperty(i)&&(r||(r={}),r[i]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(hi.hasOwnProperty(d)?o||(o=[]):(o=o||[]).push(d,null));for(d in s){var c=s[d];if(l=n!=null?n[d]:void 0,s.hasOwnProperty(d)&&c!==l&&(c!=null||l!=null))if(d==="style")if(l){for(i in l)!l.hasOwnProperty(i)||c&&c.hasOwnProperty(i)||(r||(r={}),r[i]="");for(i in c)c.hasOwnProperty(i)&&l[i]!==c[i]&&(r||(r={}),r[i]=c[i])}else r||(o||(o=[]),o.push(d,r)),r=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(o=o||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(o=o||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(hi.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&pt("scroll",t),o||l===c||(o=[])):(o=o||[]).push(d,c))}r&&(o=o||[]).push("style",r);var d=o;(e.updateQueue=d)&&(e.flags|=4)}};W1=function(t,e,r,s){r!==s&&(e.flags|=4)};function Ea(t,e){if(!wt)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var s=null;r!==null;)r.alternate!==null&&(s=r),r=r.sibling;s===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:s.sibling=null}}function gr(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,s=0;if(e)for(var n=t.child;n!==null;)r|=n.lanes|n.childLanes,s|=n.subtreeFlags&14680064,s|=n.flags&14680064,n.return=t,n=n.sibling;else for(n=t.child;n!==null;)r|=n.lanes|n.childLanes,s|=n.subtreeFlags,s|=n.flags,n.return=t,n=n.sibling;return t.subtreeFlags|=s,t.childLanes=r,e}function Rw(t,e,r){var s=e.pendingProps;switch(gf(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return gr(e),null;case 1:return Jr(e.type)&&xc(),gr(e),null;case 3:return s=e.stateNode,la(),yt(Gr),yt(Sr),jf(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(t===null||t.child===null)&&(fl(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Cs!==null&&(Ch(Cs),Cs=null))),gh(t,e),gr(e),null;case 5:Cf(e);var n=ao(Ci.current);if(r=e.type,t!==null&&e.stateNode!=null)U1(t,e,r,s,n),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!s){if(e.stateNode===null)throw Error(q(166));return gr(e),null}if(t=ao(Bs.current),fl(e)){s=e.stateNode,r=e.type;var o=e.memoizedProps;switch(s[$s]=e,s[wi]=o,t=(e.mode&1)!==0,r){case"dialog":pt("cancel",s),pt("close",s);break;case"iframe":case"object":case"embed":pt("load",s);break;case"video":case"audio":for(n=0;n<Fa.length;n++)pt(Fa[n],s);break;case"source":pt("error",s);break;case"img":case"image":case"link":pt("error",s),pt("load",s);break;case"details":pt("toggle",s);break;case"input":Am(s,o),pt("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!o.multiple},pt("invalid",s);break;case"textarea":Dm(s,o),pt("invalid",s)}zu(r,o),n=null;for(var i in o)if(o.hasOwnProperty(i)){var l=o[i];i==="children"?typeof l=="string"?s.textContent!==l&&(o.suppressHydrationWarning!==!0&&hl(s.textContent,l,t),n=["children",l]):typeof l=="number"&&s.textContent!==""+l&&(o.suppressHydrationWarning!==!0&&hl(s.textContent,l,t),n=["children",""+l]):hi.hasOwnProperty(i)&&l!=null&&i==="onScroll"&&pt("scroll",s)}switch(r){case"input":nl(s),Lm(s,o,!0);break;case"textarea":nl(s),Mm(s);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(s.onclick=vc)}s=n,e.updateQueue=s,s!==null&&(e.flags|=4)}else{i=n.nodeType===9?n:n.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=vy(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=i.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof s.is=="string"?t=i.createElement(r,{is:s.is}):(t=i.createElement(r),r==="select"&&(i=t,s.multiple?i.multiple=!0:s.size&&(i.size=s.size))):t=i.createElementNS(t,r),t[$s]=e,t[wi]=s,z1(t,e,!1,!1),e.stateNode=t;e:{switch(i=Uu(r,s),r){case"dialog":pt("cancel",t),pt("close",t),n=s;break;case"iframe":case"object":case"embed":pt("load",t),n=s;break;case"video":case"audio":for(n=0;n<Fa.length;n++)pt(Fa[n],t);n=s;break;case"source":pt("error",t),n=s;break;case"img":case"image":case"link":pt("error",t),pt("load",t),n=s;break;case"details":pt("toggle",t),n=s;break;case"input":Am(t,s),n=$u(t,s),pt("invalid",t);break;case"option":n=s;break;case"select":t._wrapperState={wasMultiple:!!s.multiple},n=Tt({},s,{value:void 0}),pt("invalid",t);break;case"textarea":Dm(t,s),n=Hu(t,s),pt("invalid",t);break;default:n=s}zu(r,n),l=n;for(o in l)if(l.hasOwnProperty(o)){var c=l[o];o==="style"?wy(t,c):o==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&xy(t,c)):o==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&fi(t,c):typeof c=="number"&&fi(t,""+c):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(hi.hasOwnProperty(o)?c!=null&&o==="onScroll"&&pt("scroll",t):c!=null&&ef(t,o,c,i))}switch(r){case"input":nl(t),Lm(t,s,!1);break;case"textarea":nl(t),Mm(t);break;case"option":s.value!=null&&t.setAttribute("value",""+Ln(s.value));break;case"select":t.multiple=!!s.multiple,o=s.value,o!=null?Ko(t,!!s.multiple,o,!1):s.defaultValue!=null&&Ko(t,!!s.multiple,s.defaultValue,!0);break;default:typeof n.onClick=="function"&&(t.onclick=vc)}switch(r){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return gr(e),null;case 6:if(t&&e.stateNode!=null)W1(t,e,t.memoizedProps,s);else{if(typeof s!="string"&&e.stateNode===null)throw Error(q(166));if(r=ao(Ci.current),ao(Bs.current),fl(e)){if(s=e.stateNode,r=e.memoizedProps,s[$s]=e,(o=s.nodeValue!==r)&&(t=rs,t!==null))switch(t.tag){case 3:hl(s.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&hl(s.nodeValue,r,(t.mode&1)!==0)}o&&(e.flags|=4)}else s=(r.nodeType===9?r:r.ownerDocument).createTextNode(s),s[$s]=e,e.stateNode=s}return gr(e),null;case 13:if(yt(It),s=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(wt&&ts!==null&&e.mode&1&&!(e.flags&128))c1(),aa(),e.flags|=98560,o=!1;else if(o=fl(e),s!==null&&s.dehydrated!==null){if(t===null){if(!o)throw Error(q(318));if(o=e.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(q(317));o[$s]=e}else aa(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;gr(e),o=!1}else Cs!==null&&(Ch(Cs),Cs=null),o=!0;if(!o)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(s=s!==null,s!==(t!==null&&t.memoizedState!==null)&&s&&(e.child.flags|=8192,e.mode&1&&(t===null||It.current&1?tr===0&&(tr=3):Pf())),e.updateQueue!==null&&(e.flags|=4),gr(e),null);case 4:return la(),gh(t,e),t===null&&xi(e.stateNode.containerInfo),gr(e),null;case 10:return xf(e.type._context),gr(e),null;case 17:return Jr(e.type)&&xc(),gr(e),null;case 19:if(yt(It),o=e.memoizedState,o===null)return gr(e),null;if(s=(e.flags&128)!==0,i=o.rendering,i===null)if(s)Ea(o,!1);else{if(tr!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(i=Nc(t),i!==null){for(e.flags|=128,Ea(o,!1),s=i.updateQueue,s!==null&&(e.updateQueue=s,e.flags|=4),e.subtreeFlags=0,s=r,r=e.child;r!==null;)o=r,t=s,o.flags&=14680066,i=o.alternate,i===null?(o.childLanes=0,o.lanes=t,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=i.childLanes,o.lanes=i.lanes,o.child=i.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=i.memoizedProps,o.memoizedState=i.memoizedState,o.updateQueue=i.updateQueue,o.type=i.type,t=i.dependencies,o.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return ut(It,It.current&1|2),e.child}t=t.sibling}o.tail!==null&&Pt()>da&&(e.flags|=128,s=!0,Ea(o,!1),e.lanes=4194304)}else{if(!s)if(t=Nc(i),t!==null){if(e.flags|=128,s=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),Ea(o,!0),o.tail===null&&o.tailMode==="hidden"&&!i.alternate&&!wt)return gr(e),null}else 2*Pt()-o.renderingStartTime>da&&r!==1073741824&&(e.flags|=128,s=!0,Ea(o,!1),e.lanes=4194304);o.isBackwards?(i.sibling=e.child,e.child=i):(r=o.last,r!==null?r.sibling=i:e.child=i,o.last=i)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=Pt(),e.sibling=null,r=It.current,ut(It,s?r&1|2:r&1),e):(gr(e),null);case 22:case 23:return Of(),s=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==s&&(e.flags|=8192),s&&e.mode&1?Zr&1073741824&&(gr(e),e.subtreeFlags&6&&(e.flags|=8192)):gr(e),null;case 24:return null;case 25:return null}throw Error(q(156,e.tag))}function Ow(t,e){switch(gf(e),e.tag){case 1:return Jr(e.type)&&xc(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return la(),yt(Gr),yt(Sr),jf(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Cf(e),null;case 13:if(yt(It),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(q(340));aa()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return yt(It),null;case 4:return la(),null;case 10:return xf(e.type._context),null;case 22:case 23:return Of(),null;case 24:return null;default:return null}}var gl=!1,br=!1,Pw=typeof WeakSet=="function"?WeakSet:Set,se=null;function Go(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(s){Dt(t,e,s)}else r.current=null}function _h(t,e,r){try{r()}catch(s){Dt(t,e,s)}}var Sp=!1;function $w(t,e){if(eh=gc,t=Yy(),mf(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var s=r.getSelection&&r.getSelection();if(s&&s.rangeCount!==0){r=s.anchorNode;var n=s.anchorOffset,o=s.focusNode;s=s.focusOffset;try{r.nodeType,o.nodeType}catch{r=null;break e}var i=0,l=-1,c=-1,d=0,u=0,h=t,f=null;t:for(;;){for(var p;h!==r||n!==0&&h.nodeType!==3||(l=i+n),h!==o||s!==0&&h.nodeType!==3||(c=i+s),h.nodeType===3&&(i+=h.nodeValue.length),(p=h.firstChild)!==null;)f=h,h=p;for(;;){if(h===t)break t;if(f===r&&++d===n&&(l=i),f===o&&++u===s&&(c=i),(p=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=p}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(th={focusedElem:t,selectionRange:r},gc=!1,se=e;se!==null;)if(e=se,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,se=t;else for(;se!==null;){e=se;try{var g=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var y=g.memoizedProps,x=g.memoizedState,m=e.stateNode,_=m.getSnapshotBeforeUpdate(e.elementType===e.type?y:xs(e.type,y),x);m.__reactInternalSnapshotBeforeUpdate=_}break;case 3:var v=e.stateNode.containerInfo;v.nodeType===1?v.textContent="":v.nodeType===9&&v.documentElement&&v.removeChild(v.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(q(163))}}catch(w){Dt(e,e.return,w)}if(t=e.sibling,t!==null){t.return=e.return,se=t;break}se=e.return}return g=Sp,Sp=!1,g}function ei(t,e,r){var s=e.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var n=s=s.next;do{if((n.tag&t)===t){var o=n.destroy;n.destroy=void 0,o!==void 0&&_h(e,r,o)}n=n.next}while(n!==s)}}function ud(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var s=r.create;r.destroy=s()}r=r.next}while(r!==e)}}function yh(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function q1(t){var e=t.alternate;e!==null&&(t.alternate=null,q1(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[$s],delete e[wi],delete e[nh],delete e[xw],delete e[bw])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function G1(t){return t.tag===5||t.tag===3||t.tag===4}function Cp(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||G1(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function vh(t,e,r){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=vc));else if(s!==4&&(t=t.child,t!==null))for(vh(t,e,r),t=t.sibling;t!==null;)vh(t,e,r),t=t.sibling}function xh(t,e,r){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(s!==4&&(t=t.child,t!==null))for(xh(t,e,r),t=t.sibling;t!==null;)xh(t,e,r),t=t.sibling}var ur=null,ws=!1;function nn(t,e,r){for(r=r.child;r!==null;)J1(t,e,r),r=r.sibling}function J1(t,e,r){if(Fs&&typeof Fs.onCommitFiberUnmount=="function")try{Fs.onCommitFiberUnmount(sd,r)}catch{}switch(r.tag){case 5:br||Go(r,e);case 6:var s=ur,n=ws;ur=null,nn(t,e,r),ur=s,ws=n,ur!==null&&(ws?(t=ur,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):ur.removeChild(r.stateNode));break;case 18:ur!==null&&(ws?(t=ur,r=r.stateNode,t.nodeType===8?Ud(t.parentNode,r):t.nodeType===1&&Ud(t,r),_i(t)):Ud(ur,r.stateNode));break;case 4:s=ur,n=ws,ur=r.stateNode.containerInfo,ws=!0,nn(t,e,r),ur=s,ws=n;break;case 0:case 11:case 14:case 15:if(!br&&(s=r.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){n=s=s.next;do{var o=n,i=o.destroy;o=o.tag,i!==void 0&&(o&2||o&4)&&_h(r,e,i),n=n.next}while(n!==s)}nn(t,e,r);break;case 1:if(!br&&(Go(r,e),s=r.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=r.memoizedProps,s.state=r.memoizedState,s.componentWillUnmount()}catch(l){Dt(r,e,l)}nn(t,e,r);break;case 21:nn(t,e,r);break;case 22:r.mode&1?(br=(s=br)||r.memoizedState!==null,nn(t,e,r),br=s):nn(t,e,r);break;default:nn(t,e,r)}}function jp(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new Pw),e.forEach(function(s){var n=Gw.bind(null,t,s);r.has(s)||(r.add(s),s.then(n,n))})}}function gs(t,e){var r=e.deletions;if(r!==null)for(var s=0;s<r.length;s++){var n=r[s];try{var o=t,i=e,l=i;e:for(;l!==null;){switch(l.tag){case 5:ur=l.stateNode,ws=!1;break e;case 3:ur=l.stateNode.containerInfo,ws=!0;break e;case 4:ur=l.stateNode.containerInfo,ws=!0;break e}l=l.return}if(ur===null)throw Error(q(160));J1(o,i,n),ur=null,ws=!1;var c=n.alternate;c!==null&&(c.return=null),n.return=null}catch(d){Dt(n,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)K1(e,t),e=e.sibling}function K1(t,e){var r=t.alternate,s=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(gs(e,t),Ts(t),s&4){try{ei(3,t,t.return),ud(3,t)}catch(y){Dt(t,t.return,y)}try{ei(5,t,t.return)}catch(y){Dt(t,t.return,y)}}break;case 1:gs(e,t),Ts(t),s&512&&r!==null&&Go(r,r.return);break;case 5:if(gs(e,t),Ts(t),s&512&&r!==null&&Go(r,r.return),t.flags&32){var n=t.stateNode;try{fi(n,"")}catch(y){Dt(t,t.return,y)}}if(s&4&&(n=t.stateNode,n!=null)){var o=t.memoizedProps,i=r!==null?r.memoizedProps:o,l=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{l==="input"&&o.type==="radio"&&o.name!=null&&_y(n,o),Uu(l,i);var d=Uu(l,o);for(i=0;i<c.length;i+=2){var u=c[i],h=c[i+1];u==="style"?wy(n,h):u==="dangerouslySetInnerHTML"?xy(n,h):u==="children"?fi(n,h):ef(n,u,h,d)}switch(l){case"input":Fu(n,o);break;case"textarea":yy(n,o);break;case"select":var f=n._wrapperState.wasMultiple;n._wrapperState.wasMultiple=!!o.multiple;var p=o.value;p!=null?Ko(n,!!o.multiple,p,!1):f!==!!o.multiple&&(o.defaultValue!=null?Ko(n,!!o.multiple,o.defaultValue,!0):Ko(n,!!o.multiple,o.multiple?[]:"",!1))}n[wi]=o}catch(y){Dt(t,t.return,y)}}break;case 6:if(gs(e,t),Ts(t),s&4){if(t.stateNode===null)throw Error(q(162));n=t.stateNode,o=t.memoizedProps;try{n.nodeValue=o}catch(y){Dt(t,t.return,y)}}break;case 3:if(gs(e,t),Ts(t),s&4&&r!==null&&r.memoizedState.isDehydrated)try{_i(e.containerInfo)}catch(y){Dt(t,t.return,y)}break;case 4:gs(e,t),Ts(t);break;case 13:gs(e,t),Ts(t),n=t.child,n.flags&8192&&(o=n.memoizedState!==null,n.stateNode.isHidden=o,!o||n.alternate!==null&&n.alternate.memoizedState!==null||(Mf=Pt())),s&4&&jp(t);break;case 22:if(u=r!==null&&r.memoizedState!==null,t.mode&1?(br=(d=br)||u,gs(e,t),br=d):gs(e,t),Ts(t),s&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!u&&t.mode&1)for(se=t,u=t.child;u!==null;){for(h=se=u;se!==null;){switch(f=se,p=f.child,f.tag){case 0:case 11:case 14:case 15:ei(4,f,f.return);break;case 1:Go(f,f.return);var g=f.stateNode;if(typeof g.componentWillUnmount=="function"){s=f,r=f.return;try{e=s,g.props=e.memoizedProps,g.state=e.memoizedState,g.componentWillUnmount()}catch(y){Dt(s,r,y)}}break;case 5:Go(f,f.return);break;case 22:if(f.memoizedState!==null){Np(h);continue}}p!==null?(p.return=f,se=p):Np(h)}u=u.sibling}e:for(u=null,h=t;;){if(h.tag===5){if(u===null){u=h;try{n=h.stateNode,d?(o=n.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(l=h.stateNode,c=h.memoizedProps.style,i=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=by("display",i))}catch(y){Dt(t,t.return,y)}}}else if(h.tag===6){if(u===null)try{h.stateNode.nodeValue=d?"":h.memoizedProps}catch(y){Dt(t,t.return,y)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:gs(e,t),Ts(t),s&4&&jp(t);break;case 21:break;default:gs(e,t),Ts(t)}}function Ts(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(G1(r)){var s=r;break e}r=r.return}throw Error(q(160))}switch(s.tag){case 5:var n=s.stateNode;s.flags&32&&(fi(n,""),s.flags&=-33);var o=Cp(t);xh(t,o,n);break;case 3:case 4:var i=s.stateNode.containerInfo,l=Cp(t);vh(t,l,i);break;default:throw Error(q(161))}}catch(c){Dt(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function Fw(t,e,r){se=t,Y1(t)}function Y1(t,e,r){for(var s=(t.mode&1)!==0;se!==null;){var n=se,o=n.child;if(n.tag===22&&s){var i=n.memoizedState!==null||gl;if(!i){var l=n.alternate,c=l!==null&&l.memoizedState!==null||br;l=gl;var d=br;if(gl=i,(br=c)&&!d)for(se=n;se!==null;)i=se,c=i.child,i.tag===22&&i.memoizedState!==null?Ip(n):c!==null?(c.return=i,se=c):Ip(n);for(;o!==null;)se=o,Y1(o),o=o.sibling;se=n,gl=l,br=d}kp(t)}else n.subtreeFlags&8772&&o!==null?(o.return=n,se=o):kp(t)}}function kp(t){for(;se!==null;){var e=se;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:br||ud(5,e);break;case 1:var s=e.stateNode;if(e.flags&4&&!br)if(r===null)s.componentDidMount();else{var n=e.elementType===e.type?r.memoizedProps:xs(e.type,r.memoizedProps);s.componentDidUpdate(n,r.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;o!==null&&dp(e,o,s);break;case 3:var i=e.updateQueue;if(i!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}dp(e,i,r)}break;case 5:var l=e.stateNode;if(r===null&&e.flags&4){r=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var u=d.memoizedState;if(u!==null){var h=u.dehydrated;h!==null&&_i(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(q(163))}br||e.flags&512&&yh(e)}catch(f){Dt(e,e.return,f)}}if(e===t){se=null;break}if(r=e.sibling,r!==null){r.return=e.return,se=r;break}se=e.return}}function Np(t){for(;se!==null;){var e=se;if(e===t){se=null;break}var r=e.sibling;if(r!==null){r.return=e.return,se=r;break}se=e.return}}function Ip(t){for(;se!==null;){var e=se;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{ud(4,e)}catch(c){Dt(e,r,c)}break;case 1:var s=e.stateNode;if(typeof s.componentDidMount=="function"){var n=e.return;try{s.componentDidMount()}catch(c){Dt(e,n,c)}}var o=e.return;try{yh(e)}catch(c){Dt(e,o,c)}break;case 5:var i=e.return;try{yh(e)}catch(c){Dt(e,i,c)}}}catch(c){Dt(e,e.return,c)}if(e===t){se=null;break}var l=e.sibling;if(l!==null){l.return=e.return,se=l;break}se=e.return}}var Bw=Math.ceil,Tc=sn.ReactCurrentDispatcher,Lf=sn.ReactCurrentOwner,fs=sn.ReactCurrentBatchConfig,qe=0,lr=null,Wt=null,fr=0,Zr=0,Jo=On(0),tr=0,Ii=null,_o=0,hd=0,Df=0,ti=null,zr=null,Mf=0,da=1/0,Ws=null,Ac=!1,bh=null,In=null,_l=!1,_n=null,Lc=0,ri=0,wh=null,nc=-1,oc=0;function Lr(){return qe&6?Pt():nc!==-1?nc:nc=Pt()}function En(t){return t.mode&1?qe&2&&fr!==0?fr&-fr:Sw.transition!==null?(oc===0&&(oc=My()),oc):(t=et,t!==0||(t=window.event,t=t===void 0?16:Hy(t.type)),t):1}function ks(t,e,r,s){if(50<ri)throw ri=0,wh=null,Error(q(185));Vi(t,r,s),(!(qe&2)||t!==lr)&&(t===lr&&(!(qe&2)&&(hd|=r),tr===4&&fn(t,fr)),Kr(t,s),r===1&&qe===0&&!(e.mode&1)&&(da=Pt()+500,ld&&Pn()))}function Kr(t,e){var r=t.callbackNode;Sb(t,e);var s=pc(t,t===lr?fr:0);if(s===0)r!==null&&Pm(r),t.callbackNode=null,t.callbackPriority=0;else if(e=s&-s,t.callbackPriority!==e){if(r!=null&&Pm(r),e===1)t.tag===0?ww(Ep.bind(null,t)):a1(Ep.bind(null,t)),yw(function(){!(qe&6)&&Pn()}),r=null;else{switch(Ry(s)){case 1:r=of;break;case 4:r=Ly;break;case 16:r=mc;break;case 536870912:r=Dy;break;default:r=mc}r=nv(r,Q1.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function Q1(t,e){if(nc=-1,oc=0,qe&6)throw Error(q(327));var r=t.callbackNode;if(ea()&&t.callbackNode!==r)return null;var s=pc(t,t===lr?fr:0);if(s===0)return null;if(s&30||s&t.expiredLanes||e)e=Dc(t,s);else{e=s;var n=qe;qe|=2;var o=X1();(lr!==t||fr!==e)&&(Ws=null,da=Pt()+500,co(t,e));do try{zw();break}catch(l){Z1(t,l)}while(!0);vf(),Tc.current=o,qe=n,Wt!==null?e=0:(lr=null,fr=0,e=tr)}if(e!==0){if(e===2&&(n=Ku(t),n!==0&&(s=n,e=Sh(t,n))),e===1)throw r=Ii,co(t,0),fn(t,s),Kr(t,Pt()),r;if(e===6)fn(t,s);else{if(n=t.current.alternate,!(s&30)&&!Hw(n)&&(e=Dc(t,s),e===2&&(o=Ku(t),o!==0&&(s=o,e=Sh(t,o))),e===1))throw r=Ii,co(t,0),fn(t,s),Kr(t,Pt()),r;switch(t.finishedWork=n,t.finishedLanes=s,e){case 0:case 1:throw Error(q(345));case 2:Qn(t,zr,Ws);break;case 3:if(fn(t,s),(s&130023424)===s&&(e=Mf+500-Pt(),10<e)){if(pc(t,0)!==0)break;if(n=t.suspendedLanes,(n&s)!==s){Lr(),t.pingedLanes|=t.suspendedLanes&n;break}t.timeoutHandle=sh(Qn.bind(null,t,zr,Ws),e);break}Qn(t,zr,Ws);break;case 4:if(fn(t,s),(s&4194240)===s)break;for(e=t.eventTimes,n=-1;0<s;){var i=31-js(s);o=1<<i,i=e[i],i>n&&(n=i),s&=~o}if(s=n,s=Pt()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*Bw(s/1960))-s,10<s){t.timeoutHandle=sh(Qn.bind(null,t,zr,Ws),s);break}Qn(t,zr,Ws);break;case 5:Qn(t,zr,Ws);break;default:throw Error(q(329))}}}return Kr(t,Pt()),t.callbackNode===r?Q1.bind(null,t):null}function Sh(t,e){var r=ti;return t.current.memoizedState.isDehydrated&&(co(t,e).flags|=256),t=Dc(t,e),t!==2&&(e=zr,zr=r,e!==null&&Ch(e)),t}function Ch(t){zr===null?zr=t:zr.push.apply(zr,t)}function Hw(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var s=0;s<r.length;s++){var n=r[s],o=n.getSnapshot;n=n.value;try{if(!Ns(o(),n))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function fn(t,e){for(e&=~Df,e&=~hd,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-js(e),s=1<<r;t[r]=-1,e&=~s}}function Ep(t){if(qe&6)throw Error(q(327));ea();var e=pc(t,0);if(!(e&1))return Kr(t,Pt()),null;var r=Dc(t,e);if(t.tag!==0&&r===2){var s=Ku(t);s!==0&&(e=s,r=Sh(t,s))}if(r===1)throw r=Ii,co(t,0),fn(t,e),Kr(t,Pt()),r;if(r===6)throw Error(q(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Qn(t,zr,Ws),Kr(t,Pt()),null}function Rf(t,e){var r=qe;qe|=1;try{return t(e)}finally{qe=r,qe===0&&(da=Pt()+500,ld&&Pn())}}function yo(t){_n!==null&&_n.tag===0&&!(qe&6)&&ea();var e=qe;qe|=1;var r=fs.transition,s=et;try{if(fs.transition=null,et=1,t)return t()}finally{et=s,fs.transition=r,qe=e,!(qe&6)&&Pn()}}function Of(){Zr=Jo.current,yt(Jo)}function co(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,_w(r)),Wt!==null)for(r=Wt.return;r!==null;){var s=r;switch(gf(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&xc();break;case 3:la(),yt(Gr),yt(Sr),jf();break;case 5:Cf(s);break;case 4:la();break;case 13:yt(It);break;case 19:yt(It);break;case 10:xf(s.type._context);break;case 22:case 23:Of()}r=r.return}if(lr=t,Wt=t=Tn(t.current,null),fr=Zr=e,tr=0,Ii=null,Df=hd=_o=0,zr=ti=null,oo!==null){for(e=0;e<oo.length;e++)if(r=oo[e],s=r.interleaved,s!==null){r.interleaved=null;var n=s.next,o=r.pending;if(o!==null){var i=o.next;o.next=n,s.next=i}r.pending=s}oo=null}return t}function Z1(t,e){do{var r=Wt;try{if(vf(),tc.current=Ec,Ic){for(var s=Et.memoizedState;s!==null;){var n=s.queue;n!==null&&(n.pending=null),s=s.next}Ic=!1}if(go=0,ar=er=Et=null,Xa=!1,ji=0,Lf.current=null,r===null||r.return===null){tr=1,Ii=e,Wt=null;break}e:{var o=t,i=r.return,l=r,c=e;if(e=fr,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,u=l,h=u.tag;if(!(u.mode&1)&&(h===0||h===11||h===15)){var f=u.alternate;f?(u.updateQueue=f.updateQueue,u.memoizedState=f.memoizedState,u.lanes=f.lanes):(u.updateQueue=null,u.memoizedState=null)}var p=gp(i);if(p!==null){p.flags&=-257,_p(p,i,l,o,e),p.mode&1&&pp(o,d,e),e=p,c=d;var g=e.updateQueue;if(g===null){var y=new Set;y.add(c),e.updateQueue=y}else g.add(c);break e}else{if(!(e&1)){pp(o,d,e),Pf();break e}c=Error(q(426))}}else if(wt&&l.mode&1){var x=gp(i);if(x!==null){!(x.flags&65536)&&(x.flags|=256),_p(x,i,l,o,e),_f(ca(c,l));break e}}o=c=ca(c,l),tr!==4&&(tr=2),ti===null?ti=[o]:ti.push(o),o=i;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e;var m=R1(o,c,e);cp(o,m);break e;case 1:l=c;var _=o.type,v=o.stateNode;if(!(o.flags&128)&&(typeof _.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(In===null||!In.has(v)))){o.flags|=65536,e&=-e,o.lanes|=e;var w=O1(o,l,e);cp(o,w);break e}}o=o.return}while(o!==null)}tv(r)}catch(S){e=S,Wt===r&&r!==null&&(Wt=r=r.return);continue}break}while(!0)}function X1(){var t=Tc.current;return Tc.current=Ec,t===null?Ec:t}function Pf(){(tr===0||tr===3||tr===2)&&(tr=4),lr===null||!(_o&268435455)&&!(hd&268435455)||fn(lr,fr)}function Dc(t,e){var r=qe;qe|=2;var s=X1();(lr!==t||fr!==e)&&(Ws=null,co(t,e));do try{Vw();break}catch(n){Z1(t,n)}while(!0);if(vf(),qe=r,Tc.current=s,Wt!==null)throw Error(q(261));return lr=null,fr=0,tr}function Vw(){for(;Wt!==null;)ev(Wt)}function zw(){for(;Wt!==null&&!mb();)ev(Wt)}function ev(t){var e=sv(t.alternate,t,Zr);t.memoizedProps=t.pendingProps,e===null?tv(t):Wt=e,Lf.current=null}function tv(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=Ow(r,e),r!==null){r.flags&=32767,Wt=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{tr=6,Wt=null;return}}else if(r=Rw(r,e,Zr),r!==null){Wt=r;return}if(e=e.sibling,e!==null){Wt=e;return}Wt=e=t}while(e!==null);tr===0&&(tr=5)}function Qn(t,e,r){var s=et,n=fs.transition;try{fs.transition=null,et=1,Uw(t,e,r,s)}finally{fs.transition=n,et=s}return null}function Uw(t,e,r,s){do ea();while(_n!==null);if(qe&6)throw Error(q(327));r=t.finishedWork;var n=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(q(177));t.callbackNode=null,t.callbackPriority=0;var o=r.lanes|r.childLanes;if(Cb(t,o),t===lr&&(Wt=lr=null,fr=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||_l||(_l=!0,nv(mc,function(){return ea(),null})),o=(r.flags&15990)!==0,r.subtreeFlags&15990||o){o=fs.transition,fs.transition=null;var i=et;et=1;var l=qe;qe|=4,Lf.current=null,$w(t,r),K1(r,t),dw(th),gc=!!eh,th=eh=null,t.current=r,Fw(r),pb(),qe=l,et=i,fs.transition=o}else t.current=r;if(_l&&(_l=!1,_n=t,Lc=n),o=t.pendingLanes,o===0&&(In=null),yb(r.stateNode),Kr(t,Pt()),e!==null)for(s=t.onRecoverableError,r=0;r<e.length;r++)n=e[r],s(n.value,{componentStack:n.stack,digest:n.digest});if(Ac)throw Ac=!1,t=bh,bh=null,t;return Lc&1&&t.tag!==0&&ea(),o=t.pendingLanes,o&1?t===wh?ri++:(ri=0,wh=t):ri=0,Pn(),null}function ea(){if(_n!==null){var t=Ry(Lc),e=fs.transition,r=et;try{if(fs.transition=null,et=16>t?16:t,_n===null)var s=!1;else{if(t=_n,_n=null,Lc=0,qe&6)throw Error(q(331));var n=qe;for(qe|=4,se=t.current;se!==null;){var o=se,i=o.child;if(se.flags&16){var l=o.deletions;if(l!==null){for(var c=0;c<l.length;c++){var d=l[c];for(se=d;se!==null;){var u=se;switch(u.tag){case 0:case 11:case 15:ei(8,u,o)}var h=u.child;if(h!==null)h.return=u,se=h;else for(;se!==null;){u=se;var f=u.sibling,p=u.return;if(q1(u),u===d){se=null;break}if(f!==null){f.return=p,se=f;break}se=p}}}var g=o.alternate;if(g!==null){var y=g.child;if(y!==null){g.child=null;do{var x=y.sibling;y.sibling=null,y=x}while(y!==null)}}se=o}}if(o.subtreeFlags&2064&&i!==null)i.return=o,se=i;else e:for(;se!==null;){if(o=se,o.flags&2048)switch(o.tag){case 0:case 11:case 15:ei(9,o,o.return)}var m=o.sibling;if(m!==null){m.return=o.return,se=m;break e}se=o.return}}var _=t.current;for(se=_;se!==null;){i=se;var v=i.child;if(i.subtreeFlags&2064&&v!==null)v.return=i,se=v;else e:for(i=_;se!==null;){if(l=se,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:ud(9,l)}}catch(S){Dt(l,l.return,S)}if(l===i){se=null;break e}var w=l.sibling;if(w!==null){w.return=l.return,se=w;break e}se=l.return}}if(qe=n,Pn(),Fs&&typeof Fs.onPostCommitFiberRoot=="function")try{Fs.onPostCommitFiberRoot(sd,t)}catch{}s=!0}return s}finally{et=r,fs.transition=e}}return!1}function Tp(t,e,r){e=ca(r,e),e=R1(t,e,1),t=Nn(t,e,1),e=Lr(),t!==null&&(Vi(t,1,e),Kr(t,e))}function Dt(t,e,r){if(t.tag===3)Tp(t,t,r);else for(;e!==null;){if(e.tag===3){Tp(e,t,r);break}else if(e.tag===1){var s=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(In===null||!In.has(s))){t=ca(r,t),t=O1(e,t,1),e=Nn(e,t,1),t=Lr(),e!==null&&(Vi(e,1,t),Kr(e,t));break}}e=e.return}}function Ww(t,e,r){var s=t.pingCache;s!==null&&s.delete(e),e=Lr(),t.pingedLanes|=t.suspendedLanes&r,lr===t&&(fr&r)===r&&(tr===4||tr===3&&(fr&130023424)===fr&&500>Pt()-Mf?co(t,0):Df|=r),Kr(t,e)}function rv(t,e){e===0&&(t.mode&1?(e=il,il<<=1,!(il&130023424)&&(il=4194304)):e=1);var r=Lr();t=en(t,e),t!==null&&(Vi(t,e,r),Kr(t,r))}function qw(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),rv(t,r)}function Gw(t,e){var r=0;switch(t.tag){case 13:var s=t.stateNode,n=t.memoizedState;n!==null&&(r=n.retryLane);break;case 19:s=t.stateNode;break;default:throw Error(q(314))}s!==null&&s.delete(e),rv(t,r)}var sv;sv=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||Gr.current)Wr=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return Wr=!1,Mw(t,e,r);Wr=!!(t.flags&131072)}else Wr=!1,wt&&e.flags&1048576&&i1(e,Sc,e.index);switch(e.lanes=0,e.tag){case 2:var s=e.type;sc(t,e),t=e.pendingProps;var n=oa(e,Sr.current);Xo(e,r),n=Nf(null,e,s,t,n,r);var o=If();return e.flags|=1,typeof n=="object"&&n!==null&&typeof n.render=="function"&&n.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Jr(s)?(o=!0,bc(e)):o=!1,e.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,wf(e),n.updater=dd,e.stateNode=n,n._reactInternals=e,dh(e,s,t,r),e=fh(null,e,s,!0,o,r)):(e.tag=0,wt&&o&&pf(e),Ir(null,e,n,r),e=e.child),e;case 16:s=e.elementType;e:{switch(sc(t,e),t=e.pendingProps,n=s._init,s=n(s._payload),e.type=s,n=e.tag=Kw(s),t=xs(s,t),n){case 0:e=hh(null,e,s,t,r);break e;case 1:e=xp(null,e,s,t,r);break e;case 11:e=yp(null,e,s,t,r);break e;case 14:e=vp(null,e,s,xs(s.type,t),r);break e}throw Error(q(306,s,""))}return e;case 0:return s=e.type,n=e.pendingProps,n=e.elementType===s?n:xs(s,n),hh(t,e,s,n,r);case 1:return s=e.type,n=e.pendingProps,n=e.elementType===s?n:xs(s,n),xp(t,e,s,n,r);case 3:e:{if(B1(e),t===null)throw Error(q(387));s=e.pendingProps,o=e.memoizedState,n=o.element,f1(t,e),kc(e,s,null,r);var i=e.memoizedState;if(s=i.element,o.isDehydrated)if(o={element:s,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},e.updateQueue.baseState=o,e.memoizedState=o,e.flags&256){n=ca(Error(q(423)),e),e=bp(t,e,s,r,n);break e}else if(s!==n){n=ca(Error(q(424)),e),e=bp(t,e,s,r,n);break e}else for(ts=kn(e.stateNode.containerInfo.firstChild),rs=e,wt=!0,Cs=null,r=u1(e,null,s,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(aa(),s===n){e=tn(t,e,r);break e}Ir(t,e,s,r)}e=e.child}return e;case 5:return m1(e),t===null&&ih(e),s=e.type,n=e.pendingProps,o=t!==null?t.memoizedProps:null,i=n.children,rh(s,n)?i=null:o!==null&&rh(s,o)&&(e.flags|=32),F1(t,e),Ir(t,e,i,r),e.child;case 6:return t===null&&ih(e),null;case 13:return H1(t,e,r);case 4:return Sf(e,e.stateNode.containerInfo),s=e.pendingProps,t===null?e.child=ia(e,null,s,r):Ir(t,e,s,r),e.child;case 11:return s=e.type,n=e.pendingProps,n=e.elementType===s?n:xs(s,n),yp(t,e,s,n,r);case 7:return Ir(t,e,e.pendingProps,r),e.child;case 8:return Ir(t,e,e.pendingProps.children,r),e.child;case 12:return Ir(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(s=e.type._context,n=e.pendingProps,o=e.memoizedProps,i=n.value,ut(Cc,s._currentValue),s._currentValue=i,o!==null)if(Ns(o.value,i)){if(o.children===n.children&&!Gr.current){e=tn(t,e,r);break e}}else for(o=e.child,o!==null&&(o.return=e);o!==null;){var l=o.dependencies;if(l!==null){i=o.child;for(var c=l.firstContext;c!==null;){if(c.context===s){if(o.tag===1){c=Qs(-1,r&-r),c.tag=2;var d=o.updateQueue;if(d!==null){d=d.shared;var u=d.pending;u===null?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}o.lanes|=r,c=o.alternate,c!==null&&(c.lanes|=r),lh(o.return,r,e),l.lanes|=r;break}c=c.next}}else if(o.tag===10)i=o.type===e.type?null:o.child;else if(o.tag===18){if(i=o.return,i===null)throw Error(q(341));i.lanes|=r,l=i.alternate,l!==null&&(l.lanes|=r),lh(i,r,e),i=o.sibling}else i=o.child;if(i!==null)i.return=o;else for(i=o;i!==null;){if(i===e){i=null;break}if(o=i.sibling,o!==null){o.return=i.return,i=o;break}i=i.return}o=i}Ir(t,e,n.children,r),e=e.child}return e;case 9:return n=e.type,s=e.pendingProps.children,Xo(e,r),n=ms(n),s=s(n),e.flags|=1,Ir(t,e,s,r),e.child;case 14:return s=e.type,n=xs(s,e.pendingProps),n=xs(s.type,n),vp(t,e,s,n,r);case 15:return P1(t,e,e.type,e.pendingProps,r);case 17:return s=e.type,n=e.pendingProps,n=e.elementType===s?n:xs(s,n),sc(t,e),e.tag=1,Jr(s)?(t=!0,bc(e)):t=!1,Xo(e,r),M1(e,s,n),dh(e,s,n,r),fh(null,e,s,!0,t,r);case 19:return V1(t,e,r);case 22:return $1(t,e,r)}throw Error(q(156,e.tag))};function nv(t,e){return Ay(t,e)}function Jw(t,e,r,s){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function us(t,e,r,s){return new Jw(t,e,r,s)}function $f(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Kw(t){if(typeof t=="function")return $f(t)?1:0;if(t!=null){if(t=t.$$typeof,t===rf)return 11;if(t===sf)return 14}return 2}function Tn(t,e){var r=t.alternate;return r===null?(r=us(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function ac(t,e,r,s,n,o){var i=2;if(s=t,typeof t=="function")$f(t)&&(i=1);else if(typeof t=="string")i=5;else e:switch(t){case $o:return uo(r.children,n,o,e);case tf:i=8,n|=8;break;case Mu:return t=us(12,r,e,n|2),t.elementType=Mu,t.lanes=o,t;case Ru:return t=us(13,r,e,n),t.elementType=Ru,t.lanes=o,t;case Ou:return t=us(19,r,e,n),t.elementType=Ou,t.lanes=o,t;case my:return fd(r,n,o,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case hy:i=10;break e;case fy:i=9;break e;case rf:i=11;break e;case sf:i=14;break e;case dn:i=16,s=null;break e}throw Error(q(130,t==null?t:typeof t,""))}return e=us(i,r,e,n),e.elementType=t,e.type=s,e.lanes=o,e}function uo(t,e,r,s){return t=us(7,t,s,e),t.lanes=r,t}function fd(t,e,r,s){return t=us(22,t,s,e),t.elementType=my,t.lanes=r,t.stateNode={isHidden:!1},t}function Zd(t,e,r){return t=us(6,t,null,e),t.lanes=r,t}function Xd(t,e,r){return e=us(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Yw(t,e,r,s,n){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Dd(0),this.expirationTimes=Dd(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Dd(0),this.identifierPrefix=s,this.onRecoverableError=n,this.mutableSourceEagerHydrationData=null}function Ff(t,e,r,s,n,o,i,l,c){return t=new Yw(t,e,r,l,c),e===1?(e=1,o===!0&&(e|=8)):e=0,o=us(3,null,null,e),t.current=o,o.stateNode=t,o.memoizedState={element:s,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},wf(o),t}function Qw(t,e,r){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Po,key:s==null?null:""+s,children:t,containerInfo:e,implementation:r}}function ov(t){if(!t)return Dn;t=t._reactInternals;e:{if(wo(t)!==t||t.tag!==1)throw Error(q(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Jr(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(q(171))}if(t.tag===1){var r=t.type;if(Jr(r))return o1(t,r,e)}return e}function av(t,e,r,s,n,o,i,l,c){return t=Ff(r,s,!0,t,n,o,i,l,c),t.context=ov(null),r=t.current,s=Lr(),n=En(r),o=Qs(s,n),o.callback=e??null,Nn(r,o,n),t.current.lanes=n,Vi(t,n,s),Kr(t,s),t}function md(t,e,r,s){var n=e.current,o=Lr(),i=En(n);return r=ov(r),e.context===null?e.context=r:e.pendingContext=r,e=Qs(o,i),e.payload={element:t},s=s===void 0?null:s,s!==null&&(e.callback=s),t=Nn(n,e,i),t!==null&&(ks(t,n,i,o),ec(t,n,i)),i}function Mc(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Ap(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function Bf(t,e){Ap(t,e),(t=t.alternate)&&Ap(t,e)}function Zw(){return null}var iv=typeof reportError=="function"?reportError:function(t){console.error(t)};function Hf(t){this._internalRoot=t}pd.prototype.render=Hf.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(q(409));md(t,e,null,null)};pd.prototype.unmount=Hf.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;yo(function(){md(null,t,null,null)}),e[Xs]=null}};function pd(t){this._internalRoot=t}pd.prototype.unstable_scheduleHydration=function(t){if(t){var e=$y();t={blockedOn:null,target:t,priority:e};for(var r=0;r<hn.length&&e!==0&&e<hn[r].priority;r++);hn.splice(r,0,t),r===0&&By(t)}};function Vf(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function gd(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Lp(){}function Xw(t,e,r,s,n){if(n){if(typeof s=="function"){var o=s;s=function(){var d=Mc(i);o.call(d)}}var i=av(e,s,t,0,null,!1,!1,"",Lp);return t._reactRootContainer=i,t[Xs]=i.current,xi(t.nodeType===8?t.parentNode:t),yo(),i}for(;n=t.lastChild;)t.removeChild(n);if(typeof s=="function"){var l=s;s=function(){var d=Mc(c);l.call(d)}}var c=Ff(t,0,!1,null,null,!1,!1,"",Lp);return t._reactRootContainer=c,t[Xs]=c.current,xi(t.nodeType===8?t.parentNode:t),yo(function(){md(e,c,r,s)}),c}function _d(t,e,r,s,n){var o=r._reactRootContainer;if(o){var i=o;if(typeof n=="function"){var l=n;n=function(){var c=Mc(i);l.call(c)}}md(e,i,t,n)}else i=Xw(r,e,t,n,s);return Mc(i)}Oy=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=$a(e.pendingLanes);r!==0&&(af(e,r|1),Kr(e,Pt()),!(qe&6)&&(da=Pt()+500,Pn()))}break;case 13:yo(function(){var s=en(t,1);if(s!==null){var n=Lr();ks(s,t,1,n)}}),Bf(t,1)}};lf=function(t){if(t.tag===13){var e=en(t,134217728);if(e!==null){var r=Lr();ks(e,t,134217728,r)}Bf(t,134217728)}};Py=function(t){if(t.tag===13){var e=En(t),r=en(t,e);if(r!==null){var s=Lr();ks(r,t,e,s)}Bf(t,e)}};$y=function(){return et};Fy=function(t,e){var r=et;try{return et=t,e()}finally{et=r}};qu=function(t,e,r){switch(e){case"input":if(Fu(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var s=r[e];if(s!==t&&s.form===t.form){var n=id(s);if(!n)throw Error(q(90));gy(s),Fu(s,n)}}}break;case"textarea":yy(t,r);break;case"select":e=r.value,e!=null&&Ko(t,!!r.multiple,e,!1)}};jy=Rf;ky=yo;var e2={usingClientEntryPoint:!1,Events:[Ui,Vo,id,Sy,Cy,Rf]},Ta={findFiberByHostInstance:no,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},t2={bundleType:Ta.bundleType,version:Ta.version,rendererPackageName:Ta.rendererPackageName,rendererConfig:Ta.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:sn.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Ey(t),t===null?null:t.stateNode},findFiberByHostInstance:Ta.findFiberByHostInstance||Zw,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var yl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!yl.isDisabled&&yl.supportsFiber)try{sd=yl.inject(t2),Fs=yl}catch{}}ns.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=e2;ns.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Vf(e))throw Error(q(200));return Qw(t,e,null,r)};ns.createRoot=function(t,e){if(!Vf(t))throw Error(q(299));var r=!1,s="",n=iv;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(s=e.identifierPrefix),e.onRecoverableError!==void 0&&(n=e.onRecoverableError)),e=Ff(t,1,!1,null,null,r,!1,s,n),t[Xs]=e.current,xi(t.nodeType===8?t.parentNode:t),new Hf(e)};ns.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(q(188)):(t=Object.keys(t).join(","),Error(q(268,t)));return t=Ey(e),t=t===null?null:t.stateNode,t};ns.flushSync=function(t){return yo(t)};ns.hydrate=function(t,e,r){if(!gd(e))throw Error(q(200));return _d(null,t,e,!0,r)};ns.hydrateRoot=function(t,e,r){if(!Vf(t))throw Error(q(405));var s=r!=null&&r.hydratedSources||null,n=!1,o="",i=iv;if(r!=null&&(r.unstable_strictMode===!0&&(n=!0),r.identifierPrefix!==void 0&&(o=r.identifierPrefix),r.onRecoverableError!==void 0&&(i=r.onRecoverableError)),e=av(e,null,t,1,r??null,n,!1,o,i),t[Xs]=e.current,xi(t),s)for(t=0;t<s.length;t++)r=s[t],n=r._getVersion,n=n(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,n]:e.mutableSourceEagerHydrationData.push(r,n);return new pd(e)};ns.render=function(t,e,r){if(!gd(e))throw Error(q(200));return _d(null,t,e,!1,r)};ns.unmountComponentAtNode=function(t){if(!gd(t))throw Error(q(40));return t._reactRootContainer?(yo(function(){_d(null,null,t,!1,function(){t._reactRootContainer=null,t[Xs]=null})}),!0):!1};ns.unstable_batchedUpdates=Rf;ns.unstable_renderSubtreeIntoContainer=function(t,e,r,s){if(!gd(r))throw Error(q(200));if(t==null||t._reactInternals===void 0)throw Error(q(38));return _d(t,e,r,!1,s)};ns.version="18.3.1-next-f1338f8080-20240426";function lv(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(lv)}catch(t){console.error(t)}}lv(),ly.exports=ns;var r2=ly.exports,Dp=r2;Lu.createRoot=Dp.createRoot,Lu.hydrateRoot=Dp.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ei(){return Ei=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},Ei.apply(this,arguments)}var yn;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(yn||(yn={}));const Mp="popstate";function s2(t){t===void 0&&(t={});function e(s,n){let{pathname:o,search:i,hash:l}=s.location;return jh("",{pathname:o,search:i,hash:l},n.state&&n.state.usr||null,n.state&&n.state.key||"default")}function r(s,n){return typeof n=="string"?n:dv(n)}return o2(e,r,null,t)}function Gt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function cv(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function n2(){return Math.random().toString(36).substr(2,8)}function Rp(t,e){return{usr:t.state,key:t.key,idx:e}}function jh(t,e,r,s){return r===void 0&&(r=null),Ei({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?ga(e):e,{state:r,key:e&&e.key||s||n2()})}function dv(t){let{pathname:e="/",search:r="",hash:s=""}=t;return r&&r!=="?"&&(e+=r.charAt(0)==="?"?r:"?"+r),s&&s!=="#"&&(e+=s.charAt(0)==="#"?s:"#"+s),e}function ga(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substr(r),t=t.substr(0,r));let s=t.indexOf("?");s>=0&&(e.search=t.substr(s),t=t.substr(0,s)),t&&(e.pathname=t)}return e}function o2(t,e,r,s){s===void 0&&(s={});let{window:n=document.defaultView,v5Compat:o=!1}=s,i=n.history,l=yn.Pop,c=null,d=u();d==null&&(d=0,i.replaceState(Ei({},i.state,{idx:d}),""));function u(){return(i.state||{idx:null}).idx}function h(){l=yn.Pop;let x=u(),m=x==null?null:x-d;d=x,c&&c({action:l,location:y.location,delta:m})}function f(x,m){l=yn.Push;let _=jh(y.location,x,m);d=u()+1;let v=Rp(_,d),w=y.createHref(_);try{i.pushState(v,"",w)}catch(S){if(S instanceof DOMException&&S.name==="DataCloneError")throw S;n.location.assign(w)}o&&c&&c({action:l,location:y.location,delta:1})}function p(x,m){l=yn.Replace;let _=jh(y.location,x,m);d=u();let v=Rp(_,d),w=y.createHref(_);i.replaceState(v,"",w),o&&c&&c({action:l,location:y.location,delta:0})}function g(x){let m=n.location.origin!=="null"?n.location.origin:n.location.href,_=typeof x=="string"?x:dv(x);return _=_.replace(/ $/,"%20"),Gt(m,"No window.location.(origin|href) available to create URL for href: "+_),new URL(_,m)}let y={get action(){return l},get location(){return t(n,i)},listen(x){if(c)throw new Error("A history only accepts one active listener");return n.addEventListener(Mp,h),c=x,()=>{n.removeEventListener(Mp,h),c=null}},createHref(x){return e(n,x)},createURL:g,encodeLocation(x){let m=g(x);return{pathname:m.pathname,search:m.search,hash:m.hash}},push:f,replace:p,go(x){return i.go(x)}};return y}var Op;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(Op||(Op={}));function a2(t,e,r){return r===void 0&&(r="/"),i2(t,e,r)}function i2(t,e,r,s){let n=typeof e=="string"?ga(e):e,o=fv(n.pathname||"/",r);if(o==null)return null;let i=uv(t);l2(i);let l=null;for(let c=0;l==null&&c<i.length;++c){let d=x2(o);l=_2(i[c],d)}return l}function uv(t,e,r,s){e===void 0&&(e=[]),r===void 0&&(r=[]),s===void 0&&(s="");let n=(o,i,l)=>{let c={relativePath:l===void 0?o.path||"":l,caseSensitive:o.caseSensitive===!0,childrenIndex:i,route:o};c.relativePath.startsWith("/")&&(Gt(c.relativePath.startsWith(s),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(s.length));let d=ho([s,c.relativePath]),u=r.concat(c);o.children&&o.children.length>0&&(Gt(o.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),uv(o.children,e,u,d)),!(o.path==null&&!o.index)&&e.push({path:d,score:p2(d,o.index),routesMeta:u})};return t.forEach((o,i)=>{var l;if(o.path===""||!((l=o.path)!=null&&l.includes("?")))n(o,i);else for(let c of hv(o.path))n(o,i,c)}),e}function hv(t){let e=t.split("/");if(e.length===0)return[];let[r,...s]=e,n=r.endsWith("?"),o=r.replace(/\?$/,"");if(s.length===0)return n?[o,""]:[o];let i=hv(s.join("/")),l=[];return l.push(...i.map(c=>c===""?o:[o,c].join("/"))),n&&l.push(...i),l.map(c=>t.startsWith("/")&&c===""?"/":c)}function l2(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:g2(e.routesMeta.map(s=>s.childrenIndex),r.routesMeta.map(s=>s.childrenIndex)))}const c2=/^:[\w-]+$/,d2=3,u2=2,h2=1,f2=10,m2=-2,Pp=t=>t==="*";function p2(t,e){let r=t.split("/"),s=r.length;return r.some(Pp)&&(s+=m2),e&&(s+=u2),r.filter(n=>!Pp(n)).reduce((n,o)=>n+(c2.test(o)?d2:o===""?h2:f2),s)}function g2(t,e){return t.length===e.length&&t.slice(0,-1).every((s,n)=>s===e[n])?t[t.length-1]-e[e.length-1]:0}function _2(t,e,r){let{routesMeta:s}=t,n={},o="/",i=[];for(let l=0;l<s.length;++l){let c=s[l],d=l===s.length-1,u=o==="/"?e:e.slice(o.length)||"/",h=y2({path:c.relativePath,caseSensitive:c.caseSensitive,end:d},u),f=c.route;if(!h)return null;Object.assign(n,h.params),i.push({params:n,pathname:ho([o,h.pathname]),pathnameBase:C2(ho([o,h.pathnameBase])),route:f}),h.pathnameBase!=="/"&&(o=ho([o,h.pathnameBase]))}return i}function y2(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,s]=v2(t.path,t.caseSensitive,t.end),n=e.match(r);if(!n)return null;let o=n[0],i=o.replace(/(.)\/+$/,"$1"),l=n.slice(1);return{params:s.reduce((d,u,h)=>{let{paramName:f,isOptional:p}=u;if(f==="*"){let y=l[h]||"";i=o.slice(0,o.length-y.length).replace(/(.)\/+$/,"$1")}const g=l[h];return p&&!g?d[f]=void 0:d[f]=(g||"").replace(/%2F/g,"/"),d},{}),pathname:o,pathnameBase:i,pattern:t}}function v2(t,e,r){e===void 0&&(e=!1),r===void 0&&(r=!0),cv(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let s=[],n="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,l,c)=>(s.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(s.push({paramName:"*"}),n+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?n+="\\/*$":t!==""&&t!=="/"&&(n+="(?:(?=\\/|$))"),[new RegExp(n,e?void 0:"i"),s]}function x2(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return cv(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function fv(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,s=t.charAt(r);return s&&s!=="/"?null:t.slice(r)||"/"}function b2(t,e){e===void 0&&(e="/");let{pathname:r,search:s="",hash:n=""}=typeof t=="string"?ga(t):t;return{pathname:r?r.startsWith("/")?r:w2(r,e):e,search:j2(s),hash:k2(n)}}function w2(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(n=>{n===".."?r.length>1&&r.pop():n!=="."&&r.push(n)}),r.length>1?r.join("/"):"/"}function eu(t,e,r,s){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(s)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function S2(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function mv(t,e){let r=S2(t);return e?r.map((s,n)=>n===r.length-1?s.pathname:s.pathnameBase):r.map(s=>s.pathnameBase)}function pv(t,e,r,s){s===void 0&&(s=!1);let n;typeof t=="string"?n=ga(t):(n=Ei({},t),Gt(!n.pathname||!n.pathname.includes("?"),eu("?","pathname","search",n)),Gt(!n.pathname||!n.pathname.includes("#"),eu("#","pathname","hash",n)),Gt(!n.search||!n.search.includes("#"),eu("#","search","hash",n)));let o=t===""||n.pathname==="",i=o?"/":n.pathname,l;if(i==null)l=r;else{let h=e.length-1;if(!s&&i.startsWith("..")){let f=i.split("/");for(;f[0]==="..";)f.shift(),h-=1;n.pathname=f.join("/")}l=h>=0?e[h]:"/"}let c=b2(n,l),d=i&&i!=="/"&&i.endsWith("/"),u=(o||i===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(d||u)&&(c.pathname+="/"),c}const ho=t=>t.join("/").replace(/\/\/+/g,"/"),C2=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),j2=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,k2=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function N2(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const gv=["post","put","patch","delete"];new Set(gv);const I2=["get",...gv];new Set(I2);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ti(){return Ti=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},Ti.apply(this,arguments)}const zf=b.createContext(null),E2=b.createContext(null),qi=b.createContext(null),yd=b.createContext(null),$n=b.createContext({outlet:null,matches:[],isDataRoute:!1}),_v=b.createContext(null);function Gi(){return b.useContext(yd)!=null}function Ji(){return Gi()||Gt(!1),b.useContext(yd).location}function yv(t){b.useContext(qi).static||b.useLayoutEffect(t)}function _a(){let{isDataRoute:t}=b.useContext($n);return t?z2():T2()}function T2(){Gi()||Gt(!1);let t=b.useContext(zf),{basename:e,future:r,navigator:s}=b.useContext(qi),{matches:n}=b.useContext($n),{pathname:o}=Ji(),i=JSON.stringify(mv(n,r.v7_relativeSplatPath)),l=b.useRef(!1);return yv(()=>{l.current=!0}),b.useCallback(function(d,u){if(u===void 0&&(u={}),!l.current)return;if(typeof d=="number"){s.go(d);return}let h=pv(d,JSON.parse(i),o,u.relative==="path");t==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:ho([e,h.pathname])),(u.replace?s.replace:s.push)(h,u.state,u)},[e,s,i,o,t])}function A2(){let{matches:t}=b.useContext($n),e=t[t.length-1];return e?e.params:{}}function L2(t,e){return D2(t,e)}function D2(t,e,r,s){Gi()||Gt(!1);let{navigator:n}=b.useContext(qi),{matches:o}=b.useContext($n),i=o[o.length-1],l=i?i.params:{};i&&i.pathname;let c=i?i.pathnameBase:"/";i&&i.route;let d=Ji(),u;if(e){var h;let x=typeof e=="string"?ga(e):e;c==="/"||(h=x.pathname)!=null&&h.startsWith(c)||Gt(!1),u=x}else u=d;let f=u.pathname||"/",p=f;if(c!=="/"){let x=c.replace(/^\//,"").split("/");p="/"+f.replace(/^\//,"").split("/").slice(x.length).join("/")}let g=a2(t,{pathname:p}),y=$2(g&&g.map(x=>Object.assign({},x,{params:Object.assign({},l,x.params),pathname:ho([c,n.encodeLocation?n.encodeLocation(x.pathname).pathname:x.pathname]),pathnameBase:x.pathnameBase==="/"?c:ho([c,n.encodeLocation?n.encodeLocation(x.pathnameBase).pathname:x.pathnameBase])})),o,r,s);return e&&y?b.createElement(yd.Provider,{value:{location:Ti({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:yn.Pop}},y):y}function M2(){let t=V2(),e=N2(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,n={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return b.createElement(b.Fragment,null,b.createElement("h2",null,"Unexpected Application Error!"),b.createElement("h3",{style:{fontStyle:"italic"}},e),r?b.createElement("pre",{style:n},r):null,null)}const R2=b.createElement(M2,null);class O2 extends b.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,r){return r.location!==e.location||r.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:r.error,location:r.location,revalidation:e.revalidation||r.revalidation}}componentDidCatch(e,r){console.error("React Router caught the following error during render",e,r)}render(){return this.state.error!==void 0?b.createElement($n.Provider,{value:this.props.routeContext},b.createElement(_v.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function P2(t){let{routeContext:e,match:r,children:s}=t,n=b.useContext(zf);return n&&n.static&&n.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=r.route.id),b.createElement($n.Provider,{value:e},s)}function $2(t,e,r,s){var n;if(e===void 0&&(e=[]),r===void 0&&(r=null),s===void 0&&(s=null),t==null){var o;if(!r)return null;if(r.errors)t=r.matches;else if((o=s)!=null&&o.v7_partialHydration&&e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let i=t,l=(n=r)==null?void 0:n.errors;if(l!=null){let u=i.findIndex(h=>h.route.id&&(l==null?void 0:l[h.route.id])!==void 0);u>=0||Gt(!1),i=i.slice(0,Math.min(i.length,u+1))}let c=!1,d=-1;if(r&&s&&s.v7_partialHydration)for(let u=0;u<i.length;u++){let h=i[u];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(d=u),h.route.id){let{loaderData:f,errors:p}=r,g=h.route.loader&&f[h.route.id]===void 0&&(!p||p[h.route.id]===void 0);if(h.route.lazy||g){c=!0,d>=0?i=i.slice(0,d+1):i=[i[0]];break}}}return i.reduceRight((u,h,f)=>{let p,g=!1,y=null,x=null;r&&(p=l&&h.route.id?l[h.route.id]:void 0,y=h.route.errorElement||R2,c&&(d<0&&f===0?(U2("route-fallback"),g=!0,x=null):d===f&&(g=!0,x=h.route.hydrateFallbackElement||null)));let m=e.concat(i.slice(0,f+1)),_=()=>{let v;return p?v=y:g?v=x:h.route.Component?v=b.createElement(h.route.Component,null):h.route.element?v=h.route.element:v=u,b.createElement(P2,{match:h,routeContext:{outlet:u,matches:m,isDataRoute:r!=null},children:v})};return r&&(h.route.ErrorBoundary||h.route.errorElement||f===0)?b.createElement(O2,{location:r.location,revalidation:r.revalidation,component:y,error:p,children:_(),routeContext:{outlet:null,matches:m,isDataRoute:!0}}):_()},null)}var vv=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(vv||{}),xv=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(xv||{});function F2(t){let e=b.useContext(zf);return e||Gt(!1),e}function B2(t){let e=b.useContext(E2);return e||Gt(!1),e}function H2(t){let e=b.useContext($n);return e||Gt(!1),e}function bv(t){let e=H2(),r=e.matches[e.matches.length-1];return r.route.id||Gt(!1),r.route.id}function V2(){var t;let e=b.useContext(_v),r=B2(),s=bv();return e!==void 0?e:(t=r.errors)==null?void 0:t[s]}function z2(){let{router:t}=F2(vv.UseNavigateStable),e=bv(xv.UseNavigateStable),r=b.useRef(!1);return yv(()=>{r.current=!0}),b.useCallback(function(n,o){o===void 0&&(o={}),r.current&&(typeof n=="number"?t.navigate(n):t.navigate(n,Ti({fromRouteId:e},o)))},[t,e])}const $p={};function U2(t,e,r){$p[t]||($p[t]=!0)}function W2(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function Ai(t){let{to:e,replace:r,state:s,relative:n}=t;Gi()||Gt(!1);let{future:o,static:i}=b.useContext(qi),{matches:l}=b.useContext($n),{pathname:c}=Ji(),d=_a(),u=pv(e,mv(l,o.v7_relativeSplatPath),c,n==="path"),h=JSON.stringify(u);return b.useEffect(()=>d(JSON.parse(h),{replace:r,state:s,relative:n}),[d,h,n,r,s]),null}function ct(t){Gt(!1)}function q2(t){let{basename:e="/",children:r=null,location:s,navigationType:n=yn.Pop,navigator:o,static:i=!1,future:l}=t;Gi()&&Gt(!1);let c=e.replace(/^\/*/,"/"),d=b.useMemo(()=>({basename:c,navigator:o,static:i,future:Ti({v7_relativeSplatPath:!1},l)}),[c,l,o,i]);typeof s=="string"&&(s=ga(s));let{pathname:u="/",search:h="",hash:f="",state:p=null,key:g="default"}=s,y=b.useMemo(()=>{let x=fv(u,c);return x==null?null:{location:{pathname:x,search:h,hash:f,state:p,key:g},navigationType:n}},[c,u,h,f,p,g,n]);return y==null?null:b.createElement(qi.Provider,{value:d},b.createElement(yd.Provider,{children:r,value:y}))}function G2(t){let{children:e,location:r}=t;return L2(kh(e),r)}new Promise(()=>{});function kh(t,e){e===void 0&&(e=[]);let r=[];return b.Children.forEach(t,(s,n)=>{if(!b.isValidElement(s))return;let o=[...e,n];if(s.type===b.Fragment){r.push.apply(r,kh(s.props.children,o));return}s.type!==ct&&Gt(!1),!s.props.index||!s.props.children||Gt(!1);let i={id:s.props.id||o.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(i.children=kh(s.props.children,o)),r.push(i)}),r}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const J2="6";try{window.__reactRouterVersion=J2}catch{}const K2="startTransition",Fp=Wx[K2];function Y2(t){let{basename:e,children:r,future:s,window:n}=t,o=b.useRef();o.current==null&&(o.current=s2({window:n,v5Compat:!0}));let i=o.current,[l,c]=b.useState({action:i.action,location:i.location}),{v7_startTransition:d}=s||{},u=b.useCallback(h=>{d&&Fp?Fp(()=>c(h)):c(h)},[c,d]);return b.useLayoutEffect(()=>i.listen(u),[i,u]),b.useEffect(()=>W2(s),[s]),b.createElement(q2,{basename:e,children:r,location:l.location,navigationType:l.action,navigator:i,future:s})}var Bp;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(Bp||(Bp={}));var Hp;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(Hp||(Hp={}));var Nh=function(t,e){return Nh=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,s){r.__proto__=s}||function(r,s){for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(r[n]=s[n])},Nh(t,e)};function wv(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Nh(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Rc=function(){return Rc=Object.assign||function(e){for(var r,s=1,n=arguments.length;s<n;s++){r=arguments[s];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},Rc.apply(this,arguments)};function ya(t,e){var r={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(r[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(t);n<s.length;n++)e.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(t,s[n])&&(r[s[n]]=t[s[n]]);return r}function Sv(t,e,r,s){var n=arguments.length,o=n<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,r):s,i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(t,e,r,s);else for(var l=t.length-1;l>=0;l--)(i=t[l])&&(o=(n<3?i(o):n>3?i(e,r,o):i(e,r))||o);return n>3&&o&&Object.defineProperty(e,r,o),o}function Cv(t,e){return function(r,s){e(r,s,t)}}function jv(t,e,r,s,n,o){function i(m){if(m!==void 0&&typeof m!="function")throw new TypeError("Function expected");return m}for(var l=s.kind,c=l==="getter"?"get":l==="setter"?"set":"value",d=!e&&t?s.static?t:t.prototype:null,u=e||(d?Object.getOwnPropertyDescriptor(d,s.name):{}),h,f=!1,p=r.length-1;p>=0;p--){var g={};for(var y in s)g[y]=y==="access"?{}:s[y];for(var y in s.access)g.access[y]=s.access[y];g.addInitializer=function(m){if(f)throw new TypeError("Cannot add initializers after decoration has completed");o.push(i(m||null))};var x=(0,r[p])(l==="accessor"?{get:u.get,set:u.set}:u[c],g);if(l==="accessor"){if(x===void 0)continue;if(x===null||typeof x!="object")throw new TypeError("Object expected");(h=i(x.get))&&(u.get=h),(h=i(x.set))&&(u.set=h),(h=i(x.init))&&n.unshift(h)}else(h=i(x))&&(l==="field"?n.unshift(h):u[c]=h)}d&&Object.defineProperty(d,s.name,u),f=!0}function kv(t,e,r){for(var s=arguments.length>2,n=0;n<e.length;n++)r=s?e[n].call(t,r):e[n].call(t);return s?r:void 0}function Nv(t){return typeof t=="symbol"?t:"".concat(t)}function Iv(t,e,r){return typeof e=="symbol"&&(e=e.description?"[".concat(e.description,"]"):""),Object.defineProperty(t,"name",{configurable:!0,value:r?"".concat(r," ",e):e})}function Ev(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function ce(t,e,r,s){function n(o){return o instanceof r?o:new r(function(i){i(o)})}return new(r||(r=Promise))(function(o,i){function l(u){try{d(s.next(u))}catch(h){i(h)}}function c(u){try{d(s.throw(u))}catch(h){i(h)}}function d(u){u.done?o(u.value):n(u.value).then(l,c)}d((s=s.apply(t,e||[])).next())})}function Tv(t,e){var r={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},s,n,o,i=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function l(d){return function(u){return c([d,u])}}function c(d){if(s)throw new TypeError("Generator is already executing.");for(;i&&(i=0,d[0]&&(r=0)),r;)try{if(s=1,n&&(o=d[0]&2?n.return:d[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,d[1])).done)return o;switch(n=0,o&&(d=[d[0]&2,o.value]),d[0]){case 0:case 1:o=d;break;case 4:return r.label++,{value:d[1],done:!1};case 5:r.label++,n=d[1],d=[0];continue;case 7:d=r.ops.pop(),r.trys.pop();continue;default:if(o=r.trys,!(o=o.length>0&&o[o.length-1])&&(d[0]===6||d[0]===2)){r=0;continue}if(d[0]===3&&(!o||d[1]>o[0]&&d[1]<o[3])){r.label=d[1];break}if(d[0]===6&&r.label<o[1]){r.label=o[1],o=d;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(d);break}o[2]&&r.ops.pop(),r.trys.pop();continue}d=e.call(t,r)}catch(u){d=[6,u],n=0}finally{s=o=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}}var vd=Object.create?function(t,e,r,s){s===void 0&&(s=r);var n=Object.getOwnPropertyDescriptor(e,r);(!n||("get"in n?!e.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,s,n)}:function(t,e,r,s){s===void 0&&(s=r),t[s]=e[r]};function Av(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&vd(e,t,r)}function Oc(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],s=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&s>=t.length&&(t=void 0),{value:t&&t[s++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Uf(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var s=r.call(t),n,o=[],i;try{for(;(e===void 0||e-- >0)&&!(n=s.next()).done;)o.push(n.value)}catch(l){i={error:l}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}return o}function Lv(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Uf(arguments[e]));return t}function Dv(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var s=Array(t),n=0,e=0;e<r;e++)for(var o=arguments[e],i=0,l=o.length;i<l;i++,n++)s[n]=o[i];return s}function Mv(t,e,r){if(r||arguments.length===2)for(var s=0,n=e.length,o;s<n;s++)(o||!(s in e))&&(o||(o=Array.prototype.slice.call(e,0,s)),o[s]=e[s]);return t.concat(o||Array.prototype.slice.call(e))}function ua(t){return this instanceof ua?(this.v=t,this):new ua(t)}function Rv(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=r.apply(t,e||[]),n,o=[];return n=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),l("next"),l("throw"),l("return",i),n[Symbol.asyncIterator]=function(){return this},n;function i(p){return function(g){return Promise.resolve(g).then(p,h)}}function l(p,g){s[p]&&(n[p]=function(y){return new Promise(function(x,m){o.push([p,y,x,m])>1||c(p,y)})},g&&(n[p]=g(n[p])))}function c(p,g){try{d(s[p](g))}catch(y){f(o[0][3],y)}}function d(p){p.value instanceof ua?Promise.resolve(p.value.v).then(u,h):f(o[0][2],p)}function u(p){c("next",p)}function h(p){c("throw",p)}function f(p,g){p(g),o.shift(),o.length&&c(o[0][0],o[0][1])}}function Ov(t){var e,r;return e={},s("next"),s("throw",function(n){throw n}),s("return"),e[Symbol.iterator]=function(){return this},e;function s(n,o){e[n]=t[n]?function(i){return(r=!r)?{value:ua(t[n](i)),done:!1}:o?o(i):i}:o}}function Pv(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof Oc=="function"?Oc(t):t[Symbol.iterator](),r={},s("next"),s("throw"),s("return"),r[Symbol.asyncIterator]=function(){return this},r);function s(o){r[o]=t[o]&&function(i){return new Promise(function(l,c){i=t[o](i),n(l,c,i.done,i.value)})}}function n(o,i,l,c){Promise.resolve(c).then(function(d){o({value:d,done:l})},i)}}function $v(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}var Q2=Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e},Ih=function(t){return Ih=Object.getOwnPropertyNames||function(e){var r=[];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(r[r.length]=s);return r},Ih(t)};function Fv(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r=Ih(t),s=0;s<r.length;s++)r[s]!=="default"&&vd(e,t,r[s]);return Q2(e,t),e}function Bv(t){return t&&t.__esModule?t:{default:t}}function Hv(t,e,r,s){if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?s:r==="a"?s.call(t):s?s.value:e.get(t)}function Vv(t,e,r,s,n){if(s==="m")throw new TypeError("Private method is not writable");if(s==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return s==="a"?n.call(t,r):n?n.value=r:e.set(t,r),r}function zv(t,e){if(e===null||typeof e!="object"&&typeof e!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof t=="function"?e===t:t.has(e)}function Uv(t,e,r){if(e!=null){if(typeof e!="object"&&typeof e!="function")throw new TypeError("Object expected.");var s,n;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");s=e[Symbol.asyncDispose]}if(s===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");s=e[Symbol.dispose],r&&(n=s)}if(typeof s!="function")throw new TypeError("Object not disposable.");n&&(s=function(){try{n.call(this)}catch(o){return Promise.reject(o)}}),t.stack.push({value:e,dispose:s,async:r})}else r&&t.stack.push({async:!0});return e}var Z2=typeof SuppressedError=="function"?SuppressedError:function(t,e,r){var s=new Error(r);return s.name="SuppressedError",s.error=t,s.suppressed=e,s};function Wv(t){function e(o){t.error=t.hasError?new Z2(o,t.error,"An error was suppressed during disposal."):o,t.hasError=!0}var r,s=0;function n(){for(;r=t.stack.pop();)try{if(!r.async&&s===1)return s=0,t.stack.push(r),Promise.resolve().then(n);if(r.dispose){var o=r.dispose.call(r.value);if(r.async)return s|=2,Promise.resolve(o).then(n,function(i){return e(i),n()})}else s|=1}catch(i){e(i)}if(s===1)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}return n()}function qv(t,e){return typeof t=="string"&&/^\.\.?\//.test(t)?t.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(r,s,n,o,i){return s?e?".jsx":".js":n&&(!o||!i)?r:n+o+"."+i.toLowerCase()+"js"}):t}const X2={__extends:wv,__assign:Rc,__rest:ya,__decorate:Sv,__param:Cv,__esDecorate:jv,__runInitializers:kv,__propKey:Nv,__setFunctionName:Iv,__metadata:Ev,__awaiter:ce,__generator:Tv,__createBinding:vd,__exportStar:Av,__values:Oc,__read:Uf,__spread:Lv,__spreadArrays:Dv,__spreadArray:Mv,__await:ua,__asyncGenerator:Rv,__asyncDelegator:Ov,__asyncValues:Pv,__makeTemplateObject:$v,__importStar:Fv,__importDefault:Bv,__classPrivateFieldGet:Hv,__classPrivateFieldSet:Vv,__classPrivateFieldIn:zv,__addDisposableResource:Uv,__disposeResources:Wv,__rewriteRelativeImportExtension:qv},eS=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:Uv,get __assign(){return Rc},__asyncDelegator:Ov,__asyncGenerator:Rv,__asyncValues:Pv,__await:ua,__awaiter:ce,__classPrivateFieldGet:Hv,__classPrivateFieldIn:zv,__classPrivateFieldSet:Vv,__createBinding:vd,__decorate:Sv,__disposeResources:Wv,__esDecorate:jv,__exportStar:Av,__extends:wv,__generator:Tv,__importDefault:Bv,__importStar:Fv,__makeTemplateObject:$v,__metadata:Ev,__param:Cv,__propKey:Nv,__read:Uf,__rest:ya,__rewriteRelativeImportExtension:qv,__runInitializers:kv,__setFunctionName:Iv,__spread:Lv,__spreadArray:Mv,__spreadArrays:Dv,__values:Oc,default:X2},Symbol.toStringTag,{value:"Module"})),tS=t=>t?(...e)=>t(...e):(...e)=>fetch(...e);class Wf extends Error{constructor(e,r="FunctionsError",s){super(e),this.name=r,this.context=s}}class Vp extends Wf{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class zp extends Wf{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Up extends Wf{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Eh;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(Eh||(Eh={}));class rS{constructor(e,{headers:r={},customFetch:s,region:n=Eh.Any}={}){this.url=e,this.headers=r,this.region=n,this.fetch=tS(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return ce(this,arguments,void 0,function*(r,s={}){var n;try{const{headers:o,method:i,body:l,signal:c}=s;let d={},{region:u}=s;u||(u=this.region);const h=new URL(`${this.url}/${r}`);u&&u!=="any"&&(d["x-region"]=u,h.searchParams.set("forceFunctionRegion",u));let f;l&&(o&&!Object.prototype.hasOwnProperty.call(o,"Content-Type")||!o)?typeof Blob<"u"&&l instanceof Blob||l instanceof ArrayBuffer?(d["Content-Type"]="application/octet-stream",f=l):typeof l=="string"?(d["Content-Type"]="text/plain",f=l):typeof FormData<"u"&&l instanceof FormData?f=l:(d["Content-Type"]="application/json",f=JSON.stringify(l)):f=l;const p=yield this.fetch(h.toString(),{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},d),this.headers),o),body:f,signal:c}).catch(m=>{throw m.name==="AbortError"?m:new Vp(m)}),g=p.headers.get("x-relay-error");if(g&&g==="true")throw new zp(p);if(!p.ok)throw new Up(p);let y=((n=p.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),x;return y==="application/json"?x=yield p.json():y==="application/octet-stream"||y==="application/pdf"?x=yield p.blob():y==="text/event-stream"?x=p:y==="multipart/form-data"?x=yield p.formData():x=yield p.text(),{data:x,error:null,response:p}}catch(o){return o instanceof Error&&o.name==="AbortError"?{data:null,error:new Vp(o)}:{data:null,error:o,response:o instanceof Up||o instanceof zp?o.context:void 0}}})}}var Tr={};const va=Ex(eS);var vl={},xl={},bl={},wl={},Sl={},Cl={},Wp;function Gv(){if(Wp)return Cl;Wp=1,Object.defineProperty(Cl,"__esModule",{value:!0});class t extends Error{constructor(r){super(r.message),this.name="PostgrestError",this.details=r.details,this.hint=r.hint,this.code=r.code}}return Cl.default=t,Cl}var qp;function Jv(){if(qp)return Sl;qp=1,Object.defineProperty(Sl,"__esModule",{value:!0});const e=va.__importDefault(Gv());class r{constructor(n){var o,i;this.shouldThrowOnError=!1,this.method=n.method,this.url=n.url,this.headers=new Headers(n.headers),this.schema=n.schema,this.body=n.body,this.shouldThrowOnError=(o=n.shouldThrowOnError)!==null&&o!==void 0?o:!1,this.signal=n.signal,this.isMaybeSingle=(i=n.isMaybeSingle)!==null&&i!==void 0?i:!1,n.fetch?this.fetch=n.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(n,o){return this.headers=new Headers(this.headers),this.headers.set(n,o),this}then(n,o){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const i=this.fetch;let l=i(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async c=>{var d,u,h,f;let p=null,g=null,y=null,x=c.status,m=c.statusText;if(c.ok){if(this.method!=="HEAD"){const S=await c.text();S===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((d=this.headers.get("Accept"))===null||d===void 0)&&d.includes("application/vnd.pgrst.plan+text"))?g=S:g=JSON.parse(S))}const v=(u=this.headers.get("Prefer"))===null||u===void 0?void 0:u.match(/count=(exact|planned|estimated)/),w=(h=c.headers.get("content-range"))===null||h===void 0?void 0:h.split("/");v&&w&&w.length>1&&(y=parseInt(w[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(g)&&(g.length>1?(p={code:"PGRST116",details:`Results contain ${g.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},g=null,y=null,x=406,m="Not Acceptable"):g.length===1?g=g[0]:g=null)}else{const v=await c.text();try{p=JSON.parse(v),Array.isArray(p)&&c.status===404&&(g=[],p=null,x=200,m="OK")}catch{c.status===404&&v===""?(x=204,m="No Content"):p={message:v}}if(p&&this.isMaybeSingle&&(!((f=p==null?void 0:p.details)===null||f===void 0)&&f.includes("0 rows"))&&(p=null,x=200,m="OK"),p&&this.shouldThrowOnError)throw new e.default(p)}return{error:p,data:g,count:y,status:x,statusText:m}});return this.shouldThrowOnError||(l=l.catch(c=>{var d,u,h;return{error:{message:`${(d=c==null?void 0:c.name)!==null&&d!==void 0?d:"FetchError"}: ${c==null?void 0:c.message}`,details:`${(u=c==null?void 0:c.stack)!==null&&u!==void 0?u:""}`,hint:"",code:`${(h=c==null?void 0:c.code)!==null&&h!==void 0?h:""}`},data:null,count:null,status:0,statusText:""}})),l.then(n,o)}returns(){return this}overrideTypes(){return this}}return Sl.default=r,Sl}var Gp;function Kv(){if(Gp)return wl;Gp=1,Object.defineProperty(wl,"__esModule",{value:!0});const e=va.__importDefault(Jv());class r extends e.default{select(n){let o=!1;const i=(n??"*").split("").map(l=>/\s/.test(l)&&!o?"":(l==='"'&&(o=!o),l)).join("");return this.url.searchParams.set("select",i),this.headers.append("Prefer","return=representation"),this}order(n,{ascending:o=!0,nullsFirst:i,foreignTable:l,referencedTable:c=l}={}){const d=c?`${c}.order`:"order",u=this.url.searchParams.get(d);return this.url.searchParams.set(d,`${u?`${u},`:""}${n}.${o?"asc":"desc"}${i===void 0?"":i?".nullsfirst":".nullslast"}`),this}limit(n,{foreignTable:o,referencedTable:i=o}={}){const l=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(l,`${n}`),this}range(n,o,{foreignTable:i,referencedTable:l=i}={}){const c=typeof l>"u"?"offset":`${l}.offset`,d=typeof l>"u"?"limit":`${l}.limit`;return this.url.searchParams.set(c,`${n}`),this.url.searchParams.set(d,`${o-n+1}`),this}abortSignal(n){return this.signal=n,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:n=!1,verbose:o=!1,settings:i=!1,buffers:l=!1,wal:c=!1,format:d="text"}={}){var u;const h=[n?"analyze":null,o?"verbose":null,i?"settings":null,l?"buffers":null,c?"wal":null].filter(Boolean).join("|"),f=(u=this.headers.get("Accept"))!==null&&u!==void 0?u:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${d}; for="${f}"; options=${h};`),d==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(n){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${n}`),this}}return wl.default=r,wl}var Jp;function qf(){if(Jp)return bl;Jp=1,Object.defineProperty(bl,"__esModule",{value:!0});const e=va.__importDefault(Kv()),r=new RegExp("[,()]");class s extends e.default{eq(o,i){return this.url.searchParams.append(o,`eq.${i}`),this}neq(o,i){return this.url.searchParams.append(o,`neq.${i}`),this}gt(o,i){return this.url.searchParams.append(o,`gt.${i}`),this}gte(o,i){return this.url.searchParams.append(o,`gte.${i}`),this}lt(o,i){return this.url.searchParams.append(o,`lt.${i}`),this}lte(o,i){return this.url.searchParams.append(o,`lte.${i}`),this}like(o,i){return this.url.searchParams.append(o,`like.${i}`),this}likeAllOf(o,i){return this.url.searchParams.append(o,`like(all).{${i.join(",")}}`),this}likeAnyOf(o,i){return this.url.searchParams.append(o,`like(any).{${i.join(",")}}`),this}ilike(o,i){return this.url.searchParams.append(o,`ilike.${i}`),this}ilikeAllOf(o,i){return this.url.searchParams.append(o,`ilike(all).{${i.join(",")}}`),this}ilikeAnyOf(o,i){return this.url.searchParams.append(o,`ilike(any).{${i.join(",")}}`),this}is(o,i){return this.url.searchParams.append(o,`is.${i}`),this}in(o,i){const l=Array.from(new Set(i)).map(c=>typeof c=="string"&&r.test(c)?`"${c}"`:`${c}`).join(",");return this.url.searchParams.append(o,`in.(${l})`),this}contains(o,i){return typeof i=="string"?this.url.searchParams.append(o,`cs.${i}`):Array.isArray(i)?this.url.searchParams.append(o,`cs.{${i.join(",")}}`):this.url.searchParams.append(o,`cs.${JSON.stringify(i)}`),this}containedBy(o,i){return typeof i=="string"?this.url.searchParams.append(o,`cd.${i}`):Array.isArray(i)?this.url.searchParams.append(o,`cd.{${i.join(",")}}`):this.url.searchParams.append(o,`cd.${JSON.stringify(i)}`),this}rangeGt(o,i){return this.url.searchParams.append(o,`sr.${i}`),this}rangeGte(o,i){return this.url.searchParams.append(o,`nxl.${i}`),this}rangeLt(o,i){return this.url.searchParams.append(o,`sl.${i}`),this}rangeLte(o,i){return this.url.searchParams.append(o,`nxr.${i}`),this}rangeAdjacent(o,i){return this.url.searchParams.append(o,`adj.${i}`),this}overlaps(o,i){return typeof i=="string"?this.url.searchParams.append(o,`ov.${i}`):this.url.searchParams.append(o,`ov.{${i.join(",")}}`),this}textSearch(o,i,{config:l,type:c}={}){let d="";c==="plain"?d="pl":c==="phrase"?d="ph":c==="websearch"&&(d="w");const u=l===void 0?"":`(${l})`;return this.url.searchParams.append(o,`${d}fts${u}.${i}`),this}match(o){return Object.entries(o).forEach(([i,l])=>{this.url.searchParams.append(i,`eq.${l}`)}),this}not(o,i,l){return this.url.searchParams.append(o,`not.${i}.${l}`),this}or(o,{foreignTable:i,referencedTable:l=i}={}){const c=l?`${l}.or`:"or";return this.url.searchParams.append(c,`(${o})`),this}filter(o,i,l){return this.url.searchParams.append(o,`${i}.${l}`),this}}return bl.default=s,bl}var Kp;function Yv(){if(Kp)return xl;Kp=1,Object.defineProperty(xl,"__esModule",{value:!0});const e=va.__importDefault(qf());class r{constructor(n,{headers:o={},schema:i,fetch:l}){this.url=n,this.headers=new Headers(o),this.schema=i,this.fetch=l}select(n,o){const{head:i=!1,count:l}=o??{},c=i?"HEAD":"GET";let d=!1;const u=(n??"*").split("").map(h=>/\s/.test(h)&&!d?"":(h==='"'&&(d=!d),h)).join("");return this.url.searchParams.set("select",u),l&&this.headers.append("Prefer",`count=${l}`),new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(n,{count:o,defaultToNull:i=!0}={}){var l;const c="POST";if(o&&this.headers.append("Prefer",`count=${o}`),i||this.headers.append("Prefer","missing=default"),Array.isArray(n)){const d=n.reduce((u,h)=>u.concat(Object.keys(h)),[]);if(d.length>0){const u=[...new Set(d)].map(h=>`"${h}"`);this.url.searchParams.set("columns",u.join(","))}}return new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}upsert(n,{onConflict:o,ignoreDuplicates:i=!1,count:l,defaultToNull:c=!0}={}){var d;const u="POST";if(this.headers.append("Prefer",`resolution=${i?"ignore":"merge"}-duplicates`),o!==void 0&&this.url.searchParams.set("on_conflict",o),l&&this.headers.append("Prefer",`count=${l}`),c||this.headers.append("Prefer","missing=default"),Array.isArray(n)){const h=n.reduce((f,p)=>f.concat(Object.keys(p)),[]);if(h.length>0){const f=[...new Set(h)].map(p=>`"${p}"`);this.url.searchParams.set("columns",f.join(","))}}return new e.default({method:u,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}update(n,{count:o}={}){var i;const l="PATCH";return o&&this.headers.append("Prefer",`count=${o}`),new e.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}delete({count:n}={}){var o;const i="DELETE";return n&&this.headers.append("Prefer",`count=${n}`),new e.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}}return xl.default=r,xl}var Yp;function sS(){if(Yp)return vl;Yp=1,Object.defineProperty(vl,"__esModule",{value:!0});const t=va,e=t.__importDefault(Yv()),r=t.__importDefault(qf());class s{constructor(o,{headers:i={},schema:l,fetch:c}={}){this.url=o,this.headers=new Headers(i),this.schemaName=l,this.fetch=c}from(o){const i=new URL(`${this.url}/${o}`);return new e.default(i,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(o){return new s(this.url,{headers:this.headers,schema:o,fetch:this.fetch})}rpc(o,i={},{head:l=!1,get:c=!1,count:d}={}){var u;let h;const f=new URL(`${this.url}/rpc/${o}`);let p;l||c?(h=l?"HEAD":"GET",Object.entries(i).filter(([y,x])=>x!==void 0).map(([y,x])=>[y,Array.isArray(x)?`{${x.join(",")}}`:`${x}`]).forEach(([y,x])=>{f.searchParams.append(y,x)})):(h="POST",p=i);const g=new Headers(this.headers);return d&&g.set("Prefer",`count=${d}`),new r.default({method:h,url:f,headers:g,schema:this.schemaName,body:p,fetch:(u=this.fetch)!==null&&u!==void 0?u:fetch})}}return vl.default=s,vl}Object.defineProperty(Tr,"__esModule",{value:!0});var Qv=Tr.PostgrestError=i0=Tr.PostgrestBuilder=o0=Tr.PostgrestTransformBuilder=s0=Tr.PostgrestFilterBuilder=t0=Tr.PostgrestQueryBuilder=Xv=Tr.PostgrestClient=void 0;const xa=va,Zv=xa.__importDefault(sS());var Xv=Tr.PostgrestClient=Zv.default;const e0=xa.__importDefault(Yv());var t0=Tr.PostgrestQueryBuilder=e0.default;const r0=xa.__importDefault(qf());var s0=Tr.PostgrestFilterBuilder=r0.default;const n0=xa.__importDefault(Kv());var o0=Tr.PostgrestTransformBuilder=n0.default;const a0=xa.__importDefault(Jv());var i0=Tr.PostgrestBuilder=a0.default;const l0=xa.__importDefault(Gv());Qv=Tr.PostgrestError=l0.default;var c0=Tr.default={PostgrestClient:Zv.default,PostgrestQueryBuilder:e0.default,PostgrestFilterBuilder:r0.default,PostgrestTransformBuilder:n0.default,PostgrestBuilder:a0.default,PostgrestError:l0.default};const nS=Y_({__proto__:null,get PostgrestBuilder(){return i0},get PostgrestClient(){return Xv},get PostgrestError(){return Qv},get PostgrestFilterBuilder(){return s0},get PostgrestQueryBuilder(){return t0},get PostgrestTransformBuilder(){return o0},default:c0},[Tr]),{PostgrestClient:oS,PostgrestQueryBuilder:uQ,PostgrestFilterBuilder:hQ,PostgrestTransformBuilder:fQ,PostgrestBuilder:mQ,PostgrestError:pQ}=c0||nS;class aS{static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const s=r.node,n=parseInt(s.replace(/^v/,"").split(".")[0]);return n>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${n} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${n} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let r=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(r+=`

Suggested solution: ${e.workaround}`),new Error(r)}static createWebSocket(e,r){const s=this.getWebSocketConstructor();return new s(e,r)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const iS="2.79.0",lS=`realtime-js/${iS}`,cS="1.0.0",Th=1e4,dS=1e3,uS=100;var si;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(si||(si={}));var Xt;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(Xt||(Xt={}));var Ss;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(Ss||(Ss={}));var Ah;(function(t){t.websocket="websocket"})(Ah||(Ah={}));var eo;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(eo||(eo={}));class hS{constructor(){this.HEADER_LENGTH=1}decode(e,r){return e.constructor===ArrayBuffer?r(this._binaryDecode(e)):r(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const r=new DataView(e),s=new TextDecoder;return this._decodeBroadcast(e,r,s)}_decodeBroadcast(e,r,s){const n=r.getUint8(1),o=r.getUint8(2);let i=this.HEADER_LENGTH+2;const l=s.decode(e.slice(i,i+n));i=i+n;const c=s.decode(e.slice(i,i+o));i=i+o;const d=JSON.parse(s.decode(e.slice(i,e.byteLength)));return{ref:null,topic:l,event:c,payload:d}}}class d0{constructor(e,r){this.callback=e,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var dt;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(dt||(dt={}));const Qp=(t,e,r={})=>{var s;const n=(s=r.skipTypes)!==null&&s!==void 0?s:[];return e?Object.keys(e).reduce((o,i)=>(o[i]=fS(i,t,e,n),o),{}):{}},fS=(t,e,r,s)=>{const n=e.find(l=>l.name===t),o=n==null?void 0:n.type,i=r[t];return o&&!s.includes(o)?u0(o,i):Lh(i)},u0=(t,e)=>{if(t.charAt(0)==="_"){const r=t.slice(1,t.length);return _S(e,r)}switch(t){case dt.bool:return mS(e);case dt.float4:case dt.float8:case dt.int2:case dt.int4:case dt.int8:case dt.numeric:case dt.oid:return pS(e);case dt.json:case dt.jsonb:return gS(e);case dt.timestamp:return yS(e);case dt.abstime:case dt.date:case dt.daterange:case dt.int4range:case dt.int8range:case dt.money:case dt.reltime:case dt.text:case dt.time:case dt.timestamptz:case dt.timetz:case dt.tsrange:case dt.tstzrange:return Lh(e);default:return Lh(e)}},Lh=t=>t,mS=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},pS=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},gS=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},_S=(t,e)=>{if(typeof t!="string")return t;const r=t.length-1,s=t[r];if(t[0]==="{"&&s==="}"){let o;const i=t.slice(1,r);try{o=JSON.parse("["+i+"]")}catch{o=i?i.split(","):[]}return o.map(l=>u0(e,l))}return t},yS=t=>typeof t=="string"?t.replace(" ","T"):t,h0=t=>{const e=new URL(t);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class tu{constructor(e,r,s={},n=Th){this.channel=e,this.event=r,this.payload=s,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,r){var s;return this._hasReceived(e)&&r((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:e,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:r}){this.recHooks.filter(s=>s.status===e).forEach(s=>s.callback(r))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Zp;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(Zp||(Zp={}));class ni{constructor(e,r){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},n=>{const{onJoin:o,onLeave:i,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=ni.syncState(this.state,n,o,i),this.pendingDiffs.forEach(c=>{this.state=ni.syncDiff(this.state,c,o,i)}),this.pendingDiffs=[],l()}),this.channel._on(s.diff,{},n=>{const{onJoin:o,onLeave:i,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(n):(this.state=ni.syncDiff(this.state,n,o,i),l())}),this.onJoin((n,o,i)=>{this.channel._trigger("presence",{event:"join",key:n,currentPresences:o,newPresences:i})}),this.onLeave((n,o,i)=>{this.channel._trigger("presence",{event:"leave",key:n,currentPresences:o,leftPresences:i})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,r,s,n){const o=this.cloneDeep(e),i=this.transformState(r),l={},c={};return this.map(o,(d,u)=>{i[d]||(c[d]=u)}),this.map(i,(d,u)=>{const h=o[d];if(h){const f=u.map(x=>x.presence_ref),p=h.map(x=>x.presence_ref),g=u.filter(x=>p.indexOf(x.presence_ref)<0),y=h.filter(x=>f.indexOf(x.presence_ref)<0);g.length>0&&(l[d]=g),y.length>0&&(c[d]=y)}else l[d]=u}),this.syncDiff(o,{joins:l,leaves:c},s,n)}static syncDiff(e,r,s,n){const{joins:o,leaves:i}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return s||(s=()=>{}),n||(n=()=>{}),this.map(o,(l,c)=>{var d;const u=(d=e[l])!==null&&d!==void 0?d:[];if(e[l]=this.cloneDeep(c),u.length>0){const h=e[l].map(p=>p.presence_ref),f=u.filter(p=>h.indexOf(p.presence_ref)<0);e[l].unshift(...f)}s(l,u,c)}),this.map(i,(l,c)=>{let d=e[l];if(!d)return;const u=c.map(h=>h.presence_ref);d=d.filter(h=>u.indexOf(h.presence_ref)<0),e[l]=d,n(l,d,c),d.length===0&&delete e[l]}),e}static map(e,r){return Object.getOwnPropertyNames(e).map(s=>r(s,e[s]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((r,s)=>{const n=e[s];return"metas"in n?r[s]=n.metas.map(o=>(o.presence_ref=o.phx_ref,delete o.phx_ref,delete o.phx_ref_prev,o)):r[s]=n,r},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Xp;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(Xp||(Xp={}));var oi;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(oi||(oi={}));var qs;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(qs||(qs={}));class Gf{constructor(e,r={config:{}},s){var n,o;if(this.topic=e,this.params=r,this.socket=s,this.bindings={},this.state=Xt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new tu(this,Ss.join,this.params,this.timeout),this.rejoinTimer=new d0(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Xt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Xt.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=Xt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Xt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=Xt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Ss.reply,{},(i,l)=>{this._trigger(this._replyEventName(l),i)}),this.presence=new ni(this),this.broadcastEndpointURL=h0(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((o=(n=this.params.config)===null||n===void 0?void 0:n.broadcast)===null||o===void 0)&&o.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,r=this.timeout){var s,n,o;if(this.socket.isConnected()||this.socket.connect(),this.state==Xt.closed){const{config:{broadcast:i,presence:l,private:c}}=this.params,d=(n=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(p=>p.filter))!==null&&n!==void 0?n:[],u=!!this.bindings[oi.PRESENCE]&&this.bindings[oi.PRESENCE].length>0||((o=this.params.config.presence)===null||o===void 0?void 0:o.enabled)===!0,h={},f={broadcast:i,presence:Object.assign(Object.assign({},l),{enabled:u}),postgres_changes:d,private:c};this.socket.accessTokenValue&&(h.access_token=this.socket.accessTokenValue),this._onError(p=>e==null?void 0:e(qs.CHANNEL_ERROR,p)),this._onClose(()=>e==null?void 0:e(qs.CLOSED)),this.updateJoinPayload(Object.assign({config:f},h)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:p})=>{var g;if(this.socket.setAuth(),p===void 0){e==null||e(qs.SUBSCRIBED);return}else{const y=this.bindings.postgres_changes,x=(g=y==null?void 0:y.length)!==null&&g!==void 0?g:0,m=[];for(let _=0;_<x;_++){const v=y[_],{filter:{event:w,schema:S,table:E,filter:C}}=v,k=p&&p[_];if(k&&k.event===w&&k.schema===S&&k.table===E&&k.filter===C)m.push(Object.assign(Object.assign({},v),{id:k.id}));else{this.unsubscribe(),this.state=Xt.errored,e==null||e(qs.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=m,e&&e(qs.SUBSCRIBED);return}}).receive("error",p=>{this.state=Xt.errored,e==null||e(qs.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(p).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(qs.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,r={}){return await this.send({type:"presence",event:"track",payload:e},r.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,r,s){return this.state===Xt.joined&&e===oi.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,r,s)}async httpSend(e,r,s={}){var n;const o=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(r==null)return Promise.reject("Payload is required for httpSend()");const i={method:"POST",headers:{Authorization:o,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:r,private:this.private}]})},l=await this._fetchWithTimeout(this.broadcastEndpointURL,i,(n=s.timeout)!==null&&n!==void 0?n:this.timeout);if(l.status===202)return{success:!0};let c=l.statusText;try{const d=await l.json();c=d.error||d.message||c}catch{}return Promise.reject(new Error(c))}async send(e,r={}){var s,n;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:o,payload:i}=e,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:o,payload:i,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(s=r.timeout)!==null&&s!==void 0?s:this.timeout);return await((n=d.body)===null||n===void 0?void 0:n.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(o=>{var i,l,c;const d=this._push(e.type,e,r.timeout||this.timeout);e.type==="broadcast"&&!(!((c=(l=(i=this.params)===null||i===void 0?void 0:i.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&o("ok"),d.receive("ok",()=>o("ok")),d.receive("error",()=>o("error")),d.receive("timeout",()=>o("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Xt.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Ss.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(n=>{s=new tu(this,Ss.leave,{},e),s.receive("ok",()=>{r(),n("ok")}).receive("timeout",()=>{r(),n("timed out")}).receive("error",()=>{n("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{s==null||s.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Xt.closed,this.bindings={}}async _fetchWithTimeout(e,r,s){const n=new AbortController,o=setTimeout(()=>n.abort(),s),i=await this.socket.fetch(e,Object.assign(Object.assign({},r),{signal:n.signal}));return clearTimeout(o),i}_push(e,r,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new tu(this,e,r,s);return this._canPush()?n.send():this._addToPushBuffer(n),n}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>uS){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(e,r,s){return r}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,r,s){var n,o;const i=e.toLocaleLowerCase(),{close:l,error:c,leave:d,join:u}=Ss;if(s&&[l,c,d,u].indexOf(i)>=0&&s!==this._joinRef())return;let f=this._onMessage(i,r,s);if(r&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?(n=this.bindings.postgres_changes)===null||n===void 0||n.filter(p=>{var g,y,x;return((g=p.filter)===null||g===void 0?void 0:g.event)==="*"||((x=(y=p.filter)===null||y===void 0?void 0:y.event)===null||x===void 0?void 0:x.toLocaleLowerCase())===i}).map(p=>p.callback(f,s)):(o=this.bindings[i])===null||o===void 0||o.filter(p=>{var g,y,x,m,_,v;if(["broadcast","presence","postgres_changes"].includes(i))if("id"in p){const w=p.id,S=(g=p.filter)===null||g===void 0?void 0:g.event;return w&&((y=r.ids)===null||y===void 0?void 0:y.includes(w))&&(S==="*"||(S==null?void 0:S.toLocaleLowerCase())===((x=r.data)===null||x===void 0?void 0:x.type.toLocaleLowerCase()))}else{const w=(_=(m=p==null?void 0:p.filter)===null||m===void 0?void 0:m.event)===null||_===void 0?void 0:_.toLocaleLowerCase();return w==="*"||w===((v=r==null?void 0:r.event)===null||v===void 0?void 0:v.toLocaleLowerCase())}else return p.type.toLocaleLowerCase()===i}).map(p=>{if(typeof f=="object"&&"ids"in f){const g=f.data,{schema:y,table:x,commit_timestamp:m,type:_,errors:v}=g;f=Object.assign(Object.assign({},{schema:y,table:x,commit_timestamp:m,eventType:_,new:{},old:{},errors:v}),this._getPayloadRecords(g))}p.callback(f,s)})}_isClosed(){return this.state===Xt.closed}_isJoined(){return this.state===Xt.joined}_isJoining(){return this.state===Xt.joining}_isLeaving(){return this.state===Xt.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,r,s){const n=e.toLocaleLowerCase(),o={type:n,filter:r,callback:s};return this.bindings[n]?this.bindings[n].push(o):this.bindings[n]=[o],this}_off(e,r){const s=e.toLocaleLowerCase();return this.bindings[s]&&(this.bindings[s]=this.bindings[s].filter(n=>{var o;return!(((o=n.type)===null||o===void 0?void 0:o.toLocaleLowerCase())===s&&Gf.isEqual(n.filter,r))})),this}static isEqual(e,r){if(Object.keys(e).length!==Object.keys(r).length)return!1;for(const s in e)if(e[s]!==r[s])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Ss.close,{},e)}_onError(e){this._on(Ss.error,{},r=>e(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Xt.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const r={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(r.new=Qp(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(r.old=Qp(e.columns,e.old_record)),r}}const ru=()=>{},jl={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},vS=[1e3,2e3,5e3,1e4],xS=1e4,bS=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class wS{constructor(e,r){var s;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Th,this.transport=null,this.heartbeatIntervalMs=jl.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=ru,this.ref=0,this.reconnectTimer=null,this.logger=ru,this.conn=null,this.sendBuffer=[],this.serializer=new hS,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=n=>n?(...o)=>n(...o):(...o)=>fetch(...o),!(!((s=r==null?void 0:r.params)===null||s===void 0)&&s.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${e}/${Ah.websocket}`,this.httpEndpoint=h0(e),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=aS.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const r=e.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:cS}))}disconnect(e,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const s=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(s),this._setConnectionState("disconnected")},e?this.conn.close(e,r??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const r=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const e=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,r,s){this.logger(e,r,s)}connectionState(){switch(this.conn&&this.conn.readyState){case si.connecting:return eo.Connecting;case si.open:return eo.Open;case si.closing:return eo.Closing;default:return eo.Closed}}isConnected(){return this.connectionState()===eo.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,r={config:{}}){const s=`realtime:${e}`,n=this.getChannels().find(o=>o.topic===s);if(n)return n;{const o=new Gf(`realtime:${e}`,r,this);return this.channels.push(o),o}}push(e){const{topic:r,event:s,payload:n,ref:o}=e,i=()=>{this.encode(e,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${r} ${s} (${o})`,n),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(dS,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},jl.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let r=this.channels.find(s=>s.topic===e&&(s._isJoined()||s._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${e}"`),r.unsubscribe())}_remove(e){this.channels=this.channels.filter(r=>r.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(d){this.log("error","error in heartbeat callback",d)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:s,event:n,payload:o,ref:i}=r,l=i?`(${i})`:"",c=o.status||"";this.log("receive",`${c} ${s} ${n} ${l}`.trim(),o),this.channels.filter(d=>d._isMember(s)).forEach(d=>d._trigger(n,o,i)),this._triggerStateCallbacks("message",r)})}_clearTimer(e){var r;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var r;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(Ss.error))}_appendParams(e,r){if(Object.keys(r).length===0)return e;const s=e.match(/\?/)?"&":"?",n=new URLSearchParams(r);return`${e}${s}${n}`}_workerObjectUrl(e){let r;if(e)r=e;else{const s=new Blob([bS],{type:"application/javascript"});r=URL.createObjectURL(s)}return r}_setConnectionState(e,r=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(e=null){let r;e?r=e:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(s=>{const n={access_token:r,version:lS};r&&s.updateJoinPayload(n),s.joinedOnce&&s._isJoined()&&s._push(Ss.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${e}`,r)})}_triggerStateCallbacks(e,r){try{this.stateChangeCallbacks[e].forEach(s=>{try{s(r)}catch(n){this.log("error",`error in ${e} callback`,n)}})}catch(s){this.log("error",`error triggering ${e} callbacks`,s)}}_setupReconnectionTimer(){this.reconnectTimer=new d0(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},jl.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var r,s,n,o,i,l,c,d,u;if(this.transport=(r=e==null?void 0:e.transport)!==null&&r!==void 0?r:null,this.timeout=(s=e==null?void 0:e.timeout)!==null&&s!==void 0?s:Th,this.heartbeatIntervalMs=(n=e==null?void 0:e.heartbeatIntervalMs)!==null&&n!==void 0?n:jl.HEARTBEAT_INTERVAL,this.worker=(o=e==null?void 0:e.worker)!==null&&o!==void 0?o:!1,this.accessToken=(i=e==null?void 0:e.accessToken)!==null&&i!==void 0?i:null,this.heartbeatCallback=(l=e==null?void 0:e.heartbeatCallback)!==null&&l!==void 0?l:ru,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(c=e==null?void 0:e.reconnectAfterMs)!==null&&c!==void 0?c:h=>vS[h-1]||xS,this.encode=(d=e==null?void 0:e.encode)!==null&&d!==void 0?d:(h,f)=>f(JSON.stringify(h)),this.decode=(u=e==null?void 0:e.decode)!==null&&u!==void 0?u:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}class Jf extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Nt(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class SS extends Jf{constructor(e,r,s){super(e),this.name="StorageApiError",this.status=r,this.statusCode=s}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Dh extends Jf{constructor(e,r){super(e),this.name="StorageUnknownError",this.originalError=r}}const Kf=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),CS=()=>Response,Mh=t=>{if(Array.isArray(t))return t.map(r=>Mh(r));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([r,s])=>{const n=r.replace(/([-_][a-z])/gi,o=>o.toUpperCase().replace(/[-_]/g,""));e[n]=Mh(s)}),e},jS=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},su=t=>{var e;return t.msg||t.message||t.error_description||(typeof t.error=="string"?t.error:(e=t.error)===null||e===void 0?void 0:e.message)||JSON.stringify(t)},kS=(t,e,r)=>ce(void 0,void 0,void 0,function*(){const s=yield CS();t instanceof s&&!(r!=null&&r.noResolveJson)?t.json().then(n=>{const o=t.status||500,i=(n==null?void 0:n.statusCode)||o+"";e(new SS(su(n),o,i))}).catch(n=>{e(new Dh(su(n),n))}):e(new Dh(su(t),t))}),NS=(t,e,r,s)=>{const n={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"||!s?n:(jS(s)?(n.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),n.body=JSON.stringify(s)):n.body=s,e!=null&&e.duplex&&(n.duplex=e.duplex),Object.assign(Object.assign({},n),r))};function Ki(t,e,r,s,n,o){return ce(this,void 0,void 0,function*(){return new Promise((i,l)=>{t(r,NS(e,s,n,o)).then(c=>{if(!c.ok)throw c;return s!=null&&s.noResolveJson?c:c.json()}).then(c=>i(c)).catch(c=>kS(c,l,s))})})}function Li(t,e,r,s){return ce(this,void 0,void 0,function*(){return Ki(t,"GET",e,r,s)})}function bs(t,e,r,s,n){return ce(this,void 0,void 0,function*(){return Ki(t,"POST",e,s,n,r)})}function Rh(t,e,r,s,n){return ce(this,void 0,void 0,function*(){return Ki(t,"PUT",e,s,n,r)})}function IS(t,e,r,s){return ce(this,void 0,void 0,function*(){return Ki(t,"HEAD",e,Object.assign(Object.assign({},r),{noResolveJson:!0}),s)})}function Yf(t,e,r,s,n){return ce(this,void 0,void 0,function*(){return Ki(t,"DELETE",e,s,n,r)})}class ES{constructor(e,r){this.downloadFn=e,this.shouldThrowOnError=r}then(e,r){return this.execute().then(e,r)}execute(){return ce(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Nt(e))return{data:null,error:e};throw e}})}}var f0;class TS{constructor(e,r){this.downloadFn=e,this.shouldThrowOnError=r,this[f0]="BlobDownloadBuilder",this.promise=null}asStream(){return new ES(this.downloadFn,this.shouldThrowOnError)}then(e,r){return this.getPromise().then(e,r)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return ce(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Nt(e))return{data:null,error:e};throw e}})}}f0=Symbol.toStringTag;const AS={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},eg={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class LS{constructor(e,r={},s,n){this.shouldThrowOnError=!1,this.url=e,this.headers=r,this.bucketId=s,this.fetch=Kf(n)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,r,s,n){return ce(this,void 0,void 0,function*(){try{let o;const i=Object.assign(Object.assign({},eg),n);let l=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(i.upsert)});const c=i.metadata;typeof Blob<"u"&&s instanceof Blob?(o=new FormData,o.append("cacheControl",i.cacheControl),c&&o.append("metadata",this.encodeMetadata(c)),o.append("",s)):typeof FormData<"u"&&s instanceof FormData?(o=s,o.has("cacheControl")||o.append("cacheControl",i.cacheControl),c&&!o.has("metadata")&&o.append("metadata",this.encodeMetadata(c))):(o=s,l["cache-control"]=`max-age=${i.cacheControl}`,l["content-type"]=i.contentType,c&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(c))),(typeof ReadableStream<"u"&&o instanceof ReadableStream||o&&typeof o=="object"&&"pipe"in o&&typeof o.pipe=="function")&&!i.duplex&&(i.duplex="half")),n!=null&&n.headers&&(l=Object.assign(Object.assign({},l),n.headers));const d=this._removeEmptyFolders(r),u=this._getFinalPath(d),h=yield(e=="PUT"?Rh:bs)(this.fetch,`${this.url}/object/${u}`,o,Object.assign({headers:l},i!=null&&i.duplex?{duplex:i.duplex}:{}));return{data:{path:d,id:h.Id,fullPath:h.Key},error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(Nt(o))return{data:null,error:o};throw o}})}upload(e,r,s){return ce(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,r,s)})}uploadToSignedUrl(e,r,s,n){return ce(this,void 0,void 0,function*(){const o=this._removeEmptyFolders(e),i=this._getFinalPath(o),l=new URL(this.url+`/object/upload/sign/${i}`);l.searchParams.set("token",r);try{let c;const d=Object.assign({upsert:eg.upsert},n),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(d.upsert)});typeof Blob<"u"&&s instanceof Blob?(c=new FormData,c.append("cacheControl",d.cacheControl),c.append("",s)):typeof FormData<"u"&&s instanceof FormData?(c=s,c.append("cacheControl",d.cacheControl)):(c=s,u["cache-control"]=`max-age=${d.cacheControl}`,u["content-type"]=d.contentType);const h=yield Rh(this.fetch,l.toString(),c,{headers:u});return{data:{path:o,fullPath:h.Key},error:null}}catch(c){if(this.shouldThrowOnError)throw c;if(Nt(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(e,r){return ce(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e);const n=Object.assign({},this.headers);r!=null&&r.upsert&&(n["x-upsert"]="true");const o=yield bs(this.fetch,`${this.url}/object/upload/sign/${s}`,{},{headers:n}),i=new URL(this.url+o.url),l=i.searchParams.get("token");if(!l)throw new Jf("No token returned by API");return{data:{signedUrl:i.toString(),path:e,token:l},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Nt(s))return{data:null,error:s};throw s}})}update(e,r,s){return ce(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,r,s)})}move(e,r,s){return ce(this,void 0,void 0,function*(){try{return{data:yield bs(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Nt(n))return{data:null,error:n};throw n}})}copy(e,r,s){return ce(this,void 0,void 0,function*(){try{return{data:{path:(yield bs(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers})).Key},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Nt(n))return{data:null,error:n};throw n}})}createSignedUrl(e,r,s){return ce(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e),o=yield bs(this.fetch,`${this.url}/object/sign/${n}`,Object.assign({expiresIn:r},s!=null&&s.transform?{transform:s.transform}:{}),{headers:this.headers});const i=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return o={signedUrl:encodeURI(`${this.url}${o.signedURL}${i}`)},{data:o,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Nt(n))return{data:null,error:n};throw n}})}createSignedUrls(e,r,s){return ce(this,void 0,void 0,function*(){try{const n=yield bs(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:e},{headers:this.headers}),o=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return{data:n.map(i=>Object.assign(Object.assign({},i),{signedUrl:i.signedURL?encodeURI(`${this.url}${i.signedURL}${o}`):null})),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Nt(n))return{data:null,error:n};throw n}})}download(e,r){const n=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",o=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),i=o?`?${o}`:"",l=this._getFinalPath(e),c=()=>Li(this.fetch,`${this.url}/${n}/${l}${i}`,{headers:this.headers,noResolveJson:!0});return new TS(c,this.shouldThrowOnError)}info(e){return ce(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{const s=yield Li(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:Mh(s),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Nt(s))return{data:null,error:s};throw s}})}exists(e){return ce(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{return yield IS(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Nt(s)&&s instanceof Dh){const n=s.originalError;if([400,404].includes(n==null?void 0:n.status))return{data:!1,error:s}}throw s}})}getPublicUrl(e,r){const s=this._getFinalPath(e),n=[],o=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";o!==""&&n.push(o);const l=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});c!==""&&n.push(c);let d=n.join("&");return d!==""&&(d=`?${d}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${s}${d}`)}}}remove(e){return ce(this,void 0,void 0,function*(){try{return{data:yield Yf(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Nt(r))return{data:null,error:r};throw r}})}list(e,r,s){return ce(this,void 0,void 0,function*(){try{const n=Object.assign(Object.assign(Object.assign({},AS),r),{prefix:e||""});return{data:yield bs(this.fetch,`${this.url}/object/list/${this.bucketId}`,n,{headers:this.headers},s),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Nt(n))return{data:null,error:n};throw n}})}listV2(e,r){return ce(this,void 0,void 0,function*(){try{const s=Object.assign({},e);return{data:yield bs(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,s,{headers:this.headers},r),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Nt(s))return{data:null,error:s};throw s}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const r=[];return e.width&&r.push(`width=${e.width}`),e.height&&r.push(`height=${e.height}`),e.resize&&r.push(`resize=${e.resize}`),e.format&&r.push(`format=${e.format}`),e.quality&&r.push(`quality=${e.quality}`),r.join("&")}}const m0="2.79.0",p0={"X-Client-Info":`storage-js/${m0}`};class DS{constructor(e,r={},s,n){this.shouldThrowOnError=!1;const o=new URL(e);n!=null&&n.useNewHostname&&/supabase\.(co|in|red)$/.test(o.hostname)&&!o.hostname.includes("storage.supabase.")&&(o.hostname=o.hostname.replace("supabase.","storage.supabase.")),this.url=o.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},p0),r),this.fetch=Kf(s)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(e){return ce(this,void 0,void 0,function*(){try{const r=this.listBucketOptionsToQueryString(e);return{data:yield Li(this.fetch,`${this.url}/bucket${r}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Nt(r))return{data:null,error:r};throw r}})}getBucket(e){return ce(this,void 0,void 0,function*(){try{return{data:yield Li(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Nt(r))return{data:null,error:r};throw r}})}createBucket(e){return ce(this,arguments,void 0,function*(r,s={public:!1}){try{return{data:yield bs(this.fetch,`${this.url}/bucket`,{id:r,name:r,type:s.type,public:s.public,file_size_limit:s.fileSizeLimit,allowed_mime_types:s.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Nt(n))return{data:null,error:n};throw n}})}updateBucket(e,r){return ce(this,void 0,void 0,function*(){try{return{data:yield Rh(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Nt(s))return{data:null,error:s};throw s}})}emptyBucket(e){return ce(this,void 0,void 0,function*(){try{return{data:yield bs(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Nt(r))return{data:null,error:r};throw r}})}deleteBucket(e){return ce(this,void 0,void 0,function*(){try{return{data:yield Yf(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Nt(r))return{data:null,error:r};throw r}})}listBucketOptionsToQueryString(e){const r={};return e&&("limit"in e&&(r.limit=String(e.limit)),"offset"in e&&(r.offset=String(e.offset)),e.search&&(r.search=e.search),e.sortColumn&&(r.sortColumn=e.sortColumn),e.sortOrder&&(r.sortOrder=e.sortOrder)),Object.keys(r).length>0?"?"+new URLSearchParams(r).toString():""}}class MS{constructor(e,r={},s){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},p0),r),this.fetch=Kf(s)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return ce(this,void 0,void 0,function*(){try{return{data:yield bs(this.fetch,`${this.url}/bucket`,{name:e},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Nt(r))return{data:null,error:r};throw r}})}listBuckets(e){return ce(this,void 0,void 0,function*(){try{const r=new URLSearchParams;(e==null?void 0:e.limit)!==void 0&&r.set("limit",e.limit.toString()),(e==null?void 0:e.offset)!==void 0&&r.set("offset",e.offset.toString()),e!=null&&e.sortColumn&&r.set("sortColumn",e.sortColumn),e!=null&&e.sortOrder&&r.set("sortOrder",e.sortOrder),e!=null&&e.search&&r.set("search",e.search);const s=r.toString(),n=s?`${this.url}/bucket?${s}`:`${this.url}/bucket`;return{data:yield Li(this.fetch,n,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Nt(r))return{data:null,error:r};throw r}})}deleteBucket(e){return ce(this,void 0,void 0,function*(){try{return{data:yield Yf(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Nt(r))return{data:null,error:r};throw r}})}}const Qf={"X-Client-Info":`storage-js/${m0}`,"Content-Type":"application/json"};class g0 extends Error{constructor(e){super(e),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function Xr(t){return typeof t=="object"&&t!==null&&"__isStorageVectorsError"in t}class nu extends g0{constructor(e,r,s){super(e),this.name="StorageVectorsApiError",this.status=r,this.statusCode=s}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class RS extends g0{constructor(e,r){super(e),this.name="StorageVectorsUnknownError",this.originalError=r}}var tg;(function(t){t.InternalError="InternalError",t.S3VectorConflictException="S3VectorConflictException",t.S3VectorNotFoundException="S3VectorNotFoundException",t.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",t.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",t.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(tg||(tg={}));const Zf=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),OS=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},rg=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),PS=(t,e,r)=>ce(void 0,void 0,void 0,function*(){if(t&&typeof t=="object"&&"status"in t&&"ok"in t&&typeof t.status=="number"&&!(r!=null&&r.noResolveJson)){const n=t.status||500,o=t;if(typeof o.json=="function")o.json().then(i=>{const l=(i==null?void 0:i.statusCode)||(i==null?void 0:i.code)||n+"";e(new nu(rg(i),n,l))}).catch(()=>{const i=n+"",l=o.statusText||`HTTP ${n} error`;e(new nu(l,n,i))});else{const i=n+"",l=o.statusText||`HTTP ${n} error`;e(new nu(l,n,i))}}else e(new RS(rg(t),t))}),$S=(t,e,r,s)=>{const n={method:t,headers:(e==null?void 0:e.headers)||{}};return s?(OS(s)?(n.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),n.body=JSON.stringify(s)):n.body=s,Object.assign(Object.assign({},n),r)):n};function FS(t,e,r,s,n,o){return ce(this,void 0,void 0,function*(){return new Promise((i,l)=>{t(r,$S(e,s,n,o)).then(c=>{if(!c.ok)throw c;if(s!=null&&s.noResolveJson)return c;const d=c.headers.get("content-type");return!d||!d.includes("application/json")?{}:c.json()}).then(c=>i(c)).catch(c=>PS(c,l,s))})})}function es(t,e,r,s,n){return ce(this,void 0,void 0,function*(){return FS(t,"POST",e,s,n,r)})}class BS{constructor(e,r={},s){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Qf),r),this.fetch=Zf(s)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(e){return ce(this,void 0,void 0,function*(){try{return{data:(yield es(this.fetch,`${this.url}/CreateIndex`,e,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Xr(r))return{data:null,error:r};throw r}})}getIndex(e,r){return ce(this,void 0,void 0,function*(){try{return{data:yield es(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:e,indexName:r},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Xr(s))return{data:null,error:s};throw s}})}listIndexes(e){return ce(this,void 0,void 0,function*(){try{return{data:yield es(this.fetch,`${this.url}/ListIndexes`,e,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Xr(r))return{data:null,error:r};throw r}})}deleteIndex(e,r){return ce(this,void 0,void 0,function*(){try{return{data:(yield es(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:e,indexName:r},{headers:this.headers}))||{},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Xr(s))return{data:null,error:s};throw s}})}}class HS{constructor(e,r={},s){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Qf),r),this.fetch=Zf(s)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(e){return ce(this,void 0,void 0,function*(){try{if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield es(this.fetch,`${this.url}/PutVectors`,e,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Xr(r))return{data:null,error:r};throw r}})}getVectors(e){return ce(this,void 0,void 0,function*(){try{return{data:yield es(this.fetch,`${this.url}/GetVectors`,e,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Xr(r))return{data:null,error:r};throw r}})}listVectors(e){return ce(this,void 0,void 0,function*(){try{if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return{data:yield es(this.fetch,`${this.url}/ListVectors`,e,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Xr(r))return{data:null,error:r};throw r}})}queryVectors(e){return ce(this,void 0,void 0,function*(){try{return{data:yield es(this.fetch,`${this.url}/QueryVectors`,e,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Xr(r))return{data:null,error:r};throw r}})}deleteVectors(e){return ce(this,void 0,void 0,function*(){try{if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield es(this.fetch,`${this.url}/DeleteVectors`,e,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Xr(r))return{data:null,error:r};throw r}})}}class VS{constructor(e,r={},s){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Qf),r),this.fetch=Zf(s)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return ce(this,void 0,void 0,function*(){try{return{data:(yield es(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Xr(r))return{data:null,error:r};throw r}})}getBucket(e){return ce(this,void 0,void 0,function*(){try{return{data:yield es(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:e},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Xr(r))return{data:null,error:r};throw r}})}listBuckets(){return ce(this,arguments,void 0,function*(e={}){try{return{data:yield es(this.fetch,`${this.url}/ListVectorBuckets`,e,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Xr(r))return{data:null,error:r};throw r}})}deleteBucket(e){return ce(this,void 0,void 0,function*(){try{return{data:(yield es(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Xr(r))return{data:null,error:r};throw r}})}}class zS extends VS{constructor(e,r={}){super(e,r.headers||{},r.fetch)}from(e){return new US(this.url,this.headers,e,this.fetch)}}class US extends BS{constructor(e,r,s,n){super(e,r,n),this.vectorBucketName=s}createIndex(e){const r=Object.create(null,{createIndex:{get:()=>super.createIndex}});return ce(this,void 0,void 0,function*(){return r.createIndex.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const e=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return ce(this,arguments,void 0,function*(r={}){return e.listIndexes.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName}))})}getIndex(e){const r=Object.create(null,{getIndex:{get:()=>super.getIndex}});return ce(this,void 0,void 0,function*(){return r.getIndex.call(this,this.vectorBucketName,e)})}deleteIndex(e){const r=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return ce(this,void 0,void 0,function*(){return r.deleteIndex.call(this,this.vectorBucketName,e)})}index(e){return new WS(this.url,this.headers,this.vectorBucketName,e,this.fetch)}}class WS extends HS{constructor(e,r,s,n,o){super(e,r,o),this.vectorBucketName=s,this.indexName=n}putVectors(e){const r=Object.create(null,{putVectors:{get:()=>super.putVectors}});return ce(this,void 0,void 0,function*(){return r.putVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(e){const r=Object.create(null,{getVectors:{get:()=>super.getVectors}});return ce(this,void 0,void 0,function*(){return r.getVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const e=Object.create(null,{listVectors:{get:()=>super.listVectors}});return ce(this,arguments,void 0,function*(r={}){return e.listVectors.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(e){const r=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return ce(this,void 0,void 0,function*(){return r.queryVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(e){const r=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return ce(this,void 0,void 0,function*(){return r.deleteVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class qS extends DS{constructor(e,r={},s,n){super(e,r,s,n)}from(e){return new LS(this.url,this.headers,e,this.fetch)}get vectors(){return new zS(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new MS(this.url+"/iceberg",this.headers,this.fetch)}}const GS="2.79.0";let Ba="";typeof Deno<"u"?Ba="deno":typeof document<"u"?Ba="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Ba="react-native":Ba="node";const JS={"X-Client-Info":`supabase-js-${Ba}/${GS}`},KS={headers:JS},YS={schema:"public"},QS={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},ZS={},XS=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),eC=()=>Headers,tC=(t,e,r)=>{const s=XS(r),n=eC();return async(o,i)=>{var l;const c=(l=await e())!==null&&l!==void 0?l:t;let d=new n(i==null?void 0:i.headers);return d.has("apikey")||d.set("apikey",t),d.has("Authorization")||d.set("Authorization",`Bearer ${c}`),s(o,Object.assign(Object.assign({},i),{headers:d}))}};function rC(t){return t.endsWith("/")?t:t+"/"}function sC(t,e){var r,s;const{db:n,auth:o,realtime:i,global:l}=t,{db:c,auth:d,realtime:u,global:h}=e,f={db:Object.assign(Object.assign({},c),n),auth:Object.assign(Object.assign({},d),o),realtime:Object.assign(Object.assign({},u),i),storage:{},global:Object.assign(Object.assign(Object.assign({},h),l),{headers:Object.assign(Object.assign({},(r=h==null?void 0:h.headers)!==null&&r!==void 0?r:{}),(s=l==null?void 0:l.headers)!==null&&s!==void 0?s:{})}),accessToken:async()=>""};return t.accessToken?f.accessToken=t.accessToken:delete f.accessToken,f}function nC(t){const e=t==null?void 0:t.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(rC(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const _0="2.79.0",Mo=30*1e3,Oh=3,ou=Oh*Mo,oC="http://localhost:9999",aC="supabase.auth.token",iC={"X-Client-Info":`gotrue-js/${_0}`},Ph="X-Supabase-Api-Version",y0={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},lC=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,cC=10*60*1e3;class Di extends Error{constructor(e,r,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=s}}function _e(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class dC extends Di{constructor(e,r,s){super(e,r,s),this.name="AuthApiError",this.status=r,this.code=s}}function uC(t){return _e(t)&&t.name==="AuthApiError"}class to extends Di{constructor(e,r){super(e),this.name="AuthUnknownError",this.originalError=r}}class Fn extends Di{constructor(e,r,s,n){super(e,s,n),this.name=r,this.status=s}}class ys extends Fn{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function hC(t){return _e(t)&&t.name==="AuthSessionMissingError"}class jo extends Fn{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class kl extends Fn{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Nl extends Fn{constructor(e,r=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function fC(t){return _e(t)&&t.name==="AuthImplicitGrantRedirectError"}class sg extends Fn{constructor(e,r=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class $h extends Fn{constructor(e,r){super(e,"AuthRetryableFetchError",r,void 0)}}function au(t){return _e(t)&&t.name==="AuthRetryableFetchError"}class ng extends Fn{constructor(e,r,s){super(e,"AuthWeakPasswordError",r,"weak_password"),this.reasons=s}}class Fh extends Fn{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Pc="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),og=` 	
\r=`.split(""),mC=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<og.length;e+=1)t[og[e].charCodeAt(0)]=-2;for(let e=0;e<Pc.length;e+=1)t[Pc[e].charCodeAt(0)]=e;return t})();function ag(t,e,r){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;r(Pc[s]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;r(Pc[s]),e.queuedBits-=6}}function v0(t,e,r){const s=mC[t];if(s>-1)for(e.queue=e.queue<<6|s,e.queuedBits+=6;e.queuedBits>=8;)r(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(s===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function ig(t){const e=[],r=i=>{e.push(String.fromCodePoint(i))},s={utf8seq:0,codepoint:0},n={queue:0,queuedBits:0},o=i=>{_C(i,s,r)};for(let i=0;i<t.length;i+=1)v0(t.charCodeAt(i),n,o);return e.join("")}function pC(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function gC(t,e){for(let r=0;r<t.length;r+=1){let s=t.charCodeAt(r);if(s>55295&&s<=56319){const n=(s-55296)*1024&65535;s=(t.charCodeAt(r+1)-56320&65535|n)+65536,r+=1}pC(s,e)}}function _C(t,e,r){if(e.utf8seq===0){if(t<=127){r(t);return}for(let s=1;s<6;s+=1)if(!(t>>7-s&1)){e.utf8seq=s;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&r(e.codepoint)}}function ta(t){const e=[],r={queue:0,queuedBits:0},s=n=>{e.push(n)};for(let n=0;n<t.length;n+=1)v0(t.charCodeAt(n),r,s);return new Uint8Array(e)}function yC(t){const e=[];return gC(t,r=>e.push(r)),new Uint8Array(e)}function io(t){const e=[],r={queue:0,queuedBits:0},s=n=>{e.push(n)};return t.forEach(n=>ag(n,r,s)),ag(null,r,s),e.join("")}function vC(t){return Math.round(Date.now()/1e3)+t}function xC(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const xr=()=>typeof window<"u"&&typeof document<"u",Hn={tested:!1,writable:!1},x0=()=>{if(!xr())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Hn.tested)return Hn.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),Hn.tested=!0,Hn.writable=!0}catch{Hn.tested=!0,Hn.writable=!1}return Hn.writable};function bC(t){const e={},r=new URL(t);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((n,o)=>{e[o]=n})}catch{}return r.searchParams.forEach((s,n)=>{e[n]=s}),e}const b0=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),wC=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",Ro=async(t,e,r)=>{await t.setItem(e,JSON.stringify(r))},Vn=async(t,e)=>{const r=await t.getItem(e);if(!r)return null;try{return JSON.parse(r)}catch{return r}},on=async(t,e)=>{await t.removeItem(e)};class xd{constructor(){this.promise=new xd.promiseConstructor((e,r)=>{this.resolve=e,this.reject=r})}}xd.promiseConstructor=Promise;function iu(t){const e=t.split(".");if(e.length!==3)throw new Fh("Invalid JWT structure");for(let s=0;s<e.length;s++)if(!lC.test(e[s]))throw new Fh("JWT not in base64url format");return{header:JSON.parse(ig(e[0])),payload:JSON.parse(ig(e[1])),signature:ta(e[2]),raw:{header:e[0],payload:e[1]}}}async function SC(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function CC(t,e){return new Promise((s,n)=>{(async()=>{for(let o=0;o<1/0;o++)try{const i=await t(o);if(!e(o,null,i)){s(i);return}}catch(i){if(!e(o,i)){n(i);return}}})()})}function jC(t){return("0"+t.toString(16)).substr(-2)}function kC(){const e=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=r.length;let n="";for(let o=0;o<56;o++)n+=r.charAt(Math.floor(Math.random()*s));return n}return crypto.getRandomValues(e),Array.from(e,jC).join("")}async function NC(t){const r=new TextEncoder().encode(t),s=await crypto.subtle.digest("SHA-256",r),n=new Uint8Array(s);return Array.from(n).map(o=>String.fromCharCode(o)).join("")}async function IC(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const r=await NC(t);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function ko(t,e,r=!1){const s=kC();let n=s;r&&(n+="/PASSWORD_RECOVERY"),await Ro(t,`${e}-code-verifier`,n);const o=await IC(s);return[o,s===o?"plain":"s256"]}const EC=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function TC(t){const e=t.headers.get(Ph);if(!e||!e.match(EC))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function AC(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function LC(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const DC=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function No(t){if(!DC.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function lu(){const t={};return new Proxy(t,{get:(e,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const s=r.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function MC(t,e){return new Proxy(t,{get:(r,s,n)=>{if(s==="__isInsecureUserWarningProxy")return!0;if(typeof s=="symbol"){const o=s.toString();if(o==="Symbol(Symbol.toPrimitive)"||o==="Symbol(Symbol.toStringTag)"||o==="Symbol(util.inspect.custom)"||o==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,s,n)}return!e.value&&typeof s=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(r,s,n)}})}function lg(t){return JSON.parse(JSON.stringify(t))}const Zn=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),RC=[502,503,504];async function cg(t){var e;if(!wC(t))throw new $h(Zn(t),0);if(RC.includes(t.status))throw new $h(Zn(t),t.status);let r;try{r=await t.json()}catch(o){throw new to(Zn(o),o)}let s;const n=TC(t);if(n&&n.getTime()>=y0["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?s=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(s=r.error_code),s){if(s==="weak_password")throw new ng(Zn(r),t.status,((e=r.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(s==="session_not_found")throw new ys}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((o,i)=>o&&typeof i=="string",!0))throw new ng(Zn(r),t.status,r.weak_password.reasons);throw new dC(Zn(r),t.status||500,s)}const OC=(t,e,r,s)=>{const n={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),n.body=JSON.stringify(s),Object.assign(Object.assign({},n),r))};async function Se(t,e,r,s){var n;const o=Object.assign({},s==null?void 0:s.headers);o[Ph]||(o[Ph]=y0["2024-01-01"].name),s!=null&&s.jwt&&(o.Authorization=`Bearer ${s.jwt}`);const i=(n=s==null?void 0:s.query)!==null&&n!==void 0?n:{};s!=null&&s.redirectTo&&(i.redirect_to=s.redirectTo);const l=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",c=await PC(t,e,r+l,{headers:o,noResolveJson:s==null?void 0:s.noResolveJson},{},s==null?void 0:s.body);return s!=null&&s.xform?s==null?void 0:s.xform(c):{data:Object.assign({},c),error:null}}async function PC(t,e,r,s,n,o){const i=OC(e,s,n,o);let l;try{l=await t(r,Object.assign({},i))}catch(c){throw console.error(c),new $h(Zn(c),0)}if(l.ok||await cg(l),s!=null&&s.noResolveJson)return l;try{return await l.json()}catch(c){await cg(c)}}function vs(t){var e;let r=null;BC(t)&&(r=Object.assign({},t),t.expires_at||(r.expires_at=vC(t.expires_in)));const s=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:r,user:s},error:null}}function dg(t){const e=vs(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((r,s)=>r&&typeof s=="string",!0)&&(e.data.weak_password=t.weak_password),e}function mn(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function $C(t){return{data:t,error:null}}function FC(t){const{action_link:e,email_otp:r,hashed_token:s,redirect_to:n,verification_type:o}=t,i=ya(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:e,email_otp:r,hashed_token:s,redirect_to:n,verification_type:o},c=Object.assign({},i);return{data:{properties:l,user:c},error:null}}function ug(t){return t}function BC(t){return t.access_token&&t.refresh_token&&t.expires_in}const cu=["global","local","others"];class HC{constructor({url:e="",headers:r={},fetch:s}){this.url=e,this.headers=r,this.fetch=b0(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,r=cu[0]){if(cu.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${cu.join(", ")}`);try{return await Se(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(_e(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e,r={}){try{return await Se(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:mn})}catch(s){if(_e(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:r}=e,s=ya(e,["options"]),n=Object.assign(Object.assign({},s),r);return"newEmail"in s&&(n.new_email=s==null?void 0:s.newEmail,delete n.newEmail),await Se(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:FC,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(_e(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(e){try{return await Se(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:mn})}catch(r){if(_e(r))return{data:{user:null},error:r};throw r}}async listUsers(e){var r,s,n,o,i,l,c;try{const d={nextPage:null,lastPage:0,total:0},u=await Se(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(r=e==null?void 0:e.page)===null||r===void 0?void 0:r.toString())!==null&&s!==void 0?s:"",per_page:(o=(n=e==null?void 0:e.perPage)===null||n===void 0?void 0:n.toString())!==null&&o!==void 0?o:""},xform:ug});if(u.error)throw u.error;const h=await u.json(),f=(i=u.headers.get("x-total-count"))!==null&&i!==void 0?i:0,p=(c=(l=u.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return p.length>0&&(p.forEach(g=>{const y=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),x=JSON.parse(g.split(";")[1].split("=")[1]);d[`${x}Page`]=y}),d.total=parseInt(f)),{data:Object.assign(Object.assign({},h),d),error:null}}catch(d){if(_e(d))return{data:{users:[]},error:d};throw d}}async getUserById(e){No(e);try{return await Se(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:mn})}catch(r){if(_e(r))return{data:{user:null},error:r};throw r}}async updateUserById(e,r){No(e);try{return await Se(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:r,headers:this.headers,xform:mn})}catch(s){if(_e(s))return{data:{user:null},error:s};throw s}}async deleteUser(e,r=!1){No(e);try{return await Se(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:r},xform:mn})}catch(s){if(_e(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){No(e.userId);try{const{data:r,error:s}=await Se(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:n=>({data:{factors:n},error:null})});return{data:r,error:s}}catch(r){if(_e(r))return{data:null,error:r};throw r}}async _deleteFactor(e){No(e.userId),No(e.id);try{return{data:await Se(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(r){if(_e(r))return{data:null,error:r};throw r}}async _listOAuthClients(e){var r,s,n,o,i,l,c;try{const d={nextPage:null,lastPage:0,total:0},u=await Se(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(r=e==null?void 0:e.page)===null||r===void 0?void 0:r.toString())!==null&&s!==void 0?s:"",per_page:(o=(n=e==null?void 0:e.perPage)===null||n===void 0?void 0:n.toString())!==null&&o!==void 0?o:""},xform:ug});if(u.error)throw u.error;const h=await u.json(),f=(i=u.headers.get("x-total-count"))!==null&&i!==void 0?i:0,p=(c=(l=u.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return p.length>0&&(p.forEach(g=>{const y=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),x=JSON.parse(g.split(";")[1].split("=")[1]);d[`${x}Page`]=y}),d.total=parseInt(f)),{data:Object.assign(Object.assign({},h),d),error:null}}catch(d){if(_e(d))return{data:{clients:[]},error:d};throw d}}async _createOAuthClient(e){try{return await Se(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(_e(r))return{data:null,error:r};throw r}}async _getOAuthClient(e){try{return await Se(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(_e(r))return{data:null,error:r};throw r}}async _updateOAuthClient(e,r){try{return await Se(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:r,headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(_e(s))return{data:null,error:s};throw s}}async _deleteOAuthClient(e){try{return await Se(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(_e(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(e){try{return await Se(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(_e(r))return{data:null,error:r};throw r}}}function hg(t={}){return{getItem:e=>t[e]||null,setItem:(e,r)=>{t[e]=r},removeItem:e=>{delete t[e]}}}const Io={debug:!!(globalThis&&x0()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class w0 extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class VC extends w0{}async function zC(t,e,r){Io.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const s=new globalThis.AbortController;return e>0&&setTimeout(()=>{s.abort(),Io.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async n=>{if(n){Io.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,n.name);try{return await r()}finally{Io.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,n.name)}}else{if(e===0)throw Io.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new VC(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(Io.debug)try{const o=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(o,null,"  "))}catch(o){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",o)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function UC(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function S0(t){if(!/^0x[a-fA-F0-9]{40}$/.test(t))throw new Error(`@supabase/auth-js: Address "${t}" is invalid.`);return t.toLowerCase()}function WC(t){return parseInt(t,16)}function qC(t){const e=new TextEncoder().encode(t);return"0x"+Array.from(e,s=>s.toString(16).padStart(2,"0")).join("")}function GC(t){var e;const{chainId:r,domain:s,expirationTime:n,issuedAt:o=new Date,nonce:i,notBefore:l,requestId:c,resources:d,scheme:u,uri:h,version:f}=t;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!s)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(i&&i.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${i}`);if(!h)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(f!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${f}`);if(!((e=t.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${t.statement}`)}const p=S0(t.address),g=u?`${u}://${s}`:s,y=t.statement?`${t.statement}
`:"",x=`${g} wants you to sign in with your Ethereum account:
${p}

${y}`;let m=`URI: ${h}
Version: ${f}
Chain ID: ${r}${i?`
Nonce: ${i}`:""}
Issued At: ${o.toISOString()}`;if(n&&(m+=`
Expiration Time: ${n.toISOString()}`),l&&(m+=`
Not Before: ${l.toISOString()}`),c&&(m+=`
Request ID: ${c}`),d){let _=`
Resources:`;for(const v of d){if(!v||typeof v!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${v}`);_+=`
- ${v}`}m+=_}return`${x}
${m}`}class Ut extends Error{constructor({message:e,code:r,cause:s,name:n}){var o;super(e,{cause:s}),this.__isWebAuthnError=!0,this.name=(o=n??(s instanceof Error?s.name:void 0))!==null&&o!==void 0?o:"Unknown Error",this.code=r}}class $c extends Ut{constructor(e,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:e}),this.name="WebAuthnUnknownError",this.originalError=r}}function JC({error:t,options:e}){var r,s,n;const{publicKey:o}=e;if(!o)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Ut({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else if(t.name==="ConstraintError"){if(((r=o.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new Ut({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:t});if(e.mediation==="conditional"&&((s=o.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new Ut({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:t});if(((n=o.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new Ut({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:t})}else{if(t.name==="InvalidStateError")return new Ut({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:t});if(t.name==="NotAllowedError")return new Ut({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="NotSupportedError")return o.pubKeyCredParams.filter(l=>l.type==="public-key").length===0?new Ut({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:t}):new Ut({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:t});if(t.name==="SecurityError"){const i=window.location.hostname;if(C0(i)){if(o.rp.id!==i)return new Ut({message:`The RP ID "${o.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new Ut({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="TypeError"){if(o.user.id.byteLength<1||o.user.id.byteLength>64)return new Ut({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:t})}else if(t.name==="UnknownError")return new Ut({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new Ut({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}function KC({error:t,options:e}){const{publicKey:r}=e;if(!r)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Ut({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else{if(t.name==="NotAllowedError")return new Ut({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="SecurityError"){const s=window.location.hostname;if(C0(s)){if(r.rpId!==s)return new Ut({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new Ut({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="UnknownError")return new Ut({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new Ut({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}class YC{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const QC=new YC;function ZC(t){if(!t)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(t);const{challenge:e,user:r,excludeCredentials:s}=t,n=ya(t,["challenge","user","excludeCredentials"]),o=ta(e).buffer,i=Object.assign(Object.assign({},r),{id:ta(r.id).buffer}),l=Object.assign(Object.assign({},n),{challenge:o,user:i});if(s&&s.length>0){l.excludeCredentials=new Array(s.length);for(let c=0;c<s.length;c++){const d=s[c];l.excludeCredentials[c]=Object.assign(Object.assign({},d),{id:ta(d.id).buffer,type:d.type||"public-key",transports:d.transports})}}return l}function XC(t){if(!t)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(t);const{challenge:e,allowCredentials:r}=t,s=ya(t,["challenge","allowCredentials"]),n=ta(e).buffer,o=Object.assign(Object.assign({},s),{challenge:n});if(r&&r.length>0){o.allowCredentials=new Array(r.length);for(let i=0;i<r.length;i++){const l=r[i];o.allowCredentials[i]=Object.assign(Object.assign({},l),{id:ta(l.id).buffer,type:l.type||"public-key",transports:l.transports})}}return o}function ej(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const r=t;return{id:t.id,rawId:t.id,response:{attestationObject:io(new Uint8Array(t.response.attestationObject)),clientDataJSON:io(new Uint8Array(t.response.clientDataJSON))},type:"public-key",clientExtensionResults:t.getClientExtensionResults(),authenticatorAttachment:(e=r.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function tj(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const r=t,s=t.getClientExtensionResults(),n=t.response;return{id:t.id,rawId:t.id,response:{authenticatorData:io(new Uint8Array(n.authenticatorData)),clientDataJSON:io(new Uint8Array(n.clientDataJSON)),signature:io(new Uint8Array(n.signature)),userHandle:n.userHandle?io(new Uint8Array(n.userHandle)):void 0},type:"public-key",clientExtensionResults:s,authenticatorAttachment:(e=r.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function C0(t){return t==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(t)}function fg(){var t,e;return!!(xr()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.create)=="function"&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.get)=="function")}async function rj(t){try{const e=await navigator.credentials.create(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new $c("Browser returned unexpected credential type",e)}:{data:null,error:new $c("Empty credential response",e)}}catch(e){return{data:null,error:JC({error:e,options:t})}}}async function sj(t){try{const e=await navigator.credentials.get(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new $c("Browser returned unexpected credential type",e)}:{data:null,error:new $c("Empty credential response",e)}}catch(e){return{data:null,error:KC({error:e,options:t})}}}const nj={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"none"},oj={userVerification:"preferred",hints:["security-key"]};function Fc(...t){const e=n=>n!==null&&typeof n=="object"&&!Array.isArray(n),r=n=>n instanceof ArrayBuffer||ArrayBuffer.isView(n),s={};for(const n of t)if(n)for(const o in n){const i=n[o];if(i!==void 0)if(Array.isArray(i))s[o]=i;else if(r(i))s[o]=i;else if(e(i)){const l=s[o];e(l)?s[o]=Fc(l,i):s[o]=Fc(i)}else s[o]=i}return s}function aj(t,e){return Fc(nj,t,e||{})}function ij(t,e){return Fc(oj,t,e||{})}class lj{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:r,friendlyName:s,signal:n},o){try{const{data:i,error:l}=await this.client.mfa.challenge({factorId:e,webauthn:r});if(!i)return{data:null,error:l};const c=n??QC.createNewAbortSignal();if(i.webauthn.type==="create"){const{user:d}=i.webauthn.credential_options.publicKey;d.name||(d.name=`${d.id}:${s}`),d.displayName||(d.displayName=d.name)}switch(i.webauthn.type){case"create":{const d=aj(i.webauthn.credential_options.publicKey,o==null?void 0:o.create),{data:u,error:h}=await rj({publicKey:d,signal:c});return u?{data:{factorId:e,challengeId:i.id,webauthn:{type:i.webauthn.type,credential_response:u}},error:null}:{data:null,error:h}}case"request":{const d=ij(i.webauthn.credential_options.publicKey,o==null?void 0:o.request),{data:u,error:h}=await sj(Object.assign(Object.assign({},i.webauthn.credential_options),{publicKey:d,signal:c}));return u?{data:{factorId:e,challengeId:i.id,webauthn:{type:i.webauthn.type,credential_response:u}},error:null}:{data:null,error:h}}}}catch(i){return _e(i)?{data:null,error:i}:{data:null,error:new to("Unexpected error in challenge",i)}}}async _verify({challengeId:e,factorId:r,webauthn:s}){return this.client.mfa.verify({factorId:r,challengeId:e,webauthn:s})}async _authenticate({factorId:e,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:n}},o){if(!r)return{data:null,error:new Di("rpId is required for WebAuthn authentication")};try{if(!fg())return{data:null,error:new to("Browser does not support WebAuthn",null)};const{data:i,error:l}=await this.challenge({factorId:e,webauthn:{rpId:r,rpOrigins:s},signal:n},{request:o});if(!i)return{data:null,error:l};const{webauthn:c}=i;return this._verify({factorId:e,challengeId:i.challengeId,webauthn:{type:c.type,rpId:r,rpOrigins:s,credential_response:c.credential_response}})}catch(i){return _e(i)?{data:null,error:i}:{data:null,error:new to("Unexpected error in authenticate",i)}}}async _register({friendlyName:e,rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:n},o){if(!r)return{data:null,error:new Di("rpId is required for WebAuthn registration")};try{if(!fg())return{data:null,error:new to("Browser does not support WebAuthn",null)};const{data:i,error:l}=await this._enroll({friendlyName:e});if(!i)return await this.client.mfa.listFactors().then(u=>{var h;return(h=u.data)===null||h===void 0?void 0:h.all.find(f=>f.factor_type==="webauthn"&&f.friendly_name===e&&f.status!=="unverified")}).then(u=>u?this.client.mfa.unenroll({factorId:u==null?void 0:u.id}):void 0),{data:null,error:l};const{data:c,error:d}=await this._challenge({factorId:i.id,friendlyName:i.friendly_name,webauthn:{rpId:r,rpOrigins:s},signal:n},{create:o});return c?this._verify({factorId:i.id,challengeId:c.challengeId,webauthn:{rpId:r,rpOrigins:s,type:c.webauthn.type,credential_response:c.webauthn.credential_response}}):{data:null,error:d}}catch(i){return _e(i)?{data:null,error:i}:{data:null,error:new to("Unexpected error in register",i)}}}}UC();const cj={url:oC,storageKey:aC,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:iC,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function mg(t,e,r){return await r()}const Eo={};class Mi{get jwks(){var e,r;return(r=(e=Eo[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(e){Eo[this.storageKey]=Object.assign(Object.assign({},Eo[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,r;return(r=(e=Eo[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Eo[this.storageKey]=Object.assign(Object.assign({},Eo[this.storageKey]),{cachedAt:e})}constructor(e){var r,s;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Mi.nextInstanceID,Mi.nextInstanceID+=1,this.instanceID>0&&xr()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const n=Object.assign(Object.assign({},cj),e);if(this.logDebugMessages=!!n.debug,typeof n.debug=="function"&&(this.logger=n.debug),this.persistSession=n.persistSession,this.storageKey=n.storageKey,this.autoRefreshToken=n.autoRefreshToken,this.admin=new HC({url:n.url,headers:n.headers,fetch:n.fetch}),this.url=n.url,this.headers=n.headers,this.fetch=b0(n.fetch),this.lock=n.lock||mg,this.detectSessionInUrl=n.detectSessionInUrl,this.flowType=n.flowType,this.hasCustomAuthorizationHeader=n.hasCustomAuthorizationHeader,this.throwOnError=n.throwOnError,n.lock?this.lock=n.lock:xr()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=zC:this.lock=mg,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new lj(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this)},this.persistSession?(n.storage?this.storage=n.storage:x0()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=hg(this.memoryStorage)),n.userStorage&&(this.userStorage=n.userStorage)):(this.memoryStorage={},this.storage=hg(this.memoryStorage)),xr()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o),await this._notifyAllSubscribers(o.data.event,o.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${_0}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let r={},s="none";if(xr()&&(r=bC(window.location.href),this._isImplicitGrantCallback(r)?s="implicit":await this._isPKCECallback(r)&&(s="pkce")),xr()&&this.detectSessionInUrl&&s!=="none"){const{data:n,error:o}=await this._getSessionFromURL(r,s);if(o){if(this._debug("#_initialize()","error detecting session from URL",o),fC(o)){const c=(e=o.details)===null||e===void 0?void 0:e.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:o}}return await this._removeSession(),{error:o}}const{session:i,redirectType:l}=n;return this._debug("#_initialize()","detected session in URL",i,"redirect type",l),await this._saveSession(i),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return _e(r)?this._returnResult({error:r}):this._returnResult({error:new to("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var r,s,n;try{const o=await Se(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(r=e==null?void 0:e.options)===null||r===void 0?void 0:r.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.captchaToken}},xform:vs}),{data:i,error:l}=o;if(l||!i)return this._returnResult({data:{user:null,session:null},error:l});const c=i.session,d=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:d,session:c},error:null})}catch(o){if(_e(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async signUp(e){var r,s,n;try{let o;if("email"in e){const{email:u,password:h,options:f}=e;let p=null,g=null;this.flowType==="pkce"&&([p,g]=await ko(this.storage,this.storageKey)),o=await Se(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f==null?void 0:f.emailRedirectTo,body:{email:u,password:h,data:(r=f==null?void 0:f.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:p,code_challenge_method:g},xform:vs})}else if("phone"in e){const{phone:u,password:h,options:f}=e;o=await Se(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:h,data:(s=f==null?void 0:f.data)!==null&&s!==void 0?s:{},channel:(n=f==null?void 0:f.channel)!==null&&n!==void 0?n:"sms",gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:vs})}else throw new kl("You must provide either an email or phone number and a password");const{data:i,error:l}=o;if(l||!i)return this._returnResult({data:{user:null,session:null},error:l});const c=i.session,d=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:d,session:c},error:null})}catch(o){if(_e(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async signInWithPassword(e){try{let r;if("email"in e){const{email:o,password:i,options:l}=e;r=await Se(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:o,password:i,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:dg})}else if("phone"in e){const{phone:o,password:i,options:l}=e;r=await Se(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:o,password:i,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:dg})}else throw new kl("You must provide either an email or phone number and a password");const{data:s,error:n}=r;if(n)return this._returnResult({data:{user:null,session:null},error:n});if(!s||!s.session||!s.user){const o=new jo;return this._returnResult({data:{user:null,session:null},error:o})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:n})}catch(r){if(_e(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(e){var r,s,n,o;return await this._handleProviderSignIn(e.provider,{redirectTo:(r=e.options)===null||r===void 0?void 0:r.redirectTo,scopes:(s=e.options)===null||s===void 0?void 0:s.scopes,queryParams:(n=e.options)===null||n===void 0?void 0:n.queryParams,skipBrowserRedirect:(o=e.options)===null||o===void 0?void 0:o.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:r}=e;switch(r){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(e){var r,s,n,o,i,l,c,d,u,h,f;let p,g;if("message"in e)p=e.message,g=e.signature;else{const{chain:y,wallet:x,statement:m,options:_}=e;let v;if(xr())if(typeof x=="object")v=x;else{const N=window;if("ethereum"in N&&typeof N.ethereum=="object"&&"request"in N.ethereum&&typeof N.ethereum.request=="function")v=N.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof x!="object"||!(_!=null&&_.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");v=x}const w=new URL((r=_==null?void 0:_.url)!==null&&r!==void 0?r:window.location.href),S=await v.request({method:"eth_requestAccounts"}).then(N=>N).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!S||S.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const E=S0(S[0]);let C=(s=_==null?void 0:_.signInWithEthereum)===null||s===void 0?void 0:s.chainId;if(!C){const N=await v.request({method:"eth_chainId"});C=WC(N)}const k={domain:w.host,address:E,statement:m,uri:w.href,version:"1",chainId:C,nonce:(n=_==null?void 0:_.signInWithEthereum)===null||n===void 0?void 0:n.nonce,issuedAt:(i=(o=_==null?void 0:_.signInWithEthereum)===null||o===void 0?void 0:o.issuedAt)!==null&&i!==void 0?i:new Date,expirationTime:(l=_==null?void 0:_.signInWithEthereum)===null||l===void 0?void 0:l.expirationTime,notBefore:(c=_==null?void 0:_.signInWithEthereum)===null||c===void 0?void 0:c.notBefore,requestId:(d=_==null?void 0:_.signInWithEthereum)===null||d===void 0?void 0:d.requestId,resources:(u=_==null?void 0:_.signInWithEthereum)===null||u===void 0?void 0:u.resources};p=GC(k),g=await v.request({method:"personal_sign",params:[qC(p),E]})}try{const{data:y,error:x}=await Se(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:p,signature:g},!((h=e.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(f=e.options)===null||f===void 0?void 0:f.captchaToken}}:null),xform:vs});if(x)throw x;if(!y||!y.session||!y.user){const m=new jo;return this._returnResult({data:{user:null,session:null},error:m})}return y.session&&(await this._saveSession(y.session),await this._notifyAllSubscribers("SIGNED_IN",y.session)),this._returnResult({data:Object.assign({},y),error:x})}catch(y){if(_e(y))return this._returnResult({data:{user:null,session:null},error:y});throw y}}async signInWithSolana(e){var r,s,n,o,i,l,c,d,u,h,f,p;let g,y;if("message"in e)g=e.message,y=e.signature;else{const{chain:x,wallet:m,statement:_,options:v}=e;let w;if(xr())if(typeof m=="object")w=m;else{const E=window;if("solana"in E&&typeof E.solana=="object"&&("signIn"in E.solana&&typeof E.solana.signIn=="function"||"signMessage"in E.solana&&typeof E.solana.signMessage=="function"))w=E.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof m!="object"||!(v!=null&&v.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");w=m}const S=new URL((r=v==null?void 0:v.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in w&&w.signIn){const E=await w.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},v==null?void 0:v.signInWithSolana),{version:"1",domain:S.host,uri:S.href}),_?{statement:_}:null));let C;if(Array.isArray(E)&&E[0]&&typeof E[0]=="object")C=E[0];else if(E&&typeof E=="object"&&"signedMessage"in E&&"signature"in E)C=E;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in C&&"signature"in C&&(typeof C.signedMessage=="string"||C.signedMessage instanceof Uint8Array)&&C.signature instanceof Uint8Array)g=typeof C.signedMessage=="string"?C.signedMessage:new TextDecoder().decode(C.signedMessage),y=C.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in w)||typeof w.signMessage!="function"||!("publicKey"in w)||typeof w!="object"||!w.publicKey||!("toBase58"in w.publicKey)||typeof w.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");g=[`${S.host} wants you to sign in with your Solana account:`,w.publicKey.toBase58(),..._?["",_,""]:[""],"Version: 1",`URI: ${S.href}`,`Issued At: ${(n=(s=v==null?void 0:v.signInWithSolana)===null||s===void 0?void 0:s.issuedAt)!==null&&n!==void 0?n:new Date().toISOString()}`,...!((o=v==null?void 0:v.signInWithSolana)===null||o===void 0)&&o.notBefore?[`Not Before: ${v.signInWithSolana.notBefore}`]:[],...!((i=v==null?void 0:v.signInWithSolana)===null||i===void 0)&&i.expirationTime?[`Expiration Time: ${v.signInWithSolana.expirationTime}`]:[],...!((l=v==null?void 0:v.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${v.signInWithSolana.chainId}`]:[],...!((c=v==null?void 0:v.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${v.signInWithSolana.nonce}`]:[],...!((d=v==null?void 0:v.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${v.signInWithSolana.requestId}`]:[],...!((h=(u=v==null?void 0:v.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||h===void 0)&&h.length?["Resources",...v.signInWithSolana.resources.map(C=>`- ${C}`)]:[]].join(`
`);const E=await w.signMessage(new TextEncoder().encode(g),"utf8");if(!E||!(E instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");y=E}}try{const{data:x,error:m}=await Se(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:g,signature:io(y)},!((f=e.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(p=e.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:vs});if(m)throw m;if(!x||!x.session||!x.user){const _=new jo;return this._returnResult({data:{user:null,session:null},error:_})}return x.session&&(await this._saveSession(x.session),await this._notifyAllSubscribers("SIGNED_IN",x.session)),this._returnResult({data:Object.assign({},x),error:m})}catch(x){if(_e(x))return this._returnResult({data:{user:null,session:null},error:x});throw x}}async _exchangeCodeForSession(e){const r=await Vn(this.storage,`${this.storageKey}-code-verifier`),[s,n]=(r??"").split("/");try{const{data:o,error:i}=await Se(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:vs});if(await on(this.storage,`${this.storageKey}-code-verifier`),i)throw i;if(!o||!o.session||!o.user){const l=new jo;return this._returnResult({data:{user:null,session:null,redirectType:null},error:l})}return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),this._returnResult({data:Object.assign(Object.assign({},o),{redirectType:n??null}),error:i})}catch(o){if(_e(o))return this._returnResult({data:{user:null,session:null,redirectType:null},error:o});throw o}}async signInWithIdToken(e){try{const{options:r,provider:s,token:n,access_token:o,nonce:i}=e,l=await Se(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:n,access_token:o,nonce:i,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:vs}),{data:c,error:d}=l;if(d)return this._returnResult({data:{user:null,session:null},error:d});if(!c||!c.session||!c.user){const u=new jo;return this._returnResult({data:{user:null,session:null},error:u})}return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),this._returnResult({data:c,error:d})}catch(r){if(_e(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(e){var r,s,n,o,i;try{if("email"in e){const{email:l,options:c}=e;let d=null,u=null;this.flowType==="pkce"&&([d,u]=await ko(this.storage,this.storageKey));const{error:h}=await Se(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(r=c==null?void 0:c.data)!==null&&r!==void 0?r:{},create_user:(s=c==null?void 0:c.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:d,code_challenge_method:u},redirectTo:c==null?void 0:c.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:h})}if("phone"in e){const{phone:l,options:c}=e,{data:d,error:u}=await Se(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(n=c==null?void 0:c.data)!==null&&n!==void 0?n:{},create_user:(o=c==null?void 0:c.shouldCreateUser)!==null&&o!==void 0?o:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(i=c==null?void 0:c.channel)!==null&&i!==void 0?i:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:d==null?void 0:d.message_id},error:u})}throw new kl("You must provide either an email or phone number.")}catch(l){if(_e(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async verifyOtp(e){var r,s;try{let n,o;"options"in e&&(n=(r=e.options)===null||r===void 0?void 0:r.redirectTo,o=(s=e.options)===null||s===void 0?void 0:s.captchaToken);const{data:i,error:l}=await Se(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:o}}),redirectTo:n,xform:vs});if(l)throw l;if(!i)throw new Error("An error occurred on token verification.");const c=i.session,d=i.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),this._returnResult({data:{user:d,session:c},error:null})}catch(n){if(_e(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithSSO(e){var r,s,n;try{let o=null,i=null;this.flowType==="pkce"&&([o,i]=await ko(this.storage,this.storageKey));const l=await Se(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(s=(r=e.options)===null||r===void 0?void 0:r.redirectTo)!==null&&s!==void 0?s:void 0}),!((n=e==null?void 0:e.options)===null||n===void 0)&&n.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:o,code_challenge_method:i}),headers:this.headers,xform:$C});return this._returnResult(l)}catch(o){if(_e(o))return this._returnResult({data:null,error:o});throw o}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:r},error:s}=e;if(s)throw s;if(!r)throw new ys;const{error:n}=await Se(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:n})})}catch(e){if(_e(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const r=`${this.url}/resend`;if("email"in e){const{email:s,type:n,options:o}=e,{error:i}=await Se(this.fetch,"POST",r,{headers:this.headers,body:{email:s,type:n,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},redirectTo:o==null?void 0:o.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:i})}else if("phone"in e){const{phone:s,type:n,options:o}=e,{data:i,error:l}=await Se(this.fetch,"POST",r,{headers:this.headers,body:{phone:s,type:n,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:i==null?void 0:i.message_id},error:l})}throw new kl("You must provide either an email or phone number and a type")}catch(r){if(_e(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(e,r){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await s,await r()))();return this.pendingInLock.push((async()=>{try{await n}catch{}})()),n}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=r();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const n=[...this.pendingInLock];await Promise.all(n),this.pendingInLock.splice(0,n.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await e(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const r=await Vn(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?e=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=e.expires_at?e.expires_at*1e3-Date.now()<ou:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.userStorage){const i=await Vn(this.userStorage,this.storageKey+"-user");i!=null&&i.user?e.user=i.user:e.user=lu()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const i={value:this.suppressGetSessionWarning};e.user=MC(e.user,i),i.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:n,error:o}=await this._callRefreshToken(e.refresh_token);return o?this._returnResult({data:{session:null},error:o}):this._returnResult({data:{session:n},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await Se(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:mn}):await this._useSession(async r=>{var s,n,o;const{data:i,error:l}=r;if(l)throw l;return!(!((s=i.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new ys}:await Se(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(o=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&o!==void 0?o:void 0,xform:mn})})}catch(r){if(_e(r))return hC(r)&&(await this._removeSession(),await on(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(e,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,r))}async _updateUser(e,r={}){try{return await this._useSession(async s=>{const{data:n,error:o}=s;if(o)throw o;if(!n.session)throw new ys;const i=n.session;let l=null,c=null;this.flowType==="pkce"&&e.email!=null&&([l,c]=await ko(this.storage,this.storageKey));const{data:d,error:u}=await Se(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:l,code_challenge_method:c}),jwt:i.access_token,xform:mn});if(u)throw u;return i.user=d.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),this._returnResult({data:{user:i.user},error:null})})}catch(s){if(_e(s))return this._returnResult({data:{user:null},error:s});throw s}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new ys;const r=Date.now()/1e3;let s=r,n=!0,o=null;const{payload:i}=iu(e.access_token);if(i.exp&&(s=i.exp,n=s<=r),n){const{data:l,error:c}=await this._callRefreshToken(e.refresh_token);if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!l)return{data:{user:null,session:null},error:null};o=l}else{const{data:l,error:c}=await this._getUser(e.access_token);if(c)throw c;o={access_token:e.access_token,refresh_token:e.refresh_token,user:l.user,token_type:"bearer",expires_in:s-r,expires_at:s},await this._saveSession(o),await this._notifyAllSubscribers("SIGNED_IN",o)}return this._returnResult({data:{user:o.user,session:o},error:null})}catch(r){if(_e(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async r=>{var s;if(!e){const{data:i,error:l}=r;if(l)throw l;e=(s=i.session)!==null&&s!==void 0?s:void 0}if(!(e!=null&&e.refresh_token))throw new ys;const{data:n,error:o}=await this._callRefreshToken(e.refresh_token);return o?this._returnResult({data:{user:null,session:null},error:o}):n?this._returnResult({data:{user:n.user,session:n},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(_e(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(e,r){try{if(!xr())throw new Nl("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Nl(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new sg("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Nl("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new sg("No code detected.");const{data:_,error:v}=await this._exchangeCodeForSession(e.code);if(v)throw v;const w=new URL(window.location.href);return w.searchParams.delete("code"),window.history.replaceState(window.history.state,"",w.toString()),{data:{session:_.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:n,access_token:o,refresh_token:i,expires_in:l,expires_at:c,token_type:d}=e;if(!o||!l||!i||!d)throw new Nl("No session defined in URL");const u=Math.round(Date.now()/1e3),h=parseInt(l);let f=u+h;c&&(f=parseInt(c));const p=f-u;p*1e3<=Mo&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${p}s, should have been closer to ${h}s`);const g=f-h;u-g>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",g,f,u):u-g<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",g,f,u);const{data:y,error:x}=await this._getUser(o);if(x)throw x;const m={provider_token:s,provider_refresh_token:n,access_token:o,expires_in:h,expires_at:f,refresh_token:i,token_type:d,user:y.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:m,redirectType:e.type},error:null})}catch(s){if(_e(s))return this._returnResult({data:{session:null,redirectType:null},error:s});throw s}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const r=await Vn(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&r)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async r=>{var s;const{data:n,error:o}=r;if(o)return this._returnResult({error:o});const i=(s=n.session)===null||s===void 0?void 0:s.access_token;if(i){const{error:l}=await this.admin.signOut(i,e);if(l&&!(uC(l)&&(l.status===404||l.status===401||l.status===403)))return this._returnResult({error:l})}return e!=="others"&&(await this._removeSession(),await on(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const r=xC(),s={id:r,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,s),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async r=>{var s,n;try{const{data:{session:o},error:i}=r;if(i)throw i;await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",o)),this._debug("INITIAL_SESSION","callback id",e,"session",o)}catch(o){await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",o),console.error(o)}})}async resetPasswordForEmail(e,r={}){let s=null,n=null;this.flowType==="pkce"&&([s,n]=await ko(this.storage,this.storageKey,!0));try{return await Se(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:n,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(o){if(_e(o))return this._returnResult({data:null,error:o});throw o}}async getUserIdentities(){var e;try{const{data:r,error:s}=await this.getUser();if(s)throw s;return this._returnResult({data:{identities:(e=r.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(r){if(_e(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var r;try{const{data:s,error:n}=await this._useSession(async o=>{var i,l,c,d,u;const{data:h,error:f}=o;if(f)throw f;const p=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(i=e.options)===null||i===void 0?void 0:i.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=e.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await Se(this.fetch,"GET",p,{headers:this.headers,jwt:(u=(d=h.session)===null||d===void 0?void 0:d.access_token)!==null&&u!==void 0?u:void 0})});if(n)throw n;return xr()&&!(!((r=e.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(s==null?void 0:s.url),this._returnResult({data:{provider:e.provider,url:s==null?void 0:s.url},error:null})}catch(s){if(_e(s))return this._returnResult({data:{provider:e.provider,url:null},error:s});throw s}}async linkIdentityIdToken(e){return await this._useSession(async r=>{var s;try{const{error:n,data:{session:o}}=r;if(n)throw n;const{options:i,provider:l,token:c,access_token:d,nonce:u}=e,h=await Se(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(s=o==null?void 0:o.access_token)!==null&&s!==void 0?s:void 0,body:{provider:l,id_token:c,access_token:d,nonce:u,link_identity:!0,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},xform:vs}),{data:f,error:p}=h;return p?this._returnResult({data:{user:null,session:null},error:p}):!f||!f.session||!f.user?this._returnResult({data:{user:null,session:null},error:new jo}):(f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("USER_UPDATED",f.session)),this._returnResult({data:f,error:p}))}catch(n){if(_e(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}})}async unlinkIdentity(e){try{return await this._useSession(async r=>{var s,n;const{data:o,error:i}=r;if(i)throw i;return await Se(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(n=(s=o.session)===null||s===void 0?void 0:s.access_token)!==null&&n!==void 0?n:void 0})})}catch(r){if(_e(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(e){const r=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{const s=Date.now();return await CC(async n=>(n>0&&await SC(200*Math.pow(2,n-1)),this._debug(r,"refreshing attempt",n),await Se(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:vs})),(n,o)=>{const i=200*Math.pow(2,n);return o&&au(o)&&Date.now()+i-s<Mo})}catch(s){if(this._debug(r,"error",s),_e(s))return this._returnResult({data:{session:null,user:null},error:s});throw s}finally{this._debug(r,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,r){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",r,"url",s),xr()&&!r.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e,r;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const n=await Vn(this.storage,this.storageKey);if(n&&this.userStorage){let i=await Vn(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!i&&(i={user:n.user},await Ro(this.userStorage,this.storageKey+"-user",i)),n.user=(e=i==null?void 0:i.user)!==null&&e!==void 0?e:lu()}else if(n&&!n.user&&!n.user){const i=await Vn(this.storage,this.storageKey+"-user");i&&(i!=null&&i.user)?(n.user=i.user,await on(this.storage,this.storageKey+"-user"),await Ro(this.storage,this.storageKey,n)):n.user=lu()}if(this._debug(s,"session from storage",n),!this._isValidSession(n)){this._debug(s,"session is not valid"),n!==null&&await this._removeSession();return}const o=((r=n.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<ou;if(this._debug(s,`session has${o?"":" not"} expired with margin of ${ou}s`),o){if(this.autoRefreshToken&&n.refresh_token){const{error:i}=await this._callRefreshToken(n.refresh_token);i&&(console.error(i),au(i)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else if(n.user&&n.user.__isUserNotAvailableProxy===!0)try{const{data:i,error:l}=await this._getUser(n.access_token);!l&&(i!=null&&i.user)?(n.user=i.user,await this._saveSession(n),await this._notifyAllSubscribers("SIGNED_IN",n)):this._debug(s,"could not get user data, skipping SIGNED_IN notification")}catch(i){console.error("Error getting user data:",i),this._debug(s,"error getting user data, skipping SIGNED_IN notification",i)}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(s,"error",n),console.error(n);return}finally{this._debug(s,"end")}}async _callRefreshToken(e){var r,s;if(!e)throw new ys;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new xd;const{data:o,error:i}=await this._refreshAccessToken(e);if(i)throw i;if(!o.session)throw new ys;await this._saveSession(o.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",o.session);const l={data:o.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(o){if(this._debug(n,"error",o),_e(o)){const i={data:null,error:o};return au(o)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(i),i}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(o),o}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(e,r,s=!0){const n=`#_notifyAllSubscribers(${e})`;this._debug(n,"begin",r,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:r});const o=[],i=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(e,r)}catch(c){o.push(c)}});if(await Promise.all(i),o.length>0){for(let l=0;l<o.length;l+=1)console.error(o[l]);throw o[0]}}finally{this._debug(n,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const r=Object.assign({},e),s=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!s&&r.user&&await Ro(this.userStorage,this.storageKey+"-user",{user:r.user});const n=Object.assign({},r);delete n.user;const o=lg(n);await Ro(this.storage,this.storageKey,o)}else{const n=lg(r);await Ro(this.storage,this.storageKey,n)}}async _removeSession(){this._debug("#_removeSession()"),await on(this.storage,this.storageKey),await on(this.storage,this.storageKey+"-code-verifier"),await on(this.storage,this.storageKey+"-user"),this.userStorage&&await on(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&xr()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Mo);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async r=>{const{data:{session:s}}=r;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const n=Math.floor((s.expires_at*1e3-e)/Mo);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts ${Mo}ms, refresh threshold is ${Oh} ticks`),n<=Oh&&await this._callRefreshToken(s.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof w0)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!xr()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const r=`#_onVisibilityChanged(${e})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,r,s){const n=[`provider=${encodeURIComponent(r)}`];if(s!=null&&s.redirectTo&&n.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s!=null&&s.scopes&&n.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[o,i]=await ko(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(o)}`,code_challenge_method:`${encodeURIComponent(i)}`});n.push(l.toString())}if(s!=null&&s.queryParams){const o=new URLSearchParams(s.queryParams);n.push(o.toString())}return s!=null&&s.skipBrowserRedirect&&n.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${n.join("&")}`}async _unenroll(e){try{return await this._useSession(async r=>{var s;const{data:n,error:o}=r;return o?this._returnResult({data:null,error:o}):await Se(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(s=n==null?void 0:n.session)===null||s===void 0?void 0:s.access_token})})}catch(r){if(_e(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(e){try{return await this._useSession(async r=>{var s,n;const{data:o,error:i}=r;if(i)return this._returnResult({data:null,error:i});const l=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:c,error:d}=await Se(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(s=o==null?void 0:o.session)===null||s===void 0?void 0:s.access_token});return d?this._returnResult({data:null,error:d}):(e.factorType==="totp"&&c.type==="totp"&&(!((n=c==null?void 0:c.totp)===null||n===void 0)&&n.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),this._returnResult({data:c,error:null}))})}catch(r){if(_e(r))return this._returnResult({data:null,error:r});throw r}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var s;const{data:n,error:o}=r;if(o)return this._returnResult({data:null,error:o});const i=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?ej(e.webauthn.credential_response):tj(e.webauthn.credential_response)})}:{code:e.code}),{data:l,error:c}=await Se(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:i,headers:this.headers,jwt:(s=n==null?void 0:n.session)===null||s===void 0?void 0:s.access_token});return c?this._returnResult({data:null,error:c}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),this._returnResult({data:l,error:c}))})}catch(r){if(_e(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var s;const{data:n,error:o}=r;if(o)return this._returnResult({data:null,error:o});const i=await Se(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(s=n==null?void 0:n.session)===null||s===void 0?void 0:s.access_token});if(i.error)return i;const{data:l}=i;if(l.type!=="webauthn")return{data:l,error:null};switch(l.webauthn.type){case"create":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:ZC(l.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:XC(l.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(_e(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(e){const{data:r,error:s}=await this._challenge({factorId:e.factorId});return s?this._returnResult({data:null,error:s}):await this._verify({factorId:e.factorId,challengeId:r.id,code:e.code})}async _listFactors(){var e;const{data:{user:r},error:s}=await this.getUser();if(s)return{data:null,error:s};const n={all:[],phone:[],totp:[],webauthn:[]};for(const o of(e=r==null?void 0:r.factors)!==null&&e!==void 0?e:[])n.all.push(o),o.status==="verified"&&n[o.factor_type].push(o);return{data:n,error:null}}async _getAuthenticatorAssuranceLevel(){var e,r;const{data:{session:s},error:n}=await this.getSession();if(n)return this._returnResult({data:null,error:n});if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=iu(s.access_token);let i=null;o.aal&&(i=o.aal);let l=i;((r=(e=s.user.factors)===null||e===void 0?void 0:e.filter(u=>u.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(l="aal2");const d=o.amr||[];return{data:{currentLevel:i,nextLevel:l,currentAuthenticationMethods:d},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async r=>{const{data:{session:s},error:n}=r;return n?this._returnResult({data:null,error:n}):s?await Se(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:s.access_token,xform:o=>({data:o,error:null})}):this._returnResult({data:null,error:new ys})})}catch(r){if(_e(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(e,r){try{return await this._useSession(async s=>{const{data:{session:n},error:o}=s;if(o)return this._returnResult({data:null,error:o});if(!n)return this._returnResult({data:null,error:new ys});const i=await Se(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:n.access_token,body:{action:"approve"},xform:l=>({data:l,error:null})});return i.data&&i.data.redirect_url&&xr()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(i.data.redirect_url),i})}catch(s){if(_e(s))return this._returnResult({data:null,error:s});throw s}}async _denyAuthorization(e,r){try{return await this._useSession(async s=>{const{data:{session:n},error:o}=s;if(o)return this._returnResult({data:null,error:o});if(!n)return this._returnResult({data:null,error:new ys});const i=await Se(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:n.access_token,body:{action:"deny"},xform:l=>({data:l,error:null})});return i.data&&i.data.redirect_url&&xr()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(i.data.redirect_url),i})}catch(s){if(_e(s))return this._returnResult({data:null,error:s});throw s}}async fetchJwk(e,r={keys:[]}){let s=r.keys.find(l=>l.kid===e);if(s)return s;const n=Date.now();if(s=this.jwks.keys.find(l=>l.kid===e),s&&this.jwks_cached_at+cC>n)return s;const{data:o,error:i}=await Se(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;return!o.keys||o.keys.length===0||(this.jwks=o,this.jwks_cached_at=n,s=o.keys.find(l=>l.kid===e),!s)?null:s}async getClaims(e,r={}){try{let s=e;if(!s){const{data:p,error:g}=await this.getSession();if(g||!p.session)return this._returnResult({data:null,error:g});s=p.session.access_token}const{header:n,payload:o,signature:i,raw:{header:l,payload:c}}=iu(s);r!=null&&r.allowExpired||AC(o.exp);const d=!n.alg||n.alg.startsWith("HS")||!n.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(n.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!d){const{error:p}=await this.getUser(s);if(p)throw p;return{data:{claims:o,header:n,signature:i},error:null}}const u=LC(n.alg),h=await crypto.subtle.importKey("jwk",d,u,!0,["verify"]);if(!await crypto.subtle.verify(u,h,i,yC(`${l}.${c}`)))throw new Fh("Invalid JWT signature");return{data:{claims:o,header:n,signature:i},error:null}}catch(s){if(_e(s))return this._returnResult({data:null,error:s});throw s}}}Mi.nextInstanceID=0;const dj=Mi;class uj extends dj{constructor(e){super(e)}}class hj{constructor(e,r,s){var n,o,i;this.supabaseUrl=e,this.supabaseKey=r;const l=nC(e);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,d={db:YS,realtime:ZS,auth:Object.assign(Object.assign({},QS),{storageKey:c}),global:KS},u=sC(s??{},d);this.storageKey=(n=u.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(o=u.global.headers)!==null&&o!==void 0?o:{},u.accessToken?(this.accessToken=u.accessToken,this.auth=new Proxy({},{get:(h,f)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(f)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((i=u.auth)!==null&&i!==void 0?i:{},this.headers,u.global.fetch),this.fetch=tC(r,this._getAccessToken.bind(this),u.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},u.realtime)),this.rest=new oS(new URL("rest/v1",l).href,{headers:this.headers,schema:u.db.schema,fetch:this.fetch}),this.storage=new qS(this.storageUrl.href,this.headers,this.fetch,s==null?void 0:s.storage),u.accessToken||this._listenForAuthEvents()}get functions(){return new rS(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,r={},s={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,r,s)}channel(e,r={config:{}}){return this.realtime.channel(e,r)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e,r;if(this.accessToken)return await this.accessToken();const{data:s}=await this.auth.getSession();return(r=(e=s.session)===null||e===void 0?void 0:e.access_token)!==null&&r!==void 0?r:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:r,detectSessionInUrl:s,storage:n,userStorage:o,storageKey:i,flowType:l,lock:c,debug:d,throwOnError:u},h,f){const p={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new uj({url:this.authUrl.href,headers:Object.assign(Object.assign({},p),h),storageKey:i,autoRefreshToken:e,persistSession:r,detectSessionInUrl:s,storage:n,userStorage:o,flowType:l,lock:c,debug:d,throwOnError:u,fetch:f,hasCustomAuthorizationHeader:Object.keys(this.headers).some(g=>g.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new wS(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,s)=>{this._handleTokenChanged(r,"CLIENT",s==null?void 0:s.access_token)})}_handleTokenChanged(e,r,s){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==s?(this.changedAccessToken=s,this.realtime.setAuth(s)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const fj=(t,e,r)=>new hj(t,e,r);function mj(){if(typeof window<"u"||typeof process>"u")return!1;const t=process.version;if(t==null)return!1;const e=t.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}mj()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const pj="https://atkekzwgukdvucqntryo.supabase.co",gj="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImF0a2VrendndWtkdnVjcW50cnlvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDI4OTQwMjIsImV4cCI6MjA1ODQ3MDAyMn0.G4WqAmLvQSqYEfMWIpFOAZOYtnT0kxCxj8dVGhuUYO8",so=class so{constructor(){W(this,"client");this.client=fj(pj,gj,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0,storage:window.localStorage}}),console.log("Supabase initialized successfully with persistence")}static getInstance(){return so.instance||(so.instance=new so),so.instance}getClient(){return this.client}get auth(){return this.client.auth}from(e){return this.client.from(e)}async rpc(e,r){const{data:s,error:n}=await this.client.rpc(e,r);if(n)throw n;return s}};W(so,"instance");let Ri=so;class j0{constructor(){W(this,"supabase");this.supabase=Ri.getInstance().getClient()}async signIn(e,r){try{const{data:s,error:n}=await this.supabase.auth.signInWithPassword({email:e,password:r});if(n)throw n;return{success:!0,user:s.user,session:s.session}}catch(s){return console.error("Login error:",s),{success:!1,error:s instanceof Error?s.message:"Unknown error"}}}async signUp(e,r,s={}){try{const{data:n,error:o}=await this.supabase.auth.signUp({email:e,password:r,options:{data:s}});if(o)throw o;return{success:!0,user:n.user,session:n.session}}catch(n){return console.error("Signup error:",n),{success:!1,error:n instanceof Error?n.message:"Unknown error"}}}async signOut(){try{const{error:e}=await this.supabase.auth.signOut();return e&&console.warn("Supabase signout error:",e),localStorage.removeItem("user"),localStorage.removeItem("session"),localStorage.removeItem("companyChoosen"),localStorage.removeItem("storeChoosen"),sessionStorage.clear(),{success:!0}}catch(e){return console.error("Logout error:",e),localStorage.removeItem("user"),localStorage.removeItem("session"),localStorage.removeItem("companyChoosen"),localStorage.removeItem("storeChoosen"),sessionStorage.clear(),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}async getCurrentUser(){try{const{data:{session:e}}=await this.supabase.auth.getSession();if(!e)return{success:!0,user:null};const{data:{user:r},error:s}=await this.supabase.auth.getUser();if(s)throw s;return{success:!0,user:r}}catch(e){return console.error("Get user error:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error",user:null}}}async getCurrentSession(){try{const{data:{session:e},error:r}=await this.supabase.auth.getSession();if(r)throw r;return{success:!0,session:e}}catch(e){return console.error("Get session error:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}onAuthStateChange(e){return this.supabase.auth.onAuthStateChange((r,s)=>{e(r,s)})}async resetPassword(e){try{const r=`${window.location.origin}/auth/reset-password`,{error:s}=await this.supabase.auth.resetPasswordForEmail(e,{redirectTo:r});if(s)throw s;return{success:!0}}catch(r){return console.error("Reset password error:",r),{success:!1,error:r instanceof Error?r.message:"Unknown error"}}}}class k0{constructor(){W(this,"supabase");this.supabase=Ri.getInstance().getClient()}async getUserCompaniesAndStores(){try{const{data:e,error:r}=await this.supabase.rpc("get_user_companies_and_stores");if(r)throw r;return{success:!0,data:e}}catch(e){return console.error("Get companies error:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}async getCategoriesWithFeatures(e){try{const{data:r,error:s}=await this.supabase.rpc("get_categories_with_features",{p_company_id:e});if(s)throw s;return{success:!0,data:r}}catch(r){return console.error("Get categories error:",r),{success:!1,error:r instanceof Error?r.message:"Unknown error"}}}async query(e,r={}){try{let s=this.supabase.from(e).select(r.select||"*");r.filters&&Object.entries(r.filters).forEach(([i,l])=>{s=s.eq(i,l)}),r.orderBy&&(s=s.order(r.orderBy.column,{ascending:r.orderBy.ascending!==!1})),r.limit&&(s=s.limit(r.limit));const{data:n,error:o}=await s;if(o)throw o;return{success:!0,data:n}}catch(s){return console.error("Query error:",s),{success:!1,error:s instanceof Error?s.message:"Unknown error"}}}}const ne=Ri.getInstance(),cn=new j0;new k0;const _j=Object.freeze(Object.defineProperty({__proto__:null,AuthService:j0,DatabaseService:k0,authService:cn,supabaseService:ne},Symbol.toStringTag,{value:"Module"})),N0=b.createContext(void 0),yj=({children:t})=>{var g;const[e,r]=b.useState(null),[s,n]=b.useState(null),[o,i]=b.useState([]),[l,c]=b.useState(null),[d,u]=b.useState([]),h=async()=>{try{const{data:{session:y},error:x}=await ne.getClient().auth.getSession();if(x||!y)return;const{data:m,error:_}=await ne.getClient().rpc("get_user_companies_and_stores",{p_user_id:y.user.id});if(_){console.error("Failed to load user companies:",_);return}if(m&&localStorage.setItem("user",JSON.stringify(m)),m&&m.companies&&m.companies.length>0){i(m.companies);const v=localStorage.getItem("companyChoosen");let w=m.companies[0];if(v){const S=m.companies.find(E=>E.company_id===v);S&&(w=S)}if(r(w),localStorage.setItem("companyChoosen",w.company_id),w.stores&&w.stores.length>0){const S=w.stores[0];n(S),localStorage.setItem("storeChoosen",S.store_id)}}else i([])}catch(y){console.error("Error loading user data:",y)}},f=async()=>{try{const{data:{session:y},error:x}=await ne.getClient().auth.getSession();if(x||!y)return;const m=localStorage.getItem("categoryFeatures");if(m)try{const w=JSON.parse(m);u(w)}catch(w){console.error("Failed to parse stored category features:",w)}const{data:_,error:v}=await ne.getClient().rpc("get_categories_with_features");if(v){console.error("Failed to load category features:",v);return}_&&(localStorage.setItem("categoryFeatures",JSON.stringify(_)),u(_))}catch(y){console.error("Error loading category features:",y)}};b.useEffect(()=>{(async()=>{const{data:{session:x}}=await ne.getClient().auth.getSession();if(x){const m=localStorage.getItem("companyChoosen"),_=localStorage.getItem("storeChoosen"),v=localStorage.getItem("user");if(m&&v)try{const w=JSON.parse(v);if(w.companies&&w.companies.length>0){i(w.companies);const S=w.companies.find(E=>E.company_id===m);if(S){if(r(S),_&&S.stores&&S.stores.length>0){const E=S.stores.find(C=>C.store_id===_);E?n(E):S.stores.length>0&&n(S.stores[0])}}else{const E=w.companies[0];r(E),E.stores&&E.stores.length>0&&n(E.stores[0])}}}catch(w){console.error("Failed to parse stored user data:",w)}await h(),await f()}})()},[]);const p={currentCompany:e,currentStore:s,companies:o,currentUser:l,categoryFeatures:d,permissions:((g=e==null?void 0:e.role)==null?void 0:g.permissions)||[],setCurrentCompany:r,setCurrentStore:n,setCurrentUser:c,loadUserData:h,loadCategoryFeatures:f};return a.jsx(N0.Provider,{value:p,children:t})},at=()=>{const t=b.useContext(N0);if(!t)throw new Error("useAppState must be used within AppStateProvider");return t},pg=t=>{let e;const r=new Set,s=(d,u)=>{const h=typeof d=="function"?d(e):d;if(!Object.is(h,e)){const f=e;e=u??(typeof h!="object"||h===null)?h:Object.assign({},e,h),r.forEach(p=>p(e,f))}},n=()=>e,l={setState:s,getState:n,getInitialState:()=>c,subscribe:d=>(r.add(d),()=>r.delete(d))},c=e=t(s,n,l);return l},vj=t=>t?pg(t):pg,xj=t=>t;function bj(t,e=xj){const r=Ar.useSyncExternalStore(t.subscribe,Ar.useCallback(()=>e(t.getState()),[t,e]),Ar.useCallback(()=>e(t.getInitialState()),[t,e]));return Ar.useDebugValue(r),r}const gg=t=>{const e=vj(t),r=s=>bj(e,s);return Object.assign(r,e),r},Jt=t=>t?gg(t):gg,wj="modulepreload",Sj=function(t){return"/"+t},_g={},Xf=function(e,r,s){let n=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),l=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));n=Promise.allSettled(r.map(c=>{if(c=Sj(c),c in _g)return;_g[c]=!0;const d=c.endsWith(".css"),u=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${u}`))return;const h=document.createElement("link");if(h.rel=d?"stylesheet":wj,d||(h.as="script"),h.crossOrigin="",h.href=c,l&&h.setAttribute("nonce",l),document.head.appendChild(h),d)return new Promise((f,p)=>{h.addEventListener("load",f),h.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${c}`)))})}))}function o(i){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=i,window.dispatchEvent(l),!l.defaultPrevented)throw i}return n.then(i=>{for(const l of i||[])l.status==="rejected"&&o(l.reason);return e().catch(o)})};class I0{async signIn(e,r){return await cn.signIn(e,r)}async signUp(e,r,s,n,o){let i;try{i=Intl.DateTimeFormat().resolvedOptions().timeZone||"Asia/Ho_Chi_Minh",(i.startsWith("+")||i.startsWith("-")||i.length<3)&&(i="Asia/Ho_Chi_Minh")}catch(c){i="Asia/Ho_Chi_Minh",console.warn(" Failed to detect timezone, using default:",c)}const l=await cn.signUp(e,r,{first_name:s,last_name:n,full_name:`${s} ${n}`,preferred_timezone:i,...o});if(!l.user)return l;try{const{supabaseService:c}=await Xf(async()=>{const{supabaseService:u}=await Promise.resolve().then(()=>_j);return{supabaseService:u}},void 0),d=new Date().toISOString();await c.from("users").upsert({user_id:l.user.id,email:e,first_name:s,last_name:n,preferred_timezone:i,created_at:d,updated_at:d},{onConflict:"user_id"})}catch(c){console.error(" ERROR: Failed to create user profile for",l.user.id),console.error("Error:",c)}return l}async signOut(){return await cn.signOut()}async getCurrentUser(){return await cn.getCurrentUser()}async getCurrentSession(){return await cn.getCurrentSession()}async resetPassword(e){return await cn.resetPassword(e)}onAuthStateChange(e){return cn.onAuthStateChange(e)}}class Bc{constructor(e,r,s,n,o,i,l,c={},d=null,u=null,h="Asia/Ho_Chi_Minh",f=!1,p=null){this.id=e,this.email=r,this.firstName=s,this.lastName=n,this.emailConfirmed=o,this.createdAt=i,this.lastSignIn=l,this.metadata=c,this.userPhoneNumber=d,this.profileImage=u,this.preferredTimezone=h,this.isDeleted=f,this.updatedAt=p}get displayName(){return this.firstName&&this.lastName?`${this.firstName} ${this.lastName}`:this.metadata.full_name||this.email.split("@")[0]}get initials(){return this.firstName&&this.lastName?`${this.firstName[0]}${this.lastName[0]}`.toUpperCase():this.metadata.full_name?this.metadata.full_name.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2):this.email.slice(0,2).toUpperCase()}get isEmailVerified(){return this.emailConfirmed}static create(e){return new Bc(e.id,e.email,e.firstName||null,e.lastName||null,e.emailConfirmed,e.createdAt instanceof Date?e.createdAt:new Date(e.createdAt),e.lastSignIn?e.lastSignIn instanceof Date?e.lastSignIn:new Date(e.lastSignIn):null,e.metadata||{},e.userPhoneNumber||null,e.profileImage||null,e.preferredTimezone||"Asia/Ho_Chi_Minh",e.isDeleted||!1,e.updatedAt?e.updatedAt instanceof Date?e.updatedAt:new Date(e.updatedAt):null)}}class ic{static fromSupabase(e){var r,s,n,o,i;return Bc.create({id:e.id,email:e.email,firstName:((r=e.user_metadata)==null?void 0:r.first_name)||null,lastName:((s=e.user_metadata)==null?void 0:s.last_name)||null,emailConfirmed:e.email_confirmed_at!==null,createdAt:e.created_at,lastSignIn:e.last_sign_in_at,metadata:e.user_metadata||{},userPhoneNumber:((n=e.user_metadata)==null?void 0:n.user_phone_number)||null,profileImage:((o=e.user_metadata)==null?void 0:o.profile_image)||null,preferredTimezone:((i=e.user_metadata)==null?void 0:i.preferred_timezone)||"Asia/Ho_Chi_Minh",isDeleted:!1,updatedAt:e.updated_at||null})}static fromUsersTable(e){return Bc.create({id:e.user_id,email:e.email,firstName:e.first_name,lastName:e.last_name,emailConfirmed:e.email_confirmed_at!==null,createdAt:e.created_at,lastSignIn:e.last_sign_in_at||null,metadata:{},userPhoneNumber:e.user_phone_number||null,profileImage:e.profile_image||null,preferredTimezone:e.preferred_timezone||"Asia/Ho_Chi_Minh",isDeleted:e.is_deleted||!1,updatedAt:e.updated_at||null})}static toInsertMap(e){const r={user_id:e.id,email:e.email,created_at:e.createdAt.toISOString(),updated_at:new Date().toISOString()};return e.firstName&&(r.first_name=e.firstName),e.lastName&&(r.last_name=e.lastName),e.userPhoneNumber&&(r.user_phone_number=e.userPhoneNumber),e.profileImage&&(r.profile_image=e.profileImage),e.preferredTimezone&&(r.preferred_timezone=e.preferredTimezone),r}static toJson(e){var r,s;return{id:e.id,email:e.email,first_name:e.firstName,last_name:e.lastName,email_confirmed:e.emailConfirmed,created_at:e.createdAt.toISOString(),last_sign_in_at:((r=e.lastSignIn)==null?void 0:r.toISOString())||null,metadata:e.metadata,user_phone_number:e.userPhoneNumber,profile_image:e.profileImage,preferred_timezone:e.preferredTimezone,is_deleted:e.isDeleted,updated_at:((s=e.updatedAt)==null?void 0:s.toISOString())||null}}static toUpdateMap(e){const r={updated_at:new Date().toISOString()};return e.firstName&&(r.first_name=e.firstName),e.lastName&&(r.last_name=e.lastName),e.userPhoneNumber&&(r.user_phone_number=e.userPhoneNumber),e.profileImage&&(r.profile_image=e.profileImage),e.preferredTimezone&&(r.preferred_timezone=e.preferredTimezone),r}}class Cj{constructor(){W(this,"dataSource");this.dataSource=new I0}async signIn(e){try{const r=await this.dataSource.signIn(e.email,e.password);return!r.success||!r.user?{success:!1,error:r.error||"Login failed"}:(e.rememberMe!==void 0&&localStorage.setItem("rememberMe",e.rememberMe?"true":"false"),{success:!0,user:ic.fromSupabase(r.user)})}catch(r){return{success:!1,error:r instanceof Error?r.message:"An unexpected error occurred"}}}async signUp(e){try{const r=await this.dataSource.signUp(e.email,e.password,e.firstName,e.lastName,e.metadata);return!r.success||!r.user?{success:!1,error:r.error||"Signup failed"}:{success:!0,user:ic.fromSupabase(r.user)}}catch(r){return{success:!1,error:r instanceof Error?r.message:"An unexpected error occurred"}}}async signOut(){try{return await this.dataSource.signOut()}catch(e){return{success:!1,error:e instanceof Error?e.message:"Sign out failed"}}}async getCurrentUser(){try{const e=await this.dataSource.getCurrentUser();return!e.success||!e.user?null:ic.fromSupabase(e.user)}catch(e){return console.error("Get current user error:",e),null}}async isAuthenticated(){try{const e=await this.dataSource.getCurrentSession();return e.success&&e.session!==null}catch{return!1}}async resetPassword(e){try{return await this.dataSource.resetPassword(e)}catch(r){return{success:!1,error:r instanceof Error?r.message:"Password reset failed"}}}}class yg{static validateEmail(e){return!e||e.trim()===""?{field:"email",message:"Email is required"}:/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)?null:{field:"email",message:"Invalid email format"}}static validatePassword(e){return!e||e.trim()===""?{field:"password",message:"Password is required"}:e.length<6?{field:"password",message:"Password must be at least 6 characters"}:null}static validatePasswordConfirmation(e,r){return e!==r?{field:"passwordConfirmation",message:"Passwords do not match"}:null}static validateName(e,r){return!e||e.trim()===""?{field:r.toLowerCase().replace(" ",""),message:`${r} is required`}:e.trim().length<2?{field:r.toLowerCase().replace(" ",""),message:`${r} must be at least 2 characters`}:null}static validateLoginCredentials(e,r){const s=[],n=this.validateEmail(e);n&&s.push(n);const o=this.validatePassword(r);return o&&s.push(o),s}static validateSignupCredentials(e,r,s,n,o){const i=[],l=this.validateEmail(e);l&&i.push(l);const c=this.validatePassword(r);c&&i.push(c);const d=this.validatePasswordConfirmation(r,s);d&&i.push(d);const u=this.validateName(n,"First name");u&&i.push(u);const h=this.validateName(o,"Last name");return h&&i.push(h),i}}const Il=new Cj,El=new I0,ir=Jt((t,e)=>({user:null,loading:!0,authenticated:!1,error:null,sessionId:null,loginLoading:!1,loginError:null,loginFieldErrors:{},registerLoading:!1,registerError:null,registerFieldErrors:{},setUser:r=>t({user:r}),setLoading:r=>t({loading:r}),setAuthenticated:r=>t({authenticated:r}),setError:r=>t({error:r}),setSessionId:r=>t({sessionId:r}),reset:()=>t({user:null,authenticated:!1,error:null,sessionId:null,loginLoading:!1,loginError:null,loginFieldErrors:{},registerLoading:!1,registerError:null,registerFieldErrors:{}}),checkAuth:async()=>{var r;t({loading:!0,error:null});try{const s=await Il.getCurrentUser(),o=((r=(await El.getCurrentSession()).session)==null?void 0:r.access_token)||null;t({user:s,authenticated:s!==null,sessionId:o,loading:!1})}catch(s){console.error("Auth check error:",s),t({user:null,authenticated:!1,sessionId:null,error:s instanceof Error?s.message:"Authentication check failed",loading:!1})}},login:async(r,s,n=!1)=>{var o;t({loginLoading:!0,loginError:null,loginFieldErrors:{}});try{const i=yg.validateLoginCredentials(r,s);if(i.length>0){const c={};return i.forEach(d=>{c[d.field]=d.message}),t({loginFieldErrors:c,loginLoading:!1}),{success:!1,error:"Validation failed"}}const l=await Il.signIn({email:r,password:s,rememberMe:n});if(l.success&&l.user){const d=((o=(await El.getCurrentSession()).session)==null?void 0:o.access_token)||null;return t({user:l.user,authenticated:!0,sessionId:d,loginLoading:!1,loginError:null,loginFieldErrors:{}}),{success:!0}}else return t({loginError:l.error||"Login failed. Please try again.",loginLoading:!1}),{success:!1,error:l.error||"Login failed. Please try again."}}catch(i){const l=i instanceof Error?i.message:"An unexpected error occurred";return t({loginError:l,loginLoading:!1}),{success:!1,error:l}}},register:async(r,s,n,o,i)=>{var l;t({registerLoading:!0,registerError:null,registerFieldErrors:{}});try{const c=yg.validateSignupCredentials(r,s,n,o,i);if(c.length>0){const u={};return c.forEach(h=>{u[h.field]=h.message}),t({registerFieldErrors:u,registerLoading:!1}),{success:!1,error:"Validation failed"}}const d=await Il.signUp({email:r,password:s,firstName:o,lastName:i});if(d.success&&d.user){const h=((l=(await El.getCurrentSession()).session)==null?void 0:l.access_token)||null;return t({user:d.user,authenticated:!0,sessionId:h,registerLoading:!1,registerError:null,registerFieldErrors:{}}),{success:!0}}else return t({registerError:d.error||"Registration failed. Please try again.",registerLoading:!1}),{success:!1,error:d.error||"Registration failed. Please try again."}}catch(c){const d=c instanceof Error?c.message:"An unexpected error occurred";return t({registerError:d,registerLoading:!1}),{success:!1,error:d}}},signOut:async()=>{t({loading:!0,error:null});try{const r=await Il.signOut();return r.success?(e().reset(),t({loading:!1}),{success:!0}):(t({error:r.error||"Sign out failed",loading:!1}),{success:!1,error:r.error})}catch(r){const s=r instanceof Error?r.message:"Sign out failed";return t({error:s,loading:!1}),{success:!1,error:s}}},refreshAuth:async()=>{await e().checkAuth()},subscribeToAuthChanges:()=>{const{data:r}=El.onAuthStateChange(async(s,n)=>{if(console.log("Auth state changed:",s),s==="SIGNED_IN"||s==="TOKEN_REFRESHED"||s==="USER_UPDATED"){if(n!=null&&n.user){const o=ic.fromSupabase(n.user);t({user:o,authenticated:!0,sessionId:n.access_token,error:null})}}else s==="SIGNED_OUT"&&e().reset()});return{unsubscribe:()=>{var s;(s=r==null?void 0:r.subscription)==null||s.unsubscribe()}}}})),jj=({children:t})=>{const e=ir(s=>s.checkAuth),r=ir(s=>s.subscribeToAuthChanges);return b.useEffect(()=>{e();const{unsubscribe:s}=r();return()=>{s()}},[]),a.jsx(a.Fragment,{children:t})},Yi=()=>{const t=ir(c=>c.user),e=ir(c=>c.loading),r=ir(c=>c.authenticated),s=ir(c=>c.error),n=ir(c=>c.sessionId),o=ir(c=>c.checkAuth),i=ir(c=>c.signOut),l=ir(c=>c.refreshAuth);return{user:t,loading:e,authenticated:r,error:s,sessionId:n,signOut:i,refreshAuth:l,checkAuth:o}},kj="_backdrop_w92d8_7",Nj="_backdropClosing_w92d8_22",Ij="_dialog_w92d8_27",Ej="_dialogClosing_w92d8_44",Tj="_iconContainer_w92d8_49",Aj="_title_w92d8_62",Lj="_message_w92d8_72",Dj="_buttonContainer_w92d8_88",Mj="_confirmButton_w92d8_95",Rj="_cancelButton_w92d8_96",As={backdrop:kj,backdropClosing:Nj,dialog:Ij,dialogClosing:Ej,iconContainer:Tj,title:Aj,message:Lj,buttonContainer:Dj,confirmButton:Mj,cancelButton:Rj},Oj={error:a.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 48 48",fill:"none",children:[a.jsx("circle",{cx:"24",cy:"24",r:"20",fill:"currentColor",opacity:"0.1"}),a.jsx("path",{d:"M24 14v12m0 4h.01",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round"})]}),warning:a.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 48 48",fill:"none",children:[a.jsx("path",{d:"M24 14v12m0 4h.01",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round"}),a.jsx("path",{d:"M21 36h6l1-16h-8l1 16z",fill:"currentColor",opacity:"0.1"})]}),info:a.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 48 48",fill:"none",children:[a.jsx("circle",{cx:"24",cy:"24",r:"20",stroke:"currentColor",strokeWidth:"2.5",fill:"none"}),a.jsx("path",{d:"M24 22v12m0-16h.01",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round"})]}),success:a.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 48 48",fill:"none",children:[a.jsx("circle",{cx:"24",cy:"24",r:"20",fill:"currentColor",opacity:"0.1"}),a.jsx("path",{d:"M16 24l6 6 12-12",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"})]})},De=({variant:t="info",title:e,message:r,isOpen:s,onClose:n,confirmText:o="OK",cancelText:i="Cancel",showCancelButton:l=!1,onConfirm:c,autoCloseDuration:d=0,closeOnBackdropClick:u=!0,closeOnEscape:h=!0,className:f="",zIndex:p=1e3,icon:g,showIcon:y=!0,dialogWidth:x,dialogMaxWidth:m,dialogMinHeight:_,dialogPadding:v,dialogBackgroundColor:w,dialogBorderRadius:S,dialogBoxShadow:E,backdropColor:C,backdropOpacity:k,titleFontSize:N,titleFontWeight:I,titleColor:L,titleMarginBottom:T,messageFontSize:j,messageFontWeight:M,messageColor:R,messageLineHeight:O,messageMarginBottom:z,iconSize:D,iconColor:P,iconMarginBottom:$,buttonHeight:U,buttonPadding:A,buttonFontSize:Ae,buttonFontWeight:ae,buttonBorderRadius:Ke,buttonGap:Te,confirmButtonColor:At,confirmButtonBackgroundColor:sr,confirmButtonHoverBackgroundColor:Cr,cancelButtonColor:tt,cancelButtonBackgroundColor:it,cancelButtonBorderColor:me,cancelButtonHoverBackgroundColor:Je,animationDuration:St})=>{const[X,J]=b.useState(!1);b.useEffect(()=>{if(!s||d<=0)return;const ht=setTimeout(()=>{ve()},d);return()=>clearTimeout(ht)},[s,d]),b.useEffect(()=>{if(!s||!h)return;const ht=Rr=>{Rr.key==="Escape"&&ve()};return document.addEventListener("keydown",ht),()=>document.removeEventListener("keydown",ht)},[s,h]),b.useEffect(()=>(s?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[s]);const ve=b.useCallback(()=>{J(!0),setTimeout(()=>{n(),J(!1)},parseFloat(St||"0.2")*1e3)},[n,St]),xe=b.useCallback(ht=>{u&&ht.target===ht.currentTarget&&ve()},[u,ve]),F=b.useCallback(()=>{c&&c(),ve()},[c,ve]);if(!s&&!X)return null;const K=g!==void 0?g:y?Oj[t]:null,ie={success:"#00C896",error:"#FF5847",warning:"#FF9500",info:"#0064FF"},ye={backgroundColor:C||`rgba(0, 0, 0, ${k??.3})`,zIndex:p},st={width:x,maxWidth:m,minHeight:_,padding:v,backgroundColor:w,borderRadius:S,boxShadow:E},Ue={width:D,height:D,color:P||ie[t],marginBottom:$},Kt={fontSize:N,fontWeight:I,color:L,marginBottom:T},So={fontSize:j,fontWeight:M,color:R,lineHeight:O,marginBottom:z},Y={gap:Te},he={height:U,padding:A,fontSize:Ae,fontWeight:ae,borderRadius:Ke,color:At,backgroundColor:sr},nt={height:U,padding:A,fontSize:Ae,fontWeight:ae,borderRadius:Ke,color:tt,backgroundColor:it,borderColor:me};return a.jsx("div",{className:`${As.backdrop} ${X?As.backdropClosing:""}`,style:ye,onClick:xe,role:"presentation",children:a.jsxs("div",{className:`${As.dialog} ${X?As.dialogClosing:""} ${f}`,style:st,role:"alertdialog","aria-modal":"true","aria-labelledby":e?"alert-title":void 0,"aria-describedby":"alert-message",onClick:ht=>ht.stopPropagation(),children:[K&&a.jsx("div",{className:As.iconContainer,style:Ue,children:K}),e&&a.jsx("h2",{id:"alert-title",className:As.title,style:Kt,children:e}),a.jsx("p",{id:"alert-message",className:As.message,style:So,children:r}),a.jsxs("div",{className:As.buttonContainer,style:Y,children:[l&&a.jsx("button",{type:"button",className:As.cancelButton,onClick:ve,style:nt,children:i}),a.jsx("button",{type:"button",className:As.confirmButton,onClick:F,style:he,autoFocus:!0,children:o})]})]})})},Pj="_container_1ygeh_7",$j="_spinner_1ygeh_22",Fj="_spin_1ygeh_22",Bj="_small_1ygeh_38",Hj="_medium_1ygeh_44",Vj="_large_1ygeh_50",du={container:Pj,spinner:$j,spin:Fj,small:Bj,medium:Hj,large:Vj},Ne=({size:t="medium",className:e="",fullscreen:r=!1})=>{const s=`${du.spinner} ${du[t]} ${e}`;return r?a.jsx("div",{className:du.container,children:a.jsx("div",{className:s})}):a.jsx("div",{className:s})},Rt=({children:t,requiredFeatureId:e})=>{const{authenticated:r,loading:s}=Yi(),{permissions:n}=at(),[o,i]=b.useState(!1),[l,c]=b.useState(!1);return b.useEffect(()=>{i(!1),c(!1)},[e]),s?a.jsx(Ne,{fullscreen:!0,size:"large"}):r?e&&!n.includes(e)?(o||i(!0),a.jsxs(a.Fragment,{children:[a.jsx(De,{variant:"warning",title:"Access Denied",message:"You don't have permission to access this page. Please contact your administrator.",isOpen:o,onClose:()=>{i(!1),c(!0)},autoCloseDuration:3e3}),l&&a.jsx(Ai,{to:"/dashboard",replace:!0})]})):a.jsx(a.Fragment,{children:t}):a.jsx(Ai,{to:"/login",replace:!0})},vg=({children:t})=>{const{authenticated:e,loading:r}=Yi();return r?a.jsx(Ne,{fullscreen:!0,size:"large"}):e?a.jsx(Ai,{to:"/dashboard",replace:!0}):a.jsx(a.Fragment,{children:t})},zj="_inputGroup_1usn9_7",Uj="_fullWidth_1usn9_14",Wj="_label_1usn9_19",qj="_required_1usn9_27",Gj="_inputWrapper_1usn9_33",Jj="_input_1usn9_7",Kj="_withIconLeft_1usn9_125",Yj="_withIconRight_1usn9_129",Qj="_iconLeft_1usn9_133",Zj="_iconRight_1usn9_134",Xj="_footer_1usn9_173",ek="_errorMessage_1usn9_182",tk="_successMessage_1usn9_183",rk="_helperText_1usn9_184",sk="_charCount_1usn9_202",nk="_focused_1usn9_215",Ft={inputGroup:zj,fullWidth:Uj,label:Wj,required:qj,inputWrapper:Gj,input:Jj,"size-sm":"_size-sm_1usn9_74","size-md":"_size-md_1usn9_80","size-lg":"_size-lg_1usn9_86","variant-default":"_variant-default_1usn9_93","variant-error":"_variant-error_1usn9_97","variant-success":"_variant-success_1usn9_106","variant-warning":"_variant-warning_1usn9_115",withIconLeft:Kj,withIconRight:Yj,iconLeft:Qj,iconRight:Zj,footer:Xj,errorMessage:ek,successMessage:tk,helperText:rk,charCount:sk,focused:nk},pn=b.forwardRef(({label:t,variant:e="default",size:r="md",error:s,success:n,helperText:o,iconLeft:i,iconRight:l,showPasswordToggle:c,showCharCount:d=!1,required:u=!1,fullWidth:h=!1,type:f="text",className:p="",maxLength:g,value:y,onChange:x,onFocus:m,onBlur:_,...v},w)=>{const[S,E]=b.useState(!1),[C,k]=b.useState(!1),N=b.useId(),I=s?"error":n?"success":e,L=f==="password"&&(c===void 0||c),T=f==="password"&&C?"text":f,j=typeof y=="string"?y.length:0,M=[Ft.input,Ft[`size-${r}`],Ft[`variant-${I}`],i&&Ft.withIconLeft,(l||L)&&Ft.withIconRight,h&&Ft.fullWidth,S&&Ft.focused,p].filter(Boolean).join(" "),R=D=>{E(!0),m==null||m(D)},O=D=>{E(!1),_==null||_(D)},z=()=>{k(D=>!D)};return a.jsxs("div",{className:`${Ft.inputGroup} ${h?Ft.fullWidth:""}`,children:[t&&a.jsxs("label",{htmlFor:N,className:Ft.label,children:[t,u&&a.jsx("span",{className:Ft.required,children:"*"})]}),a.jsxs("div",{className:Ft.inputWrapper,children:[i&&a.jsx("span",{className:Ft.iconLeft,children:i}),a.jsx("input",{ref:w,id:N,type:T,className:M,value:y,onChange:x,onFocus:R,onBlur:O,maxLength:g,required:u,...v}),L?a.jsx("button",{type:"button",className:Ft.iconRight,onClick:z,tabIndex:-1,children:C?a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"currentColor",children:[a.jsx("path",{d:"M2 2l16 16M6.71 6.71A9.78 9.78 0 0010 6c5 0 8.27 4.11 9 7a13.16 13.16 0 01-1.67 2.68"}),a.jsx("path",{d:"M12 12a3 3 0 11-4.24-4.24"}),a.jsx("path",{d:"M6.61 6.61A13.526 13.526 0 001 10s3.27 7 9 7a9.74 9.74 0 005.39-1.61"})]}):a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"currentColor",children:[a.jsx("path",{d:"M10 3C5 3 1.73 7.11 1 10c.73 2.89 4 7 9 7s8.27-4.11 9-7c-.73-2.89-4-7-9-7z"}),a.jsx("circle",{cx:"10",cy:"10",r:"3"})]})}):l&&a.jsx("span",{className:Ft.iconRight,children:l})]}),a.jsxs("div",{className:Ft.footer,children:[s&&a.jsx("span",{className:Ft.errorMessage,children:s}),!s&&n&&a.jsx("span",{className:Ft.successMessage,children:n}),!s&&!n&&o&&a.jsx("span",{className:Ft.helperText,children:o}),d&&g&&a.jsxs("span",{className:Ft.charCount,children:[j,"/",g]})]})]})});pn.displayName="TossInput";const ok="_tossButton_1rg9o_7",ak="_fullWidth_1rg9o_59",ik="_disabled_1rg9o_170",lk="_loading_1rg9o_177",ck="_content_1rg9o_183",dk="_label_1rg9o_192",uk="_iconLeft_1rg9o_197",hk="_iconRight_1rg9o_198",fk="_spinner_1rg9o_214",mk="_spinnerSvg_1rg9o_220",pk="_spin_1rg9o_214",gk="_spinnerCircle_1rg9o_226",_k="_rippleContainer_1rg9o_243",yk="_ripple_1rg9o_243",vk="_rippleEffect_1rg9o_1",jr={tossButton:ok,"size-sm":"_size-sm_1rg9o_34","size-md":"_size-md_1rg9o_40","size-lg":"_size-lg_1rg9o_46","size-xl":"_size-xl_1rg9o_52",fullWidth:ak,"variant-primary":"_variant-primary_1rg9o_65","variant-secondary":"_variant-secondary_1rg9o_81","variant-outline":"_variant-outline_1rg9o_92","variant-ghost":"_variant-ghost_1rg9o_103","variant-text":"_variant-text_1rg9o_113","variant-success":"_variant-success_1rg9o_125","variant-error":"_variant-error_1rg9o_136","variant-warning":"_variant-warning_1rg9o_147","variant-info":"_variant-info_1rg9o_158",disabled:ik,loading:lk,content:ck,label:dk,iconLeft:uk,iconRight:hk,spinner:fk,spinnerSvg:mk,spin:pk,spinnerCircle:gk,rippleContainer:_k,ripple:yk,rippleEffect:vk},be=({label:t,variant:e="primary",size:r="md",onClick:s,disabled:n=!1,fullWidth:o=!1,loading:i=!1,icon:l,iconPosition:c="left",children:d,type:u="button",className:h="",customStyles:f,...p})=>{const[g,y]=b.useState([]),x=b.useRef(null),m=b.useRef(0),_=C=>{if(!(n||i)){if(x.current){const k=x.current.getBoundingClientRect(),N=C.clientX-k.left,I=C.clientY-k.top,L=m.current++;y(T=>[...T,{x:N,y:I,id:L}]),setTimeout(()=>{y(T=>T.filter(j=>j.id!==L))},600)}s&&s(C)}},v=[jr.tossButton,jr[`variant-${e}`],jr[`size-${r}`],o&&jr.fullWidth,n&&jr.disabled,i&&jr.loading,h].filter(Boolean).join(" "),w=d||t,S=l&&!i,E={...(f==null?void 0:f.backgroundColor)&&{backgroundColor:f.backgroundColor},...(f==null?void 0:f.color)&&{color:f.color},...(f==null?void 0:f.borderColor)&&{borderColor:f.borderColor},...(f==null?void 0:f.borderWidth)&&{borderWidth:f.borderWidth},...(f==null?void 0:f.borderRadius)&&{borderRadius:f.borderRadius},...(f==null?void 0:f.width)&&{width:f.width},...(f==null?void 0:f.height)&&{height:f.height},...(f==null?void 0:f.padding)&&{padding:f.padding},...(f==null?void 0:f.fontSize)&&{fontSize:f.fontSize},...(f==null?void 0:f.fontWeight)&&{fontWeight:f.fontWeight}};return a.jsxs("button",{ref:x,type:u,className:v,style:E,onClick:_,disabled:n||i,...p,children:[a.jsx("span",{className:jr.rippleContainer,children:g.map(C=>a.jsx("span",{className:jr.ripple,style:{left:C.x,top:C.y}},C.id))}),a.jsxs("span",{className:jr.content,children:[i&&a.jsx("span",{className:jr.spinner,children:a.jsx("svg",{className:jr.spinnerSvg,viewBox:"0 0 24 24",children:a.jsx("circle",{className:jr.spinnerCircle,cx:"12",cy:"12",r:"10",fill:"none",strokeWidth:"3"})})}),S&&c==="left"&&a.jsx("span",{className:jr.iconLeft,children:l}),w&&a.jsx("span",{className:jr.label,children:w}),S&&c==="right"&&a.jsx("span",{className:jr.iconRight,children:l})]})]})},xk=()=>{const t=ir(n=>n.loginLoading),e=ir(n=>n.loginError),r=ir(n=>n.loginFieldErrors);return{login:ir(n=>n.login),loading:t,error:e,fieldErrors:r}},bk="_form_190hk_5",wk="_checkboxGroup_190hk_13",Sk="_checkboxLabel_190hk_17",Ck="_checkbox_190hk_13",jk="_errorAlert_190hk_39",kk="_forgotPassword_190hk_50",To={form:bk,checkboxGroup:wk,checkboxLabel:Sk,checkbox:Ck,errorAlert:jk,forgotPassword:kk},Nk=({onSuccess:t,onError:e,showRememberMe:r=!0,showForgotPassword:s=!0})=>{const[n,o]=b.useState(""),[i,l]=b.useState(""),[c,d]=b.useState(!1),{login:u,loading:h,error:f,fieldErrors:p}=xk(),g=async y=>{y.preventDefault();const x=await u(n,i,c);if(x.success)t==null||t();else{const m=x.error||f||Object.values(p).join(", ")||"Login failed";e==null||e(m)}};return a.jsxs("form",{className:To.form,onSubmit:g,children:[a.jsx(pn,{label:"Email Address",type:"email",name:"email",value:n,onChange:y=>o(y.target.value),placeholder:"Enter your email address",error:p.email,required:!0,fullWidth:!0,autoComplete:"email",iconLeft:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"currentColor",children:[a.jsx("path",{d:"M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z"}),a.jsx("path",{d:"M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z"})]})}),a.jsx(pn,{label:"Password",type:"password",name:"password",value:i,onChange:y=>l(y.target.value),placeholder:"Enter your password",error:p.password,required:!0,fullWidth:!0,autoComplete:"current-password",minLength:6,showPasswordToggle:!0}),r&&a.jsx("div",{className:To.checkboxGroup,children:a.jsxs("label",{className:To.checkboxLabel,children:[a.jsx("input",{type:"checkbox",checked:c,onChange:y=>d(y.target.checked),className:To.checkbox}),a.jsx("span",{children:"Remember me (Stay logged in on this device)"})]})}),f&&a.jsx("div",{className:To.errorAlert,children:f}),a.jsx(be,{type:"submit",variant:"primary",size:"lg",fullWidth:!0,loading:h,disabled:h,children:h?"Signing In...":"Sign In"}),s&&a.jsx("div",{className:To.forgotPassword,children:a.jsx("a",{href:"/auth/forgot-password",children:"Forgot your password?"})})]})},E0={appIcon:"/assets/images/app-icon.png"},Ik="_container_125n9_6",Ek="_card_125n9_15",Tk="_header_125n9_38",Ak="_logo_125n9_43",Lk="_title_125n9_56",Dk="_subtitle_125n9_64",Mk="_divider_125n9_71",Rk="_actions_125n9_96",Ok="_footer_125n9_101",Pk="_loadingContainer_125n9_126",$k="_spinner_125n9_136",Fk="_loadingText_125n9_143",Or={container:Ik,card:Ek,header:Tk,logo:Ak,title:Lk,subtitle:Dk,divider:Mk,actions:Rk,footer:Ok,loadingContainer:Pk,spinner:$k,loadingText:Fk},Bk=({redirectUrl:t})=>{var p,g;const e=_a(),r=Ji(),{authenticated:s,loading:n}=Yi(),{loadUserData:o,loadCategoryFeatures:i}=at(),[l,c]=b.useState(!1),d=((g=(p=r.state)==null?void 0:p.from)==null?void 0:g.pathname)||t||"/dashboard";b.useEffect(()=>{!n&&s&&e(d,{replace:!0})},[s,n,e,d]);const u=async()=>{try{c(!0),await Promise.all([o(),i()]),e(d,{replace:!0})}catch(y){console.error("Failed to load user data:",y),e(d,{replace:!0})}finally{c(!1)}},h=y=>{console.error("Login error:",y)},f=()=>{e("/register")};return n?a.jsx("div",{className:Or.loadingContainer,children:a.jsx("div",{className:Or.spinner,children:"Loading..."})}):l?a.jsxs("div",{className:Or.loadingContainer,children:[a.jsx("div",{className:Or.spinner,children:"Loading your data..."}),a.jsx("p",{className:Or.loadingText,children:"Please wait while we set up your workspace"})]}):s?null:a.jsx("div",{className:Or.container,children:a.jsxs("div",{className:Or.card,children:[a.jsxs("div",{className:Or.header,children:[a.jsx("div",{className:Or.logo,children:a.jsx("img",{src:E0.appIcon,alt:"Store Base Logo"})}),a.jsx("h1",{className:Or.title,children:"Welcome to Store Base"}),a.jsx("p",{className:Or.subtitle,children:"Sign in to manage your store"})]}),a.jsx(Nk,{onSuccess:u,onError:h}),a.jsx("div",{className:Or.divider,children:a.jsx("span",{children:"Or"})}),a.jsx("div",{className:Or.actions,children:a.jsx(be,{variant:"outline",size:"lg",fullWidth:!0,onClick:f,children:"Create New Account"})}),a.jsx("div",{className:Or.footer,children:a.jsxs("p",{children:["By signing in, you agree to our"," ",a.jsx("a",{href:"/terms",children:"Terms of Service"})," and"," ",a.jsx("a",{href:"/privacy",children:"Privacy Policy"})]})})]})})},Hk=()=>{const t=ir(n=>n.registerLoading),e=ir(n=>n.registerError),r=ir(n=>n.registerFieldErrors);return{register:ir(n=>n.register),loading:t,error:e,fieldErrors:r}},Vk="_form_bewng_5",zk="_nameRow_bewng_13",Uk="_errorAlert_bewng_20",Wk="_loginLink_bewng_31",Tl={form:Vk,nameRow:zk,errorAlert:Uk,loginLink:Wk},qk=({onSuccess:t,onError:e,showLoginLink:r=!0})=>{const[s,n]=b.useState(""),[o,i]=b.useState(""),[l,c]=b.useState(""),[d,u]=b.useState(""),[h,f]=b.useState(""),{register:p,loading:g,error:y,fieldErrors:x}=Hk(),m=async _=>{_.preventDefault();const v=await p(s,o,l,d,h);if(v.success)t==null||t();else{const w=v.error||y||Object.values(x).join(", ")||"Registration failed";e==null||e(w)}};return a.jsxs("form",{className:Tl.form,onSubmit:m,children:[a.jsxs("div",{className:Tl.nameRow,children:[a.jsx(pn,{label:"First Name",type:"text",name:"firstName",value:d,onChange:_=>u(_.target.value),placeholder:"First name",error:x.firstName,required:!0,fullWidth:!0,autoComplete:"given-name"}),a.jsx(pn,{label:"Last Name",type:"text",name:"lastName",value:h,onChange:_=>f(_.target.value),placeholder:"Last name",error:x.lastName,required:!0,fullWidth:!0,autoComplete:"family-name"})]}),a.jsx(pn,{label:"Email Address",type:"email",name:"email",value:s,onChange:_=>n(_.target.value),placeholder:"Enter your email address",error:x.email,required:!0,fullWidth:!0,autoComplete:"email",iconLeft:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"currentColor",children:[a.jsx("path",{d:"M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z"}),a.jsx("path",{d:"M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z"})]})}),a.jsx(pn,{label:"Password",type:"password",name:"password",value:o,onChange:_=>i(_.target.value),placeholder:"Enter your password",error:x.password,required:!0,fullWidth:!0,autoComplete:"new-password",minLength:6,showPasswordToggle:!0}),a.jsx(pn,{label:"Confirm Password",type:"password",name:"passwordConfirmation",value:l,onChange:_=>c(_.target.value),placeholder:"Confirm your password",error:x.passwordConfirmation,required:!0,fullWidth:!0,autoComplete:"new-password",minLength:6,showPasswordToggle:!0}),y&&a.jsx("div",{className:Tl.errorAlert,children:y}),a.jsx(be,{type:"submit",variant:"primary",size:"lg",fullWidth:!0,loading:g,disabled:g,children:g?"Creating Account...":"Create Account"}),r&&a.jsxs("div",{className:Tl.loginLink,children:["Already have an account? ",a.jsx("a",{href:"/auth/login",children:"Sign in"})]})]})},Gk="_container_g4l96_6",Jk="_card_g4l96_15",Kk="_header_g4l96_38",Yk="_logo_g4l96_43",Qk="_title_g4l96_56",Zk="_subtitle_g4l96_64",Xk="_divider_g4l96_71",eN="_actions_g4l96_96",tN="_footer_g4l96_101",rN="_loadingContainer_g4l96_126",sN="_spinner_g4l96_136",nN="_loadingText_g4l96_143",Pr={container:Gk,card:Jk,header:Kk,logo:Yk,title:Qk,subtitle:Zk,divider:Xk,actions:eN,footer:tN,loadingContainer:rN,spinner:sN,loadingText:nN},oN=({redirectUrl:t})=>{var p,g;const e=_a(),r=Ji(),{authenticated:s,loading:n}=Yi(),{loadUserData:o,loadCategoryFeatures:i}=at(),[l,c]=b.useState(!1),d=((g=(p=r.state)==null?void 0:p.from)==null?void 0:g.pathname)||t||"/dashboard";b.useEffect(()=>{!n&&s&&e(d,{replace:!0})},[s,n,e,d]);const u=async()=>{try{c(!0),await Promise.all([o(),i()]),e(d,{replace:!0})}catch(y){console.error("Failed to load user data:",y),e(d,{replace:!0})}finally{c(!1)}},h=y=>{console.error("Registration error:",y)},f=()=>{e("/auth/login")};return n?a.jsx("div",{className:Pr.loadingContainer,children:a.jsx("div",{className:Pr.spinner,children:"Loading..."})}):l?a.jsxs("div",{className:Pr.loadingContainer,children:[a.jsx("div",{className:Pr.spinner,children:"Setting up your account..."}),a.jsx("p",{className:Pr.loadingText,children:"Please wait while we create your workspace"})]}):s?null:a.jsx("div",{className:Pr.container,children:a.jsxs("div",{className:Pr.card,children:[a.jsxs("div",{className:Pr.header,children:[a.jsx("div",{className:Pr.logo,children:a.jsx("img",{src:E0.appIcon,alt:"Store Base Logo"})}),a.jsx("h1",{className:Pr.title,children:"Create Your Account"}),a.jsx("p",{className:Pr.subtitle,children:"Join Store Base to manage your store"})]}),a.jsx(qk,{onSuccess:u,onError:h}),a.jsx("div",{className:Pr.divider,children:a.jsx("span",{children:"Or"})}),a.jsx("div",{className:Pr.actions,children:a.jsx(be,{variant:"outline",size:"lg",fullWidth:!0,onClick:f,children:"Sign In to Existing Account"})}),a.jsx("div",{className:Pr.footer,children:a.jsxs("p",{children:["By creating an account, you agree to our"," ",a.jsx("a",{href:"/terms",children:"Terms of Service"})," and"," ",a.jsx("a",{href:"/privacy",children:"Privacy Policy"})]})})]})})},He={errors:{loadFailed:"Failed to load dashboard data",loadFailedTitle:"Data Load Failed",noDataReturned:"No data returned from server",invalidCompanyId:"Invalid company ID",companyIdRequired:"Company ID is required",invalidCompanyIdFormat:"Invalid company ID format (UUID required)",invalidDate:"Invalid date format",dateRequired:"Date is required",invalidDateFormat:"Invalid date format (ISO 8601 format required)",rpcFailed:"Failed to communicate with server",rpcError:"An error occurred during server request",unknownError:"An unknown error occurred",unexpectedError:"An unexpected error occurred",negativeRevenue:"Today revenue cannot be negative",negativeExpense:"Today expense cannot be negative",negativeMonthRevenue:"This month revenue cannot be negative",negativeLastMonthRevenue:"Last month revenue cannot be negative",currencySymbolRequired:"Currency symbol is required",currencyCodeRequired:"Currency code is required",expensePercentageInvalid:"Expense breakdown percentages do not sum to 100%"},warnings:{noExpenseData:"No expense data for this month",noTransactions:"No recent transactions",noDataAvailable:"No data available to display",dataValidationWarnings:"Data validation warnings exist"},info:{loading:"Loading...",loadingData:"Loading data...",noCompanySelected:"Please select a company"},success:{dataLoaded:"Dashboard data loaded successfully",refreshed:"Data refreshed successfully"},emptyStates:{noDashboardData:"No dashboard data available",noExpenseData:"No expense data for this month",noRecentActivity:"No recent activity",noTransactions:"No transactions"},actions:{retry:"Retry",close:"Close",refresh:"Refresh",ok:"OK",cancel:"Cancel"},technical:{expenseItemCategoryRequired:t=>`Expense item ${t+1}: Category is required`,expenseItemNegative:t=>`Expense item ${t+1}: Amount cannot be negative`,expenseItemPercentageInvalid:t=>`Expense item ${t+1}: Percentage must be between 0-100`,transactionIdRequired:t=>`Transaction ${t+1}: ID is required`,transactionDateRequired:t=>`Transaction ${t+1}: Date is required`,transactionDescriptionRequired:t=>`Transaction ${t+1}: Description is required`,transactionAmountNegative:t=>`Transaction ${t+1}: Amount cannot be negative`,transactionTypeInvalid:t=>`Transaction ${t+1}: Type must be 'income' or 'expense'`,rpcDebugFetch:t=>` Fetching dashboard data: ${JSON.stringify(t)}`,rpcDebugResponse:(t,e)=>` Dashboard RPC response: ${JSON.stringify({data:t,error:e})}`,rpcDebugError:t=>` Dashboard RPC error: ${t}`,rpcDebugSuccess:" Dashboard data fetched successfully",rpcDebugNoData:" No data returned from dashboard RPC",datasourceError:t=>` Dashboard datasource error: ${t}`,validationWarnings:t=>` Dashboard data validation warnings: ${t.join(", ")}`}};class aN{async getDashboardData(e,r){try{const s=ne.getClient(),{data:n,error:o}=await s.rpc("get_dashboard_page",{p_company_id:e,p_date:r});return o?(console.error("Dashboard RPC error:",o.message),{success:!1,error:o.message||He.errors.rpcFailed}):n?{success:!0,data:n}:{success:!1,error:He.errors.noDataReturned}}catch(s){return console.error("Dashboard datasource error:",s),{success:!1,error:s instanceof Error?s.message:He.errors.unknownError}}}}class em{constructor(e,r,s,n,o,i,l){this.todayRevenue=e,this.todayExpense=r,this.thisMonthRevenue=s,this.lastMonthRevenue=n,this.currency=o,this.expenseBreakdown=i,this.recentTransactions=l}get todayProfit(){return this.todayRevenue-this.todayExpense}get monthOverMonthGrowth(){return this.lastMonthRevenue===0?0:(this.thisMonthRevenue-this.lastMonthRevenue)/this.lastMonthRevenue*100}get isGrowthPositive(){return this.monthOverMonthGrowth>0}formatCurrency(e){const r=e||0;return`${this.currency.symbol}${r.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})}`}get formattedTodayRevenue(){return this.formatCurrency(this.todayRevenue)}get formattedTodayExpense(){return this.formatCurrency(this.todayExpense)}get formattedThisMonthRevenue(){return this.formatCurrency(this.thisMonthRevenue)}get formattedLastMonthRevenue(){return this.formatCurrency(this.lastMonthRevenue)}static create(e){return new em(e.today_revenue||0,e.today_expense||0,e.this_month_revenue||0,e.last_month_revenue||0,e.currency||{symbol:"$",currency_code:"USD"},e.expense_breakdown||[],e.recent_transactions||[])}}class te{static toUtc(e){return e.toISOString()}static nowUtc(){return new Date().toISOString()}static toLocal(e){if(!e.includes("Z")&&!e.includes("+")&&!e.includes("-",e.length-6)){const r=e.replace(" ","T");return new Date(`${r}Z`)}return new Date(e)}static toLocalSafe(e){if(!e||e.trim()==="")return null;try{return this.toLocal(e)}catch(r){return console.error("Failed to parse date:",e,r),null}}static toDateOnly(e){const r=e.getFullYear(),s=String(e.getMonth()+1).padStart(2,"0"),n=String(e.getDate()).padStart(2,"0");return`${r}-${s}-${n}`}static toUtcDateOnly(e=new Date){const r=e.getUTCFullYear(),s=String(e.getUTCMonth()+1).padStart(2,"0"),n=String(e.getUTCDate()).padStart(2,"0");return`${r}-${s}-${n}`}static nowUtcDate(){return this.toUtcDateOnly(new Date)}static toRpcFormat(e){return e.toISOString().replace("T"," ").split(".")[0]}static format(e){const r=e.getFullYear(),s=String(e.getMonth()+1).padStart(2,"0"),n=String(e.getDate()).padStart(2,"0"),o=String(e.getHours()).padStart(2,"0"),i=String(e.getMinutes()).padStart(2,"0");return`${r}-${s}-${n} ${o}:${i}`}static formatCustom(e,r={},s="ko-KR"){return new Intl.DateTimeFormat(s,r).format(e)}static formatDateOnly(e){return this.toDateOnly(e)}static formatTimeOnly(e){const r=String(e.getHours()).padStart(2,"0"),s=String(e.getMinutes()).padStart(2,"0");return`${r}:${s}`}static formatRelative(e,r="ko-KR"){const n=new Date().getTime()-e.getTime(),o=Math.floor(n/1e3),i=Math.floor(o/60),l=Math.floor(i/60),c=Math.floor(l/24),d=new Intl.RelativeTimeFormat(r,{numeric:"auto"});return o<60?d.format(-o,"second"):i<60?d.format(-i,"minute"):l<24?d.format(-l,"hour"):c<30?d.format(-c,"day"):this.format(e)}static isSameDay(e,r){return e.getFullYear()===r.getFullYear()&&e.getMonth()===r.getMonth()&&e.getDate()===r.getDate()}static addDays(e,r){const s=new Date(e);return s.setDate(s.getDate()+r),s}static startOfDay(e){const r=new Date(e);return r.setHours(0,0,0,0),r}static endOfDay(e){const r=new Date(e);return r.setHours(23,59,59,999),r}static formatTransactionDate(e){try{const r=new Date(e);if(isNaN(r.getTime()))return"Invalid Date";const s={month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0};return r.toLocaleString("en-US",s)}catch(r){return console.error("Date formatting error:",r),"Invalid Date"}}}class iN{static fromSupabase(e){var s,n;const r=(e.recent_transactions||[]).map(o=>{var d,u;const i=(d=o.lines)==null?void 0:d.some(h=>h.account_type==="income"),l=(u=o.lines)==null?void 0:u.some(h=>h.account_type==="expense"),c=o.created_at||o.entry_date;return{id:o.journal_id,date:te.toLocal(c).toISOString(),description:o.description||"No description",amount:o.total_amount||0,type:i?"income":l?"expense":"income"}});return em.create({today_revenue:e.today_revenue||0,today_expense:e.today_expense||0,this_month_revenue:e.this_month_revenue||0,last_month_revenue:e.last_month_revenue||0,currency:{symbol:((s=e.currency)==null?void 0:s.symbol)||"$",currency_code:((n=e.currency)==null?void 0:n.currency_code)||"USD"},expense_breakdown:e.expense_breakdown||[],recent_transactions:r})}}class lN{constructor(){W(this,"dataSource");this.dataSource=new aN}async getDashboardData(e,r){try{const s=await this.dataSource.getDashboardData(e,r);return!s.success||!s.data?{success:!1,error:s.error||"Failed to fetch dashboard data"}:{success:!0,data:iN.fromSupabase(s.data)}}catch(s){return{success:!1,error:s instanceof Error?s.message:"An unexpected error occurred"}}}}class uu{static validateDashboardData(e){const r=[];if(e.todayRevenue!==void 0&&e.todayRevenue<0&&r.push(He.errors.negativeRevenue),e.todayExpense!==void 0&&e.todayExpense<0&&r.push(He.errors.negativeExpense),e.thisMonthRevenue!==void 0&&e.thisMonthRevenue<0&&r.push(He.errors.negativeMonthRevenue),e.lastMonthRevenue!==void 0&&e.lastMonthRevenue<0&&r.push(He.errors.negativeLastMonthRevenue),e.currency&&((!e.currency.symbol||e.currency.symbol.trim()==="")&&r.push(He.errors.currencySymbolRequired),(!e.currency.currency_code||e.currency.currency_code.trim()==="")&&r.push(He.errors.currencyCodeRequired)),e.expenseBreakdown&&e.expenseBreakdown.length>0){const s=e.expenseBreakdown.reduce((n,o)=>n+o.percentage,0);Math.abs(s-100)>.1&&s>0&&r.push(He.errors.expensePercentageInvalid),e.expenseBreakdown.forEach((n,o)=>{(!n.category||n.category.trim()==="")&&r.push(He.technical.expenseItemCategoryRequired(o)),n.amount<0&&r.push(He.technical.expenseItemNegative(o)),(n.percentage<0||n.percentage>100)&&r.push(He.technical.expenseItemPercentageInvalid(o))})}return e.recentTransactions&&e.recentTransactions.length>0&&e.recentTransactions.forEach((s,n)=>{(!s.id||s.id.trim()==="")&&r.push(He.technical.transactionIdRequired(n)),s.date||r.push(He.technical.transactionDateRequired(n)),(!s.description||s.description.trim()==="")&&r.push(He.technical.transactionDescriptionRequired(n)),s.amount<0&&r.push(He.technical.transactionAmountNegative(n)),["income","expense"].includes(s.type)||r.push(He.technical.transactionTypeInvalid(n))}),{isValid:r.length===0,errors:r}}static validateDateFormat(e){if(!e||e.trim()==="")return{isValid:!1,error:He.errors.dateRequired};const r=new Date(e);return isNaN(r.getTime())?{isValid:!1,error:He.errors.invalidDateFormat}:{isValid:!0}}static validateCompanyId(e){return!e||e.trim()===""?{isValid:!1,error:He.errors.companyIdRequired}:/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e)?{isValid:!0}:{isValid:!1,error:He.errors.invalidCompanyIdFormat}}}const cN=new lN,zn=Jt((t,e)=>({data:null,loading:!0,error:null,errorDialog:{variant:"error",title:He.errors.loadFailedTitle,message:"",isOpen:!1},setData:r=>t({data:r}),setLoading:r=>t({loading:r}),setError:r=>t({error:r,errorDialog:{variant:"error",title:He.errors.loadFailedTitle,message:r||"",isOpen:!!r&&!e().loading}}),clearError:()=>t({error:null,errorDialog:{variant:"error",title:He.errors.loadFailedTitle,message:"",isOpen:!1}}),loadDashboardData:async(r,s)=>{const n=uu.validateCompanyId(r);if(!n.isValid){t({error:n.error||He.errors.invalidCompanyId,loading:!1}),e().setError(n.error||He.errors.invalidCompanyId);return}t({loading:!0,error:null}),e().clearError();try{const o=uu.validateDateFormat(s);if(!o.isValid){t({error:o.error||He.errors.invalidDate,loading:!1}),e().setError(o.error||He.errors.invalidDate);return}const i=await cN.getDashboardData(r,s);if(!i.success||!i.data){t({error:i.error||He.errors.loadFailed,data:null,loading:!1}),e().setError(i.error||He.errors.loadFailed);return}const l=uu.validateDashboardData({todayRevenue:i.data.todayRevenue,todayExpense:i.data.todayExpense,thisMonthRevenue:i.data.thisMonthRevenue,lastMonthRevenue:i.data.lastMonthRevenue,currency:i.data.currency,expenseBreakdown:i.data.expenseBreakdown,recentTransactions:i.data.recentTransactions});t({data:i.data,loading:!1,error:null}),e().clearError()}catch(o){const i=o instanceof Error?o.message:He.errors.unexpectedError;t({error:i,data:null,loading:!1}),e().setError(i)}},refresh:async r=>{const s=te.nowUtcDate();await e().loadDashboardData(r,s)}})),dN=(t,e={})=>{const{autoLoad:r=!0}=e,s=zn(h=>h.data),n=zn(h=>h.loading),o=zn(h=>h.error),i=zn(h=>h.errorDialog),l=zn(h=>h.loadDashboardData),c=zn(h=>h.refresh),d=zn(h=>h.clearError);return b.useEffect(()=>{if(t&&r){const h=te.nowUtcDate();l(t,h)}},[t,r,l]),{data:s,loading:n,error:o,errorDialog:i,refresh:()=>{c(t)},clearError:d}},uN="_card_s6ren_5",hN="_header_s6ren_17",fN="_iconWrapper_s6ren_23",mN="_title_s6ren_35",pN="_value_s6ren_42",gN="_change_s6ren_51",_N="_positive_s6ren_59",yN="_negative_s6ren_63",vN="_arrow_s6ren_67",xN="_skeleton_s6ren_72",bN="_skeletonIcon_s6ren_85",_r={card:uN,header:hN,iconWrapper:fN,title:mN,value:pN,change:gN,positive:_N,negative:yN,arrow:vN,skeleton:xN,skeletonIcon:bN},Al=({title:t,value:e,icon:r,changePercentage:s,isPositive:n=!0,loading:o=!1})=>{const i=()=>{if(s==null)return null;const l=n?_r.positive:_r.negative,c=n?"":"";return a.jsxs("div",{className:`${_r.change} ${l}`,children:[a.jsx("span",{className:_r.arrow,children:c}),a.jsxs("span",{children:[Math.abs(s).toFixed(1),"%"]})]})};return o?a.jsxs("div",{className:_r.card,children:[a.jsxs("div",{className:_r.header,children:[a.jsx("div",{className:`${_r.iconWrapper} ${_r.skeletonIcon}`}),a.jsx("div",{className:_r.title,children:t})]}),a.jsx("div",{className:_r.value,children:a.jsx("div",{className:_r.skeleton})})]}):a.jsxs("div",{className:_r.card,children:[a.jsxs("div",{className:_r.header,children:[a.jsx("div",{className:_r.iconWrapper,children:r}),a.jsx("div",{className:_r.title,children:t})]}),a.jsx("div",{className:_r.value,children:e}),i()]})};/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function Qi(t){return t+.5|0}const vn=(t,e,r)=>Math.max(Math.min(t,r),e);function Ha(t){return vn(Qi(t*2.55),0,255)}function An(t){return vn(Qi(t*255),0,255)}function Js(t){return vn(Qi(t/2.55)/100,0,1)}function xg(t){return vn(Qi(t*100),0,100)}const is={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},Bh=[..."0123456789ABCDEF"],wN=t=>Bh[t&15],SN=t=>Bh[(t&240)>>4]+Bh[t&15],Ll=t=>(t&240)>>4===(t&15),CN=t=>Ll(t.r)&&Ll(t.g)&&Ll(t.b)&&Ll(t.a);function jN(t){var e=t.length,r;return t[0]==="#"&&(e===4||e===5?r={r:255&is[t[1]]*17,g:255&is[t[2]]*17,b:255&is[t[3]]*17,a:e===5?is[t[4]]*17:255}:(e===7||e===9)&&(r={r:is[t[1]]<<4|is[t[2]],g:is[t[3]]<<4|is[t[4]],b:is[t[5]]<<4|is[t[6]],a:e===9?is[t[7]]<<4|is[t[8]]:255})),r}const kN=(t,e)=>t<255?e(t):"";function NN(t){var e=CN(t)?wN:SN;return t?"#"+e(t.r)+e(t.g)+e(t.b)+kN(t.a,e):void 0}const IN=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function T0(t,e,r){const s=e*Math.min(r,1-r),n=(o,i=(o+t/30)%12)=>r-s*Math.max(Math.min(i-3,9-i,1),-1);return[n(0),n(8),n(4)]}function EN(t,e,r){const s=(n,o=(n+t/60)%6)=>r-r*e*Math.max(Math.min(o,4-o,1),0);return[s(5),s(3),s(1)]}function TN(t,e,r){const s=T0(t,1,.5);let n;for(e+r>1&&(n=1/(e+r),e*=n,r*=n),n=0;n<3;n++)s[n]*=1-e-r,s[n]+=e;return s}function AN(t,e,r,s,n){return t===n?(e-r)/s+(e<r?6:0):e===n?(r-t)/s+2:(t-e)/s+4}function tm(t){const r=t.r/255,s=t.g/255,n=t.b/255,o=Math.max(r,s,n),i=Math.min(r,s,n),l=(o+i)/2;let c,d,u;return o!==i&&(u=o-i,d=l>.5?u/(2-o-i):u/(o+i),c=AN(r,s,n,u,o),c=c*60+.5),[c|0,d||0,l]}function rm(t,e,r,s){return(Array.isArray(e)?t(e[0],e[1],e[2]):t(e,r,s)).map(An)}function sm(t,e,r){return rm(T0,t,e,r)}function LN(t,e,r){return rm(TN,t,e,r)}function DN(t,e,r){return rm(EN,t,e,r)}function A0(t){return(t%360+360)%360}function MN(t){const e=IN.exec(t);let r=255,s;if(!e)return;e[5]!==s&&(r=e[6]?Ha(+e[5]):An(+e[5]));const n=A0(+e[2]),o=+e[3]/100,i=+e[4]/100;return e[1]==="hwb"?s=LN(n,o,i):e[1]==="hsv"?s=DN(n,o,i):s=sm(n,o,i),{r:s[0],g:s[1],b:s[2],a:r}}function RN(t,e){var r=tm(t);r[0]=A0(r[0]+e),r=sm(r),t.r=r[0],t.g=r[1],t.b=r[2]}function ON(t){if(!t)return;const e=tm(t),r=e[0],s=xg(e[1]),n=xg(e[2]);return t.a<255?`hsla(${r}, ${s}%, ${n}%, ${Js(t.a)})`:`hsl(${r}, ${s}%, ${n}%)`}const bg={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},wg={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function PN(){const t={},e=Object.keys(wg),r=Object.keys(bg);let s,n,o,i,l;for(s=0;s<e.length;s++){for(i=l=e[s],n=0;n<r.length;n++)o=r[n],l=l.replace(o,bg[o]);o=parseInt(wg[i],16),t[l]=[o>>16&255,o>>8&255,o&255]}return t}let Dl;function $N(t){Dl||(Dl=PN(),Dl.transparent=[0,0,0,0]);const e=Dl[t.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}const FN=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function BN(t){const e=FN.exec(t);let r=255,s,n,o;if(e){if(e[7]!==s){const i=+e[7];r=e[8]?Ha(i):vn(i*255,0,255)}return s=+e[1],n=+e[3],o=+e[5],s=255&(e[2]?Ha(s):vn(s,0,255)),n=255&(e[4]?Ha(n):vn(n,0,255)),o=255&(e[6]?Ha(o):vn(o,0,255)),{r:s,g:n,b:o,a:r}}}function HN(t){return t&&(t.a<255?`rgba(${t.r}, ${t.g}, ${t.b}, ${Js(t.a)})`:`rgb(${t.r}, ${t.g}, ${t.b})`)}const hu=t=>t<=.0031308?t*12.92:Math.pow(t,1/2.4)*1.055-.055,Ao=t=>t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4);function VN(t,e,r){const s=Ao(Js(t.r)),n=Ao(Js(t.g)),o=Ao(Js(t.b));return{r:An(hu(s+r*(Ao(Js(e.r))-s))),g:An(hu(n+r*(Ao(Js(e.g))-n))),b:An(hu(o+r*(Ao(Js(e.b))-o))),a:t.a+r*(e.a-t.a)}}function Ml(t,e,r){if(t){let s=tm(t);s[e]=Math.max(0,Math.min(s[e]+s[e]*r,e===0?360:1)),s=sm(s),t.r=s[0],t.g=s[1],t.b=s[2]}}function L0(t,e){return t&&Object.assign(e||{},t)}function Sg(t){var e={r:0,g:0,b:0,a:255};return Array.isArray(t)?t.length>=3&&(e={r:t[0],g:t[1],b:t[2],a:255},t.length>3&&(e.a=An(t[3]))):(e=L0(t,{r:0,g:0,b:0,a:1}),e.a=An(e.a)),e}function zN(t){return t.charAt(0)==="r"?BN(t):MN(t)}class Oi{constructor(e){if(e instanceof Oi)return e;const r=typeof e;let s;r==="object"?s=Sg(e):r==="string"&&(s=jN(e)||$N(e)||zN(e)),this._rgb=s,this._valid=!!s}get valid(){return this._valid}get rgb(){var e=L0(this._rgb);return e&&(e.a=Js(e.a)),e}set rgb(e){this._rgb=Sg(e)}rgbString(){return this._valid?HN(this._rgb):void 0}hexString(){return this._valid?NN(this._rgb):void 0}hslString(){return this._valid?ON(this._rgb):void 0}mix(e,r){if(e){const s=this.rgb,n=e.rgb;let o;const i=r===o?.5:r,l=2*i-1,c=s.a-n.a,d=((l*c===-1?l:(l+c)/(1+l*c))+1)/2;o=1-d,s.r=255&d*s.r+o*n.r+.5,s.g=255&d*s.g+o*n.g+.5,s.b=255&d*s.b+o*n.b+.5,s.a=i*s.a+(1-i)*n.a,this.rgb=s}return this}interpolate(e,r){return e&&(this._rgb=VN(this._rgb,e._rgb,r)),this}clone(){return new Oi(this.rgb)}alpha(e){return this._rgb.a=An(e),this}clearer(e){const r=this._rgb;return r.a*=1-e,this}greyscale(){const e=this._rgb,r=Qi(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=r,this}opaquer(e){const r=this._rgb;return r.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return Ml(this._rgb,2,e),this}darken(e){return Ml(this._rgb,2,-e),this}saturate(e){return Ml(this._rgb,1,e),this}desaturate(e){return Ml(this._rgb,1,-e),this}rotate(e){return RN(this._rgb,e),this}}/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */function Vs(){}const UN=(()=>{let t=0;return()=>t++})();function wr(t){return t==null}function hr(t){if(Array.isArray&&Array.isArray(t))return!0;const e=Object.prototype.toString.call(t);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function Ge(t){return t!==null&&Object.prototype.toString.call(t)==="[object Object]"}function rn(t){return(typeof t=="number"||t instanceof Number)&&isFinite(+t)}function Ls(t,e){return rn(t)?t:e}function Xe(t,e){return typeof t>"u"?e:t}const WN=(t,e)=>typeof t=="string"&&t.endsWith("%")?parseFloat(t)/100:+t/e,D0=(t,e)=>typeof t=="string"&&t.endsWith("%")?parseFloat(t)/100*e:+t;function gt(t,e,r){if(t&&typeof t.call=="function")return t.apply(r,e)}function Ze(t,e,r,s){let n,o,i;if(hr(t))for(o=t.length,n=0;n<o;n++)e.call(r,t[n],n);else if(Ge(t))for(i=Object.keys(t),o=i.length,n=0;n<o;n++)e.call(r,t[i[n]],i[n])}function Hc(t,e){let r,s,n,o;if(!t||!e||t.length!==e.length)return!1;for(r=0,s=t.length;r<s;++r)if(n=t[r],o=e[r],n.datasetIndex!==o.datasetIndex||n.index!==o.index)return!1;return!0}function Vc(t){if(hr(t))return t.map(Vc);if(Ge(t)){const e=Object.create(null),r=Object.keys(t),s=r.length;let n=0;for(;n<s;++n)e[r[n]]=Vc(t[r[n]]);return e}return t}function M0(t){return["__proto__","prototype","constructor"].indexOf(t)===-1}function qN(t,e,r,s){if(!M0(t))return;const n=e[t],o=r[t];Ge(n)&&Ge(o)?Pi(n,o,s):e[t]=Vc(o)}function Pi(t,e,r){const s=hr(e)?e:[e],n=s.length;if(!Ge(t))return t;r=r||{};const o=r.merger||qN;let i;for(let l=0;l<n;++l){if(i=s[l],!Ge(i))continue;const c=Object.keys(i);for(let d=0,u=c.length;d<u;++d)o(c[d],t,i,r)}return t}function ai(t,e){return Pi(t,e,{merger:GN})}function GN(t,e,r){if(!M0(t))return;const s=e[t],n=r[t];Ge(s)&&Ge(n)?ai(s,n):Object.prototype.hasOwnProperty.call(e,t)||(e[t]=Vc(n))}const Cg={"":t=>t,x:t=>t.x,y:t=>t.y};function JN(t){const e=t.split("."),r=[];let s="";for(const n of e)s+=n,s.endsWith("\\")?s=s.slice(0,-1)+".":(r.push(s),s="");return r}function KN(t){const e=JN(t);return r=>{for(const s of e){if(s==="")break;r=r&&r[s]}return r}}function $i(t,e){return(Cg[e]||(Cg[e]=KN(e)))(t)}function nm(t){return t.charAt(0).toUpperCase()+t.slice(1)}const zc=t=>typeof t<"u",Mn=t=>typeof t=="function",jg=(t,e)=>{if(t.size!==e.size)return!1;for(const r of t)if(!e.has(r))return!1;return!0};function YN(t){return t.type==="mouseup"||t.type==="click"||t.type==="contextmenu"}const _t=Math.PI,qt=2*_t,Uc=Number.POSITIVE_INFINITY,QN=_t/180,rr=_t/2,Un=_t/4,kg=_t*2/3,Ng=Math.sign;function ZN(t){const e=[],r=Math.sqrt(t);let s;for(s=1;s<r;s++)t%s===0&&(e.push(s),e.push(t/s));return r===(r|0)&&e.push(r),e.sort((n,o)=>n-o).pop(),e}function XN(t){return typeof t=="symbol"||typeof t=="object"&&t!==null&&!(Symbol.toPrimitive in t||"toString"in t||"valueOf"in t)}function Wc(t){return!XN(t)&&!isNaN(parseFloat(t))&&isFinite(t)}function lo(t){return t*(_t/180)}function eI(t){return t*(180/_t)}function R0(t,e){const r=e.x-t.x,s=e.y-t.y,n=Math.sqrt(r*r+s*s);let o=Math.atan2(s,r);return o<-.5*_t&&(o+=qt),{angle:o,distance:n}}function tI(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function Ps(t){return(t%qt+qt)%qt}function qc(t,e,r,s){const n=Ps(t),o=Ps(e),i=Ps(r),l=Ps(o-n),c=Ps(i-n),d=Ps(n-o),u=Ps(n-i);return n===o||n===i||s&&o===i||l>c&&d<u}function hs(t,e,r){return Math.max(e,Math.min(r,t))}function rI(t){return hs(t,-32768,32767)}function Va(t,e,r,s=1e-6){return t>=Math.min(e,r)-s&&t<=Math.max(e,r)+s}function om(t,e,r){r=r||(i=>t[i]<e);let s=t.length-1,n=0,o;for(;s-n>1;)o=n+s>>1,r(o)?n=o:s=o;return{lo:n,hi:s}}const Hh=(t,e,r,s)=>om(t,r,s?n=>{const o=t[n][e];return o<r||o===r&&t[n+1][e]===r}:n=>t[n][e]<r),sI=(t,e,r)=>om(t,r,s=>t[s][e]>=r);function nI(t,e,r){let s=0,n=t.length;for(;s<n&&t[s]<e;)s++;for(;n>s&&t[n-1]>r;)n--;return s>0||n<t.length?t.slice(s,n):t}const O0=["push","pop","shift","splice","unshift"];function oI(t,e){if(t._chartjs){t._chartjs.listeners.push(e);return}Object.defineProperty(t,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),O0.forEach(r=>{const s="_onData"+nm(r),n=t[r];Object.defineProperty(t,r,{configurable:!0,enumerable:!1,value(...o){const i=n.apply(this,o);return t._chartjs.listeners.forEach(l=>{typeof l[s]=="function"&&l[s](...o)}),i}})})}function Ig(t,e){const r=t._chartjs;if(!r)return;const s=r.listeners,n=s.indexOf(e);n!==-1&&s.splice(n,1),!(s.length>0)&&(O0.forEach(o=>{delete t[o]}),delete t._chartjs)}function aI(t){const e=new Set(t);return e.size===t.length?t:Array.from(e)}const P0=function(){return typeof window>"u"?function(t){return t()}:window.requestAnimationFrame}();function $0(t,e){let r=[],s=!1;return function(...n){r=n,s||(s=!0,P0.call(window,()=>{s=!1,t.apply(e,r)}))}}function iI(t,e){let r;return function(...s){return e?(clearTimeout(r),r=setTimeout(t,e,s)):t.apply(this,s),e}}const F0=t=>t==="start"?"left":t==="end"?"right":"center",Qr=(t,e,r)=>t==="start"?e:t==="end"?r:(e+r)/2,lI=(t,e,r,s)=>t===(s?"left":"right")?r:t==="center"?(e+r)/2:e,Rl=t=>t===0||t===1,Eg=(t,e,r)=>-(Math.pow(2,10*(t-=1))*Math.sin((t-e)*qt/r)),Tg=(t,e,r)=>Math.pow(2,-10*t)*Math.sin((t-e)*qt/r)+1,ii={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>-t*(t-2),easeInOutQuad:t=>(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1),easeInCubic:t=>t*t*t,easeOutCubic:t=>(t-=1)*t*t+1,easeInOutCubic:t=>(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2),easeInQuart:t=>t*t*t*t,easeOutQuart:t=>-((t-=1)*t*t*t-1),easeInOutQuart:t=>(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2),easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>(t-=1)*t*t*t*t+1,easeInOutQuint:t=>(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2),easeInSine:t=>-Math.cos(t*rr)+1,easeOutSine:t=>Math.sin(t*rr),easeInOutSine:t=>-.5*(Math.cos(_t*t)-1),easeInExpo:t=>t===0?0:Math.pow(2,10*(t-1)),easeOutExpo:t=>t===1?1:-Math.pow(2,-10*t)+1,easeInOutExpo:t=>Rl(t)?t:t<.5?.5*Math.pow(2,10*(t*2-1)):.5*(-Math.pow(2,-10*(t*2-1))+2),easeInCirc:t=>t>=1?t:-(Math.sqrt(1-t*t)-1),easeOutCirc:t=>Math.sqrt(1-(t-=1)*t),easeInOutCirc:t=>(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1),easeInElastic:t=>Rl(t)?t:Eg(t,.075,.3),easeOutElastic:t=>Rl(t)?t:Tg(t,.075,.3),easeInOutElastic(t){return Rl(t)?t:t<.5?.5*Eg(t*2,.1125,.45):.5+.5*Tg(t*2-1,.1125,.45)},easeInBack(t){return t*t*((1.70158+1)*t-1.70158)},easeOutBack(t){return(t-=1)*t*((1.70158+1)*t+1.70158)+1},easeInOutBack(t){let e=1.70158;return(t/=.5)<1?.5*(t*t*(((e*=1.525)+1)*t-e)):.5*((t-=2)*t*(((e*=1.525)+1)*t+e)+2)},easeInBounce:t=>1-ii.easeOutBounce(1-t),easeOutBounce(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},easeInOutBounce:t=>t<.5?ii.easeInBounce(t*2)*.5:ii.easeOutBounce(t*2-1)*.5+.5};function B0(t){if(t&&typeof t=="object"){const e=t.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function Ag(t){return B0(t)?t:new Oi(t)}function fu(t){return B0(t)?t:new Oi(t).saturate(.5).darken(.1).hexString()}const cI=["x","y","borderWidth","radius","tension"],dI=["color","borderColor","backgroundColor"];function uI(t){t.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),t.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),t.set("animations",{colors:{type:"color",properties:dI},numbers:{type:"number",properties:cI}}),t.describe("animations",{_fallback:"animation"}),t.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function hI(t){t.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const Lg=new Map;function fI(t,e){e=e||{};const r=t+JSON.stringify(e);let s=Lg.get(r);return s||(s=new Intl.NumberFormat(t,e),Lg.set(r,s)),s}function mI(t,e,r){return fI(e,r).format(t)}const pI={values(t){return hr(t)?t:""+t}};var gI={formatters:pI};function _I(t){t.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,r)=>r.lineWidth,tickColor:(e,r)=>r.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:gI.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),t.route("scale.ticks","color","","color"),t.route("scale.grid","color","","borderColor"),t.route("scale.border","color","","borderColor"),t.route("scale.title","color","","color"),t.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),t.describe("scales",{_fallback:"scale"}),t.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}const vo=Object.create(null),Vh=Object.create(null);function li(t,e){if(!e)return t;const r=e.split(".");for(let s=0,n=r.length;s<n;++s){const o=r[s];t=t[o]||(t[o]=Object.create(null))}return t}function mu(t,e,r){return typeof e=="string"?Pi(li(t,e),r):Pi(li(t,""),e)}class yI{constructor(e,r){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=s=>s.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(s,n)=>fu(n.backgroundColor),this.hoverBorderColor=(s,n)=>fu(n.borderColor),this.hoverColor=(s,n)=>fu(n.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(r)}set(e,r){return mu(this,e,r)}get(e){return li(this,e)}describe(e,r){return mu(Vh,e,r)}override(e,r){return mu(vo,e,r)}route(e,r,s,n){const o=li(this,e),i=li(this,s),l="_"+r;Object.defineProperties(o,{[l]:{value:o[r],writable:!0},[r]:{enumerable:!0,get(){const c=this[l],d=i[n];return Ge(c)?Object.assign({},d,c):Xe(c,d)},set(c){this[l]=c}}})}apply(e){e.forEach(r=>r(this))}}var $t=new yI({_scriptable:t=>!t.startsWith("on"),_indexable:t=>t!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[uI,hI,_I]);function vI(t){return!t||wr(t.size)||wr(t.family)?null:(t.style?t.style+" ":"")+(t.weight?t.weight+" ":"")+t.size+"px "+t.family}function Dg(t,e,r,s,n){let o=e[n];return o||(o=e[n]=t.measureText(n).width,r.push(n)),o>s&&(s=o),s}function Wn(t,e,r){const s=t.currentDevicePixelRatio,n=r!==0?Math.max(r/2,.5):0;return Math.round((e-n)*s)/s+n}function Mg(t,e){!e&&!t||(e=e||t.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,t.width,t.height),e.restore())}function Rg(t,e,r,s){H0(t,e,r,s,null)}function H0(t,e,r,s,n){let o,i,l,c,d,u,h,f;const p=e.pointStyle,g=e.rotation,y=e.radius;let x=(g||0)*QN;if(p&&typeof p=="object"&&(o=p.toString(),o==="[object HTMLImageElement]"||o==="[object HTMLCanvasElement]")){t.save(),t.translate(r,s),t.rotate(x),t.drawImage(p,-p.width/2,-p.height/2,p.width,p.height),t.restore();return}if(!(isNaN(y)||y<=0)){switch(t.beginPath(),p){default:n?t.ellipse(r,s,n/2,y,0,0,qt):t.arc(r,s,y,0,qt),t.closePath();break;case"triangle":u=n?n/2:y,t.moveTo(r+Math.sin(x)*u,s-Math.cos(x)*y),x+=kg,t.lineTo(r+Math.sin(x)*u,s-Math.cos(x)*y),x+=kg,t.lineTo(r+Math.sin(x)*u,s-Math.cos(x)*y),t.closePath();break;case"rectRounded":d=y*.516,c=y-d,i=Math.cos(x+Un)*c,h=Math.cos(x+Un)*(n?n/2-d:c),l=Math.sin(x+Un)*c,f=Math.sin(x+Un)*(n?n/2-d:c),t.arc(r-h,s-l,d,x-_t,x-rr),t.arc(r+f,s-i,d,x-rr,x),t.arc(r+h,s+l,d,x,x+rr),t.arc(r-f,s+i,d,x+rr,x+_t),t.closePath();break;case"rect":if(!g){c=Math.SQRT1_2*y,u=n?n/2:c,t.rect(r-u,s-c,2*u,2*c);break}x+=Un;case"rectRot":h=Math.cos(x)*(n?n/2:y),i=Math.cos(x)*y,l=Math.sin(x)*y,f=Math.sin(x)*(n?n/2:y),t.moveTo(r-h,s-l),t.lineTo(r+f,s-i),t.lineTo(r+h,s+l),t.lineTo(r-f,s+i),t.closePath();break;case"crossRot":x+=Un;case"cross":h=Math.cos(x)*(n?n/2:y),i=Math.cos(x)*y,l=Math.sin(x)*y,f=Math.sin(x)*(n?n/2:y),t.moveTo(r-h,s-l),t.lineTo(r+h,s+l),t.moveTo(r+f,s-i),t.lineTo(r-f,s+i);break;case"star":h=Math.cos(x)*(n?n/2:y),i=Math.cos(x)*y,l=Math.sin(x)*y,f=Math.sin(x)*(n?n/2:y),t.moveTo(r-h,s-l),t.lineTo(r+h,s+l),t.moveTo(r+f,s-i),t.lineTo(r-f,s+i),x+=Un,h=Math.cos(x)*(n?n/2:y),i=Math.cos(x)*y,l=Math.sin(x)*y,f=Math.sin(x)*(n?n/2:y),t.moveTo(r-h,s-l),t.lineTo(r+h,s+l),t.moveTo(r+f,s-i),t.lineTo(r-f,s+i);break;case"line":i=n?n/2:Math.cos(x)*y,l=Math.sin(x)*y,t.moveTo(r-i,s-l),t.lineTo(r+i,s+l);break;case"dash":t.moveTo(r,s),t.lineTo(r+Math.cos(x)*(n?n/2:y),s+Math.sin(x)*y);break;case!1:t.closePath();break}t.fill(),e.borderWidth>0&&t.stroke()}}function V0(t,e,r){return r=r||.5,!e||t&&t.x>e.left-r&&t.x<e.right+r&&t.y>e.top-r&&t.y<e.bottom+r}function am(t,e){t.save(),t.beginPath(),t.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),t.clip()}function im(t){t.restore()}function xI(t,e){e.translation&&t.translate(e.translation[0],e.translation[1]),wr(e.rotation)||t.rotate(e.rotation),e.color&&(t.fillStyle=e.color),e.textAlign&&(t.textAlign=e.textAlign),e.textBaseline&&(t.textBaseline=e.textBaseline)}function bI(t,e,r,s,n){if(n.strikethrough||n.underline){const o=t.measureText(s),i=e-o.actualBoundingBoxLeft,l=e+o.actualBoundingBoxRight,c=r-o.actualBoundingBoxAscent,d=r+o.actualBoundingBoxDescent,u=n.strikethrough?(c+d)/2:d;t.strokeStyle=t.fillStyle,t.beginPath(),t.lineWidth=n.decorationWidth||2,t.moveTo(i,u),t.lineTo(l,u),t.stroke()}}function wI(t,e){const r=t.fillStyle;t.fillStyle=e.color,t.fillRect(e.left,e.top,e.width,e.height),t.fillStyle=r}function Gc(t,e,r,s,n,o={}){const i=hr(e)?e:[e],l=o.strokeWidth>0&&o.strokeColor!=="";let c,d;for(t.save(),t.font=n.string,xI(t,o),c=0;c<i.length;++c)d=i[c],o.backdrop&&wI(t,o.backdrop),l&&(o.strokeColor&&(t.strokeStyle=o.strokeColor),wr(o.strokeWidth)||(t.lineWidth=o.strokeWidth),t.strokeText(d,r,s,o.maxWidth)),t.fillText(d,r,s,o.maxWidth),bI(t,r,s,d,o),s+=Number(n.lineHeight);t.restore()}function zh(t,e){const{x:r,y:s,w:n,h:o,radius:i}=e;t.arc(r+i.topLeft,s+i.topLeft,i.topLeft,1.5*_t,_t,!0),t.lineTo(r,s+o-i.bottomLeft),t.arc(r+i.bottomLeft,s+o-i.bottomLeft,i.bottomLeft,_t,rr,!0),t.lineTo(r+n-i.bottomRight,s+o),t.arc(r+n-i.bottomRight,s+o-i.bottomRight,i.bottomRight,rr,0,!0),t.lineTo(r+n,s+i.topRight),t.arc(r+n-i.topRight,s+i.topRight,i.topRight,0,-rr,!0),t.lineTo(r+i.topLeft,s)}const SI=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,CI=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function jI(t,e){const r=(""+t).match(SI);if(!r||r[1]==="normal")return e*1.2;switch(t=+r[2],r[3]){case"px":return t;case"%":t/=100;break}return e*t}const kI=t=>+t||0;function lm(t,e){const r={},s=Ge(e),n=s?Object.keys(e):e,o=Ge(t)?s?i=>Xe(t[i],t[e[i]]):i=>t[i]:()=>t;for(const i of n)r[i]=kI(o(i));return r}function NI(t){return lm(t,{top:"y",right:"x",bottom:"y",left:"x"})}function ci(t){return lm(t,["topLeft","topRight","bottomLeft","bottomRight"])}function Is(t){const e=NI(t);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function qr(t,e){t=t||{},e=e||$t.font;let r=Xe(t.size,e.size);typeof r=="string"&&(r=parseInt(r,10));let s=Xe(t.style,e.style);s&&!(""+s).match(CI)&&(console.warn('Invalid font style specified: "'+s+'"'),s=void 0);const n={family:Xe(t.family,e.family),lineHeight:jI(Xe(t.lineHeight,e.lineHeight),r),size:r,style:s,weight:Xe(t.weight,e.weight),string:""};return n.string=vI(n),n}function Ol(t,e,r,s){let n,o,i;for(n=0,o=t.length;n<o;++n)if(i=t[n],i!==void 0&&i!==void 0)return i}function II(t,e,r){const{min:s,max:n}=t,o=D0(e,(n-s)/2),i=(l,c)=>r&&l===0?0:l+c;return{min:i(s,-Math.abs(o)),max:i(n,o)}}function ba(t,e){return Object.assign(Object.create(t),e)}function cm(t,e=[""],r,s,n=()=>t[0]){const o=r||t;typeof s>"u"&&(s=q0("_fallback",t));const i={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:t,_rootScopes:o,_fallback:s,_getTarget:n,override:l=>cm([l,...t],e,o,s)};return new Proxy(i,{deleteProperty(l,c){return delete l[c],delete l._keys,delete t[0][c],!0},get(l,c){return U0(l,c,()=>OI(c,e,t,l))},getOwnPropertyDescriptor(l,c){return Reflect.getOwnPropertyDescriptor(l._scopes[0],c)},getPrototypeOf(){return Reflect.getPrototypeOf(t[0])},has(l,c){return Pg(l).includes(c)},ownKeys(l){return Pg(l)},set(l,c,d){const u=l._storage||(l._storage=n());return l[c]=u[c]=d,delete l._keys,!0}})}function ha(t,e,r,s){const n={_cacheable:!1,_proxy:t,_context:e,_subProxy:r,_stack:new Set,_descriptors:z0(t,s),setContext:o=>ha(t,o,r,s),override:o=>ha(t.override(o),e,r,s)};return new Proxy(n,{deleteProperty(o,i){return delete o[i],delete t[i],!0},get(o,i,l){return U0(o,i,()=>TI(o,i,l))},getOwnPropertyDescriptor(o,i){return o._descriptors.allKeys?Reflect.has(t,i)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(t,i)},getPrototypeOf(){return Reflect.getPrototypeOf(t)},has(o,i){return Reflect.has(t,i)},ownKeys(){return Reflect.ownKeys(t)},set(o,i,l){return t[i]=l,delete o[i],!0}})}function z0(t,e={scriptable:!0,indexable:!0}){const{_scriptable:r=e.scriptable,_indexable:s=e.indexable,_allKeys:n=e.allKeys}=t;return{allKeys:n,scriptable:r,indexable:s,isScriptable:Mn(r)?r:()=>r,isIndexable:Mn(s)?s:()=>s}}const EI=(t,e)=>t?t+nm(e):e,dm=(t,e)=>Ge(e)&&t!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function U0(t,e,r){if(Object.prototype.hasOwnProperty.call(t,e)||e==="constructor")return t[e];const s=r();return t[e]=s,s}function TI(t,e,r){const{_proxy:s,_context:n,_subProxy:o,_descriptors:i}=t;let l=s[e];return Mn(l)&&i.isScriptable(e)&&(l=AI(e,l,t,r)),hr(l)&&l.length&&(l=LI(e,l,t,i.isIndexable)),dm(e,l)&&(l=ha(l,n,o&&o[e],i)),l}function AI(t,e,r,s){const{_proxy:n,_context:o,_subProxy:i,_stack:l}=r;if(l.has(t))throw new Error("Recursion detected: "+Array.from(l).join("->")+"->"+t);l.add(t);let c=e(o,i||s);return l.delete(t),dm(t,c)&&(c=um(n._scopes,n,t,c)),c}function LI(t,e,r,s){const{_proxy:n,_context:o,_subProxy:i,_descriptors:l}=r;if(typeof o.index<"u"&&s(t))return e[o.index%e.length];if(Ge(e[0])){const c=e,d=n._scopes.filter(u=>u!==c);e=[];for(const u of c){const h=um(d,n,t,u);e.push(ha(h,o,i&&i[t],l))}}return e}function W0(t,e,r){return Mn(t)?t(e,r):t}const DI=(t,e)=>t===!0?e:typeof t=="string"?$i(e,t):void 0;function MI(t,e,r,s,n){for(const o of e){const i=DI(r,o);if(i){t.add(i);const l=W0(i._fallback,r,n);if(typeof l<"u"&&l!==r&&l!==s)return l}else if(i===!1&&typeof s<"u"&&r!==s)return null}return!1}function um(t,e,r,s){const n=e._rootScopes,o=W0(e._fallback,r,s),i=[...t,...n],l=new Set;l.add(s);let c=Og(l,i,r,o||r,s);return c===null||typeof o<"u"&&o!==r&&(c=Og(l,i,o,c,s),c===null)?!1:cm(Array.from(l),[""],n,o,()=>RI(e,r,s))}function Og(t,e,r,s,n){for(;r;)r=MI(t,e,r,s,n);return r}function RI(t,e,r){const s=t._getTarget();e in s||(s[e]={});const n=s[e];return hr(n)&&Ge(r)?r:n||{}}function OI(t,e,r,s){let n;for(const o of e)if(n=q0(EI(o,t),r),typeof n<"u")return dm(t,n)?um(r,s,t,n):n}function q0(t,e){for(const r of e){if(!r)continue;const s=r[t];if(typeof s<"u")return s}}function Pg(t){let e=t._keys;return e||(e=t._keys=PI(t._scopes)),e}function PI(t){const e=new Set;for(const r of t)for(const s of Object.keys(r).filter(n=>!n.startsWith("_")))e.add(s);return Array.from(e)}function hm(){return typeof window<"u"&&typeof document<"u"}function fm(t){let e=t.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function Jc(t,e,r){let s;return typeof t=="string"?(s=parseInt(t,10),t.indexOf("%")!==-1&&(s=s/100*e.parentNode[r])):s=t,s}const bd=t=>t.ownerDocument.defaultView.getComputedStyle(t,null);function $I(t,e){return bd(t).getPropertyValue(e)}const FI=["top","right","bottom","left"];function fo(t,e,r){const s={};r=r?"-"+r:"";for(let n=0;n<4;n++){const o=FI[n];s[o]=parseFloat(t[e+"-"+o+r])||0}return s.width=s.left+s.right,s.height=s.top+s.bottom,s}const BI=(t,e,r)=>(t>0||e>0)&&(!r||!r.shadowRoot);function HI(t,e){const r=t.touches,s=r&&r.length?r[0]:t,{offsetX:n,offsetY:o}=s;let i=!1,l,c;if(BI(n,o,t.target))l=n,c=o;else{const d=e.getBoundingClientRect();l=s.clientX-d.left,c=s.clientY-d.top,i=!0}return{x:l,y:c,box:i}}function Xn(t,e){if("native"in t)return t;const{canvas:r,currentDevicePixelRatio:s}=e,n=bd(r),o=n.boxSizing==="border-box",i=fo(n,"padding"),l=fo(n,"border","width"),{x:c,y:d,box:u}=HI(t,r),h=i.left+(u&&l.left),f=i.top+(u&&l.top);let{width:p,height:g}=e;return o&&(p-=i.width+l.width,g-=i.height+l.height),{x:Math.round((c-h)/p*r.width/s),y:Math.round((d-f)/g*r.height/s)}}function VI(t,e,r){let s,n;if(e===void 0||r===void 0){const o=t&&fm(t);if(!o)e=t.clientWidth,r=t.clientHeight;else{const i=o.getBoundingClientRect(),l=bd(o),c=fo(l,"border","width"),d=fo(l,"padding");e=i.width-d.width-c.width,r=i.height-d.height-c.height,s=Jc(l.maxWidth,o,"clientWidth"),n=Jc(l.maxHeight,o,"clientHeight")}}return{width:e,height:r,maxWidth:s||Uc,maxHeight:n||Uc}}const xn=t=>Math.round(t*10)/10;function zI(t,e,r,s){const n=bd(t),o=fo(n,"margin"),i=Jc(n.maxWidth,t,"clientWidth")||Uc,l=Jc(n.maxHeight,t,"clientHeight")||Uc,c=VI(t,e,r);let{width:d,height:u}=c;if(n.boxSizing==="content-box"){const f=fo(n,"border","width"),p=fo(n,"padding");d-=p.width+f.width,u-=p.height+f.height}return d=Math.max(0,d-o.width),u=Math.max(0,s?d/s:u-o.height),d=xn(Math.min(d,i,c.maxWidth)),u=xn(Math.min(u,l,c.maxHeight)),d&&!u&&(u=xn(d/2)),(e!==void 0||r!==void 0)&&s&&c.height&&u>c.height&&(u=c.height,d=xn(Math.floor(u*s))),{width:d,height:u}}function $g(t,e,r){const s=e||1,n=xn(t.height*s),o=xn(t.width*s);t.height=xn(t.height),t.width=xn(t.width);const i=t.canvas;return i.style&&(r||!i.style.height&&!i.style.width)&&(i.style.height=`${t.height}px`,i.style.width=`${t.width}px`),t.currentDevicePixelRatio!==s||i.height!==n||i.width!==o?(t.currentDevicePixelRatio=s,i.height=n,i.width=o,t.ctx.setTransform(s,0,0,s,0,0),!0):!1}const UI=function(){let t=!1;try{const e={get passive(){return t=!0,!1}};hm()&&(window.addEventListener("test",null,e),window.removeEventListener("test",null,e))}catch{}return t}();function Fg(t,e){const r=$I(t,e),s=r&&r.match(/^(\d+)(\.\d+)?px$/);return s?+s[1]:void 0}const WI=function(t,e){return{x(r){return t+t+e-r},setWidth(r){e=r},textAlign(r){return r==="center"?r:r==="right"?"left":"right"},xPlus(r,s){return r-s},leftForLtr(r,s){return r-s}}},qI=function(){return{x(t){return t},setWidth(t){},textAlign(t){return t},xPlus(t,e){return t+e},leftForLtr(t,e){return t}}};function ra(t,e,r){return t?WI(e,r):qI()}function G0(t,e){let r,s;(e==="ltr"||e==="rtl")&&(r=t.canvas.style,s=[r.getPropertyValue("direction"),r.getPropertyPriority("direction")],r.setProperty("direction",e,"important"),t.prevTextDirection=s)}function J0(t,e){e!==void 0&&(delete t.prevTextDirection,t.canvas.style.setProperty("direction",e[0],e[1]))}function Pl(t,e,r){return t.options.clip?t[r]:e[r]}function GI(t,e){const{xScale:r,yScale:s}=t;return r&&s?{left:Pl(r,e,"left"),right:Pl(r,e,"right"),top:Pl(s,e,"top"),bottom:Pl(s,e,"bottom")}:e}function JI(t,e){const r=e._clip;if(r.disabled)return!1;const s=GI(e,t.chartArea);return{left:r.left===!1?0:s.left-(r.left===!0?0:r.left),right:r.right===!1?t.width:s.right+(r.right===!0?0:r.right),top:r.top===!1?0:s.top-(r.top===!0?0:r.top),bottom:r.bottom===!1?t.height:s.bottom+(r.bottom===!0?0:r.bottom)}}/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */class KI{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,r,s,n){const o=r.listeners[n],i=r.duration;o.forEach(l=>l({chart:e,initial:r.initial,numSteps:i,currentStep:Math.min(s-r.start,i)}))}_refresh(){this._request||(this._running=!0,this._request=P0.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let r=0;this._charts.forEach((s,n)=>{if(!s.running||!s.items.length)return;const o=s.items;let i=o.length-1,l=!1,c;for(;i>=0;--i)c=o[i],c._active?(c._total>s.duration&&(s.duration=c._total),c.tick(e),l=!0):(o[i]=o[o.length-1],o.pop());l&&(n.draw(),this._notify(n,s,e,"progress")),o.length||(s.running=!1,this._notify(n,s,e,"complete"),s.initial=!1),r+=o.length}),this._lastDate=e,r===0&&(this._running=!1)}_getAnims(e){const r=this._charts;let s=r.get(e);return s||(s={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},r.set(e,s)),s}listen(e,r,s){this._getAnims(e).listeners[r].push(s)}add(e,r){!r||!r.length||this._getAnims(e).items.push(...r)}has(e){return this._getAnims(e).items.length>0}start(e){const r=this._charts.get(e);r&&(r.running=!0,r.start=Date.now(),r.duration=r.items.reduce((s,n)=>Math.max(s,n._duration),0),this._refresh())}running(e){if(!this._running)return!1;const r=this._charts.get(e);return!(!r||!r.running||!r.items.length)}stop(e){const r=this._charts.get(e);if(!r||!r.items.length)return;const s=r.items;let n=s.length-1;for(;n>=0;--n)s[n].cancel();r.items=[],this._notify(e,r,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var zs=new KI;const Bg="transparent",YI={boolean(t,e,r){return r>.5?e:t},color(t,e,r){const s=Ag(t||Bg),n=s.valid&&Ag(e||Bg);return n&&n.valid?n.mix(s,r).hexString():e},number(t,e,r){return t+(e-t)*r}};class QI{constructor(e,r,s,n){const o=r[s];n=Ol([e.to,n,o,e.from]);const i=Ol([e.from,o,n]);this._active=!0,this._fn=e.fn||YI[e.type||typeof i],this._easing=ii[e.easing]||ii.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=r,this._prop=s,this._from=i,this._to=n,this._promises=void 0}active(){return this._active}update(e,r,s){if(this._active){this._notify(!1);const n=this._target[this._prop],o=s-this._start,i=this._duration-o;this._start=s,this._duration=Math.floor(Math.max(i,e.duration)),this._total+=o,this._loop=!!e.loop,this._to=Ol([e.to,r,n,e.from]),this._from=Ol([e.from,n,r])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const r=e-this._start,s=this._duration,n=this._prop,o=this._from,i=this._loop,l=this._to;let c;if(this._active=o!==l&&(i||r<s),!this._active){this._target[n]=l,this._notify(!0);return}if(r<0){this._target[n]=o;return}c=r/s%2,c=i&&c>1?2-c:c,c=this._easing(Math.min(1,Math.max(0,c))),this._target[n]=this._fn(o,l,c)}wait(){const e=this._promises||(this._promises=[]);return new Promise((r,s)=>{e.push({res:r,rej:s})})}_notify(e){const r=e?"res":"rej",s=this._promises||[];for(let n=0;n<s.length;n++)s[n][r]()}}class K0{constructor(e,r){this._chart=e,this._properties=new Map,this.configure(r)}configure(e){if(!Ge(e))return;const r=Object.keys($t.animation),s=this._properties;Object.getOwnPropertyNames(e).forEach(n=>{const o=e[n];if(!Ge(o))return;const i={};for(const l of r)i[l]=o[l];(hr(o.properties)&&o.properties||[n]).forEach(l=>{(l===n||!s.has(l))&&s.set(l,i)})})}_animateOptions(e,r){const s=r.options,n=XI(e,s);if(!n)return[];const o=this._createAnimations(n,s);return s.$shared&&ZI(e.options.$animations,s).then(()=>{e.options=s},()=>{}),o}_createAnimations(e,r){const s=this._properties,n=[],o=e.$animations||(e.$animations={}),i=Object.keys(r),l=Date.now();let c;for(c=i.length-1;c>=0;--c){const d=i[c];if(d.charAt(0)==="$")continue;if(d==="options"){n.push(...this._animateOptions(e,r));continue}const u=r[d];let h=o[d];const f=s.get(d);if(h)if(f&&h.active()){h.update(f,u,l);continue}else h.cancel();if(!f||!f.duration){e[d]=u;continue}o[d]=h=new QI(f,e,d,u),n.push(h)}return n}update(e,r){if(this._properties.size===0){Object.assign(e,r);return}const s=this._createAnimations(e,r);if(s.length)return zs.add(this._chart,s),!0}}function ZI(t,e){const r=[],s=Object.keys(e);for(let n=0;n<s.length;n++){const o=t[s[n]];o&&o.active()&&r.push(o.wait())}return Promise.all(r)}function XI(t,e){if(!e)return;let r=t.options;if(!r){t.options=e;return}return r.$shared&&(t.options=r=Object.assign({},r,{$shared:!1,$animations:{}})),r}function Hg(t,e){const r=t&&t.options||{},s=r.reverse,n=r.min===void 0?e:0,o=r.max===void 0?e:0;return{start:s?o:n,end:s?n:o}}function eE(t,e,r){if(r===!1)return!1;const s=Hg(t,r),n=Hg(e,r);return{top:n.end,right:s.end,bottom:n.start,left:s.start}}function tE(t){let e,r,s,n;return Ge(t)?(e=t.top,r=t.right,s=t.bottom,n=t.left):e=r=s=n=t,{top:e,right:r,bottom:s,left:n,disabled:t===!1}}function Y0(t,e){const r=[],s=t._getSortedDatasetMetas(e);let n,o;for(n=0,o=s.length;n<o;++n)r.push(s[n].index);return r}function Vg(t,e,r,s={}){const n=t.keys,o=s.mode==="single";let i,l,c,d;if(e===null)return;let u=!1;for(i=0,l=n.length;i<l;++i){if(c=+n[i],c===r){if(u=!0,s.all)continue;break}d=t.values[c],rn(d)&&(o||e===0||Ng(e)===Ng(d))&&(e+=d)}return!u&&!s.all?0:e}function rE(t,e){const{iScale:r,vScale:s}=e,n=r.axis==="x"?"x":"y",o=s.axis==="x"?"x":"y",i=Object.keys(t),l=new Array(i.length);let c,d,u;for(c=0,d=i.length;c<d;++c)u=i[c],l[c]={[n]:u,[o]:t[u]};return l}function pu(t,e){const r=t&&t.options.stacked;return r||r===void 0&&e.stack!==void 0}function sE(t,e,r){return`${t.id}.${e.id}.${r.stack||r.type}`}function nE(t){const{min:e,max:r,minDefined:s,maxDefined:n}=t.getUserBounds();return{min:s?e:Number.NEGATIVE_INFINITY,max:n?r:Number.POSITIVE_INFINITY}}function oE(t,e,r){const s=t[e]||(t[e]={});return s[r]||(s[r]={})}function zg(t,e,r,s){for(const n of e.getMatchingVisibleMetas(s).reverse()){const o=t[n.index];if(r&&o>0||!r&&o<0)return n.index}return null}function Ug(t,e){const{chart:r,_cachedMeta:s}=t,n=r._stacks||(r._stacks={}),{iScale:o,vScale:i,index:l}=s,c=o.axis,d=i.axis,u=sE(o,i,s),h=e.length;let f;for(let p=0;p<h;++p){const g=e[p],{[c]:y,[d]:x}=g,m=g._stacks||(g._stacks={});f=m[d]=oE(n,u,y),f[l]=x,f._top=zg(f,i,!0,s.type),f._bottom=zg(f,i,!1,s.type);const _=f._visualValues||(f._visualValues={});_[l]=x}}function gu(t,e){const r=t.scales;return Object.keys(r).filter(s=>r[s].axis===e).shift()}function aE(t,e){return ba(t,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function iE(t,e,r){return ba(t,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:r,index:e,mode:"default",type:"data"})}function Aa(t,e){const r=t.controller.index,s=t.vScale&&t.vScale.axis;if(s){e=e||t._parsed;for(const n of e){const o=n._stacks;if(!o||o[s]===void 0||o[s][r]===void 0)return;delete o[s][r],o[s]._visualValues!==void 0&&o[s]._visualValues[r]!==void 0&&delete o[s]._visualValues[r]}}}const _u=t=>t==="reset"||t==="none",Wg=(t,e)=>e?t:Object.assign({},t),lE=(t,e,r)=>t&&!e.hidden&&e._stacked&&{keys:Y0(r,!0),values:null};class di{constructor(e,r){this.chart=e,this._ctx=e.ctx,this.index=r,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=pu(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&Aa(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,r=this._cachedMeta,s=this.getDataset(),n=(h,f,p,g)=>h==="x"?f:h==="r"?g:p,o=r.xAxisID=Xe(s.xAxisID,gu(e,"x")),i=r.yAxisID=Xe(s.yAxisID,gu(e,"y")),l=r.rAxisID=Xe(s.rAxisID,gu(e,"r")),c=r.indexAxis,d=r.iAxisID=n(c,o,i,l),u=r.vAxisID=n(c,i,o,l);r.xScale=this.getScaleForId(o),r.yScale=this.getScaleForId(i),r.rScale=this.getScaleForId(l),r.iScale=this.getScaleForId(d),r.vScale=this.getScaleForId(u)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const r=this._cachedMeta;return e===r.iScale?r.vScale:r.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&Ig(this._data,this),e._stacked&&Aa(e)}_dataCheck(){const e=this.getDataset(),r=e.data||(e.data=[]),s=this._data;if(Ge(r)){const n=this._cachedMeta;this._data=rE(r,n)}else if(s!==r){if(s){Ig(s,this);const n=this._cachedMeta;Aa(n),n._parsed=[]}r&&Object.isExtensible(r)&&oI(r,this),this._syncList=[],this._data=r}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const r=this._cachedMeta,s=this.getDataset();let n=!1;this._dataCheck();const o=r._stacked;r._stacked=pu(r.vScale,r),r.stack!==s.stack&&(n=!0,Aa(r),r.stack=s.stack),this._resyncElements(e),(n||o!==r._stacked)&&(Ug(this,r._parsed),r._stacked=pu(r.vScale,r))}configure(){const e=this.chart.config,r=e.datasetScopeKeys(this._type),s=e.getOptionScopes(this.getDataset(),r,!0);this.options=e.createResolver(s,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,r){const{_cachedMeta:s,_data:n}=this,{iScale:o,_stacked:i}=s,l=o.axis;let c=e===0&&r===n.length?!0:s._sorted,d=e>0&&s._parsed[e-1],u,h,f;if(this._parsing===!1)s._parsed=n,s._sorted=!0,f=n;else{hr(n[e])?f=this.parseArrayData(s,n,e,r):Ge(n[e])?f=this.parseObjectData(s,n,e,r):f=this.parsePrimitiveData(s,n,e,r);const p=()=>h[l]===null||d&&h[l]<d[l];for(u=0;u<r;++u)s._parsed[u+e]=h=f[u],c&&(p()&&(c=!1),d=h);s._sorted=c}i&&Ug(this,f)}parsePrimitiveData(e,r,s,n){const{iScale:o,vScale:i}=e,l=o.axis,c=i.axis,d=o.getLabels(),u=o===i,h=new Array(n);let f,p,g;for(f=0,p=n;f<p;++f)g=f+s,h[f]={[l]:u||o.parse(d[g],g),[c]:i.parse(r[g],g)};return h}parseArrayData(e,r,s,n){const{xScale:o,yScale:i}=e,l=new Array(n);let c,d,u,h;for(c=0,d=n;c<d;++c)u=c+s,h=r[u],l[c]={x:o.parse(h[0],u),y:i.parse(h[1],u)};return l}parseObjectData(e,r,s,n){const{xScale:o,yScale:i}=e,{xAxisKey:l="x",yAxisKey:c="y"}=this._parsing,d=new Array(n);let u,h,f,p;for(u=0,h=n;u<h;++u)f=u+s,p=r[f],d[u]={x:o.parse($i(p,l),f),y:i.parse($i(p,c),f)};return d}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,r,s){const n=this.chart,o=this._cachedMeta,i=r[e.axis],l={keys:Y0(n,!0),values:r._stacks[e.axis]._visualValues};return Vg(l,i,o.index,{mode:s})}updateRangeFromParsed(e,r,s,n){const o=s[r.axis];let i=o===null?NaN:o;const l=n&&s._stacks[r.axis];n&&l&&(n.values=l,i=Vg(n,o,this._cachedMeta.index)),e.min=Math.min(e.min,i),e.max=Math.max(e.max,i)}getMinMax(e,r){const s=this._cachedMeta,n=s._parsed,o=s._sorted&&e===s.iScale,i=n.length,l=this._getOtherScale(e),c=lE(r,s,this.chart),d={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:u,max:h}=nE(l);let f,p;function g(){p=n[f];const y=p[l.axis];return!rn(p[e.axis])||u>y||h<y}for(f=0;f<i&&!(!g()&&(this.updateRangeFromParsed(d,e,p,c),o));++f);if(o){for(f=i-1;f>=0;--f)if(!g()){this.updateRangeFromParsed(d,e,p,c);break}}return d}getAllParsedValues(e){const r=this._cachedMeta._parsed,s=[];let n,o,i;for(n=0,o=r.length;n<o;++n)i=r[n][e.axis],rn(i)&&s.push(i);return s}getMaxOverflow(){return!1}getLabelAndValue(e){const r=this._cachedMeta,s=r.iScale,n=r.vScale,o=this.getParsed(e);return{label:s?""+s.getLabelForValue(o[s.axis]):"",value:n?""+n.getLabelForValue(o[n.axis]):""}}_update(e){const r=this._cachedMeta;this.update(e||"default"),r._clip=tE(Xe(this.options.clip,eE(r.xScale,r.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,r=this.chart,s=this._cachedMeta,n=s.data||[],o=r.chartArea,i=[],l=this._drawStart||0,c=this._drawCount||n.length-l,d=this.options.drawActiveElementsOnTop;let u;for(s.dataset&&s.dataset.draw(e,o,l,c),u=l;u<l+c;++u){const h=n[u];h.hidden||(h.active&&d?i.push(h):h.draw(e,o))}for(u=0;u<i.length;++u)i[u].draw(e,o)}getStyle(e,r){const s=r?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(s):this.resolveDataElementOptions(e||0,s)}getContext(e,r,s){const n=this.getDataset();let o;if(e>=0&&e<this._cachedMeta.data.length){const i=this._cachedMeta.data[e];o=i.$context||(i.$context=iE(this.getContext(),e,i)),o.parsed=this.getParsed(e),o.raw=n.data[e],o.index=o.dataIndex=e}else o=this.$context||(this.$context=aE(this.chart.getContext(),this.index)),o.dataset=n,o.index=o.datasetIndex=this.index;return o.active=!!r,o.mode=s,o}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,r){return this._resolveElementOptions(this.dataElementType.id,r,e)}_resolveElementOptions(e,r="default",s){const n=r==="active",o=this._cachedDataOpts,i=e+"-"+r,l=o[i],c=this.enableOptionSharing&&zc(s);if(l)return Wg(l,c);const d=this.chart.config,u=d.datasetElementScopeKeys(this._type,e),h=n?[`${e}Hover`,"hover",e,""]:[e,""],f=d.getOptionScopes(this.getDataset(),u),p=Object.keys($t.elements[e]),g=()=>this.getContext(s,n,r),y=d.resolveNamedOptions(f,p,g,h);return y.$shared&&(y.$shared=c,o[i]=Object.freeze(Wg(y,c))),y}_resolveAnimations(e,r,s){const n=this.chart,o=this._cachedDataOpts,i=`animation-${r}`,l=o[i];if(l)return l;let c;if(n.options.animation!==!1){const u=this.chart.config,h=u.datasetAnimationScopeKeys(this._type,r),f=u.getOptionScopes(this.getDataset(),h);c=u.createResolver(f,this.getContext(e,s,r))}const d=new K0(n,c&&c.animations);return c&&c._cacheable&&(o[i]=Object.freeze(d)),d}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,r){return!r||_u(e)||this.chart._animationsDisabled}_getSharedOptions(e,r){const s=this.resolveDataElementOptions(e,r),n=this._sharedOptions,o=this.getSharedOptions(s),i=this.includeOptions(r,o)||o!==n;return this.updateSharedOptions(o,r,s),{sharedOptions:o,includeOptions:i}}updateElement(e,r,s,n){_u(n)?Object.assign(e,s):this._resolveAnimations(r,n).update(e,s)}updateSharedOptions(e,r,s){e&&!_u(r)&&this._resolveAnimations(void 0,r).update(e,s)}_setStyle(e,r,s,n){e.active=n;const o=this.getStyle(r,n);this._resolveAnimations(r,s,n).update(e,{options:!n&&this.getSharedOptions(o)||o})}removeHoverStyle(e,r,s){this._setStyle(e,s,"active",!1)}setHoverStyle(e,r,s){this._setStyle(e,s,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const r=this._data,s=this._cachedMeta.data;for(const[l,c,d]of this._syncList)this[l](c,d);this._syncList=[];const n=s.length,o=r.length,i=Math.min(o,n);i&&this.parse(0,i),o>n?this._insertElements(n,o-n,e):o<n&&this._removeElements(o,n-o)}_insertElements(e,r,s=!0){const n=this._cachedMeta,o=n.data,i=e+r;let l;const c=d=>{for(d.length+=r,l=d.length-1;l>=i;l--)d[l]=d[l-r]};for(c(o),l=e;l<i;++l)o[l]=new this.dataElementType;this._parsing&&c(n._parsed),this.parse(e,r),s&&this.updateElements(o,e,r,"reset")}updateElements(e,r,s,n){}_removeElements(e,r){const s=this._cachedMeta;if(this._parsing){const n=s._parsed.splice(e,r);s._stacked&&Aa(s,n)}s.data.splice(e,r)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[r,s,n]=e;this[r](s,n)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,r){r&&this._sync(["_removeElements",e,r]);const s=arguments.length-2;s&&this._sync(["_insertElements",e,s])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}W(di,"defaults",{}),W(di,"datasetElementType",null),W(di,"dataElementType",null);function cE(t,e,r){let s=1,n=1,o=0,i=0;if(e<qt){const l=t,c=l+e,d=Math.cos(l),u=Math.sin(l),h=Math.cos(c),f=Math.sin(c),p=(v,w,S)=>qc(v,l,c,!0)?1:Math.max(w,w*r,S,S*r),g=(v,w,S)=>qc(v,l,c,!0)?-1:Math.min(w,w*r,S,S*r),y=p(0,d,h),x=p(rr,u,f),m=g(_t,d,h),_=g(_t+rr,u,f);s=(y-m)/2,n=(x-_)/2,o=-(y+m)/2,i=-(x+_)/2}return{ratioX:s,ratioY:n,offsetX:o,offsetY:i}}class za extends di{constructor(e,r){super(e,r),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,r){const s=this.getDataset().data,n=this._cachedMeta;if(this._parsing===!1)n._parsed=s;else{let o=c=>+s[c];if(Ge(s[e])){const{key:c="value"}=this._parsing;o=d=>+$i(s[d],c)}let i,l;for(i=e,l=e+r;i<l;++i)n._parsed[i]=o(i)}}_getRotation(){return lo(this.options.rotation-90)}_getCircumference(){return lo(this.options.circumference)}_getRotationExtents(){let e=qt,r=-qt;for(let s=0;s<this.chart.data.datasets.length;++s)if(this.chart.isDatasetVisible(s)&&this.chart.getDatasetMeta(s).type===this._type){const n=this.chart.getDatasetMeta(s).controller,o=n._getRotation(),i=n._getCircumference();e=Math.min(e,o),r=Math.max(r,o+i)}return{rotation:e,circumference:r-e}}update(e){const r=this.chart,{chartArea:s}=r,n=this._cachedMeta,o=n.data,i=this.getMaxBorderWidth()+this.getMaxOffset(o)+this.options.spacing,l=Math.max((Math.min(s.width,s.height)-i)/2,0),c=Math.min(WN(this.options.cutout,l),1),d=this._getRingWeight(this.index),{circumference:u,rotation:h}=this._getRotationExtents(),{ratioX:f,ratioY:p,offsetX:g,offsetY:y}=cE(h,u,c),x=(s.width-i)/f,m=(s.height-i)/p,_=Math.max(Math.min(x,m)/2,0),v=D0(this.options.radius,_),w=Math.max(v*c,0),S=(v-w)/this._getVisibleDatasetWeightTotal();this.offsetX=g*v,this.offsetY=y*v,n.total=this.calculateTotal(),this.outerRadius=v-S*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-S*d,0),this.updateElements(o,0,o.length,e)}_circumference(e,r){const s=this.options,n=this._cachedMeta,o=this._getCircumference();return r&&s.animation.animateRotate||!this.chart.getDataVisibility(e)||n._parsed[e]===null||n.data[e].hidden?0:this.calculateCircumference(n._parsed[e]*o/qt)}updateElements(e,r,s,n){const o=n==="reset",i=this.chart,l=i.chartArea,d=i.options.animation,u=(l.left+l.right)/2,h=(l.top+l.bottom)/2,f=o&&d.animateScale,p=f?0:this.innerRadius,g=f?0:this.outerRadius,{sharedOptions:y,includeOptions:x}=this._getSharedOptions(r,n);let m=this._getRotation(),_;for(_=0;_<r;++_)m+=this._circumference(_,o);for(_=r;_<r+s;++_){const v=this._circumference(_,o),w=e[_],S={x:u+this.offsetX,y:h+this.offsetY,startAngle:m,endAngle:m+v,circumference:v,outerRadius:g,innerRadius:p};x&&(S.options=y||this.resolveDataElementOptions(_,w.active?"active":n)),m+=v,this.updateElement(w,_,S,n)}}calculateTotal(){const e=this._cachedMeta,r=e.data;let s=0,n;for(n=0;n<r.length;n++){const o=e._parsed[n];o!==null&&!isNaN(o)&&this.chart.getDataVisibility(n)&&!r[n].hidden&&(s+=Math.abs(o))}return s}calculateCircumference(e){const r=this._cachedMeta.total;return r>0&&!isNaN(e)?qt*(Math.abs(e)/r):0}getLabelAndValue(e){const r=this._cachedMeta,s=this.chart,n=s.data.labels||[],o=mI(r._parsed[e],s.options.locale);return{label:n[e]||"",value:o}}getMaxBorderWidth(e){let r=0;const s=this.chart;let n,o,i,l,c;if(!e){for(n=0,o=s.data.datasets.length;n<o;++n)if(s.isDatasetVisible(n)){i=s.getDatasetMeta(n),e=i.data,l=i.controller;break}}if(!e)return 0;for(n=0,o=e.length;n<o;++n)c=l.resolveDataElementOptions(n),c.borderAlign!=="inner"&&(r=Math.max(r,c.borderWidth||0,c.hoverBorderWidth||0));return r}getMaxOffset(e){let r=0;for(let s=0,n=e.length;s<n;++s){const o=this.resolveDataElementOptions(s);r=Math.max(r,o.offset||0,o.hoverOffset||0)}return r}_getRingWeightOffset(e){let r=0;for(let s=0;s<e;++s)this.chart.isDatasetVisible(s)&&(r+=this._getRingWeight(s));return r}_getRingWeight(e){return Math.max(Xe(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}W(za,"id","doughnut"),W(za,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),W(za,"descriptors",{_scriptable:e=>e!=="spacing",_indexable:e=>e!=="spacing"&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")}),W(za,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const r=e.data,{labels:{pointStyle:s,textAlign:n,color:o,useBorderRadius:i,borderRadius:l}}=e.legend.options;return r.labels.length&&r.datasets.length?r.labels.map((c,d)=>{const h=e.getDatasetMeta(0).controller.getStyle(d);return{text:c,fillStyle:h.backgroundColor,fontColor:o,hidden:!e.getDataVisibility(d),lineDash:h.borderDash,lineDashOffset:h.borderDashOffset,lineJoin:h.borderJoinStyle,lineWidth:h.borderWidth,strokeStyle:h.borderColor,textAlign:n,pointStyle:s,borderRadius:i&&(l||h.borderRadius),index:d}}):[]}},onClick(e,r,s){s.chart.toggleDataVisibility(r.index),s.chart.update()}}}});function qn(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class mm{constructor(e){W(this,"options");this.options=e||{}}static override(e){Object.assign(mm.prototype,e)}init(){}formats(){return qn()}parse(){return qn()}format(){return qn()}add(){return qn()}diff(){return qn()}startOf(){return qn()}endOf(){return qn()}}var dE={_date:mm};function uE(t,e,r,s){const{controller:n,data:o,_sorted:i}=t,l=n._cachedMeta.iScale,c=t.dataset&&t.dataset.options?t.dataset.options.spanGaps:null;if(l&&e===l.axis&&e!=="r"&&i&&o.length){const d=l._reversePixels?sI:Hh;if(s){if(n._sharedOptions){const u=o[0],h=typeof u.getRange=="function"&&u.getRange(e);if(h){const f=d(o,e,r-h),p=d(o,e,r+h);return{lo:f.lo,hi:p.hi}}}}else{const u=d(o,e,r);if(c){const{vScale:h}=n._cachedMeta,{_parsed:f}=t,p=f.slice(0,u.lo+1).reverse().findIndex(y=>!wr(y[h.axis]));u.lo-=Math.max(0,p);const g=f.slice(u.hi).findIndex(y=>!wr(y[h.axis]));u.hi+=Math.max(0,g)}return u}}return{lo:0,hi:o.length-1}}function wd(t,e,r,s,n){const o=t.getSortedVisibleDatasetMetas(),i=r[e];for(let l=0,c=o.length;l<c;++l){const{index:d,data:u}=o[l],{lo:h,hi:f}=uE(o[l],e,i,n);for(let p=h;p<=f;++p){const g=u[p];g.skip||s(g,d,p)}}}function hE(t){const e=t.indexOf("x")!==-1,r=t.indexOf("y")!==-1;return function(s,n){const o=e?Math.abs(s.x-n.x):0,i=r?Math.abs(s.y-n.y):0;return Math.sqrt(Math.pow(o,2)+Math.pow(i,2))}}function yu(t,e,r,s,n){const o=[];return!n&&!t.isPointInArea(e)||wd(t,r,e,function(l,c,d){!n&&!V0(l,t.chartArea,0)||l.inRange(e.x,e.y,s)&&o.push({element:l,datasetIndex:c,index:d})},!0),o}function fE(t,e,r,s){let n=[];function o(i,l,c){const{startAngle:d,endAngle:u}=i.getProps(["startAngle","endAngle"],s),{angle:h}=R0(i,{x:e.x,y:e.y});qc(h,d,u)&&n.push({element:i,datasetIndex:l,index:c})}return wd(t,r,e,o),n}function mE(t,e,r,s,n,o){let i=[];const l=hE(r);let c=Number.POSITIVE_INFINITY;function d(u,h,f){const p=u.inRange(e.x,e.y,n);if(s&&!p)return;const g=u.getCenterPoint(n);if(!(!!o||t.isPointInArea(g))&&!p)return;const x=l(e,g);x<c?(i=[{element:u,datasetIndex:h,index:f}],c=x):x===c&&i.push({element:u,datasetIndex:h,index:f})}return wd(t,r,e,d),i}function vu(t,e,r,s,n,o){return!o&&!t.isPointInArea(e)?[]:r==="r"&&!s?fE(t,e,r,n):mE(t,e,r,s,n,o)}function qg(t,e,r,s,n){const o=[],i=r==="x"?"inXRange":"inYRange";let l=!1;return wd(t,r,e,(c,d,u)=>{c[i]&&c[i](e[r],n)&&(o.push({element:c,datasetIndex:d,index:u}),l=l||c.inRange(e.x,e.y,n))}),s&&!l?[]:o}var pE={modes:{index(t,e,r,s){const n=Xn(e,t),o=r.axis||"x",i=r.includeInvisible||!1,l=r.intersect?yu(t,n,o,s,i):vu(t,n,o,!1,s,i),c=[];return l.length?(t.getSortedVisibleDatasetMetas().forEach(d=>{const u=l[0].index,h=d.data[u];h&&!h.skip&&c.push({element:h,datasetIndex:d.index,index:u})}),c):[]},dataset(t,e,r,s){const n=Xn(e,t),o=r.axis||"xy",i=r.includeInvisible||!1;let l=r.intersect?yu(t,n,o,s,i):vu(t,n,o,!1,s,i);if(l.length>0){const c=l[0].datasetIndex,d=t.getDatasetMeta(c).data;l=[];for(let u=0;u<d.length;++u)l.push({element:d[u],datasetIndex:c,index:u})}return l},point(t,e,r,s){const n=Xn(e,t),o=r.axis||"xy",i=r.includeInvisible||!1;return yu(t,n,o,s,i)},nearest(t,e,r,s){const n=Xn(e,t),o=r.axis||"xy",i=r.includeInvisible||!1;return vu(t,n,o,r.intersect,s,i)},x(t,e,r,s){const n=Xn(e,t);return qg(t,n,"x",r.intersect,s)},y(t,e,r,s){const n=Xn(e,t);return qg(t,n,"y",r.intersect,s)}}};const Q0=["left","top","right","bottom"];function La(t,e){return t.filter(r=>r.pos===e)}function Gg(t,e){return t.filter(r=>Q0.indexOf(r.pos)===-1&&r.box.axis===e)}function Da(t,e){return t.sort((r,s)=>{const n=e?s:r,o=e?r:s;return n.weight===o.weight?n.index-o.index:n.weight-o.weight})}function gE(t){const e=[];let r,s,n,o,i,l;for(r=0,s=(t||[]).length;r<s;++r)n=t[r],{position:o,options:{stack:i,stackWeight:l=1}}=n,e.push({index:r,box:n,pos:o,horizontal:n.isHorizontal(),weight:n.weight,stack:i&&o+i,stackWeight:l});return e}function _E(t){const e={};for(const r of t){const{stack:s,pos:n,stackWeight:o}=r;if(!s||!Q0.includes(n))continue;const i=e[s]||(e[s]={count:0,placed:0,weight:0,size:0});i.count++,i.weight+=o}return e}function yE(t,e){const r=_E(t),{vBoxMaxWidth:s,hBoxMaxHeight:n}=e;let o,i,l;for(o=0,i=t.length;o<i;++o){l=t[o];const{fullSize:c}=l.box,d=r[l.stack],u=d&&l.stackWeight/d.weight;l.horizontal?(l.width=u?u*s:c&&e.availableWidth,l.height=n):(l.width=s,l.height=u?u*n:c&&e.availableHeight)}return r}function vE(t){const e=gE(t),r=Da(e.filter(d=>d.box.fullSize),!0),s=Da(La(e,"left"),!0),n=Da(La(e,"right")),o=Da(La(e,"top"),!0),i=Da(La(e,"bottom")),l=Gg(e,"x"),c=Gg(e,"y");return{fullSize:r,leftAndTop:s.concat(o),rightAndBottom:n.concat(c).concat(i).concat(l),chartArea:La(e,"chartArea"),vertical:s.concat(n).concat(c),horizontal:o.concat(i).concat(l)}}function Jg(t,e,r,s){return Math.max(t[r],e[r])+Math.max(t[s],e[s])}function Z0(t,e){t.top=Math.max(t.top,e.top),t.left=Math.max(t.left,e.left),t.bottom=Math.max(t.bottom,e.bottom),t.right=Math.max(t.right,e.right)}function xE(t,e,r,s){const{pos:n,box:o}=r,i=t.maxPadding;if(!Ge(n)){r.size&&(t[n]-=r.size);const h=s[r.stack]||{size:0,count:1};h.size=Math.max(h.size,r.horizontal?o.height:o.width),r.size=h.size/h.count,t[n]+=r.size}o.getPadding&&Z0(i,o.getPadding());const l=Math.max(0,e.outerWidth-Jg(i,t,"left","right")),c=Math.max(0,e.outerHeight-Jg(i,t,"top","bottom")),d=l!==t.w,u=c!==t.h;return t.w=l,t.h=c,r.horizontal?{same:d,other:u}:{same:u,other:d}}function bE(t){const e=t.maxPadding;function r(s){const n=Math.max(e[s]-t[s],0);return t[s]+=n,n}t.y+=r("top"),t.x+=r("left"),r("right"),r("bottom")}function wE(t,e){const r=e.maxPadding;function s(n){const o={left:0,top:0,right:0,bottom:0};return n.forEach(i=>{o[i]=Math.max(e[i],r[i])}),o}return s(t?["left","right"]:["top","bottom"])}function Ua(t,e,r,s){const n=[];let o,i,l,c,d,u;for(o=0,i=t.length,d=0;o<i;++o){l=t[o],c=l.box,c.update(l.width||e.w,l.height||e.h,wE(l.horizontal,e));const{same:h,other:f}=xE(e,r,l,s);d|=h&&n.length,u=u||f,c.fullSize||n.push(l)}return d&&Ua(n,e,r,s)||u}function $l(t,e,r,s,n){t.top=r,t.left=e,t.right=e+s,t.bottom=r+n,t.width=s,t.height=n}function Kg(t,e,r,s){const n=r.padding;let{x:o,y:i}=e;for(const l of t){const c=l.box,d=s[l.stack]||{placed:0,weight:1},u=l.stackWeight/d.weight||1;if(l.horizontal){const h=e.w*u,f=d.size||c.height;zc(d.start)&&(i=d.start),c.fullSize?$l(c,n.left,i,r.outerWidth-n.right-n.left,f):$l(c,e.left+d.placed,i,h,f),d.start=i,d.placed+=h,i=c.bottom}else{const h=e.h*u,f=d.size||c.width;zc(d.start)&&(o=d.start),c.fullSize?$l(c,o,n.top,f,r.outerHeight-n.bottom-n.top):$l(c,o,e.top+d.placed,f,h),d.start=o,d.placed+=h,o=c.right}}e.x=o,e.y=i}var bn={addBox(t,e){t.boxes||(t.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(r){e.draw(r)}}]},t.boxes.push(e)},removeBox(t,e){const r=t.boxes?t.boxes.indexOf(e):-1;r!==-1&&t.boxes.splice(r,1)},configure(t,e,r){e.fullSize=r.fullSize,e.position=r.position,e.weight=r.weight},update(t,e,r,s){if(!t)return;const n=Is(t.options.layout.padding),o=Math.max(e-n.width,0),i=Math.max(r-n.height,0),l=vE(t.boxes),c=l.vertical,d=l.horizontal;Ze(t.boxes,y=>{typeof y.beforeLayout=="function"&&y.beforeLayout()});const u=c.reduce((y,x)=>x.box.options&&x.box.options.display===!1?y:y+1,0)||1,h=Object.freeze({outerWidth:e,outerHeight:r,padding:n,availableWidth:o,availableHeight:i,vBoxMaxWidth:o/2/u,hBoxMaxHeight:i/2}),f=Object.assign({},n);Z0(f,Is(s));const p=Object.assign({maxPadding:f,w:o,h:i,x:n.left,y:n.top},n),g=yE(c.concat(d),h);Ua(l.fullSize,p,h,g),Ua(c,p,h,g),Ua(d,p,h,g)&&Ua(c,p,h,g),bE(p),Kg(l.leftAndTop,p,h,g),p.x+=p.w,p.y+=p.h,Kg(l.rightAndBottom,p,h,g),t.chartArea={left:p.left,top:p.top,right:p.left+p.w,bottom:p.top+p.h,height:p.h,width:p.w},Ze(l.chartArea,y=>{const x=y.box;Object.assign(x,t.chartArea),x.update(p.w,p.h,{left:0,top:0,right:0,bottom:0})})}};class X0{acquireContext(e,r){}releaseContext(e){return!1}addEventListener(e,r,s){}removeEventListener(e,r,s){}getDevicePixelRatio(){return 1}getMaximumSize(e,r,s,n){return r=Math.max(0,r||e.width),s=s||e.height,{width:r,height:Math.max(0,n?Math.floor(r/n):s)}}isAttached(e){return!0}updateConfig(e){}}class SE extends X0{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const lc="$chartjs",CE={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},Yg=t=>t===null||t==="";function jE(t,e){const r=t.style,s=t.getAttribute("height"),n=t.getAttribute("width");if(t[lc]={initial:{height:s,width:n,style:{display:r.display,height:r.height,width:r.width}}},r.display=r.display||"block",r.boxSizing=r.boxSizing||"border-box",Yg(n)){const o=Fg(t,"width");o!==void 0&&(t.width=o)}if(Yg(s))if(t.style.height==="")t.height=t.width/(e||2);else{const o=Fg(t,"height");o!==void 0&&(t.height=o)}return t}const ex=UI?{passive:!0}:!1;function kE(t,e,r){t&&t.addEventListener(e,r,ex)}function NE(t,e,r){t&&t.canvas&&t.canvas.removeEventListener(e,r,ex)}function IE(t,e){const r=CE[t.type]||t.type,{x:s,y:n}=Xn(t,e);return{type:r,chart:e,native:t,x:s!==void 0?s:null,y:n!==void 0?n:null}}function Kc(t,e){for(const r of t)if(r===e||r.contains(e))return!0}function EE(t,e,r){const s=t.canvas,n=new MutationObserver(o=>{let i=!1;for(const l of o)i=i||Kc(l.addedNodes,s),i=i&&!Kc(l.removedNodes,s);i&&r()});return n.observe(document,{childList:!0,subtree:!0}),n}function TE(t,e,r){const s=t.canvas,n=new MutationObserver(o=>{let i=!1;for(const l of o)i=i||Kc(l.removedNodes,s),i=i&&!Kc(l.addedNodes,s);i&&r()});return n.observe(document,{childList:!0,subtree:!0}),n}const Fi=new Map;let Qg=0;function tx(){const t=window.devicePixelRatio;t!==Qg&&(Qg=t,Fi.forEach((e,r)=>{r.currentDevicePixelRatio!==t&&e()}))}function AE(t,e){Fi.size||window.addEventListener("resize",tx),Fi.set(t,e)}function LE(t){Fi.delete(t),Fi.size||window.removeEventListener("resize",tx)}function DE(t,e,r){const s=t.canvas,n=s&&fm(s);if(!n)return;const o=$0((l,c)=>{const d=n.clientWidth;r(l,c),d<n.clientWidth&&r()},window),i=new ResizeObserver(l=>{const c=l[0],d=c.contentRect.width,u=c.contentRect.height;d===0&&u===0||o(d,u)});return i.observe(n),AE(t,o),i}function xu(t,e,r){r&&r.disconnect(),e==="resize"&&LE(t)}function ME(t,e,r){const s=t.canvas,n=$0(o=>{t.ctx!==null&&r(IE(o,t))},t);return kE(s,e,n),n}class RE extends X0{acquireContext(e,r){const s=e&&e.getContext&&e.getContext("2d");return s&&s.canvas===e?(jE(e,r),s):null}releaseContext(e){const r=e.canvas;if(!r[lc])return!1;const s=r[lc].initial;["height","width"].forEach(o=>{const i=s[o];wr(i)?r.removeAttribute(o):r.setAttribute(o,i)});const n=s.style||{};return Object.keys(n).forEach(o=>{r.style[o]=n[o]}),r.width=r.width,delete r[lc],!0}addEventListener(e,r,s){this.removeEventListener(e,r);const n=e.$proxies||(e.$proxies={}),i={attach:EE,detach:TE,resize:DE}[r]||ME;n[r]=i(e,r,s)}removeEventListener(e,r){const s=e.$proxies||(e.$proxies={}),n=s[r];if(!n)return;({attach:xu,detach:xu,resize:xu}[r]||NE)(e,r,n),s[r]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,r,s,n){return zI(e,r,s,n)}isAttached(e){const r=e&&fm(e);return!!(r&&r.isConnected)}}function OE(t){return!hm()||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas?SE:RE}class xo{constructor(){W(this,"x");W(this,"y");W(this,"active",!1);W(this,"options");W(this,"$animations")}tooltipPosition(e){const{x:r,y:s}=this.getProps(["x","y"],e);return{x:r,y:s}}hasValue(){return Wc(this.x)&&Wc(this.y)}getProps(e,r){const s=this.$animations;if(!r||!s)return this;const n={};return e.forEach(o=>{n[o]=s[o]&&s[o].active()?s[o]._to:this[o]}),n}}W(xo,"defaults",{}),W(xo,"defaultRoutes");function PE(t,e){const r=t.options.ticks,s=$E(t),n=Math.min(r.maxTicksLimit||s,s),o=r.major.enabled?BE(e):[],i=o.length,l=o[0],c=o[i-1],d=[];if(i>n)return HE(e,d,o,i/n),d;const u=FE(o,e,n);if(i>0){let h,f;const p=i>1?Math.round((c-l)/(i-1)):null;for(Fl(e,d,u,wr(p)?0:l-p,l),h=0,f=i-1;h<f;h++)Fl(e,d,u,o[h],o[h+1]);return Fl(e,d,u,c,wr(p)?e.length:c+p),d}return Fl(e,d,u),d}function $E(t){const e=t.options.offset,r=t._tickSize(),s=t._length/r+(e?0:1),n=t._maxLength/r;return Math.floor(Math.min(s,n))}function FE(t,e,r){const s=VE(t),n=e.length/r;if(!s)return Math.max(n,1);const o=ZN(s);for(let i=0,l=o.length-1;i<l;i++){const c=o[i];if(c>n)return c}return Math.max(n,1)}function BE(t){const e=[];let r,s;for(r=0,s=t.length;r<s;r++)t[r].major&&e.push(r);return e}function HE(t,e,r,s){let n=0,o=r[0],i;for(s=Math.ceil(s),i=0;i<t.length;i++)i===o&&(e.push(t[i]),n++,o=r[n*s])}function Fl(t,e,r,s,n){const o=Xe(s,0),i=Math.min(Xe(n,t.length),t.length);let l=0,c,d,u;for(r=Math.ceil(r),n&&(c=n-s,r=c/Math.floor(c/r)),u=o;u<0;)l++,u=Math.round(o+l*r);for(d=Math.max(o,0);d<i;d++)d===u&&(e.push(t[d]),l++,u=Math.round(o+l*r))}function VE(t){const e=t.length;let r,s;if(e<2)return!1;for(s=t[0],r=1;r<e;++r)if(t[r]-t[r-1]!==s)return!1;return s}const zE=t=>t==="left"?"right":t==="right"?"left":t,Zg=(t,e,r)=>e==="top"||e==="left"?t[e]+r:t[e]-r,Xg=(t,e)=>Math.min(e||t,t);function e_(t,e){const r=[],s=t.length/e,n=t.length;let o=0;for(;o<n;o+=s)r.push(t[Math.floor(o)]);return r}function UE(t,e,r){const s=t.ticks.length,n=Math.min(e,s-1),o=t._startPixel,i=t._endPixel,l=1e-6;let c=t.getPixelForTick(n),d;if(!(r&&(s===1?d=Math.max(c-o,i-c):e===0?d=(t.getPixelForTick(1)-c)/2:d=(c-t.getPixelForTick(n-1))/2,c+=n<e?d:-d,c<o-l||c>i+l)))return c}function WE(t,e){Ze(t,r=>{const s=r.gc,n=s.length/2;let o;if(n>e){for(o=0;o<n;++o)delete r.data[s[o]];s.splice(0,n)}})}function Ma(t){return t.drawTicks?t.tickLength:0}function t_(t,e){if(!t.display)return 0;const r=qr(t.font,e),s=Is(t.padding);return(hr(t.text)?t.text.length:1)*r.lineHeight+s.height}function qE(t,e){return ba(t,{scale:e,type:"scale"})}function GE(t,e,r){return ba(t,{tick:r,index:e,type:"tick"})}function JE(t,e,r){let s=F0(t);return(r&&e!=="right"||!r&&e==="right")&&(s=zE(s)),s}function KE(t,e,r,s){const{top:n,left:o,bottom:i,right:l,chart:c}=t,{chartArea:d,scales:u}=c;let h=0,f,p,g;const y=i-n,x=l-o;if(t.isHorizontal()){if(p=Qr(s,o,l),Ge(r)){const m=Object.keys(r)[0],_=r[m];g=u[m].getPixelForValue(_)+y-e}else r==="center"?g=(d.bottom+d.top)/2+y-e:g=Zg(t,r,e);f=l-o}else{if(Ge(r)){const m=Object.keys(r)[0],_=r[m];p=u[m].getPixelForValue(_)-x+e}else r==="center"?p=(d.left+d.right)/2-x+e:p=Zg(t,r,e);g=Qr(s,i,n),h=r==="left"?-rr:rr}return{titleX:p,titleY:g,maxWidth:f,rotation:h}}class Sd extends xo{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,r){return e}getUserBounds(){let{_userMin:e,_userMax:r,_suggestedMin:s,_suggestedMax:n}=this;return e=Ls(e,Number.POSITIVE_INFINITY),r=Ls(r,Number.NEGATIVE_INFINITY),s=Ls(s,Number.POSITIVE_INFINITY),n=Ls(n,Number.NEGATIVE_INFINITY),{min:Ls(e,s),max:Ls(r,n),minDefined:rn(e),maxDefined:rn(r)}}getMinMax(e){let{min:r,max:s,minDefined:n,maxDefined:o}=this.getUserBounds(),i;if(n&&o)return{min:r,max:s};const l=this.getMatchingVisibleMetas();for(let c=0,d=l.length;c<d;++c)i=l[c].controller.getMinMax(this,e),n||(r=Math.min(r,i.min)),o||(s=Math.max(s,i.max));return r=o&&r>s?s:r,s=n&&r>s?r:s,{min:Ls(r,Ls(s,r)),max:Ls(s,Ls(r,s))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){gt(this.options.beforeUpdate,[this])}update(e,r,s){const{beginAtZero:n,grace:o,ticks:i}=this.options,l=i.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=r,this._margins=s=Object.assign({left:0,right:0,top:0,bottom:0},s),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+s.left+s.right:this.height+s.top+s.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=II(this,o,n),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const c=l<this.ticks.length;this._convertTicksToLabels(c?e_(this.ticks,l):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),i.display&&(i.autoSkip||i.source==="auto")&&(this.ticks=PE(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),c&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,r,s;this.isHorizontal()?(r=this.left,s=this.right):(r=this.top,s=this.bottom,e=!e),this._startPixel=r,this._endPixel=s,this._reversePixels=e,this._length=s-r,this._alignToPixels=this.options.alignToPixels}afterUpdate(){gt(this.options.afterUpdate,[this])}beforeSetDimensions(){gt(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){gt(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),gt(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){gt(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const r=this.options.ticks;let s,n,o;for(s=0,n=e.length;s<n;s++)o=e[s],o.label=gt(r.callback,[o.value,s,e],this)}afterTickToLabelConversion(){gt(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){gt(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,r=e.ticks,s=Xg(this.ticks.length,e.ticks.maxTicksLimit),n=r.minRotation||0,o=r.maxRotation;let i=n,l,c,d;if(!this._isVisible()||!r.display||n>=o||s<=1||!this.isHorizontal()){this.labelRotation=n;return}const u=this._getLabelSizes(),h=u.widest.width,f=u.highest.height,p=hs(this.chart.width-h,0,this.maxWidth);l=e.offset?this.maxWidth/s:p/(s-1),h+6>l&&(l=p/(s-(e.offset?.5:1)),c=this.maxHeight-Ma(e.grid)-r.padding-t_(e.title,this.chart.options.font),d=Math.sqrt(h*h+f*f),i=eI(Math.min(Math.asin(hs((u.highest.height+6)/l,-1,1)),Math.asin(hs(c/d,-1,1))-Math.asin(hs(f/d,-1,1)))),i=Math.max(n,Math.min(o,i))),this.labelRotation=i}afterCalculateLabelRotation(){gt(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){gt(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:r,options:{ticks:s,title:n,grid:o}}=this,i=this._isVisible(),l=this.isHorizontal();if(i){const c=t_(n,r.options.font);if(l?(e.width=this.maxWidth,e.height=Ma(o)+c):(e.height=this.maxHeight,e.width=Ma(o)+c),s.display&&this.ticks.length){const{first:d,last:u,widest:h,highest:f}=this._getLabelSizes(),p=s.padding*2,g=lo(this.labelRotation),y=Math.cos(g),x=Math.sin(g);if(l){const m=s.mirror?0:x*h.width+y*f.height;e.height=Math.min(this.maxHeight,e.height+m+p)}else{const m=s.mirror?0:y*h.width+x*f.height;e.width=Math.min(this.maxWidth,e.width+m+p)}this._calculatePadding(d,u,x,y)}}this._handleMargins(),l?(this.width=this._length=r.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=r.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,r,s,n){const{ticks:{align:o,padding:i},position:l}=this.options,c=this.labelRotation!==0,d=l!=="top"&&this.axis==="x";if(this.isHorizontal()){const u=this.getPixelForTick(0)-this.left,h=this.right-this.getPixelForTick(this.ticks.length-1);let f=0,p=0;c?d?(f=n*e.width,p=s*r.height):(f=s*e.height,p=n*r.width):o==="start"?p=r.width:o==="end"?f=e.width:o!=="inner"&&(f=e.width/2,p=r.width/2),this.paddingLeft=Math.max((f-u+i)*this.width/(this.width-u),0),this.paddingRight=Math.max((p-h+i)*this.width/(this.width-h),0)}else{let u=r.height/2,h=e.height/2;o==="start"?(u=0,h=e.height):o==="end"&&(u=r.height,h=0),this.paddingTop=u+i,this.paddingBottom=h+i}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){gt(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:r}=this.options;return r==="top"||r==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let r,s;for(r=0,s=e.length;r<s;r++)wr(e[r].label)&&(e.splice(r,1),s--,r--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const r=this.options.ticks.sampleSize;let s=this.ticks;r<s.length&&(s=e_(s,r)),this._labelSizes=e=this._computeLabelSizes(s,s.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,r,s){const{ctx:n,_longestTextCache:o}=this,i=[],l=[],c=Math.floor(r/Xg(r,s));let d=0,u=0,h,f,p,g,y,x,m,_,v,w,S;for(h=0;h<r;h+=c){if(g=e[h].label,y=this._resolveTickFontOptions(h),n.font=x=y.string,m=o[x]=o[x]||{data:{},gc:[]},_=y.lineHeight,v=w=0,!wr(g)&&!hr(g))v=Dg(n,m.data,m.gc,v,g),w=_;else if(hr(g))for(f=0,p=g.length;f<p;++f)S=g[f],!wr(S)&&!hr(S)&&(v=Dg(n,m.data,m.gc,v,S),w+=_);i.push(v),l.push(w),d=Math.max(v,d),u=Math.max(w,u)}WE(o,r);const E=i.indexOf(d),C=l.indexOf(u),k=N=>({width:i[N]||0,height:l[N]||0});return{first:k(0),last:k(r-1),widest:k(E),highest:k(C),widths:i,heights:l}}getLabelForValue(e){return e}getPixelForValue(e,r){return NaN}getValueForPixel(e){}getPixelForTick(e){const r=this.ticks;return e<0||e>r.length-1?null:this.getPixelForValue(r[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const r=this._startPixel+e*this._length;return rI(this._alignToPixels?Wn(this.chart,r,0):r)}getDecimalForPixel(e){const r=(e-this._startPixel)/this._length;return this._reversePixels?1-r:r}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:r}=this;return e<0&&r<0?r:e>0&&r>0?e:0}getContext(e){const r=this.ticks||[];if(e>=0&&e<r.length){const s=r[e];return s.$context||(s.$context=GE(this.getContext(),e,s))}return this.$context||(this.$context=qE(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,r=lo(this.labelRotation),s=Math.abs(Math.cos(r)),n=Math.abs(Math.sin(r)),o=this._getLabelSizes(),i=e.autoSkipPadding||0,l=o?o.widest.width+i:0,c=o?o.highest.height+i:0;return this.isHorizontal()?c*s>l*n?l/s:c/n:c*n<l*s?c/s:l/n}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const r=this.axis,s=this.chart,n=this.options,{grid:o,position:i,border:l}=n,c=o.offset,d=this.isHorizontal(),h=this.ticks.length+(c?1:0),f=Ma(o),p=[],g=l.setContext(this.getContext()),y=g.display?g.width:0,x=y/2,m=function(O){return Wn(s,O,y)};let _,v,w,S,E,C,k,N,I,L,T,j;if(i==="top")_=m(this.bottom),C=this.bottom-f,N=_-x,L=m(e.top)+x,j=e.bottom;else if(i==="bottom")_=m(this.top),L=e.top,j=m(e.bottom)-x,C=_+x,N=this.top+f;else if(i==="left")_=m(this.right),E=this.right-f,k=_-x,I=m(e.left)+x,T=e.right;else if(i==="right")_=m(this.left),I=e.left,T=m(e.right)-x,E=_+x,k=this.left+f;else if(r==="x"){if(i==="center")_=m((e.top+e.bottom)/2+.5);else if(Ge(i)){const O=Object.keys(i)[0],z=i[O];_=m(this.chart.scales[O].getPixelForValue(z))}L=e.top,j=e.bottom,C=_+x,N=C+f}else if(r==="y"){if(i==="center")_=m((e.left+e.right)/2);else if(Ge(i)){const O=Object.keys(i)[0],z=i[O];_=m(this.chart.scales[O].getPixelForValue(z))}E=_-x,k=E-f,I=e.left,T=e.right}const M=Xe(n.ticks.maxTicksLimit,h),R=Math.max(1,Math.ceil(h/M));for(v=0;v<h;v+=R){const O=this.getContext(v),z=o.setContext(O),D=l.setContext(O),P=z.lineWidth,$=z.color,U=D.dash||[],A=D.dashOffset,Ae=z.tickWidth,ae=z.tickColor,Ke=z.tickBorderDash||[],Te=z.tickBorderDashOffset;w=UE(this,v,c),w!==void 0&&(S=Wn(s,w,P),d?E=k=I=T=S:C=N=L=j=S,p.push({tx1:E,ty1:C,tx2:k,ty2:N,x1:I,y1:L,x2:T,y2:j,width:P,color:$,borderDash:U,borderDashOffset:A,tickWidth:Ae,tickColor:ae,tickBorderDash:Ke,tickBorderDashOffset:Te}))}return this._ticksLength=h,this._borderValue=_,p}_computeLabelItems(e){const r=this.axis,s=this.options,{position:n,ticks:o}=s,i=this.isHorizontal(),l=this.ticks,{align:c,crossAlign:d,padding:u,mirror:h}=o,f=Ma(s.grid),p=f+u,g=h?-u:p,y=-lo(this.labelRotation),x=[];let m,_,v,w,S,E,C,k,N,I,L,T,j="middle";if(n==="top")E=this.bottom-g,C=this._getXAxisLabelAlignment();else if(n==="bottom")E=this.top+g,C=this._getXAxisLabelAlignment();else if(n==="left"){const R=this._getYAxisLabelAlignment(f);C=R.textAlign,S=R.x}else if(n==="right"){const R=this._getYAxisLabelAlignment(f);C=R.textAlign,S=R.x}else if(r==="x"){if(n==="center")E=(e.top+e.bottom)/2+p;else if(Ge(n)){const R=Object.keys(n)[0],O=n[R];E=this.chart.scales[R].getPixelForValue(O)+p}C=this._getXAxisLabelAlignment()}else if(r==="y"){if(n==="center")S=(e.left+e.right)/2-p;else if(Ge(n)){const R=Object.keys(n)[0],O=n[R];S=this.chart.scales[R].getPixelForValue(O)}C=this._getYAxisLabelAlignment(f).textAlign}r==="y"&&(c==="start"?j="top":c==="end"&&(j="bottom"));const M=this._getLabelSizes();for(m=0,_=l.length;m<_;++m){v=l[m],w=v.label;const R=o.setContext(this.getContext(m));k=this.getPixelForTick(m)+o.labelOffset,N=this._resolveTickFontOptions(m),I=N.lineHeight,L=hr(w)?w.length:1;const O=L/2,z=R.color,D=R.textStrokeColor,P=R.textStrokeWidth;let $=C;i?(S=k,C==="inner"&&(m===_-1?$=this.options.reverse?"left":"right":m===0?$=this.options.reverse?"right":"left":$="center"),n==="top"?d==="near"||y!==0?T=-L*I+I/2:d==="center"?T=-M.highest.height/2-O*I+I:T=-M.highest.height+I/2:d==="near"||y!==0?T=I/2:d==="center"?T=M.highest.height/2-O*I:T=M.highest.height-L*I,h&&(T*=-1),y!==0&&!R.showLabelBackdrop&&(S+=I/2*Math.sin(y))):(E=k,T=(1-L)*I/2);let U;if(R.showLabelBackdrop){const A=Is(R.backdropPadding),Ae=M.heights[m],ae=M.widths[m];let Ke=T-A.top,Te=0-A.left;switch(j){case"middle":Ke-=Ae/2;break;case"bottom":Ke-=Ae;break}switch(C){case"center":Te-=ae/2;break;case"right":Te-=ae;break;case"inner":m===_-1?Te-=ae:m>0&&(Te-=ae/2);break}U={left:Te,top:Ke,width:ae+A.width,height:Ae+A.height,color:R.backdropColor}}x.push({label:w,font:N,textOffset:T,options:{rotation:y,color:z,strokeColor:D,strokeWidth:P,textAlign:$,textBaseline:j,translation:[S,E],backdrop:U}})}return x}_getXAxisLabelAlignment(){const{position:e,ticks:r}=this.options;if(-lo(this.labelRotation))return e==="top"?"left":"right";let n="center";return r.align==="start"?n="left":r.align==="end"?n="right":r.align==="inner"&&(n="inner"),n}_getYAxisLabelAlignment(e){const{position:r,ticks:{crossAlign:s,mirror:n,padding:o}}=this.options,i=this._getLabelSizes(),l=e+o,c=i.widest.width;let d,u;return r==="left"?n?(u=this.right+o,s==="near"?d="left":s==="center"?(d="center",u+=c/2):(d="right",u+=c)):(u=this.right-l,s==="near"?d="right":s==="center"?(d="center",u-=c/2):(d="left",u=this.left)):r==="right"?n?(u=this.left+o,s==="near"?d="right":s==="center"?(d="center",u-=c/2):(d="left",u-=c)):(u=this.left+l,s==="near"?d="left":s==="center"?(d="center",u+=c/2):(d="right",u=this.right)):d="right",{textAlign:d,x:u}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,r=this.options.position;if(r==="left"||r==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(r==="top"||r==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:r},left:s,top:n,width:o,height:i}=this;r&&(e.save(),e.fillStyle=r,e.fillRect(s,n,o,i),e.restore())}getLineWidthForValue(e){const r=this.options.grid;if(!this._isVisible()||!r.display)return 0;const n=this.ticks.findIndex(o=>o.value===e);return n>=0?r.setContext(this.getContext(n)).lineWidth:0}drawGrid(e){const r=this.options.grid,s=this.ctx,n=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let o,i;const l=(c,d,u)=>{!u.width||!u.color||(s.save(),s.lineWidth=u.width,s.strokeStyle=u.color,s.setLineDash(u.borderDash||[]),s.lineDashOffset=u.borderDashOffset,s.beginPath(),s.moveTo(c.x,c.y),s.lineTo(d.x,d.y),s.stroke(),s.restore())};if(r.display)for(o=0,i=n.length;o<i;++o){const c=n[o];r.drawOnChartArea&&l({x:c.x1,y:c.y1},{x:c.x2,y:c.y2},c),r.drawTicks&&l({x:c.tx1,y:c.ty1},{x:c.tx2,y:c.ty2},{color:c.tickColor,width:c.tickWidth,borderDash:c.tickBorderDash,borderDashOffset:c.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:r,options:{border:s,grid:n}}=this,o=s.setContext(this.getContext()),i=s.display?o.width:0;if(!i)return;const l=n.setContext(this.getContext(0)).lineWidth,c=this._borderValue;let d,u,h,f;this.isHorizontal()?(d=Wn(e,this.left,i)-i/2,u=Wn(e,this.right,l)+l/2,h=f=c):(h=Wn(e,this.top,i)-i/2,f=Wn(e,this.bottom,l)+l/2,d=u=c),r.save(),r.lineWidth=o.width,r.strokeStyle=o.color,r.beginPath(),r.moveTo(d,h),r.lineTo(u,f),r.stroke(),r.restore()}drawLabels(e){if(!this.options.ticks.display)return;const s=this.ctx,n=this._computeLabelArea();n&&am(s,n);const o=this.getLabelItems(e);for(const i of o){const l=i.options,c=i.font,d=i.label,u=i.textOffset;Gc(s,d,0,u,c,l)}n&&im(s)}drawTitle(){const{ctx:e,options:{position:r,title:s,reverse:n}}=this;if(!s.display)return;const o=qr(s.font),i=Is(s.padding),l=s.align;let c=o.lineHeight/2;r==="bottom"||r==="center"||Ge(r)?(c+=i.bottom,hr(s.text)&&(c+=o.lineHeight*(s.text.length-1))):c+=i.top;const{titleX:d,titleY:u,maxWidth:h,rotation:f}=KE(this,c,r,l);Gc(e,s.text,0,0,o,{color:s.color,maxWidth:h,rotation:f,textAlign:JE(l,r,n),textBaseline:"middle",translation:[d,u]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,r=e.ticks&&e.ticks.z||0,s=Xe(e.grid&&e.grid.z,-1),n=Xe(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==Sd.prototype.draw?[{z:r,draw:o=>{this.draw(o)}}]:[{z:s,draw:o=>{this.drawBackground(),this.drawGrid(o),this.drawTitle()}},{z:n,draw:()=>{this.drawBorder()}},{z:r,draw:o=>{this.drawLabels(o)}}]}getMatchingVisibleMetas(e){const r=this.chart.getSortedVisibleDatasetMetas(),s=this.axis+"AxisID",n=[];let o,i;for(o=0,i=r.length;o<i;++o){const l=r[o];l[s]===this.id&&(!e||l.type===e)&&n.push(l)}return n}_resolveTickFontOptions(e){const r=this.options.ticks.setContext(this.getContext(e));return qr(r.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class Bl{constructor(e,r,s){this.type=e,this.scope=r,this.override=s,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const r=Object.getPrototypeOf(e);let s;ZE(r)&&(s=this.register(r));const n=this.items,o=e.id,i=this.scope+"."+o;if(!o)throw new Error("class does not have id: "+e);return o in n||(n[o]=e,YE(e,i,s),this.override&&$t.override(e.id,e.overrides)),i}get(e){return this.items[e]}unregister(e){const r=this.items,s=e.id,n=this.scope;s in r&&delete r[s],n&&s in $t[n]&&(delete $t[n][s],this.override&&delete vo[s])}}function YE(t,e,r){const s=Pi(Object.create(null),[r?$t.get(r):{},$t.get(e),t.defaults]);$t.set(e,s),t.defaultRoutes&&QE(e,t.defaultRoutes),t.descriptors&&$t.describe(e,t.descriptors)}function QE(t,e){Object.keys(e).forEach(r=>{const s=r.split("."),n=s.pop(),o=[t].concat(s).join("."),i=e[r].split("."),l=i.pop(),c=i.join(".");$t.route(o,n,c,l)})}function ZE(t){return"id"in t&&"defaults"in t}class XE{constructor(){this.controllers=new Bl(di,"datasets",!0),this.elements=new Bl(xo,"elements"),this.plugins=new Bl(Object,"plugins"),this.scales=new Bl(Sd,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,r,s){[...r].forEach(n=>{const o=s||this._getRegistryForType(n);s||o.isForType(n)||o===this.plugins&&n.id?this._exec(e,o,n):Ze(n,i=>{const l=s||this._getRegistryForType(i);this._exec(e,l,i)})})}_exec(e,r,s){const n=nm(e);gt(s["before"+n],[],s),r[e](s),gt(s["after"+n],[],s)}_getRegistryForType(e){for(let r=0;r<this._typedRegistries.length;r++){const s=this._typedRegistries[r];if(s.isForType(e))return s}return this.plugins}_get(e,r,s){const n=r.get(e);if(n===void 0)throw new Error('"'+e+'" is not a registered '+s+".");return n}}var Os=new XE;class e4{constructor(){this._init=void 0}notify(e,r,s,n){if(r==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install")),this._init===void 0)return;const o=n?this._descriptors(e).filter(n):this._descriptors(e),i=this._notify(o,e,r,s);return r==="afterDestroy"&&(this._notify(o,e,"stop"),this._notify(this._init,e,"uninstall"),this._init=void 0),i}_notify(e,r,s,n){n=n||{};for(const o of e){const i=o.plugin,l=i[s],c=[r,n,o.options];if(gt(l,c,i)===!1&&n.cancelable)return!1}return!0}invalidate(){wr(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const r=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),r}_createDescriptors(e,r){const s=e&&e.config,n=Xe(s.options&&s.options.plugins,{}),o=t4(s);return n===!1&&!r?[]:s4(e,o,n,r)}_notifyStateChanges(e){const r=this._oldCache||[],s=this._cache,n=(o,i)=>o.filter(l=>!i.some(c=>l.plugin.id===c.plugin.id));this._notify(n(r,s),e,"stop"),this._notify(n(s,r),e,"start")}}function t4(t){const e={},r=[],s=Object.keys(Os.plugins.items);for(let o=0;o<s.length;o++)r.push(Os.getPlugin(s[o]));const n=t.plugins||[];for(let o=0;o<n.length;o++){const i=n[o];r.indexOf(i)===-1&&(r.push(i),e[i.id]=!0)}return{plugins:r,localIds:e}}function r4(t,e){return!e&&t===!1?null:t===!0?{}:t}function s4(t,{plugins:e,localIds:r},s,n){const o=[],i=t.getContext();for(const l of e){const c=l.id,d=r4(s[c],n);d!==null&&o.push({plugin:l,options:n4(t.config,{plugin:l,local:r[c]},d,i)})}return o}function n4(t,{plugin:e,local:r},s,n){const o=t.pluginScopeKeys(e),i=t.getOptionScopes(s,o);return r&&e.defaults&&i.push(e.defaults),t.createResolver(i,n,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function Uh(t,e){const r=$t.datasets[t]||{};return((e.datasets||{})[t]||{}).indexAxis||e.indexAxis||r.indexAxis||"x"}function o4(t,e){let r=t;return t==="_index_"?r=e:t==="_value_"&&(r=e==="x"?"y":"x"),r}function a4(t,e){return t===e?"_index_":"_value_"}function r_(t){if(t==="x"||t==="y"||t==="r")return t}function i4(t){if(t==="top"||t==="bottom")return"x";if(t==="left"||t==="right")return"y"}function Wh(t,...e){if(r_(t))return t;for(const r of e){const s=r.axis||i4(r.position)||t.length>1&&r_(t[0].toLowerCase());if(s)return s}throw new Error(`Cannot determine type of '${t}' axis. Please provide 'axis' or 'position' option.`)}function s_(t,e,r){if(r[e+"AxisID"]===t)return{axis:e}}function l4(t,e){if(e.data&&e.data.datasets){const r=e.data.datasets.filter(s=>s.xAxisID===t||s.yAxisID===t);if(r.length)return s_(t,"x",r[0])||s_(t,"y",r[0])}return{}}function c4(t,e){const r=vo[t.type]||{scales:{}},s=e.scales||{},n=Uh(t.type,e),o=Object.create(null);return Object.keys(s).forEach(i=>{const l=s[i];if(!Ge(l))return console.error(`Invalid scale configuration for scale: ${i}`);if(l._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${i}`);const c=Wh(i,l,l4(i,t),$t.scales[l.type]),d=a4(c,n),u=r.scales||{};o[i]=ai(Object.create(null),[{axis:c},l,u[c],u[d]])}),t.data.datasets.forEach(i=>{const l=i.type||t.type,c=i.indexAxis||Uh(l,e),u=(vo[l]||{}).scales||{};Object.keys(u).forEach(h=>{const f=o4(h,c),p=i[f+"AxisID"]||f;o[p]=o[p]||Object.create(null),ai(o[p],[{axis:f},s[p],u[h]])})}),Object.keys(o).forEach(i=>{const l=o[i];ai(l,[$t.scales[l.type],$t.scale])}),o}function rx(t){const e=t.options||(t.options={});e.plugins=Xe(e.plugins,{}),e.scales=c4(t,e)}function sx(t){return t=t||{},t.datasets=t.datasets||[],t.labels=t.labels||[],t}function d4(t){return t=t||{},t.data=sx(t.data),rx(t),t}const n_=new Map,nx=new Set;function Hl(t,e){let r=n_.get(t);return r||(r=e(),n_.set(t,r),nx.add(r)),r}const Ra=(t,e,r)=>{const s=$i(e,r);s!==void 0&&t.add(s)};class u4{constructor(e){this._config=d4(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=sx(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),rx(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return Hl(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,r){return Hl(`${e}.transition.${r}`,()=>[[`datasets.${e}.transitions.${r}`,`transitions.${r}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,r){return Hl(`${e}-${r}`,()=>[[`datasets.${e}.elements.${r}`,`datasets.${e}`,`elements.${r}`,""]])}pluginScopeKeys(e){const r=e.id,s=this.type;return Hl(`${s}-plugin-${r}`,()=>[[`plugins.${r}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,r){const s=this._scopeCache;let n=s.get(e);return(!n||r)&&(n=new Map,s.set(e,n)),n}getOptionScopes(e,r,s){const{options:n,type:o}=this,i=this._cachedScopes(e,s),l=i.get(r);if(l)return l;const c=new Set;r.forEach(u=>{e&&(c.add(e),u.forEach(h=>Ra(c,e,h))),u.forEach(h=>Ra(c,n,h)),u.forEach(h=>Ra(c,vo[o]||{},h)),u.forEach(h=>Ra(c,$t,h)),u.forEach(h=>Ra(c,Vh,h))});const d=Array.from(c);return d.length===0&&d.push(Object.create(null)),nx.has(r)&&i.set(r,d),d}chartOptionScopes(){const{options:e,type:r}=this;return[e,vo[r]||{},$t.datasets[r]||{},{type:r},$t,Vh]}resolveNamedOptions(e,r,s,n=[""]){const o={$shared:!0},{resolver:i,subPrefixes:l}=o_(this._resolverCache,e,n);let c=i;if(f4(i,r)){o.$shared=!1,s=Mn(s)?s():s;const d=this.createResolver(e,s,l);c=ha(i,s,d)}for(const d of r)o[d]=c[d];return o}createResolver(e,r,s=[""],n){const{resolver:o}=o_(this._resolverCache,e,s);return Ge(r)?ha(o,r,void 0,n):o}}function o_(t,e,r){let s=t.get(e);s||(s=new Map,t.set(e,s));const n=r.join();let o=s.get(n);return o||(o={resolver:cm(e,r),subPrefixes:r.filter(l=>!l.toLowerCase().includes("hover"))},s.set(n,o)),o}const h4=t=>Ge(t)&&Object.getOwnPropertyNames(t).some(e=>Mn(t[e]));function f4(t,e){const{isScriptable:r,isIndexable:s}=z0(t);for(const n of e){const o=r(n),i=s(n),l=(i||o)&&t[n];if(o&&(Mn(l)||h4(l))||i&&hr(l))return!0}return!1}var m4="4.5.1";const p4=["top","bottom","left","right","chartArea"];function a_(t,e){return t==="top"||t==="bottom"||p4.indexOf(t)===-1&&e==="x"}function i_(t,e){return function(r,s){return r[t]===s[t]?r[e]-s[e]:r[t]-s[t]}}function l_(t){const e=t.chart,r=e.options.animation;e.notifyPlugins("afterRender"),gt(r&&r.onComplete,[t],e)}function g4(t){const e=t.chart,r=e.options.animation;gt(r&&r.onProgress,[t],e)}function ox(t){return hm()&&typeof t=="string"?t=document.getElementById(t):t&&t.length&&(t=t[0]),t&&t.canvas&&(t=t.canvas),t}const cc={},c_=t=>{const e=ox(t);return Object.values(cc).filter(r=>r.canvas===e).pop()};function _4(t,e,r){const s=Object.keys(t);for(const n of s){const o=+n;if(o>=e){const i=t[n];delete t[n],(r>0||o>e)&&(t[o+r]=i)}}}function y4(t,e,r,s){return!r||t.type==="mouseout"?null:s?e:t}var ln;let Cd=(ln=class{static register(...e){Os.add(...e),d_()}static unregister(...e){Os.remove(...e),d_()}constructor(e,r){const s=this.config=new u4(r),n=ox(e),o=c_(n);if(o)throw new Error("Canvas is already in use. Chart with ID '"+o.id+"' must be destroyed before the canvas with ID '"+o.canvas.id+"' can be reused.");const i=s.createResolver(s.chartOptionScopes(),this.getContext());this.platform=new(s.platform||OE(n)),this.platform.updateConfig(s);const l=this.platform.acquireContext(n,i.aspectRatio),c=l&&l.canvas,d=c&&c.height,u=c&&c.width;if(this.id=UN(),this.ctx=l,this.canvas=c,this.width=u,this.height=d,this._options=i,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new e4,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=iI(h=>this.update(h),i.resizeDelay||0),this._dataChanges=[],cc[this.id]=this,!l||!c){console.error("Failed to create chart: can't acquire context from the given item");return}zs.listen(this,"complete",l_),zs.listen(this,"progress",g4),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:r},width:s,height:n,_aspectRatio:o}=this;return wr(e)?r&&o?o:n?s/n:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return Os}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():$g(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return Mg(this.canvas,this.ctx),this}stop(){return zs.stop(this),this}resize(e,r){zs.running(this)?this._resizeBeforeDraw={width:e,height:r}:this._resize(e,r)}_resize(e,r){const s=this.options,n=this.canvas,o=s.maintainAspectRatio&&this.aspectRatio,i=this.platform.getMaximumSize(n,e,r,o),l=s.devicePixelRatio||this.platform.getDevicePixelRatio(),c=this.width?"resize":"attach";this.width=i.width,this.height=i.height,this._aspectRatio=this.aspectRatio,$g(this,l,!0)&&(this.notifyPlugins("resize",{size:i}),gt(s.onResize,[this,i],this),this.attached&&this._doResize(c)&&this.render())}ensureScalesHaveIDs(){const r=this.options.scales||{};Ze(r,(s,n)=>{s.id=n})}buildOrUpdateScales(){const e=this.options,r=e.scales,s=this.scales,n=Object.keys(s).reduce((i,l)=>(i[l]=!1,i),{});let o=[];r&&(o=o.concat(Object.keys(r).map(i=>{const l=r[i],c=Wh(i,l),d=c==="r",u=c==="x";return{options:l,dposition:d?"chartArea":u?"bottom":"left",dtype:d?"radialLinear":u?"category":"linear"}}))),Ze(o,i=>{const l=i.options,c=l.id,d=Wh(c,l),u=Xe(l.type,i.dtype);(l.position===void 0||a_(l.position,d)!==a_(i.dposition))&&(l.position=i.dposition),n[c]=!0;let h=null;if(c in s&&s[c].type===u)h=s[c];else{const f=Os.getScale(u);h=new f({id:c,type:u,ctx:this.ctx,chart:this}),s[h.id]=h}h.init(l,e)}),Ze(n,(i,l)=>{i||delete s[l]}),Ze(s,i=>{bn.configure(this,i,i.options),bn.addBox(this,i)})}_updateMetasets(){const e=this._metasets,r=this.data.datasets.length,s=e.length;if(e.sort((n,o)=>n.index-o.index),s>r){for(let n=r;n<s;++n)this._destroyDatasetMeta(n);e.splice(r,s-r)}this._sortedMetasets=e.slice(0).sort(i_("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:r}}=this;e.length>r.length&&delete this._stacks,e.forEach((s,n)=>{r.filter(o=>o===s._dataset).length===0&&this._destroyDatasetMeta(n)})}buildOrUpdateControllers(){const e=[],r=this.data.datasets;let s,n;for(this._removeUnreferencedMetasets(),s=0,n=r.length;s<n;s++){const o=r[s];let i=this.getDatasetMeta(s);const l=o.type||this.config.type;if(i.type&&i.type!==l&&(this._destroyDatasetMeta(s),i=this.getDatasetMeta(s)),i.type=l,i.indexAxis=o.indexAxis||Uh(l,this.options),i.order=o.order||0,i.index=s,i.label=""+o.label,i.visible=this.isDatasetVisible(s),i.controller)i.controller.updateIndex(s),i.controller.linkScales();else{const c=Os.getController(l),{datasetElementType:d,dataElementType:u}=$t.datasets[l];Object.assign(c,{dataElementType:Os.getElement(u),datasetElementType:d&&Os.getElement(d)}),i.controller=new c(this,s),e.push(i.controller)}}return this._updateMetasets(),e}_resetElements(){Ze(this.data.datasets,(e,r)=>{this.getDatasetMeta(r).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const r=this.config;r.update();const s=this._options=r.createResolver(r.chartOptionScopes(),this.getContext()),n=this._animationsDisabled=!s.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const o=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let i=0;for(let d=0,u=this.data.datasets.length;d<u;d++){const{controller:h}=this.getDatasetMeta(d),f=!n&&o.indexOf(h)===-1;h.buildOrUpdateElements(f),i=Math.max(+h.getMaxOverflow(),i)}i=this._minPadding=s.layout.autoPadding?i:0,this._updateLayout(i),n||Ze(o,d=>{d.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(i_("z","_idx"));const{_active:l,_lastEvent:c}=this;c?this._eventHandler(c,!0):l.length&&this._updateHoverStyles(l,l,!0),this.render()}_updateScales(){Ze(this.scales,e=>{bn.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,r=new Set(Object.keys(this._listeners)),s=new Set(e.events);(!jg(r,s)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,r=this._getUniformDataChanges()||[];for(const{method:s,start:n,count:o}of r){const i=s==="_removeElements"?-o:o;_4(e,n,i)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const r=this.data.datasets.length,s=o=>new Set(e.filter(i=>i[0]===o).map((i,l)=>l+","+i.splice(1).join(","))),n=s(0);for(let o=1;o<r;o++)if(!jg(n,s(o)))return;return Array.from(n).map(o=>o.split(",")).map(o=>({method:o[1],start:+o[2],count:+o[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;bn.update(this,this.width,this.height,e);const r=this.chartArea,s=r.width<=0||r.height<=0;this._layers=[],Ze(this.boxes,n=>{s&&n.position==="chartArea"||(n.configure&&n.configure(),this._layers.push(...n._layers()))},this),this._layers.forEach((n,o)=>{n._idx=o}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let r=0,s=this.data.datasets.length;r<s;++r)this.getDatasetMeta(r).controller.configure();for(let r=0,s=this.data.datasets.length;r<s;++r)this._updateDataset(r,Mn(e)?e({datasetIndex:r}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,r){const s=this.getDatasetMeta(e),n={meta:s,index:e,mode:r,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",n)!==!1&&(s.controller._update(r),n.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",n))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(zs.has(this)?this.attached&&!zs.running(this)&&zs.start(this):(this.draw(),l_({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:s,height:n}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(s,n)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const r=this._layers;for(e=0;e<r.length&&r[e].z<=0;++e)r[e].draw(this.chartArea);for(this._drawDatasets();e<r.length;++e)r[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const r=this._sortedMetasets,s=[];let n,o;for(n=0,o=r.length;n<o;++n){const i=r[n];(!e||i.visible)&&s.push(i)}return s}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let r=e.length-1;r>=0;--r)this._drawDataset(e[r]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const r=this.ctx,s={meta:e,index:e.index,cancelable:!0},n=JI(this,e);this.notifyPlugins("beforeDatasetDraw",s)!==!1&&(n&&am(r,n),e.controller.draw(),n&&im(r),s.cancelable=!1,this.notifyPlugins("afterDatasetDraw",s))}isPointInArea(e){return V0(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,r,s,n){const o=pE.modes[r];return typeof o=="function"?o(this,e,s,n):[]}getDatasetMeta(e){const r=this.data.datasets[e],s=this._metasets;let n=s.filter(o=>o&&o._dataset===r).pop();return n||(n={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:r&&r.order||0,index:e,_dataset:r,_parsed:[],_sorted:!1},s.push(n)),n}getContext(){return this.$context||(this.$context=ba(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const r=this.data.datasets[e];if(!r)return!1;const s=this.getDatasetMeta(e);return typeof s.hidden=="boolean"?!s.hidden:!r.hidden}setDatasetVisibility(e,r){const s=this.getDatasetMeta(e);s.hidden=!r}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,r,s){const n=s?"show":"hide",o=this.getDatasetMeta(e),i=o.controller._resolveAnimations(void 0,n);zc(r)?(o.data[r].hidden=!s,this.update()):(this.setDatasetVisibility(e,s),i.update(o,{visible:s}),this.update(l=>l.datasetIndex===e?n:void 0))}hide(e,r){this._updateVisibility(e,r,!1)}show(e,r){this._updateVisibility(e,r,!0)}_destroyDatasetMeta(e){const r=this._metasets[e];r&&r.controller&&r.controller._destroy(),delete this._metasets[e]}_stop(){let e,r;for(this.stop(),zs.remove(this),e=0,r=this.data.datasets.length;e<r;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:r}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),Mg(e,r),this.platform.releaseContext(r),this.canvas=null,this.ctx=null),delete cc[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,r=this.platform,s=(o,i)=>{r.addEventListener(this,o,i),e[o]=i},n=(o,i,l)=>{o.offsetX=i,o.offsetY=l,this._eventHandler(o)};Ze(this.options.events,o=>s(o,n))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,r=this.platform,s=(c,d)=>{r.addEventListener(this,c,d),e[c]=d},n=(c,d)=>{e[c]&&(r.removeEventListener(this,c,d),delete e[c])},o=(c,d)=>{this.canvas&&this.resize(c,d)};let i;const l=()=>{n("attach",l),this.attached=!0,this.resize(),s("resize",o),s("detach",i)};i=()=>{this.attached=!1,n("resize",o),this._stop(),this._resize(0,0),s("attach",l)},r.isAttached(this.canvas)?l():i()}unbindEvents(){Ze(this._listeners,(e,r)=>{this.platform.removeEventListener(this,r,e)}),this._listeners={},Ze(this._responsiveListeners,(e,r)=>{this.platform.removeEventListener(this,r,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,r,s){const n=s?"set":"remove";let o,i,l,c;for(r==="dataset"&&(o=this.getDatasetMeta(e[0].datasetIndex),o.controller["_"+n+"DatasetHoverStyle"]()),l=0,c=e.length;l<c;++l){i=e[l];const d=i&&this.getDatasetMeta(i.datasetIndex).controller;d&&d[n+"HoverStyle"](i.element,i.datasetIndex,i.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const r=this._active||[],s=e.map(({datasetIndex:o,index:i})=>{const l=this.getDatasetMeta(o);if(!l)throw new Error("No dataset found at index "+o);return{datasetIndex:o,element:l.data[i],index:i}});!Hc(s,r)&&(this._active=s,this._lastEvent=null,this._updateHoverStyles(s,r))}notifyPlugins(e,r,s){return this._plugins.notify(this,e,r,s)}isPluginEnabled(e){return this._plugins._cache.filter(r=>r.plugin.id===e).length===1}_updateHoverStyles(e,r,s){const n=this.options.hover,o=(c,d)=>c.filter(u=>!d.some(h=>u.datasetIndex===h.datasetIndex&&u.index===h.index)),i=o(r,e),l=s?e:o(e,r);i.length&&this.updateHoverStyle(i,n.mode,!1),l.length&&n.mode&&this.updateHoverStyle(l,n.mode,!0)}_eventHandler(e,r){const s={event:e,replay:r,cancelable:!0,inChartArea:this.isPointInArea(e)},n=i=>(i.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",s,n)===!1)return;const o=this._handleEvent(e,r,s.inChartArea);return s.cancelable=!1,this.notifyPlugins("afterEvent",s,n),(o||s.changed)&&this.render(),this}_handleEvent(e,r,s){const{_active:n=[],options:o}=this,i=r,l=this._getActiveElements(e,n,s,i),c=YN(e),d=y4(e,this._lastEvent,s,c);s&&(this._lastEvent=null,gt(o.onHover,[e,l,this],this),c&&gt(o.onClick,[e,l,this],this));const u=!Hc(l,n);return(u||r)&&(this._active=l,this._updateHoverStyles(l,n,r)),this._lastEvent=d,u}_getActiveElements(e,r,s,n){if(e.type==="mouseout")return[];if(!s)return r;const o=this.options.hover;return this.getElementsAtEventForMode(e,o.mode,o,n)}},W(ln,"defaults",$t),W(ln,"instances",cc),W(ln,"overrides",vo),W(ln,"registry",Os),W(ln,"version",m4),W(ln,"getChart",c_),ln);function d_(){return Ze(Cd.instances,t=>t._plugins.invalidate())}function v4(t,e,r){const{startAngle:s,x:n,y:o,outerRadius:i,innerRadius:l,options:c}=e,{borderWidth:d,borderJoinStyle:u}=c,h=Math.min(d/i,Ps(s-r));if(t.beginPath(),t.arc(n,o,i-d/2,s+h/2,r-h/2),l>0){const f=Math.min(d/l,Ps(s-r));t.arc(n,o,l+d/2,r-f/2,s+f/2,!0)}else{const f=Math.min(d/2,i*Ps(s-r));if(u==="round")t.arc(n,o,f,r-_t/2,s+_t/2,!0);else if(u==="bevel"){const p=2*f*f,g=-p*Math.cos(r+_t/2)+n,y=-p*Math.sin(r+_t/2)+o,x=p*Math.cos(s+_t/2)+n,m=p*Math.sin(s+_t/2)+o;t.lineTo(g,y),t.lineTo(x,m)}}t.closePath(),t.moveTo(0,0),t.rect(0,0,t.canvas.width,t.canvas.height),t.clip("evenodd")}function x4(t,e,r){const{startAngle:s,pixelMargin:n,x:o,y:i,outerRadius:l,innerRadius:c}=e;let d=n/l;t.beginPath(),t.arc(o,i,l,s-d,r+d),c>n?(d=n/c,t.arc(o,i,c,r+d,s-d,!0)):t.arc(o,i,n,r+rr,s-rr),t.closePath(),t.clip()}function b4(t){return lm(t,["outerStart","outerEnd","innerStart","innerEnd"])}function w4(t,e,r,s){const n=b4(t.options.borderRadius),o=(r-e)/2,i=Math.min(o,s*e/2),l=c=>{const d=(r-Math.min(o,c))*s/2;return hs(c,0,Math.min(o,d))};return{outerStart:l(n.outerStart),outerEnd:l(n.outerEnd),innerStart:hs(n.innerStart,0,i),innerEnd:hs(n.innerEnd,0,i)}}function Lo(t,e,r,s){return{x:r+t*Math.cos(e),y:s+t*Math.sin(e)}}function Yc(t,e,r,s,n,o){const{x:i,y:l,startAngle:c,pixelMargin:d,innerRadius:u}=e,h=Math.max(e.outerRadius+s+r-d,0),f=u>0?u+s+r+d:0;let p=0;const g=n-c;if(s){const R=u>0?u-s:0,O=h>0?h-s:0,z=(R+O)/2,D=z!==0?g*z/(z+s):g;p=(g-D)/2}const y=Math.max(.001,g*h-r/_t)/h,x=(g-y)/2,m=c+x+p,_=n-x-p,{outerStart:v,outerEnd:w,innerStart:S,innerEnd:E}=w4(e,f,h,_-m),C=h-v,k=h-w,N=m+v/C,I=_-w/k,L=f+S,T=f+E,j=m+S/L,M=_-E/T;if(t.beginPath(),o){const R=(N+I)/2;if(t.arc(i,l,h,N,R),t.arc(i,l,h,R,I),w>0){const P=Lo(k,I,i,l);t.arc(P.x,P.y,w,I,_+rr)}const O=Lo(T,_,i,l);if(t.lineTo(O.x,O.y),E>0){const P=Lo(T,M,i,l);t.arc(P.x,P.y,E,_+rr,M+Math.PI)}const z=(_-E/f+(m+S/f))/2;if(t.arc(i,l,f,_-E/f,z,!0),t.arc(i,l,f,z,m+S/f,!0),S>0){const P=Lo(L,j,i,l);t.arc(P.x,P.y,S,j+Math.PI,m-rr)}const D=Lo(C,m,i,l);if(t.lineTo(D.x,D.y),v>0){const P=Lo(C,N,i,l);t.arc(P.x,P.y,v,m-rr,N)}}else{t.moveTo(i,l);const R=Math.cos(N)*h+i,O=Math.sin(N)*h+l;t.lineTo(R,O);const z=Math.cos(I)*h+i,D=Math.sin(I)*h+l;t.lineTo(z,D)}t.closePath()}function S4(t,e,r,s,n){const{fullCircles:o,startAngle:i,circumference:l}=e;let c=e.endAngle;if(o){Yc(t,e,r,s,c,n);for(let d=0;d<o;++d)t.fill();isNaN(l)||(c=i+(l%qt||qt))}return Yc(t,e,r,s,c,n),t.fill(),c}function C4(t,e,r,s,n){const{fullCircles:o,startAngle:i,circumference:l,options:c}=e,{borderWidth:d,borderJoinStyle:u,borderDash:h,borderDashOffset:f,borderRadius:p}=c,g=c.borderAlign==="inner";if(!d)return;t.setLineDash(h||[]),t.lineDashOffset=f,g?(t.lineWidth=d*2,t.lineJoin=u||"round"):(t.lineWidth=d,t.lineJoin=u||"bevel");let y=e.endAngle;if(o){Yc(t,e,r,s,y,n);for(let x=0;x<o;++x)t.stroke();isNaN(l)||(y=i+(l%qt||qt))}g&&x4(t,e,y),c.selfJoin&&y-i>=_t&&p===0&&u!=="miter"&&v4(t,e,y),o||(Yc(t,e,r,s,y,n),t.stroke())}class Wa extends xo{constructor(r){super();W(this,"circumference");W(this,"endAngle");W(this,"fullCircles");W(this,"innerRadius");W(this,"outerRadius");W(this,"pixelMargin");W(this,"startAngle");this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,r&&Object.assign(this,r)}inRange(r,s,n){const o=this.getProps(["x","y"],n),{angle:i,distance:l}=R0(o,{x:r,y:s}),{startAngle:c,endAngle:d,innerRadius:u,outerRadius:h,circumference:f}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],n),p=(this.options.spacing+this.options.borderWidth)/2,g=Xe(f,d-c),y=qc(i,c,d)&&c!==d,x=g>=qt||y,m=Va(l,u+p,h+p);return x&&m}getCenterPoint(r){const{x:s,y:n,startAngle:o,endAngle:i,innerRadius:l,outerRadius:c}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],r),{offset:d,spacing:u}=this.options,h=(o+i)/2,f=(l+c+u+d)/2;return{x:s+Math.cos(h)*f,y:n+Math.sin(h)*f}}tooltipPosition(r){return this.getCenterPoint(r)}draw(r){const{options:s,circumference:n}=this,o=(s.offset||0)/4,i=(s.spacing||0)/2,l=s.circular;if(this.pixelMargin=s.borderAlign==="inner"?.33:0,this.fullCircles=n>qt?Math.floor(n/qt):0,n===0||this.innerRadius<0||this.outerRadius<0)return;r.save();const c=(this.startAngle+this.endAngle)/2;r.translate(Math.cos(c)*o,Math.sin(c)*o);const d=1-Math.sin(Math.min(_t,n||0)),u=o*d;r.fillStyle=s.backgroundColor,r.strokeStyle=s.borderColor,S4(r,this,u,i,l),C4(r,this,u,i,l),r.restore()}}W(Wa,"id","arc"),W(Wa,"defaults",{borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1}),W(Wa,"defaultRoutes",{backgroundColor:"backgroundColor"}),W(Wa,"descriptors",{_scriptable:!0,_indexable:r=>r!=="borderDash"});const u_=(t,e)=>{let{boxHeight:r=e,boxWidth:s=e}=t;return t.usePointStyle&&(r=Math.min(r,e),s=t.pointStyleWidth||Math.min(s,e)),{boxWidth:s,boxHeight:r,itemHeight:Math.max(e,r)}},j4=(t,e)=>t!==null&&e!==null&&t.datasetIndex===e.datasetIndex&&t.index===e.index;class h_ extends xo{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,r,s){this.maxWidth=e,this.maxHeight=r,this._margins=s,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let r=gt(e.generateLabels,[this.chart],this)||[];e.filter&&(r=r.filter(s=>e.filter(s,this.chart.data))),e.sort&&(r=r.sort((s,n)=>e.sort(s,n,this.chart.data))),this.options.reverse&&r.reverse(),this.legendItems=r}fit(){const{options:e,ctx:r}=this;if(!e.display){this.width=this.height=0;return}const s=e.labels,n=qr(s.font),o=n.size,i=this._computeTitleHeight(),{boxWidth:l,itemHeight:c}=u_(s,o);let d,u;r.font=n.string,this.isHorizontal()?(d=this.maxWidth,u=this._fitRows(i,o,l,c)+10):(u=this.maxHeight,d=this._fitCols(i,n,l,c)+10),this.width=Math.min(d,e.maxWidth||this.maxWidth),this.height=Math.min(u,e.maxHeight||this.maxHeight)}_fitRows(e,r,s,n){const{ctx:o,maxWidth:i,options:{labels:{padding:l}}}=this,c=this.legendHitBoxes=[],d=this.lineWidths=[0],u=n+l;let h=e;o.textAlign="left",o.textBaseline="middle";let f=-1,p=-u;return this.legendItems.forEach((g,y)=>{const x=s+r/2+o.measureText(g.text).width;(y===0||d[d.length-1]+x+2*l>i)&&(h+=u,d[d.length-(y>0?0:1)]=0,p+=u,f++),c[y]={left:0,top:p,row:f,width:x,height:n},d[d.length-1]+=x+l}),h}_fitCols(e,r,s,n){const{ctx:o,maxHeight:i,options:{labels:{padding:l}}}=this,c=this.legendHitBoxes=[],d=this.columnSizes=[],u=i-e;let h=l,f=0,p=0,g=0,y=0;return this.legendItems.forEach((x,m)=>{const{itemWidth:_,itemHeight:v}=k4(s,r,o,x,n);m>0&&p+v+2*l>u&&(h+=f+l,d.push({width:f,height:p}),g+=f+l,y++,f=p=0),c[m]={left:g,top:p,col:y,width:_,height:v},f=Math.max(f,_),p+=v+l}),h+=f,d.push({width:f,height:p}),h}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:r,options:{align:s,labels:{padding:n},rtl:o}}=this,i=ra(o,this.left,this.width);if(this.isHorizontal()){let l=0,c=Qr(s,this.left+n,this.right-this.lineWidths[l]);for(const d of r)l!==d.row&&(l=d.row,c=Qr(s,this.left+n,this.right-this.lineWidths[l])),d.top+=this.top+e+n,d.left=i.leftForLtr(i.x(c),d.width),c+=d.width+n}else{let l=0,c=Qr(s,this.top+e+n,this.bottom-this.columnSizes[l].height);for(const d of r)d.col!==l&&(l=d.col,c=Qr(s,this.top+e+n,this.bottom-this.columnSizes[l].height)),d.top=c,d.left+=this.left+n,d.left=i.leftForLtr(i.x(d.left),d.width),c+=d.height+n}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;am(e,this),this._draw(),im(e)}}_draw(){const{options:e,columnSizes:r,lineWidths:s,ctx:n}=this,{align:o,labels:i}=e,l=$t.color,c=ra(e.rtl,this.left,this.width),d=qr(i.font),{padding:u}=i,h=d.size,f=h/2;let p;this.drawTitle(),n.textAlign=c.textAlign("left"),n.textBaseline="middle",n.lineWidth=.5,n.font=d.string;const{boxWidth:g,boxHeight:y,itemHeight:x}=u_(i,h),m=function(E,C,k){if(isNaN(g)||g<=0||isNaN(y)||y<0)return;n.save();const N=Xe(k.lineWidth,1);if(n.fillStyle=Xe(k.fillStyle,l),n.lineCap=Xe(k.lineCap,"butt"),n.lineDashOffset=Xe(k.lineDashOffset,0),n.lineJoin=Xe(k.lineJoin,"miter"),n.lineWidth=N,n.strokeStyle=Xe(k.strokeStyle,l),n.setLineDash(Xe(k.lineDash,[])),i.usePointStyle){const I={radius:y*Math.SQRT2/2,pointStyle:k.pointStyle,rotation:k.rotation,borderWidth:N},L=c.xPlus(E,g/2),T=C+f;H0(n,I,L,T,i.pointStyleWidth&&g)}else{const I=C+Math.max((h-y)/2,0),L=c.leftForLtr(E,g),T=ci(k.borderRadius);n.beginPath(),Object.values(T).some(j=>j!==0)?zh(n,{x:L,y:I,w:g,h:y,radius:T}):n.rect(L,I,g,y),n.fill(),N!==0&&n.stroke()}n.restore()},_=function(E,C,k){Gc(n,k.text,E,C+x/2,d,{strikethrough:k.hidden,textAlign:c.textAlign(k.textAlign)})},v=this.isHorizontal(),w=this._computeTitleHeight();v?p={x:Qr(o,this.left+u,this.right-s[0]),y:this.top+u+w,line:0}:p={x:this.left+u,y:Qr(o,this.top+w+u,this.bottom-r[0].height),line:0},G0(this.ctx,e.textDirection);const S=x+u;this.legendItems.forEach((E,C)=>{n.strokeStyle=E.fontColor,n.fillStyle=E.fontColor;const k=n.measureText(E.text).width,N=c.textAlign(E.textAlign||(E.textAlign=i.textAlign)),I=g+f+k;let L=p.x,T=p.y;c.setWidth(this.width),v?C>0&&L+I+u>this.right&&(T=p.y+=S,p.line++,L=p.x=Qr(o,this.left+u,this.right-s[p.line])):C>0&&T+S>this.bottom&&(L=p.x=L+r[p.line].width+u,p.line++,T=p.y=Qr(o,this.top+w+u,this.bottom-r[p.line].height));const j=c.x(L);if(m(j,T,E),L=lI(N,L+g+f,v?L+I:this.right,e.rtl),_(c.x(L),T,E),v)p.x+=I+u;else if(typeof E.text!="string"){const M=d.lineHeight;p.y+=ax(E,M)+u}else p.y+=S}),J0(this.ctx,e.textDirection)}drawTitle(){const e=this.options,r=e.title,s=qr(r.font),n=Is(r.padding);if(!r.display)return;const o=ra(e.rtl,this.left,this.width),i=this.ctx,l=r.position,c=s.size/2,d=n.top+c;let u,h=this.left,f=this.width;if(this.isHorizontal())f=Math.max(...this.lineWidths),u=this.top+d,h=Qr(e.align,h,this.right-f);else{const g=this.columnSizes.reduce((y,x)=>Math.max(y,x.height),0);u=d+Qr(e.align,this.top,this.bottom-g-e.labels.padding-this._computeTitleHeight())}const p=Qr(l,h,h+f);i.textAlign=o.textAlign(F0(l)),i.textBaseline="middle",i.strokeStyle=r.color,i.fillStyle=r.color,i.font=s.string,Gc(i,r.text,p,u,s)}_computeTitleHeight(){const e=this.options.title,r=qr(e.font),s=Is(e.padding);return e.display?r.lineHeight+s.height:0}_getLegendItemAt(e,r){let s,n,o;if(Va(e,this.left,this.right)&&Va(r,this.top,this.bottom)){for(o=this.legendHitBoxes,s=0;s<o.length;++s)if(n=o[s],Va(e,n.left,n.left+n.width)&&Va(r,n.top,n.top+n.height))return this.legendItems[s]}return null}handleEvent(e){const r=this.options;if(!E4(e.type,r))return;const s=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const n=this._hoveredItem,o=j4(n,s);n&&!o&&gt(r.onLeave,[e,n,this],this),this._hoveredItem=s,s&&!o&&gt(r.onHover,[e,s,this],this)}else s&&gt(r.onClick,[e,s,this],this)}}function k4(t,e,r,s,n){const o=N4(s,t,e,r),i=I4(n,s,e.lineHeight);return{itemWidth:o,itemHeight:i}}function N4(t,e,r,s){let n=t.text;return n&&typeof n!="string"&&(n=n.reduce((o,i)=>o.length>i.length?o:i)),e+r.size/2+s.measureText(n).width}function I4(t,e,r){let s=t;return typeof e.text!="string"&&(s=ax(e,r)),s}function ax(t,e){const r=t.text?t.text.length:0;return e*r}function E4(t,e){return!!((t==="mousemove"||t==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(t==="click"||t==="mouseup"))}var T4={id:"legend",_element:h_,start(t,e,r){const s=t.legend=new h_({ctx:t.ctx,options:r,chart:t});bn.configure(t,s,r),bn.addBox(t,s)},stop(t){bn.removeBox(t,t.legend),delete t.legend},beforeUpdate(t,e,r){const s=t.legend;bn.configure(t,s,r),s.options=r},afterUpdate(t){const e=t.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(t,e){e.replay||t.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(t,e,r){const s=e.datasetIndex,n=r.chart;n.isDatasetVisible(s)?(n.hide(s),e.hidden=!0):(n.show(s),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:t=>t.chart.options.color,boxWidth:40,padding:10,generateLabels(t){const e=t.data.datasets,{labels:{usePointStyle:r,pointStyle:s,textAlign:n,color:o,useBorderRadius:i,borderRadius:l}}=t.legend.options;return t._getSortedDatasetMetas().map(c=>{const d=c.controller.getStyle(r?0:void 0),u=Is(d.borderWidth);return{text:e[c.index].label,fillStyle:d.backgroundColor,fontColor:o,hidden:!c.visible,lineCap:d.borderCapStyle,lineDash:d.borderDash,lineDashOffset:d.borderDashOffset,lineJoin:d.borderJoinStyle,lineWidth:(u.width+u.height)/4,strokeStyle:d.borderColor,pointStyle:s||d.pointStyle,rotation:d.rotation,textAlign:n||d.textAlign,borderRadius:i&&(l||d.borderRadius),datasetIndex:c.index}},this)}},title:{color:t=>t.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:t=>!t.startsWith("on"),labels:{_scriptable:t=>!["generateLabels","filter","sort"].includes(t)}}};const qa={average(t){if(!t.length)return!1;let e,r,s=new Set,n=0,o=0;for(e=0,r=t.length;e<r;++e){const l=t[e].element;if(l&&l.hasValue()){const c=l.tooltipPosition();s.add(c.x),n+=c.y,++o}}return o===0||s.size===0?!1:{x:[...s].reduce((l,c)=>l+c)/s.size,y:n/o}},nearest(t,e){if(!t.length)return!1;let r=e.x,s=e.y,n=Number.POSITIVE_INFINITY,o,i,l;for(o=0,i=t.length;o<i;++o){const c=t[o].element;if(c&&c.hasValue()){const d=c.getCenterPoint(),u=tI(e,d);u<n&&(n=u,l=c)}}if(l){const c=l.tooltipPosition();r=c.x,s=c.y}return{x:r,y:s}}};function Ms(t,e){return e&&(hr(e)?Array.prototype.push.apply(t,e):t.push(e)),t}function Us(t){return(typeof t=="string"||t instanceof String)&&t.indexOf(`
`)>-1?t.split(`
`):t}function A4(t,e){const{element:r,datasetIndex:s,index:n}=e,o=t.getDatasetMeta(s).controller,{label:i,value:l}=o.getLabelAndValue(n);return{chart:t,label:i,parsed:o.getParsed(n),raw:t.data.datasets[s].data[n],formattedValue:l,dataset:o.getDataset(),dataIndex:n,datasetIndex:s,element:r}}function f_(t,e){const r=t.chart.ctx,{body:s,footer:n,title:o}=t,{boxWidth:i,boxHeight:l}=e,c=qr(e.bodyFont),d=qr(e.titleFont),u=qr(e.footerFont),h=o.length,f=n.length,p=s.length,g=Is(e.padding);let y=g.height,x=0,m=s.reduce((w,S)=>w+S.before.length+S.lines.length+S.after.length,0);if(m+=t.beforeBody.length+t.afterBody.length,h&&(y+=h*d.lineHeight+(h-1)*e.titleSpacing+e.titleMarginBottom),m){const w=e.displayColors?Math.max(l,c.lineHeight):c.lineHeight;y+=p*w+(m-p)*c.lineHeight+(m-1)*e.bodySpacing}f&&(y+=e.footerMarginTop+f*u.lineHeight+(f-1)*e.footerSpacing);let _=0;const v=function(w){x=Math.max(x,r.measureText(w).width+_)};return r.save(),r.font=d.string,Ze(t.title,v),r.font=c.string,Ze(t.beforeBody.concat(t.afterBody),v),_=e.displayColors?i+2+e.boxPadding:0,Ze(s,w=>{Ze(w.before,v),Ze(w.lines,v),Ze(w.after,v)}),_=0,r.font=u.string,Ze(t.footer,v),r.restore(),x+=g.width,{width:x,height:y}}function L4(t,e){const{y:r,height:s}=e;return r<s/2?"top":r>t.height-s/2?"bottom":"center"}function D4(t,e,r,s){const{x:n,width:o}=s,i=r.caretSize+r.caretPadding;if(t==="left"&&n+o+i>e.width||t==="right"&&n-o-i<0)return!0}function M4(t,e,r,s){const{x:n,width:o}=r,{width:i,chartArea:{left:l,right:c}}=t;let d="center";return s==="center"?d=n<=(l+c)/2?"left":"right":n<=o/2?d="left":n>=i-o/2&&(d="right"),D4(d,t,e,r)&&(d="center"),d}function m_(t,e,r){const s=r.yAlign||e.yAlign||L4(t,r);return{xAlign:r.xAlign||e.xAlign||M4(t,e,r,s),yAlign:s}}function R4(t,e){let{x:r,width:s}=t;return e==="right"?r-=s:e==="center"&&(r-=s/2),r}function O4(t,e,r){let{y:s,height:n}=t;return e==="top"?s+=r:e==="bottom"?s-=n+r:s-=n/2,s}function p_(t,e,r,s){const{caretSize:n,caretPadding:o,cornerRadius:i}=t,{xAlign:l,yAlign:c}=r,d=n+o,{topLeft:u,topRight:h,bottomLeft:f,bottomRight:p}=ci(i);let g=R4(e,l);const y=O4(e,c,d);return c==="center"?l==="left"?g+=d:l==="right"&&(g-=d):l==="left"?g-=Math.max(u,f)+n:l==="right"&&(g+=Math.max(h,p)+n),{x:hs(g,0,s.width-e.width),y:hs(y,0,s.height-e.height)}}function Vl(t,e,r){const s=Is(r.padding);return e==="center"?t.x+t.width/2:e==="right"?t.x+t.width-s.right:t.x+s.left}function g_(t){return Ms([],Us(t))}function P4(t,e,r){return ba(t,{tooltip:e,tooltipItems:r,type:"tooltip"})}function __(t,e){const r=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return r?t.override(r):t}const ix={beforeTitle:Vs,title(t){if(t.length>0){const e=t[0],r=e.chart.data.labels,s=r?r.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(s>0&&e.dataIndex<s)return r[e.dataIndex]}return""},afterTitle:Vs,beforeBody:Vs,beforeLabel:Vs,label(t){if(this&&this.options&&this.options.mode==="dataset")return t.label+": "+t.formattedValue||t.formattedValue;let e=t.dataset.label||"";e&&(e+=": ");const r=t.formattedValue;return wr(r)||(e+=r),e},labelColor(t){const r=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{borderColor:r.borderColor,backgroundColor:r.backgroundColor,borderWidth:r.borderWidth,borderDash:r.borderDash,borderDashOffset:r.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(t){const r=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{pointStyle:r.pointStyle,rotation:r.rotation}},afterLabel:Vs,afterBody:Vs,beforeFooter:Vs,footer:Vs,afterFooter:Vs};function $r(t,e,r,s){const n=t[e].call(r,s);return typeof n>"u"?ix[e].call(r,s):n}class qh extends xo{constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const r=this.chart,s=this.options.setContext(this.getContext()),n=s.enabled&&r.options.animation&&s.animations,o=new K0(this.chart,n);return n._cacheable&&(this._cachedAnimations=Object.freeze(o)),o}getContext(){return this.$context||(this.$context=P4(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,r){const{callbacks:s}=r,n=$r(s,"beforeTitle",this,e),o=$r(s,"title",this,e),i=$r(s,"afterTitle",this,e);let l=[];return l=Ms(l,Us(n)),l=Ms(l,Us(o)),l=Ms(l,Us(i)),l}getBeforeBody(e,r){return g_($r(r.callbacks,"beforeBody",this,e))}getBody(e,r){const{callbacks:s}=r,n=[];return Ze(e,o=>{const i={before:[],lines:[],after:[]},l=__(s,o);Ms(i.before,Us($r(l,"beforeLabel",this,o))),Ms(i.lines,$r(l,"label",this,o)),Ms(i.after,Us($r(l,"afterLabel",this,o))),n.push(i)}),n}getAfterBody(e,r){return g_($r(r.callbacks,"afterBody",this,e))}getFooter(e,r){const{callbacks:s}=r,n=$r(s,"beforeFooter",this,e),o=$r(s,"footer",this,e),i=$r(s,"afterFooter",this,e);let l=[];return l=Ms(l,Us(n)),l=Ms(l,Us(o)),l=Ms(l,Us(i)),l}_createItems(e){const r=this._active,s=this.chart.data,n=[],o=[],i=[];let l=[],c,d;for(c=0,d=r.length;c<d;++c)l.push(A4(this.chart,r[c]));return e.filter&&(l=l.filter((u,h,f)=>e.filter(u,h,f,s))),e.itemSort&&(l=l.sort((u,h)=>e.itemSort(u,h,s))),Ze(l,u=>{const h=__(e.callbacks,u);n.push($r(h,"labelColor",this,u)),o.push($r(h,"labelPointStyle",this,u)),i.push($r(h,"labelTextColor",this,u))}),this.labelColors=n,this.labelPointStyles=o,this.labelTextColors=i,this.dataPoints=l,l}update(e,r){const s=this.options.setContext(this.getContext()),n=this._active;let o,i=[];if(!n.length)this.opacity!==0&&(o={opacity:0});else{const l=qa[s.position].call(this,n,this._eventPosition);i=this._createItems(s),this.title=this.getTitle(i,s),this.beforeBody=this.getBeforeBody(i,s),this.body=this.getBody(i,s),this.afterBody=this.getAfterBody(i,s),this.footer=this.getFooter(i,s);const c=this._size=f_(this,s),d=Object.assign({},l,c),u=m_(this.chart,s,d),h=p_(s,d,u,this.chart);this.xAlign=u.xAlign,this.yAlign=u.yAlign,o={opacity:1,x:h.x,y:h.y,width:c.width,height:c.height,caretX:l.x,caretY:l.y}}this._tooltipItems=i,this.$context=void 0,o&&this._resolveAnimations().update(this,o),e&&s.external&&s.external.call(this,{chart:this.chart,tooltip:this,replay:r})}drawCaret(e,r,s,n){const o=this.getCaretPosition(e,s,n);r.lineTo(o.x1,o.y1),r.lineTo(o.x2,o.y2),r.lineTo(o.x3,o.y3)}getCaretPosition(e,r,s){const{xAlign:n,yAlign:o}=this,{caretSize:i,cornerRadius:l}=s,{topLeft:c,topRight:d,bottomLeft:u,bottomRight:h}=ci(l),{x:f,y:p}=e,{width:g,height:y}=r;let x,m,_,v,w,S;return o==="center"?(w=p+y/2,n==="left"?(x=f,m=x-i,v=w+i,S=w-i):(x=f+g,m=x+i,v=w-i,S=w+i),_=x):(n==="left"?m=f+Math.max(c,u)+i:n==="right"?m=f+g-Math.max(d,h)-i:m=this.caretX,o==="top"?(v=p,w=v-i,x=m-i,_=m+i):(v=p+y,w=v+i,x=m+i,_=m-i),S=v),{x1:x,x2:m,x3:_,y1:v,y2:w,y3:S}}drawTitle(e,r,s){const n=this.title,o=n.length;let i,l,c;if(o){const d=ra(s.rtl,this.x,this.width);for(e.x=Vl(this,s.titleAlign,s),r.textAlign=d.textAlign(s.titleAlign),r.textBaseline="middle",i=qr(s.titleFont),l=s.titleSpacing,r.fillStyle=s.titleColor,r.font=i.string,c=0;c<o;++c)r.fillText(n[c],d.x(e.x),e.y+i.lineHeight/2),e.y+=i.lineHeight+l,c+1===o&&(e.y+=s.titleMarginBottom-l)}}_drawColorBox(e,r,s,n,o){const i=this.labelColors[s],l=this.labelPointStyles[s],{boxHeight:c,boxWidth:d}=o,u=qr(o.bodyFont),h=Vl(this,"left",o),f=n.x(h),p=c<u.lineHeight?(u.lineHeight-c)/2:0,g=r.y+p;if(o.usePointStyle){const y={radius:Math.min(d,c)/2,pointStyle:l.pointStyle,rotation:l.rotation,borderWidth:1},x=n.leftForLtr(f,d)+d/2,m=g+c/2;e.strokeStyle=o.multiKeyBackground,e.fillStyle=o.multiKeyBackground,Rg(e,y,x,m),e.strokeStyle=i.borderColor,e.fillStyle=i.backgroundColor,Rg(e,y,x,m)}else{e.lineWidth=Ge(i.borderWidth)?Math.max(...Object.values(i.borderWidth)):i.borderWidth||1,e.strokeStyle=i.borderColor,e.setLineDash(i.borderDash||[]),e.lineDashOffset=i.borderDashOffset||0;const y=n.leftForLtr(f,d),x=n.leftForLtr(n.xPlus(f,1),d-2),m=ci(i.borderRadius);Object.values(m).some(_=>_!==0)?(e.beginPath(),e.fillStyle=o.multiKeyBackground,zh(e,{x:y,y:g,w:d,h:c,radius:m}),e.fill(),e.stroke(),e.fillStyle=i.backgroundColor,e.beginPath(),zh(e,{x,y:g+1,w:d-2,h:c-2,radius:m}),e.fill()):(e.fillStyle=o.multiKeyBackground,e.fillRect(y,g,d,c),e.strokeRect(y,g,d,c),e.fillStyle=i.backgroundColor,e.fillRect(x,g+1,d-2,c-2))}e.fillStyle=this.labelTextColors[s]}drawBody(e,r,s){const{body:n}=this,{bodySpacing:o,bodyAlign:i,displayColors:l,boxHeight:c,boxWidth:d,boxPadding:u}=s,h=qr(s.bodyFont);let f=h.lineHeight,p=0;const g=ra(s.rtl,this.x,this.width),y=function(k){r.fillText(k,g.x(e.x+p),e.y+f/2),e.y+=f+o},x=g.textAlign(i);let m,_,v,w,S,E,C;for(r.textAlign=i,r.textBaseline="middle",r.font=h.string,e.x=Vl(this,x,s),r.fillStyle=s.bodyColor,Ze(this.beforeBody,y),p=l&&x!=="right"?i==="center"?d/2+u:d+2+u:0,w=0,E=n.length;w<E;++w){for(m=n[w],_=this.labelTextColors[w],r.fillStyle=_,Ze(m.before,y),v=m.lines,l&&v.length&&(this._drawColorBox(r,e,w,g,s),f=Math.max(h.lineHeight,c)),S=0,C=v.length;S<C;++S)y(v[S]),f=h.lineHeight;Ze(m.after,y)}p=0,f=h.lineHeight,Ze(this.afterBody,y),e.y-=o}drawFooter(e,r,s){const n=this.footer,o=n.length;let i,l;if(o){const c=ra(s.rtl,this.x,this.width);for(e.x=Vl(this,s.footerAlign,s),e.y+=s.footerMarginTop,r.textAlign=c.textAlign(s.footerAlign),r.textBaseline="middle",i=qr(s.footerFont),r.fillStyle=s.footerColor,r.font=i.string,l=0;l<o;++l)r.fillText(n[l],c.x(e.x),e.y+i.lineHeight/2),e.y+=i.lineHeight+s.footerSpacing}}drawBackground(e,r,s,n){const{xAlign:o,yAlign:i}=this,{x:l,y:c}=e,{width:d,height:u}=s,{topLeft:h,topRight:f,bottomLeft:p,bottomRight:g}=ci(n.cornerRadius);r.fillStyle=n.backgroundColor,r.strokeStyle=n.borderColor,r.lineWidth=n.borderWidth,r.beginPath(),r.moveTo(l+h,c),i==="top"&&this.drawCaret(e,r,s,n),r.lineTo(l+d-f,c),r.quadraticCurveTo(l+d,c,l+d,c+f),i==="center"&&o==="right"&&this.drawCaret(e,r,s,n),r.lineTo(l+d,c+u-g),r.quadraticCurveTo(l+d,c+u,l+d-g,c+u),i==="bottom"&&this.drawCaret(e,r,s,n),r.lineTo(l+p,c+u),r.quadraticCurveTo(l,c+u,l,c+u-p),i==="center"&&o==="left"&&this.drawCaret(e,r,s,n),r.lineTo(l,c+h),r.quadraticCurveTo(l,c,l+h,c),r.closePath(),r.fill(),n.borderWidth>0&&r.stroke()}_updateAnimationTarget(e){const r=this.chart,s=this.$animations,n=s&&s.x,o=s&&s.y;if(n||o){const i=qa[e.position].call(this,this._active,this._eventPosition);if(!i)return;const l=this._size=f_(this,e),c=Object.assign({},i,this._size),d=m_(r,e,c),u=p_(e,c,d,r);(n._to!==u.x||o._to!==u.y)&&(this.xAlign=d.xAlign,this.yAlign=d.yAlign,this.width=l.width,this.height=l.height,this.caretX=i.x,this.caretY=i.y,this._resolveAnimations().update(this,u))}}_willRender(){return!!this.opacity}draw(e){const r=this.options.setContext(this.getContext());let s=this.opacity;if(!s)return;this._updateAnimationTarget(r);const n={width:this.width,height:this.height},o={x:this.x,y:this.y};s=Math.abs(s)<.001?0:s;const i=Is(r.padding),l=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;r.enabled&&l&&(e.save(),e.globalAlpha=s,this.drawBackground(o,e,n,r),G0(e,r.textDirection),o.y+=i.top,this.drawTitle(o,e,r),this.drawBody(o,e,r),this.drawFooter(o,e,r),J0(e,r.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,r){const s=this._active,n=e.map(({datasetIndex:l,index:c})=>{const d=this.chart.getDatasetMeta(l);if(!d)throw new Error("Cannot find a dataset at index "+l);return{datasetIndex:l,element:d.data[c],index:c}}),o=!Hc(s,n),i=this._positionChanged(n,r);(o||i)&&(this._active=n,this._eventPosition=r,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,r,s=!0){if(r&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const n=this.options,o=this._active||[],i=this._getActiveElements(e,o,r,s),l=this._positionChanged(i,e),c=r||!Hc(i,o)||l;return c&&(this._active=i,(n.enabled||n.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,r))),c}_getActiveElements(e,r,s,n){const o=this.options;if(e.type==="mouseout")return[];if(!n)return r.filter(l=>this.chart.data.datasets[l.datasetIndex]&&this.chart.getDatasetMeta(l.datasetIndex).controller.getParsed(l.index)!==void 0);const i=this.chart.getElementsAtEventForMode(e,o.mode,o,s);return o.reverse&&i.reverse(),i}_positionChanged(e,r){const{caretX:s,caretY:n,options:o}=this,i=qa[o.position].call(this,e,r);return i!==!1&&(s!==i.x||n!==i.y)}}W(qh,"positioners",qa);var $4={id:"tooltip",_element:qh,positioners:qa,afterInit(t,e,r){r&&(t.tooltip=new qh({chart:t,options:r}))},beforeUpdate(t,e,r){t.tooltip&&t.tooltip.initialize(r)},reset(t,e,r){t.tooltip&&t.tooltip.initialize(r)},afterDraw(t){const e=t.tooltip;if(e&&e._willRender()){const r={tooltip:e};if(t.notifyPlugins("beforeTooltipDraw",{...r,cancelable:!0})===!1)return;e.draw(t.ctx),t.notifyPlugins("afterTooltipDraw",r)}},afterEvent(t,e){if(t.tooltip){const r=e.replay;t.tooltip.handleEvent(e.event,r,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(t,e)=>e.bodyFont.size,boxWidth:(t,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:ix},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:t=>t!=="filter"&&t!=="itemSort"&&t!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const jd={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Ur=Object.keys(jd);function y_(t,e){return t-e}function v_(t,e){if(wr(e))return null;const r=t._adapter,{parser:s,round:n,isoWeekday:o}=t._parseOpts;let i=e;return typeof s=="function"&&(i=s(i)),rn(i)||(i=typeof s=="string"?r.parse(i,s):r.parse(i)),i===null?null:(n&&(i=n==="week"&&(Wc(o)||o===!0)?r.startOf(i,"isoWeek",o):r.startOf(i,n)),+i)}function x_(t,e,r,s){const n=Ur.length;for(let o=Ur.indexOf(t);o<n-1;++o){const i=jd[Ur[o]],l=i.steps?i.steps:Number.MAX_SAFE_INTEGER;if(i.common&&Math.ceil((r-e)/(l*i.size))<=s)return Ur[o]}return Ur[n-1]}function F4(t,e,r,s,n){for(let o=Ur.length-1;o>=Ur.indexOf(r);o--){const i=Ur[o];if(jd[i].common&&t._adapter.diff(n,s,i)>=e-1)return i}return Ur[r?Ur.indexOf(r):0]}function B4(t){for(let e=Ur.indexOf(t)+1,r=Ur.length;e<r;++e)if(jd[Ur[e]].common)return Ur[e]}function b_(t,e,r){if(!r)t[e]=!0;else if(r.length){const{lo:s,hi:n}=om(r,e),o=r[s]>=e?r[s]:r[n];t[o]=!0}}function H4(t,e,r,s){const n=t._adapter,o=+n.startOf(e[0].value,s),i=e[e.length-1].value;let l,c;for(l=o;l<=i;l=+n.add(l,1,s))c=r[l],c>=0&&(e[c].major=!0);return e}function w_(t,e,r){const s=[],n={},o=e.length;let i,l;for(i=0;i<o;++i)l=e[i],n[l]=i,s.push({value:l,major:!1});return o===0||!r?s:H4(t,s,n,r)}class Qc extends Sd{constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,r={}){const s=e.time||(e.time={}),n=this._adapter=new dE._date(e.adapters.date);n.init(r),ai(s.displayFormats,n.formats()),this._parseOpts={parser:s.parser,round:s.round,isoWeekday:s.isoWeekday},super.init(e),this._normalized=r.normalized}parse(e,r){return e===void 0?null:v_(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,r=this._adapter,s=e.time.unit||"day";let{min:n,max:o,minDefined:i,maxDefined:l}=this.getUserBounds();function c(d){!i&&!isNaN(d.min)&&(n=Math.min(n,d.min)),!l&&!isNaN(d.max)&&(o=Math.max(o,d.max))}(!i||!l)&&(c(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&c(this.getMinMax(!1))),n=rn(n)&&!isNaN(n)?n:+r.startOf(Date.now(),s),o=rn(o)&&!isNaN(o)?o:+r.endOf(Date.now(),s)+1,this.min=Math.min(n,o-1),this.max=Math.max(n+1,o)}_getLabelBounds(){const e=this.getLabelTimestamps();let r=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;return e.length&&(r=e[0],s=e[e.length-1]),{min:r,max:s}}buildTicks(){const e=this.options,r=e.time,s=e.ticks,n=s.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&n.length&&(this.min=this._userMin||n[0],this.max=this._userMax||n[n.length-1]);const o=this.min,i=this.max,l=nI(n,o,i);return this._unit=r.unit||(s.autoSkip?x_(r.minUnit,this.min,this.max,this._getLabelCapacity(o)):F4(this,l.length,r.minUnit,this.min,this.max)),this._majorUnit=!s.major.enabled||this._unit==="year"?void 0:B4(this._unit),this.initOffsets(n),e.reverse&&l.reverse(),w_(this,l,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let r=0,s=0,n,o;this.options.offset&&e.length&&(n=this.getDecimalForValue(e[0]),e.length===1?r=1-n:r=(this.getDecimalForValue(e[1])-n)/2,o=this.getDecimalForValue(e[e.length-1]),e.length===1?s=o:s=(o-this.getDecimalForValue(e[e.length-2]))/2);const i=e.length<3?.5:.25;r=hs(r,0,i),s=hs(s,0,i),this._offsets={start:r,end:s,factor:1/(r+1+s)}}_generate(){const e=this._adapter,r=this.min,s=this.max,n=this.options,o=n.time,i=o.unit||x_(o.minUnit,r,s,this._getLabelCapacity(r)),l=Xe(n.ticks.stepSize,1),c=i==="week"?o.isoWeekday:!1,d=Wc(c)||c===!0,u={};let h=r,f,p;if(d&&(h=+e.startOf(h,"isoWeek",c)),h=+e.startOf(h,d?"day":i),e.diff(s,r,i)>1e5*l)throw new Error(r+" and "+s+" are too far apart with stepSize of "+l+" "+i);const g=n.ticks.source==="data"&&this.getDataTimestamps();for(f=h,p=0;f<s;f=+e.add(f,l,i),p++)b_(u,f,g);return(f===s||n.bounds==="ticks"||p===1)&&b_(u,f,g),Object.keys(u).sort(y_).map(y=>+y)}getLabelForValue(e){const r=this._adapter,s=this.options.time;return s.tooltipFormat?r.format(e,s.tooltipFormat):r.format(e,s.displayFormats.datetime)}format(e,r){const n=this.options.time.displayFormats,o=this._unit,i=r||n[o];return this._adapter.format(e,i)}_tickFormatFunction(e,r,s,n){const o=this.options,i=o.ticks.callback;if(i)return gt(i,[e,r,s],this);const l=o.time.displayFormats,c=this._unit,d=this._majorUnit,u=c&&l[c],h=d&&l[d],f=s[r],p=d&&h&&f&&f.major;return this._adapter.format(e,n||(p?h:u))}generateTickLabels(e){let r,s,n;for(r=0,s=e.length;r<s;++r)n=e[r],n.label=this._tickFormatFunction(n.value,r,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const r=this._offsets,s=this.getDecimalForValue(e);return this.getPixelForDecimal((r.start+s)*r.factor)}getValueForPixel(e){const r=this._offsets,s=this.getDecimalForPixel(e)/r.factor-r.end;return this.min+s*(this.max-this.min)}_getLabelSize(e){const r=this.options.ticks,s=this.ctx.measureText(e).width,n=lo(this.isHorizontal()?r.maxRotation:r.minRotation),o=Math.cos(n),i=Math.sin(n),l=this._resolveTickFontOptions(0).size;return{w:s*o+l*i,h:s*i+l*o}}_getLabelCapacity(e){const r=this.options.time,s=r.displayFormats,n=s[r.unit]||s.millisecond,o=this._tickFormatFunction(e,0,w_(this,[e],this._majorUnit),n),i=this._getLabelSize(o),l=Math.floor(this.isHorizontal()?this.width/i.w:this.height/i.h)-1;return l>0?l:1}getDataTimestamps(){let e=this._cache.data||[],r,s;if(e.length)return e;const n=this.getMatchingVisibleMetas();if(this._normalized&&n.length)return this._cache.data=n[0].controller.getAllParsedValues(this);for(r=0,s=n.length;r<s;++r)e=e.concat(n[r].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let r,s;if(e.length)return e;const n=this.getLabels();for(r=0,s=n.length;r<s;++r)e.push(v_(this,n[r]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return aI(e.sort(y_))}}W(Qc,"id","time"),W(Qc,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function zl(t,e,r){let s=0,n=t.length-1,o,i,l,c;r?(e>=t[s].pos&&e<=t[n].pos&&({lo:s,hi:n}=Hh(t,"pos",e)),{pos:o,time:l}=t[s],{pos:i,time:c}=t[n]):(e>=t[s].time&&e<=t[n].time&&({lo:s,hi:n}=Hh(t,"time",e)),{time:o,pos:l}=t[s],{time:i,pos:c}=t[n]);const d=i-o;return d?l+(c-l)*(e-o)/d:l}class S_ extends Qc{constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),r=this._table=this.buildLookupTable(e);this._minPos=zl(r,this.min),this._tableRange=zl(r,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:r,max:s}=this,n=[],o=[];let i,l,c,d,u;for(i=0,l=e.length;i<l;++i)d=e[i],d>=r&&d<=s&&n.push(d);if(n.length<2)return[{time:r,pos:0},{time:s,pos:1}];for(i=0,l=n.length;i<l;++i)u=n[i+1],c=n[i-1],d=n[i],Math.round((u+c)/2)!==d&&o.push({time:d,pos:i/(l-1)});return o}_generate(){const e=this.min,r=this.max;let s=super.getDataTimestamps();return(!s.includes(e)||!s.length)&&s.splice(0,0,e),(!s.includes(r)||s.length===1)&&s.push(r),s.sort((n,o)=>n-o)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const r=this.getDataTimestamps(),s=this.getLabelTimestamps();return r.length&&s.length?e=this.normalize(r.concat(s)):e=r.length?r:s,e=this._cache.all=e,e}getDecimalForValue(e){return(zl(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const r=this._offsets,s=this.getDecimalForPixel(e)/r.factor-r.end;return zl(this._table,s*this._tableRange+this._minPos,!0)}}W(S_,"id","timeseries"),W(S_,"defaults",Qc.defaults);const lx="label";function C_(t,e){typeof t=="function"?t(e):t&&(t.current=e)}function V4(t,e){const r=t.options;r&&e&&Object.assign(r,e)}function cx(t,e){t.labels=e}function dx(t,e,r=lx){const s=[];t.datasets=e.map(n=>{const o=t.datasets.find(i=>i[r]===n[r]);return!o||!n.data||s.includes(o)?{...n}:(s.push(o),Object.assign(o,n),o)})}function z4(t,e=lx){const r={labels:[],datasets:[]};return cx(r,t.labels),dx(r,t.datasets,e),r}function U4(t,e){const{height:r=150,width:s=300,redraw:n=!1,datasetIdKey:o,type:i,data:l,options:c,plugins:d=[],fallbackContent:u,updateMode:h,...f}=t,p=b.useRef(null),g=b.useRef(null),y=()=>{p.current&&(g.current=new Cd(p.current,{type:i,data:z4(l,o),options:c&&{...c},plugins:d}),C_(e,g.current))},x=()=>{C_(e,null),g.current&&(g.current.destroy(),g.current=null)};return b.useEffect(()=>{!n&&g.current&&c&&V4(g.current,c)},[n,c]),b.useEffect(()=>{!n&&g.current&&cx(g.current.config.data,l.labels)},[n,l.labels]),b.useEffect(()=>{!n&&g.current&&l.datasets&&dx(g.current.config.data,l.datasets,o)},[n,l.datasets]),b.useEffect(()=>{g.current&&(n?(x(),setTimeout(y)):g.current.update(h))},[n,c,l.labels,l.datasets,h]),b.useEffect(()=>{g.current&&(x(),setTimeout(y))},[i]),b.useEffect(()=>(y(),()=>x()),[]),a.jsx("canvas",{ref:p,role:"img",height:r,width:s,...f,children:u})}const W4=b.forwardRef(U4);function q4(t,e){return Cd.register(e),b.forwardRef((r,s)=>a.jsx(W4,{...r,ref:s,type:t}))}const G4=q4("doughnut",za),J4="_chartContainer_1q10w_5",K4="_emptyChart_1q10w_11",j_={chartContainer:J4,emptyChart:K4};Cd.register(Wa,$4,T4);const Y4=({data:t,formatCurrency:e})=>{if(!t||t.length===0)return a.jsx("div",{className:j_.emptyChart,children:a.jsx("p",{children:"No expense data available for this month"})});const r=o=>{const i=["#0064FF","#00C896","#FF9500","#FF5847","#6C757D","#8B4FC3","#00D2FF","#FFD700","#FF69B4","#32CD32"],l=[];for(let c=0;c<o;c++)l.push(i[c%i.length]);return l},s={labels:t.map(o=>o.category),datasets:[{data:t.map(o=>o.amount),backgroundColor:r(t.length),borderWidth:0,hoverOffset:4}]},n={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"right",labels:{usePointStyle:!0,font:{family:'Inter, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',size:14},color:"#495057",padding:12,generateLabels:o=>{const i=o.data.datasets;return o.data.labels.map((l,c)=>{var u;const d=((u=t[c])==null?void 0:u.percentage)||0;return{text:`${l} (${d.toFixed(1)}%)`,fillStyle:i[0].backgroundColor[c],strokeStyle:i[0].backgroundColor[c],lineWidth:0,hidden:!1,index:c}})}}},tooltip:{callbacks:{label:function(o){var d;const i=o.label||"",l=o.parsed||0,c=((d=t[o.dataIndex])==null?void 0:d.percentage)||0;return`${i}: ${e(l)} (${c.toFixed(1)}%)`}}}},cutout:"65%",animation:{animateRotate:!0,duration:1e3}};return a.jsx("div",{className:j_.chartContainer,children:a.jsx(G4,{data:s,options:n})})},Q4="_container_zmpws_6",Z4="_selectButton_zmpws_15",X4="_active_zmpws_40",e5="_selectValue_zmpws_47",t5="_arrow_zmpws_55",r5="_menu_zmpws_69",s5="_show_zmpws_89",n5="_searchWrapper_zmpws_96",o5="_searchInput_zmpws_102",a5="_optionsList_zmpws_125",i5="_option_zmpws_125",l5="_selected_zmpws_150",c5="_optionLabel_zmpws_159",d5="_optionDescription_zmpws_165",u5="_emptyState_zmpws_171",kr={container:Q4,selectButton:Z4,active:X4,selectValue:e5,arrow:t5,menu:r5,show:s5,searchWrapper:n5,searchInput:o5,optionsList:a5,option:i5,selected:l5,optionLabel:c5,optionDescription:d5,emptyState:u5},h5=({companies:t,selectedCompanyId:e,onChange:r,className:s=""})=>{const[n,o]=b.useState(!1),[i,l]=b.useState(""),c=b.useRef(null),d=b.useRef(null),u=t.find(x=>x.company_id===e),h=t.filter(x=>x.company_name.toLowerCase().includes(i.toLowerCase()));b.useEffect(()=>{const x=m=>{c.current&&!c.current.contains(m.target)&&o(!1)};return n&&document.addEventListener("mousedown",x),()=>{document.removeEventListener("mousedown",x)}},[n]),b.useEffect(()=>{n&&d.current&&d.current.focus()},[n]);const f=()=>{o(!n),l("")},p=x=>{r(x.company_id,x),o(!1),l("")},g=x=>{l(x.target.value)},y=u?u.company_name:"Select Company";return a.jsxs("div",{ref:c,className:`${kr.container} ${s}`,children:[a.jsxs("button",{type:"button",className:`${kr.selectButton} ${n?kr.active:""}`,onClick:f,"aria-haspopup":"listbox","aria-expanded":n,children:[a.jsx("span",{className:kr.selectValue,children:y}),a.jsx("svg",{className:kr.arrow,viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M7 10l5 5 5-5z"})})]}),a.jsxs("div",{className:`${kr.menu} ${n?kr.show:""}`,children:[t.length>5&&a.jsx("div",{className:kr.searchWrapper,children:a.jsx("input",{ref:d,type:"text",className:kr.searchInput,placeholder:"Search companies...",value:i,onChange:g})}),a.jsx("div",{className:kr.optionsList,children:h.length>0?h.map(x=>{var m,_;return a.jsxs("div",{className:`${kr.option} ${x.company_id===e?kr.selected:""}`,onClick:()=>p(x),role:"option","aria-selected":x.company_id===e,children:[a.jsx("div",{className:kr.optionLabel,children:x.company_name}),a.jsxs("div",{className:kr.optionDescription,children:[((m=x.stores)==null?void 0:m.length)||0," store",((_=x.stores)==null?void 0:_.length)!==1?"s":""]})]},x.company_id)}):a.jsx("div",{className:kr.emptyState,children:"No companies found"})})]})]})},f5="_navbarComponent_rbxsw_7",m5="_navbarInner_rbxsw_16",p5="_navbarBrand_rbxsw_27",g5="_navbarLogo_rbxsw_35",_5="_navbarTitle_rbxsw_43",y5="_navbarMenu_rbxsw_51",v5="_navbarNavItem_rbxsw_59",x5="_navbarNavLink_rbxsw_64",b5="_active_rbxsw_82",w5="_navbarDropdownMenu_rbxsw_88",S5="_show_rbxsw_106",C5="_navbarDropdownSection_rbxsw_113",j5="_navbarDropdownTitle_rbxsw_121",k5="_navbarDropdownLink_rbxsw_131",N5="_navbarUser_rbxsw_171",I5="_navbarUserProfile_rbxsw_207",E5="_navbarUserAvatar_rbxsw_221",T5="_navbarUserInfo_rbxsw_234",A5="_navbarBtnSignout_rbxsw_248",Ot={navbarComponent:f5,navbarInner:m5,navbarBrand:p5,navbarLogo:g5,navbarTitle:_5,navbarMenu:y5,navbarNavItem:v5,navbarNavLink:x5,active:b5,navbarDropdownMenu:w5,show:S5,navbarDropdownSection:C5,navbarDropdownTitle:j5,navbarDropdownLink:k5,navbarUser:N5,navbarUserProfile:I5,navbarUserAvatar:E5,navbarUserInfo:T5,navbarBtnSignout:A5},fe=({activeItem:t="dashboard",user:e,onSignOut:r})=>{const{currentCompany:s,companies:n,setCurrentCompany:o}=at(),[i,l]=b.useState((e==null?void 0:e.name)||"Loading..."),[c,d]=b.useState((e==null?void 0:e.email)||"Loading..."),[u,h]=b.useState(null),[f,p]=b.useState(null),g=b.useRef({}),y=[{id:"dashboard",label:"Dashboard",href:"/dashboard",active:t==="dashboard"},{id:"product",label:"Product",href:"#",dropdown:[{section:"Product Management",items:[{label:"Inventory",href:"/product/inventory",action:"Inventory"},{label:"Invoice",href:"/product/invoice",action:"Invoice"},{label:"Order",href:"/product/order",action:"Order"},{label:"Product Receive",href:"/product/product-receive",action:"Product Receive"},{label:"Tracking",href:"/product/tracking",action:"Tracking"}]}]},{id:"marketing",label:"Marketing",href:"#",dropdown:[{section:"Marketing Tools",items:[{label:"Marketing Plan",href:"/marketing/marketing-plan",action:"Marketing Plan"}]}]},{id:"finance",label:"Finance",href:"#",dropdown:[{section:"Financial Reports",items:[{label:"Balance Sheet",href:"/finance/balance-sheet",action:"Balance Sheet"},{label:"Income Statement",href:"/finance/income-statement",action:"Income Statement"}]},{section:"Transactions",items:[{label:"Journal Input",href:"/finance/journal-input",action:"Journal Input"},{label:"Transaction History",href:"/finance/transaction-history",action:"Transaction History"},{label:"Cash Ending",href:"/finance/cash-ending",action:"Cash Ending"}]}]},{id:"employee",label:"Employee",href:"#",dropdown:[{section:"Employee Management",items:[{label:"Schedule",href:"/employee/schedule",action:"Schedule"},{label:"Employee Setting",href:"/employee/employee-setting",action:"Employee Setting"},{label:"Salary",href:"/employee/salary",action:"Salary"}]}]},{id:"setting",label:"Setting",href:"#",dropdown:[{section:"General Settings",items:[{label:"Currency",href:"/settings/currency",action:"Currency"},{label:"Company & Store Setting",href:"/settings/store-setting",action:"Company & Store Setting"}]},{section:"Financial Settings",items:[{label:"Account Mapping",href:"/settings/account-mapping",action:"Account Mapping"},{label:"Counterparty",href:"/settings/counterparty",action:"Counterparty"}]}]}];b.useEffect(()=>{(()=>{const N=window.location.pathname,I={"product/inventory":"Inventory","product/invoice":"Invoice","product/order":"Order","product/product-receive":"Product Receive","product/tracking":"Tracking","finance/balance-sheet":"Balance Sheet","finance/income-statement":"Income Statement","finance/journal-input":"Journal Input","finance/transaction-history":"Transaction History","finance/cash-ending":"Cash Ending","employee/schedule":"Schedule","employee/employee-setting":"Employee Setting","employee/salary":"Salary","marketing/marketing-plan":"Marketing Plan","settings/currency":"Currency","settings/store-setting":"Company & Store Setting","settings/account-mapping":"Account Mapping","settings/counterparty":"Counterparty",dashboard:"Dashboard"};for(const[L,T]of Object.entries(I))if(N.includes(L))return p(T),T;return null})()},[]),b.useEffect(()=>{e||(async()=>{var N,I,L;try{const T=ne.getClient(),{data:{session:j}}=await T.auth.getSession();if(j&&j.user){let M=((N=j.user.user_metadata)==null?void 0:N.full_name)||((I=j.user.user_metadata)==null?void 0:I.name)||((L=j.user.user_metadata)==null?void 0:L.display_name);!M&&j.user.email&&(M=j.user.email.split("@")[0].replace(/[._]/g," ").split(" ").map(O=>O.charAt(0).toUpperCase()+O.slice(1)).join(" ")),l(M||"User"),d(j.user.email||"")}}catch(T){console.error("Error loading user info:",T)}})()},[e]),b.useEffect(()=>{const k=N=>{N.target.closest(`.${Ot.navbarNavItem}`)||h(null)};return document.addEventListener("click",k),()=>document.removeEventListener("click",k)},[]);const x=(k,N,I)=>{k==="dashboard"?window.location.href="/dashboard":I||console.log(`Navigation clicked: ${N}`)},m=k=>{h(u===k?null:k)},_=(k,N)=>{console.log(`Dropdown action: ${k}`),window.location.href=N},v=async()=>{try{await ne.getClient().auth.signOut(),localStorage.removeItem("user"),localStorage.removeItem("session"),localStorage.removeItem("companyChoosen"),localStorage.removeItem("storeChoosen"),r?r():window.location.href="/login"}catch(k){console.error("Sign out error:",k)}},w=(k,N)=>{localStorage.setItem("companyChoosen",k),N.stores&&N.stores.length>0?localStorage.setItem("storeChoosen",N.stores[0].store_id):localStorage.removeItem("storeChoosen"),o(N),window.dispatchEvent(new CustomEvent("companyChanged",{detail:{companyId:k,companyName:N.company_name,company:N}})),typeof window.onCompanyChange=="function"&&window.onCompanyChange(k)},S=k=>f===k,C=(()=>{for(const k of y)if(k.dropdown){for(const N of k.dropdown)for(const I of N.items)if(I.action===f)return k.id}return t})();return a.jsx("nav",{className:Ot.navbarComponent,children:a.jsxs("div",{className:Ot.navbarInner,children:[a.jsxs("a",{href:"/dashboard",className:Ot.navbarBrand,children:[a.jsx("div",{className:Ot.navbarLogo,children:a.jsx("img",{src:"/assets/app icon.png",alt:"Store Base",style:{height:"30px",objectFit:"contain"}})}),a.jsx("h1",{className:Ot.navbarTitle,children:"Store Base"})]}),a.jsx("div",{className:Ot.navbarMenu,children:y.map(k=>{const N=k.dropdown&&k.dropdown.length>0,I=k.id===C;return a.jsxs("div",{className:Ot.navbarNavItem,onMouseEnter:()=>N&&h(k.id),onMouseLeave:()=>N&&h(null),children:[a.jsx("a",{href:k.href,className:`${Ot.navbarNavLink} ${I?Ot.active:""}`,onClick:L=>{N?(L.preventDefault(),m(k.id)):x(k.id,k.label,N)},children:k.label}),N&&a.jsx("div",{className:`${Ot.navbarDropdownMenu} ${u===k.id?Ot.show:""}`,ref:L=>g.current[k.id]=L,children:k.dropdown.map((L,T)=>a.jsxs("div",{className:Ot.navbarDropdownSection,children:[a.jsx("div",{className:Ot.navbarDropdownTitle,children:L.section}),L.items.map((j,M)=>{const R=S(j.action);return a.jsx("a",{href:j.href,className:`${Ot.navbarDropdownLink} ${R?Ot.active:""}`,onClick:O=>{O.preventDefault(),_(j.action,j.href)},children:j.label},M)})]},T))})]},k.id)})}),a.jsxs("div",{className:Ot.navbarUser,children:[n&&n.length>0&&a.jsx(h5,{companies:n,selectedCompanyId:(s==null?void 0:s.company_id)||"",onChange:(k,N)=>{w(k,N)}}),a.jsxs("div",{className:Ot.navbarUserProfile,children:[a.jsx("div",{className:Ot.navbarUserAvatar,children:i.charAt(0).toUpperCase()}),a.jsxs("div",{className:Ot.navbarUserInfo,children:[a.jsx("h4",{children:i}),a.jsx("p",{children:c})]})]}),a.jsx("button",{className:Ot.navbarBtnSignout,onClick:v,children:"Sign Out"})]})]})})},L5="_container_102za_7",D5="_header_102za_14",M5="_headerContent_102za_19",R5="_title_102za_24",O5="_dashboardMain_102za_43",P5="_overviewGrid_102za_51",$5="_contentGrid_102za_70",F5="_contentSection_102za_77",B5="_sectionHeader_102za_84",H5="_sectionTitle_102za_92",V5="_viewAllLink_102za_99",z5="_sectionContent_102za_110",U5="_transactionsList_102za_186",W5="_transactionItem_102za_192",q5="_transactionIcon_102za_204",G5="_transactionInfo_102za_217",J5="_transactionDescription_102za_224",K5="_transactionDate_102za_231",Y5="_transactionAmount_102za_237",Q5="_income_102za_244",Z5="_expense_102za_144",X5="_emptyTransactions_102za_252",eT="_emptyState_102za_291",$e={container:L5,header:D5,headerContent:M5,title:R5,dashboardMain:O5,overviewGrid:P5,contentGrid:$5,contentSection:F5,sectionHeader:B5,sectionTitle:H5,viewAllLink:V5,sectionContent:z5,transactionsList:U5,transactionItem:W5,transactionIcon:q5,transactionInfo:G5,transactionDescription:J5,transactionDate:K5,transactionAmount:Y5,income:Q5,expense:Z5,emptyTransactions:X5,emptyState:eT},tT="7e1fd11a-f632-427d-aefc-8b3dd6734faa",rT=()=>{const t=_a(),{currentCompany:e,permissions:r}=at(),s=(e==null?void 0:e.company_id)||"",{data:n,loading:o,errorDialog:i,refresh:l,clearError:c}=dN(s),[d,u]=b.useState(!1),h=g=>{g.preventDefault(),r.includes(tT)?t("/finance/transaction-history"):u(!0)};if(!e)return a.jsxs(a.Fragment,{children:[a.jsx(fe,{activeItem:"dashboard"}),a.jsx("div",{className:$e.container,children:a.jsx("div",{className:$e.dashboardMain,children:a.jsx(Ne,{size:"large",fullscreen:!0})})})]});if(o)return a.jsxs(a.Fragment,{children:[a.jsx(fe,{activeItem:"dashboard"}),a.jsx("div",{className:$e.container,children:a.jsx("div",{className:$e.dashboardMain,children:a.jsx(Ne,{size:"large",fullscreen:!0})})})]});if(!n&&!o)return a.jsxs(a.Fragment,{children:[a.jsx(fe,{activeItem:"dashboard"}),a.jsx("div",{className:$e.container,children:a.jsxs("div",{className:$e.dashboardMain,children:[a.jsx("div",{className:$e.header,children:a.jsx("div",{className:$e.headerContent,children:a.jsx("h1",{className:$e.title,children:"Dashboard"})})}),a.jsx("div",{className:$e.emptyState,children:a.jsx("p",{children:He.emptyStates.noDashboardData})})]})}),a.jsx(De,{variant:i.variant,title:i.title,message:i.message,isOpen:i.isOpen,onClose:c,confirmText:He.actions.retry,onConfirm:l})]});const f=0,p=(n==null?void 0:n.monthOverMonthGrowth)||0;return a.jsxs(a.Fragment,{children:[a.jsx(fe,{activeItem:"dashboard"}),a.jsx("div",{className:$e.container,children:a.jsxs("div",{className:$e.dashboardMain,children:[a.jsx("div",{className:$e.header,children:a.jsx("div",{className:$e.headerContent,children:a.jsx("h1",{className:$e.title,children:"Dashboard"})})}),a.jsxs("div",{className:$e.overviewGrid,children:[a.jsx(Al,{title:"Today Revenue",value:(n==null?void 0:n.formattedTodayRevenue)||"0",icon:a.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M11.8,10.9C9.53,10.31 8.8,9.7 8.8,8.75C8.8,7.66 9.81,6.9 11.5,6.9C13.28,6.9 13.94,7.75 14,9H16.21C16.14,7.28 15.09,5.7 13,5.19V3H10V5.16C8.06,5.58 6.5,6.84 6.5,8.77C6.5,11.08 8.41,12.23 11.2,12.9C13.7,13.5 14.2,14.38 14.2,15.31C14.2,16 13.71,17.1 11.5,17.1C9.44,17.1 8.63,16.18 8.52,15H6.32C6.44,17.19 8.08,18.42 10,18.83V21H13V18.85C14.95,18.5 16.5,17.35 16.5,15.3C16.5,12.46 14.07,11.5 11.8,10.9Z"})}),changePercentage:f,isPositive:f>=0},"today-revenue"),a.jsx(Al,{title:"Today Expense",value:(n==null?void 0:n.formattedTodayExpense)||"0",icon:a.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M3,6H21V18H3V6M12,9A3,3 0 0,1 15,12A3,3 0 0,1 12,15A3,3 0 0,1 9,12A3,3 0 0,1 12,9M7,8A2,2 0 0,1 5,10V14A2,2 0 0,1 7,16H17A2,2 0 0,1 19,14V10A2,2 0 0,1 17,8H7Z"})})},"today-expense"),a.jsx(Al,{title:"This Month Revenue",value:(n==null?void 0:n.formattedThisMonthRevenue)||"0",icon:a.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M16,6L18.29,8.29L13.41,13.17L9.41,9.17L2,16.59L3.41,18L9.41,12L13.41,16L19.71,9.71L22,12V6H16Z"})}),changePercentage:p,isPositive:(n==null?void 0:n.isGrowthPositive)||!1},"this-month-revenue"),a.jsx(Al,{title:"Last Month Revenue",value:(n==null?void 0:n.formattedLastMonthRevenue)||"0",icon:a.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M22,21H2V3H4V19H6V10H10V19H12V6H16V19H18V14H22V21Z"})})},"last-month-revenue")]}),a.jsxs("div",{className:$e.contentGrid,children:[a.jsxs("div",{className:$e.contentSection,children:[a.jsx("div",{className:$e.sectionHeader,children:a.jsx("h2",{className:$e.sectionTitle,children:"This Month Expenses"})}),a.jsx("div",{className:$e.sectionContent,children:a.jsx(Y4,{data:(n==null?void 0:n.expenseBreakdown)||[],formatCurrency:(n==null?void 0:n.formatCurrency)||(g=>`${g.toLocaleString()}`)})})]}),a.jsxs("div",{className:$e.contentSection,children:[a.jsxs("div",{className:$e.sectionHeader,children:[a.jsx("h2",{className:$e.sectionTitle,children:"Recent Activity"}),a.jsx("a",{href:"/finance/transaction-history",className:$e.viewAllLink,onClick:h,children:"View All"})]}),a.jsx("div",{className:$e.sectionContent,children:n&&n.recentTransactions.length>0?a.jsx("div",{className:$e.transactionsList,children:n.recentTransactions.slice(0,5).map(g=>a.jsxs("div",{className:$e.transactionItem,children:[a.jsx("div",{className:$e.transactionIcon,children:g.type==="income"?a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M7,15H9C9,16.08 10.37,17 12,17C13.63,17 15,16.08 15,15C15,13.9 13.96,13.5 11.76,12.97C9.64,12.44 7,11.78 7,9C7,7.21 8.47,5.69 10.5,5.18V3H13.5V5.18C15.53,5.69 17,7.21 17,9H15C15,7.92 13.63,7 12,7C10.37,7 9,7.92 9,9C9,10.1 10.04,10.5 12.24,11.03C14.36,11.56 17,12.22 17,15C17,16.79 15.53,18.31 13.5,18.82V21H10.5V18.82C8.47,18.31 7,16.79 7,15Z"})}):a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"})})}),a.jsxs("div",{className:$e.transactionInfo,children:[a.jsx("p",{className:$e.transactionDescription,children:g.description}),a.jsx("p",{className:$e.transactionDate,children:te.formatTransactionDate(g.date)})]}),a.jsxs("div",{className:`${$e.transactionAmount} ${g.type==="income"?$e.income:$e.expense}`,children:[g.type==="income"?"+":"-",(n==null?void 0:n.formatCurrency(g.amount))||`${g.amount.toLocaleString()}`]})]},g.id))}):a.jsx("div",{className:$e.emptyTransactions,children:a.jsx("p",{children:He.emptyStates.noTransactions})})})]})]})]})}),a.jsx(De,{variant:i.variant,title:i.title,message:i.message,isOpen:i.isOpen,onClose:c,confirmText:He.actions.retry,onConfirm:l}),a.jsx(De,{variant:"warning",title:"Access Denied",message:"You don't have permission to access the Transaction History page. Please contact your administrator.",isOpen:d,onClose:()=>u(!1),confirmText:"OK"})]})};class sT{async getAccountMappings(e){const r=ne.getClient(),{data:s,error:n}=await r.rpc("get_account_mapping_page",{p_company_id:e});if(n)throw console.error("Error fetching account mappings:",n),new Error(n.message);return s||{}}async createAccountMapping(e,r,s,n,o,i){const l=ne.getClient(),{data:c,error:d}=await l.rpc("insert_account_mapping_with_company",{p_my_company_id:e,p_counterparty_company_id:r,p_my_account_id:s,p_linked_account_id:n,p_direction:o,p_created_by:i});if(d)throw console.error("Error creating account mapping:",d),new Error(d.message);return c}async deleteAccountMapping(e){const r=ne.getClient(),{error:s}=await r.from("account_mappings").update({is_deleted:!0,updated_at:te.nowUtc()}).eq("mapping_id",e);if(s)throw console.error("Error deleting account mapping:",s),new Error(s.message)}async getCompanyAccounts(e){const r=ne.getClient(),{data:s,error:n}=await r.rpc("get_account_mapping_page",{p_company_id:e});if(n)throw console.error("Error fetching company accounts:",n),new Error(n.message);return s||{}}}class nT{constructor(e,r,s,n,o,i,l,c,d,u,h,f,p=!1){this.mappingId=e,this.myCompanyId=r,this.myAccountName=s,this.myAccountCode=n,this.myCategoryTag=o,this.linkedCompanyId=i,this.linkedCompanyName=l,this.linkedAccountName=c,this.linkedAccountCode=d,this.linkedCategoryTag=u,this.direction=h,this.createdAt=f,this.isReadOnly=p}getCategoryDisplay(e){switch(e){case"payable":return"Payable";case"receivable":return"Receivable";case"contra_asset":return"Contra Asset";case"cash":return"Cash";case"general":return"General";case"fixed_asset":return"Fixed Asset";case"equity":return"Equity";default:return e}}get directionDisplay(){switch(this.direction){case"outgoing":return"Outgoing";case"incoming":return"Incoming";case"both":return"Both Ways";default:return this.direction}}get isEditable(){return!this.isReadOnly}get isDeletable(){return!this.isReadOnly}get formattedCreatedDate(){return this.createdAt.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}}class k_{static fromJson(e,r=!1){const s=te.toLocalSafe(e.created_at)||new Date;return new nT(e.mapping_id,e.my_company_id,e.my_account_name,e.my_account_code||null,e.my_category_tag,e.linked_company_id,e.linked_company_name,e.linked_account_name,e.linked_account_code||null,e.linked_category_tag,e.direction||"outgoing",s,r)}static toJson(e){return{mapping_id:e.mappingId,my_company_id:e.myCompanyId,my_account_name:e.myAccountName,my_account_code:e.myAccountCode,my_category_tag:e.myCategoryTag,linked_company_id:e.linkedCompanyId,linked_company_name:e.linkedCompanyName,linked_account_name:e.linkedAccountName,linked_account_code:e.linkedAccountCode,linked_category_tag:e.linkedCategoryTag,direction:e.direction,created_at:te.toUtc(e.createdAt)}}static fromJsonArray(e,r=!1){return e.map(s=>this.fromJson(s,r))}static toJsonArray(e){return e.map(r=>this.toJson(r))}static parseRPCResponse(e){const r=e.account_mappings||[],s=e.reverse_account_mappings||[],n=this.fromJsonArray(r,!1),o=this.fromJsonArray(s,!0),i=[...n,...o];return{outgoingMappings:n,incomingMappings:o,allMappings:i}}static extractAccounts(e){return e.accounts||[]}static isValidDTO(e){return typeof e=="object"&&e!==null&&typeof e.mapping_id=="string"&&typeof e.my_company_id=="string"&&typeof e.my_account_name=="string"&&typeof e.linked_company_id=="string"&&typeof e.linked_company_name=="string"&&typeof e.linked_account_name=="string"&&typeof e.created_at=="string"}}class oT{constructor(){W(this,"dataSource");this.dataSource=new sT}async getAccountMappings(e){try{const r=await this.dataSource.getAccountMappings(e),{allMappings:s}=k_.parseRPCResponse(r);return{success:!0,data:s}}catch(r){return console.error("Repository error fetching account mappings:",r),{success:!1,error:r instanceof Error?r.message:"Failed to fetch account mappings"}}}async createAccountMapping(e,r,s,n,o,i){try{return await this.dataSource.createAccountMapping(e,r,s,n,o,i),{success:!0,data:void 0}}catch(l){return console.error("Repository error creating account mapping:",l),{success:!1,error:l instanceof Error?l.message:"Failed to create account mapping"}}}async getCompanyAccounts(e){try{const r=await this.dataSource.getCompanyAccounts(e);return{success:!0,data:k_.extractAccounts(r)}}catch(r){return console.error("Repository error fetching company accounts:",r),{success:!1,error:r instanceof Error?r.message:"Failed to fetch company accounts"}}}async deleteAccountMapping(e){try{return await this.dataSource.deleteAccountMapping(e),{success:!0}}catch(r){return console.error("Repository error deleting account mapping:",r),{success:!1,error:r instanceof Error?r.message:"Failed to delete account mapping"}}}}class N_{static validateAccountSelection(e){return!e||e.trim()===""?{field:"account",message:"Account is required"}:null}static validateCompanySelection(e){return!e||e.trim()===""?{field:"company",message:"Company is required"}:null}static validateDirection(e){if(!e||e.trim()==="")return{field:"direction",message:"Direction is required"};const r=["outgoing","incoming","both"];return r.includes(e)?null:{field:"direction",message:`Direction must be one of: ${r.join(", ")}`}}static validateUserId(e){return!e||e.trim()===""?{field:"user",message:"User ID is required"}:null}static validateCreateMapping(e){const r=[],s=this.validateCompanySelection(e.myCompanyId);s&&r.push(s),this.validateCompanySelection(e.counterpartyCompanyId)&&r.push({field:"counterpartyCompany",message:"Counterparty company is required"}),this.validateAccountSelection(e.myAccountId)&&r.push({field:"myAccount",message:"My account is required"}),this.validateAccountSelection(e.linkedAccountId)&&r.push({field:"linkedAccount",message:"Linked account is required"});const l=this.validateDirection(e.direction);l&&r.push(l);const c=this.validateUserId(e.createdBy);return c&&r.push(c),e.myCompanyId===e.counterpartyCompanyId&&r.push({field:"counterpartyCompany",message:"Cannot create mapping to the same company"}),r}static validateDeleteMapping(e){return!e||e.trim()===""?{field:"mappingId",message:"Mapping ID is required"}:null}static canEdit(e){return e?{allowed:!1,reason:"This mapping is read-only and cannot be edited"}:{allowed:!0}}static canDelete(e){return e?{allowed:!1,reason:"This mapping is read-only and cannot be deleted"}:{allowed:!0}}}const Ul=new oT,lt=Jt((t,e)=>({companyId:"",mappings:[],availableAccounts:[],availableCompanies:[],loading:!1,isCreating:!1,isDeleting:!1,error:null,showAddModal:!1,showDeleteConfirm:!1,deletingMappingId:null,deletingMappingInfo:null,showErrorMessage:!1,errorMessageText:"",getOutgoingMappings:()=>{const{mappings:r}=e();return r.filter(s=>!s.isReadOnly)},getIncomingMappings:()=>{const{mappings:r}=e();return r.filter(s=>s.isReadOnly)},setCompanyId:r=>t({companyId:r}),setMappings:r=>t({mappings:r}),setLoading:r=>t({loading:r}),setError:r=>t({error:r}),setShowAddModal:r=>t({showAddModal:r}),setShowDeleteConfirm:r=>t({showDeleteConfirm:r}),setDeletingMappingId:r=>t({deletingMappingId:r}),setDeletingMappingInfo:r=>t({deletingMappingInfo:r}),setAvailableAccounts:r=>t({availableAccounts:r}),setAvailableCompanies:r=>t({availableCompanies:r}),setShowErrorMessage:r=>t({showErrorMessage:r}),setErrorMessageText:r=>t({errorMessageText:r}),loadMappings:async()=>{const{companyId:r}=e();if(!r){t({mappings:[],loading:!1});return}t({loading:!0,error:null});try{const s=await Ul.getAccountMappings(r);if(!s.success){t({error:s.error||"Failed to load account mappings",mappings:[],loading:!1});return}t({mappings:s.data||[],loading:!1,error:null})}catch(s){t({error:s instanceof Error?s.message:"An unexpected error occurred",mappings:[],loading:!1})}},createMapping:async(r,s,n,o,i)=>{const{companyId:l,loadMappings:c}=e(),d=N_.validateCreateMapping({myCompanyId:l,counterpartyCompanyId:r,myAccountId:s,linkedAccountId:n,direction:o,createdBy:i});if(d.length>0)return{success:!1,error:d.map(h=>h.message).join(", ")};t({isCreating:!0});try{const u=await Ul.createAccountMapping(l,r,s,n,o,i);return u.success&&await c(),u}catch(u){return{success:!1,error:u instanceof Error?u.message:"Failed to create mapping"}}finally{t({isCreating:!1})}},deleteMapping:async r=>{const{loadMappings:s}=e(),n=N_.validateDeleteMapping(r);if(n)return{success:!1,error:n.message};t({isDeleting:!0});try{const o=await Ul.deleteAccountMapping(r);return o.success&&await s(),o}catch(o){return{success:!1,error:o instanceof Error?o.message:"Failed to delete mapping"}}finally{t({isDeleting:!1})}},getCompanyAccounts:async r=>{try{return await Ul.getCompanyAccounts(r)}catch(s){return{success:!1,error:s instanceof Error?s.message:"Failed to fetch company accounts"}}},loadModalData:async r=>{const{companyId:s,getCompanyAccounts:n}=e();if(s)try{const o=await n(s);o.success&&o.data&&t({availableAccounts:o.data});const i=r.filter(l=>l.company_id!==s).map(l=>({company_id:l.company_id,company_name:l.company_name}));t({availableCompanies:i})}catch(o){console.error("Error loading modal data:",o)}},refresh:async()=>{const{loadMappings:r}=e();await r()},reset:()=>t({companyId:"",mappings:[],availableAccounts:[],availableCompanies:[],loading:!1,isCreating:!1,isDeleting:!1,error:null,showAddModal:!1,showDeleteConfirm:!1,deletingMappingId:null,deletingMappingInfo:null,showErrorMessage:!1,errorMessageText:""}),openAddModal:()=>t({showAddModal:!0}),closeAddModal:()=>t({showAddModal:!1}),openDeleteConfirm:(r,s,n)=>t({showDeleteConfirm:!0,deletingMappingId:r,deletingMappingInfo:{myAccount:s,linkedAccount:n}}),closeDeleteConfirm:()=>t({showDeleteConfirm:!1,deletingMappingId:null,deletingMappingInfo:null}),showError:r=>t({showErrorMessage:!0,errorMessageText:r}),hideError:()=>t({showErrorMessage:!1,errorMessageText:""})})),aT=t=>{const e=lt(j=>j.mappings),r=lt(j=>j.availableAccounts),s=lt(j=>j.availableCompanies),n=lt(j=>j.loading),o=lt(j=>j.isCreating),i=lt(j=>j.isDeleting),l=lt(j=>j.error),c=lt(j=>j.showErrorMessage),d=lt(j=>j.errorMessageText),u=lt(j=>j.showAddModal),h=lt(j=>j.showDeleteConfirm),f=lt(j=>j.deletingMappingId),p=lt(j=>j.deletingMappingInfo),g=lt(j=>j.setCompanyId),y=lt(j=>j.loadMappings),x=lt(j=>j.createMapping),m=lt(j=>j.deleteMapping),_=lt(j=>j.getCompanyAccounts),v=lt(j=>j.loadModalData),w=lt(j=>j.refresh),S=lt(j=>j.openAddModal),E=lt(j=>j.closeAddModal),C=lt(j=>j.openDeleteConfirm),k=lt(j=>j.closeDeleteConfirm),N=lt(j=>j.showError),I=lt(j=>j.hideError),L=e.filter(j=>!j.isReadOnly),T=e.filter(j=>j.isReadOnly);return b.useEffect(()=>{g(t),y()},[t]),{mappings:e,availableAccounts:r,availableCompanies:s,loading:n,isCreating:o,isDeleting:i,error:l,showErrorMessage:c,errorMessageText:d,showAddModal:u,showDeleteConfirm:h,deletingMappingId:f,deletingMappingInfo:p,outgoingMappings:L,incomingMappings:T,createMapping:x,deleteMapping:m,getCompanyAccounts:_,loadModalData:v,refresh:w,setCompanyId:g,openAddModal:S,closeAddModal:E,openDeleteConfirm:C,closeDeleteConfirm:k,showError:N,hideError:I}},iT="_tossSelectorGroup_ar4qc_7",lT="_fullWidth_ar4qc_14",cT="_inline_ar4qc_19",dT="_tossSelect_ar4qc_7",uT="_tossSelectActive_ar4qc_53",hT="_tossSelectLabel_ar4qc_60",fT="_required_ar4qc_67",mT="_tossSelectContainer_ar4qc_74",pT="_tossSelectError_ar4qc_119",gT="_disabled_ar4qc_123",_T="_tossSelectValue_ar4qc_132",yT="_tossSelectPlaceholder_ar4qc_140",vT="_tossSelectArrow_ar4qc_145",xT="_tossSelectMenu_ar4qc_176",bT="_tossSelectMenuShow_ar4qc_196",wT="_tossSelectSearch_ar4qc_203",ST="_tossSelectSearchInput_ar4qc_209",CT="_tossSelectOptions_ar4qc_226",jT="_tossSelectOption_ar4qc_226",kT="_tossSelectOptionHighlighted_ar4qc_245",NT="_tossSelectOptionSelected_ar4qc_249",IT="_tossSelectOptionDisabled_ar4qc_258",ET="_tossSelectOptionLabel_ar4qc_265",TT="_tossSelectOptionDescription_ar4qc_269",AT="_tossSelectOptionContent_ar4qc_275",LT="_tossSelectOptionBadge_ar4qc_310",DT="_tossSelectEmpty_ar4qc_334",MT="_tossSelectLoading_ar4qc_342",RT="_tossSelectFooter_ar4qc_354",OT="_tossSelectAction_ar4qc_361",PT="_tossSelectActionIcon_ar4qc_383",$T="_tossSelectActionLabel_ar4qc_390",FT="_tossSelectMessage_ar4qc_396",BT="_tossSelectMessageError_ar4qc_405",HT="_tossSelectMessageInfo_ar4qc_409",Ve={tossSelectorGroup:iT,fullWidth:lT,inline:cT,tossSelect:dT,tossSelectActive:uT,tossSelectLabel:hT,required:fT,tossSelectContainer:mT,tossSelectError:pT,disabled:gT,tossSelectValue:_T,tossSelectPlaceholder:yT,tossSelectArrow:vT,tossSelectMenu:xT,tossSelectMenuShow:bT,tossSelectSearch:wT,tossSelectSearchInput:ST,tossSelectOptions:CT,tossSelectOption:jT,tossSelectOptionHighlighted:kT,tossSelectOptionSelected:NT,tossSelectOptionDisabled:IT,tossSelectOptionLabel:ET,tossSelectOptionDescription:TT,tossSelectOptionContent:AT,tossSelectOptionBadge:LT,tossSelectEmpty:DT,tossSelectLoading:MT,tossSelectFooter:RT,tossSelectAction:OT,tossSelectActionIcon:PT,tossSelectActionLabel:$T,tossSelectMessage:FT,tossSelectMessageError:BT,tossSelectMessageInfo:HT},We=b.forwardRef(({id:t,name:e,label:r,placeholder:s="Select an option",value:n,options:o,onChange:i,onSelect:l,showAddButton:c=!1,addButtonText:d="Add new",onAddClick:u,disabled:h=!1,error:f=!1,errorMessage:p,helperText:g,required:y=!1,fullWidth:x=!1,loading:m=!1,className:_="",searchable:v=!1,maxHeight:w="320px",showDescriptions:S=!1,emptyMessage:E="No options available",showBadges:C=!1,inline:k=!1,editable:N=!1},I)=>{const[L,T]=b.useState(!1),[j,M]=b.useState(""),[R,O]=b.useState(!1),[z,D]=b.useState(-1),P=b.useRef(null),$=b.useRef(null),U=b.useRef(null),A=b.useRef({}),Ae=I||U,ae=v&&j?o.filter(J=>J.label.toLowerCase().includes(j.toLowerCase())||J.description&&J.description.toLowerCase().includes(j.toLowerCase())):o,Ke=o.find(J=>J.value===n),Te=Ke?Ke.label:"";b.useEffect(()=>{const J=ve=>{P.current&&!P.current.contains(ve.target)&&(T(!1),M(""),O(!1),D(-1))};return L&&document.addEventListener("mousedown",J),()=>{document.removeEventListener("mousedown",J)}},[L]),b.useEffect(()=>{L&&v&&$.current&&setTimeout(()=>{var J;(J=$.current)==null||J.focus()},100),L&&D(-1)},[L,v]),b.useEffect(()=>{if(z>=0&&z<ae.length){const J=A.current[z];J&&J.scrollIntoView({block:"nearest",behavior:"smooth"})}},[z,ae.length]);const At=()=>{h||T(!L)},sr=J=>{const ve=o.find(xe=>xe.value===J);ve&&!ve.disabled&&(i(J,ve),T(!1),M(""),O(!1),D(-1),l&&l(J,ve))},Cr=J=>{M(J.target.value),O(!0),L||T(!0)},tt=()=>{!h&&k&&T(!0)},it=J=>{if(J.key==="Enter"&&ae.length>0){J.preventDefault();const ve=z>=0?z:0,xe=ae[ve];xe&&!xe.disabled&&sr(xe.value)}else J.key==="Escape"?(T(!1),M(""),O(!1),D(-1)):J.key==="ArrowDown"?(J.preventDefault(),D(ve=>{const xe=ve+1;return xe>=ae.length?0:xe})):J.key==="ArrowUp"&&(J.preventDefault(),D(ve=>{const xe=ve-1;return xe<0?ae.length-1:xe}))},me=J=>{J.stopPropagation(),u&&(u(),T(!1))},Je=[Ve.tossSelectorGroup,x?Ve.fullWidth:"",k?Ve.inline:"",_].filter(Boolean).join(" "),St=[Ve.tossSelect,L?Ve.tossSelectActive:"",f?Ve.tossSelectError:"",h?Ve.disabled:""].filter(Boolean).join(" "),X=[Ve.tossSelectMenu,L?Ve.tossSelectMenuShow:""].filter(Boolean).join(" ");return a.jsxs("div",{className:Je,ref:P,children:[r&&!k&&a.jsx("label",{htmlFor:t,className:`${Ve.tossSelectLabel} ${y?Ve.required:""}`,children:r}),a.jsxs("div",{className:Ve.tossSelectContainer,children:[k?a.jsx("input",{ref:Ae,type:"text",id:t,className:St,value:R?j:Te,onChange:Cr,onFocus:tt,onKeyDown:it,placeholder:s,disabled:h||m,"aria-haspopup":"listbox","aria-expanded":L}):a.jsxs("button",{type:"button",id:t,className:St,onClick:At,disabled:h||m,"aria-haspopup":"listbox","aria-expanded":L,children:[a.jsx("span",{className:`${Ve.tossSelectValue} ${Te?"":Ve.tossSelectPlaceholder}`,children:Te||s}),m?a.jsx(Ne,{size:"small"}):a.jsx("svg",{className:Ve.tossSelectArrow,viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M7 10l5 5 5-5z"})})]}),a.jsxs("div",{className:X,style:{maxHeight:w},children:[v&&!k&&a.jsx("div",{className:Ve.tossSelectSearch,children:a.jsx("input",{ref:$,type:"text",className:Ve.tossSelectSearchInput,placeholder:"Search...",value:j,onChange:J=>M(J.target.value),onClick:J=>J.stopPropagation(),onKeyDown:J=>{if(J.key==="Enter"&&ae.length>0){J.preventDefault();const ve=z>=0?z:0,xe=ae[ve];xe&&!xe.disabled&&sr(xe.value)}else J.key==="Escape"?(T(!1),M(""),D(-1)):J.key==="ArrowDown"?(J.preventDefault(),D(ve=>{const xe=ve+1;return xe>=ae.length?0:xe})):J.key==="ArrowUp"&&(J.preventDefault(),D(ve=>{const xe=ve-1;return xe<0?ae.length-1:xe}))}})}),a.jsx("div",{className:Ve.tossSelectOptions,children:m?a.jsx("div",{className:Ve.tossSelectLoading,children:a.jsx(Ne,{size:"medium"})}):ae.length===0?a.jsx("div",{className:Ve.tossSelectEmpty,children:E}):ae.map((J,ve)=>{const xe=J.value===n,F=ve===z,K=[Ve.tossSelectOption,xe?Ve.tossSelectOptionSelected:"",F?Ve.tossSelectOptionHighlighted:"",J.disabled?Ve.tossSelectOptionDisabled:""].filter(Boolean).join(" ");return a.jsxs("div",{ref:ie=>A.current[ve]=ie,className:K,onClick:()=>sr(J.value),onMouseEnter:()=>D(ve),role:"option","aria-selected":xe,children:[C&&J.badge&&a.jsx("span",{className:Ve.tossSelectOptionBadge,style:J.badgeColor?{backgroundColor:J.badgeColor}:void 0,children:J.badge}),a.jsxs("div",{className:Ve.tossSelectOptionContent,children:[a.jsx("div",{className:Ve.tossSelectOptionLabel,children:J.label}),S&&J.description&&a.jsx("div",{className:Ve.tossSelectOptionDescription,style:{backgroundColor:J.descriptionBgColor,color:J.descriptionColor},children:J.description})]})]},J.value)})}),c&&u&&ae.length>0&&a.jsx("div",{className:Ve.tossSelectFooter,children:a.jsxs("div",{className:Ve.tossSelectAction,onClick:me,children:[a.jsx("svg",{className:Ve.tossSelectActionIcon,viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm5 11h-4v4h-2v-4H7v-2h4V7h2v4h4v2z"})}),a.jsx("span",{className:Ve.tossSelectActionLabel,children:d})]})})]})]}),f&&p||g?a.jsx("p",{className:`${Ve.tossSelectMessage} ${f?Ve.tossSelectMessageError:Ve.tossSelectMessageInfo}`,children:f&&p?p:g}):null]})});We.displayName="TossSelector";const VT="_modalOverlay_9mx2e_5",zT="_modal_9mx2e_5",UT="_modalHeader_9mx2e_33",WT="_closeButton_9mx2e_48",qT="_modalBody_9mx2e_67",GT="_formGroup_9mx2e_73",JT="_formLabel_9mx2e_77",KT="_companyDisplay_9mx2e_85",YT="_modalFooter_9mx2e_96",QT="_cancelButton_9mx2e_103",ZT="_saveButton_9mx2e_104",Fr={modalOverlay:VT,modal:zT,modalHeader:UT,closeButton:WT,modalBody:qT,formGroup:GT,formLabel:JT,companyDisplay:KT,modalFooter:YT,cancelButton:QT,saveButton:ZT},XT=({isOpen:t,onClose:e,onSubmit:r,getCompanyAccounts:s,availableCompanies:n,availableAccounts:o})=>{const{currentCompany:i,currentUser:l}=at(),[c,d]=b.useState(""),[u,h]=b.useState(""),[f,p]=b.useState(""),[g,y]=b.useState([]),[x,m]=b.useState(!1),[_,v]=b.useState(!1),[w,S]=b.useState(!1),[E,C]=b.useState("");b.useEffect(()=>{t||(d(""),h(""),p(""),y([]),S(!1),C(""))},[t]);const k=D=>{switch(D==null?void 0:D.toLowerCase()){case"payable":return"rgba(239, 68, 68, 0.15)";case"receivable":return"rgba(59, 130, 246, 0.15)";case"contra_asset":return"rgba(107, 114, 128, 0.15)";case"cash":return"rgba(34, 197, 94, 0.15)";case"general":return"rgba(107, 114, 128, 0.15)";case"fixed_asset":return"rgba(168, 85, 247, 0.15)";case"equity":return"rgba(14, 165, 233, 0.15)";default:return"rgba(107, 114, 128, 0.15)"}},N=D=>{switch(D==null?void 0:D.toLowerCase()){case"payable":return"rgb(239, 68, 68)";case"receivable":return"rgb(59, 130, 246)";case"contra_asset":return"rgb(107, 114, 128)";case"cash":return"rgb(34, 197, 94)";case"general":return"rgb(107, 114, 128)";case"fixed_asset":return"rgb(168, 85, 247)";case"equity":return"rgb(14, 165, 233)";default:return"rgb(107, 114, 128)"}},I=D=>D?D.replace(/_/g," ").replace(/\b\w/g,P=>P.toUpperCase()):"General",L=D=>{if(!D)return"??";const P=D.trim().split(" ");return P.length===1?D.substring(0,2).toUpperCase():P.slice(0,2).map($=>$[0]).join("").toUpperCase()},T=b.useMemo(()=>o.map(D=>({value:D.account_id,label:D.account_name,badge:L(D.account_name),description:D.category_tag&&D.category_tag.toLowerCase()!=="general"?I(D.category_tag):void 0,descriptionBgColor:D.category_tag?k(D.category_tag):void 0,descriptionColor:D.category_tag?N(D.category_tag):void 0})),[o]),j=b.useMemo(()=>n.map(D=>({value:D.company_id,label:D.company_name,badge:L(D.company_name)})),[n]),M=b.useMemo(()=>g.map(D=>({value:D.account_id,label:D.account_name,badge:L(D.account_name),description:D.category_tag&&D.category_tag.toLowerCase()!=="general"?I(D.category_tag):void 0,descriptionBgColor:D.category_tag?k(D.category_tag):void 0,descriptionColor:D.category_tag?N(D.category_tag):void 0})),[g]),R=async D=>{h(D),p(""),m(!0);try{const P=await s(D);P.success&&P.data?y(P.data):y([])}catch(P){console.error("Error loading counter accounts:",P),y([])}finally{m(!1)}},O=async()=>{if(!(!c||!u||!f)){if(!i||!l){C("Missing company or user data"),S(!0);return}v(!0);try{const D=o.find(U=>U.account_id===c),P=(D==null?void 0:D.category_tag)||"both",$=await r(u,c,f,P,l.user_id);$.success?e():(C($.error||"Failed to create mapping"),S(!0))}catch(D){console.error("Error creating mapping:",D),C("Failed to create mapping"),S(!0)}finally{v(!1)}}},z=c&&u&&f;return t?a.jsx("div",{className:Fr.modalOverlay,onClick:e,children:a.jsxs("div",{className:Fr.modal,onClick:D=>D.stopPropagation(),children:[a.jsxs("div",{className:Fr.modalHeader,children:[a.jsx("h2",{children:"Add Account Mapping"}),a.jsx("button",{onClick:e,className:Fr.closeButton,children:a.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"})})})]}),a.jsxs("div",{className:Fr.modalBody,children:[a.jsxs("div",{className:Fr.formGroup,children:[a.jsx("label",{className:Fr.formLabel,children:"My Company"}),a.jsx("div",{className:Fr.companyDisplay,children:i==null?void 0:i.company_name})]}),a.jsx("div",{className:Fr.formGroup,children:a.jsx(We,{label:"My Account",placeholder:"Select Account",value:c,options:T,onChange:D=>d(D),searchable:!0,showBadges:!1,showDescriptions:!0,required:!0,fullWidth:!0})}),a.jsx("div",{className:Fr.formGroup,children:a.jsx(We,{label:"Company",placeholder:"Select Company",value:u,options:j,onChange:R,searchable:!0,showBadges:!1,required:!0,fullWidth:!0})}),a.jsx("div",{className:Fr.formGroup,children:a.jsx(We,{label:"Account",placeholder:u?"Select Account":"Select Company First",value:f,options:M,onChange:D=>p(D),searchable:!0,showBadges:!1,showDescriptions:!0,required:!0,fullWidth:!0,disabled:!u||x,loading:x})})]}),a.jsxs("div",{className:Fr.modalFooter,children:[a.jsx("button",{onClick:e,className:Fr.cancelButton,children:"Cancel"}),a.jsx("button",{onClick:O,className:Fr.saveButton,disabled:!z||_,children:_?"Creating...":"Create Mapping"})]}),a.jsx(De,{variant:"error",isOpen:w,onClose:()=>S(!1),message:E,zIndex:10001})]})}):null},eA="_modalOverlay_1g955_7",tA="_modalContainer_1g955_30",rA="_modalHeader_1g955_52",sA="_headerIcon_1g955_62",nA="_headerContent_1g955_73",oA="_modalTitle_1g955_77",aA="_modalBody_1g955_86",iA="_warningSection_1g955_91",lA="_warningIcon_1g955_103",cA="_warningContent_1g955_109",dA="_warningText_1g955_113",uA="_contentSection_1g955_122",hA="_modalFooter_1g955_129",fA="_cancelButton_1g955_139",mA="_confirmButton_1g955_162",pA="_confirmButtonPrimary_1g955_184",gA="_confirmButtonError_1g955_196",_A="_confirmButtonSuccess_1g955_208",yA="_confirmButtonWarning_1g955_220",Bt={modalOverlay:eA,modalContainer:tA,modalHeader:rA,headerIcon:sA,headerContent:nA,modalTitle:oA,modalBody:aA,warningSection:iA,warningIcon:lA,warningContent:cA,warningText:dA,contentSection:uA,modalFooter:hA,cancelButton:fA,confirmButton:mA,confirmButtonPrimary:pA,confirmButtonError:gA,confirmButtonSuccess:_A,confirmButtonWarning:yA},vA={info:a.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12,2A7,7 0 0,1 19,9C19,11.38 17.81,13.47 16,14.74V17A1,1 0 0,1 15,18H9A1,1 0 0,1 8,17V14.74C6.19,13.47 5,11.38 5,9A7,7 0 0,1 12,2M9,21V20H15V21A1,1 0 0,1 14,22H10A1,1 0 0,1 9,21M12,4A5,5 0 0,0 7,9C7,11.05 8.23,12.81 10,13.58V16H14V13.58C15.77,12.81 17,11.05 17,9A5,5 0 0,0 12,4Z"})}),warning:a.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12,2L1,21H23M12,6L19.53,19H4.47M11,10V14H13V10M11,16V18H13V16"})}),error:a.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12,2L1,21H23M12,6L19.53,19H4.47M11,10V14H13V10M11,16V18H13V16"})}),success:a.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2M12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20A8,8 0 0,0 20,12A8,8 0 0,0 12,4M11,16.5L6.5,12L7.91,10.59L11,13.67L16.59,8.09L18,9.5L11,16.5Z"})})},xA=a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"white",children:a.jsx("path",{d:"M9,20.42L2.79,14.21L5.62,11.38L9,14.77L18.88,4.88L21.71,7.71L9,20.42Z"})}),bA=a.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"#F59E0B",children:a.jsx("path",{d:"M12,2L1,21H23M12,6L19.53,19H4.47M11,10V14H13V10M11,16V18H13V16"})}),pm=({isOpen:t,onClose:e,onConfirm:r,variant:s="info",title:n,headerIcon:o,message:i,messageIcon:l,showWarningSection:c,warningSectionBackground:d="#FFF9E6",warningSectionBorder:u="#FFE5B4",children:h,isLoading:f=!1,confirmText:p="OK",cancelText:g="Cancel",confirmButtonVariant:y="error",showConfirmIcon:x=!0,confirmIcon:m,width:_="500px",headerBackground:v,closeOnBackdropClick:w=!1,closeOnEscape:S=!0,zIndex:E=1e3,className:C=""})=>{b.useEffect(()=>{if(!S||!t||f)return;const O=z=>{z.key==="Escape"&&e()};return document.addEventListener("keydown",O),()=>document.removeEventListener("keydown",O)},[t,S,f,e]);const k=b.useCallback(O=>{w&&!f&&O.target===O.currentTarget&&e()},[w,f,e]),N=b.useCallback(async()=>{if(!f)try{const O=r();O&&typeof O=="object"&&"then"in O&&await O}catch(O){console.error("ConfirmModal: Error in onConfirm:",O)}},[f,r]),I=b.useCallback(()=>{f||e()},[f,e]);if(!t)return null;const L=()=>{if(v)return v;switch(s){case"info":return"#4169E1";case"warning":return"#FF9500";case"error":return"#FF5847";case"success":return"#00C896";default:return"#4169E1"}},T=()=>{switch(y){case"primary":return Bt.confirmButtonPrimary;case"error":return Bt.confirmButtonError;case"success":return Bt.confirmButtonSuccess;case"warning":return Bt.confirmButtonWarning;default:return Bt.confirmButtonError}},j=c??(i!==void 0&&i!==""),M=o!==void 0?o:vA[s],R=m!==void 0?m:xA;return a.jsx("div",{className:Bt.modalOverlay,onClick:k,style:{zIndex:E},children:a.jsxs("div",{className:`${Bt.modalContainer} ${C}`,style:{maxWidth:_,zIndex:E+1},children:[a.jsxs("div",{className:Bt.modalHeader,style:{background:L()},children:[M&&a.jsx("div",{className:Bt.headerIcon,children:M}),a.jsx("div",{className:Bt.headerContent,children:a.jsx("h2",{className:Bt.modalTitle,children:n})})]}),a.jsxs("div",{className:Bt.modalBody,children:[j&&a.jsxs("div",{className:Bt.warningSection,style:{background:d,borderColor:u},children:[a.jsx("div",{className:Bt.warningIcon,children:l!==void 0?l:bA}),a.jsx("div",{className:Bt.warningContent,children:a.jsx("div",{className:Bt.warningText,children:i})})]}),h&&a.jsx("div",{className:Bt.contentSection,children:h})]}),a.jsxs("div",{className:Bt.modalFooter,children:[a.jsx("button",{className:Bt.cancelButton,onClick:I,disabled:f,type:"button",children:g}),a.jsx("button",{className:`${Bt.confirmButton} ${T()}`,onClick:N,disabled:f,type:"button",children:f?a.jsx(Ne,{size:"small"}):a.jsxs(a.Fragment,{children:[x&&R,p]})})]})]})})},wA="_container_1600p_6",SA="_pageHeader_1600p_16",CA="_pageTitle_1600p_25",jA="_pageSubtitle_1600p_32",kA="_addButton_1600p_38",NA="_errorState_1600p_82",IA="_errorMessage_1600p_87",EA="_retryButton_1600p_93",TA="_emptyState_1600p_110",AA="_emptySection_1600p_118",LA="_section_1600p_128",DA="_sectionTitle_1600p_132",MA="_sectionSubtitle_1600p_142",RA="_lockBadge_1600p_148",OA="_cardsGrid_1600p_161",PA="_card_1600p_161",$A="_readOnly_1600p_184",FA="_cardHeader_1600p_199",BA="_directionBadge_1600p_211",HA="_readOnlyIndicator_1600p_226",VA="_deleteButton_1600p_232",zA="_accountDetails_1600p_253",UA="_mappingItem_1600p_260",WA="_accountIcon_1600p_273",qA="_accountInfo_1600p_291",GA="_accountName_1600p_297",JA="_accountCode_1600p_309",KA="_mappingConnection_1600p_337",YA="_mappingArrow_1600p_345",QA="_companyBadge_1600p_356",de={container:wA,pageHeader:SA,pageTitle:CA,pageSubtitle:jA,addButton:kA,errorState:NA,errorMessage:IA,retryButton:EA,emptyState:TA,emptySection:AA,section:LA,sectionTitle:DA,sectionSubtitle:MA,lockBadge:RA,cardsGrid:OA,card:PA,readOnly:$A,cardHeader:FA,directionBadge:BA,readOnlyIndicator:HA,deleteButton:VA,accountDetails:zA,mappingItem:UA,accountIcon:WA,accountInfo:qA,accountName:GA,accountCode:JA,mappingConnection:KA,mappingArrow:YA,companyBadge:QA},Wl=t=>{if(!t)return"??";const e=t.trim().split(" ");return e.length===1?t.substring(0,2).toUpperCase():e.slice(0,2).map(r=>r[0]).join("").toUpperCase()},ZA=()=>{const{currentCompany:t,companies:e}=at(),{outgoingMappings:r,incomingMappings:s,availableAccounts:n,availableCompanies:o,loading:i,isDeleting:l,error:c,showErrorMessage:d,errorMessageText:u,showAddModal:h,showDeleteConfirm:f,deletingMappingId:p,deletingMappingInfo:g,createMapping:y,deleteMapping:x,getCompanyAccounts:m,loadModalData:_,refresh:v,openAddModal:w,closeAddModal:S,openDeleteConfirm:E,closeDeleteConfirm:C,showError:k,hideError:N}=aT((t==null?void 0:t.company_id)||"");b.useEffect(()=>{h&&t&&_(e)},[h,t==null?void 0:t.company_id]);const I=(j,M,R)=>{E(j,M,R)},L=async()=>{if(!p)return;const j=await x(p);j.success?C():(C(),k(j.error||"Failed to delete mapping"))},T=()=>{C()};return t?i?a.jsxs(a.Fragment,{children:[a.jsx(fe,{activeItem:"setting"}),a.jsx("div",{className:de.container,children:a.jsx(Ne,{fullscreen:!0})})]}):c?a.jsxs(a.Fragment,{children:[a.jsx(fe,{activeItem:"setting"}),a.jsx("div",{className:de.container,children:a.jsxs("div",{className:de.errorState,children:[a.jsx("p",{className:de.errorMessage,children:c}),a.jsx("button",{onClick:v,className:de.retryButton,children:"Retry"})]})})]}):a.jsxs(a.Fragment,{children:[a.jsx(fe,{activeItem:"setting"}),a.jsxs("div",{className:de.container,children:[a.jsxs("div",{className:de.pageHeader,children:[a.jsxs("div",{children:[a.jsx("h1",{className:de.pageTitle,children:"Account Mapping"}),a.jsx("p",{className:de.pageSubtitle,children:"Configure chart of accounts"})]}),a.jsxs("button",{onClick:w,className:de.addButton,children:[a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"})}),"Add Account Mapping"]})]}),a.jsxs("div",{className:de.section,children:[a.jsx("h2",{className:de.sectionTitle,children:"My Company Mappings"}),a.jsx("p",{className:de.sectionSubtitle,children:"Account mappings created by your company"}),r.length===0?a.jsx("div",{className:de.emptySection,children:a.jsx("p",{children:"No account mappings yet"})}):a.jsx("div",{className:de.cardsGrid,children:r.map(j=>a.jsxs("div",{className:de.card,children:[a.jsxs("div",{className:de.cardHeader,children:[a.jsx("span",{className:de.directionBadge,children:j.directionDisplay}),j.isDeletable&&a.jsx("button",{onClick:()=>I(j.mappingId,j.myAccountName,j.linkedAccountName),className:de.deleteButton,title:"Delete",children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"})})})]}),a.jsxs("div",{className:de.accountDetails,children:[a.jsxs("div",{className:de.mappingItem,children:[a.jsx("div",{className:de.accountIcon,children:Wl(j.myAccountName)}),a.jsxs("div",{className:de.accountInfo,children:[a.jsx("div",{className:de.accountName,children:j.myAccountName}),a.jsx("div",{className:de.accountCode,children:j.getCategoryDisplay(j.myCategoryTag)})]})]}),a.jsx("div",{className:de.mappingConnection,children:a.jsxs("div",{className:de.mappingArrow,children:[a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 4l-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8z"})}),a.jsx("span",{children:j.linkedCompanyName||"Direct Link"})]})}),a.jsxs("div",{className:de.mappingItem,children:[a.jsx("div",{className:de.accountIcon,children:Wl(j.linkedAccountName)}),a.jsxs("div",{className:de.accountInfo,children:[a.jsx("div",{className:de.accountName,children:j.linkedAccountName}),a.jsxs("div",{className:de.accountCode,children:[j.getCategoryDisplay(j.linkedCategoryTag),a.jsx("span",{className:de.companyBadge,children:j.linkedCompanyName})]})]})]})]})]},j.mappingId))})]}),s.length>0&&a.jsxs("div",{className:de.section,children:[a.jsxs("h2",{className:de.sectionTitle,children:["Reverse Mappings",a.jsxs("span",{className:de.lockBadge,children:[a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12,17C10.89,17 10,16.1 10,15C10,13.89 10.89,13 12,13A2,2 0 0,1 14,15A2,2 0 0,1 12,17M18,20V10H6V20H18M18,8A2,2 0 0,1 20,10V20A2,2 0 0,1 18,22H6C4.89,22 4,21.1 4,20V10C4,8.89 4.89,8 6,8H7V6A5,5 0 0,1 12,1A5,5 0 0,1 17,6V8H18M12,3A3,3 0 0,0 9,6V8H15V6A3,3 0 0,0 12,3Z"})}),"Read-Only"]})]}),a.jsx("p",{className:de.sectionSubtitle,children:"Mappings created by other companies (cannot be modified)"}),a.jsx("div",{className:de.cardsGrid,children:s.map(j=>a.jsxs("div",{className:`${de.card} ${de.readOnly}`,children:[a.jsxs("div",{className:de.cardHeader,children:[a.jsx("span",{className:de.directionBadge,children:j.directionDisplay}),a.jsx("div",{className:de.readOnlyIndicator,title:`Created by ${j.linkedCompanyName}. Cannot be edited from here.`,children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"var(--toss-gray-400)",children:a.jsx("path",{d:"M12 17c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm6-9h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zM8.9 6c0-1.71 1.39-3.1 3.1-3.1s3.1 1.39 3.1 3.1v2H8.9V6zM18 20H6V10h12v10z"})})})]}),a.jsxs("div",{className:de.accountDetails,children:[a.jsxs("div",{className:de.mappingItem,children:[a.jsx("div",{className:de.accountIcon,children:Wl(j.myAccountName)}),a.jsxs("div",{className:de.accountInfo,children:[a.jsx("div",{className:de.accountName,children:j.myAccountName}),a.jsx("div",{className:de.accountCode,children:j.getCategoryDisplay(j.myCategoryTag)})]})]}),a.jsx("div",{className:de.mappingConnection,children:a.jsxs("div",{className:de.mappingArrow,children:[a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"})}),a.jsx("span",{children:j.linkedCompanyName||"Direct Link"})]})}),a.jsxs("div",{className:de.mappingItem,children:[a.jsx("div",{className:de.accountIcon,children:Wl(j.linkedAccountName)}),a.jsxs("div",{className:de.accountInfo,children:[a.jsx("div",{className:de.accountName,children:j.linkedAccountName}),a.jsxs("div",{className:de.accountCode,children:[j.getCategoryDisplay(j.linkedCategoryTag),a.jsx("span",{className:de.companyBadge,children:j.linkedCompanyName})]})]})]})]})]},j.mappingId))})]}),a.jsx(XT,{isOpen:h,onClose:S,onSubmit:y,getCompanyAccounts:m,availableCompanies:o,availableAccounts:n}),a.jsx(pm,{isOpen:f,onClose:T,onConfirm:L,variant:"error",title:"Delete Account Mapping",message:"Are you sure you want to delete this account mapping?",confirmText:"Delete",cancelText:"Cancel",confirmButtonVariant:"error",isLoading:l,closeOnBackdropClick:!l,closeOnEscape:!l,children:g&&a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"var(--space-3)",padding:"var(--space-4)",background:"var(--toss-gray-50)",borderRadius:"var(--radius-md)",fontSize:"var(--font-small)"},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"var(--space-2)"},children:[a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"var(--text-tertiary)",children:a.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"})}),a.jsxs("span",{children:["Your Account: ",a.jsx("strong",{children:g.myAccount})]})]}),a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"var(--space-2)"},children:[a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"var(--text-tertiary)",children:a.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"})}),a.jsxs("span",{children:["Linked Account: ",a.jsx("strong",{children:g.linkedAccount})]})]}),a.jsx("div",{style:{color:"var(--toss-error)",fontSize:"var(--font-small)",marginTop:"var(--space-2)",fontWeight:500},children:"This action cannot be undone."})]})}),a.jsx(De,{variant:"error",isOpen:d,onClose:N,message:u,zIndex:1e4})]})]}):a.jsxs(a.Fragment,{children:[a.jsx(fe,{activeItem:"setting"}),a.jsx("div",{className:de.container,children:a.jsx("div",{className:de.emptyState,children:a.jsx("p",{children:"Please select a company to view account mappings"})})})]})};class XA{async getBalanceSheet(e,r,s,n){const o=ne.getClient(),i={p_company_id:e,p_store_id:r,p_start_date:s,p_end_date:n};console.log("Calling get_balance_sheet RPC with params:",i);const{data:l,error:c}=await o.rpc("get_balance_sheet",i);if(c)throw console.error("Error fetching balance sheet:",c),new Error(c.message);return console.log("Balance sheet data received:",l),l}}class eL{constructor(e,r,s,n,o,i,l,c,d,u,h,f,p,g,y,x){this.totalAssets=e,this.totalLiabilities=r,this.totalEquity=s,this.totalLiabilitiesAndEquity=n,this.totalCurrentAssets=o,this.totalNonCurrentAssets=i,this.totalCurrentLiabilities=l,this.totalNonCurrentLiabilities=c,this.currentAssets=d,this.nonCurrentAssets=u,this.currentLiabilities=h,this.nonCurrentLiabilities=f,this.equity=p,this.comprehensiveIncome=g,this.currencySymbol=y,this.asOfDate=x}get isBalanced(){return Math.abs(this.totalAssets-this.totalLiabilitiesAndEquity)<.01}get balanceDifference(){return this.totalAssets-this.totalLiabilitiesAndEquity}formatCurrency(e){return`${this.currencySymbol}${e.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})}`}calculatePercentage(e,r){return r===0?0:e/r*100}get assetsPercentage(){return"100% of Total"}get currentAssetsPercentage(){return`Current: ${this.calculatePercentage(this.totalCurrentAssets,this.totalAssets).toFixed(1)}%`}get liabilitiesPercentage(){const e=this.totalLiabilities+this.totalEquity;return`${this.calculatePercentage(this.totalLiabilities,e).toFixed(1)}% of Total`}get equityPercentage(){const e=this.totalLiabilities+this.totalEquity;return`${this.calculatePercentage(this.totalEquity,e).toFixed(1)}% of Total`}get formattedDate(){const[e,r,s]=this.asOfDate.split("-").map(Number);return new Date(e,r-1,s).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}}class I_{static mapAccount(e){return{accountId:e.account_id,accountName:e.account_name,balance:e.balance,formattedBalance:e.formatted_balance||e.balance.toLocaleString("en-US")}}static mapSection(e,r,s){return{title:e,total:r,accounts:(s||[]).map(n=>this.mapAccount(n))}}static fromServerResponse(e,r){var h,f;const s=e.data,n=s.totals;console.log(" Model - Mapping server response to entity"),console.log(" Model - Totals:",n),console.log(" Model - Current Assets sample:",(h=s.current_assets)==null?void 0:h[0]);const o=this.mapSection("Current Assets",(n==null?void 0:n.total_current_assets)||0,s.current_assets),i=this.mapSection("Non-Current Assets",(n==null?void 0:n.total_non_current_assets)||0,s.non_current_assets),l=this.mapSection("Current Liabilities",(n==null?void 0:n.total_current_liabilities)||0,s.current_liabilities),c=this.mapSection("Non-Current Liabilities",(n==null?void 0:n.total_non_current_liabilities)||0,s.non_current_liabilities),d=this.mapSection("Equity",(n==null?void 0:n.total_equity)||0,s.equity),u=this.mapSection("Other Comprehensive Income",0,s.comprehensive_income);return new eL((n==null?void 0:n.total_assets)||0,(n==null?void 0:n.total_liabilities)||0,(n==null?void 0:n.total_equity)||0,(n==null?void 0:n.total_liabilities_and_equity)||0,(n==null?void 0:n.total_current_assets)||0,(n==null?void 0:n.total_non_current_assets)||0,(n==null?void 0:n.total_current_liabilities)||0,(n==null?void 0:n.total_non_current_liabilities)||0,o,i,l,c,d,u,((f=e.company_info)==null?void 0:f.currency_symbol)||"",r||new Date().toISOString().split("T")[0])}static isValidResponse(e){return e&&typeof e=="object"&&e.success===!0&&e.data&&typeof e.data=="object"&&e.data.totals&&typeof e.data.totals=="object"}}class tL{constructor(){W(this,"dataSource");this.dataSource=new XA}async getBalanceSheet(e,r,s,n){try{const o=await this.dataSource.getBalanceSheet(e,r,s,n);if(console.log(" Repository - Received response from data source"),!I_.isValidResponse(o))return{success:!1,error:"Invalid balance sheet data structure"};const i=I_.fromServerResponse(o,n);return console.log(" Repository - Successfully mapped to entity"),{success:!0,data:i}}catch(o){return console.error("Repository error fetching balance sheet:",o),{success:!1,error:o instanceof Error?o.message:"Failed to fetch balance sheet"}}}}class Zc{static validateCompanyId(e){return!e||e.trim()===""?{field:"companyId",message:"Company ID is required"}:null}static validateStoreId(e){return e==null?null:e.trim()===""?{field:"storeId",message:"Store ID cannot be empty string"}:null}static validateDateFormat(e){if(!e)return null;if(!/^\d{4}-\d{2}-\d{2}$/.test(e))return{field:"date",message:"Date must be in YYYY-MM-DD format"};const s=new Date(e);return isNaN(s.getTime())?{field:"date",message:"Invalid date value"}:null}static validateDateRange(e,r){if(!e||!r)return null;const s=this.validateDateFormat(e);if(s)return{field:"startDate",message:s.message};const n=this.validateDateFormat(r);if(n)return{field:"endDate",message:n.message};const o=new Date(e),i=new Date(r);return o>i?{field:"dateRange",message:"Start date must be before or equal to end date"}:null}static validateDateNotFuture(e){if(!e)return null;const r=new Date(e),s=new Date;return s.setHours(0,0,0,0),r>s?{field:"date",message:"Date cannot be in the future"}:null}static validateFilters(e){const r=[],s=this.validateCompanyId(e.companyId);s&&r.push(s);const n=this.validateStoreId(e.storeId);if(n&&r.push(n),e.startDate){const i=this.validateDateFormat(e.startDate);i&&r.push({field:"startDate",message:i.message})}if(e.endDate){const i=this.validateDateFormat(e.endDate);i&&r.push({field:"endDate",message:i.message})}const o=this.validateDateRange(e.startDate,e.endDate);return o&&r.push(o),r}static validateBalanceEquation(e,r,s=.01){const n=Math.abs(e-r);return n>s?{valid:!1,difference:n,message:`Balance sheet equation not satisfied. Assets (${e})  Liabilities + Equity (${r}). Difference: ${n.toFixed(2)}`}:{valid:!0,difference:n}}static validateTotalConsistency(e,r,s=.01){const n=r.reduce((i,l)=>i+l,0),o=Math.abs(e-n);return o>s?{valid:!1,difference:o,message:`Total (${e}) does not match sum of sections (${n}). Difference: ${o.toFixed(2)}`}:{valid:!0,difference:o}}}const rL=new tL,bu=()=>{const t=new Date,e=new Date(t.getFullYear(),t.getMonth(),1);return te.toDateOnly(e)},wu=()=>{const t=new Date,e=new Date(t.getFullYear(),t.getMonth()+1,0);return te.toDateOnly(e)},cr=Jt((t,e)=>({companyId:"",storeId:null,startDate:bu(),endDate:wu(),balanceSheet:null,loading:!1,error:null,validationErrors:{},setCompanyId:r=>{t({companyId:r})},setStoreId:r=>{t({storeId:r,validationErrors:{}})},setDateRange:(r,s)=>{t({startDate:r,endDate:s,validationErrors:{}})},setStartDate:r=>{t({startDate:r,validationErrors:{}})},setEndDate:r=>{t({endDate:r,validationErrors:{}})},loadBalanceSheet:async(r,s,n)=>{const o=e(),i=r!==void 0?r:o.storeId,l=s!==void 0?s:o.startDate,c=n!==void 0?n:o.endDate,d=Zc.validateFilters({companyId:o.companyId,storeId:i,startDate:l,endDate:c});if(d.length>0){console.log(" Validation errors:",d);const u={};return d.forEach(h=>{u[h.field]=h.message}),t({validationErrors:u,error:"Please fix validation errors",balanceSheet:null}),{success:!1,error:"Validation failed"}}t({validationErrors:{},loading:!0,error:null});try{const u=await rL.getBalanceSheet(o.companyId,i,l,c);if(!u.success)return t({error:u.error||"Failed to load balance sheet",balanceSheet:null,loading:!1}),{success:!1,error:u.error};if(u.data){const h=Zc.validateBalanceEquation(u.data.totalAssets,u.data.totalLiabilitiesAndEquity);h.valid||console.warn(" Balance equation warning:",h.message)}return t({balanceSheet:u.data||null,loading:!1}),{success:!0}}catch(u){const h=u instanceof Error?u.message:"An unexpected error occurred";return t({error:h,balanceSheet:null,loading:!1}),{success:!1,error:h}}},refresh:async()=>{await e().loadBalanceSheet()},reset:()=>{t({storeId:null,startDate:bu(),endDate:wu(),balanceSheet:null,loading:!1,error:null,validationErrors:{}})},clearFilters:()=>{t({storeId:null,startDate:bu(),endDate:wu(),validationErrors:{}})}})),ux=()=>{const t=cr(m=>m.companyId),e=cr(m=>m.storeId),r=cr(m=>m.startDate),s=cr(m=>m.endDate),n=cr(m=>m.balanceSheet),o=cr(m=>m.loading),i=cr(m=>m.error),l=cr(m=>m.validationErrors),c=cr(m=>m.setCompanyId),d=cr(m=>m.setStoreId),u=cr(m=>m.setDateRange),h=cr(m=>m.setStartDate),f=cr(m=>m.setEndDate),p=cr(m=>m.loadBalanceSheet),g=cr(m=>m.refresh),y=cr(m=>m.reset),x=cr(m=>m.clearFilters);return{companyId:t,storeId:e,startDate:r,endDate:s,balanceSheet:n,loading:o,error:i,validationErrors:l,setCompanyId:c,setStoreId:d,setDateRange:u,setStartDate:h,setEndDate:f,loadBalanceSheet:p,refresh:g,reset:y,clearFilters:x,changeStore:d,changeDateRange:u}},sL="_storeSelector_9mu2c_12",nL="_disabled_9mu2c_18",oL="_control_9mu2c_24",aL="_open_9mu2c_43",iL="_controlIcon_9mu2c_49",lL="_controlLabel_9mu2c_56",cL="_controlArrow_9mu2c_66",dL="_dropdown_9mu2c_79",uL="_active_9mu2c_97",hL="_option_9mu2c_123",fL="_selected_9mu2c_138",mL="_optionIcon_9mu2c_147",pL="_optionText_9mu2c_158",gL="_checkmarkIcon_9mu2c_173",_L="_emptyState_9mu2c_182",Ht={storeSelector:sL,disabled:nL,control:oL,open:aL,controlIcon:iL,controlLabel:lL,controlArrow:cL,dropdown:dL,active:uL,option:hL,selected:fL,optionIcon:mL,optionText:pL,checkmarkIcon:gL,emptyState:_L},Hs=({stores:t,selectedStoreId:e,onStoreSelect:r,companyId:s,width:n="280px",maxHeight:o="380px",className:i="",showAllStoresOption:l=!0,allStoresLabel:c="All Stores",disabled:d=!1})=>{const[u,h]=b.useState(!1),f=b.useRef(null);b.useEffect(()=>{const m=_=>{f.current&&!f.current.contains(_.target)&&h(!1)};return u&&document.addEventListener("mousedown",m),()=>{document.removeEventListener("mousedown",m)}},[u]);const p=(m,_)=>{_==null||_.stopPropagation(),r(m),h(!1)},g=()=>{d||h(!u)},y=()=>{if(!e)return c;const m=t.find(_=>_.store_id===e);return(m==null?void 0:m.store_name)||c},x=t&&t.length>0;return a.jsxs("div",{ref:f,className:`${Ht.storeSelector} ${d?Ht.disabled:""} ${i}`,style:{"--store-selector-width":n,"--store-selector-max-height":o},children:[a.jsxs("div",{className:`${Ht.control} ${u?Ht.open:""}`,onClick:g,children:[a.jsx("svg",{className:Ht.controlIcon,fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M10,20V14H14V20H19V12H22L12,3L2,12H5V20H10Z"})}),a.jsx("span",{className:Ht.controlLabel,children:y()}),a.jsx("svg",{className:Ht.controlArrow,fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M7.41,8.58L12,13.17L16.59,8.58L18,10L12,16L6,10L7.41,8.58Z"})})]}),a.jsxs("div",{className:`${Ht.dropdown} ${u?Ht.active:""}`,children:[!x&&a.jsx("div",{className:Ht.emptyState,children:"No stores available"}),x&&a.jsxs(a.Fragment,{children:[l&&a.jsxs("div",{className:`${Ht.option} ${e?"":Ht.selected}`,onClick:m=>p(null,m),children:[a.jsx("svg",{className:Ht.optionIcon,fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M10,20V14H14V20H19V12H22L12,3L2,12H5V20H10Z"})}),a.jsx("span",{className:Ht.optionText,children:c}),!e&&a.jsx("svg",{className:Ht.checkmarkIcon,fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M9,20.42L2.79,14.21L5.62,11.38L9,14.77L18.88,4.88L21.71,7.71L9,20.42Z"})})]}),t.map(m=>{const _=e===m.store_id;return a.jsxs("div",{className:`${Ht.option} ${_?Ht.selected:""}`,onClick:v=>p(m.store_id,v),children:[a.jsx("svg",{className:Ht.optionIcon,fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M10,20V14H14V20H19V12H22L12,3L2,12H5V20H10Z"})}),a.jsx("span",{className:Ht.optionText,children:m.store_name}),_&&a.jsx("svg",{className:Ht.checkmarkIcon,fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M9,20.42L2.79,14.21L5.62,11.38L9,14.77L18.88,4.88L21.71,7.71L9,20.42Z"})})]},m.store_id)})]})]})]})},Es=()=>{const[t,e]=b.useState({variant:"error",message:"",isOpen:!1}),r=b.useCallback(()=>{e(c=>({...c,isOpen:!1}))},[]),s=b.useCallback((c,d)=>{e({variant:c,...d,isOpen:!0})},[]),n=b.useCallback(c=>{s("error",c)},[s]),o=b.useCallback(c=>{s("warning",c)},[s]),i=b.useCallback(c=>{s("info",c)},[s]),l=b.useCallback(c=>{s("success",c)},[s]);return{messageState:t,closeMessage:r,showError:n,showWarning:o,showInfo:i,showSuccess:l}},yL="_filterContainer_19r4t_3",vL="_filterHeader_19r4t_13",xL="_filterTitle_19r4t_21",bL="_filterContent_19r4t_34",wL="_filterRow_19r4t_38",SL="_filterField_19r4t_46",CL="_filterLabel_19r4t_54",jL="_dateInput_19r4t_62",kL="_filterActions_19r4t_85",Br={filterContainer:yL,filterHeader:vL,filterTitle:xL,filterContent:bL,filterRow:wL,filterField:SL,filterLabel:CL,dateInput:jL,filterActions:kL},NL=({stores:t=[],companyId:e,onSearch:r,onClear:s})=>{const{messageState:n,closeMessage:o,showWarning:i}=Es(),{storeId:l,startDate:c,endDate:d,setStoreId:u,setStartDate:h,setEndDate:f}=ux(),p=()=>{const y=Zc.validateDateRange(c,d);if(y){i({title:"Invalid Date Range",message:y.message,confirmText:"OK"});return}if(l){const x=Zc.validateStoreId(l);if(x){i({title:"Invalid Store",message:x.message,confirmText:"OK"});return}}r({storeId:l,startDate:c||null,endDate:d||null})},g=()=>{s()};return a.jsxs("div",{className:Br.filterContainer,children:[a.jsx("div",{className:Br.filterHeader,children:a.jsxs("div",{className:Br.filterTitle,children:[a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"})}),a.jsx("span",{children:"Search Balance Sheet"})]})}),a.jsxs("div",{className:Br.filterContent,children:[a.jsxs("div",{className:Br.filterRow,children:[a.jsxs("div",{className:Br.filterField,children:[a.jsx("label",{className:Br.filterLabel,children:"STORE"}),a.jsx(Hs,{stores:t,selectedStoreId:l,onStoreSelect:u,companyId:e||"",showAllStoresOption:!0,allStoresLabel:"All Stores",width:"100%"})]}),a.jsxs("div",{className:Br.filterField,children:[a.jsx("label",{className:Br.filterLabel,children:"FROM DATE"}),a.jsx("input",{type:"date",className:Br.dateInput,value:c||"",onChange:y=>h(y.target.value)})]}),a.jsxs("div",{className:Br.filterField,children:[a.jsx("label",{className:Br.filterLabel,children:"TO DATE"}),a.jsx("input",{type:"date",className:Br.dateInput,value:d||"",onChange:y=>f(y.target.value)})]})]}),a.jsxs("div",{className:Br.filterActions,children:[a.jsx(be,{onClick:g,variant:"secondary",children:"Clear All"}),a.jsxs(be,{onClick:p,variant:"primary",children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"11",cy:"11",r:"8"}),a.jsx("path",{d:"m21 21-4.35-4.35"})]}),"Search"]})]})]}),a.jsx(De,{variant:n.variant,title:n.title,message:n.message,isOpen:n.isOpen,onClose:o,confirmText:n.confirmText||"OK"})]})},IL="_pageContainer_lwevr_7",EL="_pageContent_lwevr_13",TL="_pageHeader_lwevr_20",AL="_pageTitle_lwevr_24",LL="_pageSubtitle_lwevr_31",DL="_contentCard_lwevr_39",ML="_emptyState_lwevr_49",RL="_emptyIcon_lwevr_58",OL="_emptyTitle_lwevr_64",PL="_emptyText_lwevr_71",$L="_loadingState_lwevr_80",FL="_spinner_lwevr_87",BL="_errorContainer_lwevr_104",HL="_errorIcon_lwevr_114",VL="_errorTitle_lwevr_121",zL="_errorMessage_lwevr_128",UL="_summaryCards_lwevr_137",WL="_summaryCard_lwevr_137",qL="_assets_lwevr_157",GL="_liabilities_lwevr_162",JL="_equity_lwevr_167",KL="_summaryCardLabel_lwevr_172",YL="_summaryCardValue_lwevr_181",QL="_summaryCardPercent_lwevr_190",ZL="_balanceSheetColumns_lwevr_197",XL="_sectionCard_lwevr_211",eD="_sectionHeader_lwevr_220",tD="_sectionTitle_lwevr_229",rD="_sectionTotal_lwevr_238",sD="_accountList_lwevr_247",nD="_accountItem_lwevr_253",oD="_accountName_lwevr_266",aD="_accountBalance_lwevr_272",oe={pageContainer:IL,pageContent:EL,pageHeader:TL,pageTitle:AL,pageSubtitle:LL,contentCard:DL,emptyState:ML,emptyIcon:RL,emptyTitle:OL,emptyText:PL,loadingState:$L,spinner:FL,errorContainer:BL,errorIcon:HL,errorTitle:VL,errorMessage:zL,summaryCards:UL,summaryCard:WL,assets:qL,liabilities:GL,equity:JL,summaryCardLabel:KL,summaryCardValue:YL,summaryCardPercent:QL,balanceSheetColumns:ZL,sectionCard:XL,sectionHeader:eD,sectionTitle:tD,sectionTotal:rD,accountList:sD,accountItem:nD,accountName:oD,accountBalance:aD},iD=()=>{const{currentCompany:t}=at(),e=(t==null?void 0:t.company_id)||"",{balanceSheet:r,loading:s,error:n,setCompanyId:o,setDateRange:i,setStoreId:l,loadBalanceSheet:c,clearFilters:d}=ux();b.useEffect(()=>{e&&o(e)},[e]);const u=p=>{console.log("Searching with filters:",p),l(p.storeId),i(p.startDate,p.endDate),c(p.storeId,p.startDate,p.endDate)},h=()=>{console.log("Filters cleared"),d()},f=p=>!p||p.accounts.length===0?a.jsx("div",{className:oe.emptyState,children:a.jsx("p",{children:"No accounts in this section"})}):a.jsx("div",{className:oe.accountList,children:p.accounts.map(g=>a.jsxs("div",{className:oe.accountItem,children:[a.jsx("span",{className:oe.accountName,children:g.accountName}),a.jsx("span",{className:oe.accountBalance,children:g.formattedBalance})]},g.accountId))});return a.jsxs(a.Fragment,{children:[a.jsx(fe,{activeItem:"finance"}),a.jsx("div",{className:oe.pageContainer,children:a.jsxs("main",{className:oe.pageContent,children:[a.jsxs("div",{className:oe.pageHeader,children:[a.jsx("h1",{className:oe.pageTitle,children:"Balance Sheet"}),a.jsx("p",{className:oe.pageSubtitle,children:"View your company's financial position"})]}),a.jsx(NL,{stores:(t==null?void 0:t.stores)||[],companyId:e,onSearch:u,onClear:h}),a.jsxs("div",{className:oe.contentCard,children:[s&&a.jsx("div",{className:oe.loadingState,children:a.jsx("div",{className:oe.spinner,children:"Loading balance sheet..."})}),n&&!s&&a.jsxs("div",{className:oe.errorContainer,children:[a.jsxs("svg",{className:oe.errorIcon,width:"120",height:"120",viewBox:"0 0 120 120",fill:"none",children:[a.jsx("circle",{cx:"60",cy:"60",r:"50",fill:"#FFEFED"}),a.jsx("circle",{cx:"60",cy:"60",r:"30",fill:"#FF5847"}),a.jsx("path",{d:"M60 45 L60 65",stroke:"white",strokeWidth:"4",strokeLinecap:"round"}),a.jsx("circle",{cx:"60",cy:"73",r:"2.5",fill:"white"}),a.jsx("rect",{x:"40",y:"25",width:"40",height:"50",rx:"4",fill:"white",stroke:"#FF5847",strokeWidth:"2"}),a.jsx("line",{x1:"48",y1:"35",x2:"72",y2:"35",stroke:"#FFE5E5",strokeWidth:"2",strokeLinecap:"round"}),a.jsx("line",{x1:"48",y1:"42",x2:"65",y2:"42",stroke:"#FFE5E5",strokeWidth:"2",strokeLinecap:"round"})]}),a.jsx("h2",{className:oe.errorTitle,children:"Failed to Load Balance Sheet"}),a.jsx("p",{className:oe.errorMessage,children:n}),a.jsx(be,{onClick:()=>c(),variant:"primary",children:"Try Again"})]}),!r&&!s&&!n&&a.jsxs("div",{className:oe.emptyState,children:[a.jsxs("svg",{className:oe.emptyIcon,width:"120",height:"120",viewBox:"0 0 120 120",fill:"none",children:[a.jsx("circle",{cx:"60",cy:"60",r:"50",fill:"#F0F6FF"}),a.jsx("rect",{x:"35",y:"40",width:"50",height:"60",rx:"4",fill:"white",stroke:"#0064FF",strokeWidth:"2"}),a.jsx("rect",{x:"40",y:"35",width:"50",height:"60",rx:"4",fill:"white",stroke:"#0064FF",strokeWidth:"2"}),a.jsx("line",{x1:"48",y1:"45",x2:"75",y2:"45",stroke:"#E9ECEF",strokeWidth:"2",strokeLinecap:"round"}),a.jsx("line",{x1:"48",y1:"52",x2:"70",y2:"52",stroke:"#E9ECEF",strokeWidth:"2",strokeLinecap:"round"}),a.jsx("line",{x1:"48",y1:"59",x2:"72",y2:"59",stroke:"#E9ECEF",strokeWidth:"2",strokeLinecap:"round"}),a.jsx("circle",{cx:"60",cy:"75",r:"12",fill:"#0064FF"}),a.jsx("path",{d:"M54 75 L56 77 L62 71",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),a.jsx("h3",{className:oe.emptyTitle,children:"Select Filters to Load Balance Sheet"}),a.jsx("p",{className:oe.emptyText,children:"Choose your filters and click Search to view the balance sheet data."})]}),r&&!s&&!n&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:oe.summaryCards,children:[a.jsxs("div",{className:`${oe.summaryCard} ${oe.assets}`,children:[a.jsx("div",{className:oe.summaryCardLabel,children:"Total Assets"}),a.jsx("div",{className:oe.summaryCardValue,children:r.formatCurrency(r.totalAssets)}),a.jsx("div",{className:oe.summaryCardPercent,children:r.assetsPercentage})]}),a.jsxs("div",{className:`${oe.summaryCard} ${oe.liabilities}`,children:[a.jsx("div",{className:oe.summaryCardLabel,children:"Total Liabilities"}),a.jsx("div",{className:oe.summaryCardValue,children:r.formatCurrency(r.totalLiabilities)}),a.jsx("div",{className:oe.summaryCardPercent,children:r.liabilitiesPercentage})]}),a.jsxs("div",{className:`${oe.summaryCard} ${oe.equity}`,children:[a.jsx("div",{className:oe.summaryCardLabel,children:"Total Equity"}),a.jsx("div",{className:oe.summaryCardValue,children:r.formatCurrency(r.totalEquity)}),a.jsx("div",{className:oe.summaryCardPercent,children:r.equityPercentage})]})]}),a.jsxs("div",{className:oe.balanceSheetColumns,children:[a.jsxs("div",{children:[a.jsxs("div",{className:oe.sectionCard,children:[a.jsxs("div",{className:oe.sectionHeader,children:[a.jsx("h3",{className:oe.sectionTitle,children:r.currentAssets.title}),a.jsx("div",{className:oe.sectionTotal,children:r.formatCurrency(r.currentAssets.total)})]}),f(r.currentAssets)]}),a.jsxs("div",{className:oe.sectionCard,children:[a.jsxs("div",{className:oe.sectionHeader,children:[a.jsx("h3",{className:oe.sectionTitle,children:r.nonCurrentAssets.title}),a.jsx("div",{className:oe.sectionTotal,children:r.formatCurrency(r.nonCurrentAssets.total)})]}),f(r.nonCurrentAssets)]})]}),a.jsxs("div",{children:[a.jsxs("div",{className:oe.sectionCard,children:[a.jsxs("div",{className:oe.sectionHeader,children:[a.jsx("h3",{className:oe.sectionTitle,children:r.currentLiabilities.title}),a.jsx("div",{className:oe.sectionTotal,children:r.formatCurrency(r.currentLiabilities.total)})]}),f(r.currentLiabilities)]}),a.jsxs("div",{className:oe.sectionCard,children:[a.jsxs("div",{className:oe.sectionHeader,children:[a.jsx("h3",{className:oe.sectionTitle,children:r.nonCurrentLiabilities.title}),a.jsx("div",{className:oe.sectionTotal,children:r.formatCurrency(r.nonCurrentLiabilities.total)})]}),f(r.nonCurrentLiabilities)]}),a.jsxs("div",{className:oe.sectionCard,children:[a.jsxs("div",{className:oe.sectionHeader,children:[a.jsx("h3",{className:oe.sectionTitle,children:r.equity.title}),a.jsx("div",{className:oe.sectionTotal,children:r.formatCurrency(r.equity.total)})]}),f(r.equity)]}),r.comprehensiveIncome.accounts.length>0&&a.jsxs("div",{className:oe.sectionCard,children:[a.jsxs("div",{className:oe.sectionHeader,children:[a.jsx("h3",{className:oe.sectionTitle,children:r.comprehensiveIncome.title}),a.jsx("div",{className:oe.sectionTotal,children:r.formatCurrency(r.comprehensiveIncome.total)})]}),f(r.comprehensiveIncome)]})]})]}),!r.isBalanced&&a.jsxs("div",{style:{marginTop:"16px",padding:"12px",background:"#FEE",borderRadius:"8px",color:"#C00"},children:[" Warning: Balance sheet equation not satisfied. Difference:"," ",r.formatCurrency(Math.abs(r.balanceDifference))]})]})]})]})})]})};function ql(t){return t.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:2})}function Gl(t){return t==null||t===0?"0 ":t.toLocaleString("vi-VN")+" "}function lD(t){return new Date(t).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}function cD(t){if(!t)return"";switch(t.toLowerCase()){case"fixedasset":return"Fixed Asset";default:return t.charAt(0).toUpperCase()+t.slice(1)}}function dD(t){return{USD:"$",EUR:"",GBP:"",JPY:"",KRW:"",CNY:"",INR:"",AUD:"A$",CAD:"C$",CHF:"Fr",HKD:"HK$",SGD:"S$",SEK:"kr",NOK:"kr",DKK:"kr",NZD:"NZ$",MXN:"Mex$",TRY:"",RUB:"",BRL:"R$",ZAR:"R"}[t]||t+" "}class uD{async getCashLocations(e){const r=ne.getClient(),{data:s,error:n}=await r.from("cash_locations").select("cash_location_id, store_id, location_name, location_type").eq("company_id",e).eq("is_deleted",!1);if(n)throw console.error("Error fetching cash locations:",n),new Error(n.message);return s||[]}async getBalanceAndActualAmounts(e,r){const s=ne.getClient(),n={p_company_id:e};r&&(n.p_store_id=r);const{data:o,error:i}=await s.rpc("get_cash_balance_amounts",n);if(i)throw console.error("Error fetching balance amounts:",i),new Error(i.message);return o}async createJournalEntry(e){try{const r=ne.getClient();if(!r)return{success:!1,error:"Supabase client not available"};const{data:s,error:n}=await r.rpc("insert_journal_with_everything",e);return n?(console.error("RPC Error:",n),{success:!1,error:n.message||"Failed to create journal entry"}):{success:!0,data:s}}catch(r){const s=r instanceof Error?r.message:"Unknown error occurred";return console.error("Error in createJournalEntry:",r),{success:!1,error:s}}}}class Su{constructor(e,r,s,n,o,i,l,c,d,u,h,f,p){this.cashEndingId=e,this.locationId=r,this.locationName=s,this.storeId=n,this.date=o,this.openingBalance=i,this.totalInflow=l,this.totalOutflow=c,this.expectedBalance=d,this.actualBalance=u,this.difference=h,this.status=f,this.currencySymbol=p}get isBalanced(){return Math.abs(this.difference)<.01}get statusDisplay(){switch(this.status){case"pending":return"Pending";case"completed":return"Completed";case"verified":return"Verified";default:return this.status}}formatCurrency(e){return`${this.currencySymbol}${e.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})}`}get formattedDate(){const[e,r,s]=this.date.split("-").map(Number);return new Date(e,r-1,s).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}}class E_{static fromLocation(e,r,s){const n=(r==null?void 0:r.balance_amount)||0,o=(s==null?void 0:s.actual_amount)||0,i=o-n,l=s?"completed":"pending";return new Su(e.cash_location_id,e.cash_location_id,e.location_name,e.store_id,te.toDateOnly(new Date),0,n,0,n,o,i,l,"")}static fromRpcResult(e){const r=e.date?te.toDateOnly(te.toLocal(e.date)):te.toDateOnly(new Date);return new Su(e.cash_ending_id||e.cash_location_id,e.location_id||e.cash_location_id,e.location_name,e.store_id,r,e.opening_balance||0,e.total_inflow||0,e.total_outflow||0,e.expected_balance||0,e.actual_balance||0,e.difference||0,e.status||"pending",e.currency_symbol||"")}static toDto(e){return{cash_ending_id:e.cashEndingId,location_id:e.locationId,location_name:e.locationName,store_id:e.storeId,date:e.date,opening_balance:e.openingBalance,total_inflow:e.totalInflow,total_outflow:e.totalOutflow,expected_balance:e.expectedBalance,actual_balance:e.actualBalance,difference:e.difference,status:e.status,currency_symbol:e.currencySymbol}}static fromLocationList(e,r,s){return e.map(n=>{const o=r.find(l=>l.cash_location_id===n.cash_location_id),i=s.find(l=>l.cash_location_id===n.cash_location_id);return this.fromLocation(n,o,i)})}static parseBalanceActualResponse(e){let r=[],s=[];return e?(e.success&&e.data?(r=e.data.balance||[],s=e.data.actual||[]):(e.balance||e.actual)&&(r=e.balance||[],s=e.actual||[]),{balance:r,actual:s}):{balance:r,actual:s}}static create(e){return new Su(e.cash_ending_id||"",e.location_id||"",e.location_name||"",e.store_id||null,e.date||te.toDateOnly(new Date),e.opening_balance||0,e.total_inflow||0,e.total_outflow||0,e.expected_balance||0,e.actual_balance||0,e.difference||0,e.status||"pending",e.currency_symbol||"")}}const Cu={CASH:"d4a7a16e-45a1-47fe-992b-ff807c8673f0",MAKE_ERROR:"a45fac5d-010c-4b1b-92e9-ddcf8f3222bf",EXCHANGE_RATE_DIFFERENCE:"80b311db-f548-46e3-9854-67c5ff6766e8"};class hD{constructor(){W(this,"dataSource");this.dataSource=new uD}async getCashEndings(e,r){try{const s=await this.dataSource.getCashLocations(e),n=await this.dataSource.getBalanceAndActualAmounts(e,r);console.log("Cash locations:",s),console.log("Balance data:",n);const{balance:o,actual:i}=E_.parseBalanceActualResponse(n);return{success:!0,data:E_.fromLocationList(s,o,i)}}catch(s){return console.error("Repository error fetching cash endings:",s),{success:!1,error:s instanceof Error?s.message:"Failed to fetch cash endings"}}}async createJournalEntry(e){const{companyId:r,userId:s,storeId:n,cashLocationId:o,difference:i,type:l}=e;try{const c=new Date,d=te.toRpcFormat(c),u=l==="error"?`Make Error ${d}`:`Exchange Rate Difference ${d}`,h=Math.abs(i),f=Cu.CASH,p=Cu.MAKE_ERROR,g=Cu.EXCHANGE_RATE_DIFFERENCE,y=l==="error"?p:g,x=[];i>0?(x.push({account_id:f,description:u,debit:h,credit:0,cash:{cash_location_id:o}}),x.push({account_id:y,description:u,debit:0,credit:h})):(x.push({account_id:f,description:u,debit:0,credit:h,cash:{cash_location_id:o}}),x.push({account_id:y,description:u,debit:h,credit:0}));const m={p_base_amount:h,p_company_id:r,p_created_by:s,p_description:u,p_entry_date:d,p_lines:x,p_store_id:n};console.log("Calling insert_journal_with_everything with params:",m);const _=await this.dataSource.createJournalEntry(m);return _.success?(console.log("Journal entry created successfully:",_.data),{success:!0}):{success:!1,error:_.error}}catch(c){const d=c instanceof Error?c.message:"Unknown error occurred";return console.error("Error in createJournalEntry:",c),{success:!1,error:d}}}}class fD{static validateCompanyId(e){return!e||e.trim()===""?{field:"companyId",message:"Company ID is required"}:/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e)?null:{field:"companyId",message:"Company ID must be a valid UUID"}}static validateUserId(e){return!e||e.trim()===""?{field:"userId",message:"User ID is required"}:/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e)?null:{field:"userId",message:"User ID must be a valid UUID"}}static validateCashLocationId(e){return!e||e.trim()===""?{field:"cashLocationId",message:"Cash location ID is required"}:/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e)?null:{field:"cashLocationId",message:"Cash location ID must be a valid UUID"}}static validateDifference(e){return e==null?{field:"difference",message:"Difference amount is required"}:typeof e!="number"||isNaN(e)?{field:"difference",message:"Difference must be a valid number"}:e===0?{field:"difference",message:"Difference cannot be zero"}:null}static validateType(e){return!e||e.trim()===""?{field:"type",message:"Journal entry type is required"}:e!=="error"&&e!=="exchange"?{field:"type",message:'Type must be either "error" or "exchange"'}:null}static validateAccountId(e,r="accountId"){return!e||e.trim()===""?{field:r,message:`${r} is required`}:/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e)?null:{field:r,message:`${r} must be a valid UUID`}}static validateJournalParams(e){const r=[],s=this.validateCompanyId(e.companyId);s&&r.push(s);const n=this.validateUserId(e.userId);n&&r.push(n);const o=this.validateCashLocationId(e.cashLocationId);o&&r.push(o);const i=this.validateDifference(e.difference);i&&r.push(i);const l=this.validateType(e.type);return l&&r.push(l),r}static validateJournalLine(e){const r=[],s=this.validateAccountId(e.account_id,"account_id");return s&&r.push(s),(!e.description||e.description.trim()==="")&&r.push({field:"description",message:"Description is required"}),(typeof e.debit!="number"||isNaN(e.debit)||e.debit<0)&&r.push({field:"debit",message:"Debit must be a non-negative number"}),(typeof e.credit!="number"||isNaN(e.credit)||e.credit<0)&&r.push({field:"credit",message:"Credit must be a non-negative number"}),e.debit>0&&e.credit>0&&r.push({field:"debit_credit",message:"A line cannot have both debit and credit amounts"}),e.debit===0&&e.credit===0&&r.push({field:"debit_credit",message:"Either debit or credit must be greater than zero"}),r}static isBalanced(e){const r=e.reduce((n,o)=>n+o.debit,0),s=e.reduce((n,o)=>n+o.credit,0);return Math.abs(r-s)<.01}}const T_=new hD,Jl={isOpen:!1,type:null,locationId:null,locationName:"",storeId:null,difference:0},Er=Jt((t,e)=>({cashEndings:[],selectedDate:te.toDateOnly(new Date),companyId:"",storeId:null,isLoading:!1,isCreatingJournal:!1,error:null,journalError:null,modalState:Jl,setCashEndings:r=>t({cashEndings:r}),setSelectedDate:r=>t({selectedDate:r}),setCompanyId:r=>t({companyId:r}),setStoreId:r=>t({storeId:r}),setLoading:r=>t({isLoading:r}),setCreatingJournal:r=>t({isCreatingJournal:r}),setError:r=>t({error:r}),setJournalError:r=>t({journalError:r}),clearErrors:()=>t({error:null,journalError:null}),openErrorModal:r=>{t({modalState:{isOpen:!0,type:"error",locationId:r.locationId,locationName:r.locationName,storeId:r.storeId,difference:r.difference}})},openExchangeModal:r=>{t({modalState:{isOpen:!0,type:"exchange",locationId:r.locationId,locationName:r.locationName,storeId:r.storeId,difference:r.difference}})},closeModal:()=>{t({modalState:Jl})},resetModal:()=>{t({modalState:Jl})},loadCashEndings:async(r,s)=>{t({isLoading:!0,error:null});try{const n=await T_.getCashEndings(r,s);return n.success?(t({cashEndings:n.data||[],companyId:r,storeId:s,error:null,isLoading:!1}),{success:!0}):(t({error:n.error||"Failed to load cash endings",cashEndings:[],isLoading:!1}),{success:!1,error:n.error||"Failed to load cash endings"})}catch(n){const o=n instanceof Error?n.message:"An unexpected error occurred";return t({error:o,cashEndings:[],isLoading:!1}),{success:!1,error:o}}},refresh:async()=>{const r=e();return await r.loadCashEndings(r.companyId,r.storeId)},createJournalEntry:async r=>{t({isCreatingJournal:!0,journalError:null});try{const s=fD.validateJournalParams(r);if(s.length>0){const o=s.map(i=>i.message).join(", ");return t({journalError:o,isCreatingJournal:!1}),{success:!1,error:o}}const n=await T_.createJournalEntry(r);return n.success?(t({isCreatingJournal:!1,journalError:null}),{success:!0}):(t({journalError:n.error||"Failed to create journal entry",isCreatingJournal:!1}),{success:!1,error:n.error||"Failed to create journal entry"})}catch(s){const n=s instanceof Error?s.message:"Unknown error occurred";return console.error("Error in createJournalEntry:",s),t({journalError:n,isCreatingJournal:!1}),{success:!1,error:n}}},reset:()=>{t({cashEndings:[],selectedDate:te.toDateOnly(new Date),companyId:"",storeId:null,isLoading:!1,isCreatingJournal:!1,error:null,journalError:null,modalState:Jl})}})),mD=(t,e)=>{const r=Er(u=>u.cashEndings),s=Er(u=>u.isLoading),n=Er(u=>u.error),o=Er(u=>u.selectedDate),i=Er(u=>u.setSelectedDate),l=Er(u=>u.loadCashEndings),c=Er(u=>u.refresh);b.useEffect(()=>{t&&l(t,e)},[t,e,l]);const d=b.useCallback(u=>{i(u)},[i]);return{cashEndings:r,loading:s,error:n,selectedDate:o,changeDate:d,refresh:c}},pD=()=>{const t=Er(s=>s.isCreatingJournal),e=Er(s=>s.journalError);return{createJournalEntry:Er(s=>s.createJournalEntry),isLoading:t,error:e}},gD=()=>{const t=Er(o=>o.modalState),e=Er(o=>o.openErrorModal),r=Er(o=>o.openExchangeModal),s=Er(o=>o.closeModal),n=Er(o=>o.resetModal);return{modalState:t,openErrorModal:e,openExchangeModal:r,closeModal:s,resetModal:n}},_D="_container_1xgpa_5",yD="_header_1xgpa_14",vD="_title_1xgpa_18",xD="_subtitle_1xgpa_25",bD="_cashEndingContainer_1xgpa_33",wD="_comparisonSplit_1xgpa_43",SD="_comparisonHeaders_1xgpa_48",CD="_headerBalance_1xgpa_54",jD="_headerActual_1xgpa_55",kD="_headerIcon_1xgpa_73",ND="_headerContent_1xgpa_78",ID="_headerTitle_1xgpa_82",ED="_headerSubtitle_1xgpa_89",TD="_comparisonRows_1xgpa_97",AD="_comparisonRow_1xgpa_97",LD="_balanceCard_1xgpa_118",DD="_actualCard_1xgpa_119",MD="_notSet_1xgpa_132",RD="_locationHeader_1xgpa_136",OD="_locationIconWrap_1xgpa_144",PD="_locationDetails_1xgpa_159",$D="_locationName_1xgpa_164",FD="_locationType_1xgpa_175",BD="_notSetLabel_1xgpa_182",HD="_balanceAmount_1xgpa_187",VD="_actualAmountDisplay_1xgpa_198",zD="_pending_1xgpa_209",UD="_emptyState_1xgpa_215",WD="_emptyIcon_1xgpa_222",qD="_emptyTitle_1xgpa_229",GD="_emptyText_1xgpa_236",JD="_errorContainer_1xgpa_243",KD="_errorIcon_1xgpa_253",YD="_errorTitle_1xgpa_260",QD="_errorMessage_1xgpa_267",ZD="_differenceSection_1xgpa_275",XD="_differenceHeader_1xgpa_284",eM="_sectionIcon_1xgpa_293",tM="_differenceTitle_1xgpa_297",rM="_differenceSubtitle_1xgpa_304",sM="_differenceItems_1xgpa_311",nM="_differenceItem_1xgpa_311",oM="_differenceLocationName_1xgpa_335",aM="_differenceAmountActions_1xgpa_341",iM="_differenceAmount_1xgpa_341",lM="_differencePositive_1xgpa_357",cM="_differenceNegative_1xgpa_361",dM="_differenceZero_1xgpa_365",uM="_actionButtonsSimple_1xgpa_370",hM="_actionBtnSimple_1xgpa_375",fM="_errorBtnSimple_1xgpa_405",mM="_exchangeBtnSimple_1xgpa_420",ee={container:_D,header:yD,title:vD,subtitle:xD,cashEndingContainer:bD,comparisonSplit:wD,comparisonHeaders:SD,headerBalance:CD,headerActual:jD,headerIcon:kD,headerContent:ND,headerTitle:ID,headerSubtitle:ED,comparisonRows:TD,comparisonRow:AD,balanceCard:LD,actualCard:DD,notSet:MD,locationHeader:RD,locationIconWrap:OD,locationDetails:PD,locationName:$D,locationType:FD,notSetLabel:BD,balanceAmount:HD,actualAmountDisplay:VD,pending:zD,emptyState:UD,emptyIcon:WD,emptyTitle:qD,emptyText:GD,errorContainer:JD,errorIcon:KD,errorTitle:YD,errorMessage:QD,differenceSection:ZD,differenceHeader:XD,sectionIcon:eM,differenceTitle:tM,differenceSubtitle:rM,differenceItems:sM,differenceItem:nM,differenceLocationName:oM,differenceAmountActions:aM,differenceAmount:iM,differencePositive:lM,differenceNegative:cM,differenceZero:dM,actionButtonsSimple:uM,actionBtnSimple:hM,errorBtnSimple:fM,exchangeBtnSimple:mM},A_=t=>{switch(t){case"bank":return a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:[a.jsx("path",{d:"M12 4L4 8V9H20V9L12 4Z",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"}),a.jsx("rect",{x:"6",y:"10",width:"2",height:"6",stroke:"currentColor",strokeWidth:"2"}),a.jsx("rect",{x:"11",y:"10",width:"2",height:"6",stroke:"currentColor",strokeWidth:"2"}),a.jsx("rect",{x:"16",y:"10",width:"2",height:"6",stroke:"currentColor",strokeWidth:"2"}),a.jsx("rect",{x:"4",y:"17",width:"16",height:"2",fill:"currentColor"})]});case"vault":return a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:[a.jsx("rect",{x:"5",y:"5",width:"16",height:"16",rx:"2",stroke:"currentColor",strokeWidth:"2.5"}),a.jsx("circle",{cx:"12",cy:"12",r:"3",stroke:"currentColor",strokeWidth:"2"}),a.jsx("circle",{cx:"12",cy:"12",r:"1",fill:"currentColor"})]});case"cash":default:return a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:[a.jsx("ellipse",{cx:"12",cy:"8",rx:"6",ry:"2.5",stroke:"currentColor",strokeWidth:"2.5"}),a.jsx("path",{d:"M6 8V12C6 13.1 8.686 14 12 14C15.314 14 18 13.1 18 12V8",stroke:"currentColor",strokeWidth:"2.5"}),a.jsx("path",{d:"M6 12V16C6 17.1 8.686 18 12 18C15.314 18 18 17.1 18 16V12",stroke:"currentColor",strokeWidth:"2.5"})]})}},L_=t=>{switch(t){case"bank":return"#E3F2FD";case"vault":return"#FFF3E0";case"cash":return"#E8F5E9";default:return"#F5F5F5"}},D_=t=>{switch(t){case"bank":return"#1976D2";case"vault":return"#F57C00";case"cash":return"#2E7D32";default:return"#616161"}},pM=()=>{const{currentCompany:t,currentStore:e,setCurrentStore:r,currentUser:s}=at(),n=(t==null?void 0:t.company_id)||"",o=(e==null?void 0:e.store_id)||null,{cashEndings:i,loading:l,error:c,refresh:d}=mD(n,o),{createJournalEntry:u,isLoading:h,error:f}=pD(),{modalState:p,openErrorModal:g,openExchangeModal:y,closeModal:x}=gD(),{messageState:m,closeMessage:_,showError:v,showSuccess:w}=Es(),S=k=>{var N;if(!k)r(null);else{const I=(N=t==null?void 0:t.stores)==null?void 0:N.find(L=>L.store_id===k);I&&r(I)}},E=async()=>{if(!p.type||!p.locationId){console.error("Missing modal state data");return}const k=s==null?void 0:s.user_id;if(!n||!k){console.error("Missing company ID or user ID"),v({title:"Session Error",message:"Missing required session data. Please refresh the page."});return}const N=await u({companyId:n,userId:k,storeId:p.storeId,cashLocationId:p.locationId,difference:p.difference,type:p.type});N.success?(x(),w({message:p.type==="error"?"Error entry created successfully":"Exchange rate entry created successfully",autoCloseDuration:3e3}),d()):v({title:"Creation Failed",message:N.error||f||"Failed to create journal entry. Please try again."})};if(!t)return a.jsxs(a.Fragment,{children:[a.jsx(fe,{activeItem:"finance"}),a.jsxs("div",{className:ee.container,children:[a.jsxs("div",{className:ee.header,children:[a.jsx("h1",{className:ee.title,children:"Cash Ending"}),a.jsx("p",{className:ee.subtitle,children:"Manage daily cash ending processes and records"})]}),a.jsx(Ne,{fullscreen:!0,size:"large"})]})]});if(l)return a.jsxs(a.Fragment,{children:[a.jsx(fe,{activeItem:"finance"}),a.jsxs("div",{className:ee.container,children:[a.jsxs("div",{className:ee.header,children:[a.jsx("h1",{className:ee.title,children:"Cash Ending"}),a.jsx("p",{className:ee.subtitle,children:"Manage daily cash ending processes and records"})]}),a.jsx(Ne,{fullscreen:!0,size:"large"})]})]});if(c)return a.jsxs(a.Fragment,{children:[a.jsx(fe,{activeItem:"finance"}),a.jsxs("div",{className:ee.container,children:[a.jsxs("div",{className:ee.header,children:[a.jsx("h1",{className:ee.title,children:"Cash Ending"}),a.jsx("p",{className:ee.subtitle,children:"Manage daily cash ending processes and records"})]}),a.jsxs("div",{className:ee.errorContainer,children:[a.jsxs("svg",{className:ee.errorIcon,width:"120",height:"120",viewBox:"0 0 120 120",fill:"none",children:[a.jsx("circle",{cx:"60",cy:"60",r:"50",fill:"#FFEFED"}),a.jsx("circle",{cx:"60",cy:"60",r:"30",fill:"#FF5847"}),a.jsx("path",{d:"M60 45 L60 65",stroke:"white",strokeWidth:"4",strokeLinecap:"round"}),a.jsx("circle",{cx:"60",cy:"73",r:"2.5",fill:"white"}),a.jsx("rect",{x:"40",y:"25",width:"40",height:"50",rx:"4",fill:"white",stroke:"#FF5847",strokeWidth:"2"}),a.jsx("line",{x1:"48",y1:"35",x2:"72",y2:"35",stroke:"#FFE5E5",strokeWidth:"2",strokeLinecap:"round"}),a.jsx("line",{x1:"48",y1:"42",x2:"65",y2:"42",stroke:"#FFE5E5",strokeWidth:"2",strokeLinecap:"round"})]}),a.jsx("h2",{className:ee.errorTitle,children:"Failed to Load Cash Endings"}),a.jsx("p",{className:ee.errorMessage,children:c})]})]})]});const C=[...i].sort((k,N)=>{const I={cash:1,bank:2,vault:3},L=i.find(O=>O.locationId===k.locationId)||k,T=i.find(O=>O.locationId===N.locationId)||N,j=O=>O.toLowerCase().includes("bank")?"bank":O.toLowerCase().includes("vault")?"vault":"cash",M=I[j(L.locationName)]||999,R=I[j(T.locationName)]||999;return M!==R?M-R:k.locationName.localeCompare(N.locationName)});return a.jsxs(a.Fragment,{children:[a.jsx(fe,{activeItem:"finance"}),a.jsxs("div",{className:ee.container,children:[a.jsxs("div",{className:ee.header,children:[a.jsx("h1",{className:ee.title,children:"Cash Ending"}),a.jsx("p",{className:ee.subtitle,children:"Manage daily cash ending processes and records"})]}),a.jsx("div",{style:{marginBottom:"24px"},children:a.jsx(Hs,{stores:(t==null?void 0:t.stores)||[],selectedStoreId:o,onStoreSelect:S,companyId:n,width:"280px",showAllStoresOption:!0,allStoresLabel:"All Stores"})}),i.length===0?a.jsxs("div",{className:ee.emptyState,children:[a.jsxs("svg",{className:ee.emptyIcon,width:"120",height:"120",viewBox:"0 0 120 120",fill:"none",children:[a.jsx("circle",{cx:"60",cy:"60",r:"50",fill:"#F0F6FF"}),a.jsx("ellipse",{cx:"60",cy:"45",rx:"25",ry:"8",fill:"white",stroke:"#0064FF",strokeWidth:"2"}),a.jsx("path",{d:"M35 45 V55 C35 58 45 61 60 61 C75 61 85 58 85 55 V45",fill:"white",stroke:"#0064FF",strokeWidth:"2"}),a.jsx("path",{d:"M35 55 V65 C35 68 45 71 60 71 C75 71 85 68 85 65 V55",fill:"white",stroke:"#0064FF",strokeWidth:"2"}),a.jsx("circle",{cx:"60",cy:"80",r:"12",fill:"#0064FF"}),a.jsx("path",{d:"M58 74 L58 86 M62 74 L62 86 M56 77 L60 77 C61.5 77 63 78 63 80 C63 82 61.5 83 60 83 L56 83 M60 83 L64 83 C65.5 83 67 82 67 80",stroke:"white",strokeWidth:"2",strokeLinecap:"round"})]}),a.jsx("h3",{className:ee.emptyTitle,children:"No Cash Endings"}),a.jsx("p",{className:ee.emptyText,children:"No cash ending records found for the selected period"})]}):a.jsxs("div",{className:ee.cashEndingContainer,children:[a.jsxs("div",{className:ee.comparisonSplit,children:[a.jsxs("div",{className:ee.comparisonHeaders,children:[a.jsxs("div",{className:ee.headerBalance,children:[a.jsxs("svg",{className:ee.headerIcon,width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",children:[a.jsx("rect",{x:"3",y:"10",width:"4",height:"11",rx:"1",fill:"currentColor"}),a.jsx("rect",{x:"10",y:"6",width:"4",height:"15",rx:"1",fill:"currentColor"}),a.jsx("rect",{x:"17",y:"13",width:"4",height:"8",rx:"1",fill:"currentColor"})]}),a.jsxs("div",{className:ee.headerContent,children:[a.jsx("div",{className:ee.headerTitle,children:"Balance"}),a.jsx("div",{className:ee.headerSubtitle,children:"Based on Balance Sheet"})]})]}),a.jsxs("div",{className:ee.headerActual,children:[a.jsxs("svg",{className:ee.headerIcon,width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",children:[a.jsx("path",{d:"M12 2L2 7V11C2 16.5 5.8 21.5 12 23C18.2 21.5 22 16.5 22 11V7L12 2Z",stroke:"currentColor",strokeWidth:"2",fill:"none"}),a.jsx("path",{d:"M9 12L11 14L15 10",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),a.jsxs("div",{className:ee.headerContent,children:[a.jsx("div",{className:ee.headerTitle,children:"Actual Cash"}),a.jsx("div",{className:ee.headerSubtitle,children:"Cash ending input for today"})]})]})]}),a.jsx("div",{className:ee.comparisonRows,children:C.map(k=>{const N=k.locationName.toLowerCase().includes("bank")?"bank":k.locationName.toLowerCase().includes("vault")?"vault":"cash",I=k.actualBalance>0||k.status==="completed";return a.jsxs("div",{className:ee.comparisonRow,children:[a.jsxs("div",{className:ee.balanceCard,children:[a.jsxs("div",{className:ee.locationHeader,children:[a.jsx("div",{className:ee.locationIconWrap,style:{background:L_(N),color:D_(N)},children:A_(N)}),a.jsxs("div",{className:ee.locationDetails,children:[a.jsx("div",{className:ee.locationName,children:k.locationName}),a.jsx("div",{className:ee.locationType,children:"From Balance Sheet"})]})]}),a.jsx("div",{className:ee.balanceAmount,children:Gl(k.expectedBalance)})]}),a.jsxs("div",{className:`${ee.actualCard} ${I?"":ee.notSet}`,children:[a.jsxs("div",{className:ee.locationHeader,children:[a.jsx("div",{className:ee.locationIconWrap,style:{background:L_(N),color:D_(N)},children:A_(N)}),a.jsxs("div",{className:ee.locationDetails,children:[a.jsx("div",{className:ee.locationName,children:k.locationName}),a.jsx("div",{className:`${ee.locationType} ${I?"":ee.notSetLabel}`,children:I?"Not updated today":"NOT SET"})]})]}),a.jsx("div",{className:`${ee.actualAmountDisplay} ${I?"":ee.pending}`,children:Gl(k.actualBalance)})]})]},k.cashEndingId)})})]}),a.jsxs("div",{className:ee.differenceSection,children:[a.jsxs("div",{className:ee.differenceHeader,children:[a.jsxs("svg",{className:ee.sectionIcon,width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",children:[a.jsx("rect",{x:"4",y:"6",width:"7",height:"2",rx:"1",fill:"currentColor"}),a.jsx("rect",{x:"4",y:"11",width:"7",height:"2",rx:"1",fill:"currentColor"}),a.jsx("rect",{x:"4",y:"16",width:"7",height:"2",rx:"1",fill:"currentColor"}),a.jsx("rect",{x:"13",y:"6",width:"7",height:"2",rx:"1",fill:"currentColor"}),a.jsx("rect",{x:"13",y:"11",width:"5",height:"2",rx:"1",fill:"currentColor"}),a.jsx("rect",{x:"13",y:"16",width:"6",height:"2",rx:"1",fill:"currentColor"})]}),a.jsxs("div",{children:[a.jsx("h3",{className:ee.differenceTitle,children:"Difference"}),a.jsx("p",{className:ee.differenceSubtitle,children:"Difference Between Balance & Actual"})]})]}),a.jsx("div",{className:ee.differenceItems,children:C.map(k=>{const N=k.difference,I=N>0?ee.differencePositive:N<0?ee.differenceNegative:ee.differenceZero;return a.jsxs("div",{className:ee.differenceItem,children:[a.jsx("div",{className:ee.differenceLocationName,children:k.locationName}),a.jsxs("div",{className:ee.differenceAmountActions,children:[a.jsxs("div",{className:`${ee.differenceAmount} ${I}`,children:[N>0?"+":"",Gl(Math.abs(N))]}),a.jsxs("div",{className:ee.actionButtonsSimple,children:[a.jsxs("button",{className:`${ee.actionBtnSimple} ${ee.errorBtnSimple}`,onClick:()=>g(k),disabled:N===0,children:[a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M13,14H11V10H13M13,18H11V16H13M1,21H23L12,2L1,21Z"})}),"Make Error"]}),a.jsxs("button",{className:`${ee.actionBtnSimple} ${ee.exchangeBtnSimple}`,onClick:()=>y(k),disabled:N===0,children:[a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M17.9,17.39C17.64,16.59 16.89,16 16,16H15V13A1,1 0 0,0 14,12H8V10H10A1,1 0 0,0 11,9V7H13A2,2 0 0,0 15,5V4.59C17.93,5.77 20,8.64 20,12C20,14.08 19.2,15.97 17.9,17.39M11,19.93C7.05,19.44 4,16.08 4,12C4,11.38 4.08,10.78 4.21,10.21L9,15V16A2,2 0 0,0 11,18M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z"})}),"Foreign Currency Translation"]})]})]})]},`diff-${k.cashEndingId}`)})})]})]}),a.jsx(pm,{isOpen:p.isOpen,onClose:x,onConfirm:E,title:p.type==="error"?"Make Error":"Foreign Currency Translation",message:p.type==="error"?"Are you sure you want to record this variance as an error?":"Are you sure you want to record this variance as a foreign exchange gain/loss?",variant:"info",confirmButtonVariant:"primary",isLoading:h,children:a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[a.jsx("span",{style:{fontWeight:600,color:"#6C757D"},children:"Location:"}),a.jsx("span",{style:{fontWeight:600,color:"#212529"},children:p.locationName})]}),a.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[a.jsx("span",{style:{fontWeight:600,color:"#6C757D"},children:"Variance:"}),a.jsx("span",{style:{fontFamily:"Pretendard, -apple-system, BlinkMacSystemFont, system-ui, sans-serif",fontWeight:700,color:"#FF5847"},children:Gl(Math.abs(p.difference))})]})]})}),a.jsx(De,{variant:m.variant,title:m.title,message:m.message,isOpen:m.isOpen,onClose:_})]})]})};let gM=class{async getCounterparties(e){const r=ne.getClient(),{data:s,error:n}=await r.from("counterparties").select("counterparty_id, company_id, name, type, is_internal, linked_company_id, email, phone, notes, is_deleted, created_at").eq("company_id",e).eq("is_deleted",!1).order("name",{ascending:!0});if(n)throw new Error(n.message);return s||[]}async createCounterparty(e,r,s,n,o,i,l,c){const d=ne.getClient(),{data:u,error:h}=await d.from("counterparties").insert({company_id:e,name:r,type:s,is_internal:n,linked_company_id:o,email:i,phone:l,notes:c,is_deleted:!1}).select().single();if(h)throw new Error(h.message);return u}async deleteCounterparty(e,r){const s=ne.getClient(),{error:n}=await s.from("counterparties").update({is_deleted:!0}).eq("counterparty_id",e).eq("company_id",r);if(n)throw new Error(n.message);return!0}};class _M{constructor(e,r,s,n,o,i,l,c,d,u,h){this.counterpartyId=e,this.companyId=r,this.name=s,this.type=n,this.isInternal=o,this.linkedCompanyId=i,this.email=l,this.phone=c,this.notes=d,this.isDeleted=u,this.createdAt=h}get initials(){return this.name.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2)}}let M_=class{static fromDatabase(e){return{counterpartyId:e.counterparty_id,companyId:e.company_id,name:e.name,type:e.type,isInternal:e.is_internal,linkedCompanyId:e.linked_company_id,email:e.email,phone:e.phone,notes:e.notes,isDeleted:e.is_deleted,createdAt:te.toLocal(e.created_at)}}static toEntity(e){return new _M(e.counterpartyId,e.companyId,e.name,e.type,e.isInternal,e.linkedCompanyId,e.email,e.phone,e.notes,e.isDeleted,e.createdAt)}static fromDatabaseToEntity(e){const r=this.fromDatabase(e);return this.toEntity(r)}static toDatabase(e){return{counterparty_id:e.counterpartyId,company_id:e.companyId,name:e.name,type:e.type,is_internal:e.isInternal,linked_company_id:e.linkedCompanyId,email:e.email,phone:e.phone,notes:e.notes,is_deleted:e.isDeleted,created_at:te.toUtc(e.createdAt)}}},yM=class{constructor(){W(this,"dataSource",new gM)}async getCounterparties(e){try{return{success:!0,data:(await this.dataSource.getCounterparties(e)).map(n=>M_.fromDatabaseToEntity(n))}}catch(r){return{success:!1,error:r instanceof Error?r.message:"Failed to fetch"}}}async createCounterparty(e,r,s,n,o,i,l,c){try{const d=await this.dataSource.createCounterparty(e,r,s,n,o,i,l,c);return{success:!0,data:M_.fromDatabaseToEntity(d)}}catch(d){return{success:!1,error:d instanceof Error?d.message:"Failed to create"}}}async deleteCounterparty(e,r){try{return await this.dataSource.deleteCounterparty(e,r),{success:!0}}catch(s){return{success:!1,error:s instanceof Error?s.message:"Failed to delete"}}}};class Oo{static validateName(e){return!e||!e.trim()?{field:"name",message:"Name is required"}:e.trim().length<2?{field:"name",message:"Name must be at least 2 characters"}:e.length>this.MAX_NAME_LENGTH?{field:"name",message:`Name must be less than ${this.MAX_NAME_LENGTH} characters`}:null}static validateType(e){return!e||!e.trim()?{field:"type",message:"Type is required"}:this.VALID_TYPES.includes(e)?null:{field:"type",message:"Invalid counterparty type"}}static validateEmail(e){return!e||!e.trim()?null:e.length>this.MAX_EMAIL_LENGTH?{field:"email",message:`Email must be less than ${this.MAX_EMAIL_LENGTH} characters`}:/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)?null:{field:"email",message:"Invalid email format"}}static validatePhone(e){return!e||!e.trim()?null:e.length>this.MAX_PHONE_LENGTH?{field:"phone",message:`Phone must be less than ${this.MAX_PHONE_LENGTH} characters`}:/^[\d\s\-()+ ]+$/.test(e)?null:{field:"phone",message:"Invalid phone format"}}static validateNotes(e){return!e||!e.trim()?null:e.length>this.MAX_NOTES_LENGTH?{field:"notes",message:`Notes must be less than ${this.MAX_NOTES_LENGTH} characters`}:null}static validateLinkedCompany(e,r){return e&&!r?{field:"linkedCompanyId",message:"Linked company is required for internal organizations"}:!e&&r?{field:"linkedCompanyId",message:"Linked company should only be set for internal organizations"}:null}static validateCreate(e){const r=[],s=this.validateName(e.name);s&&r.push(s);const n=this.validateType(e.type);n&&r.push(n);const o=this.validateLinkedCompany(e.isInternal,e.linkedCompanyId);o&&r.push(o);const i=this.validateEmail(e.email||null);i&&r.push(i);const l=this.validatePhone(e.phone||null);l&&r.push(l);const c=this.validateNotes(e.notes||null);return c&&r.push(c),r}static isValidCreate(e){return this.validateCreate(e).length===0}}W(Oo,"VALID_TYPES",["My Company","Team Member","Suppliers","Employees","Customers","Others"]),W(Oo,"MAX_NAME_LENGTH",255),W(Oo,"MAX_EMAIL_LENGTH",255),W(Oo,"MAX_PHONE_LENGTH",50),W(Oo,"MAX_NOTES_LENGTH",1e3);const R_={name:"",isInternal:!1,linkedCompanyId:null,type:"",email:"",phone:"",notes:""},ju=new yM,vt=Jt((t,e)=>({counterparties:[],loading:!1,error:null,showModal:!1,showDeleteModal:!1,deleteId:null,formData:{...R_},get isFormValid(){const{formData:r}=e();return r.name.trim()!==""&&r.type!==""&&(!r.isInternal||r.linkedCompanyId!==null)},setCounterparties:r=>t({counterparties:r}),setLoading:r=>t({loading:r}),setError:r=>t({error:r}),setShowModal:r=>t({showModal:r}),setShowDeleteModal:r=>t({showDeleteModal:r}),setDeleteId:r=>t({deleteId:r}),openCreateModal:()=>{t({showModal:!0})},closeCreateModal:()=>{t({showModal:!1}),e().resetForm()},openDeleteModal:r=>{t({deleteId:r,showDeleteModal:!0})},closeDeleteModal:()=>{t({showDeleteModal:!1,deleteId:null})},setFormData:r=>t(s=>({formData:{...s.formData,...r}})),updateFormField:(r,s)=>t(n=>({formData:{...n.formData,[r]:s}})),resetForm:()=>t({formData:{...R_}}),loadCounterparties:async r=>{if(!r){t({counterparties:[],loading:!1});return}t({loading:!0,error:null});try{const s=await ju.getCounterparties(r);if(!s.success){t({error:s.error||"Failed to load counterparties",counterparties:[],loading:!1});return}t({counterparties:s.data||[],loading:!1,error:null})}catch(s){t({error:s instanceof Error?s.message:"Error occurred",counterparties:[],loading:!1})}},submitCounterparty:async r=>{const s=e();if(!r)return{success:!1,error:"Company ID required"};const n=Oo.validateCreate({name:s.formData.name,type:s.formData.type,isInternal:s.formData.isInternal,linkedCompanyId:s.formData.linkedCompanyId,email:s.formData.email||null,phone:s.formData.phone||null,notes:s.formData.notes||null});if(n.length>0)return{success:!1,error:n[0].message};t({loading:!0,error:null});try{const o=await ju.createCounterparty(r,s.formData.name.trim(),s.formData.type,s.formData.isInternal,s.formData.linkedCompanyId,s.formData.email||null,s.formData.phone||null,s.formData.notes||null);return o.success?(await e().loadCounterparties(r),e().resetForm(),e().closeCreateModal(),{success:!0}):(t({loading:!1}),{success:!1,error:o.error||"Failed to create"})}catch(o){const i=o instanceof Error?o.message:"Error occurred";return t({loading:!1,error:i}),{success:!1,error:i}}},confirmDelete:async r=>{const s=e();if(!s.deleteId||!r)return{success:!1,error:"Invalid delete request"};t({loading:!0,error:null});try{const n=await ju.deleteCounterparty(s.deleteId,r);return n.success?(await e().loadCounterparties(r),e().closeDeleteModal(),{success:!0}):(t({loading:!1}),{success:!1,error:n.error||"Failed to delete"})}catch(n){const o=n instanceof Error?n.message:"Error occurred";return t({loading:!1,error:o}),{success:!1,error:o}}}})),hx=()=>{const t=vt(I=>I.counterparties),e=vt(I=>I.loading),r=vt(I=>I.error),s=vt(I=>I.showModal),n=vt(I=>I.showDeleteModal),o=vt(I=>I.deleteId),i=vt(I=>I.formData),l=vt(I=>I.isFormValid),c=b.useMemo(()=>t.filter(I=>I.isInternal),[t]),d=b.useMemo(()=>t.filter(I=>!I.isInternal),[t]),u=vt(I=>I.setCounterparties),h=vt(I=>I.setLoading),f=vt(I=>I.setError),p=vt(I=>I.setShowModal),g=vt(I=>I.setShowDeleteModal),y=vt(I=>I.setDeleteId),x=vt(I=>I.openCreateModal),m=vt(I=>I.closeCreateModal),_=vt(I=>I.openDeleteModal),v=vt(I=>I.closeDeleteModal),w=vt(I=>I.setFormData),S=vt(I=>I.updateFormField),E=vt(I=>I.resetForm),C=vt(I=>I.loadCounterparties),k=vt(I=>I.submitCounterparty),N=vt(I=>I.confirmDelete);return{counterparties:t,loading:e,error:r,showModal:s,showDeleteModal:n,deleteId:o,formData:i,isFormValid:l,internalCounterparties:c,externalCounterparties:d,setCounterparties:u,setLoading:h,setError:f,setShowModal:p,setShowDeleteModal:g,setDeleteId:y,openCreateModal:x,closeCreateModal:m,openDeleteModal:_,closeDeleteModal:v,setFormData:w,updateFormField:S,resetForm:E,loadCounterparties:C,submitCounterparty:k,confirmDelete:N}},vM="_modal_12qpj_2",xM="_modalContent_12qpj_17",bM="_modalHeader_12qpj_28",wM="_modalTitle_12qpj_36",SM="_modalClose_12qpj_43",CM="_modalBody_12qpj_62",jM="_formGroup_12qpj_67",kM="_formLabel_12qpj_75",NM="_formInput_12qpj_83",IM="_formTextarea_12qpj_103",EM="_selectionGroup_12qpj_126",TM="_selectionBox_12qpj_132",AM="_active_12qpj_149",LM="_modalActions_12qpj_156",DM="_btnSecondary_12qpj_163",MM="_btnPrimary_12qpj_164",Ye={modal:vM,modalContent:xM,modalHeader:bM,modalTitle:wM,modalClose:SM,modalBody:CM,formGroup:jM,formLabel:kM,formInput:NM,formTextarea:IM,selectionGroup:EM,selectionBox:TM,active:AM,modalActions:LM,btnSecondary:DM,btnPrimary:MM},RM=[{value:"My Company",label:"My Company"},{value:"Team Member",label:"Team Member"},{value:"Suppliers",label:"Suppliers"},{value:"Employees",label:"Employees"},{value:"Customers",label:"Customers"},{value:"Others",label:"Others"}],OM=({isOpen:t,onClose:e,onSubmit:r,companyOptions:s})=>{const{formData:n,isFormValid:o,updateFormField:i,setFormData:l}=hx();if(!t)return null;const c=async()=>{await r()};return a.jsx("div",{className:Ye.modal,onClick:e,children:a.jsxs("div",{className:Ye.modalContent,onClick:d=>d.stopPropagation(),children:[a.jsxs("div",{className:Ye.modalHeader,children:[a.jsx("h2",{className:Ye.modalTitle,children:"Create Counterparty"}),a.jsx("button",{onClick:e,className:Ye.modalClose,children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"})})})]}),a.jsxs("div",{className:Ye.modalBody,children:[a.jsxs("div",{className:Ye.formGroup,children:[a.jsx("label",{className:Ye.formLabel,children:"Counterparty Name *"}),a.jsx("input",{className:Ye.formInput,placeholder:"Enter counterparty name",value:n.name,onChange:d=>i("name",d.target.value)})]}),a.jsxs("div",{className:Ye.formGroup,children:[a.jsx("label",{className:Ye.formLabel,children:"Organization Type"}),a.jsxs("div",{className:Ye.selectionGroup,children:[a.jsx("div",{className:`${Ye.selectionBox} ${n.isInternal?"":Ye.active}`,onClick:()=>{l({isInternal:!1,linkedCompanyId:null})},children:"External Partner"}),a.jsx("div",{className:`${Ye.selectionBox} ${n.isInternal?Ye.active:""}`,onClick:()=>i("isInternal",!0),children:"Internal Organization"})]})]}),n.isInternal&&a.jsx("div",{className:Ye.formGroup,children:a.jsx(We,{label:"Choose Counter Party Company",placeholder:"Select company...",value:n.linkedCompanyId||"",options:s,onChange:d=>i("linkedCompanyId",d),searchable:!0,showBadges:!0,required:!0,fullWidth:!0})}),a.jsx("div",{className:Ye.formGroup,children:a.jsx(We,{label:"Type *",placeholder:"Select type...",value:n.type,options:RM,onChange:d=>i("type",d),searchable:!0,required:!0,fullWidth:!0})}),a.jsxs("div",{className:Ye.formGroup,children:[a.jsx("label",{className:Ye.formLabel,children:"Email"}),a.jsx("input",{type:"email",className:Ye.formInput,placeholder:"example@email.com",value:n.email,onChange:d=>i("email",d.target.value)})]}),a.jsxs("div",{className:Ye.formGroup,children:[a.jsx("label",{className:Ye.formLabel,children:"Phone Number"}),a.jsx("input",{type:"tel",className:Ye.formInput,placeholder:"Enter phone number",value:n.phone,onChange:d=>i("phone",d.target.value)})]}),a.jsxs("div",{className:Ye.formGroup,children:[a.jsx("label",{className:Ye.formLabel,children:"Note"}),a.jsx("textarea",{className:Ye.formTextarea,placeholder:"Add a note...",value:n.notes,onChange:d=>i("notes",d.target.value)})]})]}),a.jsxs("div",{className:Ye.modalActions,children:[a.jsx("button",{onClick:e,className:Ye.btnSecondary,children:"Cancel"}),a.jsx("button",{onClick:c,className:Ye.btnPrimary,disabled:!o,children:"Create Counterparty"})]})]})})},PM="_modal_1xo55_2",$M="_modalContent_1xo55_17",FM="_modalHeader_1xo55_26",BM="_modalTitle_1xo55_31",HM="_confirmIcon_1xo55_39",VM="_confirmMessage_1xo55_48",zM="_confirmText_1xo55_53",UM="_confirmSubtext_1xo55_60",WM="_modalActions_1xo55_67",qM="_btnSecondary_1xo55_74",GM="_btnDanger_1xo55_75",_s={modal:PM,modalContent:$M,modalHeader:FM,modalTitle:BM,confirmIcon:HM,confirmMessage:VM,confirmText:zM,confirmSubtext:UM,modalActions:WM,btnSecondary:qM,btnDanger:GM},JM=({isOpen:t,onClose:e,onConfirm:r})=>{if(!t)return null;const s=async()=>{await r()};return a.jsx("div",{className:_s.modal,onClick:e,children:a.jsxs("div",{className:_s.modalContent,onClick:n=>n.stopPropagation(),children:[a.jsx("div",{className:_s.modalHeader,children:a.jsx("h2",{className:_s.modalTitle,children:"Delete Counterparty"})}),a.jsx("div",{className:_s.confirmIcon,children:a.jsx("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12,2C17.53,2 22,6.47 22,12C22,17.53 17.53,22 12,22C6.47,22 2,17.53 2,12C2,6.47 6.47,2 12,2M15.59,7L12,10.59L8.41,7L7,8.41L10.59,12L7,15.59L8.41,17L12,13.41L15.59,17L17,15.59L13.41,12L17,8.41L15.59,7Z"})})}),a.jsxs("div",{className:_s.confirmMessage,children:[a.jsx("p",{className:_s.confirmText,children:"Are you sure you want to delete this counterparty?"}),a.jsx("p",{className:_s.confirmSubtext,children:"This action cannot be undone."})]}),a.jsxs("div",{className:_s.modalActions,children:[a.jsx("button",{onClick:e,className:_s.btnSecondary,children:"Cancel"}),a.jsx("button",{onClick:s,className:_s.btnDanger,children:"Delete"})]})]})})},KM="_container_1rdj0_2",YM="_header_1rdj0_12",QM="_title_1rdj0_21",ZM="_subtitle_1rdj0_28",XM="_addBtn_1rdj0_35",e3="_section_1rdj0_61",t3="_internalSection_1rdj0_70",r3="_sectionHeader_1rdj0_75",s3="_sectionTitle_1rdj0_85",n3="_sectionIcon_1rdj0_100",o3="_sectionCount_1rdj0_106",a3="_sectionSubtitle_1rdj0_117",i3="_grid_1rdj0_125",l3="_card_1rdj0_132",c3="_internalCard_1rdj0_146",d3="_cardHeader_1rdj0_156",u3="_cardInfo_1rdj0_163",h3="_cardName_1rdj0_167",f3="_cardMeta_1rdj0_174",m3="_cardType_1rdj0_181",p3="_internalBadge_1rdj0_188",g3="_linkedCompany_1rdj0_201",_3="_cardActions_1rdj0_209",y3="_typeBadge_1rdj0_215",v3="_deleteBtn_1rdj0_226",x3="_cardDetails_1rdj0_251",b3="_detailRow_1rdj0_257",w3="_detailIcon_1rdj0_266",S3="_empty_1rdj0_274",C3="_emptyIcon_1rdj0_283",j3="_emptyTitle_1rdj0_290",k3="_emptyText_1rdj0_297",pe={container:KM,header:YM,title:QM,subtitle:ZM,addBtn:XM,section:e3,internalSection:t3,sectionHeader:r3,sectionTitle:s3,sectionIcon:n3,sectionCount:o3,sectionSubtitle:a3,grid:i3,card:l3,internalCard:c3,cardHeader:d3,cardInfo:u3,cardName:h3,cardMeta:f3,cardType:m3,internalBadge:p3,linkedCompany:g3,cardActions:_3,typeBadge:y3,deleteBtn:v3,cardDetails:x3,detailRow:b3,detailIcon:w3,empty:S3,emptyIcon:C3,emptyTitle:j3,emptyText:k3},N3=()=>{const{currentCompany:t,companies:e}=at(),{loading:r,error:s,showModal:n,showDeleteModal:o,internalCounterparties:i,externalCounterparties:l,loadCounterparties:c,openCreateModal:d,closeCreateModal:u,closeDeleteModal:h,openDeleteModal:f,submitCounterparty:p,confirmDelete:g}=hx(),{messageState:y,closeMessage:x,showError:m,showSuccess:_}=Es(),v=b.useMemo(()=>(e||[]).map(C=>({value:C.company_id,label:C.company_name,badge:C.company_name.substring(0,2).toUpperCase()})),[e]);b.useEffect(()=>{t!=null&&t.company_id&&c(t.company_id)},[t==null?void 0:t.company_id]),b.useEffect(()=>{s&&m({title:"Failed to Load",message:s})},[s,m]);const w=async()=>{if(!(t!=null&&t.company_id))return;const C=await p(t.company_id);C.success?_({message:"Counterparty created successfully",autoCloseDuration:2e3}):m({title:"Failed to Create",message:C.error||"Unable to create counterparty. Please try again."})},S=async()=>{if(!(t!=null&&t.company_id))return;const C=await g(t.company_id);C.success?_({message:"Counterparty deleted successfully",autoCloseDuration:2e3}):m({title:"Failed to Delete",message:C.error||"Unable to delete counterparty. Please try again."})};if(r&&i.length===0&&l.length===0)return a.jsxs(a.Fragment,{children:[a.jsx(fe,{activeItem:"setting"}),a.jsx("div",{className:pe.container,children:a.jsx(Ne,{size:"large",fullscreen:!0})})]});if(!t)return a.jsxs(a.Fragment,{children:[a.jsx(fe,{activeItem:"setting"}),a.jsx("div",{className:pe.container,children:a.jsx("p",{children:"Select company"})})]});const E=i.length+l.length;return a.jsxs(a.Fragment,{children:[a.jsx(fe,{activeItem:"setting"}),a.jsxs("div",{className:pe.container,children:[a.jsxs("div",{className:pe.header,children:[a.jsxs("div",{children:[a.jsx("h1",{className:pe.title,children:"Counterparty"}),a.jsx("p",{className:pe.subtitle,children:"Manage business partners and relationships"})]}),a.jsxs("button",{onClick:d,className:pe.addBtn,children:[a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"})}),"Add Counterparty"]})]}),i.length>0&&a.jsxs("div",{className:`${pe.section} ${pe.internalSection}`,children:[a.jsxs("div",{className:pe.sectionHeader,children:[a.jsxs("div",{className:pe.sectionTitle,children:[a.jsx("svg",{className:pe.sectionIcon,viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M10,20V14H14V20H19V12H22L12,3L2,12H5V20H10Z"})}),a.jsx("h2",{children:"Internal Organizations"}),a.jsx("span",{className:pe.sectionCount,children:i.length})]}),a.jsx("p",{className:pe.sectionSubtitle,children:"Your internal company structures and departments"})]}),a.jsx("div",{className:pe.grid,children:i.map(C=>{const k=C.linkedCompanyId?e==null?void 0:e.find(N=>N.company_id===C.linkedCompanyId):null;return a.jsxs("div",{className:`${pe.card} ${pe.internalCard}`,children:[a.jsxs("div",{className:pe.cardHeader,children:[a.jsxs("div",{className:pe.cardInfo,children:[a.jsx("h3",{className:pe.cardName,children:C.name}),a.jsxs("div",{className:pe.cardMeta,children:[a.jsxs("span",{className:pe.internalBadge,children:[a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M10,20V14H14V20H19V12H22L12,3L2,12H5V20H10Z"})}),"Internal"]}),k&&a.jsx("span",{className:pe.linkedCompany,children:k.company_name})]})]}),a.jsxs("div",{className:pe.cardActions,children:[a.jsx("span",{className:pe.typeBadge,children:C.type}),a.jsx("button",{onClick:()=>f(C.counterpartyId),className:pe.deleteBtn,children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M9,3V4H4V6H5V19A2,2 0 0,0 7,21H17A2,2 0 0,0 19,19V6H20V4H15V3H9M7,6H17V19H7V6M9,8V17H11V8H9M13,8V17H15V8H13Z"})})})]})]}),(C.email||C.phone)&&a.jsxs("div",{className:pe.cardDetails,children:[C.email&&a.jsxs("div",{className:pe.detailRow,children:[a.jsx("svg",{className:pe.detailIcon,viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M20,8L12,13L4,8V6L12,11L20,6M20,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V6C22,4.89 21.1,4 20,4Z"})}),a.jsx("span",{children:C.email})]}),C.phone&&a.jsxs("div",{className:pe.detailRow,children:[a.jsx("svg",{className:pe.detailIcon,viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M6.62,10.79C8.06,13.62 10.38,15.94 13.21,17.38L15.41,15.18C15.69,14.9 16.08,14.82 16.43,14.93C17.55,15.3 18.75,15.5 20,15.5A1,1 0 0,1 21,16.5V20A1,1 0 0,1 20,21A17,17 0 0,1 3,4A1,1 0 0,1 4,3H7.5A1,1 0 0,1 8.5,4C8.5,5.25 8.7,6.45 9.07,7.57C9.18,7.92 9.1,8.31 8.82,8.59L6.62,10.79Z"})}),a.jsx("span",{children:C.phone})]})]})]},C.counterpartyId)})})]}),l.length>0&&a.jsxs("div",{className:pe.section,children:[a.jsxs("div",{className:pe.sectionHeader,children:[a.jsxs("div",{className:pe.sectionTitle,children:[a.jsx("svg",{className:pe.sectionIcon,viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12,5.5A3.5,3.5 0 0,1 15.5,9A3.5,3.5 0 0,1 12,12.5A3.5,3.5 0 0,1 8.5,9A3.5,3.5 0 0,1 12,5.5M5,8C5.56,8 6.08,8.15 6.53,8.42C6.38,9.85 6.8,11.27 7.66,12.38C7.16,13.34 6.16,14 5,14A3,3 0 0,1 2,11A3,3 0 0,1 5,8M19,8A3,3 0 0,1 22,11A3,3 0 0,1 19,14C17.84,14 16.84,13.34 16.34,12.38C17.2,11.27 17.62,9.85 17.47,8.42C17.92,8.15 18.44,8 19,8M5.5,18.25C5.5,16.18 8.41,14.5 12,14.5C15.59,14.5 18.5,16.18 18.5,18.25V20H5.5V18.25M0,20V18.5C0,17.11 1.89,15.94 4.45,15.6C3.86,16.28 3.5,17.22 3.5,18.25V20H0M24,20H20.5V18.25C20.5,17.22 20.14,16.28 19.55,15.6C22.11,15.94 24,17.11 24,18.5V20Z"})}),a.jsx("h2",{children:"External Partners"}),a.jsx("span",{className:pe.sectionCount,children:l.length})]}),a.jsx("p",{className:pe.sectionSubtitle,children:"Customers, suppliers, and business partners"})]}),a.jsx("div",{className:pe.grid,children:l.map(C=>a.jsxs("div",{className:pe.card,children:[a.jsxs("div",{className:pe.cardHeader,children:[a.jsxs("div",{className:pe.cardInfo,children:[a.jsx("h3",{className:pe.cardName,children:C.name}),a.jsxs("p",{className:pe.cardType,children:["Type: ",C.type]})]}),a.jsxs("div",{className:pe.cardActions,children:[a.jsx("span",{className:pe.typeBadge,children:C.type}),a.jsx("button",{onClick:()=>f(C.counterpartyId),className:pe.deleteBtn,children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M9,3V4H4V6H5V19A2,2 0 0,0 7,21H17A2,2 0 0,0 19,19V6H20V4H15V3H9M7,6H17V19H7V6M9,8V17H11V8H9M13,8V17H15V8H13Z"})})})]})]}),(C.email||C.phone)&&a.jsxs("div",{className:pe.cardDetails,children:[C.email&&a.jsxs("div",{className:pe.detailRow,children:[a.jsx("svg",{className:pe.detailIcon,viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M20,8L12,13L4,8V6L12,11L20,6M20,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V6C22,4.89 21.1,4 20,4Z"})}),a.jsx("span",{children:C.email})]}),C.phone&&a.jsxs("div",{className:pe.detailRow,children:[a.jsx("svg",{className:pe.detailIcon,viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M6.62,10.79C8.06,13.62 10.38,15.94 13.21,17.38L15.41,15.18C15.69,14.9 16.08,14.82 16.43,14.93C17.55,15.3 18.75,15.5 20,15.5A1,1 0 0,1 21,16.5V20A1,1 0 0,1 20,21A17,17 0 0,1 3,4A1,1 0 0,1 4,3H7.5A1,1 0 0,1 8.5,4C8.5,5.25 8.7,6.45 9.07,7.57C9.18,7.92 9.1,8.31 8.82,8.59L6.62,10.79Z"})}),a.jsx("span",{children:C.phone})]})]})]},C.counterpartyId))})]}),E===0&&a.jsxs("div",{className:pe.empty,children:[a.jsxs("svg",{className:pe.emptyIcon,width:"120",height:"120",viewBox:"0 0 120 120",fill:"none",children:[a.jsx("circle",{cx:"60",cy:"60",r:"50",fill:"#F0F6FF"}),a.jsx("rect",{x:"30",y:"45",width:"60",height:"40",rx:"4",fill:"white",stroke:"#0064FF",strokeWidth:"2"}),a.jsx("rect",{x:"35",y:"40",width:"60",height:"40",rx:"4",fill:"white",stroke:"#0064FF",strokeWidth:"2"}),a.jsx("line",{x1:"43",y1:"48",x2:"58",y2:"48",stroke:"#E9ECEF",strokeWidth:"2",strokeLinecap:"round"}),a.jsx("line",{x1:"43",y1:"54",x2:"75",y2:"54",stroke:"#E9ECEF",strokeWidth:"2",strokeLinecap:"round"}),a.jsx("line",{x1:"43",y1:"60",x2:"70",y2:"60",stroke:"#E9ECEF",strokeWidth:"2",strokeLinecap:"round"}),a.jsx("circle",{cx:"83",cy:"55",r:"8",fill:"#0064FF"}),a.jsx("circle",{cx:"83",cy:"53",r:"3",fill:"white"}),a.jsx("path",{d:"M78 59 Q78 56 83 56 Q88 56 88 59",stroke:"white",strokeWidth:"1.5",fill:"none",strokeLinecap:"round"}),a.jsx("circle",{cx:"60",cy:"85",r:"15",fill:"#0064FF"}),a.jsx("line",{x1:"60",y1:"77",x2:"60",y2:"93",stroke:"white",strokeWidth:"3",strokeLinecap:"round"}),a.jsx("line",{x1:"52",y1:"85",x2:"68",y2:"85",stroke:"white",strokeWidth:"3",strokeLinecap:"round"})]}),a.jsx("h2",{className:pe.emptyTitle,children:"No Counterparties Found"}),a.jsx("p",{className:pe.emptyText,children:"Start by adding your first counterparty to manage business relationships."}),a.jsxs("button",{onClick:d,className:pe.addBtn,children:[a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"})}),"Add Your First Counterparty"]})]}),a.jsx(OM,{isOpen:n,onClose:u,onSubmit:w,companyOptions:v}),a.jsx(JM,{isOpen:o,onClose:h,onConfirm:S}),a.jsx(De,{isOpen:y.isOpen,variant:y.variant,title:y.title,message:y.message,onClose:x,autoCloseDuration:y.autoCloseDuration,closeOnBackdropClick:y.closeOnBackdropClick})]})]})};class I3{constructor(e,r,s,n,o,i,l){this.currencyId=e,this.companyId=r,this.code=s,this.symbol=n,this.name=o,this.isDefault=i,this.exchangeRate=l}get displayName(){return`${this.code} (${this.symbol}) - ${this.name}`}}class fx{static fromDatabase(e){return{currencyId:e.currency_id,companyId:e.company_id,code:e.code||e.currency_code,symbol:e.symbol||"",name:e.name||e.currency_name||"",isDefault:e.is_default||!1,exchangeRate:e.exchange_rate||1}}static toEntity(e){return new I3(e.currencyId,e.companyId,e.code,e.symbol,e.name,e.isDefault,e.exchangeRate)}static fromDatabaseToEntity(e){const r=this.fromDatabase(e);return this.toEntity(r)}static toDatabase(e){return{currency_id:e.currencyId,company_id:e.companyId,code:e.code,symbol:e.symbol,name:e.name,is_default:e.isDefault,exchange_rate:e.exchangeRate}}}class E3{static fromDatabase(e){return{currencyId:e.currency_id,code:e.currency_code||e.code,symbol:e.symbol||"",name:e.currency_name||e.name||""}}static toDatabase(e){return{currency_id:e.currencyId,currency_code:e.code,symbol:e.symbol,currency_name:e.name}}}class T3{async getCurrencies(e){const r=ne.getClient(),{data:s,error:n}=await r.from("companies").select("base_currency_id").eq("company_id",e).single();if(n)throw new Error(n.message);const o=(s==null?void 0:s.base_currency_id)||null,{data:i,error:l}=await r.from("company_currency").select("*").eq("company_id",e).eq("is_deleted",!1).order("created_at",{ascending:!0});if(l)throw new Error(l.message);if(!i||i.length===0)return[];const c=[...new Set(i.map(f=>f.currency_id))],{data:d,error:u}=await r.from("currency_types").select("*").in("currency_id",c);if(u)throw new Error(u.message);const h=new Map;for(const f of c){const{data:p,error:g}=await r.from("book_exchange_rates").select("rate").eq("company_id",e).eq("from_currency_id",f).order("rate_date",{ascending:!1}).limit(1).maybeSingle();!g&&p&&h.set(f,p.rate)}return(d||[]).map(f=>{const p={currency_id:f.currency_id,company_id:e,code:f.currency_code,symbol:f.symbol||"",name:f.currency_name||"",is_default:f.currency_id===o,exchange_rate:h.get(f.currency_id)||1};return fx.fromDatabase(p)})}async setDefaultCurrency(e,r){const s=ne.getClient(),{error:n}=await s.from("companies").update({base_currency_id:e}).eq("company_id",r);if(n)throw new Error(n.message)}async updateExchangeRate(e,r,s,n){const o=ne.getClient(),{data:i,error:l}=await o.from("companies").select("base_currency_id").eq("company_id",r).single();if(l)throw new Error(l.message);const c=i==null?void 0:i.base_currency_id;if(!c)throw new Error("Base currency not found for the company");const d=te.toDateOnly(new Date),{data:u,error:h}=await o.from("book_exchange_rates").select("*").eq("company_id",r).eq("from_currency_id",e);if(h&&h.code!=="PGRST116"&&console.error("Error checking existing rates:",h),u&&u.length>0){const{error:f}=await o.from("book_exchange_rates").update({rate:s,rate_date:d,updated_at:te.nowUtc()}).eq("company_id",r).eq("from_currency_id",e);if(f)throw new Error(f.message)}else{const{error:f}=await o.from("book_exchange_rates").insert({company_id:r,from_currency_id:e,to_currency_id:c,rate:s,rate_date:d,created_by:n});if(f)throw new Error(f.message)}}async getAllCurrencyTypes(){const e=ne.getClient(),{data:r,error:s}=await e.from("currency_types").select("*").order("currency_code",{ascending:!0});if(s)throw new Error(s.message);return(r||[]).map(n=>E3.fromDatabase(n))}async addCurrency(e,r,s,n){const o=ne.getClient(),{data:i,error:l}=await o.from("companies").select("base_currency_id").eq("company_id",r).single();if(l)throw new Error(l.message);const c=i==null?void 0:i.base_currency_id,d=te.toDateOnly(new Date),{error:u}=await o.from("company_currency").insert({company_id:r,currency_id:e,is_deleted:!1}).select();if(u)throw new Error(u.message);if(c){const{error:h}=await o.from("book_exchange_rates").insert({company_id:r,from_currency_id:e,to_currency_id:c,rate:s,rate_date:d,created_by:n})}}async removeCurrency(e,r){const s=ne.getClient(),{error:n}=await s.from("company_currency").update({is_deleted:!0,updated_at:te.nowUtc()}).eq("company_id",r).eq("currency_id",e);if(n)throw new Error(n.message)}}class A3{constructor(){W(this,"dataSource",new T3)}async getCurrencies(e){try{return{success:!0,data:(await this.dataSource.getCurrencies(e)).map(n=>fx.toEntity(n))}}catch(r){return{success:!1,error:r instanceof Error?r.message:"Failed"}}}async getAllCurrencyTypes(){try{return{success:!0,data:await this.dataSource.getAllCurrencyTypes()}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Failed"}}}async setDefaultCurrency(e,r){try{return await this.dataSource.setDefaultCurrency(e,r),{success:!0}}catch(s){return{success:!1,error:s instanceof Error?s.message:"Failed"}}}async updateExchangeRate(e,r,s,n){try{return await this.dataSource.updateExchangeRate(e,r,s,n),{success:!0}}catch(o){return{success:!1,error:o instanceof Error?o.message:"Failed"}}}async addCurrency(e,r,s,n){try{return await this.dataSource.addCurrency(e,r,s,n),{success:!0}}catch(o){return{success:!1,error:o instanceof Error?o.message:"Failed"}}}async removeCurrency(e,r){try{return await this.dataSource.removeCurrency(e,r),{success:!0}}catch(s){return{success:!1,error:s instanceof Error?s.message:"Failed"}}}}class Bi{static validateExchangeRate(e){const r=typeof e=="string"?parseFloat(e):e;return isNaN(r)?{isValid:!1,error:"Please enter a valid exchange rate"}:r<=0?{isValid:!1,error:"Exchange rate must be greater than 0"}:r<1e-4||r>1e6?{isValid:!1,error:"Exchange rate must be between 0.0001 and 1,000,000"}:{isValid:!0}}static validateCurrencyId(e){return!e||e.trim()===""?{isValid:!1,error:"Please select a currency"}:{isValid:!0}}static validateAddCurrency(e,r){const s=Bi.validateCurrencyId(e);return s.isValid?Bi.validateExchangeRate(r):s}}const Do=new A3,jt=Jt((t,e)=>({currencies:[],loading:!1,error:null,companyId:"",userId:"",editingCurrency:null,showAddModal:!1,currencyToRemove:null,isRemoving:!1,notification:null,setContext:(r,s)=>{t({companyId:r,userId:s})},setCurrencies:r=>t({currencies:r}),setLoading:r=>t({loading:r}),setError:r=>t({error:r}),setEditingCurrency:r=>t({editingCurrency:r}),setShowAddModal:r=>t({showAddModal:r}),setCurrencyToRemove:r=>t({currencyToRemove:r}),setNotification:r=>t({notification:r}),clearNotification:()=>t({notification:null}),loadCurrencies:async()=>{const{companyId:r}=e();if(!r){t({error:"No company selected"});return}t({loading:!0,error:null});try{const s=await Do.getCurrencies(r);s.success?t({currencies:s.data||[],loading:!1,error:null}):t({loading:!1,error:s.error||"Failed to load currencies"})}catch(s){t({loading:!1,error:s instanceof Error?s.message:"Unknown error"})}},getAllCurrencyTypes:async()=>{try{const r=await Do.getAllCurrencyTypes();return r.success?r.data||[]:[]}catch(r){return console.error("Failed to get currency types:",r),[]}},updateExchangeRate:async(r,s)=>{const{companyId:n,userId:o}=e();if(!n)return{success:!1,error:"No company selected"};if(!o)return{success:!1,error:"No user ID"};const i=Bi.validateExchangeRate(s);if(!i.isValid)return{success:!1,error:i.error};try{const l=typeof s=="string"?parseFloat(s):s,c=await Do.updateExchangeRate(r,n,l,o);return c.success?(await e().loadCurrencies(),t({notification:{variant:"success",message:"Exchange rate updated successfully!"},editingCurrency:null}),setTimeout(()=>{e().clearNotification()},2e3),{success:!0}):c}catch(l){return{success:!1,error:l instanceof Error?l.message:"Failed to update exchange rate"}}},addCurrency:async(r,s)=>{const{companyId:n,userId:o}=e();if(!n)return{success:!1,error:"No company selected"};if(!o)return{success:!1,error:"No user ID"};const i=Bi.validateAddCurrency(r,s);if(!i.isValid)return{success:!1,error:i.error};try{const l=typeof s=="string"?parseFloat(s):s,c=await Do.addCurrency(r,n,l,o);if(c.success){await e().loadCurrencies();const u=(await e().getAllCurrencyTypes()).find(h=>h.currencyId===r);return t({notification:{variant:"success",message:`${(u==null?void 0:u.code)||"Currency"} added successfully!`},showAddModal:!1}),setTimeout(()=>{e().clearNotification()},2e3),{success:!0}}return c}catch(l){return{success:!1,error:l instanceof Error?l.message:"Failed to add currency"}}},removeCurrency:async r=>{const{companyId:s}=e();if(!s)return{success:!1,error:"No company selected"};t({isRemoving:!0});try{const n=await Do.removeCurrency(r,s);if(n.success){await e().loadCurrencies();const o=e().currencyToRemove;return t({notification:{variant:"success",message:`${(o==null?void 0:o.code)||"Currency"} removed successfully!`},currencyToRemove:null,isRemoving:!1}),setTimeout(()=>{e().clearNotification()},2e3),{success:!0}}return t({isRemoving:!1}),n}catch(n){const o=n instanceof Error?n.message:"Failed to remove currency";return t({isRemoving:!1}),{success:!1,error:o}}},setDefaultCurrency:async r=>{const{companyId:s}=e();if(!s)return{success:!1,error:"No company selected"};try{const n=await Do.setDefaultCurrency(r,s);return n.success?(await e().loadCurrencies(),t({notification:{variant:"success",message:"Default currency updated successfully!"}}),setTimeout(()=>{e().clearNotification()},2e3),{success:!0}):n}catch(n){return{success:!1,error:n instanceof Error?n.message:"Failed to set default currency"}}},handleEditCurrency:r=>{t({editingCurrency:r})},handleRemoveCurrency:r=>{if(r.isDefault){t({notification:{variant:"error",message:"Cannot remove the base currency. Please change the base currency in company settings first."}}),setTimeout(()=>{e().clearNotification()},3e3);return}t({currencyToRemove:r})},confirmRemoveCurrency:async()=>{const{currencyToRemove:r}=e();if(!r)return;const s=await e().removeCurrency(r.currencyId);s.success||(t({notification:{variant:"error",message:s.error||"Failed to remove currency"},isRemoving:!1}),setTimeout(()=>{e().clearNotification()},3e3))},reset:()=>{t({currencies:[],loading:!1,error:null,companyId:"",userId:"",editingCurrency:null,showAddModal:!1,currencyToRemove:null,isRemoving:!1,notification:null})}})),L3=(t,e)=>{const r=jt(N=>N.currencies),s=jt(N=>N.loading),n=jt(N=>N.error),o=jt(N=>N.editingCurrency),i=jt(N=>N.showAddModal),l=jt(N=>N.currencyToRemove),c=jt(N=>N.isRemoving),d=jt(N=>N.notification),u=jt(N=>N.setContext),h=jt(N=>N.setEditingCurrency),f=jt(N=>N.setShowAddModal),p=jt(N=>N.setCurrencyToRemove),g=jt(N=>N.setNotification),y=jt(N=>N.clearNotification),x=jt(N=>N.loadCurrencies),m=jt(N=>N.getAllCurrencyTypes),_=jt(N=>N.updateExchangeRate),v=jt(N=>N.addCurrency),w=jt(N=>N.removeCurrency),S=jt(N=>N.setDefaultCurrency),E=jt(N=>N.handleEditCurrency),C=jt(N=>N.handleRemoveCurrency),k=jt(N=>N.confirmRemoveCurrency);return b.useEffect(()=>{t&&e&&(u(t,e),x())},[t,e,u,x]),{currencies:r,loading:s,error:n,editingCurrency:o,showAddModal:i,currencyToRemove:l,isRemoving:c,notification:d,setEditingCurrency:h,setShowAddModal:f,setCurrencyToRemove:p,setNotification:g,clearNotification:y,loadCurrencies:x,getAllCurrencyTypes:m,updateExchangeRate:_,addCurrency:v,removeCurrency:w,setDefaultCurrency:S,handleEditCurrency:E,handleRemoveCurrency:C,confirmRemoveCurrency:k}},D3="_modalOverlay_pfp42_2",M3="_show_pfp42_17",R3="_modalContent_pfp42_23",O3="_modalHeader_pfp42_40",P3="_modalTitle_pfp42_48",$3="_modalCloseBtn_pfp42_55",F3="_modalBody_pfp42_74",B3="_modalInfoGroup_pfp42_79",H3="_modalInfoItem_pfp42_89",V3="_modalInfoLabel_pfp42_95",z3="_modalInfoValue_pfp42_103",U3="_modalFormGroup_pfp42_110",W3="_modalLabel_pfp42_116",q3="_modalInput_pfp42_124",G3="_exchangeRateInfo_pfp42_140",J3="_liveRateDisplay_pfp42_147",K3="_rateError_pfp42_157",Y3="_liveRateText_pfp42_161",Q3="_rateValue_pfp42_169",Z3="_baseCurrency_pfp42_175",X3="_useLiveRateBtn_pfp42_179",eR="_modalFooter_pfp42_198",Qe={modalOverlay:D3,show:M3,modalContent:R3,modalHeader:O3,modalTitle:P3,modalCloseBtn:$3,modalBody:F3,modalInfoGroup:B3,modalInfoItem:H3,modalInfoLabel:V3,modalInfoValue:z3,modalFormGroup:U3,modalLabel:W3,modalInput:q3,exchangeRateInfo:G3,liveRateDisplay:J3,rateError:K3,liveRateText:Y3,rateValue:Q3,baseCurrency:Z3,useLiveRateBtn:X3,modalFooter:eR},tR=({currency:t,baseCurrencyCode:e,onClose:r,onSave:s})=>{const[n,o]=b.useState("1.0000"),[i,l]=b.useState(null),[c,d]=b.useState(!1),[u,h]=b.useState(null),[f,p]=b.useState(!1),[g,y]=b.useState(null);b.useEffect(()=>{var S;t&&(o(((S=t.exchangeRate)==null?void 0:S.toString())||"1.0000"),t.code!==e&&x(t.code,e))},[t,e]);const x=async(S,E)=>{d(!0),h(null),l(null);try{const C=await fetch(`https://api.exchangerate-api.com/v4/latest/${S}`);if(!C.ok)throw new Error("Failed to fetch exchange rate");const N=(await C.json()).rates[E];if(N)l(N);else throw new Error("Exchange rate not available")}catch(C){console.error("Error fetching live rate:",C);try{const N=await(await fetch(`https://api.exchangerate-api.com/v4/latest/${E}`)).json();if(N.rates[S]){const I=1/N.rates[S];l(I)}else h("Exchange rate currently unavailable")}catch{h("Unable to fetch live rate")}}finally{d(!1)}},m=()=>{i&&(o(i.toFixed(4)),l(null))},_=async()=>{if(t){p(!0),y(null);try{const S=await s(t.currencyId,n);S.success?r():y({title:"Failed to Update Exchange Rate",message:S.error||"An error occurred while updating the exchange rate. Please try again."})}catch(S){y({title:"Unexpected Error",message:S instanceof Error?S.message:"An unexpected error occurred. Please try again."})}finally{p(!1)}}},v=S=>{S.target===S.currentTarget&&r()};if(!t)return null;const w=i!==null&&Math.abs(parseFloat(n)-i)>1e-4;return a.jsxs("div",{className:`${Qe.modalOverlay} ${t?Qe.show:""}`,onClick:v,children:[a.jsxs("div",{className:Qe.modalContent,onClick:S=>S.stopPropagation(),children:[a.jsxs("div",{className:Qe.modalHeader,children:[a.jsx("h2",{className:Qe.modalTitle,children:"Edit Currency Details"}),a.jsx("button",{className:Qe.modalCloseBtn,onClick:r,children:a.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})})})]}),a.jsxs("div",{className:Qe.modalBody,children:[a.jsxs("div",{className:Qe.modalInfoGroup,children:[a.jsxs("div",{className:Qe.modalInfoItem,children:[a.jsx("span",{className:Qe.modalInfoLabel,children:"Currency Code"}),a.jsx("span",{className:Qe.modalInfoValue,children:t.code})]}),a.jsxs("div",{className:Qe.modalInfoItem,children:[a.jsx("span",{className:Qe.modalInfoLabel,children:"Currency Name"}),a.jsx("span",{className:Qe.modalInfoValue,children:t.name})]}),a.jsxs("div",{className:Qe.modalInfoItem,children:[a.jsx("span",{className:Qe.modalInfoLabel,children:"Symbol"}),a.jsx("span",{className:Qe.modalInfoValue,children:t.symbol})]})]}),a.jsxs("div",{className:Qe.modalFormGroup,children:[a.jsx("label",{className:Qe.modalLabel,children:"Exchange Rate"}),a.jsx("input",{type:"number",className:Qe.modalInput,step:"0.0001",min:"0",placeholder:"1.0000",value:n,onChange:S=>o(S.target.value)}),a.jsxs("div",{className:Qe.exchangeRateInfo,children:[a.jsxs("div",{className:Qe.liveRateDisplay,children:[c&&a.jsx("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:a.jsx(Ne,{size:"small"})}),!c&&u&&a.jsx("span",{className:Qe.rateError,children:u}),!c&&i&&!u&&a.jsxs("span",{className:Qe.liveRateText,children:[a.jsx("strong",{children:"Live Rate:"})," 1 ",t.code," = ",a.jsx("span",{className:Qe.rateValue,children:i.toFixed(4)})," ",a.jsx("span",{className:Qe.baseCurrency,children:e})]}),!c&&t.code===e&&a.jsxs("span",{className:Qe.liveRateText,children:["Exchange rate to base currency: ",a.jsx("span",{className:Qe.rateValue,children:"1.0000"})]})]}),w&&a.jsx("button",{type:"button",className:Qe.useLiveRateBtn,onClick:m,children:"Use Live Rate"})]})]})]}),a.jsxs("div",{className:Qe.modalFooter,children:[a.jsx(be,{variant:"outline",size:"md",onClick:r,disabled:f,children:"Cancel"}),a.jsx(be,{variant:"primary",size:"md",onClick:_,disabled:f,children:f?a.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:a.jsx(Ne,{size:"small"})}):"Save Changes"})]})]}),a.jsx(De,{variant:"error",title:g==null?void 0:g.title,message:(g==null?void 0:g.message)||"",isOpen:!!g,onClose:()=>y(null),zIndex:10001})]})},rR="_modalOverlay_k04mn_2",sR="_show_k04mn_17",nR="_modalContent_k04mn_23",oR="_modalHeader_k04mn_43",aR="_modalTitle_k04mn_51",iR="_modalCloseBtn_k04mn_58",lR="_modalBody_k04mn_77",cR="_formGroup_k04mn_84",dR="_formLabel_k04mn_88",uR="_formInput_k04mn_96",hR="_currencyInfo_k04mn_123",fR="_currencyInfoItem_k04mn_130",mR="_currencyInfoLabel_k04mn_140",pR="_currencyInfoValue_k04mn_145",gR="_exchangeRateWrapper_k04mn_152",_R="_liveRateInfo_k04mn_163",yR="_liveRateLabel_k04mn_173",vR="_liveRateValue_k04mn_178",xR="_modalFooter_k04mn_186",ft={modalOverlay:rR,show:sR,modalContent:nR,modalHeader:oR,modalTitle:aR,modalCloseBtn:iR,modalBody:lR,formGroup:cR,formLabel:dR,formInput:uR,currencyInfo:hR,currencyInfoItem:fR,currencyInfoLabel:mR,currencyInfoValue:pR,exchangeRateWrapper:gR,liveRateInfo:_R,liveRateLabel:yR,liveRateValue:vR,modalFooter:xR},bR=({isOpen:t,onClose:e,existingCurrencies:r,baseCurrencyCode:s,onGetAllCurrencyTypes:n,onAddCurrency:o})=>{const[i,l]=b.useState([]),[c,d]=b.useState(""),[u,h]=b.useState(""),[f,p]=b.useState(null),[g,y]=b.useState(!1),[x,m]=b.useState(!1),[_,v]=b.useState(null);b.useEffect(()=>{t&&(w(),d(""),h(""),p(null),v(null))},[t]);const w=async()=>{const j=await n();l(j)},E=i.filter(j=>!r.some(R=>R.currencyId===j.currencyId)).map(j=>({value:j.currencyId,label:`${j.code}`,description:j.name,badge:j.symbol})),C=i.find(j=>j.currencyId===c),k=j=>{d(j),p(null)},N=async()=>{if(!(!C||!s)){y(!0);try{const R=(await(await fetch(`https://api.exchangerate-api.com/v4/latest/${C.code}`)).json()).rates[s];if(R)p(R),h(R.toFixed(4));else{const z=await(await fetch(`https://api.exchangerate-api.com/v4/latest/${s}`)).json();if(z.rates[C.code]){const D=1/z.rates[C.code];p(D),h(D.toFixed(4))}}}catch(j){console.error("Failed to fetch live exchange rate:",j)}finally{y(!1)}}},I=()=>{f&&h(f.toFixed(4))},L=async()=>{if(!(!c||!u)){m(!0),v(null);try{const j=await o(c,u);m(!1),j.success?e():v({title:"Failed to Add Currency",message:j.error||"An error occurred while adding the currency. Please try again."})}catch(j){m(!1),v({title:"Unexpected Error",message:j instanceof Error?j.message:"An unexpected error occurred. Please try again."})}}},T=j=>{j.target===j.currentTarget&&e()};return t?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:`${ft.modalOverlay} ${t?ft.show:""}`,onClick:T,children:a.jsxs("div",{className:ft.modalContent,onClick:j=>j.stopPropagation(),children:[a.jsxs("div",{className:ft.modalHeader,children:[a.jsx("h2",{className:ft.modalTitle,children:"Add New Currency"}),a.jsx("button",{className:ft.modalCloseBtn,onClick:e,children:a.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})})})]}),a.jsxs("div",{className:ft.modalBody,children:[a.jsx(We,{label:"Select Currency",placeholder:"Select currency",value:c,options:E,onChange:k,searchable:!0,showDescriptions:!0,showBadges:!0,fullWidth:!0,emptyMessage:"No currencies available",maxHeight:"300px"}),C&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:ft.currencyInfo,children:[a.jsxs("div",{className:ft.currencyInfoItem,children:[a.jsx("span",{className:ft.currencyInfoLabel,children:"Code:"}),a.jsx("span",{className:ft.currencyInfoValue,children:C.code})]}),a.jsxs("div",{className:ft.currencyInfoItem,children:[a.jsx("span",{className:ft.currencyInfoLabel,children:"Name:"}),a.jsx("span",{className:ft.currencyInfoValue,children:C.name})]}),a.jsxs("div",{className:ft.currencyInfoItem,children:[a.jsx("span",{className:ft.currencyInfoLabel,children:"Symbol:"}),a.jsx("span",{className:ft.currencyInfoValue,children:C.symbol})]})]}),a.jsxs("div",{className:ft.formGroup,children:[a.jsxs("label",{className:ft.formLabel,children:["Exchange Rate (1 ",C.code," = ? ",s,")"]}),a.jsxs("div",{className:ft.exchangeRateWrapper,children:[a.jsx("input",{type:"number",step:"0.0001",className:ft.formInput,value:u,onChange:j=>h(j.target.value),placeholder:"Enter exchange rate"}),a.jsx(be,{variant:"outline",size:"sm",onClick:N,disabled:g,children:g?a.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:a.jsx(Ne,{size:"small"})}):"Get Live Rate"})]})]}),f&&a.jsxs("div",{className:ft.liveRateInfo,children:[a.jsx("span",{className:ft.liveRateLabel,children:"Live Rate:"}),a.jsx("span",{className:ft.liveRateValue,children:f.toFixed(4)}),a.jsx(be,{variant:"text",size:"sm",onClick:I,children:"Use This Rate"})]})]})]}),a.jsxs("div",{className:ft.modalFooter,children:[a.jsx(be,{variant:"outline",size:"md",onClick:e,children:"Cancel"}),a.jsx(be,{variant:"primary",size:"md",onClick:L,disabled:!c||!u||x,children:x?a.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:a.jsx(Ne,{size:"small"})}):"Add Currency"})]})]})}),a.jsx(De,{variant:"error",title:_==null?void 0:_.title,message:(_==null?void 0:_.message)||"",isOpen:!!_,onClose:()=>v(null),zIndex:10001})]}):null},wR="_pageContainer_air4p_2",SR="_pageContent_air4p_8",CR="_pageHeader_air4p_18",jR="_pageHeaderContent_air4p_27",kR="_pageTitle_air4p_31",NR="_pageSubtitle_air4p_38",IR="_statsCard_air4p_47",ER="_statsGrid_air4p_55",TR="_statItem_air4p_61",AR="_statValue_air4p_65",LR="_statLabel_air4p_73",DR="_currencySection_air4p_83",MR="_sectionHeader_air4p_87",RR="_sectionTitle_air4p_94",OR="_currencyGrid_air4p_102",PR="_currencyCard_air4p_109",$R="_currencyCardHeader_air4p_123",FR="_currencyIconWrapper_air4p_131",BR="_currencySymbol_air4p_142",HR="_currencyHeaderInfo_air4p_148",VR="_currencyCode_air4p_152",zR="_currencyName_air4p_159",UR="_currencyBadgePrimary_air4p_165",WR="_currencyCardBody_air4p_174",qR="_currencyDetails_air4p_178",GR="_currencyDetailItem_air4p_184",JR="_currencyDetailLabel_air4p_190",KR="_currencyDetailValue_air4p_198",YR="_currencyCardFooter_air4p_205",QR="_currencyActions_air4p_214",ZR="_emptyContainer_air4p_224",XR="_emptyTitle_air4p_232",eO="_emptyText_air4p_239",ke={pageContainer:wR,pageContent:SR,pageHeader:CR,pageHeaderContent:jR,pageTitle:kR,pageSubtitle:NR,statsCard:IR,statsGrid:ER,statItem:TR,statValue:AR,statLabel:LR,currencySection:DR,sectionHeader:MR,sectionTitle:RR,currencyGrid:OR,currencyCard:PR,currencyCardHeader:$R,currencyIconWrapper:FR,currencySymbol:BR,currencyHeaderInfo:HR,currencyCode:VR,currencyName:zR,currencyBadgePrimary:UR,currencyCardBody:WR,currencyDetails:qR,currencyDetailItem:GR,currencyDetailLabel:JR,currencyDetailValue:KR,currencyCardFooter:YR,currencyActions:QR,emptyContainer:ZR,emptyTitle:XR,emptyText:eO},tO=()=>{const{currentCompany:t,currentUser:e}=at();let r=(e==null?void 0:e.user_id)||"";if(!r)try{const C=sessionStorage.getItem("userData")||localStorage.getItem("userData")||localStorage.getItem("user");C&&(r=JSON.parse(C).user_id||"")}catch(C){console.error("Failed to parse stored user data:",C)}const{currencies:s,loading:n,editingCurrency:o,showAddModal:i,currencyToRemove:l,isRemoving:c,notification:d,setEditingCurrency:u,setShowAddModal:h,setCurrencyToRemove:f,clearNotification:p,getAllCurrencyTypes:g,updateExchangeRate:y,addCurrency:x,handleEditCurrency:m,handleRemoveCurrency:_,confirmRemoveCurrency:v}=L3((t==null?void 0:t.company_id)||"",r);if(n)return a.jsxs(a.Fragment,{children:[a.jsx(fe,{activeItem:"setting"}),a.jsx("div",{className:ke.pageContainer,children:a.jsx("main",{className:ke.pageContent,children:a.jsx(Ne,{size:"large",fullscreen:!0})})})]});if(!t)return a.jsxs(a.Fragment,{children:[a.jsx(fe,{activeItem:"setting"}),a.jsx("div",{className:ke.pageContainer,children:a.jsx("main",{className:ke.pageContent,children:a.jsxs("div",{className:ke.emptyContainer,children:[a.jsx("h2",{className:ke.emptyTitle,children:"No Company Selected"}),a.jsx("p",{className:ke.emptyText,children:"Please select a company to manage currencies"})]})})})]});const w=s.length,S=s.length,E=s.find(C=>C.isDefault);return a.jsxs(a.Fragment,{children:[a.jsx(fe,{activeItem:"setting"}),a.jsx("div",{className:ke.pageContainer,children:a.jsxs("main",{className:ke.pageContent,children:[a.jsxs("div",{className:ke.pageHeader,children:[a.jsxs("div",{className:ke.pageHeaderContent,children:[a.jsx("h1",{className:ke.pageTitle,children:"Currency Settings"}),a.jsx("p",{className:ke.pageSubtitle,children:"Manage your company's currencies and exchange rates"})]}),a.jsxs(be,{variant:"primary",size:"md",onClick:()=>h(!0),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor",style:{marginRight:"8px"},children:a.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"})}),"Add Currency"]})]}),s.length>0&&a.jsx("div",{className:ke.statsCard,children:a.jsxs("div",{className:ke.statsGrid,children:[a.jsxs("div",{className:ke.statItem,children:[a.jsx("p",{className:ke.statValue,children:w}),a.jsx("p",{className:ke.statLabel,children:"Total Currencies"})]}),a.jsxs("div",{className:ke.statItem,children:[a.jsx("p",{className:ke.statValue,children:S}),a.jsx("p",{className:ke.statLabel,children:"Active Currencies"})]}),a.jsxs("div",{className:ke.statItem,children:[a.jsx("p",{className:ke.statValue,children:(E==null?void 0:E.code)||"-"}),a.jsx("p",{className:ke.statLabel,children:"Primary Currency"})]})]})}),a.jsxs("div",{className:ke.currencySection,children:[a.jsx("div",{className:ke.sectionHeader,children:a.jsx("h2",{className:ke.sectionTitle,children:"Configured Currencies"})}),a.jsx("div",{className:ke.currencyGrid,children:s.map(C=>a.jsxs("div",{className:ke.currencyCard,children:[a.jsxs("div",{className:ke.currencyCardHeader,children:[a.jsx("div",{className:ke.currencyIconWrapper,children:a.jsx("span",{className:ke.currencySymbol,children:C.symbol})}),a.jsxs("div",{className:ke.currencyHeaderInfo,children:[a.jsx("h3",{className:ke.currencyCode,children:C.code}),a.jsx("p",{className:ke.currencyName,children:C.name})]}),C.isDefault&&a.jsx("span",{className:ke.currencyBadgePrimary,children:"DEFAULT"})]}),a.jsx("div",{className:ke.currencyCardBody,children:a.jsx("div",{className:ke.currencyDetails,children:a.jsxs("div",{className:ke.currencyDetailItem,children:[a.jsx("span",{className:ke.currencyDetailLabel,children:"Exchange Rate"}),a.jsx("span",{className:ke.currencyDetailValue,children:(C.exchangeRate||1).toFixed(4)})]})})}),a.jsx("div",{className:ke.currencyCardFooter,children:a.jsxs("div",{className:ke.currencyActions,children:[a.jsx(be,{variant:"outline",size:"sm",onClick:()=>m(C),children:"Edit"}),!C.isDefault&&a.jsx(be,{variant:"outline",size:"sm",onClick:()=>_(C),children:"Remove"})]})})]},C.currencyId))})]})]})}),a.jsx(bR,{isOpen:i,onClose:()=>h(!1),existingCurrencies:s,baseCurrencyCode:(E==null?void 0:E.code)||"",onGetAllCurrencyTypes:g,onAddCurrency:x}),a.jsx(tR,{currency:o,baseCurrencyCode:(E==null?void 0:E.code)||"",onClose:()=>u(null),onSave:y}),a.jsx(De,{variant:(d==null?void 0:d.variant)||"error",message:(d==null?void 0:d.message)||"",isOpen:!!d,onClose:p,autoCloseDuration:2e3,zIndex:1e4}),a.jsx(pm,{isOpen:!!l,onClose:()=>f(null),onConfirm:v,variant:"error",title:"Remove Currency",message:`Are you sure you want to remove ${l==null?void 0:l.code}? This action cannot be undone.`,confirmText:"Remove",cancelText:"Cancel",confirmButtonVariant:"error",isLoading:c,closeOnBackdropClick:!0,closeOnEscape:!c,children:l&&a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px",marginTop:"16px"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[a.jsx("span",{style:{fontSize:"14px",fontWeight:600,color:"#6C757D"},children:"Currency Code:"}),a.jsx("span",{style:{fontSize:"14px",fontWeight:600,color:"#212529"},children:l.code})]}),a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[a.jsx("span",{style:{fontSize:"14px",fontWeight:600,color:"#6C757D"},children:"Currency Name:"}),a.jsx("span",{style:{fontSize:"14px",fontWeight:500,color:"#212529"},children:l.name})]}),a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[a.jsx("span",{style:{fontSize:"14px",fontWeight:600,color:"#6C757D"},children:"Exchange Rate:"}),a.jsx("span",{style:{fontFamily:"Pretendard, -apple-system, BlinkMacSystemFont, system-ui, sans-serif",fontSize:"14px",fontWeight:600,color:"#212529"},children:(l.exchangeRate||1).toFixed(4)})]})]})})]})};class rO{async getSalaryData(e,r){try{const s=ne.getClient(),{data:n,error:o}=await s.rpc("get_employee_salary",{p_company_id:e,p_month:r});return o?(console.error("Salary RPC error:",o),{success:!1,error:o.message||"Failed to fetch salary data"}):n?{success:!0,data:n}:{success:!1,error:"No data returned from salary query"}}catch(s){return console.error("Salary datasource error:",s),{success:!1,error:s instanceof Error?s.message:"Unknown error occurred"}}}async exportToExcel(e,r){try{const s=ne.getClient(),{data:n,error:o}=await s.rpc("get_employee_salary_excel",{p_company_id:e,p_month:r});return o?(console.error("Salary Excel RPC error:",o),{success:!1,error:o.message||"Failed to export salary data"}):{success:!0,data:n}}catch(s){return console.error("Salary Excel export error:",s),{success:!1,error:s instanceof Error?s.message:"Unknown error occurred"}}}}class gm{constructor(e,r,s,n,o,i,l,c,d,u,h,f=null,p="pending"){this.userId=e,this.fullName=r,this.email=s,this.roleName=n,this.storeName=o,this.baseSalary=i,this.bonuses=l,this.deductions=c,this.totalSalary=d,this.currencySymbol=u,this.currencyCode=h,this.paymentDate=f,this.status=p}get netSalary(){return this.totalSalary}formatAmount(e){return`${this.currencySymbol}${e.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})}`}get formattedBaseSalary(){return this.formatAmount(this.baseSalary)}get formattedBonuses(){return this.formatAmount(this.bonuses)}get formattedDeductions(){return this.formatAmount(this.deductions)}get formattedTotalSalary(){return this.formatAmount(this.totalSalary)}get isOverdue(){return!this.paymentDate||this.status==="paid"?!1:this.paymentDate<new Date}static create(e){return new gm(e.user_id,e.full_name,e.email,e.role_name,e.store_name,e.base_salary||0,e.bonuses||0,e.deductions||0,e.total_salary||0,e.currency_symbol,e.currency_code,e.payment_date||null,e.status||"pending")}}class Xc{constructor(e,r,s,n,o,i,l){this.period=e,this.totalEmployees=r,this.totalSalary=s,this.averageSalary=n,this.totalBonuses=o,this.totalDeductions=i,this.currencySymbol=l}formatAmount(e){return`${this.currencySymbol}${e.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})}`}get formattedTotalSalary(){return this.formatAmount(this.totalSalary)}get formattedAverageSalary(){return this.formatAmount(this.averageSalary)}get formattedTotalBonuses(){return this.formatAmount(this.totalBonuses)}get formattedTotalDeductions(){return this.formatAmount(this.totalDeductions)}static create(e){return new Xc(e.period,e.total_employees||0,e.total_salary||0,e.average_salary||0,e.total_bonuses||0,e.total_deductions||0,e.currency_symbol)}static empty(e,r="$"){return new Xc(e,0,0,0,0,0,r)}}class sO{static employeeFromSupabase(e){var d;const r=e.currency_info||{currency_symbol:"$",currency_code:"USD"},s=e.salary_info,n=(s==null?void 0:s.base_info)||{},o=(s==null?void 0:s.deductions)||{},i=(s==null?void 0:s.bonuses)||{},l=((d=e.stores)==null?void 0:d.map(u=>u.store_name).join(", "))||"N/A";let c=0;return e.salary_type==="hourly"?c=(n.worked_hours||0)*(n.hourly_rate||0):c=n.monthly_salary||n.base_payment||0,gm.create({user_id:e.user_id,full_name:e.user_name,email:e.email,role_name:e.role_name||"N/A",store_name:l,base_salary:c,bonuses:i.bonus_amount||0,deductions:o.late_deduction_amount||0,total_salary:(s==null?void 0:s.total_payment)||0,currency_symbol:r.currency_symbol,currency_code:r.currency_code,payment_date:e.payment_date?te.toLocal(e.payment_date):null,status:e.status||"pending"})}static summaryFromSupabase(e,r){const s=r.base_currency||{currency_symbol:"$"},n=r.total_payment||r.total_salary||0;return Xc.create({period:e,total_employees:r.total_employees||0,total_salary:n,average_salary:r.average_salary||0,total_bonuses:r.total_bonuses||0,total_deductions:r.total_deductions||0,currency_symbol:s.currency_symbol})}static fromSupabase(e){const r=(e.employees||[]).map(n=>this.employeeFromSupabase(n)),s=this.summaryFromSupabase(e.period,e.summary);return{records:r,summary:s}}}class nO{constructor(){W(this,"dataSource");this.dataSource=new rO}async getSalaryData(e,r){try{const s=await this.dataSource.getSalaryData(e,r);if(!s.success||!s.data)return{success:!1,error:s.error||"Failed to fetch salary data"};const{records:n,summary:o}=sO.fromSupabase(s.data);return{success:!0,records:n,summary:o}}catch(s){return{success:!1,error:s instanceof Error?s.message:"An unexpected error occurred"}}}async exportToExcel(e,r,s=null,n="Company",o="AllStores"){try{const i=await Xf(()=>import("./exceljs.min-CcsQJMWo.js").then(m=>m.e),[]),l=await this.dataSource.exportToExcel(e,r);if(!l.success||!l.data)return{success:!1,error:l.error||"Failed to export salary data"};const c=l.data;if(!c||c.length===0)return{success:!1,error:"No data available for export in the selected period"};console.log(`Excel export data received: ${c.length} shift records`);const d=c.map(m=>({shift_request_id:m.shift_request_id||"",user_id:m.user_id||"",first_name:m.first_name||"",last_name:m.last_name||"",user_name:m.user_name||"",user_email:m.user_email||"",store_name:m.store_name||"",store_code:m.store_code||"",request_date:m.request_date?te.formatDateOnly(te.toLocal(m.request_date)):"",shift_name:m.shift_name||"",start_time:m.start_time?te.format(te.toLocal(m.start_time)):"",end_time:m.end_time?te.format(te.toLocal(m.end_time)):"",actual_start_time:m.actual_start_time?te.format(te.toLocal(m.actual_start_time)):"",actual_end_time:m.actual_end_time?te.format(te.toLocal(m.actual_end_time)):"",confirm_start_time:m.confirm_start_time?te.format(te.toLocal(m.confirm_start_time)):"",confirm_end_time:m.confirm_end_time?te.format(te.toLocal(m.confirm_end_time)):"",scheduled_hours:m.scheduled_hours||0,actual_worked_hours:m.actual_worked_hours||0,paid_hours:m.paid_hours||0,is_late:m.is_late?"Yes":"No",late_minutes:m.late_minutes||0,late_deduction_krw:m.late_deduction_krw||0,is_extratime:m.is_extratime?"Yes":"No",overtime_minutes:m.overtime_minutes||0,overtime_amount:m.overtime_amount||0,salary_type:m.salary_type||"",salary_amount:m.salary_amount||0,bonus_amount:m.bonus_amount||0,total_salary_pay:m.total_salary_pay||0,total_pay_with_bonus:m.total_pay_with_bonus||0,is_approved:m.is_approved?"Yes":"No",is_problem:m.is_problem?"Yes":"No",problem_type:m.problem_type||"",report_reason:m.report_reason||""})),u=new i.Workbook,h=u.addWorksheet("Shift Records");h.columns=[{header:"shift_request_id",key:"shift_request_id",width:36},{header:"user_id",key:"user_id",width:36},{header:"first_name",key:"first_name",width:15},{header:"last_name",key:"last_name",width:15},{header:"user_name",key:"user_name",width:20},{header:"user_email",key:"user_email",width:25},{header:"store_name",key:"store_name",width:20},{header:"store_code",key:"store_code",width:12},{header:"request_date",key:"request_date",width:12},{header:"shift_name",key:"shift_name",width:15},{header:"start_time",key:"start_time",width:18},{header:"end_time",key:"end_time",width:18},{header:"actual_start_time",key:"actual_start_time",width:18},{header:"actual_end_time",key:"actual_end_time",width:18},{header:"confirm_start_time",key:"confirm_start_time",width:18},{header:"confirm_end_time",key:"confirm_end_time",width:18},{header:"scheduled_hours",key:"scheduled_hours",width:14},{header:"actual_worked_hours",key:"actual_worked_hours",width:16},{header:"paid_hours",key:"paid_hours",width:12},{header:"is_late",key:"is_late",width:8},{header:"late_minutes",key:"late_minutes",width:12},{header:"late_deduction_krw",key:"late_deduction_krw",width:16},{header:"is_extratime",key:"is_extratime",width:10},{header:"overtime_minutes",key:"overtime_minutes",width:15},{header:"overtime_amount",key:"overtime_amount",width:15},{header:"salary_type",key:"salary_type",width:12},{header:"salary_amount",key:"salary_amount",width:15},{header:"bonus_amount",key:"bonus_amount",width:15},{header:"total_salary_pay",key:"total_salary_pay",width:16},{header:"total_pay_with_bonus",key:"total_pay_with_bonus",width:18},{header:"is_approved",key:"is_approved",width:12},{header:"is_problem",key:"is_problem",width:12},{header:"problem_type",key:"problem_type",width:15},{header:"report_reason",key:"report_reason",width:20}],d.forEach(m=>{h.addRow(m)});const f=h.getRow(1);f.font={name:"Arial",size:18,bold:!0},f.alignment={vertical:"middle",horizontal:"center",wrapText:!1},f.height=30,f.eachCell({includeEmpty:!1},m=>{m.border={bottom:{style:"thick",color:{argb:"FF000000"}}},m.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFF2F2F2"}}});const p=m=>m.replace(/[^a-zA-Z0-9-\s-]/g,"").replace(/\s+/g,"_"),g=`ShiftRecords_${p(n)}_${p(o)}_${r}.xlsx`,y=await u.xlsx.writeBuffer();return{success:!0,blob:new Blob([y],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),filename:g,recordCount:c.length}}catch(i){return console.error("Export to Excel error:",i),{success:!1,error:i instanceof Error?i.message:"An unexpected error occurred"}}}}class ku{static validateCompanyId(e){const r=[];return!e||e.trim()===""?(r.push({field:"companyId",message:"Company ID is required"}),r):(/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e)||r.push({field:"companyId",message:"Invalid company ID format"}),r)}static validateMonthFormat(e){const r=[];if(!e||e.trim()==="")return r.push({field:"month",message:"Month is required"}),r;if(!/^\d{4}-(0[1-9]|1[0-2])$/.test(e))return r.push({field:"month",message:"Invalid month format. Expected YYYY-MM (e.g., 2025-11)"}),r;const[n,o]=e.split("-").map(Number),i=new Date(n,o-1,1),l=new Date,c=new Date(l.getFullYear(),l.getMonth(),1);i>c&&r.push({field:"month",message:"Cannot query future months"});const d=new Date(l.getFullYear()-5,l.getMonth(),1);return i<d&&r.push({field:"month",message:"Cannot query data older than 5 years"}),r}static validateSalaryQuery(e,r){const s=[],n=this.validateCompanyId(e);s.push(...n);const o=this.validateMonthFormat(r);return s.push(...o),s}static validateExcelExport(e,r,s,n){const o=[],i=this.validateSalaryQuery(e,r);return o.push(...i),!s||s.trim()===""?o.push({field:"companyName",message:"Company name is required for export"}):s.length>100&&o.push({field:"companyName",message:"Company name is too long (max 100 characters)"}),!n||n.trim()===""?o.push({field:"storeName",message:"Store name is required for export"}):n.length>100&&o.push({field:"storeName",message:"Store name is too long (max 100 characters)"}),o}static validateStoreId(e){const r=[];return e===null||e===""||/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e)||r.push({field:"storeId",message:"Invalid store ID format"}),r}}const O_=new nO,Nu=()=>{const t=new Date;return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}`},yr=Jt((t,e)=>({records:[],summary:null,currentMonth:Nu(),companyId:"",loading:!1,exporting:!1,error:null,notification:null,setRecords:r=>t({records:r}),setSummary:r=>t({summary:r}),setCurrentMonth:r=>t({currentMonth:r}),setCompanyId:r=>t({companyId:r}),setLoading:r=>t({loading:r}),setExporting:r=>t({exporting:r}),setError:r=>t({error:r}),setNotification:r=>t({notification:r}),clearErrors:()=>t({error:null,notification:null}),loadSalaryData:async(r,s)=>{t({loading:!0,error:null});try{const n=ku.validateSalaryQuery(r,s);if(n.length>0){const i=n.map(l=>l.message).join(", ");return t({error:i,records:[],summary:null,loading:!1}),{success:!1,error:i}}const o=await O_.getSalaryData(r,s);if(console.log("Salary Data Result:",o),!o.success){const i=o.error||"Failed to load salary data";return t({error:i,records:[],summary:null}),{success:!1,error:i}}return console.log("Salary Records:",o.records),o.records&&o.records.length>0&&(console.log("First Record:",o.records[0]),console.log("Record fullName:",o.records[0].fullName),console.log("Record totalSalary:",o.records[0].totalSalary)),console.log("Salary Summary:",o.summary),t({records:o.records||[],summary:o.summary||null,error:null}),{success:!0}}catch(n){console.error("Salary data error:",n);const o=n instanceof Error?n.message:"An unexpected error occurred";return t({error:o,records:[],summary:null}),{success:!1,error:o}}finally{t({loading:!1})}},refresh:async()=>{const{companyId:r,currentMonth:s,loadSalaryData:n}=e();return r?n(r,s):{success:!1,error:"Company ID is required"}},goToPreviousMonth:()=>{const r=e().currentMonth,[s,n]=r.split("-").map(Number),o=new Date(s,n-1,1);o.setMonth(o.getMonth()-1);const i=`${o.getFullYear()}-${String(o.getMonth()+1).padStart(2,"0")}`;t({currentMonth:i})},goToNextMonth:()=>{const r=e().currentMonth,[s,n]=r.split("-").map(Number),o=new Date(s,n-1,1);o.setMonth(o.getMonth()+1);const i=`${o.getFullYear()}-${String(o.getMonth()+1).padStart(2,"0")}`;t({currentMonth:i})},goToCurrentMonth:()=>{t({currentMonth:Nu()})},exportToExcel:async(r,s,n)=>{const{companyId:o,currentMonth:i}=e(),l=ku.validateExcelExport(o,i,s,n);if(l.length>0){const d=l.map(u=>u.message).join(", ");return t({notification:{variant:"error",title:"Validation Error",message:d}}),{success:!1,error:d}}if(r!==null){const d=ku.validateStoreId(r);if(d.length>0){const u=d.map(h=>h.message).join(", ");return t({notification:{variant:"error",title:"Validation Error",message:u}}),{success:!1,error:u}}}let c=null;if("showSaveFilePicker"in window)try{const d=h=>h.replace(/[^a-zA-Z0-9-\s-]/g,"").replace(/\s+/g,"_"),u=`ShiftRecords_${d(s)}_${d(n)}_${i}.xlsx`;c=await window.showSaveFilePicker({suggestedName:u,types:[{description:"Excel Files",accept:{"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[".xlsx"]}}],excludeAcceptAllOption:!0}),console.log("File handle obtained successfully")}catch(d){if(d&&d.name==="AbortError")return console.log("User cancelled file selection"),{success:!1,error:"User cancelled"};console.log("Could not get file handle:",(d==null?void 0:d.name)||"Unknown error")}t({exporting:!0});try{const d=await O_.exportToExcel(o,i,r,s,n);if(!d.success||!d.blob)throw new Error(d.error||"Failed to export data");const u=d.blob,h=d.filename||`salary_${i}.xlsx`;if(c)try{console.log("Writing to pre-obtained file handle...");const f=await c.createWritable();await f.write(u),await f.close(),console.log(`Excel file saved successfully: ${h}`),t({notification:{variant:"success",message:`${d.recordCount||0} shift records exported successfully to: ${h}`}})}catch(f){console.error("Failed to write to file handle:",f),P_(u,h,t)}else P_(u,h,t);return{success:!0}}catch(d){console.error("Export error:",d);const u=d instanceof Error?d.message:"Failed to export data";return t({notification:{variant:"error",title:"Export Failed",message:u}}),{success:!1,error:u}}finally{t({exporting:!1})}},reset:()=>t({records:[],summary:null,currentMonth:Nu(),companyId:"",loading:!1,exporting:!1,error:null,notification:null})})),P_=(t,e,r)=>{try{const s=URL.createObjectURL(t),n=document.createElement("a");n.href=s,n.download=e,n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(s),setTimeout(()=>{const o=` File "${e}" is being saved to your browser's default download folder. To change download location, check your browser settings.`;console.log(o),r({notification:{variant:"success",message:`File "${e}" has been downloaded successfully.`}})},1e3)}catch(s){console.error("Fallback download failed:",s),r({notification:{variant:"error",title:"Download Failed",message:"Failed to download the Excel file. Please try again."}})}},oO=(t,e)=>{const r=yr(_=>_.records),s=yr(_=>_.summary),n=yr(_=>_.loading),o=yr(_=>_.error),i=yr(_=>_.currentMonth),l=yr(_=>_.exporting),c=yr(_=>_.notification),d=yr(_=>_.setNotification),u=yr(_=>_.setCompanyId),h=yr(_=>_.setCurrentMonth),f=yr(_=>_.loadSalaryData),p=yr(_=>_.refresh),g=yr(_=>_.goToPreviousMonth),y=yr(_=>_.goToNextMonth),x=yr(_=>_.goToCurrentMonth),m=yr(_=>_.exportToExcel);return b.useEffect(()=>{t&&u(t)},[t,u]),b.useEffect(()=>{e&&h(e)},[e,h]),b.useEffect(()=>{t&&i&&f(t,i)},[t,i,f]),{records:r,summary:s,loading:n,error:o,currentMonth:i,exporting:l,notification:c,setNotification:d,refresh:p,goToPreviousMonth:g,goToNextMonth:y,goToCurrentMonth:x,exportToExcel:m}},aO="_pageContainer_krja1_2",iO="_salaryContainer_krja1_10",lO="_salaryHeader_krja1_19",cO="_salaryTitleSection_krja1_28",dO="_salaryTitle_krja1_28",uO="_salarySubtitle_krja1_41",hO="_periodControlsWrapper_krja1_48",fO="_exportExcelBtn_krja1_55",mO="_spinAnimation_krja1_93",pO="_periodControls_krja1_48",gO="_periodNavBtn_krja1_118",_O="_periodDisplay_krja1_138",yO="_active_krja1_244",vO="_summarySection_krja1_318",xO="_summaryCard_krja1_325",bO="_summaryLabel_krja1_338",wO="_summaryValue_krja1_347",SO="_total_krja1_355",CO="_problems_krja1_359",jO="_summaryDetail_krja1_363",kO="_summaryIcon_krja1_369",NO="_filterBar_krja1_376",IO="_searchBox_krja1_388",EO="_searchInput_krja1_394",TO="_searchIcon_krja1_409",AO="_filterChip_krja1_419",LO="_employeeList_krja1_442",DO="_employeeCard_krja1_448",MO="_employeeHeader_krja1_461",RO="_employeeMainInfo_krja1_471",OO="_employeeIdentity_krja1_478",PO="_employeeAvatar_krja1_484",$O="_employeeInfo_krja1_497",FO="_employeeName_krja1_503",BO="_employeeType_krja1_509",HO="_monthly_krja1_519",VO="_employeeSalarySummary_krja1_530",zO="_totalPayment_krja1_537",UO="_paymentBreakdown_krja1_544",WO="_employeeStores_krja1_550",qO="_storeBadge_krja1_556",GO="_employeeQuickStats_krja1_566",JO="_quickStat_krja1_574",KO="_quickStatLabel_krja1_581",YO="_quickStatValue_krja1_585",QO="_positive_krja1_590",ZO="_negative_krja1_594",XO="_expandIcon_krja1_603",e6="_expanded_krja1_611",t6="_employeeDetails_krja1_616",r6="_detailsContent_krja1_628",s6="_detailSection_krja1_633",n6="_detailSectionTitle_krja1_641",o6="_salaryBreakdownTable_krja1_651",a6="_breakdownRow_krja1_657",i6="_breakdownLabel_krja1_670",l6="_breakdownValue_krja1_675",c6="_notRegistered_krja1_690",d6="_emptyState_krja1_720",u6="_emptyIcon_krja1_728",h6="_emptyTitle_krja1_735",f6="_emptyText_krja1_742",B={pageContainer:aO,salaryContainer:iO,salaryHeader:lO,salaryTitleSection:cO,salaryTitle:dO,salarySubtitle:uO,periodControlsWrapper:hO,exportExcelBtn:fO,spinAnimation:mO,periodControls:pO,periodNavBtn:gO,periodDisplay:_O,active:yO,summarySection:vO,summaryCard:xO,summaryLabel:bO,summaryValue:wO,total:SO,problems:CO,summaryDetail:jO,summaryIcon:kO,filterBar:NO,searchBox:IO,searchInput:EO,searchIcon:TO,filterChip:AO,employeeList:LO,employeeCard:DO,employeeHeader:MO,employeeMainInfo:RO,employeeIdentity:OO,employeeAvatar:PO,employeeInfo:$O,employeeName:FO,employeeType:BO,monthly:HO,employeeSalarySummary:VO,totalPayment:zO,paymentBreakdown:UO,employeeStores:WO,storeBadge:qO,employeeQuickStats:GO,quickStat:JO,quickStatLabel:KO,quickStatValue:YO,positive:QO,negative:ZO,expandIcon:XO,expanded:e6,employeeDetails:t6,detailsContent:r6,detailSection:s6,detailSectionTitle:n6,salaryBreakdownTable:o6,breakdownRow:a6,breakdownLabel:i6,breakdownValue:l6,notRegistered:c6,emptyState:d6,emptyIcon:u6,emptyTitle:h6,emptyText:f6},m6=({initialMonth:t})=>{const{currentCompany:e}=at(),r=(e==null?void 0:e.company_id)||"",[s,n]=b.useState(null),[o,i]=b.useState(""),[l,c]=b.useState("all"),[d,u]=b.useState(new Set),{records:h,summary:f,loading:p,error:g,currentMonth:y,exporting:x,notification:m,setNotification:_,refresh:v,goToPreviousMonth:w,goToNextMonth:S,exportToExcel:E}=oO(r,t),C=T=>T,k=T=>{const j=new Set(d);j.has(T)?j.delete(T):j.add(T),u(j)},N=h.filter(T=>!(o&&!T.fullName.toLowerCase().includes(o.toLowerCase())||s&&T.storeName!==s||l==="monthly"&&!T.roleName.toLowerCase().includes("monthly")||l==="hourly"&&!T.roleName.toLowerCase().includes("hourly")||l==="problems"&&T.status!=="pending")),I=T=>T&&T.split(" ").map(j=>j[0]).join("").toUpperCase().slice(0,2)||"??";if(!e)return a.jsxs(a.Fragment,{children:[a.jsx(fe,{activeItem:"employee"}),a.jsx("div",{className:B.pageContainer,children:a.jsx("div",{className:B.salaryContainer,children:a.jsx(Ne,{size:"large",fullscreen:!0})})})]});if(p)return a.jsxs(a.Fragment,{children:[a.jsx(fe,{activeItem:"employee"}),a.jsx("div",{className:B.pageContainer,children:a.jsx("div",{className:B.salaryContainer,children:a.jsx(Ne,{size:"large",fullscreen:!0})})})]});const L=(e==null?void 0:e.stores)||[];return a.jsxs(a.Fragment,{children:[a.jsx(fe,{activeItem:"employee"}),a.jsx("div",{className:B.pageContainer,children:a.jsxs("div",{className:B.salaryContainer,children:[a.jsxs("div",{className:B.salaryHeader,children:[a.jsxs("div",{className:B.salaryTitleSection,children:[a.jsx("h1",{className:B.salaryTitle,children:"Salary Management"}),a.jsx("p",{className:B.salarySubtitle,children:"Manage employee compensation and payroll"})]}),a.jsxs("div",{className:B.periodControlsWrapper,children:[a.jsx("button",{className:B.exportExcelBtn,onClick:()=>{const T=(e==null?void 0:e.company_name)||"Company";let j="AllStores";if(s){const M=L.find(R=>R.store_id===s);j=(M==null?void 0:M.store_name)||"Store"}E(s,T,j)},disabled:x||h.length===0,children:x?a.jsxs(a.Fragment,{children:[a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",className:B.spinAnimation,children:a.jsx("path",{d:"M12,4V2A10,10 0 0,0 2,12H4A8,8 0 0,1 12,4Z"})}),a.jsx("span",{children:"Exporting..."})]}):a.jsxs(a.Fragment,{children:[a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"})}),a.jsx("span",{children:"Export Excel"})]})}),a.jsxs("div",{className:B.periodControls,children:[a.jsx("button",{className:B.periodNavBtn,onClick:w,children:""}),a.jsx("div",{className:B.periodDisplay,children:C(y)}),a.jsx("button",{className:B.periodNavBtn,onClick:S,children:""})]})]})]}),a.jsx(Hs,{stores:L,selectedStoreId:s,onStoreSelect:n,companyId:r}),f&&a.jsxs("div",{className:B.summarySection,children:[a.jsxs("div",{className:B.summaryCard,children:[a.jsxs("div",{className:B.summaryLabel,children:[a.jsx("svg",{className:B.summaryIcon,viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M16,13C15.71,13 15.38,13 15.03,13.05C16.19,13.89 17,15 17,16.5V19H23V16.5C23,14.17 18.33,13 16,13M8,13C5.67,13 1,14.17 1,16.5V19H15V16.5C15,14.17 10.33,13 8,13M8,11A3,3 0 0,0 11,8A3,3 0 0,0 8,5A3,3 0 0,0 5,8A3,3 0 0,0 8,11M16,11A3,3 0 0,0 19,8A3,3 0 0,0 16,5A3,3 0 0,0 13,8A3,3 0 0,0 16,11Z"})}),"Total Employees"]}),a.jsx("div",{className:B.summaryValue,children:f.totalEmployees}),a.jsxs("div",{className:B.summaryDetail,children:["Monthly: ",N.length," | Hourly: 0"]})]}),a.jsxs("div",{className:B.summaryCard,children:[a.jsxs("div",{className:B.summaryLabel,children:[a.jsx("svg",{className:B.summaryIcon,viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4M11,17V16H9V14H13V13H10A1,1 0 0,1 9,12V9A1,1 0 0,1 10,8H11V7H13V8H15V10H11V11H14A1,1 0 0,1 15,12V15A1,1 0 0,1 14,16H13V17H11Z"})}),"Total Payment"]}),a.jsx("div",{className:`${B.summaryValue} ${B.total}`,children:f.formattedTotalSalary}),a.jsxs("div",{className:B.summaryDetail,children:["Base: ",f.formattedTotalSalary]})]}),a.jsxs("div",{className:B.summaryCard,children:[a.jsxs("div",{className:B.summaryLabel,children:[a.jsx("svg",{className:B.summaryIcon,viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12,2A2,2 0 0,1 14,4C14,4.74 13.6,5.39 13,5.73V7H14A7,7 0 0,1 21,14H22A1,1 0 0,1 23,15V18A1,1 0 0,1 22,19H21V20A2,2 0 0,1 19,22H5A2,2 0 0,1 3,20V19H2A1,1 0 0,1 1,18V15A1,1 0 0,1 2,14H3A7,7 0 0,1 10,7H11V5.73C10.4,5.39 10,4.74 10,4A2,2 0 0,1 12,2M7.5,13A2.5,2.5 0 0,0 5,15.5A2.5,2.5 0 0,0 7.5,18A2.5,2.5 0 0,0 10,15.5A2.5,2.5 0 0,0 7.5,13M16.5,13A2.5,2.5 0 0,0 14,15.5A2.5,2.5 0 0,0 16.5,18A2.5,2.5 0 0,0 19,15.5A2.5,2.5 0 0,0 16.5,13Z"})}),"Problems"]}),a.jsx("div",{className:`${B.summaryValue} ${B.problems}`,children:"0"}),a.jsx("div",{className:B.summaryDetail,children:"Total: 0 | Solved: 0"})]})]}),a.jsxs("div",{className:B.filterBar,children:[a.jsxs("div",{className:B.searchBox,children:[a.jsx("svg",{className:B.searchIcon,viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"})}),a.jsx("input",{type:"text",className:B.searchInput,placeholder:"Search by employee name...",value:o,onChange:T=>i(T.target.value)})]}),a.jsx("button",{className:`${B.filterChip} ${l==="all"?B.active:""}`,onClick:()=>c("all"),children:"All Employees"}),a.jsx("button",{className:`${B.filterChip} ${l==="monthly"?B.active:""}`,onClick:()=>c("monthly"),children:"Monthly"}),a.jsx("button",{className:`${B.filterChip} ${l==="hourly"?B.active:""}`,onClick:()=>c("hourly"),children:"Hourly"}),a.jsx("button",{className:`${B.filterChip} ${l==="problems"?B.active:""}`,onClick:()=>c("problems"),children:"Has Problems"}),a.jsx("button",{className:`${B.filterChip} ${l==="overtime"?B.active:""}`,onClick:()=>c("overtime"),children:"Overtime"})]}),N.length===0?a.jsxs("div",{className:B.emptyState,children:[a.jsxs("svg",{className:B.emptyIcon,width:"120",height:"120",viewBox:"0 0 120 120",fill:"none",children:[a.jsx("circle",{cx:"60",cy:"60",r:"50",fill:"#F0F6FF"}),a.jsx("rect",{x:"30",y:"45",width:"60",height:"40",rx:"6",fill:"white",stroke:"#0064FF",strokeWidth:"2"}),a.jsx("rect",{x:"30",y:"55",width:"60",height:"8",fill:"#0064FF"}),a.jsx("rect",{x:"38",y:"68",width:"12",height:"10",rx:"2",fill:"#E9ECEF"}),a.jsx("line",{x1:"41",y1:"68",x2:"41",y2:"78",stroke:"#ADB5BD",strokeWidth:"1"}),a.jsx("line",{x1:"47",y1:"68",x2:"47",y2:"78",stroke:"#ADB5BD",strokeWidth:"1"}),a.jsx("circle",{cx:"75",cy:"73",r:"10",fill:"#0064FF"}),a.jsx("text",{x:"75",y:"78",textAnchor:"middle",fill:"white",fontSize:"14",fontWeight:"600",children:"$"})]}),a.jsx("h3",{className:B.emptyTitle,children:"No Salary Records"}),a.jsx("p",{className:B.emptyText,children:"No employees found matching your criteria"})]}):a.jsx("div",{className:B.employeeList,children:N.map(T=>a.jsxs("div",{className:`${B.employeeCard} ${d.has(T.userId)?B.expanded:""}`,children:[a.jsxs("div",{className:B.employeeHeader,onClick:()=>k(T.userId),children:[a.jsxs("div",{className:B.employeeMainInfo,children:[a.jsxs("div",{className:B.employeeIdentity,children:[a.jsx("div",{className:B.employeeAvatar,children:I(T.fullName)}),a.jsxs("div",{className:B.employeeInfo,children:[a.jsx("div",{className:B.employeeName,children:T.fullName}),a.jsx("span",{className:`${B.employeeType} ${B.monthly}`,children:"Monthly"})]})]}),a.jsxs("div",{className:B.employeeSalarySummary,children:[a.jsx("div",{className:B.totalPayment,children:T.formattedTotalSalary}),a.jsxs("div",{className:B.paymentBreakdown,children:["Base: ",T.formattedBaseSalary]})]})]}),a.jsx("div",{className:B.employeeStores,children:a.jsx("span",{className:B.storeBadge,children:T.storeName})}),a.jsxs("div",{className:B.employeeQuickStats,children:[a.jsxs("div",{className:B.quickStat,children:[a.jsx("span",{className:B.quickStatLabel,children:"Late:"}),a.jsx("span",{className:B.quickStatValue,children:"0 times"})]}),a.jsxs("div",{className:B.quickStat,children:[a.jsx("span",{className:B.quickStatLabel,children:"Overtime:"}),a.jsx("span",{className:B.quickStatValue,children:"0 hours"})]}),a.jsxs("div",{className:B.quickStat,children:[a.jsx("span",{className:B.quickStatLabel,children:"Bonus:"}),a.jsx("span",{className:`${B.quickStatValue} ${B.positive}`,children:T.formattedBonuses})]})]}),a.jsx("svg",{className:B.expandIcon,viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M7,10L12,15L17,10H7Z"})})]}),d.has(T.userId)&&a.jsx("div",{className:B.employeeDetails,children:a.jsxs("div",{className:B.detailsContent,children:[a.jsxs("div",{className:B.detailSection,children:[a.jsx("h3",{className:B.detailSectionTitle,children:"Salary Breakdown"}),a.jsxs("div",{className:B.salaryBreakdownTable,children:[a.jsxs("div",{className:B.breakdownRow,children:[a.jsx("span",{className:B.breakdownLabel,children:"Base Salary"}),a.jsx("span",{className:B.breakdownValue,children:T.formattedBaseSalary})]}),a.jsxs("div",{className:B.breakdownRow,children:[a.jsx("span",{className:B.breakdownLabel,children:"Late Deduction"}),a.jsxs("span",{className:`${B.breakdownValue} ${B.negative}`,children:["-",T.formattedDeductions]})]}),a.jsxs("div",{className:B.breakdownRow,children:[a.jsx("span",{className:B.breakdownLabel,children:"Overtime Payment"}),a.jsxs("span",{className:`${B.breakdownValue} ${B.positive}`,children:["+",T.currencySymbol,"0"]})]}),a.jsxs("div",{className:B.breakdownRow,children:[a.jsx("span",{className:B.breakdownLabel,children:"Bonus"}),a.jsxs("span",{className:`${B.breakdownValue} ${B.positive}`,children:["+",T.formattedBonuses]})]}),a.jsxs("div",{className:B.breakdownRow,children:[a.jsx("span",{className:B.breakdownLabel,children:"Total Payment"}),a.jsx("span",{className:B.breakdownValue,children:T.formattedTotalSalary})]})]})]}),a.jsxs("div",{className:B.detailSection,children:[a.jsx("h3",{className:B.detailSectionTitle,children:"Bank Information"}),a.jsxs("div",{className:B.salaryBreakdownTable,children:[a.jsxs("div",{className:B.breakdownRow,children:[a.jsx("span",{className:B.breakdownLabel,children:"Bank Name"}),a.jsx("span",{className:`${B.breakdownValue} ${B.notRegistered}`,children:"Not registered"})]}),a.jsxs("div",{className:B.breakdownRow,children:[a.jsx("span",{className:B.breakdownLabel,children:"Account Number"}),a.jsx("span",{className:`${B.breakdownValue} ${B.notRegistered}`,children:"Not registered"})]})]})]}),a.jsxs("div",{className:B.detailSection,children:[a.jsx("h3",{className:B.detailSectionTitle,children:"Store Assignments"}),a.jsx("div",{className:B.employeeStores,children:T.storeName.split(", ").map((j,M)=>a.jsx("span",{className:B.storeBadge,children:j},M))})]})]})})]},T.userId))})]})}),m&&a.jsx(De,{variant:m.variant,title:m.title,message:m.message,isOpen:!0,onClose:()=>_(null),autoCloseDuration:m.variant==="success"?2e3:0}),g&&a.jsx(De,{variant:"error",title:"Failed to Load Salary Data",message:g,isOpen:!0,onClose:()=>{},confirmText:"Try Again",onConfirm:v})]})};class p6{constructor(e,r,s,n,o,i,l,c,d,u,h,f,p,g,y){this.userId=e,this.fullName=r,this.email=s,this.roleIds=n,this.roleNames=o,this.stores=i,this.companyId=l,this.companyName=c,this.salaryId=d,this.salaryAmount=u,this.salaryType=h,this.bonusAmount=f,this.currencyId=p,this.currencyCode=g,this.accountId=y}get initials(){const e=this.fullName.trim().split(" ");return e.length>=2?(e[0].charAt(0)+e[e.length-1].charAt(0)).toUpperCase():this.fullName.charAt(0).toUpperCase()}get primaryRole(){return this.roleNames[0]||"No Role"}get displayRole(){return this.roleNames.length>1?`${this.primaryRole} +${this.roleNames.length-1}`:this.primaryRole}isAssignedToStore(e){return this.stores.some(r=>r.store_id===e)}get storeNamesString(){return this.stores.map(e=>e.store_name).join(", ")}}class g6{async getEmployees(e,r){try{const s=ne.getClient(),{data:n,error:o}=await s.rpc("get_employee_info",{p_company_id:e,p_store_id:r});return o?(console.error("Employee RPC error:",o),{success:!1,error:o.message||"Failed to fetch employees"}):n?{success:!0,data:n}:{success:!1,error:"No data returned from employee query"}}catch(s){return console.error("Employee datasource error:",s),{success:!1,error:s instanceof Error?s.message:"Unknown error occurred"}}}async getScheduleData(e,r,s,n){try{const o=ne.getClient(),i=te.toRpcFormat(new Date(s)),l=te.toRpcFormat(new Date(n)),{data:c,error:d}=await o.rpc("get_shift_schedule_info",{p_company_id:e,p_store_id:r,p_start_date:i,p_end_date:l});return d?(console.error("Schedule RPC error:",d),{success:!1,error:d.message||"Failed to fetch schedule data"}):c?{success:!0,data:c}:{success:!1,error:"No data returned from schedule query"}}catch(o){return console.error("Schedule datasource error:",o),{success:!1,error:o instanceof Error?o.message:"Unknown error occurred"}}}async createAssignment(e,r,s,n,o){try{const i=ne.getClient(),l=te.toRpcFormat(new Date(n)),{data:c,error:d}=await i.rpc("manager_shift_insert_schedule",{p_user_id:e,p_shift_id:r,p_store_id:s,p_request_date:l,p_approved_by:o});return d?(console.error("Create assignment RPC error:",d),{success:!1,error:d.message||"Failed to create assignment"}):{success:!0,data:c}}catch(i){return console.error("Create assignment datasource error:",i),{success:!1,error:i instanceof Error?i.message:"Unknown error occurred"}}}async updateAssignment(e,r){return{success:!1,error:"Not implemented yet"}}async deleteAssignment(e){return{success:!1,error:"Not implemented yet"}}}class ed{constructor(e,r,s,n,o){this.shiftId=e,this.shiftName=r,this.startTime=s,this.endTime=n,this.color=o}get timeRange(){return`${this.startTime} - ${this.endTime}`}static create(e){return new ed(e.shift_id,e.shift_name,e.start_time,e.end_time,e.color||"#3B82F6")}}class _m{constructor(e,r,s,n,o,i="scheduled"){this.assignmentId=e,this.userId=r,this.fullName=s,this.date=n,this.shift=o,this.status=i}get formattedDate(){return new Date(this.date).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})}get isToday(){const e=te.toDateOnly(new Date);return this.date===e}static create(e){return new _m(e.assignment_id,e.user_id,e.full_name,e.date,e.shift,e.status||"scheduled")}}class _6{static shiftFromSupabase(e){return ed.create({shift_id:e.shift_id,shift_name:e.shift_name,start_time:e.start_time,end_time:e.end_time,color:e.color})}static fromSupabase(e){const r=(e.shifts||[]).map(o=>this.shiftFromSupabase(o)),s=new Map((e.shifts||[]).map(o=>[o.shift_id,{shift_name:o.shift_name,start_time:o.start_time,end_time:o.end_time}])),n=[];return(e.schedule||[]).forEach(o=>{o.shifts.forEach(i=>{const l=s.get(i.shift_id);if(!l){console.warn(`Shift ${i.shift_id} not found in shifts list`);return}i.employees.forEach(c=>{const d=ed.create({shift_id:i.shift_id,shift_name:i.shift_name,start_time:l.start_time,end_time:l.end_time,color:void 0}),u=te.toLocalSafe(o.date),h=u?te.toDateOnly(u):o.date,f=_m.create({assignment_id:`${h}-${i.shift_id}-${c.user_id}`,user_id:c.user_id,full_name:c.user_name,date:h,shift:d,status:c.status||"scheduled"});n.push(f)})})}),{shifts:r,assignments:n}}}class y6{constructor(){W(this,"dataSource");this.dataSource=new g6}async getScheduleData(e,r,s,n){try{const o=await this.dataSource.getScheduleData(e,r,s,n);if(!o.success||!o.data)return{success:!1,error:o.error||"Failed to fetch schedule data"};const{shifts:i,assignments:l}=_6.fromSupabase(o.data);return{success:!0,shifts:i,assignments:l}}catch(o){return{success:!1,error:o instanceof Error?o.message:"An unexpected error occurred"}}}async getEmployees(e,r){try{const s=await this.dataSource.getEmployees(e,r);return!s.success||!s.data?{success:!1,error:s.error||"Failed to fetch employees"}:{success:!0,employees:s.data.map(o=>new p6(o.user_id,o.full_name,o.email,o.role_ids||[],o.role_names||[],o.stores||[],o.company_id,o.company_name,o.salary_id,o.salary_amount,o.salary_type,o.bonus_amount,o.currency_id,o.currency_code,o.account_id))}}catch(s){return{success:!1,error:s instanceof Error?s.message:"An unexpected error occurred"}}}async createAssignment(e,r,s,n,o){try{return await this.dataSource.createAssignment(e,r,s,n,o)}catch(i){return{success:!1,error:i instanceof Error?i.message:"An unexpected error occurred"}}}async updateAssignment(e,r){return await this.dataSource.updateAssignment(e,r)}async deleteAssignment(e){return await this.dataSource.deleteAssignment(e)}}class v6{static validateAssignment(e){const r=[];if((!e.shiftId||!e.shiftId.trim())&&r.push({field:"shiftId",message:"Please select a shift"}),(!e.employeeId||!e.employeeId.trim())&&r.push({field:"employeeId",message:"Please select an employee"}),!e.date||!e.date.trim())r.push({field:"date",message:"Date is required"});else if(!/^\d{4}-\d{2}-\d{2}$/.test(e.date))r.push({field:"date",message:"Invalid date format (expected YYYY-MM-DD)"});else{const n=new Date(e.date),o=new Date;o.setHours(0,0,0,0),n<o&&r.push({field:"date",message:"Cannot create assignment for past dates"})}return r}static validateDateRange(e,r){const s=[];if((!e||!e.trim())&&s.push({field:"startDate",message:"Start date is required"}),(!r||!r.trim())&&s.push({field:"endDate",message:"End date is required"}),e&&r){const n=new Date(e),o=new Date(r);n>o&&s.push({field:"dateRange",message:"Start date must be before or equal to end date"}),Math.floor((o.getTime()-n.getTime())/(1e3*60*60*24))>90&&s.push({field:"dateRange",message:"Date range cannot exceed 90 days"})}return s}static validateContext(e,r){const s=[];return(!e||!e.trim())&&s.push({field:"companyId",message:"Company ID is required"}),(!r||!r.trim())&&s.push({field:"storeId",message:"Store ID is required"}),s}}const Iu=new y6,ot=Jt((t,e)=>({shifts:[],assignments:[],employees:[],loading:!1,loadingEmployees:!1,error:null,currentWeek:new Date,selectedStoreId:null,isAddEmployeeModalOpen:!1,selectedDate:"",addingEmployee:!1,notification:null,getWeekRange:(r=new Date)=>{const s=new Date(r);s.setDate(s.getDate()-s.getDay()),s.setHours(0,0,0,0);const n=new Date(s);return n.setDate(n.getDate()+6),n.setHours(23,59,59,999),{startDate:te.toDateOnly(s),endDate:te.toDateOnly(n)}},getWeekDays:()=>{const{startDate:r}=e().getWeekRange(e().currentWeek),s=[],n=new Date(r);for(let o=0;o<7;o++){const i=new Date(n);i.setDate(i.getDate()+o),s.push(i.toISOString().split("T")[0])}return s},loadScheduleData:async(r,s)=>{t({loading:!0,error:null});try{const{startDate:n,endDate:o}=e().getWeekRange(e().currentWeek),i=await Iu.getScheduleData(r,s,n,o);if(!i.success){t({error:i.error||"Failed to load schedule data",shifts:[],assignments:[],loading:!1});return}t({shifts:i.shifts||[],assignments:i.assignments||[],loading:!1,error:null})}catch(n){t({error:n instanceof Error?n.message:"An unexpected error occurred",shifts:[],assignments:[],loading:!1})}},loadEmployees:async(r,s)=>{t({loadingEmployees:!0});try{const n=await Iu.getEmployees(r,s);if(!n.success||!n.employees){console.error("Failed to load employees:",n.error),t({employees:[],loadingEmployees:!1});return}t({employees:n.employees,loadingEmployees:!1})}catch(n){console.error("Error loading employees:",n),t({employees:[],loadingEmployees:!1})}},refresh:()=>{},goToPreviousWeek:()=>{const r=e().currentWeek,s=new Date(r);s.setDate(s.getDate()-7),t({currentWeek:s})},goToNextWeek:()=>{const r=e().currentWeek,s=new Date(r);s.setDate(s.getDate()+7),t({currentWeek:s})},goToCurrentWeek:()=>{t({currentWeek:new Date})},getAssignmentsForDate:r=>e().assignments.filter(s=>s.date===r),createAssignment:async(r,s,n,o)=>{try{const i=v6.validateAssignment({shiftId:r,employeeId:s,date:n});if(i.length>0){const c={};return i.forEach(d=>{c[d.field]=d.message}),{success:!1,error:i[0].message,fieldErrors:c}}const l=await Iu.createAssignment(s,r,e().selectedStoreId||"",n,o);return l.success?{success:!0}:{success:!1,error:l.error||"Failed to create assignment"}}catch(i){return{success:!1,error:i instanceof Error?i.message:"An unexpected error occurred"}}},setSelectedStore:r=>{t({selectedStoreId:r})},openAddEmployeeModal:r=>{t({isAddEmployeeModalOpen:!0,selectedDate:r})},closeAddEmployeeModal:()=>{t({isAddEmployeeModalOpen:!1,selectedDate:""})},setAddingEmployee:r=>{t({addingEmployee:r})},showNotification:r=>{t({notification:r})},clearNotification:()=>{t({notification:null})},reset:()=>{t({shifts:[],assignments:[],employees:[],loading:!1,loadingEmployees:!1,error:null,currentWeek:new Date,selectedStoreId:null,isAddEmployeeModalOpen:!1,selectedDate:"",addingEmployee:!1,notification:null})}})),mx=(t,e)=>{const r=ot(M=>M.shifts),s=ot(M=>M.assignments),n=ot(M=>M.employees),o=ot(M=>M.loading),i=ot(M=>M.loadingEmployees),l=ot(M=>M.error),c=ot(M=>M.currentWeek),d=ot(M=>M.selectedStoreId),u=ot(M=>M.isAddEmployeeModalOpen),h=ot(M=>M.selectedDate),f=ot(M=>M.addingEmployee),p=ot(M=>M.notification),g=ot(M=>M.loadScheduleData),y=ot(M=>M.loadEmployees),x=ot(M=>M.goToPreviousWeek),m=ot(M=>M.goToNextWeek),_=ot(M=>M.goToCurrentWeek),v=ot(M=>M.getWeekRange),w=ot(M=>M.getWeekDays),S=ot(M=>M.getAssignmentsForDate),E=ot(M=>M.createAssignment),C=ot(M=>M.setSelectedStore),k=ot(M=>M.openAddEmployeeModal),N=ot(M=>M.closeAddEmployeeModal),I=ot(M=>M.setAddingEmployee),L=ot(M=>M.showNotification),T=ot(M=>M.clearNotification);return b.useEffect(()=>{t&&e&&(g(t,e),y(t,e))},[t,e,c,g,y]),{shifts:r,assignments:s,employees:n,loading:o,loadingEmployees:i,error:l,currentWeek:c,selectedStoreId:d,isAddEmployeeModalOpen:u,selectedDate:h,addingEmployee:f,notification:p,refresh:()=>{t&&e&&g(t,e)},goToPreviousWeek:x,goToNextWeek:m,goToCurrentWeek:_,getWeekRange:v,getWeekDays:w,getAssignmentsForDate:S,createAssignment:E,setSelectedStore:C,openAddEmployeeModal:k,closeAddEmployeeModal:N,setAddingEmployee:I,showNotification:L,clearNotification:T}},x6="_container_1bspj_5",b6="_header_1bspj_15",w6="_title_1bspj_19",S6="_subtitle_1bspj_27",C6="_overviewGrid_1bspj_58",j6="_overviewCard_1bspj_65",k6="_overviewIcon_1bspj_82",N6="_overviewContent_1bspj_93",I6="_overviewNumber_1bspj_99",E6="_overviewLabel_1bspj_107",T6="_storesGrid_1bspj_116",A6="_storeCard_1bspj_122",L6="_storeHeader_1bspj_138",D6="_storeIcon_1bspj_147",M6="_storeName_1bspj_158",R6="_storeStats_1bspj_165",O6="_employeeCount_1bspj_171",P6="_statNumber_1bspj_178",$6="_statLabel_1bspj_186",F6="_storeScheduleSection_1bspj_194",B6="_scheduleSectionTitle_1bspj_199",H6="_scheduleInfo_1bspj_208",V6="_shiftItem_1bspj_214",z6="_shiftName_1bspj_223",U6="_shiftTime_1bspj_229",W6="_noShifts_1bspj_234",je={container:x6,header:b6,title:w6,subtitle:S6,overviewGrid:C6,overviewCard:j6,overviewIcon:k6,overviewContent:N6,overviewNumber:I6,overviewLabel:E6,storesGrid:T6,storeCard:A6,storeHeader:L6,storeIcon:D6,storeName:M6,storeStats:R6,employeeCount:O6,statNumber:P6,statLabel:$6,storeScheduleSection:F6,scheduleSectionTitle:B6,scheduleInfo:H6,shiftItem:V6,shiftName:z6,shiftTime:U6,noShifts:W6},q6=()=>{const t=_a(),{currentCompany:e,currentStore:r}=at(),s=(e==null?void 0:e.company_id)||"",n=(r==null?void 0:r.store_id)||"",{shifts:o}=mx(s,n),i=(e==null?void 0:e.stores)||[],l=i.length*8,c=d=>{t(`/employee/schedule/${d}`)};return e?a.jsxs(a.Fragment,{children:[a.jsx(fe,{activeItem:"employee"}),a.jsxs("div",{className:je.container,children:[a.jsxs("div",{className:je.header,children:[a.jsx("h1",{className:je.title,children:"Dashboard"}),a.jsx("p",{className:je.subtitle,children:"Overview of all stores and scheduling status"})]}),a.jsxs("div",{className:je.overviewGrid,children:[a.jsxs("div",{className:je.overviewCard,children:[a.jsx("div",{className:je.overviewIcon,children:a.jsx("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M20 4H4v2h16V4zm1 10v-2l-1-5H4l-1 5v2h1v6h10v-6h4v6h2v-6h1zm-9 4H6v-4h6v4z"})})}),a.jsxs("div",{className:je.overviewContent,children:[a.jsx("div",{className:je.overviewNumber,children:i.length}),a.jsx("div",{className:je.overviewLabel,children:"Total Stores"})]})]}),a.jsxs("div",{className:je.overviewCard,children:[a.jsx("div",{className:je.overviewIcon,children:a.jsx("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z"})})}),a.jsxs("div",{className:je.overviewContent,children:[a.jsx("div",{className:je.overviewNumber,children:l}),a.jsx("div",{className:je.overviewLabel,children:"Total Employees"})]})]}),a.jsxs("div",{className:je.overviewCard,children:[a.jsx("div",{className:je.overviewIcon,children:a.jsx("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M19 3h-4.18C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm2 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"})})}),a.jsxs("div",{className:je.overviewContent,children:[a.jsx("div",{className:je.overviewNumber,children:"0"}),a.jsx("div",{className:je.overviewLabel,children:"Total Requests"})]})]}),a.jsxs("div",{className:je.overviewCard,children:[a.jsx("div",{className:je.overviewIcon,children:a.jsx("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"})})}),a.jsxs("div",{className:je.overviewContent,children:[a.jsx("div",{className:je.overviewNumber,children:"0"}),a.jsx("div",{className:je.overviewLabel,children:"Problems"})]})]})]}),a.jsx("div",{className:je.storesGrid,children:i.map(d=>a.jsxs("div",{className:je.storeCard,onClick:()=>c(d.store_id),children:[a.jsxs("div",{className:je.storeHeader,children:[a.jsx("div",{className:je.storeIcon,children:a.jsx("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M20 4H4v2h16V4zm1 10v-2l-1-5H4l-1 5v2h1v6h10v-6h4v6h2v-6h1zm-9 4H6v-4h6v4z"})})}),a.jsx("h3",{className:je.storeName,children:d.store_name})]}),a.jsx("div",{className:je.storeStats,children:a.jsxs("div",{className:je.employeeCount,children:[a.jsx("span",{className:je.statNumber,children:"8"}),a.jsx("span",{className:je.statLabel,children:"EMPLOYEES"})]})}),a.jsxs("div",{className:je.storeScheduleSection,children:[a.jsx("h4",{className:je.scheduleSectionTitle,children:"SHIFT SCHEDULE"}),a.jsx("div",{className:je.scheduleInfo,children:o.length>0?o.slice(0,3).map(u=>a.jsxs("div",{className:je.shiftItem,children:[a.jsx("span",{className:je.shiftName,children:u.shiftName}),a.jsx("span",{className:je.shiftTime,children:u.timeRange})]},u.shiftId)):a.jsx("div",{className:je.noShifts,children:"No shifts scheduled"})})]})]},d.store_id))})]})]}):a.jsxs(a.Fragment,{children:[a.jsx(fe,{activeItem:"employee"}),a.jsxs("div",{className:je.container,children:[a.jsx("div",{className:je.header,children:a.jsx("h1",{className:je.title,children:"Dashboard"})}),a.jsx(Ne,{fullscreen:!0})]})]})},G6="_modalOverlay_ejot4_6",J6="_modalContent_ejot4_30",K6="_modalHeader_ejot4_56",Y6="_modalTitle_ejot4_64",Q6="_closeButton_ejot4_71",Z6="_closeIcon_ejot4_94",X6="_modalBody_ejot4_100",eP="_dateDisplay_ejot4_107",tP="_calendarIcon_ejot4_118",rP="_dateText_ejot4_125",sP="_dateValue_ejot4_131",nP="_modalFooter_ejot4_142",oP="_cancelButton_ejot4_150",aP="_addButton_ejot4_151",iP="_buttonIcon_ejot4_208",Nr={modalOverlay:G6,modalContent:J6,modalHeader:K6,modalTitle:Y6,closeButton:Q6,closeIcon:Z6,modalBody:X6,dateDisplay:eP,calendarIcon:tP,dateText:rP,dateValue:sP,modalFooter:nP,cancelButton:oP,addButton:aP,buttonIcon:iP},lP=({isOpen:t,onClose:e,selectedDate:r,shifts:s,employees:n,onAddEmployee:o,loading:i=!1})=>{const[l,c]=b.useState(""),[d,u]=b.useState("");b.useEffect(()=>{t&&(c(""),u(""))},[t]);const h=s.map(v=>({value:v.shiftId,label:v.shiftName,description:v.timeRange})),f=n.map(v=>({value:v.userId,label:v.fullName,description:v.displayRole})),p=v=>new Date(v).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),g=async()=>{await o(l,d,r)},y=v=>{v.target===v.currentTarget&&!i&&e()},x=()=>a.jsx("svg",{className:Nr.closeIcon,viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"})}),m=()=>a.jsx("svg",{className:Nr.calendarIcon,viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M19,19H5V8H19M16,1V3H8V1H6V3H5C3.89,3 3,3.89 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3H18V1M17,12H12V17H17V12Z"})}),_=()=>a.jsx("svg",{className:Nr.buttonIcon,viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"})});return t?a.jsx("div",{className:Nr.modalOverlay,onClick:y,children:a.jsxs("div",{className:Nr.modalContent,children:[a.jsxs("div",{className:Nr.modalHeader,children:[a.jsx("h3",{className:Nr.modalTitle,children:"Add Employee to Shift"}),a.jsx("button",{className:Nr.closeButton,onClick:e,disabled:i,"aria-label":"Close modal",children:a.jsx(x,{})})]}),a.jsxs("div",{className:Nr.modalBody,children:[a.jsxs("div",{className:Nr.dateDisplay,children:[a.jsx(m,{}),a.jsxs("span",{className:Nr.dateText,children:["Selected Date: ",a.jsx("span",{className:Nr.dateValue,children:p(r)})]})]}),a.jsx(We,{id:"shift-select",label:"Select Shift",placeholder:"Choose a shift...",value:l,options:h,onChange:v=>c(v),disabled:i,fullWidth:!0,showDescriptions:!0,required:!0}),a.jsx(We,{id:"employee-select",label:"Select Employee",placeholder:"Choose an employee...",value:d,options:f,onChange:v=>u(v),disabled:i,fullWidth:!0,showDescriptions:!0,searchable:!0,required:!0})]}),a.jsxs("div",{className:Nr.modalFooter,children:[a.jsx("button",{className:Nr.cancelButton,onClick:e,disabled:i,children:"Cancel"}),a.jsxs("button",{className:Nr.addButton,onClick:g,disabled:i||!l||!d,children:[a.jsx(_,{}),i?"Adding...":"Add Employee"]})]})]})}):null},cP="_container_8bi58_5",dP="_header_8bi58_15",uP="_breadcrumb_8bi58_19",hP="_title_8bi58_23",fP="_subtitle_8bi58_31",mP="_weekNavigator_8bi58_38",pP="_weekDisplay_8bi58_51",gP="_employeeSection_8bi58_60",_P="_sectionTitle_8bi58_69",yP="_employeeLoading_8bi58_76",vP="_noEmployees_8bi58_83",xP="_employeeGrid_8bi58_90",bP="_employeeCard_8bi58_96",wP="_employeeAvatar_8bi58_112",SP="_employeeInfo_8bi58_126",CP="_employeeName_8bi58_131",jP="_employeeRole_8bi58_140",kP="_shiftLegend_8bi58_149",NP="_legendTitle_8bi58_158",IP="_legendItems_8bi58_165",EP="_legendItem_8bi58_165",TP="_legendColor_8bi58_177",AP="_legendInfo_8bi58_184",LP="_legendName_8bi58_190",DP="_legendTime_8bi58_196",MP="_scheduleSection_8bi58_202",RP="_scheduleGrid_8bi58_211",OP="_dayColumn_8bi58_217",PP="_today_8bi58_227",$P="_dayHeader_8bi58_232",FP="_dayName_8bi58_243",BP="_todayBadge_8bi58_250",HP="_assignmentList_8bi58_260",VP="_noAssignments_8bi58_268",zP="_assignmentCard_8bi58_276",UP="_assignmentName_8bi58_294",WP="_assignmentShift_8bi58_300",qP="_assignmentTime_8bi58_306",GP="_statusBadge_8bi58_312",JP="_scheduled_8bi58_323",KP="_confirmed_8bi58_328",YP="_absent_8bi58_333",QP="_addEmployeeButton_8bi58_339",ZP="_addIcon_8bi58_367",XP="_emptyState_8bi58_374",e9="_emptyIcon_8bi58_383",t9="_emptyTitle_8bi58_390",r9="_emptyText_8bi58_397",s9="_loadingState_8bi58_404",n9="_spinner_8bi58_411",o9="_pulse_8bi58_1",a9="_errorContainer_8bi58_428",i9="_errorIcon_8bi58_438",l9="_errorTitle_8bi58_445",c9="_errorMessage_8bi58_452",ge={container:cP,header:dP,breadcrumb:uP,title:hP,subtitle:fP,weekNavigator:mP,weekDisplay:pP,employeeSection:gP,sectionTitle:_P,employeeLoading:yP,noEmployees:vP,employeeGrid:xP,employeeCard:bP,employeeAvatar:wP,employeeInfo:SP,employeeName:CP,employeeRole:jP,shiftLegend:kP,legendTitle:NP,legendItems:IP,legendItem:EP,legendColor:TP,legendInfo:AP,legendName:LP,legendTime:DP,scheduleSection:MP,scheduleGrid:RP,dayColumn:OP,today:PP,dayHeader:$P,dayName:FP,todayBadge:BP,assignmentList:HP,noAssignments:VP,assignmentCard:zP,assignmentName:UP,assignmentShift:WP,assignmentTime:qP,statusBadge:GP,scheduled:JP,confirmed:KP,absent:YP,addEmployeeButton:QP,addIcon:ZP,emptyState:XP,emptyIcon:e9,emptyTitle:t9,emptyText:r9,loadingState:s9,spinner:n9,pulse:o9,errorContainer:a9,errorIcon:i9,errorTitle:l9,errorMessage:c9},d9=()=>{const{storeId:t}=A2(),e=_a(),{currentCompany:r,currentUser:s}=at(),n=(r==null?void 0:r.company_id)||"",o=t||"",i=(s==null?void 0:s.user_id)||"",{shifts:l,employees:c,loading:d,loadingEmployees:u,error:h,refresh:f,goToPreviousWeek:p,goToNextWeek:g,goToCurrentWeek:y,getAssignmentsForDate:x,getWeekDays:m,createAssignment:_,isAddEmployeeModalOpen:v,selectedDate:w,addingEmployee:S,notification:E,openAddEmployeeModal:C,closeAddEmployeeModal:k,setAddingEmployee:N,showNotification:I,clearNotification:L}=mx(n,o),j=((r==null?void 0:r.stores)||[]).find(U=>U.store_id===o),M=(j==null?void 0:j.store_name)||"Store",R=()=>{e("/employee/schedule")},O=async(U,A,Ae)=>{N(!0);try{if(!i){I({variant:"error",title:"Authentication Error",message:"You must be logged in to add employees to shifts"});return}const ae=await _(U,A,Ae,i);if(!ae.success){I({variant:"error",title:"Failed to Add Employee",message:ae.error||"Failed to add employee to shift"});return}I({variant:"success",title:"Success",message:"Employee successfully added to shift"}),k(),f()}catch(ae){I({variant:"error",title:"Unexpected Error",message:ae instanceof Error?ae.message:"An unexpected error occurred"})}finally{N(!1)}},z=()=>{const U=m();if(U.length===0)return"";const A=new Date(U[0]),Ae=new Date(U[U.length-1]);return`${A.toLocaleDateString("en-US",{month:"short",day:"numeric"})} - ${Ae.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}`},D=U=>new Date(U).toLocaleDateString("en-US",{weekday:"short",month:"numeric",day:"numeric"}),P=U=>{const A=new Date().toISOString().split("T")[0];return U===A};if(!r||!t)return a.jsxs(a.Fragment,{children:[a.jsx(fe,{activeItem:"employee"}),a.jsxs("div",{className:ge.container,children:[a.jsx("div",{className:ge.header,children:a.jsx("h1",{className:ge.title,children:"Employee Schedule"})}),a.jsx(Ne,{fullscreen:!0})]})]});if(d)return a.jsxs(a.Fragment,{children:[a.jsx(fe,{activeItem:"employee"}),a.jsxs("div",{className:ge.container,children:[a.jsxs("div",{className:ge.header,children:[a.jsx("div",{className:ge.breadcrumb,children:a.jsx(be,{variant:"ghost",size:"sm",onClick:R,children:" Back to Dashboard"})}),a.jsxs("h1",{className:ge.title,children:[M," - Schedule"]})]}),a.jsx(Ne,{fullscreen:!0})]})]});if(h)return a.jsxs(a.Fragment,{children:[a.jsx(fe,{activeItem:"employee"}),a.jsxs("div",{className:ge.container,children:[a.jsxs("div",{className:ge.header,children:[a.jsx("div",{className:ge.breadcrumb,children:a.jsx(be,{variant:"ghost",size:"sm",onClick:R,children:" Back to Dashboard"})}),a.jsxs("h1",{className:ge.title,children:[M," - Schedule"]})]}),a.jsx(Ne,{fullscreen:!0})]}),a.jsx(De,{variant:"error",title:"Failed to Load Schedule",message:h,isOpen:!0,onClose:R,confirmText:"Try Again",onConfirm:f})]});const $=m();return a.jsxs(a.Fragment,{children:[a.jsx(fe,{activeItem:"employee"}),a.jsxs("div",{className:ge.container,children:[a.jsx("div",{className:ge.header,children:a.jsxs("div",{children:[a.jsx("div",{className:ge.breadcrumb,children:a.jsx(be,{variant:"ghost",size:"sm",onClick:R,children:" Back to Dashboard"})}),a.jsxs("h1",{className:ge.title,children:[M," - Schedule"]}),a.jsx("p",{className:ge.subtitle,children:"Manage work shifts and assignments"})]})}),a.jsxs("div",{className:ge.weekNavigator,children:[a.jsx(be,{variant:"outline",size:"sm",onClick:p,children:" Previous Week"}),a.jsx("div",{className:ge.weekDisplay,children:z()}),a.jsx(be,{variant:"outline",size:"sm",onClick:g,children:"Next Week "}),a.jsx(be,{variant:"outline",size:"sm",onClick:y,children:"This Week"})]}),l.length>0&&a.jsxs("div",{className:ge.shiftLegend,children:[a.jsx("h3",{className:ge.legendTitle,children:"Shifts"}),a.jsx("div",{className:ge.legendItems,children:l.map(U=>a.jsxs("div",{className:ge.legendItem,children:[a.jsx("div",{className:ge.legendColor,style:{backgroundColor:U.color}}),a.jsxs("div",{className:ge.legendInfo,children:[a.jsx("span",{className:ge.legendName,children:U.shiftName}),a.jsx("span",{className:ge.legendTime,children:U.timeRange})]})]},U.shiftId))})]}),a.jsx("div",{className:ge.scheduleSection,children:$.length===0?a.jsxs("div",{className:ge.emptyState,children:[a.jsxs("svg",{className:ge.emptyIcon,width:"120",height:"120",viewBox:"0 0 120 120",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[a.jsx("circle",{cx:"60",cy:"60",r:"50",fill:"#F0F6FF"}),a.jsx("rect",{x:"30",y:"35",width:"60",height:"55",rx:"6",fill:"white",stroke:"#0064FF",strokeWidth:"2"}),a.jsx("rect",{x:"30",y:"35",width:"60",height:"15",rx:"6",fill:"#0064FF"}),a.jsx("rect",{x:"30",y:"43",width:"60",height:"7",fill:"#0064FF"}),a.jsx("circle",{cx:"42",cy:"35",r:"3",fill:"white"}),a.jsx("circle",{cx:"60",cy:"35",r:"3",fill:"white"}),a.jsx("circle",{cx:"78",cy:"35",r:"3",fill:"white"}),a.jsx("line",{x1:"37",y1:"58",x2:"47",y2:"58",stroke:"#E9ECEF",strokeWidth:"2",strokeLinecap:"round"}),a.jsx("line",{x1:"52",y1:"58",x2:"62",y2:"58",stroke:"#E9ECEF",strokeWidth:"2",strokeLinecap:"round"}),a.jsx("line",{x1:"67",y1:"58",x2:"77",y2:"58",stroke:"#E9ECEF",strokeWidth:"2",strokeLinecap:"round"}),a.jsx("line",{x1:"37",y1:"68",x2:"47",y2:"68",stroke:"#E9ECEF",strokeWidth:"2",strokeLinecap:"round"}),a.jsx("line",{x1:"52",y1:"68",x2:"62",y2:"68",stroke:"#E9ECEF",strokeWidth:"2",strokeLinecap:"round"}),a.jsx("line",{x1:"67",y1:"68",x2:"77",y2:"68",stroke:"#E9ECEF",strokeWidth:"2",strokeLinecap:"round"}),a.jsx("line",{x1:"37",y1:"78",x2:"47",y2:"78",stroke:"#E9ECEF",strokeWidth:"2",strokeLinecap:"round"}),a.jsx("line",{x1:"52",y1:"78",x2:"62",y2:"78",stroke:"#0064FF",strokeWidth:"3",strokeLinecap:"round"}),a.jsx("line",{x1:"67",y1:"78",x2:"77",y2:"78",stroke:"#E9ECEF",strokeWidth:"2",strokeLinecap:"round"}),a.jsx("circle",{cx:"60",cy:"95",r:"14",fill:"#0064FF"}),a.jsx("path",{d:"M60 88 Q60 85 63 85 Q66 85 66 88 Q66 91 63 93 L60 95",stroke:"white",strokeWidth:"2.5",fill:"none",strokeLinecap:"round"}),a.jsx("circle",{cx:"60",cy:"99",r:"1.5",fill:"white"})]}),a.jsx("h3",{className:ge.emptyTitle,children:"No Schedule Available"}),a.jsx("p",{className:ge.emptyText,children:"No schedule data for the selected week"})]}):a.jsx("div",{className:ge.scheduleGrid,children:$.map(U=>{const A=x(U),Ae=P(U);return a.jsxs("div",{className:`${ge.dayColumn} ${Ae?ge.today:""}`,children:[a.jsxs("div",{className:ge.dayHeader,children:[a.jsx("div",{className:ge.dayName,children:D(U)}),Ae&&a.jsx("span",{className:ge.todayBadge,children:"Today"})]}),a.jsxs("div",{className:ge.assignmentList,children:[A.length===0?a.jsx("div",{className:ge.noAssignments,children:"No shifts"}):a.jsx(a.Fragment,{children:A.map(ae=>a.jsxs("div",{className:ge.assignmentCard,style:{borderLeftColor:ae.shift.color},children:[a.jsx("div",{className:ge.assignmentName,children:ae.fullName||"Unknown Employee"}),a.jsx("div",{className:ge.assignmentShift,children:ae.shift.shiftName}),a.jsx("div",{className:ge.assignmentTime,children:ae.shift.timeRange}),a.jsx("span",{className:`${ge.statusBadge} ${ge[ae.status]}`,children:ae.status})]},ae.assignmentId))}),a.jsxs("button",{className:ge.addEmployeeButton,onClick:()=>C(U),children:[a.jsxs("svg",{className:ge.addIcon,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),a.jsx("span",{children:"Add Employee"})]})]})]},U)})})}),a.jsxs("div",{className:ge.employeeSection,children:[a.jsxs("h3",{className:ge.sectionTitle,children:["Employees (",c.length,")"]}),u?a.jsx(Ne,{}):c.length===0?a.jsx("div",{className:ge.noEmployees,children:"No employees found for this store"}):a.jsx("div",{className:ge.employeeGrid,children:c.map(U=>a.jsxs("div",{className:ge.employeeCard,children:[a.jsx("div",{className:ge.employeeAvatar,children:U.initials}),a.jsxs("div",{className:ge.employeeInfo,children:[a.jsx("div",{className:ge.employeeName,children:U.fullName}),a.jsx("div",{className:ge.employeeRole,children:U.displayRole})]})]},U.userId))})]})]}),a.jsx(lP,{isOpen:v,onClose:k,selectedDate:w,shifts:l,employees:c,onAddEmployee:O,loading:S}),E&&a.jsx(De,{variant:E.variant,title:E.title,message:E.message,isOpen:!0,onClose:L})]})};class u9{async getEmployees(e,r){try{const s=ne.getClient(),n={p_company_id:e};r&&(n.p_store_id=r);const{data:o,error:i}=await s.rpc("get_employee_info",n);return i?(console.error("Employee RPC error:",i),{success:!1,error:i.message||"Failed to fetch employees"}):o?{success:!0,data:o}:{success:!1,error:"No data returned from employees"}}catch(s){return console.error("Employee datasource error:",s),{success:!1,error:s instanceof Error?s.message:"Unknown error occurred"}}}async createEmployee(e){return{success:!1,error:"Not implemented yet"}}async updateEmployee(e,r){return{success:!1,error:"Not implemented yet"}}async deleteEmployee(e){return{success:!1,error:"Not implemented yet"}}async updateEmployeeSalary(e,r,s,n){try{const o=ne.getClient(),{error:i}=await o.rpc("update_user_salary",{p_salary_id:e,p_salary_amount:r,p_salary_type:s,p_currency_id:n});return i?(console.error("Update salary RPC error:",i),{success:!1,error:i.message||"Failed to update salary"}):{success:!0}}catch(o){return console.error("Update salary datasource error:",o),{success:!1,error:o instanceof Error?o.message:"Unknown error occurred"}}}async getCurrencies(e){try{const r=ne.getClient(),{data:s,error:n}=await r.from("company_currency").select(`
          currency_id,
          currency_types (
            currency_id,
            currency_code,
            currency_name,
            symbol
          )
        `).eq("company_id",e).order("currency_types(currency_code)");return n?(console.error("Get currencies error:",n),{success:!1,error:n.message||"Failed to fetch currencies"}):s?{success:!0,data:(s||[]).map(i=>{const l=i.currency_types;return l?{currency_id:l.currency_id,currency_code:l.currency_code,currency_name:l.currency_name,currency_symbol:l.symbol}:null}).filter(i=>i!==null)}:{success:!1,error:"No data returned from currencies"}}catch(r){return console.error("Get currencies datasource error:",r),{success:!1,error:r instanceof Error?r.message:"Unknown error occurred"}}}}class ym{constructor(e,r,s,n,o,i,l,c,d,u,h,f,p,g,y,x,m,_,v,w=null,S=null){this.userId=e,this.fullName=r,this.email=s,this.roleId=n,this.roleIds=o,this.roleName=i,this.roleNames=l,this.storeId=c,this.storeIds=d,this.storeName=u,this.storeNames=h,this.salaryAmount=f,this.salaryType=p,this.currencyId=g,this.currencyCode=y,this.currencySymbol=x,this.salaryId=m,this.companyId=_,this.accountId=v,this.profileImage=w,this.userRoleId=S}get initials(){return this.fullName.charAt(0).toUpperCase()}get formattedSalary(){return`${this.currencyCode}${this.salaryAmount.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})}`}get salaryTypeLabel(){return this.salaryType==="hourly"?"per hour":"per month"}get isActive(){return!0}get hasMultipleRoles(){return this.roleIds.length>1}get hasMultipleStores(){return this.storeIds.length>1}get displayRole(){return this.hasMultipleRoles?`${this.roleName} +${this.roleIds.length-1}`:this.roleName}get displayStore(){return this.hasMultipleStores?`${this.storeName} +${this.storeIds.length-1}`:this.storeName}static create(e){return new ym(e.user_id,e.full_name,e.email,e.role_id,e.role_ids||[],e.role_name||"No role assigned",e.role_names||[],e.store_id,e.store_ids||[],e.store_name||"No store assigned",e.store_names||[],e.salary_amount||0,e.salary_type||"monthly",e.currency_id,e.currency_code,e.currency_symbol,e.salary_id,e.company_id,e.account_id,e.profile_image||null,e.user_role_id||null)}}class wn{constructor(e,r,s){this.totalEmployees=e,this.totalRoles=r,this.totalStores=s}static create(e){return new wn(e.total_employees||0,e.total_roles||0,e.total_stores||0)}static empty(){return new wn(0,0,0)}}class $_{static fromSupabase(e){const r=e.role_ids||[],s=e.role_names||[],n=e.stores||[],o=n.map(p=>p.store_id),i=n.map(p=>p.store_name),l=r.length>0?r[0]:null,c=s.length>0?s[0]:"No role assigned",d=o.length>0?o[0]:null,u=i.length>0?i[0]:"No store assigned",h={KRW:"",USD:"$",EUR:"",JPY:"",CNY:""},f=e.currency_code?h[e.currency_code]||e.currency_code:"";return ym.create({user_id:e.user_id,full_name:e.full_name,email:e.email,role_id:l,role_ids:r,role_name:c,role_names:s,store_id:d,store_ids:o,store_name:u,store_names:i,salary_amount:e.salary_amount||0,currency_id:e.currency_id,currency_code:e.currency_code,currency_symbol:f,user_role_id:null,salary_type:e.salary_type||"monthly",salary_id:e.salary_id||"",company_id:e.company_id,account_id:e.account_id||""})}static calculateStats(e){const r=new Set,s=new Set;return e.forEach(n=>{n.roleIds.forEach(o=>{o&&r.add(o)}),n.storeIds.forEach(o=>{o&&s.add(o)})}),wn.create({total_employees:e.length,total_roles:r.size,total_stores:s.size})}}class px{constructor(){W(this,"dataSource");this.dataSource=new u9}async getEmployees(e){try{const r=await this.dataSource.getEmployees(e.companyId,e.storeId);if(!r.success||!r.data)return{success:!1,error:r.error||"Failed to fetch employees"};let s=r.data.map(o=>$_.fromSupabase(o));if(e.searchQuery&&e.searchQuery.trim()!==""){const o=e.searchQuery.toLowerCase();s=s.filter(i=>i.fullName.toLowerCase().includes(o)||i.email.toLowerCase().includes(o)||i.roleName.toLowerCase().includes(o))}const n=$_.calculateStats(s);return{success:!0,employees:s,stats:n}}catch(r){return{success:!1,error:r instanceof Error?r.message:"An unexpected error occurred"}}}async getEmployeeById(e){return null}async createEmployee(e){return await this.dataSource.createEmployee(e)}async updateEmployee(e,r){return await this.dataSource.updateEmployee(e,r)}async deleteEmployee(e){return await this.dataSource.deleteEmployee(e)}async updateEmployeeSalary(e,r,s,n){return await this.dataSource.updateEmployeeSalary(e,r,s,n)}async getCurrencies(e){const r=await this.dataSource.getCurrencies(e);return!r.success||!r.data?[]:r.data}}const h9=new px,kt=Jt((t,e)=>({employees:[],stats:wn.empty(),loading:!1,error:null,isEditModalOpen:!1,selectedEmployee:null,deleteConfirm:null,searchQuery:"",storeFilter:null,get filteredEmployees(){const{employees:r,searchQuery:s,storeFilter:n}=e();let o=[...r];if(n&&(o=o.filter(i=>i.storeId===n)),s.trim()){const i=s.toLowerCase();o=o.filter(l=>l.fullName.toLowerCase().includes(i)||l.email.toLowerCase().includes(i)||l.displayRole.toLowerCase().includes(i))}return o},setEmployees:r=>t({employees:r}),setStats:r=>t({stats:r}),setLoading:r=>t({loading:r}),setError:r=>t({error:r}),openEditModal:r=>{const s=e().employees.find(n=>n.userId===r);s&&t({selectedEmployee:{userId:s.userId,fullName:s.fullName,email:s.email,roleName:s.displayRole,storeName:s.displayStore,salaryType:s.salaryType,salaryAmount:s.salaryAmount,currencyId:s.currencyId,currencyCode:s.currencyCode,salaryId:s.salaryId,companyId:s.companyId,accountId:s.accountId,initials:s.initials},isEditModalOpen:!0})},closeEditModal:()=>{t({isEditModalOpen:!1,selectedEmployee:null})},openDeleteConfirm:r=>{const s=e().employees.find(n=>n.userId===r);s&&t({deleteConfirm:{userId:s.userId,name:s.fullName}})},closeDeleteConfirm:()=>{t({deleteConfirm:null})},setSearchQuery:r=>{t({searchQuery:r})},setStoreFilter:r=>{t({storeFilter:r})},loadEmployees:async r=>{t({loading:!0,error:null});try{const{storeFilter:s,searchQuery:n}=e(),o=await h9.getEmployees({companyId:r,storeId:s,searchQuery:n});if(!o.success){t({error:o.error||"Failed to load employees",employees:[],stats:wn.empty()});return}t({employees:o.employees||[],stats:o.stats||wn.empty(),error:null})}catch(s){t({error:s instanceof Error?s.message:"An unexpected error occurred",employees:[],stats:wn.empty()})}finally{t({loading:!1})}},refreshEmployees:async()=>{var s;const r=e();if(r.employees.length>0){const n=(s=r.employees[0])==null?void 0:s.companyId;n&&await e().loadEmployees(n)}},deleteEmployee:async r=>{const{deleteConfirm:s}=e();if(!s)return{success:!1,error:"No employee selected for deletion"};t({loading:!0,error:null});try{return console.log("Delete employee:",s.userId),e().closeDeleteConfirm(),await e().refreshEmployees(),{success:!0}}catch(n){const o=n instanceof Error?n.message:"Failed to delete employee";return t({error:o}),{success:!1,error:o}}finally{t({loading:!1})}}})),f9=()=>{const t=kt(C=>C.employees),e=kt(C=>C.stats),r=kt(C=>C.loading),s=kt(C=>C.error),n=kt(C=>C.isEditModalOpen),o=kt(C=>C.selectedEmployee),i=kt(C=>C.deleteConfirm),l=kt(C=>C.searchQuery),c=kt(C=>C.storeFilter),d=kt(C=>C.filteredEmployees),u=kt(C=>C.setEmployees),h=kt(C=>C.setStats),f=kt(C=>C.setLoading),p=kt(C=>C.setError),g=kt(C=>C.openEditModal),y=kt(C=>C.closeEditModal),x=kt(C=>C.openDeleteConfirm),m=kt(C=>C.closeDeleteConfirm),_=kt(C=>C.setSearchQuery),v=kt(C=>C.setStoreFilter),w=kt(C=>C.loadEmployees),S=kt(C=>C.refreshEmployees),E=kt(C=>C.deleteEmployee);return{employees:t,stats:e,loading:r,error:s,isEditModalOpen:n,selectedEmployee:o,deleteConfirm:i,searchQuery:l,storeFilter:c,filteredEmployees:d,setEmployees:u,setStats:h,setLoading:f,setError:p,openEditModal:g,closeEditModal:y,openDeleteConfirm:x,closeDeleteConfirm:m,setSearchQuery:_,setStoreFilter:v,loadEmployees:w,refreshEmployees:S,deleteEmployee:E}},m9="_card_vy0i7_6",p9="_header_vy0i7_26",g9="_body_vy0i7_33",_9="_actions_vy0i7_38",y9="_actionButton_vy0i7_44",v9="_avatarContainer_vy0i7_76",x9="_avatar_vy0i7_76",b9="_info_vy0i7_95",w9="_name_vy0i7_100",S9="_role_vy0i7_110",C9="_store_vy0i7_117",j9="_statusBadge_vy0i7_126",k9="_statusDot_vy0i7_140",N9="_details_vy0i7_148",I9="_salaryContainer_vy0i7_156",E9="_salaryLabel_vy0i7_162",T9="_salaryAmount_vy0i7_171",A9="_salaryType_vy0i7_179",Yt={card:m9,header:p9,body:g9,actions:_9,actionButton:y9,avatarContainer:v9,avatar:x9,info:b9,name:w9,role:S9,store:C9,statusBadge:j9,statusDot:k9,details:N9,salaryContainer:I9,salaryLabel:E9,salaryAmount:T9,salaryType:A9},L9=({userId:t,fullName:e,roleName:r,storeName:s,formattedSalary:n,salaryTypeLabel:o,initials:i,isActive:l,onEdit:c,onDelete:d})=>a.jsxs("div",{className:Yt.card,children:[a.jsxs("div",{className:Yt.header,children:[a.jsx("div",{className:Yt.avatarContainer,children:a.jsx("div",{className:Yt.avatar,children:i})}),a.jsx("div",{className:Yt.body,children:a.jsxs("div",{className:Yt.info,children:[a.jsx("h3",{className:Yt.name,children:e}),a.jsx("p",{className:Yt.role,children:r}),a.jsxs("p",{className:Yt.store,children:[a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"currentColor",style:{opacity:.6},children:a.jsx("circle",{cx:"7",cy:"7",r:"7"})}),s]}),l&&a.jsxs("div",{className:Yt.statusBadge,children:[a.jsx("span",{className:Yt.statusDot}),"Active"]})]})}),a.jsxs("div",{className:Yt.actions,children:[c&&a.jsx("button",{className:Yt.actionButton,onClick:()=>c(t),title:"Edit employee","aria-label":"Edit employee",children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor",children:a.jsx("path",{d:"M11.013 1.427a1.75 1.75 0 0 1 2.474 0l1.086 1.086a1.75 1.75 0 0 1 0 2.474l-8.61 8.61c-.21.21-.47.364-.756.445l-3.251.93a.75.75 0 0 1-.927-.928l.929-3.25a1.75 1.75 0 0 1 .445-.758l8.61-8.61Zm.176 4.823L9.75 4.81l-6.286 6.287a.253.253 0 0 0-.064.108l-.558 1.953 1.953-.558a.253.253 0 0 0 .108-.064Z"})})}),d&&a.jsx("button",{className:Yt.actionButton,onClick:()=>d(t),title:"Delete employee","aria-label":"Delete employee",children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor",children:a.jsx("path",{d:"M11 1.75V3h2.25a.75.75 0 0 1 0 1.5H2.75a.75.75 0 0 1 0-1.5H5V1.75C5 .784 5.784 0 6.75 0h2.5C10.216 0 11 .784 11 1.75ZM4.496 6.675l.66 6.6a.25.25 0 0 0 .249.225h5.19a.25.25 0 0 0 .249-.225l.66-6.6a.75.75 0 0 1 1.492.149l-.66 6.6A1.748 1.748 0 0 1 10.595 15h-5.19a1.75 1.75 0 0 1-1.741-1.575l-.66-6.6a.75.75 0 1 1 1.492-.15ZM6.5 1.75V3h3V1.75a.25.25 0 0 0-.25-.25h-2.5a.25.25 0 0 0-.25.25Z"})})})]})]}),a.jsx("div",{className:Yt.details,children:a.jsxs("div",{className:Yt.salaryContainer,children:[a.jsx("div",{className:Yt.salaryLabel,children:"Salary"}),a.jsx("div",{className:Yt.salaryAmount,children:n}),a.jsx("div",{className:Yt.salaryType,children:o})]})})]});class sa{static validateSalaryAmount(e){return isNaN(e)?{isValid:!1,error:"Please enter a valid salary amount"}:e<0?{isValid:!1,error:"Salary amount cannot be negative"}:e===0?{isValid:!1,error:"Salary amount must be greater than 0"}:e>1e9?{isValid:!1,error:"Salary amount exceeds maximum limit (1,000,000,000)"}:{isValid:!0}}static validateCurrencyId(e){return!e||e.trim()===""?{isValid:!1,error:"Please select a currency"}:/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e)?{isValid:!0}:{isValid:!1,error:"Invalid currency ID format"}}static validateSalaryType(e){return!e||e.trim()===""?{isValid:!1,error:"Please select a salary type"}:["monthly","hourly"].includes(e)?{isValid:!0}:{isValid:!1,error:'Invalid salary type. Must be "monthly" or "hourly"'}}static validateEmail(e){return!e||e.trim()===""?{isValid:!1,error:"Email is required"}:/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)?{isValid:!0}:{isValid:!1,error:"Invalid email format"}}static validateFullName(e){return!e||e.trim()===""?{isValid:!1,error:"Full name is required"}:e.trim().length<2?{isValid:!1,error:"Full name must be at least 2 characters"}:e.length>100?{isValid:!1,error:"Full name must not exceed 100 characters"}:{isValid:!0}}static validateSalaryUpdate(e,r,s){const n=sa.validateSalaryAmount(e);if(!n.isValid)return n;const o=sa.validateCurrencyId(r);if(!o.isValid)return o;const i=sa.validateSalaryType(s);return i.isValid?{isValid:!0}:i}static validateSalaryId(e){return!e||e.trim()===""?{isValid:!1,error:"Salary ID is required"}:/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e)?{isValid:!0}:{isValid:!1,error:"Invalid salary ID format"}}}const D9="_overlay_1fjb7_7",M9="_modal_1fjb7_21",R9="_header_1fjb7_31",O9="_title_1fjb7_38",P9="_closeButton_1fjb7_45",$9="_body_1fjb7_65",F9="_employeeInfo_1fjb7_70",B9="_avatarLarge_1fjb7_81",H9="_employeeHeader_1fjb7_96",V9="_employeeName_1fjb7_100",z9="_employeeEmail_1fjb7_107",U9="_infoGrid_1fjb7_114",W9="_infoItem_1fjb7_121",q9="_infoLabel_1fjb7_128",G9="_infoValue_1fjb7_138",J9="_editSection_1fjb7_145",K9="_sectionTitle_1fjb7_152",Y9="_formGroup_1fjb7_160",Q9="_formLabel_1fjb7_168",Z9="_salaryTypeToggle_1fjb7_177",X9="_toggleOption_1fjb7_185",e8="_active_1fjb7_206",t8="_toggleIcon_1fjb7_212",r8="_inputWrapper_1fjb7_218",s8="_currencySymbol_1fjb7_238",n8="_formInput_1fjb7_245",o8="_salaryPeriod_1fjb7_259",a8="_footer_1fjb7_267",i8="_cancelButton_1fjb7_275",l8="_saveButton_1fjb7_276",Me={overlay:D9,modal:M9,header:R9,title:O9,closeButton:P9,body:$9,employeeInfo:F9,avatarLarge:B9,employeeHeader:H9,employeeName:V9,employeeEmail:z9,infoGrid:U9,infoItem:W9,infoLabel:q9,infoValue:G9,editSection:J9,sectionTitle:K9,formGroup:Y9,formLabel:Q9,salaryTypeToggle:Z9,toggleOption:X9,active:e8,toggleIcon:t8,inputWrapper:r8,currencySymbol:s8,formInput:n8,salaryPeriod:o8,footer:a8,cancelButton:i8,saveButton:l8},c8=({isOpen:t,onClose:e,employee:r,onSave:s})=>{const[n,o]=b.useState("monthly"),[i,l]=b.useState(""),[c,d]=b.useState(""),[u,h]=b.useState([]),[f,p]=b.useState(!1),[g,y]=b.useState(null),[x,m]=b.useState(null),_=new px;b.useEffect(()=>{t&&r&&(async()=>{try{if(!(r!=null&&r.companyId))return;const N=await _.getCurrencies(r.companyId);h(N)}catch(N){console.error("Error loading currencies:",N)}})()},[t,r,_]),b.useEffect(()=>{r&&t&&(o(r.salaryType||"monthly"),l(r.currencyId||""),d(v(r.salaryAmount||0)))},[r,t]);const v=k=>k.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),w=k=>{const N=k.target.value.replace(/,/g,"");/^\d*$/.test(N)&&d(v(parseInt(N)||0))},S=()=>{const k=u.find(N=>N.currency_id===i);return(k==null?void 0:k.currency_symbol)||"$"},E=()=>n==="monthly"?"per month":"per hour",C=async()=>{if(!r)return;const k=parseFloat(c.replace(/,/g,""))||0,N=sa.validateSalaryUpdate(k,i,n);if(!N.isValid){y({title:"Validation Error",message:N.error||"Invalid salary information"});return}const I=sa.validateSalaryId(r.salaryId);if(!I.isValid){y({title:"Validation Error",message:I.error||"Invalid salary ID"});return}p(!0);try{const L=await _.updateEmployeeSalary(r.salaryId,k,n,i);if(!L.success){y({title:"Update Failed",message:L.error||"Failed to update employee salary. Please try again."});return}m("Employee salary updated successfully!"),setTimeout(()=>{m(null),s(),e()},1500)}catch(L){console.error("Error updating salary:",L),y({title:"Unexpected Error",message:L instanceof Error?L.message:"An unexpected error occurred. Please try again."})}finally{p(!1)}};return!t||!r?null:a.jsxs(a.Fragment,{children:[a.jsx("div",{className:Me.overlay,onClick:e,children:a.jsxs("div",{className:Me.modal,onClick:k=>k.stopPropagation(),children:[a.jsxs("div",{className:Me.header,children:[a.jsx("h2",{className:Me.title,children:"Edit Employee"}),a.jsx("button",{className:Me.closeButton,onClick:e,children:a.jsx("svg",{width:"24",height:"24",fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"})})})]}),a.jsxs("div",{className:Me.body,children:[a.jsxs("div",{className:Me.employeeInfo,children:[a.jsx("div",{className:Me.avatarLarge,children:r.initials}),a.jsxs("div",{className:Me.employeeHeader,children:[a.jsx("h3",{className:Me.employeeName,children:r.fullName}),a.jsx("p",{className:Me.employeeEmail,children:r.email})]})]}),a.jsxs("div",{className:Me.infoGrid,children:[a.jsxs("div",{className:Me.infoItem,children:[a.jsx("label",{className:Me.infoLabel,children:"ROLE"}),a.jsx("div",{className:Me.infoValue,children:r.roleName})]}),a.jsxs("div",{className:Me.infoItem,children:[a.jsx("label",{className:Me.infoLabel,children:"STORE"}),a.jsx("div",{className:Me.infoValue,children:r.storeName})]})]}),a.jsxs("div",{className:Me.editSection,children:[a.jsx("h4",{className:Me.sectionTitle,children:"Salary Configuration"}),a.jsxs("div",{className:Me.formGroup,children:[a.jsx("label",{className:Me.formLabel,children:"Salary Type"}),a.jsxs("div",{className:Me.salaryTypeToggle,children:[a.jsxs("button",{className:`${Me.toggleOption} ${n==="monthly"?Me.active:""}`,onClick:()=>o("monthly"),children:[a.jsx("svg",{className:Me.toggleIcon,width:"16",height:"16",fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M19,3H18V1H16V3H8V1H6V3H5C3.89,3 3,3.89 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3M19,19H5V8H19V19Z"})}),"Monthly"]}),a.jsxs("button",{className:`${Me.toggleOption} ${n==="hourly"?Me.active:""}`,onClick:()=>o("hourly"),children:[a.jsx("svg",{className:Me.toggleIcon,width:"16",height:"16",fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M12,20A8,8 0 0,0 20,12A8,8 0 0,0 12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22C6.47,22 2,17.5 2,12A10,10 0 0,1 12,2M12.5,7V12.25L17,14.92L16.25,16.15L11,13V7H12.5Z"})}),"Hourly"]})]})]}),a.jsx(We,{id:"currency",label:"Currency",placeholder:"Select currency",value:i,options:u.map(k=>({value:k.currency_id,label:`${k.currency_code} - ${k.currency_name} (${k.currency_symbol})`})),onChange:k=>l(k),fullWidth:!0,searchable:!0}),a.jsxs("div",{className:Me.formGroup,children:[a.jsx("label",{className:Me.formLabel,htmlFor:"salaryAmount",children:"Salary Amount"}),a.jsxs("div",{className:Me.inputWrapper,children:[a.jsx("span",{className:Me.currencySymbol,children:S()}),a.jsx("input",{id:"salaryAmount",type:"text",className:Me.formInput,value:c,onChange:w,placeholder:"0"}),a.jsx("span",{className:Me.salaryPeriod,children:E()})]})]})]})]}),a.jsxs("div",{className:Me.footer,children:[a.jsx("button",{className:Me.cancelButton,onClick:e,disabled:f,children:"Cancel"}),a.jsx("button",{className:Me.saveButton,onClick:C,disabled:f,children:f?a.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:a.jsx(Ne,{size:"small"})}):a.jsxs(a.Fragment,{children:[a.jsx("svg",{width:"16",height:"16",fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M17,3H5C3.89,3 3,3.89 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V7.5L18.5,5M19,19H5V5H16.17L19,7.83V19M12,12C10.34,12 9,13.34 9,15C9,16.66 10.34,18 12,18C13.66,18 15,16.66 15,15C15,13.34 13.66,12 12,12M6,6H15V10H6V6Z"})}),"Save Changes"]})})]})]})}),a.jsx(De,{variant:"error",title:g==null?void 0:g.title,message:(g==null?void 0:g.message)||"",isOpen:!!g,onClose:()=>y(null),zIndex:10001}),a.jsx(De,{variant:"success",title:"Success",message:x||"",isOpen:!!x,onClose:()=>m(null),autoCloseDuration:1500,zIndex:10001})]})},d8="_container_j8ync_6",u8="_header_j8ync_13",h8="_title_j8ync_17",f8="_statsContainer_j8ync_25",m8="_statCard_j8ync_29",p8="_statIcon_j8ync_41",g8="_statContent_j8ync_54",_8="_statLabel_j8ync_60",y8="_statValue_j8ync_68",v8="_filterSection_j8ync_77",x8="_employeeSection_j8ync_83",b8="_sectionHeader_j8ync_88",w8="_sectionTitleContainer_j8ync_97",S8="_sectionIcon_j8ync_103",C8="_sectionTitle_j8ync_97",j8="_memberCount_j8ync_114",k8="_employeeGrid_j8ync_124",N8="_emptyState_j8ync_132",I8="_emptyIcon_j8ync_144",E8="_emptyTitle_j8ync_151",T8="_emptyText_j8ync_158",A8="_errorContainer_j8ync_190",L8="_errorIcon_j8ync_203",D8="_errorTitle_j8ync_210",M8="_errorMessage_j8ync_217",R8="_retryButton_j8ync_224",Le={container:d8,header:u8,title:h8,statsContainer:f8,statCard:m8,statIcon:p8,statContent:g8,statLabel:_8,statValue:y8,filterSection:v8,employeeSection:x8,sectionHeader:b8,sectionTitleContainer:w8,sectionIcon:S8,sectionTitle:C8,memberCount:j8,employeeGrid:k8,emptyState:N8,emptyIcon:I8,emptyTitle:E8,emptyText:T8,errorContainer:A8,errorIcon:L8,errorTitle:D8,errorMessage:M8,retryButton:R8},O8=()=>{const{currentCompany:t}=at(),e=(t==null?void 0:t.company_id)||"",{employees:r,stats:s,loading:n,error:o,isEditModalOpen:i,selectedEmployee:l,deleteConfirm:c,storeFilter:d,openEditModal:u,closeEditModal:h,openDeleteConfirm:f,closeDeleteConfirm:p,setStoreFilter:g,loadEmployees:y,refreshEmployees:x,deleteEmployee:m}=f9();if(b.useEffect(()=>{e&&y(e)},[e,y]),!e)return a.jsxs(a.Fragment,{children:[a.jsx(fe,{activeItem:"employee"}),a.jsxs("div",{className:Le.container,children:[a.jsx("div",{className:Le.header,children:a.jsx("h1",{className:Le.title,children:"Team Management"})}),a.jsxs("div",{className:Le.errorContainer,children:[a.jsxs("svg",{className:Le.errorIcon,width:"120",height:"120",viewBox:"0 0 120 120",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[a.jsx("circle",{cx:"60",cy:"60",r:"50",fill:"#FFEFED"}),a.jsx("circle",{cx:"60",cy:"60",r:"30",fill:"#FF5847"}),a.jsx("path",{d:"M60 45 L60 65",stroke:"white",strokeWidth:"4",strokeLinecap:"round"}),a.jsx("circle",{cx:"60",cy:"73",r:"2.5",fill:"white"}),a.jsx("rect",{x:"40",y:"25",width:"40",height:"50",rx:"4",fill:"white",stroke:"#FF5847",strokeWidth:"2"})]}),a.jsx("h2",{className:Le.errorTitle,children:"No Company Selected"}),a.jsx("p",{className:Le.errorMessage,children:"Please select a company to view employees"})]})]})]});const _=k=>{u(k)},v=()=>{h()},w=()=>{x()},S=k=>{f(k)},E=async()=>{c&&await m(e)},C=(t==null?void 0:t.stores)||[];return n?a.jsxs(a.Fragment,{children:[a.jsx(fe,{activeItem:"employee"}),a.jsxs("div",{className:Le.container,children:[a.jsx("div",{className:Le.header,children:a.jsx("h1",{className:Le.title,children:"Team Management"})}),a.jsx(Ne,{fullscreen:!0,size:"large"})]})]}):o?a.jsxs(a.Fragment,{children:[a.jsx(fe,{activeItem:"employee"}),a.jsxs("div",{className:Le.container,children:[a.jsx("div",{className:Le.header,children:a.jsx("h1",{className:Le.title,children:"Team Management"})}),a.jsxs("div",{className:Le.errorContainer,children:[a.jsxs("svg",{className:Le.errorIcon,width:"120",height:"120",viewBox:"0 0 120 120",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[a.jsx("circle",{cx:"60",cy:"60",r:"50",fill:"#FFEFED"}),a.jsx("circle",{cx:"60",cy:"60",r:"30",fill:"#FF5847"}),a.jsx("path",{d:"M60 45 L60 65",stroke:"white",strokeWidth:"4",strokeLinecap:"round"}),a.jsx("circle",{cx:"60",cy:"73",r:"2.5",fill:"white"}),a.jsx("rect",{x:"40",y:"25",width:"40",height:"50",rx:"4",fill:"white",stroke:"#FF5847",strokeWidth:"2"})]}),a.jsx("h2",{className:Le.errorTitle,children:"Failed to Load Employees"}),a.jsx("p",{className:Le.errorMessage,children:o}),a.jsx("button",{onClick:x,className:Le.retryButton,children:"Try Again"})]})]})]}):a.jsxs(a.Fragment,{children:[a.jsx(fe,{activeItem:"employee"}),a.jsxs("div",{className:Le.container,children:[a.jsx("div",{className:Le.header,children:a.jsx("h1",{className:Le.title,children:"Team Management"})}),a.jsx("div",{className:Le.statsContainer,children:a.jsxs("div",{className:Le.statCard,children:[a.jsx("div",{className:Le.statIcon,children:a.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z"})})}),a.jsxs("div",{className:Le.statContent,children:[a.jsx("div",{className:Le.statLabel,children:"TOTAL EMPLOYEES"}),a.jsx("div",{className:Le.statValue,children:s.totalEmployees})]})]})}),a.jsx("div",{className:Le.filterSection,children:a.jsx(Hs,{stores:C,selectedStoreId:d,onStoreSelect:g,companyId:e,width:"100%"})}),a.jsxs("div",{className:Le.employeeSection,children:[a.jsxs("div",{className:Le.sectionHeader,children:[a.jsxs("div",{className:Le.sectionTitleContainer,children:[a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"currentColor",className:Le.sectionIcon,children:a.jsx("path",{d:"M13 6a3 3 0 11-6 0 3 3 0 016 0zM18 8a2 2 0 11-4 0 2 2 0 014 0zM14 15a4 4 0 00-8 0v3h8v-3zM6 8a2 2 0 11-4 0 2 2 0 014 0zM16 18v-3a5.972 5.972 0 00-.75-2.906A3.005 3.005 0 0119 15v3h-3zM4.75 12.094A5.973 5.973 0 004 15v3H1v-3a3 3 0 013.75-2.906z"})}),a.jsx("h2",{className:Le.sectionTitle,children:"Team Members"})]}),a.jsxs("div",{className:Le.memberCount,children:[r.length," members"]})]}),r.length===0?a.jsxs("div",{className:Le.emptyState,children:[a.jsxs("svg",{className:Le.emptyIcon,width:"120",height:"120",viewBox:"0 0 120 120",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[a.jsx("circle",{cx:"60",cy:"60",r:"50",fill:"#F0F6FF"}),a.jsx("circle",{cx:"60",cy:"45",r:"15",fill:"white",stroke:"#0064FF",strokeWidth:"2"}),a.jsx("path",{d:"M35 85 Q35 65 60 65 Q85 65 85 85 L85 95 Q85 100 80 100 L40 100 Q35 100 35 95 Z",fill:"white",stroke:"#0064FF",strokeWidth:"2"}),a.jsx("circle",{cx:"80",cy:"80",r:"18",fill:"#0064FF"}),a.jsx("circle",{cx:"80",cy:"80",r:"8",fill:"none",stroke:"white",strokeWidth:"2.5"}),a.jsx("line",{x1:"85",y1:"85",x2:"91",y2:"91",stroke:"white",strokeWidth:"2.5",strokeLinecap:"round"})]}),a.jsx("h3",{className:Le.emptyTitle,children:"No Employees Found"}),a.jsx("p",{className:Le.emptyText,children:d?"No employees found for the selected store":"No employees found in this company"})]}):a.jsx("div",{className:Le.employeeGrid,children:r.map(k=>a.jsx(L9,{userId:k.userId,fullName:k.fullName,email:k.email,roleName:k.displayRole,storeName:k.displayStore,formattedSalary:k.formattedSalary,salaryTypeLabel:k.salaryTypeLabel,initials:k.initials,isActive:k.isActive,onEdit:_,onDelete:S},k.userId))})]}),a.jsx(c8,{isOpen:i,onClose:v,employee:l,onSave:w}),a.jsx(De,{variant:"warning",title:"Confirm Delete",message:`Are you sure you want to delete ${c==null?void 0:c.name}? This action cannot be undone.`,isOpen:!!c,onClose:p,showCancelButton:!0,confirmText:"Delete",cancelText:"Cancel",onConfirm:E})]})]})};class ui{static validateCompanyId(e){const r=[];return!e||e.trim()===""?(r.push({field:"companyId",message:"Company ID is required"}),{isValid:!1,errors:r}):(/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e)||r.push({field:"companyId",message:"Invalid company ID format"}),{isValid:r.length===0,errors:r})}static validateStoreId(e){const r=[];return e===null||e===""?{isValid:!0,errors:r}:(/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e)||r.push({field:"storeId",message:"Invalid store ID format"}),{isValid:r.length===0,errors:r})}static validateDateFormat(e,r){const s=[];if(!e||e.trim()==="")return s.push({field:r,message:`${r} is required`}),{isValid:!1,errors:s};if(!/^\d{4}-(0[1-9]|1[0-2])-(0[1-9]|[12]\d|3[01])$/.test(e))return s.push({field:r,message:`Invalid ${r} format. Expected YYYY-MM-DD`}),{isValid:!1,errors:s};const o=new Date(e);return isNaN(o.getTime())&&s.push({field:r,message:`Invalid ${r}`}),{isValid:s.length===0,errors:s}}static validateDateRange(e,r){const s=[],n=this.validateDateFormat(e,"fromDate"),o=this.validateDateFormat(r,"toDate");if(n.isValid||s.push(...n.errors),o.isValid||s.push(...o.errors),s.length>0)return{isValid:!1,errors:s};const i=new Date(e),l=new Date(r);return i>l&&s.push({field:"dateRange",message:"From date must be before or equal to date"}),Math.abs((l.getTime()-i.getTime())/(1e3*60*60*24))>366&&s.push({field:"dateRange",message:"Date range cannot exceed 12 months"}),{isValid:s.length===0,errors:s}}static validateStatementType(e){const r=[];return!e||e.trim()===""?(r.push({field:"type",message:"Income statement type is required"}),{isValid:!1,errors:r}):(["monthly","12month"].includes(e)||r.push({field:"type",message:'Invalid income statement type. Must be "monthly" or "12month"'}),{isValid:r.length===0,errors:r})}static validateQuery(e,r,s,n,o){const i=[],l=this.validateCompanyId(e);l.isValid||i.push(...l.errors);const c=this.validateStoreId(r);c.isValid||i.push(...c.errors);const d=this.validateDateRange(s,n);d.isValid||i.push(...d.errors);const u=this.validateStatementType(o);if(u.isValid||i.push(...u.errors),o==="12month"&&d.isValid){const h=new Date(s),f=new Date(n),p=(f.getFullYear()-h.getFullYear())*12+(f.getMonth()-h.getMonth());(p<11||p>12)&&i.push({field:"dateRange",message:"12-month view requires a date range of approximately 12 months"})}return{isValid:i.length===0,errors:i}}}const P8="_filterContainer_wsz6m_3",$8="_filterHeader_wsz6m_13",F8="_filterTitle_wsz6m_21",B8="_filterContent_wsz6m_34",H8="_filterRow_wsz6m_38",V8="_filterField_wsz6m_46",z8="_filterLabel_wsz6m_54",U8="_dateInput_wsz6m_62",W8="_filterActions_wsz6m_93",vr={filterContainer:P8,filterHeader:$8,filterTitle:F8,filterContent:B8,filterRow:H8,filterField:V8,filterLabel:z8,dateInput:U8,filterActions:W8},F_=()=>{const t=new Date,e=new Date(t.getFullYear(),t.getMonth(),1);return te.toDateOnly(e)},B_=()=>{const t=new Date,e=new Date(t.getFullYear(),t.getMonth()+1,0);return te.toDateOnly(e)},q8=({onSearch:t,onClear:e,className:r=""})=>{const{currentCompany:s}=at(),n=(s==null?void 0:s.stores)||[],{messageState:o,closeMessage:i,showWarning:l}=Es(),[c,d]=b.useState(null),[u,h]=b.useState("monthly"),[f,p]=b.useState(F_()),[g,y]=b.useState(B_()),x=[{value:"monthly",label:"Monthly"},{value:"12month",label:"12-Month View"}],m=()=>{var S,E,C;const v=ui.validateDateRange(f,g);if(!v.isValid){l({title:"Invalid Date Range",message:((S=v.errors[0])==null?void 0:S.message)||"Invalid date range",confirmText:"OK"});return}if(c){const k=ui.validateStoreId(c);if(!k.isValid){l({title:"Invalid Store",message:((E=k.errors[0])==null?void 0:E.message)||"Invalid store ID",confirmText:"OK"});return}}const w=ui.validateStatementType(u);if(!w.isValid){l({title:"Invalid Type",message:((C=w.errors[0])==null?void 0:C.message)||"Invalid statement type",confirmText:"OK"});return}t({store:c,type:u,fromDate:f,toDate:g})},_=()=>{d(null),h("monthly"),p(F_()),y(B_()),e==null||e()};return b.useEffect(()=>{_()},[s==null?void 0:s.company_id]),a.jsxs("div",{className:`${vr.filterContainer} ${r}`,children:[a.jsx("div",{className:vr.filterHeader,children:a.jsxs("div",{className:vr.filterTitle,children:[a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"})}),a.jsx("span",{children:"Search Income Statement"})]})}),a.jsxs("div",{className:vr.filterContent,children:[a.jsxs("div",{className:vr.filterRow,children:[a.jsxs("div",{className:vr.filterField,children:[a.jsx("label",{className:vr.filterLabel,children:"STORE"}),a.jsx(Hs,{stores:n,selectedStoreId:c,onStoreSelect:d,showAllStoresOption:!0,width:"100%"})]}),a.jsxs("div",{className:vr.filterField,children:[a.jsx("label",{className:vr.filterLabel,children:"TYPE"}),a.jsx(We,{id:"income-type-filter",name:"type",placeholder:"Select type",value:u,options:x,onChange:v=>h(v),fullWidth:!0})]}),a.jsxs("div",{className:vr.filterField,children:[a.jsx("label",{className:vr.filterLabel,children:"FROM DATE"}),a.jsx("input",{type:"date",className:vr.dateInput,value:f,onChange:v=>p(v.target.value),disabled:u==="12month"})]}),a.jsxs("div",{className:vr.filterField,children:[a.jsx("label",{className:vr.filterLabel,children:"TO DATE"}),a.jsx("input",{type:"date",className:vr.dateInput,value:g,onChange:v=>y(v.target.value),disabled:u==="12month"})]})]}),a.jsxs("div",{className:vr.filterActions,children:[a.jsx(be,{onClick:_,variant:"secondary",children:"Clear All"}),a.jsxs(be,{onClick:m,variant:"primary",children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"11",cy:"11",r:"8"}),a.jsx("path",{d:"m21 21-4.35-4.35"})]}),"Search"]})]})]}),a.jsx(De,{variant:o.variant,title:o.title,message:o.message,isOpen:o.isOpen,onClose:i,confirmText:o.confirmText||"OK"})]})};class G8{async getMonthlyIncomeStatement(e,r,s,n){const o=ne.getClient(),i={p_company_id:e,p_store_id:r||null,p_start_date:s,p_end_date:n};console.log(" [DataSource] Calling get_income_statement_v2 RPC with params:",i);const{data:l,error:c}=await o.rpc("get_income_statement_v2",i);if(c)throw console.error(" [DataSource] Error fetching monthly income statement:",c),new Error(c.message);return console.log(" [DataSource] Monthly income statement data received:",l),l}async get12MonthIncomeStatement(e,r,s,n){const o=ne.getClient(),i={p_company_id:e,p_store_id:r||null,p_start_date:s,p_end_date:n};console.log(" [DataSource] Calling get_income_statement_monthly RPC with params:",i);const{data:l,error:c}=await o.rpc("get_income_statement_monthly",i);if(c)throw console.error(" [DataSource] Error fetching 12-month income statement:",c),new Error(c.message);return console.log(" [DataSource] 12-month income statement data received:",l),l}async getCompanyCurrency(e){const r=ne.getClient();try{const{data:s,error:n}=await r.from("companies").select("base_currency_id").eq("company_id",e).single();if(n||!(s!=null&&s.base_currency_id))return console.log("No base currency found, using default"),"$";const{data:o,error:i}=await r.from("currency_types").select("currency_code, currency_name, symbol").eq("currency_id",s.base_currency_id).single();return i||!(o!=null&&o.symbol)?(console.log("No currency symbol found, using default"),"$"):(console.log("Using company currency:",o),o.symbol)}catch(s){return console.error("Error in getCompanyCurrency:",s),"$"}}}class H_{static fromMonthlyRpcResponse(e){if(!Array.isArray(e))throw console.error(" [Model] Invalid RPC response format: expected array, got",typeof e),new Error("Invalid monthly income statement data format");if(e.length===0)return console.warn(" [Model] Empty RPC response received"),[];try{const r=e.map((s,n)=>!s||typeof s!="object"?(console.warn(` [Model] Invalid section at index ${n}:`,s),{section:"Unknown Section",section_total:0,subcategories:[]}):{section:s.section||`Unknown Section ${n+1}`,section_total:this.parseNumber(s.section_total,0),subcategories:this.mapSubcategories(s.subcategories||[])});return console.log(" [Model] Successfully mapped monthly income statement data"),r}catch(r){throw console.error(" [Model] Error mapping monthly RPC response:",r),new Error("Failed to map monthly income statement data")}}static from12MonthRpcResponse(e){var r,s,n,o,i,l;if(!e||typeof e!="object")throw console.error(" [Model] Invalid 12-month RPC response format:",typeof e),new Error("Invalid 12-month income statement data format");if(!e.sections||!Array.isArray(e.sections))throw console.error(" [Model] Missing or invalid sections in 12-month data"),new Error("Invalid 12-month income statement data: missing sections");if(!e.months||!Array.isArray(e.months))throw console.error(" [Model] Missing or invalid months in 12-month data"),new Error("Invalid 12-month income statement data: missing months");try{const c={summary:{period_info:{start_date:((s=(r=e.summary)==null?void 0:r.period_info)==null?void 0:s.start_date)||"",end_date:((o=(n=e.summary)==null?void 0:n.period_info)==null?void 0:o.end_date)||"",store_scope:((l=(i=e.summary)==null?void 0:i.period_info)==null?void 0:l.store_scope)||"all_stores"}},months:e.months,sections:e.sections.map((d,u)=>!d||typeof d!="object"?(console.warn(` [Model] Invalid section at index ${u}:`,d),{section:"Unknown Section",section_total:0,section_monthly_totals:{},subcategories:[]}):{section:d.section||`Unknown Section ${u+1}`,section_total:this.parseNumber(d.section_total,0),section_monthly_totals:d.section_monthly_totals||{},subcategories:this.mapSubcategories(d.subcategories||[])})};return console.log(" [Model] Successfully mapped 12-month income statement data"),c}catch(c){throw console.error(" [Model] Error mapping 12-month RPC response:",c),new Error("Failed to map 12-month income statement data")}}static mapSubcategories(e){return Array.isArray(e)?e.map((r,s)=>!r||typeof r!="object"?(console.warn(` [Model] Invalid subcategory at index ${s}:`,r),{subcategory:"",subcategory_total:0,accounts:[]}):{subcategory:r.subcategory||"",subcategory_total:this.parseNumber(r.subcategory_total,0),subcategory_monthly_totals:r.subcategory_monthly_totals||{},accounts:this.mapAccounts(r.accounts||[])}):(console.warn(" [Model] Invalid subcategories format, expected array"),[])}static mapAccounts(e){return Array.isArray(e)?e.map((r,s)=>!r||typeof r!="object"?(console.warn(` [Model] Invalid account at index ${s}:`,r),{account_name:"Unknown Account",net_amount:0}):{account_name:r.account_name||`Unknown Account ${s+1}`,net_amount:this.parseNumber(r.net_amount,0),monthly_amounts:r.monthly_amounts||{},total:this.parseNumber(r.total,this.parseNumber(r.net_amount,0))}):(console.warn(" [Model] Invalid accounts format, expected array"),[])}static parseNumber(e,r=0){if(e==null)return r;if(typeof e=="number")return isNaN(e)?r:e;if(typeof e=="string"){const s=parseFloat(e);return isNaN(s)?r:s}return r}static validateMappedData(e,r){if(!e)return console.error(" [Model] Validation failed: data is null or undefined"),!1;if(r==="monthly"){const s=e;return Array.isArray(s)?(console.log(" [Model] Monthly data validation passed"),!0):(console.error(" [Model] Validation failed: monthly data is not an array"),!1)}else{const s=e;return!s.sections||!Array.isArray(s.sections)?(console.error(" [Model] Validation failed: 12-month data missing sections array"),!1):!s.months||!Array.isArray(s.months)?(console.error(" [Model] Validation failed: 12-month data missing months array"),!1):(console.log(" [Model] 12-month data validation passed"),!0)}}}class J8{constructor(){W(this,"dataSource");this.dataSource=new G8}async getMonthlyIncomeStatement(e,r,s,n){try{console.log(" [Repository] Getting monthly income statement");const o=await this.dataSource.getMonthlyIncomeStatement(e,r,s,n);if(!o||!Array.isArray(o)||o.length===0)return{success:!1,error:"No monthly income statement data available"};const i=H_.fromMonthlyRpcResponse(o),l=await this.dataSource.getCompanyCurrency(e);return console.log(" [Repository] Monthly income statement data processed successfully"),{success:!0,data:i,currency:l}}catch(o){return console.error(" [Repository] Error fetching monthly income statement:",o),{success:!1,error:o instanceof Error?o.message:"Failed to fetch monthly income statement"}}}async get12MonthIncomeStatement(e,r,s,n){try{console.log(" [Repository] Getting 12-month income statement");const o=await this.dataSource.get12MonthIncomeStatement(e,r,s,n);if(!o||!o.sections||!o.months)return{success:!1,error:"No 12-month income statement data available"};const i=H_.from12MonthRpcResponse(o),l=await this.dataSource.getCompanyCurrency(e);return console.log(" [Repository] 12-month income statement data processed successfully"),{success:!0,data:i,currency:l}}catch(o){return console.error(" [Repository] Error fetching 12-month income statement:",o),{success:!1,error:o instanceof Error?o.message:"Failed to fetch 12-month income statement"}}}}const V_=new J8,dr=Jt((t,e)=>({companyId:"",storeId:null,monthlyData:null,twelveMonthData:null,currentFilters:null,currency:"$",loading:!1,error:null,messageState:{isOpen:!1,variant:"info",title:"",message:""},setCompanyId:r=>{t({companyId:r})},setStoreId:r=>{t({storeId:r})},setCurrentFilters:r=>{t({currentFilters:r})},closeMessage:()=>{t({messageState:{isOpen:!1,variant:"info",title:"",message:""}})},loadMonthlyData:async(r,s,n,o)=>{var i,l;console.log(" [Provider] Loading monthly income statement:",{companyId:r,storeId:s,startDate:n,endDate:o}),t({loading:!0,twelveMonthData:null,error:null});try{const c=ui.validateQuery(r,s,n,o,"monthly");if(!c.isValid){const u=c.errors.map(h=>h.message).join(", ");console.error(" [Provider] Validation failed:",c.errors),t({monthlyData:null,loading:!1,error:u,messageState:{isOpen:!0,variant:"warning",title:"Validation Error",message:u}});return}const d=await V_.getMonthlyIncomeStatement(r,s,n,o);if(!d.success){console.error(" [Provider] Repository error:",d.error);const u=((i=d.error)==null?void 0:i.includes("No"))||((l=d.error)==null?void 0:l.includes("available")),h=u?"info":"error",f=u?"No Data Available":"Error Loading Data",p=d.error||(u?"No income statement data found for the selected period.":"Failed to load income statement. Please try again.");t({monthlyData:null,loading:!1,error:d.error||"Failed to load data",messageState:{isOpen:!0,variant:h,title:f,message:p}});return}t({monthlyData:d.data||null,currency:d.currency||"$",loading:!1,error:null}),console.log(" [Provider] Monthly income statement loaded successfully")}catch(c){const d=c instanceof Error?c.message:"An unexpected error occurred";console.error(" [Provider] Error loading monthly data:",c),t({monthlyData:null,loading:!1,error:d,messageState:{isOpen:!0,variant:"error",title:"Unexpected Error",message:d}})}},load12MonthData:async(r,s,n,o)=>{var i,l;console.log(" [Provider] Loading 12-month income statement:",{companyId:r,storeId:s,startDate:n,endDate:o}),t({loading:!0,monthlyData:null,error:null});try{const c=ui.validateQuery(r,s,n,o,"12month");if(!c.isValid){const u=c.errors.map(h=>h.message).join(", ");console.error(" [Provider] Validation failed:",c.errors),t({twelveMonthData:null,loading:!1,error:u,messageState:{isOpen:!0,variant:"warning",title:"Validation Error",message:u}});return}const d=await V_.get12MonthIncomeStatement(r,s,n,o);if(!d.success){console.error(" [Provider] Repository error:",d.error);const u=((i=d.error)==null?void 0:i.includes("No"))||((l=d.error)==null?void 0:l.includes("available")),h=u?"info":"error",f=u?"No Data Available":"Error Loading Data",p=d.error||(u?"No income statement data found for the selected period.":"Failed to load income statement. Please try again.");t({twelveMonthData:null,loading:!1,error:d.error||"Failed to load data",messageState:{isOpen:!0,variant:h,title:f,message:p}});return}t({twelveMonthData:d.data||null,currency:d.currency||"$",loading:!1,error:null}),console.log(" [Provider] 12-month income statement loaded successfully")}catch(c){const d=c instanceof Error?c.message:"An unexpected error occurred";console.error(" [Provider] Error loading 12-month data:",c),t({twelveMonthData:null,loading:!1,error:d,messageState:{isOpen:!0,variant:"error",title:"Unexpected Error",message:d}})}},clearData:()=>{console.log(" [Provider] Clearing income statement data"),t({monthlyData:null,twelveMonthData:null,currentFilters:null,currency:"$",error:null})},reset:()=>{console.log(" [Provider] Resetting income statement state"),t({companyId:"",storeId:null,monthlyData:null,twelveMonthData:null,currentFilters:null,currency:"$",loading:!1,error:null,messageState:{isOpen:!1,variant:"info",title:"",message:""}})}})),K8=()=>{const t=dr(m=>m.companyId),e=dr(m=>m.storeId),r=dr(m=>m.monthlyData),s=dr(m=>m.twelveMonthData),n=dr(m=>m.currentFilters),o=dr(m=>m.currency),i=dr(m=>m.loading),l=dr(m=>m.error),c=dr(m=>m.messageState),d=dr(m=>m.setCompanyId),u=dr(m=>m.setStoreId),h=dr(m=>m.setCurrentFilters),f=dr(m=>m.closeMessage),p=dr(m=>m.loadMonthlyData),g=dr(m=>m.load12MonthData),y=dr(m=>m.clearData),x=dr(m=>m.reset);return{companyId:t,storeId:e,monthlyData:r,twelveMonthData:s,currentFilters:n,currency:o,loading:i,error:l,messageState:c,setCompanyId:d,setStoreId:u,setCurrentFilters:h,closeMessage:f,loadMonthlyData:p,load12MonthData:g,clearData:y,reset:x}},Y8="_pageContainer_gbxmi_6",Q8="_pageContent_gbxmi_11",Z8="_pageHeader_gbxmi_17",X8="_pageTitle_gbxmi_21",e$="_pageSubtitle_gbxmi_28",t$="_filterSection_gbxmi_35",r$="_contentSection_gbxmi_39",s$="_contentWrapper_gbxmi_43",n$="_summaryCards_gbxmi_53",o$="_summaryCard_gbxmi_53",a$="_revenue_gbxmi_75",i$="_profit_gbxmi_79",l$="_operating_gbxmi_83",c$="_net_gbxmi_87",d$="_cardLabel_gbxmi_91",u$="_cardValue_gbxmi_100",h$="_cardPercent_gbxmi_109",f$="_tableContainer_gbxmi_116",m$="_tableHeader_gbxmi_120",p$="_tableTitle_gbxmi_124",g$="_periodInfo_gbxmi_131",_$="_incomeTable_gbxmi_137",y$="_descriptionColumn_gbxmi_155",v$="_amountColumn_gbxmi_159",x$="_currencyNote_gbxmi_164",b$="_sectionRow_gbxmi_172",w$="_sectionHeader_gbxmi_178",S$="_cogs_gbxmi_202",C$="_expenses_gbxmi_214",j$="_ebitda_gbxmi_234",k$="_sectionName_gbxmi_240",N$="_sectionTotal_gbxmi_247",I$="_subcategoryRow_gbxmi_257",E$="_subsectionHeader_gbxmi_261",T$="_subcategoryName_gbxmi_277",A$="_subcategoryTotal_gbxmi_284",L$="_accountRow_gbxmi_306",D$="_accountName_gbxmi_314",M$="_accountAmount_gbxmi_334",R$="_horizontalScroll_gbxmi_346",O$="_monthlyTable_gbxmi_351",P$="_monthColumn_gbxmi_382",$$="_totalColumn_gbxmi_386",F$="_table12Month_gbxmi_393",B$="_totalRow_gbxmi_511",H$="_totalLabel_gbxmi_525",V$="_totalAmount_gbxmi_530",z$="_sectionTotalLabel_gbxmi_553",U$="_sectionTotalAmount_gbxmi_559",W$="_sectionAmount_gbxmi_653",q$="_subcategoryAmount_gbxmi_692",G$="_ratiosSection_gbxmi_769",J$="_ratiosTitle_gbxmi_774",K$="_ratiosGrid_gbxmi_781",Y$="_ratioItem_gbxmi_787",Q$="_ratioCard_gbxmi_796",Z$="_ratioLabel_gbxmi_805",X$="_ratioValue_gbxmi_814",eF="_loadingState_gbxmi_835",tF="_spinner_gbxmi_844",rF="_spin_gbxmi_844",sF="_errorState_gbxmi_865",nF="_errorMessage_gbxmi_875",oF="_emptyState_gbxmi_885",aF="_emptyIcon_gbxmi_897",iF="_emptyTitle_gbxmi_909",lF="_emptyText_gbxmi_916",G={pageContainer:Y8,pageContent:Q8,pageHeader:Z8,pageTitle:X8,pageSubtitle:e$,filterSection:t$,contentSection:r$,contentWrapper:s$,summaryCards:n$,summaryCard:o$,revenue:a$,profit:i$,operating:l$,net:c$,cardLabel:d$,cardValue:u$,cardPercent:h$,tableContainer:f$,tableHeader:m$,tableTitle:p$,periodInfo:g$,incomeTable:_$,descriptionColumn:y$,amountColumn:v$,currencyNote:x$,sectionRow:b$,sectionHeader:w$,"cost-of-goods-sold":"_cost-of-goods-sold_gbxmi_201",cogs:S$,"gross-profit":"_gross-profit_gbxmi_208",expenses:C$,"operating-expenses":"_operating-expenses_gbxmi_215","operating-income":"_operating-income_gbxmi_221","net-income":"_net-income_gbxmi_227",ebitda:j$,sectionName:k$,sectionTotal:N$,subcategoryRow:I$,subsectionHeader:E$,subcategoryName:T$,subcategoryTotal:A$,accountRow:L$,accountName:D$,accountAmount:M$,horizontalScroll:R$,monthlyTable:O$,monthColumn:P$,totalColumn:$$,table12Month:F$,totalRow:B$,totalLabel:H$,totalAmount:V$,sectionTotalLabel:z$,sectionTotalAmount:U$,sectionAmount:W$,subcategoryAmount:q$,ratiosSection:G$,ratiosTitle:J$,ratiosGrid:K$,ratioItem:Y$,ratioCard:Q$,ratioLabel:Z$,ratioValue:X$,loadingState:eF,spinner:tF,spin:rF,errorState:sF,errorMessage:nF,emptyState:oF,emptyIcon:aF,emptyTitle:iF,emptyText:lF},cF=()=>{const{currentCompany:t}=at(),{monthlyData:e,twelveMonthData:r,currentFilters:s,currency:n,loading:o,messageState:i,closeMessage:l,loadMonthlyData:c,load12MonthData:d,clearData:u,setCurrentFilters:h}=K8();b.useEffect(()=>{u()},[t==null?void 0:t.company_id,u]);const f=async w=>{if(!(t!=null&&t.company_id)){console.error("No company selected");return}h(w);const S=w.store||null;w.type==="monthly"?await c(t.company_id,S,w.fromDate,w.toDate):await d(t.company_id,S,w.fromDate,w.toDate)},p=()=>{u()},g=w=>w==null?`${n}0`:typeof w=="string"?w:`${n}${w.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})}`,y=w=>{let S=0,E=0,C=0,k=0,N=0,I=0,L=0,T=0;return w.forEach(j=>{const M=j.section.toLowerCase();M==="revenue"?S=typeof j.section_total=="number"?j.section_total:0:M==="gross profit"?E=typeof j.section_total=="number"?j.section_total:0:M==="operating income"?C=typeof j.section_total=="number"?j.section_total:0:M==="net income"?k=typeof j.section_total=="number"?j.section_total:0:M==="gross margin"?N=typeof j.section_total=="number"?j.section_total:0:M==="operating margin"?I=typeof j.section_total=="number"?j.section_total:0:M==="net margin"?L=typeof j.section_total=="number"?j.section_total:0:M==="ebitda"&&(T=typeof j.section_total=="number"?j.section_total:0)}),{revenue:S,grossProfit:E,operatingIncome:C,netIncome:k,grossMargin:N,operatingMargin:I,netMargin:L,ebitda:T}},x=w=>{if(!w)return"";const[S,E,C]=w.fromDate.split("-").map(Number),[k,N,I]=w.toDate.split("-").map(Number),L=new Date(S,E-1,C),T=new Date(k,N-1,I),j={year:"numeric",month:"short",day:"numeric"};return`${L.toLocaleDateString("en-US",j)} - ${T.toLocaleDateString("en-US",j)}`},m=w=>{const S=y(w);return a.jsxs("div",{className:G.contentWrapper,children:[a.jsxs("div",{className:G.summaryCards,children:[a.jsxs("div",{className:`${G.summaryCard} ${G.revenue}`,children:[a.jsx("div",{className:G.cardLabel,children:"TOTAL REVENUE"}),a.jsx("div",{className:G.cardValue,children:g(S.revenue)}),a.jsxs("div",{className:G.cardPercent,children:[S.grossMargin.toFixed(2),"% Gross Margin"]})]}),a.jsxs("div",{className:`${G.summaryCard} ${G.profit}`,children:[a.jsx("div",{className:G.cardLabel,children:"GROSS PROFIT"}),a.jsx("div",{className:G.cardValue,children:g(S.grossProfit)}),a.jsxs("div",{className:G.cardPercent,children:[S.operatingMargin.toFixed(2),"% Operating Margin"]})]}),a.jsxs("div",{className:`${G.summaryCard} ${G.operating}`,children:[a.jsx("div",{className:G.cardLabel,children:"OPERATING INCOME"}),a.jsx("div",{className:G.cardValue,children:g(S.operatingIncome)}),a.jsxs("div",{className:G.cardPercent,children:["EBITDA: ",g(S.ebitda)]})]}),a.jsxs("div",{className:`${G.summaryCard} ${G.net}`,children:[a.jsx("div",{className:G.cardLabel,children:"NET INCOME"}),a.jsx("div",{className:G.cardValue,children:g(S.netIncome)}),a.jsxs("div",{className:G.cardPercent,children:[S.netMargin.toFixed(2),"% Net Margin"]})]})]}),a.jsxs("div",{className:G.tableContainer,children:[a.jsxs("div",{className:G.tableHeader,children:[a.jsx("h3",{className:G.tableTitle,children:"Income Statement"}),a.jsxs("div",{className:G.periodInfo,children:["For the Period Ended ",x(s)]})]}),a.jsxs("table",{className:G.incomeTable,children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{className:G.descriptionColumn,children:"Description"}),a.jsxs("th",{className:G.amountColumn,children:["Amount",a.jsx("br",{}),a.jsxs("small",{className:G.currencyNote,children:["(in ",n,")"]})]})]})}),a.jsx("tbody",{children:w.map((E,C)=>{if(E.section.toLowerCase().includes("margin"))return null;const k=E.section.toLowerCase().replace(/ /g,"-");return a.jsxs(Ar.Fragment,{children:[a.jsx("tr",{className:`${G.sectionHeader} ${G[k]||""}`,children:a.jsx("td",{colSpan:2,children:E.section.toUpperCase()})}),E.subcategories&&E.subcategories.map((N,I)=>a.jsxs(Ar.Fragment,{children:[N.subcategory&&a.jsx("tr",{className:G.subsectionHeader,children:a.jsx("td",{colSpan:2,children:N.subcategory})}),N.accounts&&N.accounts.map((L,T)=>a.jsxs("tr",{className:G.accountRow,children:[a.jsx("td",{className:G.accountName,children:L.account_name}),a.jsx("td",{className:G.accountAmount,children:L.net_amount.toLocaleString("en-US")})]},`${C}-${I}-${T}`))]},`${C}-${I}`))]},C)})})]})]}),a.jsxs("div",{className:G.ratiosSection,children:[a.jsx("h3",{className:G.ratiosTitle,children:"Key Financial Ratios"}),a.jsxs("div",{className:G.ratiosGrid,children:[a.jsxs("div",{className:G.ratioCard,children:[a.jsx("div",{className:G.ratioLabel,children:"GROSS MARGIN"}),a.jsxs("div",{className:G.ratioValue,children:[S.grossMargin.toFixed(2),"%"]})]}),a.jsxs("div",{className:G.ratioCard,children:[a.jsx("div",{className:G.ratioLabel,children:"OPERATING MARGIN"}),a.jsxs("div",{className:G.ratioValue,children:[S.operatingMargin.toFixed(2),"%"]})]}),a.jsxs("div",{className:G.ratioCard,children:[a.jsx("div",{className:G.ratioLabel,children:"NET MARGIN"}),a.jsxs("div",{className:G.ratioValue,children:[S.netMargin.toFixed(2),"%"]})]}),a.jsxs("div",{className:G.ratioCard,children:[a.jsx("div",{className:G.ratioLabel,children:"EBITDA MARGIN"}),a.jsxs("div",{className:G.ratioValue,children:[S.revenue!==0?(S.ebitda/S.revenue*100).toFixed(2):"0.00","%"]})]})]})]})]})},_=w=>{const[S,E]=w.split("-"),C=["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"],k=parseInt(E,10)-1;return`${S} ${C[k]}`},v=w=>{var k,N,I,L;const{months:S,sections:E,summary:C}=w;return a.jsxs("div",{className:G.contentWrapper,children:[a.jsxs("div",{className:G.tableHeader,children:[a.jsx("h3",{className:G.tableTitle,children:"Income Statement - 12 Month View"}),a.jsxs("div",{className:G.periodInfo,children:["Period: ",((k=C==null?void 0:C.period_info)==null?void 0:k.start_date)||"N/A"," to ",((N=C==null?void 0:C.period_info)==null?void 0:N.end_date)||"N/A",((I=C==null?void 0:C.period_info)==null?void 0:I.store_name)&&` (${C.period_info.store_name})`,!((L=C==null?void 0:C.period_info)!=null&&L.store_name)&&" (ALL STORES)"]})]}),a.jsx("div",{className:G.tableContainer,children:a.jsx("div",{className:G.horizontalScroll,children:a.jsxs("table",{className:`${G.monthlyTable} ${G.table12Month}`,children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsxs("th",{className:G.accountColumn,children:["ACCOUNT",a.jsx("br",{}),a.jsxs("small",{className:G.currencyNote,children:["(in ",n,")"]})]}),S.map((T,j)=>a.jsx("th",{className:G.monthColumn,children:_(T)},j)),a.jsx("th",{className:G.totalColumn,children:"TOTAL"})]})}),a.jsx("tbody",{children:E.map((T,j)=>{if(T.section.toLowerCase().includes("margin"))return null;const M=T.section.toLowerCase().replace(/ /g,"-");return a.jsxs(Ar.Fragment,{children:[a.jsx("tr",{className:`${G.sectionHeader} ${G[M]||""}`,children:a.jsx("td",{colSpan:S.length+2,children:T.section.toUpperCase()})}),T.subcategories&&T.subcategories.map((R,O)=>a.jsxs(Ar.Fragment,{children:[R.subcategory&&a.jsx("tr",{className:G.subsectionHeader,children:a.jsx("td",{colSpan:S.length+2,children:R.subcategory})}),R.accounts&&R.accounts.map((z,D)=>a.jsxs("tr",{className:G.accountRow,children:[a.jsx("td",{className:G.accountName,children:z.account_name}),S.map((P,$)=>{var U;return a.jsx("td",{className:G.accountAmount,children:g(((U=z.monthly_amounts)==null?void 0:U[P])||0)},$)}),a.jsx("td",{className:G.accountAmount,children:g(z.total||z.net_amount)})]},`${j}-${O}-${D}`)),R.subcategory&&a.jsxs("tr",{className:G.totalRow,children:[a.jsxs("td",{className:G.totalLabel,children:["Total ",R.subcategory]}),S.map((z,D)=>{var P;return a.jsx("td",{className:G.totalAmount,children:g(((P=R.subcategory_monthly_totals)==null?void 0:P[z])||0)},D)}),a.jsx("td",{className:G.totalAmount,children:g(R.subcategory_total)})]})]},`${j}-${O}`)),a.jsxs("tr",{className:`${G.sectionTotal} ${G[M]||""}`,children:[a.jsx("td",{className:G.sectionTotalLabel,children:a.jsx("strong",{children:T.section})}),S.map((R,O)=>{var z;return a.jsx("td",{className:G.sectionTotalAmount,children:g(((z=T.section_monthly_totals)==null?void 0:z[R])||0)},O)}),a.jsx("td",{className:G.sectionTotalAmount,children:g(T.section_total)})]})]},j)})})]})})})]})};return a.jsxs(a.Fragment,{children:[a.jsx(fe,{activeItem:"finance"}),a.jsx("div",{className:G.pageContainer,children:a.jsxs("div",{className:G.pageContent,children:[a.jsxs("div",{className:G.pageHeader,children:[a.jsx("h1",{className:G.pageTitle,children:"Income Statement"}),a.jsx("p",{className:G.pageSubtitle,children:"View revenue and expenses"})]}),a.jsx(q8,{onSearch:f,onClear:p,className:G.filterSection}),a.jsxs("div",{className:G.contentSection,children:[o&&a.jsx(Ne,{fullscreen:!0,size:"large"}),!o&&!e&&!r&&a.jsxs("div",{className:G.emptyState,children:[a.jsx("div",{className:G.emptyIcon,children:a.jsxs("svg",{width:"120",height:"120",viewBox:"0 0 120 120",fill:"none",children:[a.jsx("circle",{cx:"60",cy:"60",r:"50",fill:"#F0F6FF"}),a.jsx("rect",{x:"35",y:"40",width:"50",height:"60",rx:"4",fill:"white",stroke:"#0064FF",strokeWidth:"2"}),a.jsx("rect",{x:"40",y:"35",width:"50",height:"60",rx:"4",fill:"white",stroke:"#0064FF",strokeWidth:"2"}),a.jsx("line",{x1:"48",y1:"45",x2:"75",y2:"45",stroke:"#E9ECEF",strokeWidth:"2",strokeLinecap:"round"}),a.jsx("line",{x1:"48",y1:"52",x2:"70",y2:"52",stroke:"#E9ECEF",strokeWidth:"2",strokeLinecap:"round"}),a.jsx("line",{x1:"48",y1:"59",x2:"72",y2:"59",stroke:"#E9ECEF",strokeWidth:"2",strokeLinecap:"round"}),a.jsx("circle",{cx:"60",cy:"75",r:"12",fill:"#0064FF"}),a.jsx("path",{d:"M56 75 L58 77 L64 71",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})}),a.jsx("h2",{className:G.emptyTitle,children:"Select Filters to Load Income Statement"}),a.jsx("p",{className:G.emptyText,children:"Choose Monthly type and date range, then click Search to view the income statement."})]}),!o&&e&&(s==null?void 0:s.type)==="monthly"&&m(e),!o&&r&&(s==null?void 0:s.type)==="12month"&&v(r)]}),a.jsx(De,{variant:i.variant,title:i.title,message:i.message,isOpen:i.isOpen,onClose:l})]})})]})};class dF{async getInventory(e,r,s=1,n=20,o){var u,h,f;const i=ne.getClient();if(!e)return{products:[]};const l={p_company_id:e,p_store_id:r,p_page:s,p_limit:n};o&&o.trim()!==""&&(l.p_search=o.trim());const{data:c,error:d}=await i.rpc("get_inventory_page",l);if(d)throw new Error(d.message);if(c&&typeof c=="object"&&"success"in c&&c.success===!0)return{products:((u=c.data)==null?void 0:u.products)||[],currency:(h=c.data)==null?void 0:h.currency,pagination:(f=c.data)==null?void 0:f.pagination};throw new Error("Invalid response format from get_inventory_page")}async updateProduct(e,r,s,n){var d;const o=ne.getClient(),i={p_product_id:e,p_company_id:r,p_store_id:s,p_sku:n.sku,p_product_name:n.productName,p_category_id:n.category||null,p_brand_id:n.brand||null,p_unit:n.unit||"piece",p_product_type:n.productType||"commodity",p_cost_price:n.costPrice,p_selling_price:n.sellingPrice,p_new_quantity:n.currentStock},{data:l,error:c}=await o.rpc("inventory_edit_product",i);return c?{success:!1,error:c.message}:l&&typeof l=="object"&&"success"in l?l.success===!0?{success:!0}:{success:!1,error:((d=l.error)==null?void 0:d.message)||"Failed to update product"}:{success:!0}}async getMetadata(e,r){const s=ne.getClient(),{data:n,error:o}=await s.rpc("get_inventory_metadata",{p_company_id:e,p_store_id:r||null});if(o)throw new Error(o.message);return n}async importExcel(e,r,s,n){const o=ne.getClient(),{data:i,error:l}=await o.rpc("inventory_import_excel",{p_company_id:e,p_store_id:r,p_user_id:s,p_products:n});return l?{success:!1,error:l.message}:i&&typeof i=="object"&&"success"in i?{success:i.success,summary:i.summary,errors:i.errors}:{success:!1,error:"Invalid response format from inventory_import_excel"}}}class uF{constructor(e,r,s,n,o,i,l,c,d,u,h,f,p=null,g=null,y="",x="",m="commodity",_=0,v){this.productId=e,this.productCode=r,this.productName=s,this.categoryName=n,this.brandName=o,this.currentStock=i,this.minStock=l,this.maxStock=c,this.unitPrice=d,this.totalValue=u,this.unit=h,this.currencySymbol=f,this.categoryId=p,this.brandId=g,this.sku=y,this.barcode=x,this.productType=m,this.costPrice=_,this.createdAt=v}get isLowStock(){return this.currentStock<=this.minStock}get isOverStock(){return this.currentStock>=this.maxStock}get stockStatus(){return this.isLowStock?"low":this.isOverStock?"over":"normal"}formatCurrency(e){return`${this.currencySymbol}${e.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})}`}get stockPercentage(){return this.maxStock===0?0:this.currentStock/this.maxStock*100}}class vm{static fromJson(e,r=""){var c,d,u;const s=((c=e.stock)==null?void 0:c.quantity_on_hand)??0,n=((d=e.price)==null?void 0:d.selling)??0,o=((u=e.price)==null?void 0:u.cost)??0,i=s*n,l=e.created_at?te.toLocalSafe(e.created_at):void 0;return new uF(e.product_id,e.sku||"N/A",e.product_name||"Unknown Product",e.category_name||"Uncategorized",e.brand_name||"No Brand",s,0,0,n,i,e.unit||"piece",r,e.category_id||null,e.brand_id||null,e.sku||"",e.barcode||"",e.product_type||"commodity",o,l??void 0)}static toJson(e){return{product_id:e.productId,sku:e.sku,barcode:e.barcode,product_name:e.productName,category_id:e.categoryId,category_name:e.categoryName,brand_id:e.brandId,brand_name:e.brandName,unit:e.unit,product_type:e.productType,stock:{quantity_on_hand:e.currentStock},price:{cost:e.costPrice,selling:e.unitPrice}}}static fromJsonArray(e,r=""){return e.map(s=>vm.fromJson(s,r))}static toUpdateParams(e,r,s,n){return{p_product_id:e,p_company_id:r,p_store_id:s,p_sku:n.sku,p_product_name:n.productName,p_category_id:n.category||null,p_brand_id:n.brand||null,p_unit:n.unit||"piece",p_product_type:n.productType||"commodity",p_cost_price:n.costPrice,p_selling_price:n.sellingPrice,p_new_quantity:n.currentStock}}}class gx{constructor(){W(this,"dataSource");this.dataSource=new dF}async getInventory(e,r,s=1,n=20,o){var i;try{const l=await this.dataSource.getInventory(e,r,s,n,o),c=l.products,d=((i=l.currency)==null?void 0:i.symbol)||"";return{success:!0,data:vm.fromJsonArray(c,d),currency:l.currency,pagination:l.pagination}}catch(l){return{success:!1,error:l instanceof Error?l.message:"Failed to fetch inventory"}}}async updateProduct(e,r,s,n){try{return await this.dataSource.updateProduct(e,r,s,n)}catch(o){return{success:!1,error:o instanceof Error?o.message:"Failed to update product"}}}async getMetadata(e,r){try{const s=await this.dataSource.getMetadata(e,r);return s&&s.success&&s.data?{success:!0,data:{...s.data,last_updated:s.data.last_updated?te.toLocal(s.data.last_updated).toISOString():s.data.last_updated}}:{success:!1,error:"Invalid metadata response format"}}catch(s){return{success:!1,error:s instanceof Error?s.message:"Failed to fetch metadata"}}}async importExcel(e,r,s,n){try{return await this.dataSource.importExcel(e,r,s,n)}catch(o){return{success:!1,error:o instanceof Error?o.message:"Failed to import Excel data"}}}}class hF{static validateProduct(e){const r=[];return!e.productName||e.productName.trim()===""?r.push({field:"productName",message:"Product name is required"}):e.productName.length>255&&r.push({field:"productName",message:"Product name must be less than 255 characters"}),e.sku&&e.sku.length>100&&r.push({field:"sku",message:"SKU must be less than 100 characters"}),e.costPrice!==void 0&&e.costPrice<0&&r.push({field:"costPrice",message:"Cost price cannot be negative"}),e.sellingPrice!==void 0&&e.sellingPrice<0&&r.push({field:"sellingPrice",message:"Selling price cannot be negative"}),e.costPrice!==void 0&&e.sellingPrice!==void 0&&e.sellingPrice<e.costPrice&&r.push({field:"sellingPrice",message:"Selling price should be higher than or equal to cost price"}),e.currentStock!==void 0&&e.currentStock<0&&r.push({field:"currentStock",message:"Current stock cannot be negative"}),e.minStock!==void 0&&e.minStock<0&&r.push({field:"minStock",message:"Minimum stock cannot be negative"}),e.maxStock!==void 0&&e.maxStock<0&&r.push({field:"maxStock",message:"Maximum stock cannot be negative"}),e.minStock!==void 0&&e.maxStock!==void 0&&e.maxStock<e.minStock&&r.push({field:"maxStock",message:"Maximum stock should be greater than or equal to minimum stock"}),e.reorderPoint!==void 0&&e.reorderPoint<0&&r.push({field:"reorderPoint",message:"Reorder point cannot be negative"}),r}static validateSearchQuery(e){const r=[];return e.length>255&&r.push({field:"search",message:"Search query must be less than 255 characters"}),r}static isValid(e){return this.validateProduct(e).length===0}}const Eu=new gx,Re=Jt((t,e)=>({inventory:[],currency:{symbol:"",code:"VND"},currentPage:1,itemsPerPage:20,totalItems:0,selectedStoreId:null,searchQuery:"",selectedProducts:new Set,filterType:"newest",selectedBrandFilter:null,isModalOpen:!1,selectedProductData:null,isAddProductModalOpen:!1,loading:!0,error:null,notification:{isOpen:!1,variant:"success",message:""},setSelectedStoreId:r=>t({selectedStoreId:r,currentPage:1}),setSearchQuery:r=>t({searchQuery:r,currentPage:1}),setCurrentPage:r=>t({currentPage:r}),toggleProductSelection:r=>t(s=>{const n=new Set(s.selectedProducts);return n.has(r)?n.delete(r):n.add(r),{selectedProducts:n}}),selectAllProducts:()=>t(r=>({selectedProducts:new Set(r.inventory.map(s=>s.productId))})),clearSelection:()=>t({selectedProducts:new Set}),setFilterType:r=>t({filterType:r,currentPage:1}),setSelectedBrandFilter:r=>t({selectedBrandFilter:r,currentPage:1}),clearFilter:()=>t({filterType:"newest",selectedBrandFilter:null,currentPage:1}),openModal:r=>t({isModalOpen:!0,selectedProductData:r}),closeModal:()=>t({isModalOpen:!1,selectedProductData:null}),openAddProductModal:()=>t({isAddProductModalOpen:!0}),closeAddProductModal:()=>t({isAddProductModalOpen:!1}),showNotification:(r,s)=>t({notification:{isOpen:!0,variant:r,message:s}}),hideNotification:()=>t(r=>({notification:{...r.notification,isOpen:!1}})),setLoading:r=>t({loading:r}),setError:r=>t({error:r}),clearError:()=>t({error:null}),loadInventory:async(r,s,n)=>{var o,i,l,c;t({loading:!0,error:null});try{const d=await Eu.getInventory(r,s,1,1e4,n||void 0);if(!d.success){t({error:d.error||"Failed to load inventory",inventory:[],loading:!1});return}((o=d.currency)!=null&&o.symbol||(i=d.currency)!=null&&i.code)&&t({currency:{symbol:((l=d.currency)==null?void 0:l.symbol)||e().currency.symbol,code:((c=d.currency)==null?void 0:c.code)||e().currency.code}});const u=(d.data||[]).sort((f,p)=>!f.createdAt&&!p.createdAt?0:f.createdAt?p.createdAt?p.createdAt.getTime()-f.createdAt.getTime():-1:1),h=u.length;console.log(" Loaded all products:",h),t({inventory:u,totalItems:h,loading:!1})}catch(d){t({error:d instanceof Error?d.message:"An unexpected error occurred",inventory:[],loading:!1})}},updateProduct:async(r,s,n,o)=>{const i=e();if(!s||!n)return{success:!1,error:"Company ID and Store ID are required"};const l=hF.validateProduct({productName:o.productName,sku:o.sku,costPrice:o.costPrice,sellingPrice:o.sellingPrice,currentStock:o.currentStock});if(l.length>0)return{success:!1,error:l[0].message};try{const c=await Eu.updateProduct(r,s,n,o);return c.success&&await e().loadInventory(s,n,i.searchQuery),c}catch(c){return{success:!1,error:c instanceof Error?c.message:"An unexpected error occurred"}}},importExcel:async(r,s,n,o)=>{try{return await Eu.importExcel(r,s,n,o)}catch(i){return{success:!1,error:i instanceof Error?i.message:"An unexpected error occurred"}}},refresh:async()=>{const r=e();await e().loadInventory("",r.selectedStoreId,r.searchQuery)}})),fF=()=>{const t=Re(A=>A.inventory),e=Re(A=>A.currency),r=Re(A=>A.currentPage),s=Re(A=>A.itemsPerPage),n=Re(A=>A.totalItems),o=Re(A=>A.selectedStoreId),i=Re(A=>A.searchQuery),l=Re(A=>A.selectedProducts),c=Re(A=>A.filterType),d=Re(A=>A.selectedBrandFilter),u=Re(A=>A.isModalOpen),h=Re(A=>A.selectedProductData),f=Re(A=>A.isAddProductModalOpen),p=Re(A=>A.loading),g=Re(A=>A.error),y=Re(A=>A.notification),x=Re(A=>A.setSelectedStoreId),m=Re(A=>A.setSearchQuery),_=Re(A=>A.setCurrentPage),v=Re(A=>A.toggleProductSelection),w=Re(A=>A.selectAllProducts),S=Re(A=>A.clearSelection),E=Re(A=>A.setFilterType),C=Re(A=>A.setSelectedBrandFilter),k=Re(A=>A.clearFilter),N=Re(A=>A.openModal),I=Re(A=>A.closeModal),L=Re(A=>A.openAddProductModal),T=Re(A=>A.closeAddProductModal),j=Re(A=>A.showNotification),M=Re(A=>A.hideNotification),R=Re(A=>A.setLoading),O=Re(A=>A.setError),z=Re(A=>A.clearError),D=Re(A=>A.loadInventory),P=Re(A=>A.updateProduct),$=Re(A=>A.importExcel),U=Re(A=>A.refresh);return{inventory:t,currencySymbol:e.symbol,currencyCode:e.code,currentPage:r,itemsPerPage:s,totalItems:n,selectedStoreId:o,searchQuery:i,selectedProducts:l,filterType:c,selectedBrandFilter:d,isModalOpen:u,selectedProductData:h,isAddProductModalOpen:f,loading:p,error:g,notification:y,setSelectedStoreId:x,setSearchQuery:m,setCurrentPage:_,toggleProductSelection:v,selectAllProducts:w,clearSelection:S,setFilterType:E,setSelectedBrandFilter:C,clearFilter:k,openModal:N,closeModal:I,openAddProductModal:L,closeAddProductModal:T,showNotification:j,hideNotification:M,setLoading:R,setError:O,clearError:z,loadInventory:D,updateProduct:P,importExcel:$,refresh:U}},mF=(t,e)=>{const[r,s]=b.useState(null),[n,o]=b.useState(!0),[i,l]=b.useState(null),c=new gx,d=async()=>{try{o(!0),l(null);const u=await c.getMetadata(t,e);u.success&&u.data?s(u.data):l(u.error||"Failed to load metadata")}catch(u){l(u instanceof Error?u.message:"Unknown error")}finally{o(!1)}};return b.useEffect(()=>{t&&d()},[t,e]),{metadata:r,loading:n,error:i,refresh:d}},pF="_modalOverlay_13av9_6",gF="_show_13av9_22",_F="_modalContainer_13av9_27",yF="_modalHeader_13av9_45",vF="_modalTitleSection_13av9_54",xF="_modalTitle_13av9_54",bF="_modalSubtitle_13av9_66",wF="_closeButton_13av9_73",SF="_modalBody_13av9_95",CF="_formGroup_13av9_101",jF="_label_13av9_109",kF="_required_13av9_118",NF="_input_13av9_124",IF="_error_13av9_150",EF="_helperText_13av9_158",TF="_errorMessage_13av9_166",AF="_modalFooter_13av9_175",Vt={modalOverlay:pF,show:gF,modalContainer:_F,modalHeader:yF,modalTitleSection:vF,modalTitle:xF,modalSubtitle:bF,closeButton:wF,modalBody:SF,formGroup:CF,label:jF,required:kF,input:NF,error:IF,helperText:EF,errorMessage:TF,modalFooter:AF},_x=({isOpen:t,onClose:e,companyId:r,onBrandAdded:s})=>{const[n,o]=b.useState({brandName:"",brandCode:""}),[i,l]=b.useState({}),[c,d]=b.useState(!1),[u,h]=b.useState({isOpen:!1,variant:"success",message:""});b.useEffect(()=>{t&&(o({brandName:"",brandCode:""}),l({}),d(!1),h({isOpen:!1,variant:"success",message:""}))},[t]);const f=(x,m)=>{o(_=>({..._,[x]:m})),i[x]&&l(_=>({..._,[x]:""}))},p=()=>{const x={};return n.brandName.trim()||(x.brandName="Brand name is required"),l(x),Object.keys(x).length===0},g=async()=>{if(p()){d(!0);try{const{data:x,error:m}=await ne.getClient().rpc("inventory_create_brand",{p_company_id:r,p_brand_name:n.brandName.trim(),p_brand_code:n.brandCode.trim()||null});if(m){console.error("Error creating brand:",m),m.message&&m.message.includes("DUPLICATE_BRAND")?h({isOpen:!0,variant:"error",message:"A brand with this name already exists"}):h({isOpen:!0,variant:"error",message:m.message||"Failed to create brand. Please try again."}),d(!1);return}h({isOpen:!0,variant:"success",message:`Brand "${n.brandName}" has been created successfully!`}),setTimeout(()=>{s&&x&&s(x),e()},1500)}catch(x){console.error("Error creating brand:",x),h({isOpen:!0,variant:"error",message:x instanceof Error?x.message:"An error occurred. Please try again."}),d(!1)}}},y=x=>{x.target===x.currentTarget&&e()};return t?a.jsxs("div",{className:`${Vt.modalOverlay} ${t?Vt.show:""}`,onClick:y,children:[a.jsxs("div",{className:Vt.modalContainer,children:[a.jsxs("div",{className:Vt.modalHeader,children:[a.jsxs("div",{className:Vt.modalTitleSection,children:[a.jsx("h2",{className:Vt.modalTitle,children:"Add New Brand"}),a.jsx("p",{className:Vt.modalSubtitle,children:"Create a new brand for your inventory"})]}),a.jsx("button",{className:Vt.closeButton,onClick:e,children:a.jsx("svg",{width:"20",height:"20",fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})})})]}),a.jsxs("div",{className:Vt.modalBody,children:[a.jsxs("div",{className:Vt.formGroup,children:[a.jsx("label",{className:`${Vt.label} ${Vt.required}`,children:"Brand Name"}),a.jsx("input",{type:"text",className:`${Vt.input} ${i.brandName?Vt.error:""}`,placeholder:"Enter brand name",value:n.brandName,onChange:x=>f("brandName",x.target.value),maxLength:100,autoFocus:!0}),i.brandName&&a.jsx("span",{className:Vt.errorMessage,children:i.brandName})]}),a.jsxs("div",{className:Vt.formGroup,children:[a.jsx("label",{className:Vt.label,children:"Brand Code"}),a.jsx("input",{type:"text",className:Vt.input,placeholder:"Optional - auto-generated if empty",value:n.brandCode,onChange:x=>f("brandCode",x.target.value),maxLength:50}),a.jsx("span",{className:Vt.helperText,children:"Leave empty to auto-generate from brand name"})]})]}),a.jsxs("div",{className:Vt.modalFooter,children:[a.jsx(be,{variant:"secondary",size:"md",onClick:e,disabled:c,children:"Cancel"}),a.jsx(be,{variant:"primary",size:"md",onClick:g,disabled:c,children:c?"Adding...":"Add Brand"})]})]}),a.jsx(De,{variant:u.variant,message:u.message,isOpen:u.isOpen,onClose:()=>h({...u,isOpen:!1}),autoCloseDuration:u.variant==="success"?1500:0,zIndex:1e4})]}):null},LF="_modalOverlay_ys0db_6",DF="_show_ys0db_22",MF="_modalContainer_ys0db_27",RF="_modalHeader_ys0db_45",OF="_modalTitleSection_ys0db_54",PF="_modalTitle_ys0db_54",$F="_modalSubtitle_ys0db_66",FF="_closeButton_ys0db_73",BF="_modalBody_ys0db_95",HF="_formGroup_ys0db_101",VF="_label_ys0db_109",zF="_required_ys0db_118",UF="_input_ys0db_124",WF="_error_ys0db_150",qF="_helperText_ys0db_158",GF="_errorMessage_ys0db_166",JF="_modalFooter_ys0db_175",or={modalOverlay:LF,show:DF,modalContainer:MF,modalHeader:RF,modalTitleSection:OF,modalTitle:PF,modalSubtitle:$F,closeButton:FF,modalBody:BF,formGroup:HF,label:VF,required:zF,input:UF,error:WF,helperText:qF,errorMessage:GF,modalFooter:JF},yx=({isOpen:t,onClose:e,companyId:r,categories:s,onCategoryAdded:n})=>{const[o,i]=b.useState({categoryName:"",parentCategoryId:""}),[l,c]=b.useState({}),[d,u]=b.useState(!1),[h,f]=b.useState({isOpen:!1,variant:"success",message:""});b.useEffect(()=>{t&&(i({categoryName:"",parentCategoryId:""}),c({}),u(!1),f({isOpen:!1,variant:"success",message:""}))},[t]);const p=(m,_)=>{i(v=>({...v,[m]:_})),l[m]&&c(v=>({...v,[m]:""}))},g=()=>{const m={};return o.categoryName.trim()||(m.categoryName="Category name is required"),c(m),Object.keys(m).length===0},y=async()=>{if(g()){u(!0);try{const{data:m,error:_}=await ne.getClient().rpc("inventory_create_category",{p_company_id:r,p_category_name:o.categoryName.trim(),p_parent_category_id:o.parentCategoryId||null});if(_){console.error("Error creating category:",_),_.message&&_.message.includes("DUPLICATE_CATEGORY")?f({isOpen:!0,variant:"error",message:"A category with this name already exists at this level"}):f({isOpen:!0,variant:"error",message:_.message||"Failed to create category. Please try again."}),u(!1);return}f({isOpen:!0,variant:"success",message:`Category "${o.categoryName}" has been created successfully!`}),setTimeout(()=>{n&&m&&n(m),e()},1500)}catch(m){console.error("Error creating category:",m),f({isOpen:!0,variant:"error",message:m instanceof Error?m.message:"An error occurred. Please try again."}),u(!1)}}},x=m=>{m.target===m.currentTarget&&e()};return t?a.jsxs("div",{className:`${or.modalOverlay} ${t?or.show:""}`,onClick:x,children:[a.jsxs("div",{className:or.modalContainer,children:[a.jsxs("div",{className:or.modalHeader,children:[a.jsxs("div",{className:or.modalTitleSection,children:[a.jsx("h2",{className:or.modalTitle,children:"Add New Category"}),a.jsx("p",{className:or.modalSubtitle,children:"Create a new category for your inventory"})]}),a.jsx("button",{className:or.closeButton,onClick:e,children:a.jsx("svg",{width:"20",height:"20",fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})})})]}),a.jsxs("div",{className:or.modalBody,children:[a.jsxs("div",{className:or.formGroup,children:[a.jsx("label",{className:`${or.label} ${or.required}`,children:"Category Name"}),a.jsx("input",{type:"text",className:`${or.input} ${l.categoryName?or.error:""}`,placeholder:"Enter category name",value:o.categoryName,onChange:m=>p("categoryName",m.target.value),maxLength:100,autoFocus:!0}),l.categoryName&&a.jsx("span",{className:or.errorMessage,children:l.categoryName})]}),a.jsxs("div",{className:or.formGroup,children:[a.jsx(We,{label:"Parent Category",placeholder:"Select parent category",value:o.parentCategoryId,options:s.map(m=>({value:m.category_id,label:m.category_name,description:m.description})),onChange:m=>p("parentCategoryId",m),fullWidth:!0}),a.jsx("span",{className:or.helperText,children:"Leave empty for top-level category"})]})]}),a.jsxs("div",{className:or.modalFooter,children:[a.jsx(be,{variant:"secondary",size:"md",onClick:e,disabled:d,children:"Cancel"}),a.jsx(be,{variant:"primary",size:"md",onClick:y,disabled:d,children:d?"Adding...":"Add Category"})]})]}),a.jsx(De,{variant:h.variant,message:h.message,isOpen:h.isOpen,onClose:()=>f({...h,isOpen:!1}),autoCloseDuration:h.variant==="success"?1500:0,zIndex:1e4})]}):null},KF="_modalOverlay_1jiwj_5",YF="_modalContainer_1jiwj_19",QF="_modalHeader_1jiwj_32",ZF="_modalTitleSection_1jiwj_40",XF="_modalTitle_1jiwj_40",e7="_modalSubtitle_1jiwj_51",t7="_closeButton_1jiwj_57",r7="_modalBody_1jiwj_79",s7="_section_1jiwj_85",n7="_sectionTitle_1jiwj_93",o7="_formGrid_1jiwj_102",a7="_formGroup_1jiwj_108",i7="_formGroupFull_1jiwj_113",l7="_label_1jiwj_117",c7="_input_1jiwj_126",d7="_modalFooter_1jiwj_187",Ie={modalOverlay:KF,modalContainer:YF,modalHeader:QF,modalTitleSection:ZF,modalTitle:XF,modalSubtitle:e7,closeButton:t7,modalBody:r7,section:s7,sectionTitle:n7,formGrid:o7,formGroup:a7,formGroupFull:i7,label:l7,input:c7,modalFooter:d7},u7=({isOpen:t,onClose:e,productId:r,companyId:s,productData:n,metadata:o,onSave:i,onMetadataRefresh:l})=>{const[c,d]=b.useState({productName:"",category:"",brand:"",productType:"Physical Product",barcode:"",sku:"",currentStock:"",unit:"",costPrice:"",sellingPrice:""}),[u,h]=b.useState(!1),[f,p]=b.useState(!1);b.useEffect(()=>{var m,_,v;n&&d({productName:n.productName||"",category:n.categoryId||"",brand:n.brandId||"",productType:n.productType||"commodity",barcode:n.barcode||"",sku:n.sku||n.productCode||"",currentStock:((m=n.currentStock)==null?void 0:m.toString())||"",unit:n.unit||"",costPrice:((_=n.costPrice)==null?void 0:_.toString())||"",sellingPrice:((v=n.unitPrice)==null?void 0:v.toString())||""})},[n]);const g=(m,_)=>{d(v=>({...v,[m]:_}))},y=()=>{if(i){const m={...c,currentStock:typeof c.currentStock=="string"?parseInt(c.currentStock)||0:c.currentStock,costPrice:typeof c.costPrice=="string"?parseFloat(c.costPrice)||0:c.costPrice,sellingPrice:typeof c.sellingPrice=="string"?parseFloat(c.sellingPrice)||0:c.sellingPrice};i(m)}e()},x=m=>{m.target===m.currentTarget&&e()};return t?a.jsxs("div",{className:Ie.modalOverlay,onClick:x,children:[a.jsxs("div",{className:Ie.modalContainer,children:[a.jsxs("div",{className:Ie.modalHeader,children:[a.jsxs("div",{className:Ie.modalTitleSection,children:[a.jsx("h2",{className:Ie.modalTitle,children:"Product Details"}),a.jsx("p",{className:Ie.modalSubtitle,children:"View and edit product information"})]}),a.jsx("button",{className:Ie.closeButton,onClick:e,children:a.jsx("svg",{width:"20",height:"20",fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})})})]}),a.jsxs("div",{className:Ie.modalBody,children:[a.jsxs("div",{className:Ie.section,children:[a.jsx("h3",{className:Ie.sectionTitle,children:"Product Information"}),a.jsxs("div",{className:Ie.formGrid,children:[a.jsxs("div",{className:`${Ie.formGroup} ${Ie.formGroupFull}`,children:[a.jsx("label",{className:Ie.label,children:"Product Name"}),a.jsx("input",{type:"text",className:Ie.input,value:c.productName,onChange:m=>g("productName",m.target.value),placeholder:"Enter product name"})]}),a.jsx("div",{className:Ie.formGroup,children:a.jsx(We,{label:"Category",placeholder:"Select category",value:c.category,options:(o==null?void 0:o.categories.map(m=>({value:m.category_id,label:m.category_name,description:m.description})))||[],onChange:m=>g("category",m),showAddButton:!0,addButtonText:"Add category",onAddClick:()=>p(!0),showDescriptions:!0,fullWidth:!0})}),a.jsx("div",{className:Ie.formGroup,children:a.jsx(We,{label:"Brand",placeholder:"Select brand",value:c.brand,options:(o==null?void 0:o.brands.map(m=>({value:m.brand_id,label:m.brand_name,description:m.description})))||[],onChange:m=>g("brand",m),showAddButton:!0,addButtonText:"Add brand",onAddClick:()=>h(!0),showDescriptions:!0,fullWidth:!0})}),a.jsx("div",{className:Ie.formGroup,children:a.jsx(We,{label:"Product Type",placeholder:"Select product type",value:c.productType,options:(o==null?void 0:o.product_types.map(m=>{let _=m.label;return m.value==="commodity"&&(_="Commodity"),m.value==="bundle"&&(_="Bundle/Set"),m.value==="service"&&(_="Service"),{value:m.value,label:_,description:m.description}}))||[],onChange:m=>g("productType",m),showDescriptions:!0,fullWidth:!0})}),a.jsxs("div",{className:Ie.formGroup,children:[a.jsx("label",{className:Ie.label,children:"Barcode"}),a.jsx("input",{type:"text",className:Ie.input,value:c.barcode,onChange:m=>g("barcode",m.target.value),placeholder:"Enter barcode"})]}),a.jsxs("div",{className:Ie.formGroup,children:[a.jsx("label",{className:Ie.label,children:"SKU"}),a.jsx("input",{type:"text",className:Ie.input,value:c.sku,onChange:m=>g("sku",m.target.value),placeholder:"Enter SKU"})]})]})]}),a.jsxs("div",{className:Ie.section,children:[a.jsx("h3",{className:Ie.sectionTitle,children:"Stock Information"}),a.jsxs("div",{className:Ie.formGrid,children:[a.jsxs("div",{className:Ie.formGroup,children:[a.jsx("label",{className:Ie.label,children:"Current Quantity"}),a.jsx("input",{type:"number",className:Ie.input,value:c.currentStock,onChange:m=>g("currentStock",m.target.value),placeholder:"0"})]}),a.jsx("div",{className:Ie.formGroup,children:a.jsx(We,{label:"Unit",placeholder:"Select unit",value:c.unit,options:(o==null?void 0:o.units.map(m=>({value:m.value,label:`${m.value} (${m.symbol})`,description:`${m.value} - ${m.symbol}`})))||[],onChange:m=>g("unit",m),fullWidth:!0})})]})]}),a.jsxs("div",{className:Ie.section,children:[a.jsx("h3",{className:Ie.sectionTitle,children:"Price Information"}),a.jsxs("div",{className:Ie.formGrid,children:[a.jsxs("div",{className:Ie.formGroup,children:[a.jsx("label",{className:Ie.label,children:"Cost Price"}),a.jsx("input",{type:"number",className:Ie.input,value:c.costPrice,onChange:m=>g("costPrice",m.target.value),placeholder:"0"})]}),a.jsxs("div",{className:Ie.formGroup,children:[a.jsx("label",{className:Ie.label,children:"Selling Price"}),a.jsx("input",{type:"number",className:Ie.input,value:c.sellingPrice,onChange:m=>g("sellingPrice",m.target.value),placeholder:"0"})]})]})]})]}),a.jsxs("div",{className:Ie.modalFooter,children:[a.jsx(be,{variant:"secondary",size:"md",onClick:e,children:"Cancel"}),a.jsx(be,{variant:"primary",size:"md",onClick:y,children:"Save Changes"})]})]}),a.jsx(_x,{isOpen:u,onClose:()=>h(!1),companyId:s,onBrandAdded:m=>{g("brand",m.brand_id),l&&l()}}),a.jsx(yx,{isOpen:f,onClose:()=>p(!1),companyId:s,categories:(o==null?void 0:o.categories)||[],onCategoryAdded:m=>{g("category",m.category_id),l&&l()}})]}):null},h7="_modalOverlay_9bb8x_6",f7="_show_9bb8x_22",m7="_modalContainer_9bb8x_27",p7="_modalLg_9bb8x_40",g7="_modalHeader_9bb8x_49",_7="_modalTitleSection_9bb8x_58",y7="_modalTitle_9bb8x_58",v7="_modalSubtitle_9bb8x_70",x7="_closeButton_9bb8x_77",b7="_modalBody_9bb8x_99",w7="_formGrid_9bb8x_105",S7="_formGroup_9bb8x_111",C7="_formGroupFull_9bb8x_116",j7="_label_9bb8x_120",k7="_required_9bb8x_129",N7="_input_9bb8x_135",I7="_error_9bb8x_161",E7="_inputWrapper_9bb8x_170",T7="_inputPrefix_9bb8x_176",A7="_withPrefix_9bb8x_185",L7="_helperText_9bb8x_189",D7="_errorMessage_9bb8x_197",M7="_modalFooter_9bb8x_206",Ce={modalOverlay:h7,show:f7,modalContainer:m7,modalLg:p7,modalHeader:g7,modalTitleSection:_7,modalTitle:y7,modalSubtitle:v7,closeButton:x7,modalBody:b7,formGrid:w7,formGroup:S7,formGroupFull:C7,label:j7,required:k7,input:N7,error:I7,inputWrapper:E7,inputPrefix:T7,withPrefix:A7,helperText:L7,errorMessage:D7,modalFooter:M7},R7=({isOpen:t,onClose:e,companyId:r,storeId:s,metadata:n,onProductAdded:o,onMetadataRefresh:i})=>{var N;const[l,c]=b.useState({productName:"",sku:"",barcode:"",categoryId:"",brandId:"",unit:"",costPrice:"",sellingPrice:"",initialQuantity:"0",imageUrl:"",thumbnailUrl:""}),[d,u]=b.useState({}),[h,f]=b.useState(!1),[p,g]=b.useState({isOpen:!1,variant:"success",message:""}),[y,x]=b.useState(!1),[m,_]=b.useState(!1);b.useEffect(()=>{var I,L,T;t&&(console.log(" AddProductModal opened"),console.log("  - Categories:",((I=n==null?void 0:n.categories)==null?void 0:I.length)||0),console.log("  - Brands:",((L=n==null?void 0:n.brands)==null?void 0:L.length)||0),console.log("  - Units:",((T=n==null?void 0:n.units)==null?void 0:T.length)||0),console.log("  - Units data:",JSON.stringify(n==null?void 0:n.units,null,2)),c({productName:"",sku:"",barcode:"",categoryId:"",brandId:"",unit:"",costPrice:"",sellingPrice:"",initialQuantity:"0",imageUrl:"",thumbnailUrl:""}),u({}),f(!1),g({isOpen:!1,variant:"success",message:""}))},[t,n]);const v=(I,L)=>{c(T=>({...T,[I]:L})),d[I]&&u(T=>({...T,[I]:""}))},w=()=>{const I={};return l.productName.trim()||(I.productName="Product name is required"),u(I),Object.keys(I).length===0},S=l.productName.trim().length>0,E=async()=>{var I,L,T,j,M,R;if(w()){f(!0);try{const O={p_company_id:r,p_product_name:l.productName.trim(),p_store_id:s||null,p_sku:l.sku.trim()||null,p_barcode:l.barcode.trim()||null,p_category_id:l.categoryId||null,p_brand_id:l.brandId||null,p_unit:l.unit||null,p_cost_price:l.costPrice&&parseFloat(l.costPrice)>0?parseFloat(l.costPrice):null,p_selling_price:l.sellingPrice&&parseFloat(l.sellingPrice)>0?parseFloat(l.sellingPrice):null,p_initial_quantity:l.initialQuantity&&parseFloat(l.initialQuantity)>0?parseFloat(l.initialQuantity):null,p_image_url:l.imageUrl.trim()||null,p_thumbnail_url:l.thumbnailUrl.trim()||null};console.log("Creating product with parameters:",O),console.log("  - p_sku type:",typeof O.p_sku,"| value:",O.p_sku,"| is null:",O.p_sku===null),console.log("  - p_barcode type:",typeof O.p_barcode,"| value:",O.p_barcode,"| is null:",O.p_barcode===null),console.log("  - categoryId type:",typeof O.p_category_id,"| value:",O.p_category_id),console.log("  - brandId type:",typeof O.p_brand_id,"| value:",O.p_brand_id);const{data:z,error:D}=await ne.getClient().rpc("inventory_create_product",O).single();if(console.log(" RPC Response:",{data:z,error:D}),console.log(" Full data:",JSON.stringify(z,null,2)),D){console.error(" Error creating product:",D),console.error("   Error details:",JSON.stringify(D,null,2));let A="Failed to create product";D.code==="DUPLICATE_SKU"||(I=D.message)!=null&&I.includes("DUPLICATE_SKU")?A="This SKU already exists. Please use a different SKU.":D.code==="DUPLICATE_BARCODE"||(L=D.message)!=null&&L.includes("DUPLICATE_BARCODE")?A="This barcode already exists. Please use a different barcode.":D.code==="FOREIGN_KEY_ERROR"||(T=D.message)!=null&&T.includes("FOREIGN_KEY")?A="Invalid category or brand selected.":D.message&&(A=D.message),g({isOpen:!0,variant:"error",message:A}),f(!1);return}if(!z){console.error(" RPC returned no data"),g({isOpen:!0,variant:"error",message:"Failed to create product: No data returned from server"}),f(!1);return}if(z.success===!1){console.error(" RPC returned success: false",z);let A="Failed to create product";z.code==="DUPLICATE_SKU"||(j=z.details)!=null&&j.includes("inventory_products_company_id_sku_key")?A="This SKU already exists. Please use a different SKU or leave it empty to auto-generate.":z.code==="DUPLICATE_BARCODE"||(M=z.details)!=null&&M.includes("barcode")?A="This barcode already exists. Please use a different barcode.":z.code==="FOREIGN_KEY_ERROR"||(R=z.details)!=null&&R.includes("foreign key")?A="Invalid category or brand selected.":(A=z.error||z.message||"Failed to create product",z.details&&(A+=` (${z.details})`)),g({isOpen:!0,variant:"error",message:A}),f(!1);return}const P=(z==null?void 0:z.data)||z;console.log(" Product created successfully:",P),console.log(" Product data type:",typeof P),console.log(" Product data keys:",P?Object.keys(P):"null");let $=`Product "${l.productName}" has been created successfully!`;const U=[];!l.sku.trim()&&(P!=null&&P.sku)&&U.push(`SKU: ${P.sku}`),!l.barcode.trim()&&(P!=null&&P.barcode)&&U.push(`Barcode: ${P.barcode}`),U.length>0&&($+=` (Auto-generated: ${U.join(", ")})`),g({isOpen:!0,variant:"success",message:$}),setTimeout(()=>{o&&P&&o(P),e()},1500)}catch(O){console.error("Error creating product:",O),g({isOpen:!0,variant:"error",message:O instanceof Error?O.message:"An error occurred. Please try again."}),f(!1)}}},C=I=>{I.target===I.currentTarget&&e()};if(!t)return null;const k=((N=n==null?void 0:n.currency)==null?void 0:N.symbol)||"$";return a.jsxs("div",{className:`${Ce.modalOverlay} ${t?Ce.show:""}`,onClick:C,children:[a.jsxs("div",{className:`${Ce.modalContainer} ${Ce.modalLg}`,children:[a.jsxs("div",{className:Ce.modalHeader,children:[a.jsxs("div",{className:Ce.modalTitleSection,children:[a.jsx("h2",{className:Ce.modalTitle,children:"Add New Product"}),a.jsx("p",{className:Ce.modalSubtitle,children:"Enter product details to add to your inventory"})]}),a.jsx("button",{className:Ce.closeButton,onClick:e,children:a.jsx("svg",{width:"20",height:"20",fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})})})]}),a.jsx("div",{className:Ce.modalBody,children:a.jsxs("div",{className:Ce.formGrid,children:[a.jsxs("div",{className:`${Ce.formGroup} ${Ce.formGroupFull}`,children:[a.jsx("label",{className:`${Ce.label} ${Ce.required}`,children:"Product Name"}),a.jsx("input",{type:"text",className:`${Ce.input} ${d.productName?Ce.error:""}`,placeholder:"Enter product name",value:l.productName,onChange:I=>v("productName",I.target.value),maxLength:200,autoFocus:!0}),d.productName&&a.jsx("span",{className:Ce.errorMessage,children:d.productName})]}),a.jsxs("div",{className:Ce.formGroup,children:[a.jsx("label",{className:Ce.label,children:"SKU"}),a.jsx("input",{type:"text",className:Ce.input,placeholder:"Leave empty to auto-generate",value:l.sku,onChange:I=>v("sku",I.target.value),maxLength:50}),a.jsx("span",{className:Ce.helperText,children:"Will be auto-generated if left empty"})]}),a.jsxs("div",{className:Ce.formGroup,children:[a.jsx("label",{className:Ce.label,children:"Barcode"}),a.jsx("input",{type:"text",className:Ce.input,placeholder:"Leave empty to auto-generate",value:l.barcode,onChange:I=>v("barcode",I.target.value),maxLength:50}),a.jsx("span",{className:Ce.helperText,children:"Will be auto-generated if left empty"})]}),a.jsx("div",{className:Ce.formGroup,children:a.jsx(We,{label:"Category",placeholder:"Select category",value:l.categoryId,options:(n==null?void 0:n.categories.map(I=>({value:I.category_id,label:I.category_name,description:I.description})))||[],onChange:I=>v("categoryId",I),showAddButton:!0,addButtonText:"Add category",onAddClick:()=>_(!0),showDescriptions:!0,fullWidth:!0})}),a.jsx("div",{className:Ce.formGroup,children:a.jsx(We,{label:"Brand",placeholder:"Select brand",value:l.brandId,options:(n==null?void 0:n.brands.map(I=>({value:I.brand_id,label:I.brand_name,description:I.description})))||[],onChange:I=>v("brandId",I),showAddButton:!0,addButtonText:"Add brand",onAddClick:()=>x(!0),showDescriptions:!0,fullWidth:!0})}),a.jsxs("div",{className:Ce.formGroup,children:[a.jsx("label",{className:Ce.label,children:"Cost Price"}),a.jsxs("div",{className:Ce.inputWrapper,children:[a.jsx("span",{className:Ce.inputPrefix,children:k}),a.jsx("input",{type:"number",className:`${Ce.input} ${Ce.withPrefix}`,placeholder:"0",value:l.costPrice,onChange:I=>v("costPrice",I.target.value),min:"0",step:"0.01",max:"999999999"})]})]}),a.jsxs("div",{className:Ce.formGroup,children:[a.jsx("label",{className:Ce.label,children:"Selling Price"}),a.jsxs("div",{className:Ce.inputWrapper,children:[a.jsx("span",{className:Ce.inputPrefix,children:k}),a.jsx("input",{type:"number",className:`${Ce.input} ${Ce.withPrefix}`,placeholder:"0",value:l.sellingPrice,onChange:I=>v("sellingPrice",I.target.value),min:"0",step:"0.01",max:"999999999"})]})]}),a.jsx("div",{className:Ce.formGroup,children:a.jsx(We,{label:"Unit",placeholder:"Select unit",value:l.unit,options:[{value:"piece",label:"Piece"},{value:"kg",label:"Kilogram (kg)"},{value:"g",label:"Gram (g)"},{value:"l",label:"Liter (l)"},{value:"ml",label:"Milliliter (ml)"},{value:"box",label:"Box"}],onChange:I=>v("unit",I),fullWidth:!0})}),a.jsxs("div",{className:Ce.formGroup,children:[a.jsx("label",{className:Ce.label,children:"Initial Quantity"}),a.jsx("input",{type:"number",className:Ce.input,placeholder:"0",value:l.initialQuantity,onChange:I=>v("initialQuantity",I.target.value),min:"0",max:"999999999"})]})]})}),a.jsxs("div",{className:Ce.modalFooter,children:[a.jsx(be,{variant:"secondary",size:"md",onClick:e,disabled:h,children:"Cancel"}),a.jsx(be,{variant:"primary",size:"md",onClick:E,disabled:h||!S,children:h?"Creating...":"Create Product"})]})]}),a.jsx(_x,{isOpen:y,onClose:()=>x(!1),companyId:r,onBrandAdded:I=>{v("brandId",I.brand_id),i&&i()}}),a.jsx(yx,{isOpen:m,onClose:()=>_(!1),companyId:r,categories:(n==null?void 0:n.categories)||[],onCategoryAdded:I=>{v("categoryId",I.category_id),i&&i()}}),a.jsx(De,{variant:p.variant,message:p.message,isOpen:p.isOpen,onClose:()=>g({...p,isOpen:!1}),autoCloseDuration:p.variant==="success"?1500:0,zIndex:1e4})]})},O7="_filterContainer_gloe1_6",P7="_filterButton_gloe1_11",$7="_filterIcon_gloe1_32",F7="_dropdownArrow_gloe1_38",B7="_dropdownArrowOpen_gloe1_45",H7="_dropdownMenu_gloe1_49",V7="_dropdownItem_gloe1_76",z7="_active_gloe1_96",U7="_checkIcon_gloe1_106",W7="_chevronRight_gloe1_113",q7="_divider_gloe1_120",G7="_brandMenuItem_gloe1_126",J7="_brandSubmenu_gloe1_130",K7="_emptyBrands_gloe1_160",Fe={filterContainer:O7,filterButton:P7,filterIcon:$7,dropdownArrow:F7,dropdownArrowOpen:B7,dropdownMenu:H7,dropdownItem:V7,active:z7,checkIcon:U7,chevronRight:W7,divider:q7,brandMenuItem:G7,brandSubmenu:J7,emptyBrands:K7},Y7=({filterType:t,selectedBrandFilter:e,brands:r,onFilterChange:s,onBrandFilterChange:n})=>{const[o,i]=b.useState(!1),[l,c]=b.useState(!1),d=b.useRef(null);b.useEffect(()=>{const g=y=>{d.current&&!d.current.contains(y.target)&&(i(!1),c(!1))};return document.addEventListener("mousedown",g),()=>document.removeEventListener("mousedown",g)},[]);const u=()=>{i(!o),o&&c(!1)},h=g=>{g==="brand"?c(!0):(s(g),n(null),i(!1),c(!1))},f=g=>{s("brand"),n(g),i(!1),c(!1)},p=()=>t==="brand"&&e?`Brand: ${e}`:{newest:"Newest",oldest:"Oldest",price_high:"Price: High to Low",price_low:"Price: Low to High",cost_high:"Cost: High to Low",cost_low:"Cost: Low to High",brand:"Brand"}[t];return a.jsxs("div",{className:Fe.filterContainer,ref:d,children:[a.jsxs("button",{className:Fe.filterButton,onClick:u,"aria-label":"Filter products",children:[a.jsx("svg",{className:Fe.filterIcon,width:"16",height:"16",fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M10,18h4v-2h-4V18z M3,6v2h18V6H3z M6,13h12v-2H6V13z"})}),a.jsx("span",{children:p()}),a.jsx("svg",{className:`${Fe.dropdownArrow} ${o?Fe.dropdownArrowOpen:""}`,width:"12",height:"12",fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M7.41,8.58L12,13.17L16.59,8.58L18,10L12,16L6,10L7.41,8.58Z"})})]}),o&&a.jsxs("div",{className:Fe.dropdownMenu,children:[a.jsxs("button",{className:`${Fe.dropdownItem} ${t==="newest"?Fe.active:""}`,onClick:()=>h("newest"),children:[a.jsx("span",{children:"Newest"}),t==="newest"&&a.jsx("svg",{className:Fe.checkIcon,width:"16",height:"16",fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M9,16.17L4.83,12l-1.42,1.41L9,19L21,7l-1.41-1.41L9,16.17z"})})]}),a.jsxs("button",{className:`${Fe.dropdownItem} ${t==="oldest"?Fe.active:""}`,onClick:()=>h("oldest"),children:[a.jsx("span",{children:"Oldest"}),t==="oldest"&&a.jsx("svg",{className:Fe.checkIcon,width:"16",height:"16",fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M9,16.17L4.83,12l-1.42,1.41L9,19L21,7l-1.41-1.41L9,16.17z"})})]}),a.jsx("div",{className:Fe.divider}),a.jsxs("button",{className:`${Fe.dropdownItem} ${t==="price_high"?Fe.active:""}`,onClick:()=>h("price_high"),children:[a.jsx("span",{children:"Price: High to Low"}),t==="price_high"&&a.jsx("svg",{className:Fe.checkIcon,width:"16",height:"16",fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M9,16.17L4.83,12l-1.42,1.41L9,19L21,7l-1.41-1.41L9,16.17z"})})]}),a.jsxs("button",{className:`${Fe.dropdownItem} ${t==="price_low"?Fe.active:""}`,onClick:()=>h("price_low"),children:[a.jsx("span",{children:"Price: Low to High"}),t==="price_low"&&a.jsx("svg",{className:Fe.checkIcon,width:"16",height:"16",fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M9,16.17L4.83,12l-1.42,1.41L9,19L21,7l-1.41-1.41L9,16.17z"})})]}),a.jsx("div",{className:Fe.divider}),a.jsxs("button",{className:`${Fe.dropdownItem} ${t==="cost_high"?Fe.active:""}`,onClick:()=>h("cost_high"),children:[a.jsx("span",{children:"Cost: High to Low"}),t==="cost_high"&&a.jsx("svg",{className:Fe.checkIcon,width:"16",height:"16",fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M9,16.17L4.83,12l-1.42,1.41L9,19L21,7l-1.41-1.41L9,16.17z"})})]}),a.jsxs("button",{className:`${Fe.dropdownItem} ${t==="cost_low"?Fe.active:""}`,onClick:()=>h("cost_low"),children:[a.jsx("span",{children:"Cost: Low to High"}),t==="cost_low"&&a.jsx("svg",{className:Fe.checkIcon,width:"16",height:"16",fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M9,16.17L4.83,12l-1.42,1.41L9,19L21,7l-1.41-1.41L9,16.17z"})})]}),a.jsx("div",{className:Fe.divider}),a.jsxs("div",{className:Fe.brandMenuItem,children:[a.jsxs("button",{className:`${Fe.dropdownItem} ${t==="brand"?Fe.active:""}`,onClick:()=>h("brand"),children:[a.jsx("span",{children:"Brand"}),a.jsx("svg",{className:Fe.chevronRight,width:"16",height:"16",fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z"})})]}),l&&a.jsx("div",{className:Fe.brandSubmenu,children:r.length===0?a.jsx("div",{className:Fe.emptyBrands,children:"No brands available"}):r.map(g=>a.jsxs("button",{className:`${Fe.dropdownItem} ${t==="brand"&&e===g?Fe.active:""}`,onClick:()=>f(g),children:[a.jsx("span",{children:g}),t==="brand"&&e===g&&a.jsx("svg",{className:Fe.checkIcon,width:"16",height:"16",fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M9,16.17L4.83,12l-1.42,1.41L9,19L21,7l-1.41-1.41L9,16.17z"})})]},g))})]})]})]})};class Q7{constructor(){W(this,"excelJSLoaded",!1);W(this,"excelJSLoading",null)}async loadExcelJS(){return this.excelJSLoaded?!0:this.excelJSLoading?this.excelJSLoading:(this.excelJSLoading=new Promise((e,r)=>{const s=document.createElement("script");s.src="https://cdn.jsdelivr.net/npm/exceljs@4.4.0/dist/exceljs.min.js",s.async=!0,s.onload=()=>{this.excelJSLoaded=!0,this.excelJSLoading=null,console.log(" ExcelJS loaded successfully"),e(!0)},s.onerror=()=>{this.excelJSLoading=null,console.error(" Failed to load ExcelJS"),r(new Error("Failed to load ExcelJS library"))},document.head.appendChild(s)}),this.excelJSLoading)}async exportInventoryToExcel(e,r="AllStores",s="VND"){await this.loadExcelJS();const n=window.ExcelJS;if(!n)throw new Error("ExcelJS library not loaded");const o=new n.Workbook,i=o.addWorksheet("Inventory");i.columns=[{header:"Product Code (SKU)",key:"sku",width:18},{header:"Barcode",key:"barcode",width:15},{header:"Product Name",key:"product_name",width:30},{header:"Category",key:"category",width:20},{header:"Brand",key:"brand",width:20},{header:"Unit",key:"unit",width:10},{header:`Cost Price (${s})`,key:"cost_price",width:15},{header:`Selling Price (${s})`,key:"selling_price",width:15},{header:"Current Stock",key:"current_stock",width:15},{header:"Status",key:"status",width:12}],e.forEach(p=>{i.addRow({sku:p.productCode||p.sku||"",barcode:p.barcode||"",product_name:p.productName||"",category:p.categoryName||"",brand:p.brandName||"",unit:p.unit||"piece",cost_price:p.costPrice||0,selling_price:p.unitPrice||0,current_stock:p.currentStock||0,status:p.currentStock===0?"OUT OF STOCK":p.currentStock<=5?"LOW STOCK":"IN STOCK"})});const l=i.getRow(1);l.font={name:"Arial",size:11,bold:!0,color:{argb:"FFFFFFFF"}},l.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FF4472C4"}},l.alignment={vertical:"middle",horizontal:"center",wrapText:!1},l.height=25,l.eachCell({includeEmpty:!1},p=>{p.border={top:{style:"thin",color:{argb:"FF000000"}},left:{style:"thin",color:{argb:"FF000000"}},bottom:{style:"thin",color:{argb:"FF000000"}},right:{style:"thin",color:{argb:"FF000000"}}}}),i.eachRow((p,g)=>{g>1&&p.eachCell({includeEmpty:!1},y=>{y.border={top:{style:"thin",color:{argb:"FFD3D3D3"}},left:{style:"thin",color:{argb:"FFD3D3D3"}},bottom:{style:"thin",color:{argb:"FFD3D3D3"}},right:{style:"thin",color:{argb:"FFD3D3D3"}}};const x=i.getColumn(y.col).key;["cost_price","selling_price","current_stock"].includes(x)&&(y.alignment={horizontal:"center",vertical:"middle"})})}),i.views=[{state:"frozen",ySplit:1}];const c=new Date,d=c.getFullYear()+String(c.getMonth()+1).padStart(2,"0")+String(c.getDate()).padStart(2,"0"),u=`Inventory_${r}_${d}.xlsx`,h=await o.xlsx.writeBuffer(),f=new Blob([h],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});await this.downloadExcelFile(f,u,e.length)}async downloadExcelFile(e,r,s){let n=!1;if("showSaveFilePicker"in window&&window.isSecureContext&&!window.location.protocol.includes("file:"))try{const l=await(await window.showSaveFilePicker({suggestedName:r,types:[{description:"Excel Files",accept:{"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[".xlsx"]}}],excludeAcceptAllOption:!0})).createWritable();await l.write(e),await l.close(),n=!0,console.log(` Export successful: ${s} products exported to ${r}`)}catch(i){if(i.name==="AbortError")throw console.log(" Export cancelled by user"),new Error("Export cancelled by user");i.name==="SecurityError"||i.name,n=!1}n||this.fallbackExcelDownload(e,r)}fallbackExcelDownload(e,r){try{const s=window.URL.createObjectURL(e),n=document.createElement("a");n.href=s,n.download=r,n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(s),console.log(" Export successful (fallback): File saved to default downloads folder")}catch(s){throw console.error(" Fallback download error:",s),s}}async parseInventoryExcel(e){await this.loadExcelJS();const r=window.ExcelJS;if(!r)throw new Error("ExcelJS library not loaded");const s=new r.Workbook;await s.xlsx.load(await e.arrayBuffer());const n=s.getWorksheet(1),o=[];return n.eachRow((i,l)=>{if(l===1)return;const c={product_id:null,sku:i.getCell(1).value||null,barcode:i.getCell(2).value||null,product_name:i.getCell(3).value||"",category:i.getCell(4).value||null,brand:i.getCell(5).value||null,unit:i.getCell(6).value||"piece",cost_price:parseFloat(i.getCell(7).value)||0,selling_price:parseFloat(i.getCell(8).value)||0,current_stock:parseFloat(i.getCell(9).value)||0,min_stock:parseFloat(i.getCell(10).value)||0,max_stock:parseFloat(i.getCell(11).value)||0,reorder_point:parseFloat(i.getCell(12).value)||0,status:i.getCell(13).value||"Active"};c.product_name&&(c.sku!==null&&(c.sku=String(c.sku).trim()),c.barcode!==null&&(c.barcode=String(c.barcode).trim()),c.product_name&&(c.product_name=String(c.product_name).trim()),c.category!==null&&(c.category=String(c.category).trim()),c.brand!==null&&(c.brand=String(c.brand).trim()),c.unit&&(c.unit=String(c.unit).toLowerCase().trim()),c.status&&(c.status=String(c.status).trim()),c.sku===""&&(c.sku=null),c.barcode===""&&(c.barcode=null),c.category===""&&(c.category=null),c.brand===""&&(c.brand=null),c.cost_price=isNaN(c.cost_price)?0:c.cost_price,c.selling_price=isNaN(c.selling_price)?0:c.selling_price,c.current_stock=isNaN(c.current_stock)?0:c.current_stock,c.min_stock=isNaN(c.min_stock)?0:c.min_stock,c.max_stock=isNaN(c.max_stock)?0:c.max_stock,c.reorder_point=isNaN(c.reorder_point)?0:c.reorder_point,o.push(c))}),o}}const z_=new Q7,Z7="_container_77p8f_6",X7="_header_77p8f_15",eB="_title_77p8f_19",tB="_subtitle_77p8f_26",rB="_controlsCard_77p8f_34",sB="_controlSection_77p8f_43",nB="_controlLabel_77p8f_79",oB="_controlIcon_77p8f_84",aB="_active_77p8f_140",iB="_contentCard_77p8f_203",lB="_inventoryHeader_77p8f_213",cB="_inventoryTitleSection_77p8f_222",dB="_inventoryTitle_77p8f_222",uB="_inventoryActions_77p8f_236",hB="_actionButtons_77p8f_242",fB="_inventorySearchWrapper_77p8f_320",mB="_inventorySearch_77p8f_320",pB="_searchIcon_77p8f_347",gB="_searchClear_77p8f_358",_B="_inventoryTableWrapper_77p8f_383",yB="_inventoryTable_77p8f_383",vB="_quantityCell_77p8f_411",xB="_priceCell_77p8f_412",bB="_costCell_77p8f_413",wB="_checkboxCell_77p8f_432",SB="_productRow_77p8f_520",CB="_productNameCell_77p8f_525",jB="_productName_77p8f_525",kB="_productCodeCell_77p8f_542",NB="_productCode_77p8f_542",IB="_barcodeCell_77p8f_560",EB="_barcode_77p8f_560",TB="_quantityValue_77p8f_579",AB="_quantityOut_77p8f_584",LB="_quantityLow_77p8f_588",DB="_priceValue_77p8f_598",MB="_costValue_77p8f_604",RB="_statusInStock_77p8f_625",OB="_statusLowStock_77p8f_631",PB="_statusOutOfStock_77p8f_637",$B="_moveCell_77p8f_645",FB="_actionsCell_77p8f_650",BB="_emptyState_77p8f_681",HB="_emptyIcon_77p8f_687",VB="_emptyTitle_77p8f_694",zB="_emptyText_77p8f_701",UB="_pagination_77p8f_762",WB="_paginationInfo_77p8f_770",qB="_paginationControls_77p8f_775",GB="_paginationButton_77p8f_781",Z={container:Z7,header:X7,title:eB,subtitle:tB,controlsCard:rB,controlSection:sB,controlLabel:nB,controlIcon:oB,active:aB,contentCard:iB,inventoryHeader:lB,inventoryTitleSection:cB,inventoryTitle:dB,inventoryActions:uB,actionButtons:hB,inventorySearchWrapper:fB,inventorySearch:mB,searchIcon:pB,searchClear:gB,inventoryTableWrapper:_B,inventoryTable:yB,quantityCell:vB,priceCell:xB,costCell:bB,checkboxCell:wB,productRow:SB,productNameCell:CB,productName:jB,productCodeCell:kB,productCode:NB,barcodeCell:IB,barcode:EB,quantityValue:TB,quantityOut:AB,quantityLow:LB,priceValue:DB,costValue:MB,statusInStock:RB,statusLowStock:OB,statusOutOfStock:PB,moveCell:$B,actionsCell:FB,emptyState:BB,emptyIcon:HB,emptyTitle:VB,emptyText:zB,pagination:UB,paginationInfo:WB,paginationControls:qB,paginationButton:GB},JB=()=>{const{currentCompany:t}=at(),e=(t==null?void 0:t.company_id)||"",{inventory:r,currencySymbol:s,currencyCode:n,currentPage:o,itemsPerPage:i,selectedStoreId:l,selectedProducts:c,filterType:d,selectedBrandFilter:u,isModalOpen:h,selectedProductData:f,isAddProductModalOpen:p,loading:g,error:y,notification:x,setSelectedStoreId:m,setCurrentPage:_,toggleProductSelection:v,clearSelection:w,setFilterType:S,setSelectedBrandFilter:E,openModal:C,closeModal:k,openAddProductModal:N,closeAddProductModal:I,showNotification:L,hideNotification:T,loadInventory:j,updateProduct:M,importExcel:R,refresh:O}=fF(),{metadata:z,error:D,refresh:P}=mF(e,l||void 0),[$,U]=b.useState(!1),[A,Ae]=b.useState(!1),[ae,Ke]=b.useState({current:0,total:0}),[Te,At]=b.useState(""),sr=Ar.useRef(null);b.useEffect(()=>{_(1)},[Te,_]),b.useEffect(()=>{t!=null&&t.stores&&t.stores.length>0&&!l&&m(t.stores[0].store_id)},[t,l,m]),b.useEffect(()=>{e&&l&&j(e,l,"")},[e,l,j]);const Cr=Ar.useMemo(()=>Array.from(new Set(r.map(he=>he.brandName).filter(Boolean))).sort(),[r]),tt=Ar.useMemo(()=>{let Y=[...r];if(Te.trim()){const he=Te.toLowerCase().trim();Y=Y.filter(nt=>nt.productName.toLowerCase().includes(he)||nt.sku.toLowerCase().includes(he))}switch(d==="brand"&&u&&(Y=Y.filter(he=>he.brandName===u)),d){case"newest":break;case"oldest":Y=Y.reverse();break;case"price_high":Y=Y.sort((he,nt)=>nt.unitPrice-he.unitPrice);break;case"price_low":Y=Y.sort((he,nt)=>he.unitPrice-nt.unitPrice);break;case"cost_high":Y=Y.sort((he,nt)=>nt.costPrice-he.costPrice);break;case"cost_low":Y=Y.sort((he,nt)=>he.costPrice-nt.costPrice);break}return Y},[r,Te,d,u]),it=Ar.useMemo(()=>{const Y=(o-1)*i,he=Y+i;return tt.slice(Y,he)},[tt,o,i]),me=tt.length,Je=Math.ceil(me/i),St=Y=>{const he=Y.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0});return`${s}${he}`},X=Y=>{Y.target.checked?(w(),tt.forEach(he=>{v(he.productId)})):w()},J=Y=>{v(Y)},ve=Y=>{const he=r.find(nt=>nt.productId===Y);he&&C(he)},xe=()=>{console.log("Delete products:",Array.from(c))},F=async()=>{var Y;if(!$)try{U(!0);const he=(Y=t==null?void 0:t.stores)==null?void 0:Y.find(ht=>ht.store_id===l),nt=(he==null?void 0:he.store_name)||"AllStores";await z_.exportInventoryToExcel(r,nt,n),L("success",`Successfully exported ${r.length} products to Excel!`)}catch(he){console.error("Export Excel error:",he),(he instanceof Error?he.message:"").includes("cancelled")||L("error","Failed to export inventory data. Please try again.")}finally{U(!1)}},K=async Y=>{var nt;console.log(" Import Excel handler called");const he=(nt=Y.target.files)==null?void 0:nt[0];if(console.log(" Selected file:",he),!he){console.log(" No file selected");return}if(Y.target.value="",!he.name.endsWith(".xlsx")&&!he.name.endsWith(".xls")){console.log(" Invalid file type:",he.name),L("error","Please select a valid Excel file (.xlsx or .xls)");return}try{console.log(" File validation passed, starting import..."),console.log(" Parsing Excel file...");const ht=await z_.parseInventoryExcel(he);if(console.log(" Parsed products:",ht.length),!ht||ht.length===0){console.log(" No valid products found"),L("error","No valid products found in the Excel file");return}console.log(" Getting user from Supabase Auth...");const{data:{user:Rr},error:Zi}=await ne.auth.getUser();if(console.log(" User:",Rr),Zi||!Rr){console.log(" Auth error:",Zi),L("error","Failed to get user information. Please log in again.");return}const Q=200,Ct=ht.length,nr=Math.ceil(Ct/Q);console.log(` Starting batch processing: ${Ct} products in ${nr} batches`),Ae(!0),Ke({current:0,total:nr});let as=0,Mt=0,Xi=0,Bn=0;const Sx=[];for(let el=0;el<nr;el++){const wa=el+1,Nd=el*Q,Cx=Math.min(Nd+Q,Ct),tl=ht.slice(Nd,Cx);console.log(` Processing batch ${wa}/${nr} (${tl.length} products)`);try{Ke({current:wa,total:nr});const Yr=await R(e,l,Rr.id,tl);if(Yr.success&&Yr.summary){if(as+=Yr.summary.created||0,Mt+=Yr.summary.updated||0,Xi+=Yr.summary.skipped||0,Bn+=Yr.summary.errors||0,Yr.errors&&Yr.errors.length>0){const jx=Yr.errors.map(Cm=>({...Cm,row:Cm.row+Nd}));Sx.push(...jx)}console.log(` Batch ${wa}/${nr} completed:`,Yr.summary)}else console.error(` Batch ${wa}/${nr} failed:`,Yr.error),Bn+=tl.length}catch(Yr){console.error(` Batch ${wa}/${nr} error:`,Yr),Bn+=tl.length}}console.log(" All batches processed"),console.log(` Final results: Created=${as}, Updated=${Mt}, Skipped=${Xi}, Errors=${Bn}`);let kd=`Import completed: ${as+Mt+Xi+Bn} products processed.
`;kd+=` Created: ${as}, Updated: ${Mt}, Skipped: ${Xi}`,Bn>0&&(kd+=`,  Errors: ${Bn}`),L("success",kd),console.log(" Refreshing inventory..."),await j(e,l,""),console.log(" Import completed and inventory refreshed")}catch(ht){console.error("Import Excel error:",ht),L("error","Failed to import Excel file. Please check the file format and try again.")}finally{Ae(!1),Ke({current:0,total:0})}},ie=()=>{var Y;console.log(" Import button clicked"),console.log(" File input ref:",sr.current),(Y=sr.current)==null||Y.click()},ye=()=>{N()},st=()=>{At("")},Ue=Y=>{const he=Y.currentStock;return he===0?{class:Z.statusOutOfStock,text:"OUT OF STOCK"}:he<=5?{class:Z.statusLowStock,text:"LOW STOCK"}:{class:Z.statusInStock,text:"IN STOCK"}},Kt=Y=>Y===0?Z.quantityOut:Y<=5?Z.quantityLow:"";if(!t)return a.jsxs(a.Fragment,{children:[a.jsx(fe,{activeItem:"product"}),a.jsxs("div",{className:Z.container,children:[a.jsx("div",{className:Z.header,children:a.jsx("h1",{className:Z.title,children:"Inventory"})}),a.jsx(Ne,{fullscreen:!0,size:"large"})]})]});if(g)return a.jsxs(a.Fragment,{children:[a.jsx(fe,{activeItem:"product"}),a.jsxs("div",{className:Z.container,children:[a.jsxs("div",{className:Z.header,children:[a.jsx("h1",{className:Z.title,children:"Inventory"}),a.jsx("p",{className:Z.subtitle,children:"Manage product inventory across stores"})]}),a.jsx("div",{className:Z.controlsCard,children:a.jsxs("div",{className:Z.controlSection,children:[a.jsx("svg",{className:Z.controlIcon,fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M19,2H5A3,3 0 0,0 2,5V19A3,3 0 0,0 5,22H19A3,3 0 0,0 22,19V5A3,3 0 0,0 19,2M19,19H5V5H19V19Z"})}),a.jsx("span",{className:Z.controlLabel,children:"All Stores"})]})}),a.jsx("div",{className:Z.contentCard,children:a.jsx(Ne,{fullscreen:!0,size:"large"})})]})]});if(y)return a.jsxs(a.Fragment,{children:[a.jsx(fe,{activeItem:"product"}),a.jsxs("div",{className:Z.container,children:[a.jsxs("div",{className:Z.header,children:[a.jsx("h1",{className:Z.title,children:"Inventory"}),a.jsx("p",{className:Z.subtitle,children:"Manage product inventory across stores"})]}),a.jsx("div",{className:Z.controlsCard,children:a.jsxs("div",{className:Z.controlSection,children:[a.jsx("svg",{className:Z.controlIcon,fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M19,2H5A3,3 0 0,0 2,5V19A3,3 0 0,0 5,22H19A3,3 0 0,0 22,19V5A3,3 0 0,0 19,2M19,19H5V5H19V19Z"})}),a.jsx("span",{className:Z.controlLabel,children:"All Stores"})]})}),a.jsx("div",{className:Z.contentCard,children:a.jsx(Ne,{fullscreen:!0,size:"large"})})]}),a.jsx(De,{isOpen:!0,variant:"error",title:"Failed to Load Inventory",message:y,onClose:()=>{},confirmText:"Try Again",onConfirm:()=>j(e,l,""),closeOnBackdropClick:!1,closeOnEscape:!1,zIndex:9999})]});const So=tt.length>0&&tt.every(Y=>c.has(Y.productId));return a.jsxs(a.Fragment,{children:[a.jsx(fe,{activeItem:"product"}),a.jsxs("div",{className:Z.container,children:[a.jsxs("div",{className:Z.header,children:[a.jsx("h1",{className:Z.title,children:"Inventory"}),a.jsx("p",{className:Z.subtitle,children:"Manage product inventory across stores"})]}),a.jsx("div",{className:Z.controlsCard,children:a.jsx(Hs,{stores:(t==null?void 0:t.stores)||[],selectedStoreId:l,onStoreSelect:m,companyId:t==null?void 0:t.company_id,showAllStoresOption:!1})}),a.jsxs("div",{className:Z.contentCard,children:[a.jsxs("div",{className:Z.inventoryHeader,children:[a.jsxs("div",{className:Z.inventoryTitleSection,children:[a.jsx("h2",{className:Z.inventoryTitle,children:"Products"}),a.jsxs("div",{className:Z.inventorySearchWrapper,children:[a.jsx("svg",{className:Z.searchIcon,fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"})}),a.jsx("input",{type:"text",className:Z.inventorySearch,placeholder:"Search products...",value:Te,onChange:Y=>At(Y.target.value)}),Te&&a.jsx("button",{className:Z.searchClear,onClick:st,children:a.jsx("svg",{fill:"currentColor",viewBox:"0 0 24 24",width:"16",height:"16",children:a.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})})})]}),a.jsx(Y7,{filterType:d,selectedBrandFilter:u,brands:Cr,onFilterChange:S,onBrandFilterChange:E})]}),a.jsx("div",{className:Z.inventoryActions,children:a.jsxs("div",{className:Z.actionButtons,children:[a.jsx(be,{variant:"error",size:"md",onClick:xe,disabled:c.size===0,icon:a.jsx("svg",{width:"16",height:"16",fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z"})}),iconPosition:"left",children:c.size>0?`Delete ${c.size} Product${c.size>1?"s":""}`:"Delete Product"}),a.jsx(be,{variant:"secondary",size:"md",onClick:F,disabled:$||r.length===0,icon:$?a.jsx(Ne,{size:"small"}):a.jsx("svg",{width:"16",height:"16",fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"})}),iconPosition:"left",children:$?"Exporting...":"Export Excel"}),a.jsx(be,{variant:"secondary",size:"md",onClick:ie,disabled:A,icon:A?a.jsx(Ne,{size:"small"}):a.jsx("svg",{width:"16",height:"16",fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M13,13H11V16H9L12,19L15,16H13V13M13,9V3.5L18.5,9H13Z"})}),iconPosition:"left",children:A?"Importing...":"Import Excel"}),a.jsx("input",{ref:sr,type:"file",accept:".xlsx,.xls",onChange:K,style:{display:"none"}}),a.jsx(be,{variant:"primary",size:"md",onClick:ye,icon:a.jsx("svg",{width:"16",height:"16",fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"})}),iconPosition:"left",children:"Add Product"})]})})]}),r.length===0?a.jsxs("div",{className:Z.emptyState,children:[a.jsxs("svg",{className:Z.emptyIcon,width:"120",height:"120",viewBox:"0 0 120 120",fill:"none",children:[a.jsx("circle",{cx:"60",cy:"60",r:"50",fill:"#F0F6FF"}),a.jsx("rect",{x:"35",y:"35",width:"50",height:"50",rx:"4",fill:"white",stroke:"#0064FF",strokeWidth:"2"}),a.jsx("rect",{x:"40",y:"40",width:"40",height:"40",rx:"2",fill:"#F0F6FF",stroke:"#0064FF",strokeWidth:"1.5"}),a.jsx("line",{x1:"42",y1:"50",x2:"78",y2:"50",stroke:"#0064FF",strokeWidth:"2",strokeLinecap:"round"}),a.jsx("line",{x1:"42",y1:"60",x2:"78",y2:"60",stroke:"#0064FF",strokeWidth:"2",strokeLinecap:"round"}),a.jsx("line",{x1:"42",y1:"70",x2:"78",y2:"70",stroke:"#0064FF",strokeWidth:"2",strokeLinecap:"round"}),a.jsx("circle",{cx:"70",cy:"80",r:"12",fill:"#0064FF"}),a.jsx("circle",{cx:"70",cy:"80",r:"5",stroke:"white",strokeWidth:"2",fill:"none"}),a.jsx("line",{x1:"74",y1:"84",x2:"78",y2:"88",stroke:"white",strokeWidth:"2",strokeLinecap:"round"})]}),a.jsx("h3",{className:Z.emptyTitle,children:"No products found"}),a.jsx("p",{className:Z.emptyText,children:Te?"No items match your search criteria":"Add products to start managing inventory"})]}):a.jsx("div",{className:Z.inventoryTableWrapper,children:a.jsxs("table",{className:Z.inventoryTable,children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{className:Z.checkboxCell,children:a.jsx("input",{type:"checkbox",className:Z.checkbox,checked:So,onChange:X})}),a.jsx("th",{children:"Product Name"}),a.jsx("th",{children:"Product Code"}),a.jsx("th",{children:"Brand"}),a.jsx("th",{className:Z.quantityCell,children:"Quantity"}),a.jsxs("th",{className:Z.priceCell,children:["Price (",n,")"]}),a.jsxs("th",{className:Z.costCell,children:["Cost (",n,")"]}),a.jsx("th",{children:"Move"}),a.jsx("th",{children:"Actions"})]})}),a.jsx("tbody",{children:it.map(Y=>{Ue(Y);const he=Kt(Y.currentStock);return a.jsxs("tr",{className:Z.productRow,children:[a.jsx("td",{className:Z.checkboxCell,children:a.jsx("input",{type:"checkbox",className:Z.checkbox,checked:c.has(Y.productId),onChange:()=>J(Y.productId)})}),a.jsx("td",{className:Z.productNameCell,children:a.jsx("span",{className:Z.productName,children:Y.productName})}),a.jsx("td",{className:Z.productCodeCell,children:a.jsx("span",{className:Z.productCode,children:Y.productCode})}),a.jsx("td",{className:Z.barcodeCell,children:a.jsx("span",{className:Z.barcode,children:Y.brandName||"N/A"})}),a.jsx("td",{className:Z.quantityCell,children:a.jsx("span",{className:`${Z.quantityValue} ${he}`,children:Y.currentStock})}),a.jsx("td",{className:Z.priceCell,children:a.jsx("div",{className:Z.priceValue,children:St(Y.unitPrice)})}),a.jsx("td",{className:Z.costCell,children:a.jsx("div",{className:Z.costValue,children:St(Y.costPrice)})}),a.jsx("td",{className:Z.moveCell,children:a.jsx(be,{variant:"outline",size:"sm",onClick:()=>{},disabled:Y.currentStock===0,icon:a.jsx("svg",{width:"14",height:"14",fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M6,13H14L10.5,16.5L11.92,17.92L17.84,12L11.92,6.08L10.5,7.5L14,11H6V13M20,6V18H11V20H20A2,2 0 0,0 22,18V6A2,2 0 0,0 20,4H11V6H20Z"})}),iconPosition:"left",customStyles:{backgroundColor:Y.currentStock===0?"#F8F9FA":"white",color:Y.currentStock===0?"#ADB5BD":"#0064FF",borderColor:Y.currentStock===0?"#DEE2E6":"#0064FF",borderWidth:"1.5px",borderRadius:"8px",padding:"6px 12px",fontSize:"13px",cursor:Y.currentStock===0?"not-allowed":"pointer"},children:"Move"})}),a.jsx("td",{className:Z.actionsCell,children:a.jsx(be,{variant:"outline",size:"sm",onClick:()=>ve(Y.productId),icon:a.jsx("svg",{width:"14",height:"14",fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"})}),iconPosition:"left",customStyles:{backgroundColor:"white",color:"#0064FF",borderColor:"#0064FF",borderWidth:"1.5px",borderRadius:"8px",padding:"6px 12px",fontSize:"13px"},children:"Edit"})})]},Y.productId)})})]})}),tt.length>0&&a.jsxs("div",{className:Z.pagination,children:[a.jsxs("div",{className:Z.paginationInfo,children:["Showing ",(o-1)*i+1,"-",Math.min(o*i,me)," of ",me," products"]}),a.jsxs("div",{className:Z.paginationControls,children:[a.jsx("button",{className:Z.paginationButton,onClick:()=>{const Y=Math.floor((o-1)/5),he=Math.max(1,Y*5);_(he)},disabled:o<=5,style:{opacity:o<=5?.4:1,cursor:o<=5?"not-allowed":"pointer"},children:a.jsx("svg",{width:"16",height:"16",fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M15.41,16.58L10.83,12L15.41,7.41L14,6L8,12L14,18L15.41,16.58Z"})})}),(()=>{const Y=[],nt=Math.floor((o-1)/5)*5+1,ht=Math.min(nt+4,Je);for(let Rr=nt;Rr<=ht;Rr++)Y.push(a.jsx("button",{className:`${Z.paginationButton} ${o===Rr?Z.active:""}`,onClick:()=>_(Rr),children:Rr},Rr));return Y})(),a.jsx("button",{className:Z.paginationButton,onClick:()=>{const he=(Math.floor((o-1)/5)+1)*5+1,nt=Math.min(he,Je);_(nt)},disabled:(Math.floor((o-1)/5)+1)*5+1>Je,style:{opacity:(Math.floor((o-1)/5)+1)*5+1>Je?.4:1,cursor:(Math.floor((o-1)/5)+1)*5+1>Je?"not-allowed":"pointer"},children:a.jsx("svg",{width:"16",height:"16",fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z"})})})]})]})]})]}),a.jsx(u7,{isOpen:h,onClose:k,productId:(f==null?void 0:f.productId)||"",companyId:e,productData:f,metadata:z,onSave:async Y=>{const he=await M((f==null?void 0:f.productId)||"",e,l||"",Y);he.success?L("success","Product updated successfully!"):L("error",he.error||"Failed to update product")},onMetadataRefresh:P}),a.jsx(R7,{isOpen:p,onClose:I,companyId:e,storeId:l,metadata:z,onProductAdded:()=>{O()},onMetadataRefresh:P}),a.jsx(De,{isOpen:x.isOpen,variant:x.variant,message:x.message,onClose:T,autoCloseDuration:2e3,zIndex:9999}),D&&a.jsx(De,{isOpen:!0,variant:"warning",title:"Failed to Load Metadata",message:D,onClose:()=>{},confirmText:"Retry",onConfirm:P,showCancelButton:!0,cancelText:"Dismiss",zIndex:9998}),A&&a.jsx(Ne,{size:"large",fullscreen:!0})]})};class KB{async getInvoices(e,r,s,n,o,i,l){const c=ne.getClient(),d={p_company_id:e,p_store_id:r,p_page:s,p_limit:n,p_search:o,p_start_date:i,p_end_date:l},{data:u,error:h}=await c.rpc("get_invoice_page",d);if(h)throw console.error(" Error fetching invoices:",h),new Error(h.message);return u}async getInvoiceDetail(e){const r=ne.getClient(),{data:s,error:n}=await r.rpc("get_invoice_detail",{p_invoice_id:e});if(n)throw console.error(" Error fetching invoice detail:",n),new Error(n.message);return s}async refundInvoice(e,r,s){const n=ne.getClient(),{data:o,error:i}=await n.rpc("inventory_refund_invoice",{p_invoice_id:e,p_refund_date:te.nowUtc(),p_refund_reason:r||null,p_created_by:s||null});if(i)throw console.error(" Error refunding invoice:",i),new Error(i.message);return o}}class YB{constructor(e,r,s,n,o,i,l,c,d,u,h="cash",f="pending"){this.invoiceId=e,this.invoiceNumber=r,this.invoiceDate=s,this.customerName=n,this.customerPhone=o,this.itemCount=i,this.totalQuantity=l,this.totalAmount=c,this.status=d,this.currencySymbol=u,this.paymentMethod=h,this.paymentStatus=f}get statusDisplay(){switch(this.status){case"draft":return"Draft";case"issued":return"Issued";case"paid":return"Paid";case"cancelled":return"Cancelled";default:return this.status}}formatCurrency(e){const r=e??0;return`${this.currencySymbol}${r.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})}`}get formattedDate(){if(!this.invoiceDate)return"Invalid Date";try{return te.toLocal(this.invoiceDate).toLocaleDateString("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit"})}catch(e){return console.error("Error formatting date:",this.invoiceDate,e),"Invalid Date"}}get isEditable(){return this.status==="draft"}get isCancellable(){return this.status==="draft"||this.status==="issued"}get paymentMethodDisplay(){return{cash:"Cash",card:"Card",bank:"Bank",transfer:"Bank",bank_transfer:"Bank"}[this.paymentMethod]||this.paymentMethod}get paymentBadgeClass(){return this.paymentStatus==="paid"?"payment-paid":"payment-pending"}}class QB{static fromJson(e,r){var f,p,g,y,x,m,_,v,w;const s=((f=e.customer)==null?void 0:f.name)||"Walk-in",n=((p=e.customer)==null?void 0:p.phone)||null,o=((g=e.items_summary)==null?void 0:g.item_count)||0,i=((y=e.items_summary)==null?void 0:y.total_quantity)||0,l=((x=e.amounts)==null?void 0:x.total_amount)||0,c=r||((m=e.amounts)==null?void 0:m.currency_symbol)||((_=e.store)==null?void 0:_.currency_symbol)||"",d=((v=e.payment)==null?void 0:v.method)||"cash",u=((w=e.payment)==null?void 0:w.status)||"pending",h=e.invoice_date||e.sale_date;return new YB(e.invoice_id,e.invoice_number,h,s,n,o,i,l,e.status,c,d,u)}static fromJsonArray(e,r){return e.map(s=>this.fromJson(s,r))}static toJson(e){return{invoice_id:e.invoiceId,invoice_number:e.invoiceNumber,invoice_date:e.invoiceDate,customer_name:e.customerName,customer_phone:e.customerPhone,item_count:e.itemCount,total_quantity:e.totalQuantity,total_amount:e.totalAmount,status:e.status,currency_symbol:e.currencySymbol,payment_method:e.paymentMethod,payment_status:e.paymentStatus}}static toJsonArray(e){return e.map(r=>this.toJson(r))}static isValidApiResponse(e){return e&&typeof e=="object"&&typeof e.invoice_id=="string"&&typeof e.invoice_number=="string"&&typeof e.status=="string"}static extractCurrencySymbol(e){var r,s,n;return((r=e.amounts)==null?void 0:r.currency_symbol)||((s=e.store)==null?void 0:s.currency_symbol)||((n=e.currency)==null?void 0:n.symbol)||""}static extractPaginationInfo(e){return e.pagination?{current_page:e.pagination.current_page||1,total_pages:e.pagination.total_pages||1,total_count:e.pagination.total_count||0,has_next:e.pagination.has_next||!1,has_prev:e.pagination.has_prev||!1}:null}}class ZB{constructor(){W(this,"dataSource");this.dataSource=new KB}async getInvoices(e,r,s,n,o,i,l){var c;try{const d=await this.dataSource.getInvoices(e,r,s,n,o,i,l);if(!d.success||!d.data)return{success:!1,error:d.error||"Failed to fetch invoices"};const u=(c=d.data.currency)==null?void 0:c.symbol;return{success:!0,data:QB.fromJsonArray(d.data.invoices,u),pagination:d.data.pagination}}catch(d){return console.error(" Repository error fetching invoices:",d),{success:!1,error:d instanceof Error?d.message:"Failed to fetch invoices"}}}async getInvoiceDetail(e){try{const r=await this.dataSource.getInvoiceDetail(e);return!r.success||!r.data?{success:!1,error:r.error||"Failed to fetch invoice detail"}:{success:!0,data:r.data,message:r.message}}catch(r){return console.error(" Repository error fetching invoice detail:",r),{success:!1,error:r instanceof Error?r.message:"Failed to fetch invoice detail"}}}async refundInvoice(e,r,s){try{const n=await this.dataSource.refundInvoice(e,r,s);return n.success?{success:!0,message:n.message||"Invoice refunded successfully"}:{success:!1,error:n.error||"Failed to refund invoice"}}catch(n){return console.error(" Repository error refunding invoice:",n),{success:!1,error:n instanceof Error?n.message:"Failed to refund invoice"}}}}const Tu=new ZB,U_=()=>{const t=new Date;return{start:new Date(t.getFullYear()-10,0,1).toISOString().split("T")[0],end:t.toISOString().split("T")[0]}},xt=Jt((t,e)=>({invoices:[],selectedInvoice:null,invoiceDetail:null,loading:!0,detailLoading:!1,refunding:!1,error:null,selectedStoreId:localStorage.getItem("storeChoosen")||null,currentPage:1,itemsPerPage:20,searchQuery:"",dateRange:U_(),activeFilter:"all",pagination:null,setInvoices:r=>t({invoices:r}),setSelectedInvoice:r=>t({selectedInvoice:r}),setInvoiceDetail:r=>t({invoiceDetail:r}),setSelectedStoreId:r=>{t({selectedStoreId:r}),r?localStorage.setItem("storeChoosen",r):localStorage.removeItem("storeChoosen")},setActiveFilter:r=>t({activeFilter:r}),setLoading:r=>t({loading:r}),setDetailLoading:r=>t({detailLoading:r}),setRefunding:r=>t({refunding:r}),setError:r=>t({error:r}),setPagination:r=>t({pagination:r}),changeDateRange:(r,s)=>{t({dateRange:{start:r,end:s},currentPage:1})},changeSearch:r=>{t({searchQuery:r,currentPage:1})},changePage:r=>{t({currentPage:r})},loadInvoices:async r=>{var n;const s=e();console.log(" InvoiceProvider.loadInvoices - starting...",{companyId:r,storeId:s.selectedStoreId,currentPage:s.currentPage,searchQuery:s.searchQuery,dateRange:s.dateRange}),t({loading:!0,error:null});try{const o=await Tu.getInvoices(r,s.selectedStoreId,s.currentPage,s.itemsPerPage,s.searchQuery||null,s.dateRange.start,s.dateRange.end);if(console.log(" InvoiceProvider.loadInvoices - result:",o),!o.success){console.log(" InvoiceProvider - Result not successful:",o.error),t({error:o.error||"Failed to load invoices",invoices:[],pagination:null});return}console.log(" InvoiceProvider - Setting invoices:",((n=o.data)==null?void 0:n.length)||0),t({invoices:o.data||[],pagination:o.pagination||null,error:null})}catch(o){console.error(" InvoiceProvider.loadInvoices - error:",o),t({error:o instanceof Error?o.message:"An unexpected error occurred",invoices:[],pagination:null})}finally{t({loading:!1})}},fetchInvoiceDetail:async r=>{console.log(" InvoiceProvider.fetchInvoiceDetail - starting...",{invoiceId:r}),t({detailLoading:!0});try{const s=await Tu.getInvoiceDetail(r);if(!s.success){console.error(" InvoiceProvider.fetchInvoiceDetail - failed:",s.error),t({invoiceDetail:null});return}console.log(" InvoiceProvider.fetchInvoiceDetail - success"),t({invoiceDetail:s.data||null})}catch(s){console.error(" InvoiceProvider.fetchInvoiceDetail - error:",s),t({invoiceDetail:null})}finally{t({detailLoading:!1})}},refundInvoice:async(r,s,n)=>{console.log(" InvoiceProvider.refundInvoice - starting...",{invoiceId:r,refundReason:s}),t({refunding:!0});try{const o=await Tu.refundInvoice(r,s,n);return o.success?(console.log(" InvoiceProvider.refundInvoice - success"),{success:!0,message:o.message||"Invoice refunded successfully"}):(console.error(" InvoiceProvider.refundInvoice - failed:",o.error),{success:!1,error:o.error||"Failed to refund invoice"})}catch(o){return console.error(" InvoiceProvider.refundInvoice - error:",o),{success:!1,error:o instanceof Error?o.message:"An unexpected error occurred"}}finally{t({refunding:!1})}},refresh:async r=>{console.log(" InvoiceProvider.refresh - reloading invoices..."),await e().loadInvoices(r)},clearDetail:()=>{t({invoiceDetail:null,selectedInvoice:null})},reset:()=>{t({invoices:[],selectedInvoice:null,invoiceDetail:null,loading:!0,detailLoading:!1,refunding:!1,error:null,currentPage:1,searchQuery:"",dateRange:U_(),activeFilter:"all",pagination:null})}})),XB=t=>{const e=xt(T=>T.invoices),r=xt(T=>T.loading),s=xt(T=>T.error),n=xt(T=>T.pagination),o=xt(T=>T.currentPage),i=xt(T=>T.searchQuery),l=xt(T=>T.dateRange),c=xt(T=>T.selectedStoreId),d=xt(T=>T.activeFilter),u=xt(T=>T.selectedInvoice),h=xt(T=>T.invoiceDetail),f=xt(T=>T.detailLoading),p=xt(T=>T.refunding),g=xt(T=>T.setSelectedStoreId),y=xt(T=>T.setActiveFilter),x=xt(T=>T.setSelectedInvoice),m=xt(T=>T.changeDateRange),_=xt(T=>T.changeSearch),v=xt(T=>T.changePage),w=xt(T=>T.loadInvoices),S=xt(T=>T.fetchInvoiceDetail),E=xt(T=>T.refundInvoice),C=xt(T=>T.refresh),k=xt(T=>T.clearDetail);return b.useEffect(()=>{t&&t!==""?(console.log(" useInvoice - useEffect triggered, loading invoices..."),w(t)):console.log(" useInvoice - No companyId, skipping load")},[t,c,o,i,l,w]),{invoices:e,loading:r,error:s,pagination:n,currentPage:o,searchQuery:i,dateRange:l,selectedStoreId:c,activeFilter:d,selectedInvoice:u,invoiceDetail:h,detailLoading:f,refunding:p,setSelectedStoreId:T=>{console.log(" useInvoice.handleStoreChange - storeId:",T),g(T)},setActiveFilter:y,setSelectedInvoice:x,changeDateRange:(T,j,M)=>{console.log(" useInvoice.handleDateFilterChange:",{filter:T,start:j,end:M}),y(T),m(j,M)},changeSearch:_,changePage:v,fetchInvoiceDetail:S,refundInvoice:E,refresh:()=>{console.log(" useInvoice.handleRefresh - reloading..."),C(t)},clearDetail:k}},eH="_container_1t3z8_5",tH="_tabsWrapper_1t3z8_10",rH="_tab_1t3z8_10",sH="_active_1t3z8_35",nH="_customPicker_1t3z8_47",oH="_customPickerContent_1t3z8_60",aH="_customPickerHeader_1t3z8_68",iH="_closeButton_1t3z8_83",lH="_customPickerBody_1t3z8_104",cH="_dateInput_1t3z8_111",dH="_customPickerFooter_1t3z8_139",uH="_cancelButton_1t3z8_147",hH="_applyButton_1t3z8_148",Hr={container:eH,tabsWrapper:tH,tab:rH,active:sH,customPicker:nH,customPickerContent:oH,customPickerHeader:aH,closeButton:iH,customPickerBody:lH,dateInput:cH,customPickerFooter:dH,cancelButton:uH,applyButton:hH},fH=({activeFilter:t,onFilterChange:e})=>{const[r,s]=b.useState(!1),[n,o]=b.useState(""),[i,l]=b.useState(""),c=f=>{if(f==="custom"){s(!0);return}const{start:p,end:g}=d(f);e(f,p,g)},d=f=>{const p=new Date;let g,y=new Date(p);switch(f){case"all":g=new Date(p.getFullYear()-10,0,1);break;case"today":g=new Date(p);break;case"yesterday":g=new Date(p),g.setDate(p.getDate()-1),y=new Date(g);break;case"this-week":g=new Date(p);const x=p.getDay(),m=x===0?-6:1-x;g.setDate(p.getDate()+m);break;case"this-month":g=new Date(p.getFullYear(),p.getMonth(),1);break;case"last-month":g=new Date(p.getFullYear(),p.getMonth()-1,1),y=new Date(p.getFullYear(),p.getMonth(),0);break;default:g=new Date(p)}return{start:te.toDateOnly(g),end:te.toDateOnly(y)}},u=()=>{n&&i&&(e("custom",n,i),s(!1))},h=[{id:"all",label:"All"},{id:"today",label:"Today"},{id:"yesterday",label:"Yesterday"},{id:"this-week",label:"This Week"},{id:"this-month",label:"This Month"},{id:"last-month",label:"Last Month"},{id:"custom",label:"Custom Range"}];return a.jsxs("div",{className:Hr.container,children:[a.jsx("div",{className:Hr.tabsWrapper,children:h.map(f=>a.jsx("button",{className:`${Hr.tab} ${t===f.id?Hr.active:""}`,onClick:()=>c(f.id),children:f.label},f.id))}),r&&a.jsx("div",{className:Hr.customPicker,children:a.jsxs("div",{className:Hr.customPickerContent,children:[a.jsxs("div",{className:Hr.customPickerHeader,children:[a.jsx("h3",{children:"Custom Date Range"}),a.jsx("button",{className:Hr.closeButton,onClick:()=>s(!1),children:""})]}),a.jsxs("div",{className:Hr.customPickerBody,children:[a.jsxs("div",{className:Hr.dateInput,children:[a.jsx("label",{children:"Start Date"}),a.jsx("input",{type:"date",value:n,onChange:f=>o(f.target.value)})]}),a.jsxs("div",{className:Hr.dateInput,children:[a.jsx("label",{children:"End Date"}),a.jsx("input",{type:"date",value:i,onChange:f=>l(f.target.value)})]})]}),a.jsxs("div",{className:Hr.customPickerFooter,children:[a.jsx("button",{className:Hr.cancelButton,onClick:()=>s(!1),children:"Cancel"}),a.jsx("button",{className:Hr.applyButton,onClick:u,disabled:!n||!i,children:"Apply"})]})]})})]})},mH="_container_o9ro1_5",pH="_header_o9ro1_14",gH="_headerLeft_o9ro1_23",_H="_headerActions_o9ro1_28",yH="_title_o9ro1_34",vH="_subtitle_o9ro1_41",xH="_controlsContainer_o9ro1_48",bH="_dateFilterContainer_o9ro1_58",wH="_searchFilterBar_o9ro1_68",SH="_searchInputWrapper_o9ro1_77",CH="_searchInput_o9ro1_77",jH="_searchIcon_o9ro1_100",kH="_invoiceTableContainer_o9ro1_111",NH="_invoiceTable_o9ro1_111",IH="_invoiceNumber_o9ro1_159",EH="_invoiceDate_o9ro1_166",TH="_customerCell_o9ro1_173",AH="_customerName_o9ro1_177",LH="_customerPhone_o9ro1_184",DH="_itemsCell_o9ro1_190",MH="_itemCount_o9ro1_194",RH="_itemQty_o9ro1_200",OH="_paymentCell_o9ro1_206",PH="_paymentBadge_o9ro1_210",$H="_paymentPaid_o9ro1_219",FH="_paymentPending_o9ro1_225",BH="_totalCell_o9ro1_231",HH="_statusCell_o9ro1_240",VH="_statusBadge_o9ro1_244",zH="_draft_o9ro1_253",UH="_issued_o9ro1_258",WH="_paid_o9ro1_263",qH="_completed_o9ro1_264",GH="_cancelled_o9ro1_269",JH="_actionsCell_o9ro1_275",KH="_actionBtn_o9ro1_280",YH="_emptyState_o9ro1_305",QH="_emptyIcon_o9ro1_312",ZH="_emptyTitle_o9ro1_319",XH="_emptyText_o9ro1_326",eV="_loadingState_o9ro1_332",tV="_spinner_o9ro1_339",rV="_pulse_o9ro1_1",sV="_errorContainer_o9ro1_354",nV="_errorIcon_o9ro1_364",oV="_errorTitle_o9ro1_371",aV="_errorMessage_o9ro1_378",iV="_pagination_o9ro1_385",lV="_paginationInfo_o9ro1_396",cV="_modalOverlay_o9ro1_461",dV="_fadeIn_o9ro1_1",uV="_modalContent_o9ro1_484",hV="_slideUp_o9ro1_1",fV="_modalHeader_o9ro1_506",mV="_modalTitle_o9ro1_514",pV="_modalSubtitle_o9ro1_521",gV="_modalCloseBtn_o9ro1_527",_V="_modalBody_o9ro1_545",yV="_modalSummary_o9ro1_551",vV="_summaryLabel_o9ro1_561",xV="_summaryAmount_o9ro1_569",bV="_modalSection_o9ro1_577",wV="_sectionHeader_o9ro1_584",SV="_sectionTitle_o9ro1_592",CV="_sectionContent_o9ro1_599",jV="_sectionSubtext_o9ro1_606",kV="_sectionRow_o9ro1_612",NV="_itemsTable_o9ro1_619",IV="_paymentAmountsRow_o9ro1_664",EV="_paymentInfo_o9ro1_671",TV="_amountSummary_o9ro1_672",AV="_paymentRow_o9ro1_676",LV="_amountRow_o9ro1_677",DV="_paymentValue_o9ro1_690",MV="_totalRow_o9ro1_701",RV="_inventoryTable_o9ro1_715",OV="_negative_o9ro1_759",PV="_positive_o9ro1_764",$V="_modalActions_o9ro1_770",V={container:mH,header:pH,headerLeft:gH,headerActions:_H,title:yH,subtitle:vH,controlsContainer:xH,dateFilterContainer:bH,searchFilterBar:wH,searchInputWrapper:SH,searchInput:CH,searchIcon:jH,invoiceTableContainer:kH,invoiceTable:NH,invoiceNumber:IH,invoiceDate:EH,customerCell:TH,customerName:AH,customerPhone:LH,itemsCell:DH,itemCount:MH,itemQty:RH,paymentCell:OH,paymentBadge:PH,"payment-paid":"_payment-paid_o9ro1_218",paymentPaid:$H,"payment-pending":"_payment-pending_o9ro1_224",paymentPending:FH,totalCell:BH,statusCell:HH,statusBadge:VH,draft:zH,issued:UH,paid:WH,completed:qH,cancelled:GH,actionsCell:JH,actionBtn:KH,emptyState:YH,emptyIcon:QH,emptyTitle:ZH,emptyText:XH,loadingState:eV,spinner:tV,pulse:rV,errorContainer:sV,errorIcon:nV,errorTitle:oV,errorMessage:aV,pagination:iV,paginationInfo:lV,modalOverlay:cV,fadeIn:dV,modalContent:uV,slideUp:hV,modalHeader:fV,modalTitle:mV,modalSubtitle:pV,modalCloseBtn:gV,modalBody:_V,modalSummary:yV,summaryLabel:vV,summaryAmount:xV,modalSection:bV,sectionHeader:wV,sectionTitle:SV,sectionContent:CV,sectionSubtext:jV,sectionRow:kV,itemsTable:NV,paymentAmountsRow:IV,paymentInfo:EV,amountSummary:TV,paymentRow:AV,amountRow:LV,paymentValue:DV,totalRow:MV,inventoryTable:RV,negative:OV,positive:PV,modalActions:$V},FV=()=>{var M;const{currentCompany:t}=at(),{messageState:e,closeMessage:r,showError:s,showSuccess:n}=Es(),o=(t==null?void 0:t.company_id)||"",{invoices:i,loading:l,error:c,pagination:d,currentPage:u,searchQuery:h,selectedStoreId:f,activeFilter:p,selectedInvoice:g,invoiceDetail:y,detailLoading:x,refunding:m,setSelectedStoreId:_,setSelectedInvoice:v,changeDateRange:w,changeSearch:S,changePage:E,fetchInvoiceDetail:C,refundInvoice:k,refresh:N,clearDetail:I}=XB(o);b.useEffect(()=>{g!=null&&g.invoiceId&&C(g.invoiceId)},[g,C]);const L=()=>{I()},T=async()=>{if(!(!g||!y||!window.confirm(`Are you sure you want to refund invoice ${g.invoiceNumber}?

Total Amount: ${g.formatCurrency(y.amounts.total_amount)}

This action will:
- Reverse the payment
- Restore inventory quantities
- Mark the invoice as refunded

This action cannot be undone.`)))try{const O=await k(g.invoiceId);O.success?(n({message:O.message||"Invoice refunded successfully",autoCloseDuration:3e3}),L(),N()):s({title:"Refund Failed",message:O.error||"Failed to refund invoice. Please try again."})}catch(O){s({title:"Refund Error",message:O instanceof Error?O.message:"An unexpected error occurred"})}};console.log(" InvoicePage - render with:",{companyId:o,selectedStoreId:f,storesCount:((M=t==null?void 0:t.stores)==null?void 0:M.length)||0});const j=(t==null?void 0:t.stores)||[];return o?l?a.jsxs(a.Fragment,{children:[a.jsx(fe,{activeItem:"product"}),a.jsxs("div",{className:V.container,children:[a.jsx("div",{className:V.header,children:a.jsx("div",{className:V.headerLeft,children:a.jsx("h1",{className:V.title,children:"Invoices"})})}),a.jsx(Ne,{fullscreen:!0,size:"large"})]})]}):c?a.jsxs(a.Fragment,{children:[a.jsx(fe,{activeItem:"product"}),a.jsxs("div",{className:V.container,children:[a.jsx("div",{className:V.header,children:a.jsx("div",{className:V.headerLeft,children:a.jsx("h1",{className:V.title,children:"Invoices"})})}),a.jsxs("div",{className:V.errorContainer,children:[a.jsxs("svg",{className:V.errorIcon,width:"120",height:"120",viewBox:"0 0 120 120",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[a.jsx("circle",{cx:"60",cy:"60",r:"50",fill:"#FFEFED"}),a.jsx("circle",{cx:"60",cy:"60",r:"30",fill:"#FF5847"}),a.jsx("path",{d:"M60 45 L60 65",stroke:"white",strokeWidth:"4",strokeLinecap:"round"}),a.jsx("circle",{cx:"60",cy:"73",r:"2.5",fill:"white"}),a.jsx("rect",{x:"40",y:"25",width:"40",height:"50",rx:"4",fill:"white",stroke:"#FF5847",strokeWidth:"2"})]}),a.jsx("h2",{className:V.errorTitle,children:"Failed to Load Invoices"}),a.jsx("p",{className:V.errorMessage,children:c}),a.jsx(be,{onClick:N,variant:"primary",children:"Try Again"})]})]})]}):a.jsxs(a.Fragment,{children:[a.jsx(fe,{activeItem:"product"}),a.jsxs("div",{className:V.container,children:[a.jsxs("div",{className:V.header,children:[a.jsxs("div",{className:V.headerLeft,children:[a.jsx("h1",{className:V.title,children:"Invoices"}),a.jsx("p",{className:V.subtitle,children:"Manage billing and payment records"})]}),a.jsxs("div",{className:V.headerActions,children:[a.jsxs(be,{variant:"secondary",size:"md",children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor",style:{marginRight:"8px"},children:a.jsx("path",{d:"M14,13V17H10V13H7L12,8L17,13M19.35,10.03C18.67,6.59 15.64,4 12,4C9.11,4 6.6,5.64 5.35,8.03C2.34,8.36 0,10.9 0,14A6,6 0 0,0 6,20H19A5,5 0 0,0 24,15C24,12.36 21.95,10.22 19.35,10.03Z"})}),"Export"]}),a.jsxs(be,{variant:"primary",size:"md",children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor",style:{marginRight:"8px"},children:a.jsx("path",{d:"M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"})}),"New Invoice"]})]})]}),a.jsx("div",{className:V.controlsContainer,children:a.jsx(Hs,{stores:j,selectedStoreId:f,onStoreSelect:_,companyId:o,width:"280px"})}),a.jsx("div",{className:V.dateFilterContainer,children:a.jsx(fH,{activeFilter:p,onFilterChange:w})}),a.jsx("div",{className:V.searchFilterBar,children:a.jsxs("div",{className:V.searchInputWrapper,children:[a.jsx("svg",{className:V.searchIcon,viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"})}),a.jsx("input",{type:"text",className:V.searchInput,placeholder:"Search by invoice number, customer, or amount...",value:h,onChange:R=>S(R.target.value)})]})}),i.length===0?a.jsxs("div",{className:V.emptyState,children:[a.jsxs("svg",{className:V.emptyIcon,width:"120",height:"120",viewBox:"0 0 120 120",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[a.jsx("circle",{cx:"60",cy:"60",r:"50",fill:"#F0F6FF"}),a.jsx("rect",{x:"35",y:"40",width:"50",height:"60",rx:"4",fill:"white",stroke:"#0064FF",strokeWidth:"2"}),a.jsx("rect",{x:"40",y:"35",width:"50",height:"60",rx:"4",fill:"white",stroke:"#0064FF",strokeWidth:"2"}),a.jsx("line",{x1:"48",y1:"45",x2:"75",y2:"45",stroke:"#E9ECEF",strokeWidth:"2",strokeLinecap:"round"}),a.jsx("line",{x1:"48",y1:"52",x2:"70",y2:"52",stroke:"#E9ECEF",strokeWidth:"2",strokeLinecap:"round"}),a.jsx("line",{x1:"48",y1:"59",x2:"72",y2:"59",stroke:"#E9ECEF",strokeWidth:"2",strokeLinecap:"round"}),a.jsx("circle",{cx:"60",cy:"75",r:"12",fill:"#0064FF"}),a.jsx("path",{d:"M56 75 L58 77 L64 71",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),a.jsx("h3",{className:V.emptyTitle,children:"No Invoices"}),a.jsx("p",{className:V.emptyText,children:"No invoice records found for the selected period"})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:V.invoiceTableContainer,children:a.jsxs("table",{className:V.invoiceTable,children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"INVOICE #"}),a.jsx("th",{children:"DATE"}),a.jsx("th",{children:"CUSTOMER"}),a.jsx("th",{children:"ITEMS"}),a.jsx("th",{children:"PAYMENT"}),a.jsx("th",{children:"TOTAL"}),a.jsx("th",{children:"STATUS"}),a.jsx("th",{children:"ACTIONS"})]})}),a.jsx("tbody",{children:i.map(R=>a.jsxs("tr",{className:V.invoiceRow,onClick:()=>v(R),style:{cursor:"pointer"},children:[a.jsx("td",{className:V.invoiceNumber,children:R.invoiceNumber}),a.jsx("td",{className:V.invoiceDate,children:R.formattedDate}),a.jsx("td",{className:V.customerCell,children:R.customerName}),a.jsxs("td",{className:V.itemsCell,children:[a.jsxs("div",{className:V.itemCount,children:[R.itemCount," items"]}),a.jsxs("div",{className:V.itemQty,children:["Qty: ",R.totalQuantity]})]}),a.jsx("td",{className:V.paymentCell,children:a.jsx("span",{className:`${V.paymentBadge} ${V[R.paymentBadgeClass]}`,children:R.paymentMethodDisplay})}),a.jsx("td",{className:V.totalCell,children:R.formatCurrency(R.totalAmount)}),a.jsx("td",{className:V.statusCell,children:a.jsx("span",{className:`${V.statusBadge} ${V[R.status]}`,children:R.statusDisplay.toUpperCase()})}),a.jsxs("td",{className:V.actionsCell,onClick:O=>O.stopPropagation(),children:[a.jsx("button",{className:V.actionBtn,title:"View",onClick:()=>v(R),children:a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9M12,17A5,5 0 0,1 7,12A5,5 0 0,1 12,7A5,5 0 0,1 17,12A5,5 0 0,1 12,17M12,4.5C7,4.5 2.73,7.61 1,12C2.73,16.39 7,19.5 12,19.5C17,19.5 21.27,16.39 23,12C21.27,7.61 17,4.5 12,4.5Z"})})}),a.jsx("button",{className:V.actionBtn,title:"Edit",children:a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z"})})}),a.jsx("button",{className:V.actionBtn,title:"Print",children:a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M18,3H6V7H18M19,12A1,1 0 0,1 18,11A1,1 0 0,1 19,10A1,1 0 0,1 20,11A1,1 0 0,1 19,12M16,19H8V14H16M19,8H5A3,3 0 0,0 2,11V17H6V21H18V17H22V11A3,3 0 0,0 19,8Z"})})})]})]},R.invoiceId))})]})}),d&&d.total_pages>1&&a.jsxs("div",{className:V.pagination,children:[a.jsx(be,{variant:"secondary",size:"sm",onClick:()=>E(u-1),disabled:!d.has_prev,children:"Previous"}),a.jsxs("div",{className:V.paginationInfo,children:["Page ",u," of ",d.total_pages," (",d.total_count," total)"]}),a.jsx(be,{variant:"secondary",size:"sm",onClick:()=>E(u+1),disabled:!d.has_next,children:"Next"})]})]}),g&&a.jsx("div",{className:V.modalOverlay,onClick:L,children:a.jsxs("div",{className:V.modalContent,onClick:R=>R.stopPropagation(),children:[a.jsxs("div",{className:V.modalHeader,children:[a.jsxs("div",{children:[a.jsx("h2",{className:V.modalTitle,children:g.invoiceNumber}),a.jsx("p",{className:V.modalSubtitle,children:g.formattedDate})]}),a.jsx("button",{className:V.modalCloseBtn,onClick:L,children:a.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"})})})]}),a.jsx("div",{className:V.modalBody,children:x?a.jsx(Ne,{fullscreen:!0,size:"large"}):y?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:V.modalSummary,children:[a.jsxs("div",{children:[a.jsx("p",{className:V.summaryLabel,children:"Total Amount"}),a.jsx("p",{className:V.summaryAmount,children:g.formatCurrency(y.amounts.total_amount)})]}),a.jsx("span",{className:`${V.statusBadge} ${V[y.invoice.status]}`,children:y.invoice.status.toUpperCase()})]}),a.jsxs("div",{className:V.modalSection,children:[a.jsxs("div",{className:V.sectionHeader,children:[a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12,2L2,7V17H4V22H20V17H22V7L12,2M11,18H6V17H11V18M11,15H6V14H11V15M11,12H6V11H11V12M11,9H6V8H11V9M18,18H13V17H18V18M18,15H13V14H18V15M18,12H13V11H18V12M18,9H13V8H18V9Z"})}),a.jsx("span",{className:V.sectionTitle,children:"Store"})]}),a.jsx("p",{className:V.sectionContent,children:y.invoice.store_name})]}),a.jsxs("div",{className:V.modalSection,children:[a.jsxs("div",{className:V.sectionHeader,children:[a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12,4A4,4 0 0,1 16,8A4,4 0 0,1 12,12A4,4 0 0,1 8,8A4,4 0 0,1 12,4M12,14C16.42,14 20,15.79 20,18V20H4V18C4,15.79 7.58,14 12,14Z"})}),a.jsx("span",{className:V.sectionTitle,children:"Customer"})]}),a.jsx("p",{className:V.sectionContent,children:y.invoice.customer_name||"Walk-in"})]}),a.jsxs("div",{className:V.modalSection,children:[a.jsxs("div",{className:V.sectionHeader,children:[a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M17,18A2,2 0 0,1 19,20A2,2 0 0,1 17,22C15.89,22 15,21.1 15,20C15,18.89 15.89,18 17,18M1,2H4.27L5.21,4H20A1,1 0 0,1 21,5C21,5.17 20.95,5.34 20.88,5.5L17.3,11.97C16.96,12.58 16.3,13 15.55,13H8.1L7.2,14.63L7.17,14.75A0.25,0.25 0 0,0 7.42,15H19V17H7C5.89,17 5,16.1 5,15C5,14.65 5.09,14.32 5.24,14.04L6.6,11.59L3,4H1V2M7,18A2,2 0 0,1 9,20A2,2 0 0,1 7,22C5.89,22 5,21.1 5,20C5,18.89 5.89,18 7,18M16,11L18.78,6H6.14L8.5,11H16Z"})}),a.jsxs("span",{className:V.sectionTitle,children:["Items (",y.items.length,")"]})]}),a.jsx("div",{className:V.itemsTable,children:a.jsxs("table",{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"PRODUCT"}),a.jsx("th",{children:"SKU"}),a.jsx("th",{children:"QTY"}),a.jsx("th",{children:"UNIT PRICE"}),a.jsx("th",{children:"DISCOUNT"}),a.jsx("th",{children:"TOTAL"})]})}),a.jsx("tbody",{children:y.items.map(R=>a.jsxs("tr",{children:[a.jsx("td",{children:R.product_name}),a.jsx("td",{children:R.sku}),a.jsx("td",{children:R.quantity_sold}),a.jsx("td",{children:g.formatCurrency(R.unit_price)}),a.jsx("td",{children:g.formatCurrency(R.discount_amount)}),a.jsx("td",{children:g.formatCurrency(R.total_amount)})]},R.item_id))})]})})]}),a.jsxs("div",{className:V.paymentAmountsRow,children:[a.jsxs("div",{className:V.modalSection,children:[a.jsxs("div",{className:V.sectionHeader,children:[a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M20,8H4V6H20M20,18H4V12H20M20,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V6C22,4.89 21.1,4 20,4Z"})}),a.jsx("span",{className:V.sectionTitle,children:"Payment Information"})]}),a.jsxs("div",{className:V.paymentInfo,children:[a.jsxs("div",{className:V.paymentRow,children:[a.jsx("span",{children:"Method:"}),a.jsx("span",{className:V.paymentValue,children:y.payment.method.toUpperCase()})]}),a.jsxs("div",{className:V.paymentRow,children:[a.jsx("span",{children:"Status:"}),a.jsx("span",{className:`${V.paymentBadge} ${y.payment.status==="paid"?V.paymentPaid:V.paymentPending}`,children:y.payment.status.toUpperCase()})]})]})]}),a.jsxs("div",{className:V.modalSection,children:[a.jsxs("div",{className:V.sectionHeader,children:[a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M7,15H9C9,16.08 10.37,17 12,17C13.63,17 15,16.08 15,15C15,13.9 13.96,13.5 11.76,12.97C9.64,12.44 7,11.78 7,9C7,7.21 8.47,5.69 10.5,5.18V3H13.5V5.18C15.53,5.69 17,7.21 17,9H15C15,7.92 13.63,7 12,7C10.37,7 9,7.92 9,9C9,10.1 10.04,10.5 12.24,11.03C14.36,11.56 17,12.22 17,15C17,16.79 15.53,18.31 13.5,18.82V21H10.5V18.82C8.47,18.31 7,16.79 7,15Z"})}),a.jsx("span",{className:V.sectionTitle,children:"Amount Summary"})]}),a.jsxs("div",{className:V.amountSummary,children:[a.jsxs("div",{className:V.amountRow,children:[a.jsx("span",{children:"Subtotal:"}),a.jsx("span",{children:g.formatCurrency(y.amounts.subtotal)})]}),a.jsxs("div",{className:V.amountRow,children:[a.jsx("span",{children:"Tax:"}),a.jsx("span",{children:g.formatCurrency(y.amounts.tax_amount)})]}),a.jsxs("div",{className:V.amountRow,children:[a.jsx("span",{children:"Discount:"}),a.jsx("span",{children:g.formatCurrency(y.amounts.discount_amount)})]}),a.jsxs("div",{className:`${V.amountRow} ${V.totalRow}`,children:[a.jsx("span",{children:"Total:"}),a.jsx("span",{children:g.formatCurrency(y.amounts.total_amount)})]})]})]})]}),y.inventory_movements&&y.inventory_movements.length>0&&a.jsxs("div",{className:V.modalSection,children:[a.jsxs("div",{className:V.sectionHeader,children:[a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M6,2V8H6V8L10,12L6,16V16H6V22H18V16H18V16L14,12L18,8V8H18V2H6M16,16.5V20H8V16.5L12,12.5L16,16.5M12,11.5L8,7.5V4H16V7.5L12,11.5Z"})}),a.jsx("span",{className:V.sectionTitle,children:"Inventory Impact"})]}),a.jsx("div",{className:V.inventoryTable,children:a.jsxs("table",{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"PRODUCT"}),a.jsx("th",{children:"QTY CHANGE"}),a.jsx("th",{children:"STOCK BEFORE"}),a.jsx("th",{children:"STOCK AFTER"})]})}),a.jsx("tbody",{children:y.inventory_movements.map((R,O)=>a.jsxs("tr",{children:[a.jsx("td",{children:R.product_name}),a.jsx("td",{className:R.quantity_change<0?V.negative:V.positive,children:R.quantity_change}),a.jsx("td",{children:R.stock_before}),a.jsx("td",{children:R.stock_after})]},O))})]})})]}),y.invoice.status==="completed"&&a.jsx("div",{className:V.modalActions,children:a.jsx(be,{variant:"error",size:"md",onClick:T,disabled:m,loading:m,children:m?"Refunding...":"Refund Invoice"})})]}):a.jsx("div",{className:V.errorContainer,children:a.jsx("p",{children:"Failed to load invoice details"})})})]})}),a.jsx(De,{variant:e.variant,title:e.title,message:e.message,isOpen:e.isOpen,onClose:r})]})]}):a.jsxs(a.Fragment,{children:[a.jsx(fe,{activeItem:"product"}),a.jsx("div",{className:V.container,children:a.jsx(Ne,{fullscreen:!0,size:"large"})})]})};let ro=class dc{constructor(e,r,s,n){this.companyId=e,this.storeId=r,this.date=s,this.transactionLines=n}get totalDebits(){return this.transactionLines.filter(e=>e.isDebit).reduce((e,r)=>e+r.amount,0)}get totalCredits(){return this.transactionLines.filter(e=>!e.isDebit).reduce((e,r)=>e+r.amount,0)}get debitCount(){return this.transactionLines.filter(e=>e.isDebit).length}get creditCount(){return this.transactionLines.filter(e=>!e.isDebit).length}get difference(){return this.totalDebits-this.totalCredits}get isBalanced(){return Math.abs(this.difference)<.01}canSubmit(){return this.isBalanced&&this.transactionLines.length>=2&&this.transactionLines.every(e=>e.isValid)}getCashLocationId(){const e=this.transactionLines.find(r=>r.cashLocationId!==null);return e?e.cashLocationId:null}hasCashLocation(){return this.getCashLocationId()!==null}addTransactionLine(e){return new dc(this.companyId,this.storeId,this.date,[...this.transactionLines,e])}updateTransactionLine(e,r){const s=[...this.transactionLines];return s[e]=r,new dc(this.companyId,this.storeId,this.date,s)}removeTransactionLine(e){const r=this.transactionLines.filter((s,n)=>n!==e);return new dc(this.companyId,this.storeId,this.date,r)}};class BV{async getAccounts(){const e=ne.getClient(),{data:r,error:s}=await e.rpc("get_accounts");if(s)throw console.error("Error fetching accounts:",s),new Error(s.message);return r||[]}async getCashLocations(e,r){const s=ne.getClient(),n={p_company_id:e};r&&(n.p_store_id=r);const{data:o,error:i}=await s.rpc("get_cash_locations",n);if(i)throw console.error("Error fetching cash locations:",i),new Error(i.message);return o||[]}async getCounterparties(e){const r=ne.getClient(),{data:s,error:n}=await r.from("counterparties").select("counterparty_id, name, type, is_internal, linked_company_id, email, phone").eq("company_id",e).order("name");if(n)throw console.error("Error fetching counterparties:",n),new Error(n.message);return s||[]}async checkAccountMapping(e){const r=ne.getClient(),{data:s,error:n}=await r.from("account_mappings").select("my_account_id, linked_account_id, direction").eq("my_company_id",e.companyId).eq("counterparty_id",e.counterpartyId).eq("my_account_id",e.accountId).maybeSingle();return n?(console.error("Error checking account mapping:",n),null):s}async getCounterpartyStores(e){const r=ne.getClient(),{data:s,error:n}=await r.from("stores").select("store_id, store_name").eq("company_id",e).order("store_name");if(n)throw console.error("Error fetching counterparty stores:",n),new Error(n.message);return s||[]}async submitJournalEntry(e){var p;const r=ne.getClient(),s=e.transactionLines.filter(g=>g.isDebit).reduce((g,y)=>g+y.amount,0),n=e.transactionLines.map(g=>{const y={account_id:g.accountId,description:g.description,debit:g.isDebit?g.amount.toString():"0",credit:g.isDebit?"0":g.amount.toString()};if(g.cashLocationId&&(y.cash={cash_location_id:g.cashLocationId}),g.counterpartyId){const x=new Date,m=g.issueDate?new Date(g.issueDate):x,_=g.dueDate?new Date(g.dueDate):new Date(x.getTime()+30*24*60*60*1e3);y.debt={counterparty_id:g.counterpartyId,direction:g.isDebit?"receivable":"payable",category:g.debtCategory||"other",original_amount:g.amount.toString(),interest_rate:(g.interestRate||0).toString(),interest_account_id:g.interestAccountId||"",interest_due_day:g.interestDueDay||0,issue_date:m.toISOString().split("T")[0],due_date:_.toISOString().split("T")[0],description:g.debtDescription||"",linkedCounterparty_store_id:g.counterpartyStoreId||"",linkedCounterparty_companyId:g.linkedCompanyId||""}}return y});let o;if(e.date instanceof Date)o=e.date;else{const g=new Date,[y,x,m]=e.date.split("-").map(Number);o=new Date(y,x-1,m,g.getHours(),g.getMinutes(),g.getSeconds())}const i=te.toRpcFormat(o),l=((p=e.transactionLines.find(g=>g.counterpartyId))==null?void 0:p.counterpartyId)||null,c=e.transactionLines.find(g=>g.counterpartyId&&g.linkedCompanyId),d=(c==null?void 0:c.counterpartyCashLocationId)||null,u={p_base_amount:s,p_company_id:e.companyId,p_created_by:e.createdBy,p_description:e.description,p_entry_date:i,p_lines:n,p_store_id:e.storeId,p_counterparty_id:l,p_if_cash_location_id:d};console.log("=== RPC Parameters ==="),console.log("p_lines:",JSON.stringify(n,null,2)),console.log("Full params:",JSON.stringify(u,null,2));const{data:h,error:f}=await r.rpc("insert_journal_with_everything",u);if(f){console.error("Error submitting journal entry:",f),console.error("Error details:",JSON.stringify(f,null,2));let g=f.message;throw g.includes(" ")||g.includes("credit")||g.includes("debit")?g="Invalid transaction line format. Please check debit and credit values.":(g.includes("")||g.includes(""))&&(g="Journal entry validation failed. Please check all required fields."),new Error(g)}return{journal_id:h}}}class HV{static fromJson(e){return{accountId:e.id,accountName:e.name,categoryTag:e.categoryTag,accountType:e.type,expenseNature:e.expenseNature}}static toJson(e){return{id:e.accountId,name:e.accountName,categoryTag:e.categoryTag,type:e.accountType,expenseNature:e.expenseNature}}}class VV{static fromJson(e){return{locationId:e.id,locationName:e.name,locationType:e.type,storeId:e.storeId,isCompanyWide:e.isCompanyWide}}static toJson(e){return{id:e.locationId,name:e.locationName,type:e.locationType,storeId:e.storeId,isCompanyWide:e.isCompanyWide}}}let zV=class{static fromJson(e){return{counterpartyId:e.counterparty_id||e.id,counterpartyName:e.name,type:e.type,isInternal:e.is_internal??e.isInternal??!1,email:e.email,phone:e.phone,linkedCompanyId:e.linked_company_id||e.linkedCompanyId||null}}static toJson(e){return{id:e.counterpartyId,name:e.counterpartyName,type:e.type,isInternal:e.isInternal,email:e.email,phone:e.phone,linkedCompanyId:e.linkedCompanyId}}};class vx{constructor(){W(this,"dataSource");this.dataSource=new BV}async getAccounts(e){try{return(await this.dataSource.getAccounts()).map(HV.fromJson)}catch(r){return console.error("Repository error fetching accounts:",r),[]}}async getCashLocations(e,r){try{return(await this.dataSource.getCashLocations(e,r)).map(VV.fromJson)}catch(s){return console.error("Repository error fetching cash locations:",s),[]}}async getCounterparties(e){try{const r=await this.dataSource.getCounterparties(e);console.log("Raw counterparty data from datasource:",r);const s=r.map(zV.fromJson);return console.log("Mapped counterparty data:",s),s}catch(r){return console.error("Repository error fetching counterparties:",r),[]}}async checkAccountMapping(e,r,s){try{const n=await this.dataSource.checkAccountMapping({companyId:e,counterpartyId:r,accountId:s});return n?{myAccountId:n.my_account_id,linkedAccountId:n.linked_account_id,direction:n.direction}:null}catch(n){return console.error("Repository error checking account mapping:",n),null}}async getCounterpartyStores(e){try{return(await this.dataSource.getCounterpartyStores(e)).map(s=>({storeId:s.store_id,storeName:s.store_name}))}catch(r){return console.error("Repository error fetching counterparty stores:",r),[]}}async submitJournalEntry(e,r,s){try{const n=await this.dataSource.submitJournalEntry({companyId:e.companyId,storeId:e.storeId,date:e.date,createdBy:r,description:s||`Journal entry for ${e.date}`,transactionLines:e.transactionLines.map(o=>({isDebit:o.isDebit,accountId:o.accountId,amount:o.amount,description:o.description,cashLocationId:o.cashLocationId,counterpartyId:o.counterpartyId,counterpartyStoreId:o.counterpartyStoreId,debtCategory:o.debtCategory,interestRate:o.interestRate,interestAccountId:o.interestAccountId,interestDueDay:o.interestDueDay,issueDate:o.issueDate,dueDate:o.dueDate,debtDescription:o.debtDescription,linkedCompanyId:o.linkedCompanyId,counterpartyCashLocationId:o.counterpartyCashLocationId}))});return{success:!0,journalId:n==null?void 0:n.journal_id}}catch(n){return console.error("Repository error submitting journal entry:",n),{success:!1,error:n instanceof Error?n.message:"Failed to submit journal entry"}}}}class Ga{static today(){const e=new Date,r=e.getFullYear(),s=String(e.getMonth()+1).padStart(2,"0"),n=String(e.getDate()).padStart(2,"0");return`${r}-${s}-${n}`}static toDateOnly(e){const r=e.getFullYear(),s=String(e.getMonth()+1).padStart(2,"0"),n=String(e.getDate()).padStart(2,"0");return`${r}-${s}-${n}`}static toRpcFormat(e){const[r,s,n]=e.split("-").map(Number);return new Date(Date.UTC(r,s-1,n,0,0,0,0)).toISOString().replace("T"," ").split(".")[0]}static isValid(e){if(!e||e.trim()===""||!/^\d{4}-\d{2}-\d{2}$/.test(e))return!1;const s=new Date(e);return!isNaN(s.getTime())}static formatDisplay(e){const r=new Date(e);return new Intl.DateTimeFormat("en-US",{year:"numeric",month:"long",day:"numeric"}).format(r)}static formatDisplayKo(e){const r=new Date(e);return new Intl.DateTimeFormat("ko-KR",{year:"numeric",month:"long",day:"numeric"}).format(r)}}const Gn=new vx,Qt=Jt((t,e)=>({journalEntry:new ro("",null,Ga.today(),[]),companyId:"",storeId:null,userId:"",accounts:[],cashLocations:[],counterparties:[],loading:!1,submitting:!1,error:null,setJournalEntry:r=>t({journalEntry:r}),setAccounts:r=>t({accounts:r}),setCashLocations:r=>t({cashLocations:r}),setCounterparties:r=>t({counterparties:r}),addTransactionLine:r=>{const n=e().journalEntry.addTransactionLine(r);t({journalEntry:n})},updateTransactionLine:(r,s)=>{const o=e().journalEntry.updateTransactionLine(r,s);t({journalEntry:o})},removeTransactionLine:r=>{const n=e().journalEntry.removeTransactionLine(r);t({journalEntry:n})},changeJournalDate:r=>{const s=e(),n=new ro(s.journalEntry.companyId,s.journalEntry.storeId,r,s.journalEntry.transactionLines);t({journalEntry:n})},resetJournalEntry:r=>{const s=e(),n=new ro(s.companyId,r,Ga.today(),[]);t({journalEntry:n,storeId:r})},loadInitialData:async()=>{const r=e();t({loading:!0,error:null});try{const[s,n,o]=await Promise.all([Gn.getAccounts(r.companyId),Gn.getCashLocations(r.companyId,r.storeId),Gn.getCounterparties(r.companyId)]);t({accounts:s,cashLocations:n,counterparties:o,loading:!1})}catch{t({loading:!1})}},submitJournalEntry:async r=>{const s=e();if(!s.journalEntry.canSubmit())return{success:!1,error:"Journal entry must be balanced with at least 2 transaction lines"};t({submitting:!0,error:null});try{const n=await Gn.submitJournalEntry(s.journalEntry,s.userId,r);if(n.success){const o=new ro(s.companyId,s.storeId,Ga.today(),[]);t({journalEntry:o,submitting:!1})}else t({submitting:!1,error:n.error});return n}catch(n){const o=n instanceof Error?n.message:"Failed to submit journal entry";return t({submitting:!1,error:o}),{success:!1,error:o}}},checkAccountMapping:async(r,s,n)=>{try{return await Gn.checkAccountMapping(r,s,n)!==null}catch{return!1}},getCounterpartyStores:async r=>{try{return await Gn.getCounterpartyStores(r)}catch{return[]}},getCounterpartyCashLocations:async(r,s)=>{try{return await Gn.getCashLocations(r,s)}catch{return[]}},reset:()=>{const r=e();t({journalEntry:new ro(r.companyId,r.storeId,Ga.today(),[]),loading:!1,submitting:!1,error:null})}})),UV=(t,e,r)=>{const s=Qt(S=>S.journalEntry),n=Qt(S=>S.accounts),o=Qt(S=>S.cashLocations),i=Qt(S=>S.counterparties),l=Qt(S=>S.loading),c=Qt(S=>S.submitting),d=Qt(S=>S.error),u=Qt(S=>S.setJournalEntry),h=Qt(S=>S.addTransactionLine),f=Qt(S=>S.updateTransactionLine),p=Qt(S=>S.removeTransactionLine),g=Qt(S=>S.changeJournalDate),y=Qt(S=>S.resetJournalEntry),x=Qt(S=>S.submitJournalEntry),m=Qt(S=>S.checkAccountMapping),_=Qt(S=>S.getCounterpartyStores),v=Qt(S=>S.getCounterpartyCashLocations),w=Qt(S=>S.loadInitialData);return b.useEffect(()=>{Qt.setState({companyId:t,storeId:e,userId:r,journalEntry:new ro(t,e,Ga.today(),[])}),t&&w()},[t,e,r,w]),{journalEntry:s,accounts:n,cashLocations:o,counterparties:i,loading:l,submitting:c,error:d,setJournalEntry:u,addTransactionLine:h,updateTransactionLine:f,removeTransactionLine:p,changeJournalDate:g,resetJournalEntry:y,submitJournalEntry:x,checkAccountMapping:m,getCounterpartyStores:_,getCounterpartyCashLocations:v}};class xx{constructor(e,r,s,n,o,i,l,c,d,u,h,f,p,g,y=null,x=null,m=null,_=null,v=null,w=null,S=null,E=null){this.isDebit=e,this.accountId=r,this.accountName=s,this.amount=n,this.description=o,this.categoryTag=i,this.cashLocationId=l,this.cashLocationName=c,this.cashLocationType=d,this.counterpartyId=u,this.counterpartyName=h,this.counterpartyStoreId=f,this.counterpartyStoreName=p,this.debtCategory=g,this.interestRate=y,this.interestAccountId=x,this.interestDueDay=m,this.issueDate=_,this.dueDate=v,this.debtDescription=w,this.linkedCompanyId=S,this.counterpartyCashLocationId=E}get typeDisplay(){return this.isDebit?"DEBIT":"CREDIT"}get isValid(){return!!(this.accountId&&this.amount>0)}}const WV="_balanceSummaryCard_cuikk_6",qV="_balanceSummaryGrid_cuikk_14",GV="_balanceItem_cuikk_21",JV="_clickable_cuikk_30",KV="_balanceLabel_cuikk_40",YV="_balanceAmount_cuikk_48",QV="_debit_cuikk_55",ZV="_credit_cuikk_59",XV="_difference_cuikk_63",ez="_unbalanced_cuikk_67",tz="_balanceCount_cuikk_71",rz="_balanceDivider_cuikk_76",sz="_descriptionCard_cuikk_83",nz="_descriptionLabel_cuikk_91",oz="_descriptionTextarea_cuikk_99",az="_transactionSection_cuikk_122",iz="_emptyState_cuikk_127",lz="_emptyIcon_cuikk_135",cz="_emptyTitle_cuikk_142",dz="_emptyText_cuikk_149",uz="_transactionLineCard_cuikk_156",hz="_transactionLineHeader_cuikk_169",fz="_transactionLineType_cuikk_187",mz="_transactionLineAccount_cuikk_209",pz="_transactionLineAmount_cuikk_221",gz="_transactionLineBody_cuikk_237",_z="_transactionLineDescription_cuikk_242",yz="_transactionLineTags_cuikk_251",vz="_transactionTag_cuikk_258",xz="_category_cuikk_268",bz="_cash_cuikk_273",wz="_counterparty_cuikk_278",Sz="_transactionLineActions_cuikk_283",Cz="_transactionActionBtn_cuikk_288",jz="_edit_cuikk_302",kz="_actionIcon_cuikk_318",Nz="_actionsFooter_cuikk_324",Iz="_addTransactionBtn_cuikk_330",Ez="_submitBtn_cuikk_337",le={balanceSummaryCard:WV,balanceSummaryGrid:qV,balanceItem:GV,clickable:JV,balanceLabel:KV,balanceAmount:YV,debit:QV,credit:ZV,difference:XV,unbalanced:ez,balanceCount:tz,balanceDivider:rz,descriptionCard:sz,descriptionLabel:nz,descriptionTextarea:oz,transactionSection:az,emptyState:iz,emptyIcon:lz,emptyTitle:cz,emptyText:dz,transactionLineCard:uz,transactionLineHeader:hz,transactionLineType:fz,transactionLineAccount:mz,transactionLineAmount:pz,transactionLineBody:gz,transactionLineDescription:_z,transactionLineTags:yz,transactionTag:vz,category:xz,cash:bz,counterparty:wz,transactionLineActions:Sz,transactionActionBtn:Cz,edit:jz,delete:"_delete_cuikk_310",actionIcon:kz,actionsFooter:Nz,addTransactionBtn:Iz,submitBtn:Ez},Tz=({journalEntry:t,submitting:e,onAddTransaction:r,onEditTransaction:s,onDeleteTransaction:n,onSubmit:o})=>{const i=()=>t.transactionLines.length===0?"Add transactions to submit":t.isBalanced?"Submit Journal Entry":"Balance debits and credits",l=()=>{r()},c=()=>{r()};return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:le.balanceSummaryCard,children:a.jsxs("div",{className:le.balanceSummaryGrid,children:[a.jsxs("div",{className:`${le.balanceItem} ${le.clickable}`,onClick:l,children:[a.jsx("div",{className:le.balanceLabel,children:"Debits"}),a.jsx("div",{className:`${le.balanceAmount} ${le.debit}`,children:ql(t.totalDebits)}),a.jsxs("div",{className:le.balanceCount,children:[t.debitCount," items"]})]}),a.jsx("div",{className:le.balanceDivider}),a.jsxs("div",{className:`${le.balanceItem} ${le.clickable}`,onClick:c,children:[a.jsx("div",{className:le.balanceLabel,children:"Credits"}),a.jsx("div",{className:`${le.balanceAmount} ${le.credit}`,children:ql(t.totalCredits)}),a.jsxs("div",{className:le.balanceCount,children:[t.creditCount," items"]})]}),a.jsx("div",{className:le.balanceDivider}),a.jsxs("div",{className:le.balanceItem,children:[a.jsx("div",{className:le.balanceLabel,children:"Difference"}),a.jsx("div",{className:`${le.balanceAmount} ${le.difference} ${t.isBalanced?"":le.unbalanced}`,children:ql(Math.abs(t.difference))}),a.jsx("div",{className:le.balanceCount,children:""})]})]})}),a.jsxs("div",{className:le.descriptionCard,children:[a.jsx("label",{className:le.descriptionLabel,htmlFor:"journalDescription",children:"Description (Optional)"}),a.jsx("textarea",{id:"journalDescription",className:le.descriptionTextarea,rows:2,placeholder:"Enter journal description..."})]}),a.jsxs("div",{className:le.transactionSection,children:[t.transactionLines.length===0?a.jsxs("div",{className:le.emptyState,children:[a.jsxs("svg",{className:le.emptyIcon,width:"120",height:"120",viewBox:"0 0 120 120",fill:"none",children:[a.jsx("circle",{cx:"60",cy:"60",r:"50",fill:"#F0F6FF"}),a.jsx("rect",{x:"35",y:"40",width:"50",height:"60",rx:"4",fill:"white",stroke:"#0064FF",strokeWidth:"2"}),a.jsx("rect",{x:"40",y:"35",width:"50",height:"60",rx:"4",fill:"white",stroke:"#0064FF",strokeWidth:"2"}),a.jsx("line",{x1:"48",y1:"45",x2:"75",y2:"45",stroke:"#E9ECEF",strokeWidth:"2",strokeLinecap:"round"}),a.jsx("line",{x1:"48",y1:"52",x2:"70",y2:"52",stroke:"#E9ECEF",strokeWidth:"2",strokeLinecap:"round"}),a.jsx("line",{x1:"48",y1:"59",x2:"72",y2:"59",stroke:"#E9ECEF",strokeWidth:"2",strokeLinecap:"round"}),a.jsx("circle",{cx:"60",cy:"75",r:"12",fill:"#0064FF"}),a.jsx("path",{d:"M56 75 H64 M60 71 V79",stroke:"white",strokeWidth:"2.5",strokeLinecap:"round"})]}),a.jsx("h3",{className:le.emptyTitle,children:"No transactions added"}),a.jsx("p",{className:le.emptyText,children:"Click Debits or Credits above to add transactions"})]}):a.jsx(a.Fragment,{children:t.transactionLines.map((d,u)=>a.jsxs("div",{className:le.transactionLineCard,children:[a.jsxs("div",{className:`${le.transactionLineHeader} ${d.isDebit?le.debit:le.credit}`,children:[a.jsx("div",{className:`${le.transactionLineType} ${d.isDebit?le.debit:le.credit}`,children:d.typeDisplay}),a.jsx("div",{className:le.transactionLineAccount,children:d.accountName||"No Account Selected"}),a.jsx("div",{className:`${le.transactionLineAmount} ${d.isDebit?le.debit:le.credit}`,children:ql(d.amount)})]}),a.jsxs("div",{className:le.transactionLineBody,children:[d.description&&a.jsxs("div",{className:le.transactionLineDescription,children:[a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M14,10H19.5L14,4.5V10M5,3H15L21,9V19A2,2 0 0,1 19,21H5C3.89,21 3,20.1 3,19V5C3,3.89 3.89,3 5,3M9,12H16V14H9V12M9,16H14V18H9V16Z"})}),a.jsx("span",{children:d.description})]}),a.jsxs("div",{className:le.transactionLineTags,children:[d.categoryTag&&a.jsxs("div",{className:`${le.transactionTag} ${le.category}`,children:[a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M17.63,5.84C17.27,5.33 16.67,5 16,5L5,5.01C3.9,5.01 3,5.9 3,7V17C3,18.1 3.9,19 5,19H16C16.67,19 17.27,18.67 17.63,18.16L22,12L17.63,5.84Z"})}),cD(d.categoryTag)]}),d.cashLocationName&&a.jsxs("div",{className:`${le.transactionTag} ${le.cash}`,children:[a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M11,8C11,9.66 9.66,11 8,11C6.34,11 5,9.66 5,8C5,6.34 6.34,5 8,5C9.66,5 11,6.34 11,8M14,20H2V18C2,15.79 4.69,14 8,14C11.31,14 14,15.79 14,18V20M22,8V18H24V8H22M18,10V16H20V10H18M16,13V16H17V13H16Z"})}),d.cashLocationName]}),d.counterpartyName&&a.jsxs("div",{className:`${le.transactionTag} ${le.counterparty}`,children:[a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4M12,6A6,6 0 0,0 6,12A6,6 0 0,0 12,18A6,6 0 0,0 18,12A6,6 0 0,0 12,6Z"})}),d.counterpartyName]})]}),a.jsxs("div",{className:le.transactionLineActions,children:[a.jsxs("button",{className:`${le.transactionActionBtn} ${le.edit}`,onClick:()=>s(u),children:[a.jsx("svg",{className:le.actionIcon,viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z"})}),"Edit"]}),a.jsxs("button",{className:`${le.transactionActionBtn} ${le.delete}`,onClick:()=>n(u),children:[a.jsx("svg",{className:le.actionIcon,viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z"})}),"Delete"]})]})]})]},u))}),a.jsxs("div",{className:le.actionsFooter,children:[a.jsxs(be,{variant:"outline",size:"lg",onClick:r,className:le.addTransactionBtn,children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor",style:{marginRight:"8px"},children:a.jsx("path",{d:"M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"})}),"Add Transaction"]}),a.jsx(be,{variant:"primary",size:"lg",onClick:o,disabled:!t.canSubmit(),loading:e,className:le.submitBtn,children:i()})]})]})]})},Az="_backdrop_zr0q6_5",Lz="_modal_zr0q6_16",Dz="_modalHeader_zr0q6_55",Mz="_modalTitle_zr0q6_63",Rz="_closeButton_zr0q6_70",Oz="_modalBody_zr0q6_88",Pz="_modalDescription_zr0q6_94",$z="_selectorSpacing_zr0q6_106",Fz="_modalFooter_zr0q6_110",Bz="_cancelButton_zr0q6_118",Hz="_confirmButton_zr0q6_135",ls={backdrop:Az,modal:Lz,modalHeader:Dz,modalTitle:Mz,closeButton:Rz,modalBody:Oz,modalDescription:Pz,selectorSpacing:$z,modalFooter:Fz,cancelButton:Bz,confirmButton:Hz},Vz=({isOpen:t,counterpartyName:e,linkedCompanyId:r,onGetCounterpartyStores:s,onGetCounterpartyCashLocations:n,onConfirm:o,onCancel:i})=>{const[l,c]=b.useState([]),[d,u]=b.useState([]),[h,f]=b.useState(""),[p,g]=b.useState(""),[y,x]=b.useState(""),[m,_]=b.useState(!1),[v,w]=b.useState(!1);b.useEffect(()=>{(async()=>{if(!(!t||!r||!s)){_(!0);try{const T=await s(r);c(T)}catch{c([])}finally{_(!1)}}})()},[t,r,s]),b.useEffect(()=>{(async()=>{if(!t||!r||!n){u([]),g("");return}w(!0);try{const T=await n(r,h||null);u(T)}catch{u([])}finally{w(!1)}})()},[t,r,h,n]),b.useEffect(()=>{t||(c([]),u([]),f(""),g(""),x(""))},[t]);const S=l.map(L=>({value:L.storeId,label:L.storeName})),E=d.map(L=>({value:L.locationId,label:L.locationName,description:L.locationType||void 0})),C=[{value:"note",label:"Note"},{value:"account",label:"Account"},{value:"loan",label:"Loan"},{value:"other",label:"Other"}],k=()=>{h&&p&&y&&o(h,p,y)},N=()=>{i()},I=h&&p&&y;return t?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:ls.backdrop,onClick:N}),a.jsxs("div",{className:ls.modal,children:[a.jsxs("div",{className:ls.modalHeader,children:[a.jsx("h3",{className:ls.modalTitle,children:"Select Counterparty Cash Location"}),a.jsx("button",{className:ls.closeButton,onClick:N,type:"button",children:a.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"})})})]}),a.jsxs("div",{className:ls.modalBody,children:[a.jsxs("p",{className:ls.modalDescription,children:["Select the store and cash location for ",a.jsx("strong",{children:e})]}),a.jsx(We,{label:"Counterparty Store",placeholder:m?"Loading stores...":"Select store",value:h,options:S,onChange:L=>{f(L),g("")},required:!0,searchable:!0,fullWidth:!0,emptyMessage:m?"Loading...":"No stores available",disabled:m}),a.jsx("div",{className:ls.selectorSpacing,children:a.jsx(We,{label:"Counterparty Cash Location",placeholder:v?"Loading locations...":"Select cash location",value:p,options:E,onChange:L=>g(L),required:!0,searchable:!0,fullWidth:!0,emptyMessage:v?"Loading...":"No cash locations available",disabled:v||!h})}),a.jsx("div",{className:ls.selectorSpacing,children:a.jsx(We,{label:"Debt Category",placeholder:"Select debt category",value:y,options:C,onChange:L=>x(L),required:!0,searchable:!1,fullWidth:!0,emptyMessage:"No categories available"})})]}),a.jsxs("div",{className:ls.modalFooter,children:[a.jsx("button",{className:ls.cancelButton,onClick:N,type:"button",children:"Cancel"}),a.jsx("button",{className:ls.confirmButton,onClick:k,disabled:!I,type:"button",children:"Confirm"})]})]})]}):null},zz=new vx,Jn=t=>({id:t,date:"",accountId:"",locationId:"",internalId:"",externalId:"",detail:"",debit:"",credit:"",counterpartyStoreId:"",counterpartyCashLocationId:"",debtCategory:""}),Zt=Jt((t,e)=>({rows:[Jn(1),Jn(2)],nextId:3,submitting:!1,showMappingWarning:!1,mappingWarningMessage:"",showCashLocationModal:!1,selectedRowForModal:null,modalCounterpartyData:null,addRow:()=>{const r=e();t({rows:[...r.rows,Jn(r.nextId)],nextId:r.nextId+1})},deleteRow:r=>{const s=e();s.rows.length<=2||t({rows:s.rows.filter(n=>n.id!==r)})},updateRowField:(r,s,n)=>{const o=e();t({rows:o.rows.map((i,l)=>{if(i.id===r){const c={...i,[s]:n};return s==="accountId"&&(c.locationId="",c.internalId="",c.externalId="",c.detail="",c.debit="",c.credit="",c.counterpartyStoreId="",c.counterpartyCashLocationId="",c.debtCategory=""),s==="internalId"&&n&&(c.externalId="",c.counterpartyStoreId="",c.counterpartyCashLocationId="",c.debtCategory=""),s==="externalId"&&n&&(c.internalId="",c.counterpartyStoreId="",c.counterpartyCashLocationId="",c.debtCategory=""),c}if(s==="date"&&n){if(r===1&&l===1&&!i.date)return{...i,date:n};if(r===2&&l===0&&!i.date)return{...i,date:n}}return i})})},clearCounterparty:(r,s)=>{e().updateRowField(r,s,"")},openCashLocationModal:(r,s)=>{t({selectedRowForModal:r,modalCounterpartyData:s,showCashLocationModal:!0})},closeCashLocationModal:()=>{t({showCashLocationModal:!1,selectedRowForModal:null,modalCounterpartyData:null})},confirmCashLocationModal:(r,s,n)=>{const o=e();o.selectedRowForModal!==null&&o.modalCounterpartyData&&t({rows:o.rows.map(i=>i.id===o.selectedRowForModal?{...i,internalId:o.modalCounterpartyData.counterpartyId,externalId:"",counterpartyStoreId:r,counterpartyCashLocationId:s,debtCategory:n}:i),showCashLocationModal:!1,selectedRowForModal:null,modalCounterpartyData:null})},showWarning:r=>{t({showMappingWarning:!0,mappingWarningMessage:r})},hideWarning:()=>{t({showMappingWarning:!1,mappingWarningMessage:""})},submitExcelEntry:async(r,s,n,o,i)=>{const l=e(),{isValid:c,error:d}=Uz(l.rows,o);if(!c)return{success:!1,error:d};t({submitting:!0});try{const u=l.rows.map(p=>{const g=o.find(E=>E.accountId===p.accountId),y=parseFloat(p.debit.replace(/,/g,""))||0,x=parseFloat(p.credit.replace(/,/g,""))||0,m=y>0?y:x,_=y>0,v=p.internalId||p.externalId||null,w=v?i.find(E=>E.counterpartyId===v):null;let S=null;return v&&p.debtCategory&&(S=p.debtCategory),new xx(_,p.accountId,(g==null?void 0:g.accountName)||"",m,p.detail||"",(g==null?void 0:g.categoryTag)||null,p.locationId||null,null,null,v,(w==null?void 0:w.counterpartyName)||null,p.counterpartyStoreId||null,null,S,null,null,null,p.date,null,null,(w==null?void 0:w.linkedCompanyId)||null,p.counterpartyCashLocationId||null)}),h=new ro(r,s,l.rows[0].date,u),f=await zz.submitJournalEntry(h,n,"Excel journal entry");return f.success?(t({rows:[Jn(1),Jn(2)],nextId:3,submitting:!1}),{success:!0}):(t({submitting:!1}),{success:!1,error:f.error})}catch(u){return t({submitting:!1}),{success:!1,error:u instanceof Error?u.message:"Failed to submit journal entry"}}},reset:()=>{t({rows:[Jn(1),Jn(2)],nextId:3,submitting:!1,showMappingWarning:!1,mappingWarningMessage:"",showCashLocationModal:!1,selectedRowForModal:null,modalCounterpartyData:null})}}));function Uz(t,e){const r=t.reduce((o,i)=>{const l=parseFloat(i.debit.replace(/,/g,""))||0;return o+l},0),s=t.reduce((o,i)=>{const l=parseFloat(i.credit.replace(/,/g,""))||0;return o+l},0);if(r-s!==0)return{isValid:!1,error:"Debits and credits must be balanced"};for(const o of t){if(!o.date)return{isValid:!1,error:"All rows must have a date"};if(!o.accountId)return{isValid:!1,error:"All rows must have an account selected"};const i=e.find(h=>h.accountId===o.accountId);if(i&&i.accountName.toLowerCase()==="cash"&&!o.locationId)return{isValid:!1,error:"Cash accounts must have a location selected"};if(i&&i.categoryTag&&(i.categoryTag.toLowerCase()==="payable"||i.categoryTag.toLowerCase()==="receivable")&&!o.internalId&&!o.externalId)return{isValid:!1,error:"Payable/Receivable accounts must have a counterparty selected"};if(o.internalId&&!o.debtCategory)return{isValid:!1,error:"Internal counterparties must have a debt category selected"};const d=parseFloat(o.debit.replace(/,/g,""))||0,u=parseFloat(o.credit.replace(/,/g,""))||0;if(d===0&&u===0)return{isValid:!1,error:"Each row must have either a debit or credit value"}}return{isValid:!0}}const Wz=()=>{const t=Zt(v=>v.rows),e=Zt(v=>v.nextId),r=Zt(v=>v.submitting),s=Zt(v=>v.showMappingWarning),n=Zt(v=>v.mappingWarningMessage),o=Zt(v=>v.showCashLocationModal),i=Zt(v=>v.selectedRowForModal),l=Zt(v=>v.modalCounterpartyData),c=Zt(v=>v.addRow),d=Zt(v=>v.deleteRow),u=Zt(v=>v.updateRowField),h=Zt(v=>v.clearCounterparty),f=Zt(v=>v.openCashLocationModal),p=Zt(v=>v.closeCashLocationModal),g=Zt(v=>v.confirmCashLocationModal),y=Zt(v=>v.showWarning),x=Zt(v=>v.hideWarning),m=Zt(v=>v.submitExcelEntry),_=Zt(v=>v.reset);return{rows:t,nextId:e,submitting:r,showMappingWarning:s,mappingWarningMessage:n,showCashLocationModal:o,selectedRowForModal:i,modalCounterpartyData:l,addRow:c,deleteRow:d,updateRowField:u,clearCounterparty:h,openCashLocationModal:f,closeCashLocationModal:p,confirmCashLocationModal:g,showWarning:y,hideWarning:x,submitExcelEntry:m,reset:_}},qz="_container_1e585_5",Gz="_table_1e585_9",Jz="_selectorCell_1e585_73",Kz="_disabled_1e585_78",Yz="_counterpartyCell_1e585_87",Qz="_clearButton_1e585_94",Zz="_actionButtons_1e585_122",Xz="_summary_1e585_132",eU="_summaryItem_1e585_137",tU="_summaryLabel_1e585_143",rU="_summaryValue_1e585_149",sU="_summarySuccess_1e585_155",nU="_summaryError_1e585_159",oU="_buttonGroup_1e585_164",aU="_addLineButton_1e585_169",iU="_submitButton_1e585_194",lU="_deleteButton_1e585_215",bt={container:qz,table:Gz,selectorCell:Jz,disabled:Kz,counterpartyCell:Yz,clearButton:Qz,actionButtons:Zz,summary:Xz,summaryItem:eU,summaryLabel:tU,summaryValue:rU,summarySuccess:sU,summaryError:nU,buttonGroup:oU,addLineButton:aU,submitButton:iU,deleteButton:lU},cU=({accounts:t,cashLocations:e,counterparties:r,companyId:s,selectedStoreId:n,userId:o,onCheckAccountMapping:i,onGetCounterpartyStores:l,onGetCounterpartyCashLocations:c,onSubmitSuccess:d,onSubmitError:u})=>{const{rows:h,submitting:f,showMappingWarning:p,mappingWarningMessage:g,showCashLocationModal:y,modalCounterpartyData:x,addRow:m,deleteRow:_,updateRowField:v,clearCounterparty:w,openCashLocationModal:S,closeCashLocationModal:E,confirmCashLocationModal:C,showWarning:k,hideWarning:N,submitExcelEntry:I,reset:L}=Wz(),T=b.useRef({}),j=b.useRef({}),M=b.useRef({}),R=b.useRef({}),O=b.useRef({}),z=b.useRef({}),D=b.useRef({});b.useEffect(()=>{L()},[L]);const P=F=>t.find(K=>K.accountId===F),$=F=>{const K=P(F);return K&&K.accountName.toLowerCase()==="cash"},U=F=>{const K=P(F);if(!K||!K.categoryTag)return!1;const ie=K.categoryTag.toLowerCase();return ie==="payable"||ie==="receivable"},A=F=>{if(!F)return"";const ie=F.replace(/[^\d.]/g,"").split(".");return ie[0]=ie[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),ie.length>1?ie[0]+"."+ie[1]:ie[0]},Ae=()=>{const F=h.reduce((ye,st)=>{const Ue=parseFloat(st.debit.replace(/,/g,""))||0;return ye+Ue},0),K=h.reduce((ye,st)=>{const Ue=parseFloat(st.credit.replace(/,/g,""))||0;return ye+Ue},0),ie=F-K;return{totalDebit:F,totalCredit:K,difference:ie}},{difference:ae}=Ae(),Te=(()=>{if(ae!==0)return!1;for(const F of h){if(!F.date||!F.accountId||$(F.accountId)&&!F.locationId||U(F.accountId)&&!F.internalId&&!F.externalId)return!1;const K=parseFloat(F.debit.replace(/,/g,""))||0,ie=parseFloat(F.credit.replace(/,/g,""))||0;if(K===0&&ie===0)return!1}return!0})(),At=t.map(F=>({value:F.accountId,label:F.accountName||F.account_name||""})),sr=()=>h.map(F=>F.locationId).filter(F=>F),Cr=F=>{const K=sr(),ie=h.find(ye=>ye.id===F);return e.map(ye=>({value:ye.locationId,label:ye.locationName,disabled:K.includes(ye.locationId)&&(ie==null?void 0:ie.locationId)!==ye.locationId}))},tt=F=>r.filter(ie=>F?ie.isInternal===!0:ie.isInternal!==!0).map(ie=>({value:ie.counterpartyId,label:ie.counterpartyName})),it=(F,K,ie)=>{const ye=F.replace(/[^\d.]/g,"");ye.split(".").length>2||v(K,ie,ye)},me=async(F,K)=>{var Ue;if(!i)return!0;const ie=P(F),ye=r.find(Kt=>Kt.counterpartyId===K);if(!(ye!=null&&ye.isInternal))return!0;const st=(Ue=ie==null?void 0:ie.categoryTag)==null?void 0:Ue.toLowerCase();if(st!=="payable"&&st!=="receivable")return!0;try{return await i(s,K,F)?!0:(k("This internal counterparty requires an account mapping to be set up first. Please configure the account mapping in the Account Mapping page before using this counterparty."),!1)}catch{return k("Error checking account mapping. Please try again."),!1}},Je=async(F,K,ie)=>{if(K==="internalId"&&ie){const ye=h.find(st=>st.id===F);if(ye&&ye.accountId){if(!await me(ye.accountId,ie))return;const Ue=r.find(Kt=>Kt.counterpartyId===ie);if(Ue!=null&&Ue.isInternal&&(Ue!=null&&Ue.linkedCompanyId)){S(F,{counterpartyId:ie,counterpartyName:Ue.counterpartyName,linkedCompanyId:Ue.linkedCompanyId});return}}}v(F,K,ie)},St=(F,K)=>{setTimeout(()=>{if(h.find(ye=>ye.id===F))if($(K)){const ye=T.current[F];ye&&(ye.focus(),ye.click())}else if(U(K)){const ye=j.current[F];ye&&(ye.focus(),ye.click())}else{const ye=R.current[F];ye&&ye.focus()}},100)},X=F=>{setTimeout(()=>{if(!h.find(ye=>ye.id===F))return;const ie=R.current[F];ie&&ie.focus()},100)},J=F=>{setTimeout(()=>{if(!h.find(ye=>ye.id===F))return;const ie=R.current[F];ie&&ie.focus()},100)},ve=F=>{setTimeout(()=>{if(!h.find(ye=>ye.id===F))return;const ie=R.current[F];ie&&ie.focus()},100)},xe=async()=>{if(!Te||f)return;const F=await I(s,n,o,t,r);F.success?d&&d():u&&u(F.error||"Failed to submit journal entry")};return a.jsxs("div",{className:bt.container,children:[a.jsxs("table",{className:bt.table,children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Date"}),a.jsx("th",{children:"Account"}),a.jsx("th",{children:"Location"}),a.jsx("th",{children:"Internal"}),a.jsx("th",{children:"External"}),a.jsx("th",{children:"Detail"}),a.jsx("th",{children:"Debit"}),a.jsx("th",{children:"Credit"}),a.jsx("th",{})]})}),a.jsx("tbody",{children:h.map(F=>a.jsxs("tr",{children:[a.jsx("td",{children:a.jsx("input",{type:"date",value:F.date,onChange:K=>Je(F.id,"date",K.target.value)})}),a.jsx("td",{className:bt.selectorCell,children:a.jsx(We,{ref:K=>D.current[F.id]=K,value:F.accountId,options:At,onChange:K=>Je(F.id,"accountId",K),onSelect:K=>St(F.id,K),placeholder:"Select account...",searchable:!0,inline:!0,fullWidth:!0,emptyMessage:"No accounts available"})}),a.jsx("td",{className:`${bt.selectorCell} ${$(F.accountId)?"":bt.disabled}`,children:a.jsx(We,{ref:K=>T.current[F.id]=K,value:F.locationId,options:Cr(F.id),onChange:K=>Je(F.id,"locationId",K),onSelect:()=>X(F.id),placeholder:"Select location...",searchable:!0,inline:!0,fullWidth:!0,disabled:!$(F.accountId),emptyMessage:"No locations available"})}),a.jsx("td",{className:`${bt.selectorCell} ${!U(F.accountId)||F.externalId?bt.disabled:""}`,children:a.jsxs("div",{className:bt.counterpartyCell,children:[a.jsx(We,{ref:K=>j.current[F.id]=K,value:F.internalId,options:tt(!0),onChange:K=>Je(F.id,"internalId",K),onSelect:()=>J(F.id),placeholder:"Select internal...",searchable:!0,inline:!0,fullWidth:!0,disabled:!U(F.accountId)||!!F.externalId,emptyMessage:"No internal counterparties"}),F.internalId&&a.jsx("button",{className:bt.clearButton,onClick:()=>w(F.id,"internalId"),type:"button",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"})})})]})}),a.jsx("td",{className:`${bt.selectorCell} ${!U(F.accountId)||F.internalId?bt.disabled:""}`,children:a.jsxs("div",{className:bt.counterpartyCell,children:[a.jsx(We,{ref:K=>M.current[F.id]=K,value:F.externalId,options:tt(!1),onChange:K=>Je(F.id,"externalId",K),onSelect:()=>ve(F.id),placeholder:"Select external...",searchable:!0,inline:!0,fullWidth:!0,disabled:!U(F.accountId)||!!F.internalId,emptyMessage:"No external counterparties"}),F.externalId&&a.jsx("button",{className:bt.clearButton,onClick:()=>w(F.id,"externalId"),type:"button",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"})})})]})}),a.jsx("td",{children:a.jsx("input",{ref:K=>R.current[F.id]=K,type:"text",value:F.detail,onChange:K=>Je(F.id,"detail",K.target.value),onKeyDown:K=>{if(K.key==="Enter"){K.preventDefault();const ie=O.current[F.id];ie&&(ie.focus(),ie.select())}},placeholder:"Enter detail..."})}),a.jsx("td",{children:a.jsx("input",{ref:K=>O.current[F.id]=K,type:"text",inputMode:"decimal",value:A(F.debit),onChange:K=>it(K.target.value,F.id,"debit"),onKeyDown:K=>{if(K.key==="Enter")if(K.preventDefault(),!!F.debit&&parseFloat(F.debit.replace(/,/g,""))>0){const ye=h.findIndex(Ue=>Ue.id===F.id),st=h[ye+1];if(st){const Ue=D.current[st.id];Ue&&(Ue.focus(),Ue.click())}else m(),setTimeout(()=>{const Ue=h[h.length-1].id+1,Kt=D.current[Ue];Kt&&(Kt.focus(),Kt.click())},100)}else{const ye=z.current[F.id];ye&&(ye.focus(),ye.select())}},disabled:!!F.credit&&parseFloat(F.credit.replace(/,/g,""))>0,placeholder:"0",style:{textAlign:"right"}})}),a.jsx("td",{children:a.jsx("input",{ref:K=>z.current[F.id]=K,type:"text",inputMode:"decimal",value:A(F.credit),onChange:K=>it(K.target.value,F.id,"credit"),disabled:!!F.debit&&parseFloat(F.debit.replace(/,/g,""))>0,onKeyDown:K=>{if(K.key==="Enter"){K.preventDefault();const ie=h.findIndex(st=>st.id===F.id),ye=h[ie+1];if(ye){const st=D.current[ye.id];st&&(st.focus(),st.click())}else m(),setTimeout(()=>{const st=h[h.length-1].id+1,Ue=D.current[st];Ue&&(Ue.focus(),Ue.click())},100)}},placeholder:"0",style:{textAlign:"right"}})}),a.jsx("td",{children:a.jsx("button",{className:bt.deleteButton,onClick:()=>_(F.id),disabled:h.length<=2,children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"})})})})]},F.id))})]}),a.jsxs("div",{className:bt.actionButtons,children:[a.jsx("div",{className:bt.summary,children:a.jsxs("div",{className:bt.summaryItem,children:[a.jsx("span",{className:bt.summaryLabel,children:"Difference:"}),a.jsx("span",{className:`${bt.summaryValue} ${ae!==0?bt.summaryError:bt.summarySuccess}`,children:A(Math.abs(ae).toString())})]})}),a.jsxs("div",{className:bt.buttonGroup,children:[a.jsxs("button",{className:bt.addLineButton,onClick:m,children:[a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"})}),"Add Line"]}),a.jsx("button",{className:bt.submitButton,disabled:!Te||f,onClick:xe,children:f?"Submitting...":"Submit"})]})]}),a.jsx(De,{variant:"warning",title:"Account Mapping Required",message:g,isOpen:p,onClose:N,onConfirm:N,confirmText:"OK",showCancelButton:!1}),x&&a.jsx(Vz,{isOpen:y,counterpartyName:x.counterpartyName,linkedCompanyId:x.linkedCompanyId,onGetCounterpartyStores:l,onGetCounterpartyCashLocations:c,onConfirm:C,onCancel:E})]})},dU="_transactionForm_1w5hm_7",uU="_formSection_1w5hm_13",hU="_formTitle_1w5hm_19",fU="_required_1w5hm_26",mU="_transactionTypeToggle_1w5hm_31",pU="_transactionTypeOption_1w5hm_39",gU="_active_1w5hm_54",_U="_credit_1w5hm_71",yU="_conditionalFields_1w5hm_236",vU="_debtFields_1w5hm_243",xU="_input_1w5hm_250",bU="_dateInputWrapper_1w5hm_280",wU="_dateClearButton_1w5hm_285",Oe={transactionForm:dU,formSection:uU,formTitle:hU,required:fU,transactionTypeToggle:mU,transactionTypeOption:pU,active:gU,credit:_U,conditionalFields:yU,debtFields:vU,input:xU,dateInputWrapper:bU,dateClearButton:wU},SU=({initialData:t,initialIsDebit:e,suggestedAmount:r})=>{var Cr,tt;const s=()=>{const it=new Date,me=it.getFullYear(),Je=String(it.getMonth()+1).padStart(2,"0"),St=String(it.getDate()).padStart(2,"0");return`${me}-${Je}-${St}`},[n,o]=b.useState((t==null?void 0:t.isDebit)??e),[i,l]=b.useState((t==null?void 0:t.accountId)??""),[c,d]=b.useState(t!=null&&t.amount?t.amount.toString():r?r.toString():""),[u,h]=b.useState((t==null?void 0:t.description)??""),[f,p]=b.useState((t==null?void 0:t.cashLocationId)??""),[g,y]=b.useState((t==null?void 0:t.counterpartyId)??""),[x,m]=b.useState([]),[_,v]=b.useState((t==null?void 0:t.counterpartyStoreId)??""),[w,S]=b.useState([]),[E,C]=b.useState((t==null?void 0:t.counterpartyCashLocationId)??""),[k,N]=b.useState(!1),[I,L]=b.useState(!1),[T,j]=b.useState((t==null?void 0:t.debtCategory)??""),[M,R]=b.useState(((Cr=t==null?void 0:t.interestRate)==null?void 0:Cr.toString())??"0"),[O,z]=b.useState((t==null?void 0:t.interestAccountId)??""),[D,P]=b.useState(((tt=t==null?void 0:t.interestDueDay)==null?void 0:tt.toString())??""),[$,U]=b.useState((t==null?void 0:t.issueDate)??s()),[A,Ae]=b.useState((t==null?void 0:t.dueDate)??""),[ae,Ke]=b.useState((t==null?void 0:t.debtDescription)??"");return{isDebit:n,selectedAccountId:i,amount:c,description:u,selectedCashLocation:f,selectedCounterparty:g,counterpartyStores:x,selectedCounterpartyStore:_,counterpartyCashLocations:w,selectedCounterpartyCashLocation:E,loadingCounterpartyStores:k,loadingCounterpartyCashLocations:I,debtCategory:T,interestRate:M,interestAccountId:O,interestDueDay:D,issueDate:$,dueDate:A,debtDescription:ae,setIsDebit:o,setSelectedAccountId:l,setAmount:d,setDescription:h,setSelectedCashLocation:p,setSelectedCounterparty:y,setCounterpartyStores:m,setSelectedCounterpartyStore:v,setCounterpartyCashLocations:S,setSelectedCounterpartyCashLocation:C,setLoadingCounterpartyStores:N,setLoadingCounterpartyCashLocations:L,setDebtCategory:j,setInterestRate:R,setInterestAccountId:z,setInterestDueDay:P,setIssueDate:U,setDueDate:Ae,setDebtDescription:Ke,formatAmountDisplay:it=>{if(!it)return"";const me=parseFloat(it);return isNaN(me)?it:me.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:2})},handleAmountChange:it=>{const me=it.replace(/[^\d.]/g,"");me.split(".").length>2||d(me)},handleAccountChange:it=>{l(it),p(""),y("")}}},CU=({selectedCounterparty:t,counterparties:e,setCounterpartyStores:r,setSelectedCounterpartyStore:s,setCounterpartyCashLocations:n,setSelectedCounterpartyCashLocation:o,setLoadingCounterpartyStores:i,setLoadingCounterpartyCashLocations:l,selectedCounterpartyStore:c,onGetCounterpartyStores:d,onGetCounterpartyCashLocations:u})=>{const h=e.find(f=>f.counterpartyId===t)||null;return b.useEffect(()=>{(async()=>{if(!(h!=null&&h.isInternal)||!(h!=null&&h.linkedCompanyId)||!d){r([]),s(""),n([]),o("");return}i(!0);try{const p=await d(h.linkedCompanyId);r(p)}catch{r([])}finally{i(!1)}})()},[t,h==null?void 0:h.isInternal,h==null?void 0:h.linkedCompanyId,d,r,s,n,o,i]),b.useEffect(()=>{(async()=>{if(!(h!=null&&h.isInternal)||!(h!=null&&h.linkedCompanyId)||!u){n([]),o("");return}l(!0);try{const p=await u(h.linkedCompanyId,c||null);n(p)}catch{n([])}finally{l(!1)}})()},[t,h==null?void 0:h.linkedCompanyId,c,u,n,o,l]),{selectedCounterpartyData:h}},jU=({selectedAccountId:t,selectedAccount:e,selectedCounterparty:r,selectedCounterpartyData:s,companyId:n,onCheckAccountMapping:o})=>{const[i,l]=b.useState("none"),[c,d]=b.useState(!1),u=async()=>{var p;if(!t||!r||!s||!o){l("none");return}if(!s.isInternal){l("none");return}const f=(p=e==null?void 0:e.categoryTag)==null?void 0:p.toLowerCase();if(f!=="payable"&&f!=="receivable"){l("none");return}l("checking");try{await o(n,r,t)?l("valid"):(l("invalid"),d(!0))}catch{l("invalid"),d(!0)}};return b.useEffect(()=>{u()},[t,r,e==null?void 0:e.categoryTag,s==null?void 0:s.isInternal,n,o]),{accountMappingStatus:i,showMappingWarning:c,setShowMappingWarning:d,handleMappingWarningClose:()=>{d(!1)}}},kU=({isDebit:t,onSubmit:e,accounts:r,cashLocations:s,counterparties:n,companyId:o,suggestedAmount:i,initialData:l,disabledCashLocationId:c=null,onCheckAccountMapping:d,onGetCounterpartyStores:u,onGetCounterpartyCashLocations:h,onValidationChange:f})=>{const p=SU({initialData:l,initialIsDebit:t,suggestedAmount:i}),{isDebit:g,selectedAccountId:y,amount:x,description:m,selectedCashLocation:_,selectedCounterparty:v,counterpartyStores:w,selectedCounterpartyStore:S,counterpartyCashLocations:E,selectedCounterpartyCashLocation:C,loadingCounterpartyStores:k,loadingCounterpartyCashLocations:N,debtCategory:I,interestRate:L,interestAccountId:T,interestDueDay:j,issueDate:M,dueDate:R,debtDescription:O,setIsDebit:z,setSelectedCashLocation:D,setSelectedCounterparty:P,setSelectedCounterpartyStore:$,setSelectedCounterpartyCashLocation:U,setDebtCategory:A,setInterestRate:Ae,setInterestAccountId:ae,setInterestDueDay:Ke,setIssueDate:Te,setDueDate:At,setDebtDescription:sr,setCounterpartyStores:Cr,setCounterpartyCashLocations:tt,setLoadingCounterpartyStores:it,setLoadingCounterpartyCashLocations:me,setDescription:Je,formatAmountDisplay:St,handleAmountChange:X,handleAccountChange:J}=p,ve=r.find(Q=>Q.accountId===y)||null,{selectedCounterpartyData:xe}=CU({selectedCounterparty:v,counterparties:n,setCounterpartyStores:Cr,setSelectedCounterpartyStore:$,setCounterpartyCashLocations:tt,setSelectedCounterpartyCashLocation:U,setLoadingCounterpartyStores:it,setLoadingCounterpartyCashLocations:me,selectedCounterpartyStore:S,onGetCounterpartyStores:u,onGetCounterpartyCashLocations:h}),{accountMappingStatus:F,showMappingWarning:K,handleMappingWarningClose:ie}=jU({selectedAccountId:y,selectedAccount:ve,selectedCounterparty:v,selectedCounterpartyData:xe,companyId:o,onCheckAccountMapping:d}),ye=Q=>{switch(Q==null?void 0:Q.toLowerCase()){case"payable":return"rgba(239, 68, 68, 0.15)";case"receivable":return"rgba(59, 130, 246, 0.15)";case"contra_asset":return"rgba(107, 114, 128, 0.15)";case"cash":return"rgba(34, 197, 94, 0.15)";case"general":return"rgba(107, 114, 128, 0.15)";case"fixed_asset":return"rgba(168, 85, 247, 0.15)";case"equity":return"rgba(14, 165, 233, 0.15)";default:return"rgba(107, 114, 128, 0.15)"}},st=Q=>{switch(Q==null?void 0:Q.toLowerCase()){case"payable":return"rgb(239, 68, 68)";case"receivable":return"rgb(59, 130, 246)";case"contra_asset":return"rgb(107, 114, 128)";case"cash":return"rgb(34, 197, 94)";case"general":return"rgb(107, 114, 128)";case"fixed_asset":return"rgb(168, 85, 247)";case"equity":return"rgb(14, 165, 233)";default:return"rgb(107, 114, 128)"}},Ue=Q=>Q?Q.replace(/_/g," ").replace(/\b\w/g,Ct=>Ct.toUpperCase()):"General",Kt=Q=>{if(!Q)return"??";const Ct=Q.trim().split(" ");return Ct.length===1?Q.substring(0,2).toUpperCase():Ct.slice(0,2).map(nr=>nr[0]).join("").toUpperCase()},So=r.map(Q=>({value:Q.accountId,label:Q.accountName,badge:Kt(Q.accountName),description:Q.categoryTag&&Q.categoryTag.toLowerCase()!=="general"?Ue(Q.categoryTag):void 0,descriptionBgColor:Q.categoryTag?ye(Q.categoryTag):void 0,descriptionColor:Q.categoryTag?st(Q.categoryTag):void 0})),Y=s.map(Q=>({value:Q.locationId,label:Q.locationName,badge:Kt(Q.locationName),description:Q.locationType||void 0,disabled:c===Q.locationId&&_!==Q.locationId})),he=n.map(Q=>{let Ct="",nr,as;return Q.isInternal?(Ct="Internal Company",Q.type&&(Ct+=`  ${Q.type}`),nr="rgba(59, 130, 246, 0.1)",as="rgba(59, 130, 246, 1)"):(Ct=Q.type||"",Ct&&(nr="rgba(107, 114, 128, 0.1)",as="rgba(107, 114, 128, 1)")),{value:Q.counterpartyId,label:Q.counterpartyName,badge:Kt(Q.counterpartyName),description:Ct||void 0,descriptionBgColor:nr,descriptionColor:as}}),nt=()=>{if(!y||!x)return;const Q=r.find(as=>as.accountId===y);if(!Q)return;const Ct=parseFloat(x.replace(/,/g,""));if(isNaN(Ct)||Ct<=0)return;const nr={accountId:Q.accountId,accountName:Q.accountName,categoryTag:Q.categoryTag,amount:Ct,description:m||void 0,isDebit:g,cashLocationId:_||void 0,counterpartyId:v||void 0,counterpartyStoreId:S||void 0,counterpartyCashLocationId:C||void 0,debtCategory:I||void 0,interestRate:L?parseFloat(L):void 0,interestAccountId:T||void 0,interestDueDay:j?parseInt(j):void 0,issueDate:M||void 0,dueDate:R||void 0,debtDescription:O||void 0};e(nr)},ht=(()=>{var Ct;if(!y||!x||parseFloat(x)<=0)return!1;const Q=(Ct=ve==null?void 0:ve.categoryTag)==null?void 0:Ct.toLowerCase();return!((Q==="payable"||Q==="receivable")&&!v||xe!=null&&xe.isInternal&&(xe!=null&&xe.linkedCompanyId)&&(!S||!C))})();b.useEffect(()=>{f==null||f(ht)},[ht,f]);const Rr=[{value:"",label:"Select debt category"},{value:"note",label:"Note"},{value:"account",label:"Account"},{value:"loan",label:"Loan"},{value:"other",label:"Other"}],Zi=()=>{if(!ve||!ve.categoryTag)return null;const{categoryTag:Q}=ve,Ct=Q==="receivable"||Q==="payable",nr=w.map(Mt=>({value:Mt.storeId,label:Mt.storeName,badge:Kt(Mt.storeName)})),as=E.map(Mt=>({value:Mt.locationId,label:Mt.locationName,badge:Kt(Mt.locationName),description:Mt.locationType||void 0}));return a.jsxs("div",{className:Oe.conditionalFields,children:[Q==="cash"&&a.jsx(We,{label:"Cash Location",placeholder:"Select cash location",value:_,options:Y,onChange:Mt=>D(Mt),required:!0,searchable:!0,showBadges:!1,fullWidth:!0,emptyMessage:"No cash locations found"}),Ct&&a.jsxs(a.Fragment,{children:[a.jsx(We,{label:"Counterparty",placeholder:"Select counterparty",value:v,options:he,onChange:Mt=>P(Mt),required:!0,searchable:!0,showBadges:!1,showDescriptions:!0,fullWidth:!0,emptyMessage:"No counterparties found"}),(xe==null?void 0:xe.isInternal)&&F==="valid"&&a.jsxs("div",{style:{padding:"12px 16px",backgroundColor:"rgba(34, 197, 94, 0.1)",borderRadius:"8px",display:"flex",alignItems:"center",gap:"8px",marginTop:"12px"},children:[a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",children:[a.jsx("circle",{cx:"10",cy:"10",r:"10",fill:"rgb(34, 197, 94)",opacity:"0.2"}),a.jsx("path",{d:"M6 10l3 3 5-5",stroke:"rgb(34, 197, 94)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),a.jsx("span",{style:{color:"rgb(34, 197, 94)",fontSize:"14px",fontWeight:"500"},children:"Account mapping verified"})]}),(xe==null?void 0:xe.isInternal)&&(xe==null?void 0:xe.linkedCompanyId)&&a.jsx(We,{label:"Counterparty Store",placeholder:k?"Loading stores...":"Select counterparty store",value:S,options:nr,onChange:Mt=>{$(Mt),U("")},required:!0,searchable:!0,showBadges:!1,fullWidth:!0,emptyMessage:k?"Loading...":"No stores configured for this counterparty",disabled:k}),(xe==null?void 0:xe.isInternal)&&(xe==null?void 0:xe.linkedCompanyId)&&a.jsx(We,{label:"Counterparty Cash Location",placeholder:N?"Loading locations...":"Select counterparty cash location",value:C,options:as,onChange:Mt=>U(Mt),required:!0,searchable:!0,showBadges:!1,fullWidth:!0,emptyMessage:N?"Loading...":"No cash locations found",disabled:N})]})]})};return a.jsxs("form",{className:Oe.transactionForm,onSubmit:Q=>{Q.preventDefault(),nt()},children:[a.jsxs("div",{className:Oe.formSection,children:[a.jsx("div",{className:Oe.formTitle,children:"Transaction Type"}),a.jsxs("div",{className:`${Oe.transactionTypeToggle} ${g?"":Oe.credit}`,children:[a.jsx("button",{type:"button",className:`${Oe.transactionTypeOption} ${g?Oe.active:""}`,onClick:()=>z(!0),children:"Debit"}),a.jsx("button",{type:"button",className:`${Oe.transactionTypeOption} ${g?"":Oe.active}`,onClick:()=>z(!1),children:"Credit"})]})]}),a.jsx(We,{label:"Account",placeholder:"Select account",value:y,options:So,onChange:J,required:!0,searchable:!0,showBadges:!1,showDescriptions:!0,fullWidth:!0,emptyMessage:"No accounts found"}),Zi(),a.jsxs("div",{className:Oe.formSection,children:[a.jsxs("div",{className:Oe.formTitle,children:["Amount ",a.jsx("span",{className:Oe.required,children:"*"})]}),a.jsx("input",{type:"text",className:Oe.input,placeholder:"Enter amount",value:St(x),onChange:Q=>X(Q.target.value)})]}),a.jsxs("div",{className:Oe.formSection,children:[a.jsx("div",{className:Oe.formTitle,children:"Description (Optional)"}),a.jsx("input",{type:"text",className:Oe.input,placeholder:"Enter description",value:m,onChange:Q=>Je(Q.target.value)})]}),(ve==null?void 0:ve.categoryTag)&&(ve.categoryTag==="payable"||ve.categoryTag==="receivable")&&v&&a.jsxs("div",{className:Oe.debtFields,children:[a.jsx(We,{label:"Debt Category (Optional)",placeholder:"Select debt category",value:I,options:Rr,onChange:Q=>A(Q),required:!1,searchable:!1,showBadges:!1,fullWidth:!0,emptyMessage:"No categories available"}),a.jsxs("div",{className:Oe.formSection,children:[a.jsx("div",{className:Oe.formTitle,children:"Interest Rate (%) (Optional)"}),a.jsx("input",{type:"number",className:Oe.input,placeholder:"Enter interest rate",value:L,onChange:Q=>Ae(Q.target.value),min:"0",max:"100",step:"0.01"})]}),a.jsx(We,{label:"Interest Account (Optional)",placeholder:"Select interest account",value:T,options:So,onChange:Q=>ae(Q),required:!1,searchable:!0,showBadges:!1,showDescriptions:!0,fullWidth:!0,emptyMessage:"No accounts found"}),a.jsxs("div",{className:Oe.formSection,children:[a.jsx("div",{className:Oe.formTitle,children:"Interest Due Day (Optional)"}),a.jsx("input",{type:"number",className:Oe.input,placeholder:"Enter day (1-31)",value:j,onChange:Q=>Ke(Q.target.value),min:"1",max:"31",step:"1"})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"},children:[a.jsxs("div",{className:Oe.formSection,children:[a.jsx("div",{className:Oe.formTitle,children:"Issue Date (Optional)"}),a.jsxs("div",{className:Oe.dateInputWrapper,children:[a.jsx("input",{type:"date",className:Oe.input,value:M,onChange:Q=>Te(Q.target.value)}),M&&a.jsx("button",{type:"button",className:Oe.dateClearButton,onClick:()=>Te(""),"aria-label":"Clear issue date",children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"})})})]})]}),a.jsxs("div",{className:Oe.formSection,children:[a.jsx("div",{className:Oe.formTitle,children:"Due Date (Optional)"}),a.jsxs("div",{className:Oe.dateInputWrapper,children:[a.jsx("input",{type:"date",className:Oe.input,value:R,onChange:Q=>At(Q.target.value)}),R&&a.jsx("button",{type:"button",className:Oe.dateClearButton,onClick:()=>At(""),"aria-label":"Clear due date",children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"})})})]})]})]}),a.jsxs("div",{className:Oe.formSection,children:[a.jsx("div",{className:Oe.formTitle,children:"Debt Description (Optional)"}),a.jsx("textarea",{className:Oe.input,placeholder:"Enter debt description",value:O,onChange:Q=>sr(Q.target.value),rows:2,style:{resize:"vertical",fontFamily:"inherit"}})]})]}),a.jsx("button",{type:"submit",style:{display:"none"},disabled:!ht}),a.jsx(De,{variant:"warning",title:"Account Mapping Required",message:"This internal counterparty requires an account mapping to be set up first. Please configure the account mapping in the Account Mapping page before using this counterparty.",isOpen:K,onClose:ie,onConfirm:ie,confirmText:"OK",showCancelButton:!1})]})},NU="_modalOverlay_2brv3_3",IU="_modal_2brv3_3",EU="_modalHeader_2brv3_29",TU="_modalTitle_2brv3_37",AU="_modalClose_2brv3_44",LU="_modalBody_2brv3_61",DU="_modalFooter_2brv3_67",Kn={modalOverlay:NU,modal:IU,modalHeader:EU,modalTitle:TU,modalClose:AU,modalBody:LU,modalFooter:DU},MU=({isOpen:t,isEditMode:e,editingIndex:r,journalEntry:s,modalTransactionType:n,accounts:o,cashLocations:i,counterparties:l,companyId:c,selectedStoreId:d,isFormValid:u,onSubmit:h,onCancel:f,onCheckAccountMapping:p,onGetCounterpartyStores:g,onGetCounterpartyCashLocations:y,onValidationChange:x})=>{if(!t)return null;const m=e&&r!==null?s.transactionLines[r]:null,_=m?{accountId:m.accountId,accountName:m.accountName,categoryTag:m.categoryTag||void 0,amount:m.amount,description:m.description||void 0,isDebit:m.isDebit,cashLocationId:m.cashLocationId||void 0,counterpartyId:m.counterpartyId||void 0,counterpartyStoreId:m.counterpartyStoreId||void 0,counterpartyCashLocationId:m.counterpartyCashLocationId||void 0,debtCategory:m.debtCategory||void 0,interestRate:m.interestRate||void 0,interestAccountId:m.interestAccountId||void 0,interestDueDay:m.interestDueDay||void 0,issueDate:m.issueDate||void 0,dueDate:m.dueDate||void 0,debtDescription:m.debtDescription||void 0}:void 0,v=e&&m!=null&&m.cashLocationId?null:s.getCashLocationId(),w=()=>{const S=document.querySelector("form");if(S){const E=S.querySelector('button[type="submit"]');E==null||E.click()}};return a.jsx("div",{className:Kn.modalOverlay,onClick:f,children:a.jsxs("div",{className:Kn.modal,onClick:S=>S.stopPropagation(),children:[a.jsxs("div",{className:Kn.modalHeader,children:[a.jsx("h2",{className:Kn.modalTitle,children:e?"Edit Transaction":"Add Transaction"}),a.jsx("button",{className:Kn.modalClose,onClick:f,children:a.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"})})})]}),a.jsx("div",{className:Kn.modalBody,children:a.jsx(kU,{isDebit:n==="debit",onSubmit:h,onCancel:f,accounts:o,cashLocations:i,counterparties:l,companyId:c,storeId:d,suggestedAmount:Math.abs(s.difference),initialData:_,isEditMode:e,disabledCashLocationId:v,onCheckAccountMapping:p,onGetCounterpartyStores:g,onGetCounterpartyCashLocations:y,onValidationChange:x})}),a.jsxs("div",{className:Kn.modalFooter,children:[a.jsx(be,{variant:"outline",size:"lg",onClick:f,children:"Cancel"}),a.jsx(be,{variant:"primary",size:"lg",disabled:!u,onClick:w,children:e?"Update":"Add"})]})]})})},RU="_container_svdkk_7",OU="_header_svdkk_14",PU="_title_svdkk_18",$U="_subtitle_svdkk_25",FU="_journalHeaderCard_svdkk_32",BU="_journalDateInfo_svdkk_44",HU="_journalDateIcon_svdkk_50",VU="_journalDateText_svdkk_57",zU="_journalCompanyInfo_svdkk_63",UU="_journalCompanyIcon_svdkk_70",WU="_journalCompanyText_svdkk_76",qU="_storeSelectorCard_svdkk_87",GU="_tabsContainer_svdkk_96",JU="_tabsWrapper_svdkk_100",KU="_tab_svdkk_96",YU="_active_svdkk_130",QU="_iconActive_svdkk_148",ZU="_tabIcon_svdkk_152",rt={container:RU,header:OU,title:PU,subtitle:$U,journalHeaderCard:FU,journalDateInfo:BU,journalDateIcon:HU,journalDateText:VU,journalCompanyInfo:zU,journalCompanyIcon:UU,journalCompanyText:WU,storeSelectorCard:qU,tabsContainer:GU,tabsWrapper:JU,tab:KU,active:YU,iconActive:QU,tabIcon:ZU},XU=()=>{const{user:t}=Yi(),{currentCompany:e,currentStore:r}=at(),s=(e==null?void 0:e.company_id)||"",n=(e==null?void 0:e.stores)||[],[o,i]=b.useState((r==null?void 0:r.store_id)||null),{journalEntry:l,accounts:c,cashLocations:d,counterparties:u,loading:h,submitting:f,addTransactionLine:p,updateTransactionLine:g,removeTransactionLine:y,submitJournalEntry:x,resetJournalEntry:m,checkAccountMapping:_,getCounterpartyStores:v,getCounterpartyCashLocations:w}=UV(s,o,(t==null?void 0:t.id)||""),[S,E]=b.useState(!1),[C,k]=b.useState("debit"),[N,I]=b.useState(null),[L,T]=b.useState("excel"),[j,M]=b.useState(!1),[R,O]=b.useState(!1),[z,D]=b.useState(!1),[P,$]=b.useState(!1),[U,A]=b.useState(""),Ae=me=>{i(me),m(me)};if(!e)return a.jsxs(a.Fragment,{children:[a.jsx(fe,{activeItem:"finance"}),a.jsx("div",{className:rt.container,children:a.jsxs("div",{className:rt.header,children:[a.jsx("h1",{className:rt.title,children:"Journal Input"}),a.jsx("p",{className:rt.subtitle,children:"Please select a company first"})]})})]});const ae=()=>l.totalDebits<=l.totalCredits?"debit":"credit",Ke=()=>{I(null),M(!1),k(ae()),E(!0)},Te=me=>{const Je=me.cashLocationId?d.find(J=>J.locationId===me.cashLocationId):null,St=me.counterpartyId?u.find(J=>J.counterpartyId===me.counterpartyId):null,X=new xx(me.isDebit,me.accountId,me.accountName,me.amount,me.description||"",me.categoryTag||null,me.cashLocationId||null,(Je==null?void 0:Je.locationName)||null,(Je==null?void 0:Je.locationType)||null,me.counterpartyId||null,(St==null?void 0:St.counterpartyName)||null,me.counterpartyStoreId||null,null,me.debtCategory||null,me.interestRate||null,me.interestAccountId||null,me.interestDueDay||null,me.issueDate||null,me.dueDate||null,me.debtDescription||null,(St==null?void 0:St.linkedCompanyId)||null,me.counterpartyCashLocationId||null);N!==null?g(N,X):p(X),E(!1),I(null)},At=()=>{E(!1),I(null),M(!1)},sr=me=>{I(me),M(!1);const Je=l.transactionLines[me];k(Je.isDebit?"debit":"credit"),E(!0)},Cr=me=>{y(me)},tt=()=>{if(!l.canSubmit()){O(!0);return}it()},it=async()=>{const me=await x();me.success?D(!0):(A(me.error||"Failed to submit journal entry"),$(!0))};return h?a.jsxs(a.Fragment,{children:[a.jsx(fe,{activeItem:"finance"}),a.jsxs("div",{className:rt.container,children:[a.jsx("div",{className:rt.header,children:a.jsx("h1",{className:rt.title,children:"Journal Input"})}),a.jsx(Ne,{fullscreen:!0})]})]}):a.jsxs(a.Fragment,{children:[a.jsx(fe,{activeItem:"finance"}),a.jsxs("div",{className:rt.container,children:[a.jsxs("div",{className:rt.header,children:[a.jsx("h1",{className:rt.title,children:"Journal Entry"}),a.jsx("p",{className:rt.subtitle,children:"Create balanced financial transactions"})]}),a.jsxs("div",{className:rt.journalHeaderCard,children:[a.jsxs("div",{className:rt.journalDateInfo,children:[a.jsx("svg",{className:rt.journalDateIcon,viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M19,3H18V1H16V3H8V1H6V3H5A2,2 0 0,0 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5A2,2 0 0,0 19,3M19,19H5V8H19V19Z"})}),a.jsx("span",{className:rt.journalDateText,children:lD(l.date)})]}),a.jsxs("div",{className:rt.journalCompanyInfo,children:[a.jsx("svg",{className:rt.journalCompanyIcon,viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12,7V3H2V21H22V7H12M6,19H4V17H6V19M6,15H4V13H6V15M6,11H4V9H6V11M6,7H4V5H6V7M10,19H8V17H10V19M10,15H8V13H10V15M10,11H8V9H10V11M10,7H8V5H10V7M20,19H18V17H20V19M20,15H18V13H20V15M20,11H18V9H20V11M16,19H14V17H16V19M16,15H14V13H16V15M16,11H14V9H16V11"})}),a.jsx("span",{className:rt.journalCompanyText,children:(e==null?void 0:e.company_name)||"Company"})]})]}),a.jsx("div",{className:rt.storeSelectorCard,children:a.jsx(Hs,{stores:n,selectedStoreId:o,onStoreSelect:Ae,companyId:s,showAllStoresOption:!1,width:"100%"})}),a.jsx("div",{className:rt.tabsContainer,children:a.jsxs("div",{className:`${rt.tabsWrapper} ${L==="icon"?rt.iconActive:""}`,children:[a.jsxs("button",{className:`${rt.tab} ${L==="excel"?rt.active:""}`,onClick:()=>T("excel"),children:[a.jsx("svg",{className:rt.tabIcon,viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20M12.9,14.5L15.8,19H14L12,15.6L10,19H8.2L11.1,14.5L8.2,10H10L12,13.4L14,10H15.8L12.9,14.5Z"})}),"Excel"]}),a.jsxs("button",{className:`${rt.tab} ${L==="icon"?rt.active:""}`,onClick:()=>T("icon"),children:[a.jsx("svg",{className:rt.tabIcon,viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M13,9H18.5L13,3.5V9M6,2H14L20,8V20A2,2 0 0,1 18,22H6C4.89,22 4,21.1 4,20V4C4,2.89 4.89,2 6,2M15,18V16H6V18H15M18,14V12H6V14H18Z"})}),"Icon"]})]})}),L==="icon"&&a.jsx(Tz,{journalEntry:l,accounts:c,cashLocations:d,counterparties:u,companyId:s,selectedStoreId:o,submitting:f,onAddTransaction:Ke,onEditTransaction:sr,onDeleteTransaction:Cr,onSubmit:tt}),L==="excel"&&a.jsx(cU,{accounts:c,cashLocations:d,counterparties:u,companyId:s,selectedStoreId:o,userId:(t==null?void 0:t.id)||"",onCheckAccountMapping:_,onGetCounterpartyStores:v,onGetCounterpartyCashLocations:w,onSubmitSuccess:()=>D(!0),onSubmitError:me=>{A(me),$(!0)}})]}),a.jsx(MU,{isOpen:S,isEditMode:N!==null,editingIndex:N,journalEntry:l,modalTransactionType:C,accounts:c,cashLocations:d,counterparties:u,companyId:s,selectedStoreId:o,isFormValid:j,onSubmit:Te,onCancel:At,onCheckAccountMapping:_,onGetCounterpartyStores:v,onGetCounterpartyCashLocations:w,onValidationChange:M}),a.jsx(De,{variant:"warning",isOpen:R,onClose:()=>O(!1),message:"Journal entry must be balanced with at least 2 transaction lines",zIndex:1e4}),a.jsx(De,{variant:"success",isOpen:z,onClose:()=>D(!1),message:"Journal entry submitted successfully!",zIndex:1e4,autoCloseDuration:2e3}),a.jsx(De,{variant:"error",isOpen:P,onClose:()=>$(!1),message:U,zIndex:1e4})]})},eW="_container_1628h_5",tW="_header_1628h_11",rW="_title_1628h_15",sW="_subtitle_1628h_22",nW="_comingSoonCard_1628h_28",oW="_comingSoon_1628h_28",aW="_icon_1628h_40",iW="_comingSoonTitle_1628h_52",lW="_comingSoonText_1628h_59",cW="_features_1628h_65",Ds={container:eW,header:tW,title:rW,subtitle:sW,comingSoonCard:nW,comingSoon:oW,icon:aW,comingSoonTitle:iW,comingSoonText:lW,features:cW},dW=()=>a.jsxs(a.Fragment,{children:[a.jsx(fe,{activeItem:"marketing"}),a.jsxs("div",{className:Ds.container,children:[a.jsxs("div",{className:Ds.header,children:[a.jsx("h1",{className:Ds.title,children:"Marketing Plan"}),a.jsx("p",{className:Ds.subtitle,children:"Plan and track marketing campaigns"})]}),a.jsx("div",{className:Ds.comingSoonCard,children:a.jsxs("div",{className:Ds.comingSoon,children:[a.jsx("div",{className:Ds.icon,children:a.jsx("svg",{width:"64",height:"64",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12,2L13.09,8.26L22,9L15.5,15.14L16.91,22L12,18.5L7.09,22L8.5,15.14L2,9L10.91,8.26L12,2Z"})})}),a.jsx("h2",{className:Ds.comingSoonTitle,children:"Marketing Plan Coming Soon"}),a.jsx("p",{className:Ds.comingSoonText,children:"The marketing plan feature is currently under development."}),a.jsxs("div",{className:Ds.features,children:[a.jsx("h3",{children:"Planned Features:"}),a.jsxs("ul",{children:[a.jsx("li",{children:" Campaign planning and tracking"}),a.jsx("li",{children:" Marketing analytics and insights"}),a.jsx("li",{children:" Target audience management"}),a.jsx("li",{children:" Budget allocation and ROI tracking"}),a.jsx("li",{children:" Campaign calendar and scheduling"})]})]})]})})]})]});class uW{async getOrders(e,r){const s=ne.getClient(),{data:n,error:o}=await s.rpc("get_inventory_order_list",{p_company_id:e});if(o)throw console.error("Error fetching orders:",o),new Error(o.message);return(n==null?void 0:n.orders)||[]}async getCompanyCurrency(e){if(!e)return null;try{const r=ne.getClient(),{data:s,error:n}=await r.from("companies").select("base_currency_id").eq("company_id",e).single();if(n||!s||!s.base_currency_id)return null;const{data:o,error:i}=await r.from("currency_types").select("currency_id, currency_code").eq("currency_id",s.base_currency_id).single();return i||!o?null:{currency_id:o.currency_id,currency_code:o.currency_code,currency_symbol:dD(o.currency_code)}}catch(r){return console.error("Error fetching company currency:",r),null}}}class hW{constructor(e,r,s,n,o,i,l,c,d,u,h,f){this.orderId=e,this.orderNumber=r,this.orderDate=s,this.expectedDate=n,this.supplierName=o,this.itemCount=i,this.totalQuantity=l,this.totalAmount=c,this.status=d,this.currencySymbol=u,this.items=h,this.summary=f}get statusDisplay(){switch(this.status){case"pending":return"Pending";case"approved":return"Approved";case"received":return"Received";case"cancelled":return"Cancelled";case"partial":return"Partial";default:return this.status}}formatCurrency(e){return`${this.currencySymbol}${Math.round(e).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}`}get formattedDate(){const e=te.toLocal(this.orderDate);return te.formatCustom(e,{year:"numeric",month:"short",day:"numeric"},"en-US")}get formattedExpectedDate(){if(!this.expectedDate)return null;const e=te.toLocal(this.expectedDate);return te.formatCustom(e,{year:"numeric",month:"short",day:"numeric"},"en-US")}get isCancellable(){return this.status==="pending"||this.status==="approved"}get isReceivable(){return this.status==="approved"||this.status==="partial"}get receivingProgress(){return this.summary?{received:this.summary.total_received,total:this.summary.total_ordered,percentage:this.summary.completion_rate}:{received:0,total:0,percentage:0}}}let fW=class bx{static fromJson(e,r="$"){var d,u;const s=((d=e.summary)==null?void 0:d.total_products)??(e.items?e.items.length:0),n=((u=e.summary)==null?void 0:u.total_ordered)??0,o=r,l=te.toLocal(e.order_date).toISOString(),c=e.expected_date?te.toLocal(e.expected_date).toISOString():null;return new hW(e.order_id,e.order_number,l,c,e.supplier_name,s,n,e.total_amount,e.status,o,e.items,e.summary)}static toJson(e){return{order_id:e.orderId,order_number:e.orderNumber,order_date:e.orderDate,expected_date:e.expectedDate,supplier_name:e.supplierName,total_amount:e.totalAmount,status:e.status,items:e.items,summary:e.summary}}static fromJsonArray(e,r="$"){return e.map(s=>bx.fromJson(s,r))}};class mW{constructor(){W(this,"dataSource");this.dataSource=new uW}async getOrders(e,r){try{const[s,n]=await Promise.all([this.dataSource.getCompanyCurrency(e),this.dataSource.getOrders(e,r)]),o=(s==null?void 0:s.currency_symbol)||"$";return{success:!0,data:fW.fromJsonArray(n,o)}}catch(s){return console.error("Repository error fetching orders:",s),{success:!1,error:s instanceof Error?s.message:"Failed to fetch orders"}}}}const pW=new mW,mt=Jt(t=>({orders:[],selectedOrder:null,currency:{symbol:"$",code:"USD"},activeTab:"new-order",searchQuery:"",selectedOrderIds:new Set,loading:!0,error:null,isCreatingOrder:!1,isCancellingOrder:!1,notification:{isOpen:!1,variant:"success",message:""},setActiveTab:e=>t({activeTab:e}),setSearchQuery:e=>t({searchQuery:e}),toggleOrderSelection:e=>t(r=>{const s=new Set(r.selectedOrderIds);return s.has(e)?s.delete(e):s.add(e),{selectedOrderIds:s}}),selectAllOrders:()=>t(e=>({selectedOrderIds:new Set(e.orders.map(r=>r.orderId))})),clearSelection:()=>t({selectedOrderIds:new Set}),setSelectedOrder:e=>t({selectedOrder:e}),showNotification:(e,r)=>t({notification:{isOpen:!0,variant:e,message:r}}),hideNotification:()=>t(e=>({notification:{...e.notification,isOpen:!1}})),setLoading:e=>t({loading:e}),setError:e=>t({error:e}),clearError:()=>t({error:null}),loadOrders:async(e,r)=>{t({loading:!0,error:null});try{const s=await pW.getOrders(e,r);if(!s.success){t({error:s.error||"Failed to load orders",orders:[],loading:!1});return}const n=(s.data||[]).sort((o,i)=>{const l=new Date(o.orderDate);return new Date(i.orderDate).getTime()-l.getTime()});t({orders:n,loading:!1})}catch(s){t({error:s instanceof Error?s.message:"An unexpected error occurred",orders:[],loading:!1})}},createOrder:async e=>{t({isCreatingOrder:!0,error:null});try{return t({isCreatingOrder:!1}),{success:!1,error:"Order creation not yet implemented"}}catch(r){return t({isCreatingOrder:!1}),{success:!1,error:r instanceof Error?r.message:"An unexpected error occurred"}}},cancelOrder:async e=>{t({isCancellingOrder:!0,error:null});try{return t({isCancellingOrder:!1}),{success:!1,error:"Order cancellation not yet implemented"}}catch(r){return t({isCancellingOrder:!1}),{success:!1,error:r instanceof Error?r.message:"An unexpected error occurred"}}},refresh:async()=>{}})),gW=(t,e)=>{const r=mt(j=>j.orders),s=mt(j=>j.selectedOrder),n=mt(j=>j.currency),o=mt(j=>j.activeTab),i=mt(j=>j.searchQuery),l=mt(j=>j.selectedOrderIds),c=mt(j=>j.loading),d=mt(j=>j.error),u=mt(j=>j.isCreatingOrder),h=mt(j=>j.isCancellingOrder),f=mt(j=>j.notification),p=mt(j=>j.setActiveTab),g=mt(j=>j.setSearchQuery),y=mt(j=>j.toggleOrderSelection),x=mt(j=>j.selectAllOrders),m=mt(j=>j.clearSelection),_=mt(j=>j.setSelectedOrder),v=mt(j=>j.showNotification),w=mt(j=>j.hideNotification),S=mt(j=>j.setLoading),E=mt(j=>j.setError),C=mt(j=>j.clearError),k=mt(j=>j.loadOrders),N=mt(j=>j.createOrder),I=mt(j=>j.cancelOrder);b.useEffect(()=>{t&&k(t,e)},[t,e]);const L=b.useCallback(()=>{t&&k(t,e)},[t,e]);return{orders:i?r.filter(j=>j.orderNumber.toLowerCase().includes(i.toLowerCase())||j.supplierName.toLowerCase().includes(i.toLowerCase())):r,allOrders:r,selectedOrder:s,currency:n,activeTab:o,searchQuery:i,selectedOrderIds:l,loading:c,error:d,isCreatingOrder:u,isCancellingOrder:h,notification:f,setActiveTab:p,setSearchQuery:g,toggleOrderSelection:y,selectAllOrders:x,clearSelection:m,setSelectedOrder:_,showNotification:v,hideNotification:w,setLoading:S,setError:E,clearError:C,createOrder:N,cancelOrder:I,refresh:L}};class _W{async getSuppliers(e){const{data:r,error:s}=await ne.getClient().from("counterparties").select("counterparty_id, name, email, phone, address, notes").eq("company_id",e).eq("type","Suppliers").eq("is_deleted",!1).order("name");if(s)throw console.error("Error fetching counterparties:",s),new Error(s.message);return r||[]}}class xm{static fromJson(e){return{counterparty_id:e.counterparty_id,name:e.name,email:e.email,phone:e.phone,address:e.address,notes:e.notes}}static fromJsonArray(e){return e.map(r=>xm.fromJson(r))}static toJson(e){return{counterparty_id:e.counterparty_id,name:e.name,email:e.email,phone:e.phone,address:e.address,notes:e.notes}}}class yW{constructor(){W(this,"dataSource");this.dataSource=new _W}async getSuppliers(e){try{const r=await this.dataSource.getSuppliers(e);return{success:!0,data:xm.fromJsonArray(r)}}catch(r){return console.error("Repository error fetching counterparties:",r),{success:!1,error:r instanceof Error?r.message:"Failed to fetch suppliers"}}}searchByName(e,r){if(!r||r.length<1)return e;const s=r.toLowerCase();return e.filter(n=>(n.name||"").toLowerCase().includes(s))}getById(e,r){return e.find(s=>s.counterparty_id===r)||null}}const vW=t=>{const[e,r]=b.useState([]),[s,n]=b.useState(!1),[o,i]=b.useState(null),l=new yW,c=b.useCallback(async()=>{if(t){n(!0),i(null);try{const d=await l.getSuppliers(t);if(!d.success){i(d.error||"Failed to fetch suppliers"),r([]);return}r(d.data||[])}catch(d){console.error("Error fetching counterparties:",d),i(d instanceof Error?d.message:"Failed to fetch suppliers"),r([])}finally{n(!1)}}},[t]);return b.useEffect(()=>{t?c():r([])},[t,c]),{counterparties:e,loading:s,error:o,refresh:c}};class xW{async getProductsByCompany(e){const{data:r,error:s}=await ne.getClient().rpc("get_inventory_product_list_company",{p_company_id:e});if(s)throw console.error("Error fetching products:",s),new Error(s.message);if(!r||!r.success)throw new Error("Failed to fetch products");return{company:r.data.company||null,products:r.data.products||[],summary:r.data.summary||null}}}class bm{static fromJson(e){var r,s,n,o;return{product_id:e.product_id,product_name:e.product_name,sku:e.sku,barcode:e.barcode,unit_of_measure:e.unit_of_measure,selling_price:((r=e.pricing)==null?void 0:r.selling_price)??0,quantity_on_hand:((s=e.total_stock_summary)==null?void 0:s.total_quantity_on_hand)??0,is_active:((n=e.status)==null?void 0:n.is_active)??!0,is_deleted:((o=e.status)==null?void 0:o.is_deleted)??!1}}static fromJsonArray(e){return e.map(r=>bm.fromJson(r))}}class bW{constructor(){W(this,"dataSource");this.dataSource=new xW}async getProducts(e){var r,s,n,o;try{const i=await this.dataSource.getProductsByCompany(e),l=bm.fromJsonArray(i.products),c=((s=(r=i.company)==null?void 0:r.currency)==null?void 0:s.symbol)||"",d=((o=(n=i.company)==null?void 0:n.currency)==null?void 0:o.code)||"KRW";return{success:!0,data:{products:l,currencySymbol:c,currencyCode:d}}}catch(i){return console.error("Repository error fetching products:",i),{success:!1,error:i instanceof Error?i.message:"Failed to fetch products"}}}async getActiveProducts(e){const r=await this.getProducts(e);if(!r.success||!r.data)return r;const s=r.data.products.filter(n=>n.is_active&&!n.is_deleted);return{success:!0,data:{...r.data,products:s}}}searchProducts(e,r){if(!r||r.length<1)return[];const s=r.toLowerCase();return e.filter(n=>{const o=(n.product_name||"").toLowerCase(),i=(n.sku||"").toLowerCase(),l=(n.barcode||"").toLowerCase();return o.includes(s)||i.includes(s)||l.includes(s)})}getProductById(e,r){return e.find(s=>s.product_id===r)||null}getProductBySKU(e,r){return e.find(s=>s.sku===r)||null}}const wW=t=>{const[e,r]=b.useState([]),[s,n]=b.useState(!1),[o,i]=b.useState(null),[l,c]=b.useState(""),d=new bW,u=b.useCallback(async()=>{if(t){n(!0),i(null);try{const y=await d.getProducts(t);if(!y.success){i(y.error||"Failed to fetch products"),r([]);return}y.data&&(r(y.data.products),c(y.data.currencySymbol))}catch(y){console.error("Error fetching products:",y),i(y instanceof Error?y.message:"Failed to fetch products"),r([])}finally{n(!1)}}},[t]);b.useEffect(()=>{t?u():(r([]),c(""))},[t,u]);const h=b.useCallback(()=>e.filter(y=>y.is_active&&!y.is_deleted),[e]),f=b.useCallback(y=>{const x=h();return d.searchProducts(x,y)},[e,h]),p=b.useCallback(y=>d.getProductById(e,y),[e]),g=b.useCallback(y=>d.getProductBySKU(e,y),[e]);return{products:e,loading:s,error:o,currencySymbol:l,refresh:u,getActiveProducts:h,searchProducts:f,getProductById:p,getProductBySKU:g}};class SW{static validateOrderDate(e){if(!e||e.trim()==="")return{field:"orderDate",message:"Order date is required"};const r=new Date(e);if(isNaN(r.getTime()))return{field:"orderDate",message:"Invalid order date format"};const s=new Date;return s.setFullYear(s.getFullYear()+1),r>s?{field:"orderDate",message:"Order date cannot be more than 1 year in the future"}:null}static validateCounterpartySupplier(e){return!e||e.trim()===""?{field:"supplier",message:"Please select a supplier"}:null}static validateSupplierInfo(e){const r=[];return(!e.name||e.name.trim()==="")&&r.push({field:"supplier.name",message:"Supplier name is required"}),e.email&&e.email.trim()!==""&&(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e.email)||r.push({field:"supplier.email",message:"Invalid email format"})),e.phone&&e.phone.trim()!==""&&(/^[\d\s\-\+\(\)]+$/.test(e.phone)||r.push({field:"supplier.phone",message:"Invalid phone format"})),r}static validateOrderItems(e){const r=[];return!e||e.length===0?(r.push({field:"items",message:"At least one product must be added to the order"}),r):(e.forEach((s,n)=>{(!s.quantity_ordered||s.quantity_ordered<=0)&&r.push({field:`items[${n}].quantity_ordered`,message:`Item "${s.product_name}": Quantity must be greater than 0`}),(s.unit_price===void 0||s.unit_price===null||s.unit_price<0)&&r.push({field:`items[${n}].unit_price`,message:`Item "${s.product_name}": Unit price must be 0 or greater`});const o=s.quantity_ordered*s.unit_price;Math.abs(s.total_amount-o)>.01&&r.push({field:`items[${n}].total_amount`,message:`Item "${s.product_name}": Total amount calculation mismatch`}),(!s.product_id||s.product_id.trim()==="")&&r.push({field:`items[${n}].product_id`,message:`Item "${s.product_name}": Missing product ID`})}),r)}static validateOrderForm(e,r,s,n,o){const i=[],l=this.validateOrderDate(e);if(l&&i.push(l),r==="counter-party"){const d=this.validateCounterpartySupplier(s);d&&i.push(d)}else if(r==="others")if(!n)i.push({field:"supplier",message:"Supplier information is required"});else{const d=this.validateSupplierInfo(n);i.push(...d)}const c=this.validateOrderItems(o);return i.push(...c),i}static isValidOrderForm(e,r,s,n,o){return this.validateOrderForm(e,r,s,n,o).length===0}}const Au={name:"",contact:"",phone:"",email:"",address:"",bank_account:"",memo:""},Be=Jt((t,e)=>({orderDate:"",notes:"",supplierTab:"counter-party",selectedSupplier:null,supplierInfo:Au,orderItems:[],isDropdownOpen:!1,searchTerm:"",showSuggestions:!1,searchResults:[],isCreating:!1,error:null,validationErrors:{},setOrderDate:r=>t({orderDate:r}),setNotes:r=>t({notes:r}),setSupplierTab:r=>{t(r==="others"?{supplierTab:r,selectedSupplier:null}:{supplierTab:r,supplierInfo:Au})},setSelectedSupplier:r=>t({selectedSupplier:r}),setSupplierInfo:r=>t(s=>({supplierInfo:{...s.supplierInfo,...r}})),setOrderItems:r=>t({orderItems:r}),setIsDropdownOpen:r=>t({isDropdownOpen:r}),setSearchTerm:r=>t({searchTerm:r}),setShowSuggestions:r=>t({showSuggestions:r}),setSearchResults:r=>t({searchResults:r}),setIsCreating:r=>t({isCreating:r}),setError:r=>t({error:r}),setValidationErrors:r=>t({validationErrors:r}),clearErrors:()=>t({error:null,validationErrors:{}}),addOrderItem:r=>{const s=e();if(s.orderItems.find(o=>o.product_id===r.product_id))t({orderItems:s.orderItems.map(o=>o.product_id===r.product_id?{...o,quantity:o.quantity+1,subtotal:(o.quantity+1)*o.unit_price}:o)});else{const o={product_id:r.product_id,product_name:r.product_name,sku:r.sku||"",unit:r.unit_of_measure||"Unit",quantity:1,unit_price:r.selling_price||0,subtotal:r.selling_price||0};t({orderItems:[...s.orderItems,o]})}},updateOrderItemQuantity:(r,s)=>{const n=e();t({orderItems:n.orderItems.map(o=>o.product_id===r?{...o,quantity:s,subtotal:s*o.unit_price}:o)})},updateOrderItemPrice:(r,s)=>{const n=e();t({orderItems:n.orderItems.map(o=>o.product_id===r?{...o,unit_price:s,subtotal:o.quantity*s}:o)})},removeOrderItem:r=>{const s=e();t({orderItems:s.orderItems.filter(n=>n.product_id!==r)})},searchProducts:(r,s)=>{if(!r||r.length<1){t({searchResults:[],showSuggestions:!1});return}const n=r.toLowerCase(),o=s.filter(i=>i.product_name.toLowerCase().includes(n)||i.sku&&i.sku.toLowerCase().includes(n));t({searchResults:o.slice(0,10),showSuggestions:!0})},clearSearch:()=>{t({searchTerm:"",searchResults:[],showSuggestions:!1})},validateForm:()=>{var o;const r=e(),s=r.orderItems.map(i=>({product_id:i.product_id,product_name:i.product_name,sku:i.sku,barcode:void 0,quantity_ordered:i.quantity,quantity_received_total:void 0,quantity_remaining:void 0,unit_price:i.unit_price,total_amount:i.subtotal})),n=SW.validateOrderForm(r.orderDate,r.supplierTab,((o=r.selectedSupplier)==null?void 0:o.counterparty_id)||null,r.supplierTab==="others"?r.supplierInfo:null,s);if(n.length>0){const i={};return n.forEach(l=>{i[l.field]=l.message}),t({validationErrors:i}),!1}return t({validationErrors:{}}),!0},resetForm:()=>{const r=new Date,s=r.getFullYear(),n=String(r.getMonth()+1).padStart(2,"0"),o=String(r.getDate()).padStart(2,"0"),i=`${s}-${n}-${o}`;t({orderDate:i,notes:"",supplierTab:"counter-party",selectedSupplier:null,supplierInfo:Au,orderItems:[],isDropdownOpen:!1,searchTerm:"",showSuggestions:!1,searchResults:[],error:null,validationErrors:{}})},getSummary:()=>{const r=e();return{items:r.orderItems.length,totalQuantity:r.orderItems.reduce((s,n)=>s+n.quantity,0),subtotal:r.orderItems.reduce((s,n)=>s+n.subtotal,0)}}})),CW=()=>{const t=Be(A=>A.orderDate),e=Be(A=>A.notes),r=Be(A=>A.supplierTab),s=Be(A=>A.selectedSupplier),n=Be(A=>A.supplierInfo),o=Be(A=>A.orderItems),i=Be(A=>A.isDropdownOpen),l=Be(A=>A.searchTerm),c=Be(A=>A.showSuggestions),d=Be(A=>A.searchResults),u=Be(A=>A.isCreating),h=Be(A=>A.error),f=Be(A=>A.validationErrors),p=Be(A=>A.setOrderDate),g=Be(A=>A.setNotes),y=Be(A=>A.setSupplierTab),x=Be(A=>A.setSelectedSupplier),m=Be(A=>A.setSupplierInfo),_=Be(A=>A.setOrderItems),v=Be(A=>A.setIsDropdownOpen),w=Be(A=>A.setSearchTerm),S=Be(A=>A.setShowSuggestions),E=Be(A=>A.setSearchResults),C=Be(A=>A.setIsCreating),k=Be(A=>A.setError),N=Be(A=>A.setValidationErrors),I=Be(A=>A.clearErrors),L=Be(A=>A.addOrderItem),T=Be(A=>A.updateOrderItemQuantity),j=Be(A=>A.updateOrderItemPrice),M=Be(A=>A.removeOrderItem),R=Be(A=>A.searchProducts),O=Be(A=>A.clearSearch),z=Be(A=>A.validateForm),D=Be(A=>A.resetForm),P=Be(A=>A.getSummary);b.useEffect(()=>{if(!t){const A=new Date,Ae=A.getFullYear(),ae=String(A.getMonth()+1).padStart(2,"0"),Ke=String(A.getDate()).padStart(2,"0");p(`${Ae}-${ae}-${Ke}`)}},[]);const $=P(),U=o.length>0&&z();return{orderDate:t,notes:e,supplierTab:r,selectedSupplier:s,supplierInfo:n,orderItems:o,isDropdownOpen:i,searchTerm:l,showSuggestions:c,searchResults:d,isCreating:u,error:h,validationErrors:f,summary:$,isValid:U,setOrderDate:p,setNotes:g,setSupplierTab:y,setSelectedSupplier:x,setSupplierInfo:m,setOrderItems:_,setIsDropdownOpen:v,setSearchTerm:w,setShowSuggestions:S,setSearchResults:E,setIsCreating:C,setError:k,setValidationErrors:N,clearErrors:I,addOrderItem:L,updateOrderItemQuantity:T,updateOrderItemPrice:j,removeOrderItem:M,searchProducts:R,clearSearch:O,validateForm:z,resetForm:D}},jW="_orderFormContainer_1wg52_7",kW="_orderFormMain_1wg52_13",NW="_formSection_1wg52_21",IW="_sectionTitle_1wg52_28",EW="_sectionHeader_1wg52_35",TW="_sectionActions_1wg52_42",AW="_formRow_1wg52_49",LW="_formGroup_1wg52_60",DW="_formLabel_1wg52_66",MW="_formInput_1wg52_74",RW="_supplierTabs_1wg52_102",OW="_supplierTab_1wg52_102",PW="_active_1wg52_127",$W="_supplierTabContent_1wg52_133",FW="_customDropdown_1wg52_149",BW="_dropdownHeader_1wg52_153",HW="_dropdownSelected_1wg52_169",VW="_dropdownArrow_1wg52_182",zW="_open_1wg52_188",UW="_dropdownList_1wg52_192",WW="_dropdownOption_1wg52_219",qW="_selected_1wg52_234",GW="_supplierInfo_1wg52_238",JW="_supplierName_1wg52_244",KW="_supplierDetail_1wg52_250",YW="_productSearch_1wg52_256",QW="_productSearchIcon_1wg52_261",ZW="_productSearchInput_1wg52_270",XW="_searchSuggestions_1wg52_287",eq="_searchSuggestionItem_1wg52_303",tq="_searchSuggestionContent_1wg52_318",rq="_searchSuggestionName_1wg52_324",sq="_searchSuggestionDetails_1wg52_330",nq="_searchSuggestionSku_1wg52_337",oq="_searchSuggestionPrice_1wg52_341",aq="_searchNoResults_1wg52_346",iq="_productsTableContainer_1wg52_354",lq="_productsTable_1wg52_354",cq="_emptyMessage_1wg52_395",dq="_quantityInput_1wg52_403",uq="_priceInput_1wg52_404",hq="_subtotalCell_1wg52_436",fq="_btnDelete_1wg52_442",mq="_orderSummary_1wg52_465",pq="_summaryTitle_1wg52_476",gq="_summaryItem_1wg52_483",_q="_summaryLabel_1wg52_491",yq="_summaryValue_1wg52_496",vq="_summaryDivider_1wg52_502",xq="_summaryTotal_1wg52_508",bq="_summaryTotalLabel_1wg52_514",wq="_summaryTotalValue_1wg52_520",Sq="_currencyAmount_1wg52_526",Cq="_formActions_1wg52_531",jq="_btnSecondary_1wg52_537",kq="_btnPrimary_1wg52_538",H={orderFormContainer:jW,orderFormMain:kW,formSection:NW,sectionTitle:IW,sectionHeader:EW,sectionActions:TW,formRow:AW,formGroup:LW,formLabel:DW,formInput:MW,supplierTabs:RW,supplierTab:OW,active:PW,supplierTabContent:$W,customDropdown:FW,dropdownHeader:BW,dropdownSelected:HW,dropdownArrow:VW,open:zW,dropdownList:UW,dropdownOption:WW,selected:qW,supplierInfo:GW,supplierName:JW,supplierDetail:KW,productSearch:YW,productSearchIcon:QW,productSearchInput:ZW,searchSuggestions:XW,searchSuggestionItem:eq,searchSuggestionContent:tq,searchSuggestionName:rq,searchSuggestionDetails:sq,searchSuggestionSku:nq,searchSuggestionPrice:oq,searchNoResults:aq,productsTableContainer:iq,productsTable:lq,emptyMessage:cq,quantityInput:dq,priceInput:uq,subtotalCell:hq,btnDelete:fq,orderSummary:mq,summaryTitle:pq,summaryItem:gq,summaryLabel:_q,summaryValue:yq,summaryDivider:vq,summaryTotal:xq,summaryTotalLabel:bq,summaryTotalValue:wq,currencyAmount:Sq,formActions:Cq,btnSecondary:jq,btnPrimary:kq},Nq=({onCancel:t})=>{const{currentCompany:e}=at(),{counterparties:r,loading:s,error:n}=vW((e==null?void 0:e.company_id)||null),{products:o,currencySymbol:i,error:l}=wW((e==null?void 0:e.company_id)||null),{messageState:c,closeMessage:d,showError:u}=Es(),h=b.useRef(null),f=b.useRef(null),{orderDate:p,notes:g,supplierTab:y,selectedSupplier:x,supplierInfo:m,orderItems:_,isDropdownOpen:v,searchTerm:w,showSuggestions:S,searchResults:E,isCreating:C,validationErrors:k,summary:N,isValid:I,setOrderDate:L,setNotes:T,setSupplierTab:j,setSelectedSupplier:M,setSupplierInfo:R,setIsDropdownOpen:O,setSearchTerm:z,setShowSuggestions:D,addOrderItem:P,updateOrderItemQuantity:$,updateOrderItemPrice:U,removeOrderItem:A,searchProducts:Ae,clearSearch:ae,validateForm:Ke,resetForm:Te}=CW();b.useEffect(()=>{l&&u({title:"Failed to Load Products",message:l})},[l,u]),b.useEffect(()=>{n&&u({title:"Failed to Load Suppliers",message:n})},[n,u]),b.useEffect(()=>{const X=J=>{h.current&&!h.current.contains(J.target)&&O(!1),f.current&&!f.current.contains(J.target)&&D(!1)};return(v||S)&&document.addEventListener("mousedown",X),()=>{document.removeEventListener("mousedown",X)}},[v,S,O,D]);const At=X=>{j(X)},sr=X=>{const J=X.target.value;z(J),Ae(J,o)},Cr=X=>{P(X),ae()},tt=X=>Math.round(X).toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),it=(X,J)=>{const ve=parseInt(J.replace(/,/g,""))||0;$(X,ve)},me=(X,J)=>{const ve=parseFloat(J.replace(/,/g,""))||0;U(X,ve)},Je=async()=>{if(e){if(!Ke()){const X=Object.values(k).join(`
`);u({title:"Validation Failed",message:X});return}u({title:"Not Implemented",message:"Order creation is not yet implemented"})}},St=()=>{Te(),t&&t()};return a.jsxs("div",{className:H.orderFormContainer,children:[a.jsxs("div",{className:H.orderFormMain,children:[a.jsxs("div",{className:H.formSection,children:[a.jsx("h2",{className:H.sectionTitle,children:"Order Information"}),a.jsxs("div",{className:H.formRow,children:[a.jsxs("div",{className:H.formGroup,children:[a.jsx("label",{className:H.formLabel,children:"Order Date"}),a.jsx("input",{type:"date",className:H.formInput,value:p,onChange:X=>L(X.target.value)})]}),a.jsxs("div",{className:H.formGroup,children:[a.jsx("label",{className:H.formLabel,children:"Notes"}),a.jsx("textarea",{className:H.formInput,rows:1,placeholder:"Optional notes...",value:g,onChange:X=>T(X.target.value)})]})]})]}),a.jsxs("div",{className:H.formSection,children:[a.jsx("h2",{className:H.sectionTitle,children:"Supplier Details"}),a.jsxs("div",{className:H.supplierTabs,children:[a.jsx("button",{className:`${H.supplierTab} ${y==="counter-party"?H.active:""}`,onClick:()=>At("counter-party"),children:"Counter Party"}),a.jsx("button",{className:`${H.supplierTab} ${y==="others"?H.active:""}`,onClick:()=>At("others"),children:"Others"})]}),y==="counter-party"&&a.jsx("div",{className:H.supplierTabContent,children:a.jsx("div",{className:H.formRow,children:a.jsxs("div",{className:H.formGroup,style:{gridColumn:"1 / -1"},children:[a.jsx("label",{className:H.formLabel,children:"Select Supplier"}),a.jsxs("div",{className:H.customDropdown,ref:h,children:[a.jsxs("div",{className:H.dropdownHeader,onClick:()=>O(!v),children:[a.jsxs("div",{className:H.dropdownSelected,children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"11",cy:"11",r:"8"}),a.jsx("path",{d:"m21 21-4.35-4.35"})]}),a.jsx("span",{children:x?x.name:"Choose a supplier..."})]}),a.jsx("svg",{className:`${H.dropdownArrow} ${v?H.open:""}`,width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polyline",{points:"6 9 12 15 18 9"})})]}),v&&a.jsx("div",{className:H.dropdownList,children:s?a.jsx("div",{className:H.dropdownOption,children:a.jsx(Ne,{size:"small"})}):r.length===0?a.jsx("div",{className:H.dropdownOption,children:a.jsx("span",{children:"No suppliers found"})}):r.map(X=>a.jsx("div",{className:`${H.dropdownOption} ${(x==null?void 0:x.counterparty_id)===X.counterparty_id?H.selected:""}`,onClick:()=>{M(X),O(!1)},children:a.jsxs("div",{className:H.supplierInfo,children:[a.jsx("div",{className:H.supplierName,children:X.name}),X.phone&&a.jsx("div",{className:H.supplierDetail,children:X.phone})]})},X.counterparty_id))})]})]})})}),y==="others"&&a.jsxs("div",{className:H.supplierTabContent,children:[a.jsxs("div",{className:H.formRow,children:[a.jsxs("div",{className:H.formGroup,children:[a.jsx("label",{className:H.formLabel,children:"Supplier Name"}),a.jsx("input",{type:"text",className:H.formInput,placeholder:"Enter supplier name",value:m.name,onChange:X=>R({name:X.target.value})})]}),a.jsxs("div",{className:H.formGroup,children:[a.jsx("label",{className:H.formLabel,children:"Contact Person"}),a.jsx("input",{type:"text",className:H.formInput,placeholder:"Enter contact name",value:m.contact,onChange:X=>R({contact:X.target.value})})]})]}),a.jsxs("div",{className:H.formRow,children:[a.jsxs("div",{className:H.formGroup,children:[a.jsx("label",{className:H.formLabel,children:"Phone"}),a.jsx("input",{type:"tel",className:H.formInput,placeholder:"Enter phone number",value:m.phone,onChange:X=>R({phone:X.target.value})})]}),a.jsxs("div",{className:H.formGroup,children:[a.jsx("label",{className:H.formLabel,children:"Email"}),a.jsx("input",{type:"email",className:H.formInput,placeholder:"Enter email address",value:m.email,onChange:X=>R({email:X.target.value})})]})]}),a.jsx("div",{className:H.formRow,children:a.jsxs("div",{className:H.formGroup,style:{gridColumn:"1 / -1"},children:[a.jsx("label",{className:H.formLabel,children:"Address"}),a.jsx("input",{type:"text",className:H.formInput,placeholder:"Enter supplier address",value:m.address,onChange:X=>R({address:X.target.value})})]})}),a.jsxs("div",{className:H.formRow,children:[a.jsxs("div",{className:H.formGroup,children:[a.jsx("label",{className:H.formLabel,children:"Bank Account"}),a.jsx("input",{type:"text",className:H.formInput,placeholder:"Enter bank account information",value:m.bank_account,onChange:X=>R({bank_account:X.target.value})})]}),a.jsxs("div",{className:H.formGroup,children:[a.jsx("label",{className:H.formLabel,children:"Memo"}),a.jsx("textarea",{className:H.formInput,rows:2,placeholder:"Enter any additional notes...",value:m.memo,onChange:X=>R({memo:X.target.value})})]})]})]})]}),a.jsxs("div",{className:H.formSection,children:[a.jsxs("div",{className:H.sectionHeader,children:[a.jsx("h2",{className:H.sectionTitle,children:"Order Items"}),a.jsxs("div",{className:H.sectionActions,children:[a.jsxs("div",{className:H.productSearch,ref:f,children:[a.jsxs("svg",{className:H.productSearchIcon,width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"11",cy:"11",r:"8"}),a.jsx("path",{d:"m21 21-4.35-4.35"})]}),a.jsx("input",{type:"text",placeholder:"Search products...",className:H.productSearchInput,value:w,onChange:sr}),S&&E.length>0&&a.jsx("div",{className:H.searchSuggestions,children:E.map(X=>{const J=X.selling_price||0,ve=X.quantity_on_hand||0;return a.jsx("div",{className:H.searchSuggestionItem,onClick:()=>Cr(X),children:a.jsxs("div",{className:H.searchSuggestionContent,children:[a.jsx("div",{className:H.searchSuggestionName,children:X.product_name}),a.jsxs("div",{className:H.searchSuggestionDetails,children:[a.jsxs("span",{className:H.searchSuggestionSku,children:["SKU: ",X.sku||"N/A"]}),a.jsxs("span",{children:["Stock: ",ve]}),a.jsxs("span",{className:H.searchSuggestionPrice,children:[i,tt(J)]})]})]})},X.product_id)})}),S&&w&&E.length===0&&a.jsx("div",{className:H.searchSuggestions,children:a.jsxs("div",{className:H.searchNoResults,children:['No products found matching "',w,'"']})})]}),a.jsxs("button",{className:H.btnSecondary,children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),a.jsx("polyline",{points:"14 2 14 8 20 8"}),a.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),a.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"})]}),"Import Excel"]}),a.jsxs("button",{className:H.btnSecondary,children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),a.jsx("polyline",{points:"7 10 12 15 17 10"}),a.jsx("line",{x1:"12",y1:"15",x2:"12",y2:"3"})]}),"Export Template & Product List"]})]})]}),a.jsx("div",{className:H.productsTableContainer,children:a.jsxs("table",{className:H.productsTable,children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Product Name"}),a.jsx("th",{children:"SKU"}),a.jsx("th",{children:"Unit"}),a.jsx("th",{children:"Quantity"}),a.jsx("th",{children:"Unit Price"}),a.jsx("th",{children:"Subtotal"}),a.jsx("th",{children:"Action"})]})}),a.jsx("tbody",{children:_.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:H.emptyMessage,children:"No items added yet. Search for products above to add them."})}):_.map(X=>a.jsxs("tr",{children:[a.jsx("td",{children:X.product_name}),a.jsx("td",{children:X.sku||"-"}),a.jsx("td",{children:X.unit}),a.jsx("td",{children:a.jsx("input",{type:"text",inputMode:"numeric",className:H.quantityInput,value:tt(X.quantity),onChange:J=>it(X.product_id,J.target.value)})}),a.jsx("td",{children:a.jsx("input",{type:"text",inputMode:"decimal",className:H.priceInput,value:tt(X.unit_price),onChange:J=>me(X.product_id,J.target.value)})}),a.jsxs("td",{className:H.subtotalCell,children:[i,tt(X.subtotal)]}),a.jsx("td",{children:a.jsx("button",{className:H.btnDelete,onClick:()=>A(X.product_id),type:"button",children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M3 6h18M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})})})})]},X.product_id))})]})})]}),a.jsxs("div",{className:H.formActions,children:[a.jsx("button",{className:H.btnSecondary,onClick:St,disabled:C,children:"Cancel"}),a.jsx("button",{className:H.btnPrimary,onClick:Je,disabled:!I||C,children:C?"Creating Order...":"Create Order"})]})]}),a.jsxs("div",{className:H.orderSummary,children:[a.jsx("h3",{className:H.summaryTitle,children:"Order Summary"}),a.jsxs("div",{className:H.summaryItem,children:[a.jsx("span",{className:H.summaryLabel,children:"Items"}),a.jsx("span",{className:H.summaryValue,children:N.items})]}),a.jsxs("div",{className:H.summaryItem,children:[a.jsx("span",{className:H.summaryLabel,children:"Total Quantity"}),a.jsx("span",{className:H.summaryValue,children:N.totalQuantity})]}),a.jsxs("div",{className:H.summaryItem,children:[a.jsx("span",{className:H.summaryLabel,children:"Subtotal"}),a.jsxs("span",{className:`${H.summaryValue} ${H.currencyAmount}`,children:[i,tt(N.subtotal)]})]}),a.jsx("div",{className:H.summaryDivider}),a.jsxs("div",{className:H.summaryTotal,children:[a.jsx("span",{className:H.summaryTotalLabel,children:"Total Amount"}),a.jsxs("span",{className:`${H.summaryTotalValue} ${H.currencyAmount}`,children:[i,tt(N.subtotal)]})]})]}),a.jsx(De,{variant:c.variant,title:c.title,message:c.message,isOpen:c.isOpen,onClose:d})]})},Iq="_pageContainer_2o8k3_7",Eq="_pageContent_2o8k3_15",Tq="_pageHeader_2o8k3_24",Aq="_pageTitle_2o8k3_28",Lq="_pageSubtitle_2o8k3_35",Dq="_tabsContainer_2o8k3_42",Mq="_tabsNav_2o8k3_50",Rq="_tabItem_2o8k3_56",Oq="_active_2o8k3_76",Pq="_tabIcon_2o8k3_82",$q="_tabBadge_2o8k3_86",Fq="_tabContent_2o8k3_101",Bq="_comingSoon_2o8k3_107",Hq="_loadingSpinner_2o8k3_126",Vq="_spinner_2o8k3_133",zq="_spin_2o8k3_133",Uq="_errorState_2o8k3_148",Wq="_errorMessage_2o8k3_153",qq="_retryButton_2o8k3_159",Gq="_emptyState_2o8k3_177",Jq="_emptyIcon_2o8k3_182",Kq="_emptyTitle_2o8k3_189",Yq="_emptyDescription_2o8k3_196",Qq="_tableContainer_2o8k3_203",Zq="_ordersTable_2o8k3_208",Xq="_orderNumber_2o8k3_263",eG="_currencyAmount_2o8k3_274",tG="_receivingProgress_2o8k3_281",rG="_progressText_2o8k3_287",sG="_progressBar_2o8k3_293",nG="_progressFill_2o8k3_303",oG="_progressPercentage_2o8k3_310",aG="_statusBadge_2o8k3_316",iG="_pending_2o8k3_325",lG="_approved_2o8k3_330",cG="_partial_2o8k3_335",dG="_received_2o8k3_340",uG="_cancelled_2o8k3_345",hG="_actionBtn_2o8k3_351",ze={pageContainer:Iq,pageContent:Eq,pageHeader:Tq,pageTitle:Aq,pageSubtitle:Lq,tabsContainer:Dq,tabsNav:Mq,tabItem:Rq,active:Oq,tabIcon:Pq,tabBadge:$q,tabContent:Fq,comingSoon:Bq,loadingSpinner:Hq,spinner:Vq,spin:zq,errorState:Uq,errorMessage:Wq,retryButton:qq,emptyState:Gq,emptyIcon:Jq,emptyTitle:Kq,emptyDescription:Yq,tableContainer:Qq,ordersTable:Zq,orderNumber:Xq,currencyAmount:eG,receivingProgress:tG,progressText:rG,progressBar:sG,progressFill:nG,progressPercentage:oG,statusBadge:aG,pending:iG,approved:lG,partial:cG,received:dG,cancelled:uG,actionBtn:hG},W_=t=>Math.round(t).toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),fG=()=>{const{currentCompany:t,currentStore:e}=at(),{orders:r,activeTab:s,loading:n,error:o,setActiveTab:i,refresh:l}=gW((t==null?void 0:t.company_id)||"",(e==null?void 0:e.store_id)||null),{messageState:c,closeMessage:d,showError:u}=Es();return b.useEffect(()=>{o&&u({title:"Failed to Load Orders",message:o,confirmText:"Retry",onConfirm:()=>{d(),l()}})},[o,u,d,l]),t?a.jsxs(a.Fragment,{children:[a.jsx(fe,{activeItem:"product"}),a.jsx("div",{className:ze.pageContainer,children:a.jsxs("main",{className:ze.pageContent,children:[a.jsxs("div",{className:ze.pageHeader,children:[a.jsx("h1",{className:ze.pageTitle,children:"Purchase Orders"}),a.jsx("p",{className:ze.pageSubtitle,children:"Manage supplier orders and track deliveries"})]}),a.jsxs("div",{className:ze.tabsContainer,children:[a.jsxs("div",{className:ze.tabsNav,children:[a.jsxs("button",{className:`${ze.tabItem} ${s==="new-order"?ze.active:""}`,onClick:()=>i("new-order"),children:[a.jsxs("svg",{className:ze.tabIcon,width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),a.jsx("polyline",{points:"14 2 14 8 20 8"}),a.jsx("line",{x1:"12",y1:"18",x2:"12",y2:"12"}),a.jsx("line",{x1:"9",y1:"15",x2:"15",y2:"15"})]}),a.jsx("span",{children:"New Order"})]}),a.jsxs("button",{className:`${ze.tabItem} ${s==="order-list"?ze.active:""}`,onClick:()=>i("order-list"),children:[a.jsxs("svg",{className:ze.tabIcon,width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),a.jsx("line",{x1:"7",y1:"8",x2:"17",y2:"8"}),a.jsx("line",{x1:"7",y1:"12",x2:"17",y2:"12"}),a.jsx("line",{x1:"7",y1:"16",x2:"12",y2:"16"})]}),a.jsx("span",{children:"Order List"}),a.jsx("span",{className:ze.tabBadge,children:r.length})]})]}),s==="new-order"&&a.jsx("div",{className:ze.tabContent,children:a.jsx(Nq,{onSuccess:()=>{l(),i("order-list")},onCancel:()=>i("order-list")})}),s==="order-list"&&a.jsx("div",{className:ze.tabContent,children:n?a.jsx(Ne,{size:"large",fullscreen:!0}):r.length===0?a.jsxs("div",{className:ze.emptyState,children:[a.jsxs("svg",{className:ze.emptyIcon,width:"120",height:"120",viewBox:"0 0 120 120",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[a.jsx("circle",{cx:"60",cy:"60",r:"50",fill:"#F0F6FF"}),a.jsx("rect",{x:"35",y:"40",width:"50",height:"60",rx:"4",fill:"white",stroke:"#0064FF",strokeWidth:"2"}),a.jsx("rect",{x:"40",y:"35",width:"50",height:"60",rx:"4",fill:"white",stroke:"#0064FF",strokeWidth:"2"}),a.jsx("line",{x1:"48",y1:"45",x2:"75",y2:"45",stroke:"#E9ECEF",strokeWidth:"2",strokeLinecap:"round"}),a.jsx("line",{x1:"48",y1:"52",x2:"70",y2:"52",stroke:"#E9ECEF",strokeWidth:"2",strokeLinecap:"round"}),a.jsx("line",{x1:"48",y1:"59",x2:"72",y2:"59",stroke:"#E9ECEF",strokeWidth:"2",strokeLinecap:"round"}),a.jsx("circle",{cx:"60",cy:"75",r:"12",fill:"#0064FF"}),a.jsx("path",{d:"M56 75 L58 77 L64 71",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),a.jsx("h3",{className:ze.emptyTitle,children:"No Purchase Orders"}),a.jsx("p",{className:ze.emptyDescription,children:"You don't have any purchase orders yet"})]}):a.jsx("div",{className:ze.tableContainer,children:a.jsxs("table",{className:ze.ordersTable,children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:a.jsx("input",{type:"checkbox"})}),a.jsx("th",{children:"Order Number"}),a.jsx("th",{children:"Date"}),a.jsx("th",{children:"Supplier"}),a.jsx("th",{children:"Items"}),a.jsx("th",{children:"Total Amount"}),a.jsx("th",{children:"Receiving Status"}),a.jsx("th",{children:"Status"}),a.jsx("th",{children:"Action"})]})}),a.jsx("tbody",{children:r.map(h=>{const f=h.receivingProgress;return a.jsxs("tr",{children:[a.jsx("td",{children:a.jsx("input",{type:"checkbox","data-order-id":h.orderId})}),a.jsx("td",{children:a.jsx("span",{className:ze.orderNumber,children:h.orderNumber})}),a.jsx("td",{children:h.formattedDate}),a.jsx("td",{children:h.supplierName}),a.jsxs("td",{children:[h.itemCount," item",h.itemCount!==1?"s":""]}),a.jsx("td",{className:ze.currencyAmount,children:h.formatCurrency(h.totalAmount)}),a.jsx("td",{children:h.status!=="cancelled"?a.jsxs("div",{className:ze.receivingProgress,children:[a.jsxs("span",{className:ze.progressText,children:[W_(f.received),"/",W_(f.total)]}),f.total>0&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:ze.progressBar,children:a.jsx("div",{className:ze.progressFill,style:{width:`${f.percentage}%`}})}),a.jsxs("small",{className:ze.progressPercentage,children:["(",f.percentage,"%)"]})]})]}):"-"}),a.jsx("td",{children:a.jsx("span",{className:`${ze.statusBadge} ${ze[h.status]}`,children:h.statusDisplay})}),a.jsx("td",{children:a.jsx("button",{className:ze.actionBtn,"data-order-id":h.orderId,children:"View"})})]},h.orderId)})})]})})})]})]})}),a.jsx(De,{variant:c.variant,title:c.title,message:c.message,isOpen:c.isOpen,onClose:d,confirmText:c.confirmText,onConfirm:c.onConfirm})]}):a.jsxs(a.Fragment,{children:[a.jsx(fe,{activeItem:"product"}),a.jsx("div",{className:ze.pageContainer,children:a.jsx("main",{className:ze.pageContent,children:a.jsx("div",{className:ze.emptyState,children:a.jsx("p",{children:"Please select a company to view orders"})})})})]})};class mG{async getCurrentUserId(){var e;try{const{data:{session:r},error:s}=await ne.getClient().auth.getSession();return s||!((e=r==null?void 0:r.user)!=null&&e.id)?(console.error("getCurrentUserId error:",s),null):r.user.id}catch(r){return console.error("getCurrentUserId error:",r),null}}async getOrders(e){var r;try{const{data:s,error:n}=await ne.getClient().rpc("get_inventory_order_list",{p_company_id:e});if(n)throw console.error("getOrders RPC error:",n),n;return console.log(" RPC Response:",s),(r=s==null?void 0:s.orders)!=null&&r[0]&&(console.log(" First Order:",s.orders[0]),console.log(" First Order Progress Fields:",{total_items:s.orders[0].total_items,received_items:s.orders[0].received_items,remaining_items:s.orders[0].remaining_items})),s}catch(s){throw console.error("getOrders error:",s),s}}async submitReceive(e,r,s,n,o,i){try{const{data:l,error:c}=await ne.getClient().rpc("inventory_order_receive",{p_company_id:e,p_store_id:r,p_order_id:s,p_user_id:n,p_items:o,p_notes:i||null});if(c)throw console.error("submitReceive RPC error:",c),c;return l}catch(l){throw console.error("submitReceive error:",l),l}}}class pG{constructor(e){W(this,"orderId");W(this,"orderNumber");W(this,"supplierName");W(this,"status");W(this,"orderDate");W(this,"totalItems");W(this,"receivedItems");W(this,"remainingItems");W(this,"items");this.orderId=e.orderId,this.orderNumber=e.orderNumber,this.supplierName=e.supplierName,this.status=e.status,this.orderDate=e.orderDate,this.totalItems=e.totalItems,this.receivedItems=e.receivedItems,this.remainingItems=e.remainingItems,this.items=e.items}get progressPercentage(){return this.totalItems===0?0:Math.round(this.receivedItems/this.totalItems*100)}get isReceivable(){return this.status==="pending"||this.status==="partial"}get displayName(){return`${this.orderNumber} - ${this.supplierName}`}}class gG{constructor(e){W(this,"productId");W(this,"sku");W(this,"productName");W(this,"quantityOrdered");W(this,"quantityReceived");W(this,"quantityRemaining");W(this,"unit");this.productId=e.productId,this.sku=e.sku,this.productName=e.productName,this.quantityOrdered=e.quantityOrdered,this.quantityReceived=e.quantityReceived,this.quantityRemaining=e.quantityRemaining,this.unit=e.unit}get isFullyReceived(){return this.quantityReceived>=this.quantityOrdered}get progressPercentage(){return this.quantityOrdered===0?0:Math.round(this.quantityReceived/this.quantityOrdered*100)}canReceiveMore(e){return this.quantityReceived+e<=this.quantityOrdered}getDisplayName(){return`${this.productName} (${this.sku})`}}class wm{static fromDTO(e){return new gG({productId:e.product_id,sku:e.sku,productName:e.product_name,quantityOrdered:e.quantity_ordered||0,quantityReceived:e.quantity_received_total||0,quantityRemaining:(e.quantity_ordered||0)-(e.quantity_received_total||0),unit:""})}static toDTO(e){return{product_id:e.productId,sku:e.sku,product_name:e.productName,quantity_ordered:e.quantityOrdered,quantity_received_total:e.quantityReceived}}static fromDTOArray(e){return e.map(r=>wm.fromDTO(r))}}class td{static fromDTO(e){var s,n,o,i;const r=e.items?wm.fromDTOArray(e.items):void 0;return new pG({orderId:e.order_id,orderNumber:e.order_number,supplierName:e.supplier_name,status:e.status,orderDate:te.toLocal(e.order_date),totalItems:((s=e.summary)==null?void 0:s.total_ordered)||0,receivedItems:((n=e.summary)==null?void 0:n.total_received)||0,remainingItems:(((o=e.summary)==null?void 0:o.total_ordered)||0)-(((i=e.summary)==null?void 0:i.total_received)||0),items:r})}static toDTO(e){var r;return{order_id:e.orderId,order_number:e.orderNumber,supplier_name:e.supplierName,status:e.status,order_date:te.toUtc(e.orderDate),summary:{total_products:((r=e.items)==null?void 0:r.length)||0,total_ordered:e.totalItems,total_received:e.receivedItems,completion_rate:e.progressPercentage||0}}}static fromDTOArray(e){return e.map(r=>td.fromDTO(r))}static filterReceivableOrders(e){return e.filter(r=>r.isReceivable)}}class _G{constructor(e){W(this,"success");W(this,"receiptNumber");W(this,"message");W(this,"receivedCount");W(this,"warnings");W(this,"error");this.success=e.success,this.receiptNumber=e.receiptNumber,this.message=e.message,this.receivedCount=e.receivedCount,this.warnings=e.warnings,this.error=e.error}get hasWarnings(){return!!this.warnings&&this.warnings.length>0}get displayMessage(){return this.success?this.message||"Products received successfully":this.error||"Failed to receive products"}}class yG{static fromDTO(e){return new _G({success:e.success,receiptNumber:e.receipt_number,message:e.message,receivedCount:e.received_count,warnings:e.warnings,error:e.success?void 0:e.message})}static toDTO(e){return{success:e.success,receipt_number:e.receiptNumber,message:e.message,received_count:e.receivedCount,warnings:e.warnings}}}class wx{constructor(){W(this,"dataSource");this.dataSource=new mG}async getOrders(e){try{const r=await this.dataSource.getOrders(e);if(!r||!r.orders)return{success:!0,data:[]};const s=td.fromDTOArray(r.orders);return{success:!0,data:td.filterReceivableOrders(s)}}catch(r){return{success:!1,error:r instanceof Error?r.message:"Failed to get orders"}}}async getOrderProducts(e,r){return{success:!0,data:[]}}async searchProducts(e,r){return{success:!0,data:[]}}async getCurrentUserId(){try{const e=await this.dataSource.getCurrentUserId();return e?{success:!0,data:e}:{success:!1,error:"User session not found. Please login again."}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Failed to get user ID"}}}async submitReceive(e,r,s,n,o,i){try{const l=o.map(u=>({product_id:u.productId,quantity_received:u.quantityReceived})),c=await this.dataSource.submitReceive(e,r,s,n,l,i);return{success:!0,data:yG.fromDTO(c)}}catch(l){return{success:!1,error:l instanceof Error?l.message:"Failed to submit receive"}}}}const vG=Object.freeze(Object.defineProperty({__proto__:null,ProductReceiveRepositoryImpl:wx},Symbol.toStringTag,{value:"Module"}));class xG{static validateScannedItem(e,r){const s=[];return e.count<=0&&s.push({field:"quantity",message:"Quantity must be greater than 0"}),e.count>r.quantityRemaining&&s.push({field:"quantity",message:`Cannot receive ${e.count} items. Only ${r.quantityRemaining} items remaining in order`}),e.sku!==r.sku&&s.push({field:"sku",message:"SKU mismatch"}),s}static validateSubmission(e,r,s){const n=[];if(!r)return n.push({field:"order",message:"No order selected. Please select an order first"}),n;if(r.isReceivable||n.push({field:"order",message:`Order status "${r.status}" is not receivable. Only pending or partial orders can receive products`}),e.length===0)return n.push({field:"items",message:"No items scanned. Please scan at least one product"}),n;for(const o of e){const i=s.find(c=>c.sku===o.sku);if(!i){n.push({field:`item_${o.sku}`,message:`Product ${o.sku} is not in this order`});continue}const l=this.validateScannedItem(o,i);n.push(...l)}return n}static validateSKUInput(e){const r=e.trim();return r?r.length<2?{field:"sku",message:"SKU must be at least 2 characters"}:/^[a-zA-Z0-9-_]+$/.test(r)?null:{field:"sku",message:"SKU contains invalid characters. Only letters, numbers, hyphens, and underscores are allowed"}:{field:"sku",message:"SKU cannot be empty"}}static validateQuantity(e,r){return e<=0?{field:"quantity",message:"Quantity must be greater than 0"}:Number.isInteger(e)?e>r?{field:"quantity",message:`Quantity cannot exceed ${r}`}:null:{field:"quantity",message:"Quantity must be a whole number"}}static isProductInOrder(e,r){return r.some(s=>s.sku===e)}static getRemainingQuantity(e,r){const s=r.find(n=>n.sku===e);return s?s.quantityRemaining:0}static isOrderFullyReceived(e){return e.every(r=>r.isFullyReceived)}static calculateTotalQuantity(e){return e.reduce((r,s)=>r+s.count,0)}static hasDuplicateSKUs(e){const r=e.map(n=>n.sku),s=new Set(r);return r.length!==s.size}}class bG{constructor(e,r,s,n=1){W(this,"sku");W(this,"productId");W(this,"productName");W(this,"count");W(this,"scannedAt");W(this,"lastScannedAt");this.sku=e,this.productId=r,this.productName=s,this.count=n,this.scannedAt=new Date,this.lastScannedAt=new Date}incrementCount(){this.count++,this.lastScannedAt=new Date}decrementCount(){this.count>0&&(this.count--,this.lastScannedAt=new Date)}setCount(e){e>=0&&(this.count=e,this.lastScannedAt=new Date)}get displayName(){return`${this.productName} (${this.sku})`}get formattedTime(){const r=new Date().getTime()-this.lastScannedAt.getTime(),s=Math.floor(r/1e3);if(s<60)return"Just now";const n=Math.floor(s/60);return n<60?`${n}m ago`:`${Math.floor(n/60)}h ago`}}const q_=new wx,Lt=Jt((t,e)=>({orders:[],selectedOrder:null,orderProducts:[],loadingOrders:!1,scannedItems:new Map,skuInput:"",autocompleteResults:[],showAutocomplete:!1,productSearchTerm:"",filteredProducts:[],submitting:!1,error:null,setSkuInput:r=>t({skuInput:r}),setShowAutocomplete:r=>t({showAutocomplete:r}),setProductSearchTerm:r=>{t({productSearchTerm:r});const s=e();if(!r.trim()){t({filteredProducts:s.orderProducts});return}const n=r.toLowerCase(),o=s.orderProducts.filter(i=>i.sku.toLowerCase().includes(n)||i.productName.toLowerCase().includes(n));t({filteredProducts:o})},setError:r=>t({error:r}),clearError:()=>t({error:null}),loadOrders:async r=>{if(!r){t({orders:[],selectedOrder:null,orderProducts:[]});return}t({loadingOrders:!0,error:null});try{const s=await q_.getOrders(r);if(!s.success){t({error:s.error||"Failed to load orders",orders:[],selectedOrder:null,orderProducts:[],loadingOrders:!1});return}const n=s.data||[];t({orders:n});const o=e();if(n.length>0){if(o.selectedOrder){const i=n.find(l=>{var c;return l.orderId===((c=o.selectedOrder)==null?void 0:c.orderId)});t(i?{selectedOrder:i,orderProducts:i.items||[],filteredProducts:i.items||[]}:{selectedOrder:n[0],orderProducts:n[0].items||[],filteredProducts:n[0].items||[]})}else t({selectedOrder:n[0],orderProducts:n[0].items||[],filteredProducts:n[0].items||[]});t({scannedItems:new Map,skuInput:"",productSearchTerm:""})}}catch(s){t({error:s instanceof Error?s.message:"An unexpected error occurred",orders:[],selectedOrder:null,orderProducts:[]})}finally{t({loadingOrders:!1})}},selectOrder:r=>{t({selectedOrder:r,orderProducts:r.items||[],filteredProducts:r.items||[],scannedItems:new Map,skuInput:"",productSearchTerm:"",error:null})},handleSkuInput:r=>{t({skuInput:r});const s=r.trim().toLowerCase();if(!s||s.length<1){t({showAutocomplete:!1,autocompleteResults:[]});return}let o=e().orderProducts.filter(i=>i.sku.toLowerCase().includes(s)||i.productName.toLowerCase().includes(s));o.sort((i,l)=>{const c=i.sku.toLowerCase().startsWith(s),d=l.sku.toLowerCase().startsWith(s);return c&&!d?-1:!c&&d?1:i.sku.localeCompare(l.sku)}),o=o.slice(0,10),t({autocompleteResults:o,showAutocomplete:o.length>0})},addScannedItem:r=>{const s=e(),n=new Map(s.scannedItems),o=n.get(r.sku);o?o.incrementCount():n.set(r.sku,new bG(r.sku,r.productId,r.productName,1)),t({scannedItems:n,skuInput:"",showAutocomplete:!1,error:null})},updateScannedQuantity:(r,s)=>{const n=e(),o=new Map(n.scannedItems),i=o.get(r);i&&s>0?i.setCount(s):i&&s===0&&o.delete(r),t({scannedItems:o})},removeScannedItem:r=>{const s=e(),n=new Map(s.scannedItems);n.delete(r),t({scannedItems:n})},clearAllScanned:()=>{t({scannedItems:new Map,skuInput:"",error:null})},submitReceive:async(r,s,n)=>{const o=e(),i=Array.from(o.scannedItems.values()),l=xG.validateSubmission(i,o.selectedOrder,o.orderProducts);if(l.length>0){const c=l[0].message;return t({error:c}),{success:!1,error:c}}if(!r||!s){const c="Company or Store is not selected";return t({error:c}),{success:!1,error:c}}if(!o.selectedOrder){const c="No order selected";return t({error:c}),{success:!1,error:c}}t({submitting:!0,error:null});try{const c=Array.from(o.scannedItems.values()).map(u=>({productId:u.productId,quantityReceived:u.count})),d=await q_.submitReceive(r,s,o.selectedOrder.orderId,n,c,null);if(!d.success){const u=d.error||"Failed to submit receive";return t({error:u,submitting:!1}),{success:!1,error:u}}return e().clearAllScanned(),await e().loadOrders(r),{success:!0,data:d.data}}catch(c){const d=c instanceof Error?c.message:"An unexpected error occurred";return t({error:d,submitting:!1}),{success:!1,error:d}}finally{t({submitting:!1})}}})),wG=(t,e)=>{const r=Lt(L=>L.orders),s=Lt(L=>L.selectedOrder),n=Lt(L=>L.orderProducts),o=Lt(L=>L.loadingOrders),i=Lt(L=>L.scannedItems),l=Lt(L=>L.skuInput),c=Lt(L=>L.autocompleteResults),d=Lt(L=>L.showAutocomplete),u=Lt(L=>L.productSearchTerm),h=Lt(L=>L.filteredProducts),f=Lt(L=>L.submitting),p=Lt(L=>L.error),g=Lt(L=>L.selectOrder),y=Lt(L=>L.loadOrders),x=Lt(L=>L.handleSkuInput),m=Lt(L=>L.setShowAutocomplete),_=Lt(L=>L.setProductSearchTerm),v=Lt(L=>L.addScannedItem),w=Lt(L=>L.updateScannedQuantity),S=Lt(L=>L.removeScannedItem),E=Lt(L=>L.clearAllScanned),C=Lt(L=>L.submitReceive);b.useEffect(()=>{y(t)},[t,y]);const k=b.useCallback(async()=>{if(!t||!e)return{success:!1,error:"Company or Store is not selected"};const{ProductReceiveRepositoryImpl:L}=await Xf(async()=>{const{ProductReceiveRepositoryImpl:R}=await Promise.resolve().then(()=>vG);return{ProductReceiveRepositoryImpl:R}},void 0),j=await new L().getCurrentUserId();if(!j.success||!j.data)return{success:!1,error:j.error||"Failed to get user ID"};const M=j.data;return await C(t,e,M)},[t,e,C]),N=Array.from(i.values()).reduce((L,T)=>L+T.count,0),I=Array.from(i.values());return{orders:r,selectedOrder:s,selectOrder:g,loadingOrders:o,orderProducts:n,filteredProducts:h,productSearchTerm:u,setProductSearchTerm:_,scannedItems:I,totalScannedCount:N,skuInput:l,handleSkuInput:x,autocompleteResults:c,showAutocomplete:d,setShowAutocomplete:m,addScannedItem:v,updateScannedQuantity:w,removeScannedItem:S,clearAllScanned:E,submitReceive:k,submitting:f,error:p}},SG="_selector_1pwab_1",CG="_button_1pwab_7",jG="_open_1pwab_27",kG="_icon_1pwab_33",NG="_label_1pwab_40",IG="_dropdown_1pwab_50",EG="_dropdownMenu_1pwab_58",TG="_option_1pwab_72",AG="_selected_1pwab_85",LG="_optionContent_1pwab_89",DG="_optionText_1pwab_96",MG="_optionMeta_1pwab_102",RG="_checkmark_1pwab_107",zt={selector:SG,button:CG,open:jG,icon:kG,label:NG,dropdown:IG,dropdownMenu:EG,option:TG,selected:AG,optionContent:LG,optionText:DG,optionMeta:MG,checkmark:RG},OG=({orders:t,selectedOrder:e,onSelectOrder:r,loading:s=!1})=>{const[n,o]=b.useState(!1),i=b.useRef(null);b.useEffect(()=>{const u=h=>{i.current&&!i.current.contains(h.target)&&o(!1)};return document.addEventListener("click",u),()=>document.removeEventListener("click",u)},[]);const l=u=>{r(u),o(!1)};if(s)return a.jsx("div",{className:zt.selector,children:a.jsxs("div",{className:zt.button,children:[a.jsx(Ne,{size:"small"}),a.jsx("span",{className:zt.label,style:{marginLeft:"8px"},children:"Loading..."})]})});if(t.length===0)return a.jsx("div",{className:zt.selector,children:a.jsx("div",{className:zt.button,children:a.jsx("span",{className:zt.label,children:"No receivable orders"})})});const c=n?`${zt.button} ${zt.open}`:zt.button,d=u=>{const h=zt.option;return(e==null?void 0:e.orderId)===u?`${h} ${zt.selected}`:h};return a.jsxs("div",{className:zt.selector,ref:i,children:[a.jsxs("div",{className:c,onClick:()=>o(!n),children:[a.jsx("svg",{className:zt.icon,fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M19,3H5A2,2 0 0,0 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5A2,2 0 0,0 19,3M19,19H5V5H19V19M17,17H7V15H17V17M17,13H7V11H17V13M17,9H7V7H17V9Z"})}),a.jsx("span",{className:zt.label,children:e?e.displayName:"Select Order..."}),a.jsx("svg",{className:zt.dropdown,fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M7,10L12,15L17,10H7Z"})})]}),n&&a.jsx("div",{className:zt.dropdownMenu,children:t.map(u=>a.jsxs("div",{className:d(u.orderId),onClick:()=>l(u),children:[a.jsxs("div",{className:zt.optionContent,children:[a.jsx("span",{className:zt.optionText,children:u.displayName}),a.jsxs("span",{className:zt.optionMeta,children:[u.receivedItems,"/",u.totalItems," received"]})]}),(e==null?void 0:e.orderId)===u.orderId&&a.jsx("svg",{className:zt.checkmark,fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M9,20.42L2.79,14.21L5.62,11.38L9,14.77L18.88,4.88L21.71,7.71L9,20.42Z"})})]},u.orderId))})]})},PG="_container_1uidr_1",$G="_pageContent_1uidr_7",FG="_header_1uidr_14",BG="_title_1uidr_18",HG="_subtitle_1uidr_25",VG="_controls_1uidr_31",zG="_emptyState_1uidr_55",UG="_placeholder_1uidr_56",WG="_placeholderIcon_1uidr_64",qG="_content_1uidr_76",GG="_rightColumn_1uidr_82",JG="_scannerCard_1uidr_88",KG="_scannedCard_1uidr_89",YG="_sectionTitle_1uidr_96",QG="_skuInputWrapper_1uidr_103",ZG="_skuInput_1uidr_103",XG="_autocomplete_1uidr_122",eJ="_autocompleteItem_1uidr_136",tJ="_productName_1uidr_152",rJ="_productSku_1uidr_159",sJ="_productStock_1uidr_165",nJ="_scannedHeader_1uidr_170",oJ="_badge_1uidr_177",aJ="_emptyScanned_1uidr_186",iJ="_scannedList_1uidr_194",lJ="_scannedItem_1uidr_200",cJ="_itemInfo_1uidr_210",dJ="_itemName_1uidr_214",uJ="_itemSku_1uidr_221",hJ="_itemActions_1uidr_227",fJ="_quantityControls_1uidr_233",mJ="_qtyBtn_1uidr_242",pJ="_qty_1uidr_242",gJ="_removeBtn_1uidr_268",_J="_actions_1uidr_289",yJ="_btnSecondary_1uidr_296",vJ="_btnPrimary_1uidr_297",xJ="_orderDetailsCard_1uidr_335",bJ="_orderSummary_1uidr_342",wJ="_orderTitle_1uidr_346",SJ="_progressContainer_1uidr_353",CJ="_progressRing_1uidr_359",jJ="_progressRingCircle_1uidr_370",kJ="_progressRingProgress_1uidr_376",NJ="_progressRingText_1uidr_384",IJ="_progressStats_1uidr_394",EJ="_progressStat_1uidr_394",TJ="_progressStatLabel_1uidr_407",AJ="_progressStatValue_1uidr_412",LJ="_productListSection_1uidr_418",DJ="_productListTitle_1uidr_422",MJ="_productSearch_1uidr_429",RJ="_productList_1uidr_418",OJ="_productItem_1uidr_448",PJ="_productItemHeader_1uidr_462",$J="_productItemName_1uidr_469",FJ="_productItemProgress_1uidr_475",BJ="_productItemSku_1uidr_480",re={container:PG,pageContent:$G,header:FG,title:BG,subtitle:HG,controls:VG,emptyState:zG,placeholder:UG,placeholderIcon:WG,content:qG,rightColumn:GG,scannerCard:JG,scannedCard:KG,sectionTitle:YG,skuInputWrapper:QG,skuInput:ZG,autocomplete:XG,autocompleteItem:eJ,productName:tJ,productSku:rJ,productStock:sJ,scannedHeader:nJ,badge:oJ,emptyScanned:aJ,scannedList:iJ,scannedItem:lJ,itemInfo:cJ,itemName:dJ,itemSku:uJ,itemActions:hJ,quantityControls:fJ,qtyBtn:mJ,qty:pJ,removeBtn:gJ,actions:_J,btnSecondary:yJ,btnPrimary:vJ,orderDetailsCard:xJ,orderSummary:bJ,orderTitle:wJ,progressContainer:SJ,progressRing:CJ,progressRingCircle:jJ,progressRingProgress:kJ,progressRingText:NJ,progressStats:IJ,progressStat:EJ,progressStatLabel:TJ,progressStatValue:AJ,productListSection:LJ,productListTitle:DJ,productSearch:MJ,productList:RJ,productItem:OJ,productItemHeader:PJ,productItemName:$J,productItemProgress:FJ,productItemSku:BJ},HJ=()=>{var P;const{currentCompany:t,currentStore:e,setCurrentStore:r}=at(),{messageState:s,closeMessage:n,showError:o,showSuccess:i}=Es(),{orders:l,selectedOrder:c,selectOrder:d,loadingOrders:u,filteredProducts:h,productSearchTerm:f,setProductSearchTerm:p,scannedItems:g,skuInput:y,handleSkuInput:x,autocompleteResults:m,showAutocomplete:_,setShowAutocomplete:v,addScannedItem:w,updateScannedQuantity:S,removeScannedItem:E,clearAllScanned:C,submitReceive:k,submitting:N,error:I}=wG((t==null?void 0:t.company_id)||"",(e==null?void 0:e.store_id)||null),L=async()=>{(await k()).success&&i({message:"Products received successfully!",autoCloseDuration:2e3})};b.useEffect(()=>{I&&o({message:I})},[I,o]);const T=(c==null?void 0:c.totalItems)||0,j=(c==null?void 0:c.receivedItems)||0,M=(c==null?void 0:c.remainingItems)||0,R=T>0?Math.round(j/T*100):0;console.log(" Progress Debug:",{selectedOrder:c,totalItems:T,receivedItems:j,remainingItems:M,progressPercentage:R,orderItems:((P=c==null?void 0:c.items)==null?void 0:P.length)||0});const O=28,z=2*Math.PI*O,D=z-R/100*z;return t?a.jsxs(a.Fragment,{children:[a.jsx(fe,{activeItem:"product"}),a.jsx("div",{className:re.container,children:a.jsxs("div",{className:re.pageContent,children:[a.jsxs("div",{className:re.header,children:[a.jsx("h1",{className:re.title,children:"Product Receive"}),a.jsx("p",{className:re.subtitle,children:"Scan and receive products from purchase orders"})]}),a.jsxs("div",{className:re.controls,children:[a.jsx(Hs,{stores:t.stores||[],selectedStoreId:(e==null?void 0:e.store_id)||null,onStoreSelect:$=>{var U;if($){const A=(U=t.stores)==null?void 0:U.find(Ae=>Ae.store_id===$);r(A||null)}else r(null)},showAllStoresOption:!1}),a.jsx(OG,{orders:l,selectedOrder:c,onSelectOrder:d,loading:u})]}),u?a.jsx(Ne,{size:"large",fullscreen:!0}):c?a.jsxs("div",{className:re.content,children:[a.jsxs("div",{className:re.orderDetailsCard,children:[a.jsxs("div",{className:re.orderSummary,children:[a.jsx("h2",{className:re.orderTitle,children:"Order Progress"}),a.jsxs("div",{className:re.progressContainer,children:[a.jsxs("div",{className:re.progressRing,children:[a.jsxs("svg",{width:"60",height:"60",children:[a.jsx("circle",{className:re.progressRingCircle,cx:"30",cy:"30",r:O}),a.jsx("circle",{className:re.progressRingProgress,cx:"30",cy:"30",r:O,strokeDasharray:z,strokeDashoffset:D})]}),a.jsxs("div",{className:re.progressRingText,children:[R,"%"]})]}),a.jsxs("div",{className:re.progressStats,children:[a.jsxs("div",{className:re.progressStat,children:[a.jsx("span",{className:re.progressStatLabel,children:"Received"}),a.jsx("span",{className:re.progressStatValue,children:j})]}),a.jsxs("div",{className:re.progressStat,children:[a.jsx("span",{className:re.progressStatLabel,children:"Remaining"}),a.jsx("span",{className:re.progressStatValue,children:M})]}),a.jsxs("div",{className:re.progressStat,children:[a.jsx("span",{className:re.progressStatLabel,children:"Total"}),a.jsx("span",{className:re.progressStatValue,children:T})]})]})]})]}),a.jsxs("div",{className:re.productListSection,children:[a.jsx("h3",{className:re.productListTitle,children:"Products in Order"}),a.jsx("input",{type:"text",placeholder:"Search products...",value:f,onChange:$=>p($.target.value),className:re.productSearch}),a.jsx("div",{className:re.productList,children:h.map($=>{const U=$.quantityOrdered>0?Math.round($.quantityReceived/$.quantityOrdered*100):0;return a.jsxs("div",{className:re.productItem,children:[a.jsxs("div",{className:re.productItemHeader,children:[a.jsx("span",{className:re.productItemName,children:$.productName}),a.jsxs("span",{className:re.productItemProgress,style:{color:U===100?"var(--toss-green-500)":"var(--text-secondary)"},children:[$.quantityReceived,"/",$.quantityOrdered]})]}),a.jsx("div",{className:re.productItemSku,children:$.sku})]},$.productId)})})]})]}),a.jsxs("div",{className:re.rightColumn,children:[a.jsxs("div",{className:re.scannerCard,children:[a.jsx("h2",{className:re.sectionTitle,children:"Scan Product"}),a.jsxs("div",{className:re.skuInputWrapper,children:[a.jsx("input",{type:"text",value:y,onChange:$=>x($.target.value),onFocus:()=>y&&v(!0),placeholder:"Scan or type SKU / Product name",className:re.skuInput,autoFocus:!0}),_&&m.length>0&&a.jsx("div",{className:re.autocomplete,children:m.map($=>a.jsxs("div",{className:re.autocompleteItem,onClick:()=>{w($),v(!1)},children:[a.jsxs("div",{children:[a.jsx("div",{className:re.productName,children:$.productName}),a.jsx("div",{className:re.productSku,children:$.sku})]}),a.jsxs("div",{className:re.productStock,children:["Remaining: ",$.quantityRemaining]})]},$.productId))})]})]}),a.jsxs("div",{className:re.scannedCard,children:[a.jsxs("div",{className:re.scannedHeader,children:[a.jsx("h2",{className:re.sectionTitle,children:"Scanned Items"}),a.jsxs("span",{className:re.badge,children:[g.length," items"]})]}),g.length===0?a.jsx("div",{className:re.emptyScanned,children:"No items scanned yet"}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:re.scannedList,children:g.map($=>a.jsxs("div",{className:re.scannedItem,children:[a.jsxs("div",{className:re.itemInfo,children:[a.jsx("div",{className:re.itemName,children:$.productName}),a.jsx("div",{className:re.itemSku,children:$.sku})]}),a.jsxs("div",{className:re.itemActions,children:[a.jsxs("div",{className:re.quantityControls,children:[a.jsx("button",{onClick:()=>S($.sku,$.count-1),className:re.qtyBtn,children:"-"}),a.jsx("span",{className:re.qty,children:$.count}),a.jsx("button",{onClick:()=>S($.sku,$.count+1),className:re.qtyBtn,children:"+"})]}),a.jsx("button",{onClick:()=>E($.sku),className:re.removeBtn,children:""})]})]},$.sku))}),a.jsxs("div",{className:re.actions,children:[a.jsx("button",{onClick:C,className:re.btnSecondary,disabled:N,children:"Clear All"}),a.jsx("button",{onClick:L,className:re.btnPrimary,disabled:N||g.length===0,children:N?a.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[a.jsx(Ne,{size:"small"}),a.jsx("span",{children:"Submitting..."})]}):"Submit Receive"})]})]})]})]})]}):a.jsxs("div",{className:re.placeholder,children:[a.jsx("div",{className:re.placeholderIcon,children:a.jsx("svg",{fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M19,3H5A2,2 0 0,0 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5A2,2 0 0,0 19,3M19,19H5V5H19V19Z"})})}),a.jsx("h3",{children:"Select a Purchase Order"}),a.jsx("p",{children:"Choose an order above to begin receiving products"})]})]})}),a.jsx(De,{variant:s.variant,message:s.message,title:s.title,isOpen:s.isOpen,onClose:n,confirmText:s.confirmText,onConfirm:s.onConfirm,autoCloseDuration:s.autoCloseDuration})]}):a.jsxs(a.Fragment,{children:[a.jsx(fe,{activeItem:"product"}),a.jsx("div",{className:re.container,children:a.jsx("div",{className:re.emptyState,children:a.jsx("p",{children:"Please select a company to receive products"})})})]})};class VJ{async getStores(e){const{data:r,error:s}=await ne.getClient().from("stores").select("store_id, store_name, store_address, store_phone, huddle_time, payment_time, allowed_distance").eq("company_id",e).eq("is_deleted",!1).order("created_at",{ascending:!1});if(s)throw new Error(`Failed to fetch stores: ${s.message}`);return r||[]}async createStore(e,r,s,n){const o={company_id:e,store_name:r,store_address:s||null,store_phone:n||null,created_at:te.nowUtc(),updated_at:te.nowUtc(),is_deleted:!1},{data:i,error:l}=await ne.getClient().from("stores").insert(o).select();if(l)throw new Error(`Failed to create store: ${l.message}`);return i}async deleteStore(e){const{error:r}=await ne.getClient().from("stores").update({is_deleted:!0,updated_at:te.nowUtc()}).eq("store_id",e);if(r)throw new Error(`Failed to delete store: ${r.message}`)}}class zJ{constructor(e,r,s,n,o,i,l=null,c=null,d=null){this.storeId=e,this.companyId=r,this.storeName=s,this.address=n,this.phone=o,this.isActive=i,this.huddleTime=l,this.paymentTime=c,this.allowedDistance=d}get displayName(){return this.storeName}}class UJ{static fromJson(e){return new zJ(e.store_id,e.company_id,e.store_name,e.store_address,e.store_phone,!e.is_deleted,e.huddle_time,e.payment_time,e.allowed_distance)}static toJson(e){return{store_id:e.storeId,company_id:e.companyId,store_name:e.storeName,store_address:e.address,store_phone:e.phone,is_deleted:!e.isActive,huddle_time:e.huddleTime,payment_time:e.paymentTime,allowed_distance:e.allowedDistance}}static toCreateJson(e,r,s,n){return{company_id:e,store_name:r,store_address:s||null,store_phone:n||null,is_deleted:!1}}}class WJ{constructor(){W(this,"dataSource",new VJ)}async getStores(e){try{return{success:!0,data:(await this.dataSource.getStores(e)).map(n=>UJ.fromJson(n))}}catch(r){return console.error("StoreRepository.getStores error:",r),{success:!1,error:r instanceof Error?r.message:"Failed to fetch stores"}}}async createStore(e,r,s,n){try{return await this.dataSource.createStore(e,r,s,n),{success:!0}}catch(o){return console.error("StoreRepository.createStore error:",o),{success:!1,error:o instanceof Error?o.message:"Failed to create store"}}}async deleteStore(e){try{return await this.dataSource.deleteStore(e),{success:!0}}catch(r){return console.error("StoreRepository.deleteStore error:",r),{success:!1,error:r instanceof Error?r.message:"Failed to delete store"}}}}class qJ{static validateStoreName(e){return!e||!e.trim()?{field:"storeName",message:"Store name is required"}:e.trim().length<2?{field:"storeName",message:"Store name must be at least 2 characters"}:e.trim().length>100?{field:"storeName",message:"Store name must not exceed 100 characters"}:null}static validatePhone(e){return!e||!e.trim()?null:/^[0-9\-+() ]+$/.test(e)?e.replace(/[^0-9]/g,"").length<8?{field:"phone",message:"Phone number must contain at least 8 digits"}:null:{field:"phone",message:"Invalid phone number format. Use numbers, spaces, hyphens, or parentheses."}}static validateAddress(e){return!e||!e.trim()?null:e.trim().length>255?{field:"address",message:"Address must not exceed 255 characters"}:null}static validateCreateStore(e,r,s){const n=[],o=this.validateStoreName(e);o&&n.push(o);const i=this.validateAddress(r);i&&n.push(i);const l=this.validatePhone(s);return l&&n.push(l),n}static validateHuddleTime(e){return e===null?null:e<0?{field:"huddleTime",message:"Huddle time cannot be negative"}:e>1440?{field:"huddleTime",message:"Huddle time cannot exceed 24 hours (1440 minutes)"}:null}static validatePaymentTime(e){return e===null?null:e<0?{field:"paymentTime",message:"Payment time cannot be negative"}:e>1440?{field:"paymentTime",message:"Payment time cannot exceed 24 hours (1440 minutes)"}:null}static validateAllowedDistance(e){return e===null?null:e<0?{field:"allowedDistance",message:"Allowed distance cannot be negative"}:e>1e4?{field:"allowedDistance",message:"Allowed distance cannot exceed 10,000 meters (10km)"}:null}}const GJ=t=>{const[e,r]=b.useState([]),[s,n]=b.useState(!0),o=new WJ,i=b.useCallback(async()=>{if(!t)return;n(!0);const d=await o.getStores(t);d.success&&r(d.data||[]),n(!1)},[t]);b.useEffect(()=>{i()},[i]);const l=b.useCallback(async(d,u,h)=>{const f=qJ.validateCreateStore(d,u,h);if(f.length>0)return{success:!1,error:f[0].message};const p=await o.createStore(t,d,u,h);return p.success&&await i(),p},[t,i]),c=b.useCallback(async d=>{const u=await o.deleteStore(d);return u.success&&await i(),u},[i]);return{stores:e,loading:s,create:l,remove:c}},JJ=Jt(t=>({showAddModal:!1,showDeleteModal:!1,deleteStoreId:"",newName:"",newAddress:"",newPhone:"",setShowAddModal:e=>t({showAddModal:e}),setShowDeleteModal:e=>t({showDeleteModal:e}),setDeleteStoreId:e=>t({deleteStoreId:e}),setNewName:e=>t({newName:e}),setNewAddress:e=>t({newAddress:e}),setNewPhone:e=>t({newPhone:e}),resetForm:()=>t({newName:"",newAddress:"",newPhone:""}),closeAllModals:()=>t({showAddModal:!1,showDeleteModal:!1,deleteStoreId:""})})),KJ="_pageContent_rozwa_2",YJ="_pageHeader_rozwa_12",QJ="_pageHeaderContent_rozwa_19",ZJ="_pageTitle_rozwa_23",XJ="_pageSubtitle_rozwa_30",eK="_addStoreBtn_rozwa_38",tK="_storesContainer_rozwa_60",rK="_storesGrid_rozwa_64",sK="_storeCard_rozwa_71",nK="_storeCardHeader_rozwa_89",oK="_storeName_rozwa_93",aK="_storeDetail_rozwa_100",iK="_storeActions_rozwa_108",lK="_storeActionBtn_rozwa_118",cK="_emptyState_rozwa_145",dK="_emptyStateIcon_rozwa_153",uK="_emptyStateTitle_rozwa_160",hK="_emptyStateText_rozwa_167",fK="_modalOverlay_rozwa_174",mK="_modalContent_rozwa_188",pK="_deleteModal_rozwa_200",gK="_modalHeader_rozwa_204",_K="_modalTitle_rozwa_211",yK="_modalClose_rozwa_218",vK="_modalBody_rozwa_231",xK="_formGroup_rozwa_236",bK="_formLabel_rozwa_240",wK="_required_rozwa_248",SK="_optional_rozwa_252",CK="_formInput_rozwa_259",jK="_modalFooter_rozwa_283",kK="_modalBtnCancel_rozwa_289",NK="_modalBtnSave_rozwa_290",IK="_modalBtnDelete_rozwa_291",EK="_deleteConfirmIcon_rozwa_346",TK="_deleteConfirmTitle_rozwa_358",AK="_deleteConfirmText_rozwa_366",ue={pageContent:KJ,pageHeader:YJ,pageHeaderContent:QJ,pageTitle:ZJ,pageSubtitle:XJ,addStoreBtn:eK,storesContainer:tK,storesGrid:rK,storeCard:sK,storeCardHeader:nK,storeName:oK,storeDetail:aK,storeActions:iK,storeActionBtn:lK,delete:"_delete_rozwa_137",emptyState:cK,emptyStateIcon:dK,emptyStateTitle:uK,emptyStateText:hK,modalOverlay:fK,modalContent:mK,deleteModal:pK,modalHeader:gK,modalTitle:_K,modalClose:yK,modalBody:vK,formGroup:xK,formLabel:bK,required:wK,optional:SK,formInput:CK,modalFooter:jK,modalBtnCancel:kK,modalBtnSave:NK,modalBtnDelete:IK,deleteConfirmIcon:EK,deleteConfirmTitle:TK,deleteConfirmText:AK},LK=()=>{const{currentCompany:t}=at(),{stores:e,loading:r,create:s,remove:n}=GJ((t==null?void 0:t.company_id)||""),{messageState:o,closeMessage:i,showError:l,showSuccess:c}=Es(),{showAddModal:d,setShowAddModal:u,showDeleteModal:h,setShowDeleteModal:f,deleteStoreId:p,setDeleteStoreId:g,newName:y,setNewName:x,newAddress:m,setNewAddress:_,newPhone:v,setNewPhone:w,resetForm:S}=JJ(),E=async()=>{const N=await s(y,m||null,v||null);N.success?(u(!1),S(),c({title:"Store Created",message:`Store "${y}" has been successfully created.`,autoCloseDuration:3e3})):l({title:"Failed to Create Store",message:N.error||"An unexpected error occurred while creating the store."})},C=N=>{g(N),f(!0)},k=async()=>{if(p){const N=await n(p);N.success?(f(!1),g(""),c({title:"Store Deleted",message:"The store has been successfully deleted.",autoCloseDuration:3e3})):l({title:"Failed to Delete Store",message:N.error||"An unexpected error occurred while deleting the store."})}};return r?a.jsxs(a.Fragment,{children:[a.jsx(fe,{activeItem:"setting"}),a.jsx("div",{className:ue.pageContent,children:a.jsx(Ne,{size:"large",fullscreen:!0})})]}):t?a.jsxs(a.Fragment,{children:[a.jsx(fe,{activeItem:"setting"}),a.jsxs("main",{className:ue.pageContent,children:[a.jsxs("div",{className:ue.pageHeader,children:[a.jsxs("div",{className:ue.pageHeaderContent,children:[a.jsx("h1",{className:ue.pageTitle,children:"Store Setting"}),a.jsx("p",{className:ue.pageSubtitle,children:"Manage your store configuration and settings"})]}),a.jsxs("button",{className:ue.addStoreBtn,onClick:()=>u(!0),children:[a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M19 13H13V19H11V13H5V11H11V5H13V11H19V13Z"})}),"Add Store"]})]}),a.jsx("div",{className:ue.storesContainer,children:e.length===0?a.jsxs("div",{className:ue.emptyState,children:[a.jsxs("svg",{className:ue.emptyStateIcon,width:"120",height:"120",viewBox:"0 0 120 120",fill:"none",children:[a.jsx("circle",{cx:"60",cy:"60",r:"50",fill:"#F0F6FF"}),a.jsx("rect",{x:"35",y:"45",width:"50",height:"45",rx:"2",fill:"white",stroke:"#0064FF",strokeWidth:"2"}),a.jsx("path",{d:"M30 45 L35 40 L85 40 L90 45 Z",fill:"#0064FF"}),a.jsx("rect",{x:"52",y:"65",width:"16",height:"25",rx:"1",fill:"#E9ECEF"}),a.jsx("rect",{x:"40",y:"52",width:"10",height:"8",rx:"1",fill:"#E9ECEF"}),a.jsx("rect",{x:"70",y:"52",width:"10",height:"8",rx:"1",fill:"#E9ECEF"}),a.jsx("circle",{cx:"60",cy:"25",r:"12",fill:"#0064FF"}),a.jsx("path",{d:"M56 25 L58 27 L64 21",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),a.jsx("h3",{className:ue.emptyStateTitle,children:"No Stores Yet"}),a.jsx("p",{className:ue.emptyStateText,children:'Click "Add Store" to create your first store location.'})]}):a.jsx("div",{className:ue.storesGrid,children:e.map(N=>a.jsxs("div",{className:ue.storeCard,children:[a.jsx("div",{className:ue.storeActions,children:a.jsx("button",{className:`${ue.storeActionBtn} ${ue.delete}`,onClick:()=>C(N.storeId),title:"Delete",children:a.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"})})})}),a.jsxs("div",{className:ue.storeCardHeader,children:[a.jsx("h3",{className:ue.storeName,children:N.storeName}),N.address&&a.jsxs("div",{className:ue.storeDetail,children:["Address: ",N.address]}),N.phone&&a.jsxs("div",{className:ue.storeDetail,children:["Phone: ",N.phone]}),N.huddleTime&&a.jsxs("div",{className:ue.storeDetail,children:["Huddle Time: ",N.huddleTime," minutes"]}),N.paymentTime&&a.jsxs("div",{className:ue.storeDetail,children:["Payment Time: ",N.paymentTime," minutes"]}),N.allowedDistance&&a.jsxs("div",{className:ue.storeDetail,children:["Allowed Distance: ",N.allowedDistance," meters"]})]})]},N.storeId))})})]}),d&&a.jsx("div",{className:ue.modalOverlay,onClick:()=>u(!1),children:a.jsxs("div",{className:ue.modalContent,onClick:N=>N.stopPropagation(),children:[a.jsxs("div",{className:ue.modalHeader,children:[a.jsx("h2",{className:ue.modalTitle,children:"Add New Store"}),a.jsx("button",{className:ue.modalClose,onClick:()=>u(!1),children:a.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M19 6.41L17.59 5L12 10.59L6.41 5L5 6.41L10.59 12L5 17.59L6.41 19L12 13.41L17.59 19L19 17.59L13.41 12L19 6.41Z"})})})]}),a.jsxs("div",{className:ue.modalBody,children:[a.jsxs("div",{className:ue.formGroup,children:[a.jsxs("label",{className:ue.formLabel,children:["Store Name ",a.jsx("span",{className:ue.required,children:"*"})]}),a.jsx("input",{type:"text",className:ue.formInput,placeholder:"Enter store name",value:y,onChange:N=>x(N.target.value)})]}),a.jsxs("div",{className:ue.formGroup,children:[a.jsxs("label",{className:ue.formLabel,children:["Store Address ",a.jsx("span",{className:ue.optional,children:"(Optional)"})]}),a.jsx("input",{type:"text",className:ue.formInput,placeholder:"Enter store address",value:m,onChange:N=>_(N.target.value)})]}),a.jsxs("div",{className:ue.formGroup,children:[a.jsxs("label",{className:ue.formLabel,children:["Store Phone ",a.jsx("span",{className:ue.optional,children:"(Optional)"})]}),a.jsx("input",{type:"tel",className:ue.formInput,placeholder:"Enter phone number",value:v,onChange:N=>w(N.target.value)})]})]}),a.jsxs("div",{className:ue.modalFooter,children:[a.jsx("button",{className:ue.modalBtnCancel,onClick:()=>u(!1),children:"Cancel"}),a.jsx("button",{className:ue.modalBtnSave,onClick:E,disabled:!y.trim(),children:"Create Store"})]})]})}),h&&a.jsx("div",{className:ue.modalOverlay,onClick:()=>f(!1),children:a.jsxs("div",{className:`${ue.modalContent} ${ue.deleteModal}`,onClick:N=>N.stopPropagation(),children:[a.jsxs("div",{className:ue.modalHeader,children:[a.jsx("h2",{className:ue.modalTitle,children:"Delete Store"}),a.jsx("button",{className:ue.modalClose,onClick:()=>f(!1),children:a.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M19 6.41L17.59 5L12 10.59L6.41 5L5 6.41L10.59 12L5 17.59L6.41 19L12 13.41L17.59 19L19 17.59L13.41 12L19 6.41Z"})})})]}),a.jsxs("div",{className:ue.modalBody,children:[a.jsx("div",{className:ue.deleteConfirmIcon,children:a.jsx("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"})})}),a.jsx("p",{className:ue.deleteConfirmTitle,children:"Are you sure you want to delete this store?"}),a.jsx("p",{className:ue.deleteConfirmText,children:"This action cannot be undone. The store will be permanently removed from your system."})]}),a.jsxs("div",{className:ue.modalFooter,children:[a.jsx("button",{className:ue.modalBtnCancel,onClick:()=>f(!1),children:"Cancel"}),a.jsx("button",{className:ue.modalBtnDelete,onClick:k,children:"Yes, Delete Store"})]})]})}),a.jsx(De,{variant:o.variant,title:o.title,message:o.message,isOpen:o.isOpen,onClose:i,confirmText:o.confirmText,autoCloseDuration:o.autoCloseDuration,closeOnBackdropClick:o.closeOnBackdropClick})]}):a.jsxs(a.Fragment,{children:[a.jsx(fe,{activeItem:"setting"}),a.jsx("div",{className:ue.pageContent,children:a.jsx("p",{children:"Select a company to manage stores"})})]})};class DK{constructor(e,r,s,n,o,i,l,c,d,u){this.productId=e,this.sku=r,this.productName=s,this.categoryName=n,this.brandName=o,this.currentStock=i,this.minStock=l,this.maxStock=c,this.unitPrice=d,this.currencySymbol=u}get totalValue(){return this.currentStock*this.unitPrice}formatCurrency(e){return`${this.currencySymbol}${e.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})}`}get formattedTotalValue(){return this.formatCurrency(this.totalValue)}get isLowStock(){return this.currentStock<=this.minStock}get isOverStock(){return this.currentStock>=this.maxStock}get stockStatus(){return this.isLowStock?"low":this.isOverStock?"over":"normal"}get stockPercentage(){return this.maxStock===0?0:Math.min(100,this.currentStock/this.maxStock*100)}}class MK{async getTrackingItems(e,r){const s=ne.getClient(),{data:n,error:o}=await s.rpc("get_store_inventory_tracking",{p_company_id:e,p_store_id:r});if(o)throw console.error("Error fetching tracking items:",o),new Error(o.message);return n||[]}}class RK{constructor(){W(this,"dataSource");this.dataSource=new MK}async getTrackingItems(e,r){try{return{success:!0,data:(await this.dataSource.getTrackingItems(e,r)).map(o=>new DK(o.product_id,o.sku,o.product_name,o.category_name,o.brand_name,o.current_stock,o.min_stock,o.max_stock,o.unit_price,o.currency_symbol||""))}}catch(s){return console.error("Repository error fetching tracking items:",s),{success:!1,error:s instanceof Error?s.message:"Failed to fetch tracking items"}}}}const OK=(t,e)=>{const[r,s]=b.useState([]),[n,o]=b.useState(!0),[i,l]=b.useState(null),c=new RK,d=b.useCallback(async()=>{if(!t||!e){s([]),o(!1);return}o(!0),l(null);try{const h=await c.getTrackingItems(t,e);if(!h.success){l(h.error||"Failed to load tracking items"),s([]);return}s(h.data||[])}catch(h){l(h instanceof Error?h.message:"An unexpected error occurred"),s([])}finally{o(!1)}},[t,e]);b.useEffect(()=>{d()},[d]);const u=b.useCallback(()=>{d()},[d]);return{items:r,loading:n,error:i,refresh:u}},PK="_container_1j2dr_6",$K="_pageHeader_1j2dr_12",FK="_pageTitle_1j2dr_16",BK="_pageSubtitle_1j2dr_23",HK="_loadingSpinner_1j2dr_30",VK="_spinner_1j2dr_37",zK="_spin_1j2dr_37",UK="_errorState_1j2dr_52",WK="_errorMessage_1j2dr_57",qK="_retryButton_1j2dr_63",GK="_statsGrid_1j2dr_82",JK="_statCard_1j2dr_89",KK="_statIcon_1j2dr_105",YK="_warning_1j2dr_117",QK="_success_1j2dr_122",ZK="_statContent_1j2dr_127",XK="_statLabel_1j2dr_131",eY="_statValue_1j2dr_137",tY="_searchBar_1j2dr_144",rY="_searchIcon_1j2dr_149",sY="_searchInput_1j2dr_157",nY="_tableCard_1j2dr_178",oY="_table_1j2dr_178",aY="_skuCell_1j2dr_223",iY="_nameCell_1j2dr_229",lY="_numberCell_1j2dr_233",cY="_statusBadge_1j2dr_238",dY="_low_1j2dr_247",uY="_normal_1j2dr_252",hY="_over_1j2dr_257",fY="_emptyState_1j2dr_263",mY="_emptyTitle_1j2dr_271",pY="_emptyDescription_1j2dr_278",we={container:PK,pageHeader:$K,pageTitle:FK,pageSubtitle:BK,loadingSpinner:HK,spinner:VK,spin:zK,errorState:UK,errorMessage:WK,retryButton:qK,statsGrid:GK,statCard:JK,statIcon:KK,warning:YK,success:QK,statContent:ZK,statLabel:XK,statValue:eY,searchBar:tY,searchIcon:rY,searchInput:sY,tableCard:nY,table:oY,skuCell:aY,nameCell:iY,numberCell:lY,statusBadge:cY,low:dY,normal:uY,over:hY,emptyState:fY,emptyTitle:mY,emptyDescription:pY},gY=()=>{var h;const{currentCompany:t,currentStore:e}=at(),{items:r,loading:s,error:n,refresh:o}=OK((t==null?void 0:t.company_id)||"",(e==null?void 0:e.store_id)||null),[i,l]=b.useState("");if(!t||!e)return a.jsxs(a.Fragment,{children:[a.jsx(fe,{activeItem:"product"}),a.jsx("div",{className:we.container,children:a.jsx("div",{className:we.emptyState,children:a.jsx("p",{children:"Please select a company and store to view tracking"})})})]});if(s)return a.jsxs(a.Fragment,{children:[a.jsx(fe,{activeItem:"product"}),a.jsx("div",{className:we.container,children:a.jsx("div",{className:we.loadingSpinner,children:a.jsx("div",{className:we.spinner})})})]});if(n)return a.jsxs(a.Fragment,{children:[a.jsx(fe,{activeItem:"product"}),a.jsx("div",{className:we.container,children:a.jsxs("div",{className:we.errorState,children:[a.jsx("p",{className:we.errorMessage,children:n}),a.jsx("button",{onClick:o,className:we.retryButton,children:"Retry"})]})})]});const c=r.filter(f=>f.productName.toLowerCase().includes(i.toLowerCase())||f.sku.toLowerCase().includes(i.toLowerCase())||f.categoryName.toLowerCase().includes(i.toLowerCase())||f.brandName.toLowerCase().includes(i.toLowerCase())),d=r.filter(f=>f.isLowStock).length,u=r.reduce((f,p)=>f+p.totalValue,0);return a.jsxs(a.Fragment,{children:[a.jsx(fe,{activeItem:"product"}),a.jsxs("div",{className:we.container,children:[a.jsxs("div",{className:we.pageHeader,children:[a.jsx("h1",{className:we.pageTitle,children:"Inventory Tracking"}),a.jsxs("p",{className:we.pageSubtitle,children:["Track inventory for ",e.store_name]})]}),a.jsxs("div",{className:we.statsGrid,children:[a.jsxs("div",{className:we.statCard,children:[a.jsx("div",{className:we.statIcon,children:a.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})})}),a.jsxs("div",{className:we.statContent,children:[a.jsx("div",{className:we.statLabel,children:"Total Items"}),a.jsx("div",{className:we.statValue,children:r.length})]})]}),a.jsxs("div",{className:we.statCard,children:[a.jsx("div",{className:`${we.statIcon} ${we.warning}`,children:a.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),a.jsxs("div",{className:we.statContent,children:[a.jsx("div",{className:we.statLabel,children:"Low Stock Items"}),a.jsx("div",{className:we.statValue,children:d})]})]}),a.jsxs("div",{className:we.statCard,children:[a.jsx("div",{className:`${we.statIcon} ${we.success}`,children:a.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),a.jsxs("div",{className:we.statContent,children:[a.jsx("div",{className:we.statLabel,children:"Total Value"}),a.jsx("div",{className:we.statValue,children:((h=r[0])==null?void 0:h.formatCurrency(u))||"0"})]})]})]}),a.jsxs("div",{className:we.searchBar,children:[a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:we.searchIcon,children:[a.jsx("circle",{cx:"11",cy:"11",r:"8"}),a.jsx("path",{d:"M21 21l-4.35-4.35"})]}),a.jsx("input",{type:"text",placeholder:"Search by product name, SKU, category, or brand...",value:i,onChange:f=>l(f.target.value),className:we.searchInput})]}),c.length===0?a.jsxs("div",{className:we.emptyState,children:[a.jsx("h3",{className:we.emptyTitle,children:"No Items Found"}),a.jsx("p",{className:we.emptyDescription,children:i?"Try adjusting your search criteria":"No tracking items available"})]}):a.jsx("div",{className:we.tableCard,children:a.jsxs("table",{className:we.table,children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"SKU"}),a.jsx("th",{children:"Product Name"}),a.jsx("th",{children:"Category"}),a.jsx("th",{children:"Brand"}),a.jsx("th",{children:"Current Stock"}),a.jsx("th",{children:"Min Stock"}),a.jsx("th",{children:"Max Stock"}),a.jsx("th",{children:"Status"}),a.jsx("th",{children:"Unit Price"}),a.jsx("th",{children:"Total Value"})]})}),a.jsx("tbody",{children:c.map(f=>a.jsxs("tr",{children:[a.jsx("td",{className:we.skuCell,children:f.sku}),a.jsx("td",{className:we.nameCell,children:f.productName}),a.jsx("td",{children:f.categoryName}),a.jsx("td",{children:f.brandName}),a.jsx("td",{className:we.numberCell,children:f.currentStock}),a.jsx("td",{className:we.numberCell,children:f.minStock}),a.jsx("td",{className:we.numberCell,children:f.maxStock}),a.jsx("td",{children:a.jsxs("span",{className:`${we.statusBadge} ${we[f.stockStatus]}`,children:[f.stockStatus==="low"&&"Low Stock",f.stockStatus==="normal"&&"Normal",f.stockStatus==="over"&&"Over Stock"]})}),a.jsx("td",{className:we.numberCell,children:f.formatCurrency(f.unitPrice)}),a.jsx("td",{className:we.numberCell,children:f.formattedTotalValue})]},f.productId))})]})})]})]})};class _Y{async getTransactions(e,r,s,n,o){const i=ne.getClient(),l={p_company_id:e,p_date_from:s,p_date_to:n};r&&(l.p_store_id=r),o&&(l.p_account_id=o);const{data:c,error:d}=await i.rpc("get_transaction_history",l);if(d)throw console.error("Error fetching transaction history:",d),new Error(d.message);return c||[]}}class yY{constructor(e,r,s,n,o,i,l,c,d,u,h,f,p,g,y,x,m,_){this.journalId=e,this.journalNumber=r,this.entryDate=s,this.createdAt=n,this.description=o,this.journalType=i,this.isDraft=l,this.storeId=c,this.storeName=d,this.storeCode=u,this.createdBy=h,this.createdByName=f,this.currencyCode=p,this.currencySymbol=g,this.totalDebit=y,this.totalCredit=x,this.totalAmount=m,this.lines=_}get formattedDate(){return new Date(this.entryDate).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}get formattedTime(){return new Date(this.createdAt).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})}formatCurrency(e){return this.currencySymbol?`${this.currencySymbol==="W"?"":this.currencySymbol}${e.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})}`:e.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})}get sortedLines(){return[...this.lines].sort((e,r)=>e.isDebit&&!r.isDebit?-1:!e.isDebit&&r.isDebit?1:0)}}class Sm{static fromJson(e){const r=(e.lines||[]).map(o=>({lineId:o.line_id,accountId:o.account_id,accountName:o.account_name||"",accountType:o.account_type||"",debit:o.debit||0,credit:o.credit||0,isDebit:o.is_debit||!1,description:o.description||"",counterparty:o.counterparty||null,cashLocation:o.cash_location||null,displayLocation:o.display_location||"",displayCounterparty:o.display_counterparty||""})),s=e.entry_date?te.toLocal(e.entry_date).toISOString():"",n=e.created_at?te.toLocal(e.created_at).toISOString():"";return new yY(e.journal_id,e.journal_number,s,n,e.description||"",e.journal_type||"",e.is_draft||!1,e.store_id||null,e.store_name||null,e.store_code||null,e.created_by,e.created_by_name||"System",e.currency_code||"",e.currency_symbol||"",e.total_debit||0,e.total_credit||0,e.total_amount||0,r)}static toJson(e){return{journal_id:e.journalId,journal_number:e.journalNumber,entry_date:e.entryDate,created_at:e.createdAt,description:e.description,journal_type:e.journalType,is_draft:e.isDraft,store_id:e.storeId,store_name:e.storeName,store_code:e.storeCode,created_by:e.createdBy,created_by_name:e.createdByName,currency_code:e.currencyCode,currency_symbol:e.currencySymbol,total_debit:e.totalDebit,total_credit:e.totalCredit,total_amount:e.totalAmount,lines:e.lines.map(r=>({line_id:r.lineId,account_id:r.accountId,account_name:r.accountName,account_type:r.accountType,debit:r.debit,credit:r.credit,is_debit:r.isDebit,description:r.description,counterparty:r.counterparty,cash_location:r.cashLocation,display_location:r.displayLocation,display_counterparty:r.displayCounterparty}))}}static fromJsonArray(e){const r=e.map(s=>Sm.fromJson(s));return r.sort((s,n)=>new Date(n.createdAt).getTime()-new Date(s.createdAt).getTime()),r}}class vY{constructor(){W(this,"dataSource");this.dataSource=new _Y}async getJournalEntries(e,r,s,n,o){try{const i=s?te.toRpcFormat(new Date(s+"T00:00:00")):"",l=n?te.toRpcFormat(new Date(n+"T23:59:59")):"",c=await this.dataSource.getTransactions(e,r,i,l,o);return{success:!0,data:Sm.fromJsonArray(c)}}catch(i){return console.error("Repository error fetching journal entries:",i),{success:!1,error:i instanceof Error?i.message:"Failed to fetch journal entries"}}}}class Gh{static validateDateFormat(e){if(!e||e.trim()==="")return{field:"date",message:"Date is required"};if(!/^\d{4}-\d{2}-\d{2}$/.test(e))return{field:"date",message:"Invalid date format. Use YYYY-MM-DD"};const s=new Date(e);return isNaN(s.getTime())?{field:"date",message:"Invalid date"}:null}static validateDateRange(e,r){const s=this.validateDateFormat(e);if(s)return s;const n=this.validateDateFormat(r);if(n)return n;const o=new Date(e),i=new Date(r);if(o>i)return{field:"dateRange",message:"From date must be before or equal to To date"};const l=Math.floor((i.getTime()-o.getTime())/(1e3*60*60*24)),c=365;return l>c?{field:"dateRange",message:`Date range cannot exceed ${c} days`}:null}static validateStoreId(e){return e===null||e===""||/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e)?null:{field:"storeId",message:"Invalid store ID format"}}static validateAccountId(e){return e===null||e===""||/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e)?null:{field:"accountId",message:"Invalid account ID format"}}static validateCompanyId(e){return!e||e.trim()===""?{field:"companyId",message:"Company ID is required"}:/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e)?null:{field:"companyId",message:"Invalid company ID format"}}static validateTransactionFilter(e,r,s,n,o){const i=[],l=this.validateCompanyId(e);l&&i.push(l);const c=this.validateStoreId(r);c&&i.push(c);const d=this.validateDateRange(s,n);if(d&&i.push(d),o!==void 0){const u=this.validateAccountId(o);u&&i.push(u)}return i}static validateJournalFilter(e,r,s,n){const o=[],i=this.validateCompanyId(e);i&&o.push(i);const l=this.validateStoreId(r);if(l&&o.push(l),s&&n){const c=this.validateDateRange(s,n);c&&o.push(c)}return o}}const xY=new vY,an=Jt((t,e)=>({journalEntries:[],loading:!1,error:null,hasSearched:!1,currentStoreId:null,currentStartDate:null,currentEndDate:null,searchJournalEntries:async(r,s,n)=>{const o=e();t({loading:!0,error:null,hasSearched:!0});try{const i=o.companyId||"";if(!i){t({error:"No company selected",journalEntries:[],loading:!1});return}const l=Gh.validateJournalFilter(i,r,s,n);if(l.length>0){t({error:l.map(d=>d.message).join(", "),journalEntries:[],loading:!1});return}const c=await xY.getJournalEntries(i,r,s,n,null);if(!c.success){t({error:c.error||"Failed to load journal entries",journalEntries:[],loading:!1});return}t({journalEntries:c.data||[],currentStoreId:r,currentStartDate:s,currentEndDate:n,loading:!1})}catch(i){t({error:i instanceof Error?i.message:"An unexpected error occurred",journalEntries:[],loading:!1})}},clearSearch:()=>{t({journalEntries:[],hasSearched:!1,error:null,currentStoreId:null,currentStartDate:null,currentEndDate:null})},setError:r=>{t({error:r})},reset:()=>{t({journalEntries:[],loading:!1,error:null,hasSearched:!1,currentStoreId:null,currentStartDate:null,currentEndDate:null})}})),bY=t=>{const e=an(c=>c.journalEntries),r=an(c=>c.loading),s=an(c=>c.error),n=an(c=>c.hasSearched),o=an(c=>c.searchJournalEntries),i=an(c=>c.clearSearch),l=an(c=>c.setError);return b.useEffect(()=>{t&&an.setState({companyId:t})},[t]),{journalEntries:e,loading:r,error:s,hasSearched:n,searchJournalEntries:o,clearSearch:i,setError:l}},wY="_filterContainer_m5uqg_3",SY="_filterHeader_m5uqg_13",CY="_filterTitle_m5uqg_21",jY="_filterContent_m5uqg_35",kY="_filterRow_m5uqg_39",NY="_filterField_m5uqg_47",IY="_filterLabel_m5uqg_55",EY="_dateInput_m5uqg_63",TY="_filterActions_m5uqg_86",Vr={filterContainer:wY,filterHeader:SY,filterTitle:CY,filterContent:jY,filterRow:kY,filterField:NY,filterLabel:IY,dateInput:EY,filterActions:TY},G_=()=>{const t=new Date,e=new Date(t.getFullYear(),t.getMonth(),1);return te.toDateOnly(e)},J_=()=>{const t=new Date,e=new Date(t.getFullYear(),t.getMonth()+1,0);return te.toDateOnly(e)},AY=({onSearch:t,onClear:e})=>{const{currentCompany:r}=at(),s=(r==null?void 0:r.stores)||[],{messageState:n,closeMessage:o,showWarning:i}=Es(),[l,c]=b.useState(null),[d,u]=b.useState(G_()),[h,f]=b.useState(J_()),p=()=>{const y=Gh.validateDateRange(d,h);if(y){i({title:"Invalid Date Range",message:y.message,confirmText:"OK"});return}if(l){const x=Gh.validateStoreId(l);if(x){i({title:"Invalid Store",message:x.message,confirmText:"OK"});return}}t({storeId:l,fromDate:d,toDate:h})},g=()=>{c(null),u(G_()),f(J_()),e()};return a.jsxs("div",{className:Vr.filterContainer,children:[a.jsx("div",{className:Vr.filterHeader,children:a.jsxs("div",{className:Vr.filterTitle,children:[a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"})}),a.jsx("span",{children:"Search Transactions"})]})}),a.jsxs("div",{className:Vr.filterContent,children:[a.jsxs("div",{className:Vr.filterRow,children:[a.jsxs("div",{className:Vr.filterField,children:[a.jsx("label",{className:Vr.filterLabel,children:"STORE"}),a.jsx(Hs,{stores:s,selectedStoreId:l,onStoreSelect:c,showAllStoresOption:!0,width:"100%"})]}),a.jsxs("div",{className:Vr.filterField,children:[a.jsx("label",{className:Vr.filterLabel,children:"FROM DATE"}),a.jsx("input",{type:"date",className:Vr.dateInput,value:d,onChange:y=>u(y.target.value)})]}),a.jsxs("div",{className:Vr.filterField,children:[a.jsx("label",{className:Vr.filterLabel,children:"TO DATE"}),a.jsx("input",{type:"date",className:Vr.dateInput,value:h,onChange:y=>f(y.target.value)})]})]}),a.jsxs("div",{className:Vr.filterActions,children:[a.jsx(be,{onClick:g,variant:"secondary",children:"Clear All"}),a.jsxs(be,{onClick:p,variant:"primary",children:[a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"11",cy:"11",r:"8"}),a.jsx("path",{d:"m21 21-4.35-4.35"})]}),"Search"]})]})]}),a.jsx(De,{variant:n.variant,title:n.title,message:n.message,isOpen:n.isOpen,onClose:o,confirmText:n.confirmText||"OK"})]})},LY="_container_k5inl_3",DY="_pageHeader_k5inl_11",MY="_title_k5inl_15",RY="_subtitle_k5inl_22",OY="_contentCard_k5inl_29",PY="_emptyState_k5inl_38",$Y="_loadingState_k5inl_39",FY="_emptyIcon_k5inl_44",BY="_emptyTitle_k5inl_61",HY="_emptyText_k5inl_68",VY="_tableWrapper_k5inl_79",zY="_tableHeader_k5inl_83",UY="_tableTitle_k5inl_87",WY="_tableSubtitle_k5inl_94",qY="_transactionTable_k5inl_101",GY="_journalHeader_k5inl_139",JY="_journalDate_k5inl_152",KY="_journalTime_k5inl_158",YY="_storeBadge_k5inl_165",QY="_lineRow_k5inl_178",ZY="_alternate_k5inl_183",XY="_accountCell_k5inl_197",eQ="_lineDescription_k5inl_206",tQ="_totalRow_k5inl_212",rQ="_totalLabel_k5inl_225",sQ="_amountCell_k5inl_232",nQ="_debitAmount_k5inl_238",oQ="_creditAmount_k5inl_242",Ee={container:LY,pageHeader:DY,title:MY,subtitle:RY,contentCard:OY,emptyState:PY,loadingState:$Y,emptyIcon:FY,emptyTitle:BY,emptyText:HY,tableWrapper:VY,tableHeader:zY,tableTitle:UY,tableSubtitle:WY,transactionTable:qY,journalHeader:GY,journalDate:JY,journalTime:KY,storeBadge:YY,lineRow:QY,alternate:ZY,accountCell:XY,lineDescription:eQ,totalRow:tQ,totalLabel:rQ,amountCell:sQ,debitAmount:nQ,creditAmount:oQ},K_=()=>{const{currentCompany:t}=at(),e=(t==null?void 0:t.company_id)||"",{messageState:r,closeMessage:s,showError:n}=Es(),{journalEntries:o,loading:i,error:l,hasSearched:c,searchJournalEntries:d,clearSearch:u}=bY(e);b.useEffect(()=>{l&&n({title:"Failed to Load Transactions",message:l,confirmText:"OK"})},[l,n]);const h=_=>{d(_.storeId,_.fromDate||null,_.toDate||null)},f=()=>{u()},p=()=>a.jsxs("div",{className:Ee.emptyState,children:[a.jsx("div",{className:Ee.emptyIcon,children:a.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"11",cy:"11",r:"8"}),a.jsx("path",{d:"m21 21-4.35-4.35"})]})}),a.jsx("h3",{className:Ee.emptyTitle,children:"Search Transactions"}),a.jsx("p",{className:Ee.emptyText,children:"Select filters and click Search to view transaction history"})]}),g=()=>a.jsx("div",{className:Ee.loadingState,children:a.jsx(Ne,{size:"large"})}),y=()=>a.jsxs("div",{className:Ee.emptyState,children:[a.jsx("div",{className:Ee.emptyIcon,children:a.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 3v18h18"}),a.jsx("path",{d:"M18 17V9"}),a.jsx("path",{d:"M13 17V5"}),a.jsx("path",{d:"M8 17v-3"})]})}),a.jsx("h3",{className:Ee.emptyTitle,children:"No Transactions Found"}),a.jsx("p",{className:Ee.emptyText,children:"No transactions found for the selected period. Try adjusting your search filters."})]}),x=_=>a.jsxs(Ar.Fragment,{children:[a.jsxs("tr",{className:Ee.journalHeader,children:[a.jsxs("td",{children:[a.jsx("div",{className:Ee.journalDate,children:_.formattedDate}),a.jsx("div",{className:Ee.journalTime,children:_.formattedTime})]}),a.jsx("td",{children:_.description||"-"}),a.jsx("td",{children:_.storeName?a.jsx("span",{className:Ee.storeBadge,children:_.storeName}):"All Stores"}),a.jsx("td",{children:_.createdByName}),a.jsx("td",{className:`${Ee.amountCell} ${Ee.debitAmount}`,children:_.formatCurrency(_.totalDebit)}),a.jsx("td",{className:`${Ee.amountCell} ${Ee.creditAmount}`,children:_.formatCurrency(_.totalCredit)})]}),_.sortedLines.map((v,w)=>{const S=w%2===1?Ee.alternate:"";let E=v.description||v.accountName;return v.displayCounterparty&&v.displayLocation?E=`${E}  ${v.displayCounterparty}  ${v.displayLocation}`:v.displayCounterparty?E=`${E}  ${v.displayCounterparty}`:v.displayLocation&&(E=`${E}  ${v.displayLocation}`),a.jsxs("tr",{className:`${Ee.lineRow} ${S}`,children:[a.jsx("td",{className:Ee.accountCell,children:a.jsx("strong",{children:v.accountName})}),a.jsx("td",{className:Ee.lineDescription,children:E}),a.jsx("td",{children:"-"}),a.jsx("td",{children:"-"}),a.jsx("td",{className:`${Ee.amountCell} ${Ee.debitAmount}`,children:v.debit>0?v.debit.toLocaleString("en-US"):"-"}),a.jsx("td",{className:`${Ee.amountCell} ${Ee.creditAmount}`,children:v.credit>0?v.credit.toLocaleString("en-US"):"-"})]},v.lineId)}),a.jsxs("tr",{className:Ee.totalRow,children:[a.jsx("td",{colSpan:4,className:Ee.totalLabel,children:"Total:"}),a.jsx("td",{className:`${Ee.amountCell} ${Ee.debitAmount}`,children:_.totalDebit>0?_.totalDebit.toLocaleString("en-US"):"-"}),a.jsx("td",{className:`${Ee.amountCell} ${Ee.creditAmount}`,children:_.totalCredit>0?_.totalCredit.toLocaleString("en-US"):"-"})]})]},_.journalId),m=()=>a.jsxs("div",{className:Ee.tableWrapper,children:[a.jsxs("div",{className:Ee.tableHeader,children:[a.jsx("h3",{className:Ee.tableTitle,children:"Transaction History"}),a.jsxs("p",{className:Ee.tableSubtitle,children:["Found ",o.length," journal",o.length!==1?"s":""]})]}),a.jsxs("table",{className:Ee.transactionTable,children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:{width:"160px"},children:"DATE & TIME"}),a.jsx("th",{style:{width:"200px"},children:"DESCRIPTION"}),a.jsx("th",{style:{width:"120px"},children:"STORE"}),a.jsx("th",{style:{width:"120px"},children:"CREATED BY"}),a.jsx("th",{style:{width:"120px"},children:"DEBIT"}),a.jsx("th",{style:{width:"120px"},children:"CREDIT"})]})}),a.jsx("tbody",{children:o.map(x)})]})]});return a.jsxs(a.Fragment,{children:[a.jsx(fe,{activeItem:"finance"}),a.jsxs("div",{className:Ee.container,children:[a.jsxs("div",{className:Ee.pageHeader,children:[a.jsx("h1",{className:Ee.title,children:"Transaction History"}),a.jsx("p",{className:Ee.subtitle,children:"View all transactions"})]}),a.jsx(AY,{onSearch:h,onClear:f}),a.jsxs("div",{className:Ee.contentCard,children:[i&&g(),!i&&!c&&p(),!i&&c&&o.length===0&&y(),!i&&c&&o.length>0&&m()]})]}),a.jsx(De,{variant:r.variant,title:r.title,message:r.message,isOpen:r.isOpen,onClose:s,confirmText:r.confirmText||"OK"})]})},aQ=()=>a.jsxs(G2,{children:[a.jsx(ct,{path:"/login",element:a.jsx(vg,{children:a.jsx(Bk,{})})}),a.jsx(ct,{path:"/register",element:a.jsx(vg,{children:a.jsx(oN,{})})}),a.jsx(ct,{path:"/dashboard",element:a.jsx(Rt,{children:a.jsx(rT,{})})}),a.jsx(ct,{path:"/product/inventory",element:a.jsx(Rt,{requiredFeatureId:"ced86713-e046-457a-b3c9-775304b31557",children:a.jsx(JB,{})})}),a.jsx(ct,{path:"/product/invoice",element:a.jsx(Rt,{requiredFeatureId:"b5affc71-32e5-481b-932a-77a743253ddc",children:a.jsx(FV,{})})}),a.jsx(ct,{path:"/product/order",element:a.jsx(Rt,{requiredFeatureId:"5f622ea0-ede7-4b24-a203-92d5c9f31a6b",children:a.jsx(fG,{})})}),a.jsx(ct,{path:"/product/product-receive",element:a.jsx(Rt,{requiredFeatureId:"ced86713-e046-457a-b3c9-775304b31557",children:a.jsx(HJ,{})})}),a.jsx(ct,{path:"/product/tracking",element:a.jsx(Rt,{requiredFeatureId:"98cc610a-9dff-4276-91f2-d900cdf00ba7",children:a.jsx(gY,{})})}),a.jsx(ct,{path:"/finance/journal-input",element:a.jsx(Rt,{requiredFeatureId:"58fddce6-6b45-4735-8c59-9d80ccc1928e",children:a.jsx(XU,{})})}),a.jsx(ct,{path:"/finance/balance-sheet",element:a.jsx(Rt,{requiredFeatureId:"bdd46e64-5a59-4001-b70f-b9f4b23da33d",children:a.jsx(iD,{})})}),a.jsx(ct,{path:"/finance/income-statement",element:a.jsx(Rt,{requiredFeatureId:"247a7896-ea5c-49b7-afec-94b500093cd4",children:a.jsx(cF,{})})}),a.jsx(ct,{path:"/finance/cash-ending",element:a.jsx(Rt,{requiredFeatureId:"582171a8-6a92-42e7-99ed-f8233169a652",children:a.jsx(pM,{})})}),a.jsx(ct,{path:"/finance/transaction-history",element:a.jsx(Rt,{requiredFeatureId:"7e1fd11a-f632-427d-aefc-8b3dd6734faa",children:a.jsx(K_,{})})}),a.jsx(ct,{path:"/transactions",element:a.jsx(Rt,{requiredFeatureId:"7e1fd11a-f632-427d-aefc-8b3dd6734faa",children:a.jsx(K_,{})})}),a.jsx(ct,{path:"/employee/employee-setting",element:a.jsx(Rt,{requiredFeatureId:"4a0c90b6-7099-4d76-88b2-783302e1248f",children:a.jsx(O8,{})})}),a.jsx(ct,{path:"/employee/schedule",element:a.jsx(Rt,{requiredFeatureId:"eaf85f06-b708-4c29-b35f-d39d234d1b60",children:a.jsx(q6,{})})}),a.jsx(ct,{path:"/employee/schedule/:storeId",element:a.jsx(Rt,{requiredFeatureId:"eaf85f06-b708-4c29-b35f-d39d234d1b60",children:a.jsx(d9,{})})}),a.jsx(ct,{path:"/employee/salary",element:a.jsx(Rt,{requiredFeatureId:"4a0c90b6-7099-4d76-88b2-783302e1248f",children:a.jsx(m6,{})})}),a.jsx(ct,{path:"/marketing/marketing-plan",element:a.jsx(Rt,{requiredFeatureId:"069fc24c-915b-43a0-8c27-6872badfc4a1",children:a.jsx(dW,{})})}),a.jsx(ct,{path:"/settings/account-mapping",element:a.jsx(Rt,{requiredFeatureId:"6e527ba2-9421-4243-a0f9-2497f5ed9772",children:a.jsx(ZA,{})})}),a.jsx(ct,{path:"/settings/counterparty",element:a.jsx(Rt,{requiredFeatureId:"57b2972a-d2d4-478e-ab10-83e1f429b94b",children:a.jsx(N3,{})})}),a.jsx(ct,{path:"/settings/currency",element:a.jsx(Rt,{requiredFeatureId:"95310d59-24ae-4d8b-9474-c536ed8b0584",children:a.jsx(tO,{})})}),a.jsx(ct,{path:"/settings/store-setting",element:a.jsx(Rt,{requiredFeatureId:"7b767def-41bb-420c-a548-807e4336e738",children:a.jsx(LK,{})})}),a.jsx(ct,{path:"/",element:a.jsx(Ai,{to:"/login",replace:!0})}),a.jsx(ct,{path:"*",element:a.jsx(Ai,{to:"/login",replace:!0})})]}),iQ=()=>a.jsx(jj,{children:a.jsx(yj,{children:a.jsx(aQ,{})})});Lu.createRoot(document.getElementById("root")).render(a.jsx(Ar.StrictMode,{children:a.jsx(Y2,{children:a.jsx(iQ,{})})}));export{dQ as c,Ix as g};
