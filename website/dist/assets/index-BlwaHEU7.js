var Gx=Object.defineProperty;var Jx=(t,e,r)=>e in t?Gx(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var W=(t,e,r)=>Jx(t,typeof e!="symbol"?e+"":e,r);function uy(t,e){for(var r=0;r<e.length;r++){const s=e[r];if(typeof s!="string"&&!Array.isArray(s)){for(const n in s)if(n!=="default"&&!(n in t)){const a=Object.getOwnPropertyDescriptor(s,n);a&&Object.defineProperty(t,n,a.get?a:{enumerable:!0,get:()=>s[n]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function r(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(n){if(n.ep)return;n.ep=!0;const a=r(n);fetch(n.href,a)}})();var fee=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Kx(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Yx(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var r=function s(){return this instanceof s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(s){var n=Object.getOwnPropertyDescriptor(t,s);Object.defineProperty(r,s,n.get?n:{enumerable:!0,get:function(){return t[s]}})}),r}var hy={exports:{}},md={},fy={exports:{}},Ve={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tl=Symbol.for("react.element"),Qx=Symbol.for("react.portal"),Zx=Symbol.for("react.fragment"),Xx=Symbol.for("react.strict_mode"),eb=Symbol.for("react.profiler"),tb=Symbol.for("react.provider"),rb=Symbol.for("react.context"),sb=Symbol.for("react.forward_ref"),nb=Symbol.for("react.suspense"),ab=Symbol.for("react.memo"),ob=Symbol.for("react.lazy"),Fm=Symbol.iterator;function ib(t){return t===null||typeof t!="object"?null:(t=Fm&&t[Fm]||t["@@iterator"],typeof t=="function"?t:null)}var my={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},py=Object.assign,gy={};function So(t,e,r){this.props=t,this.context=e,this.refs=gy,this.updater=r||my}So.prototype.isReactComponent={};So.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};So.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function _y(){}_y.prototype=So.prototype;function nf(t,e,r){this.props=t,this.context=e,this.refs=gy,this.updater=r||my}var af=nf.prototype=new _y;af.constructor=nf;py(af,So.prototype);af.isPureReactComponent=!0;var Bm=Array.isArray,yy=Object.prototype.hasOwnProperty,of={current:null},vy={key:!0,ref:!0,__self:!0,__source:!0};function xy(t,e,r){var s,n={},a=null,i=null;if(e!=null)for(s in e.ref!==void 0&&(i=e.ref),e.key!==void 0&&(a=""+e.key),e)yy.call(e,s)&&!vy.hasOwnProperty(s)&&(n[s]=e[s]);var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];n.children=c}if(t&&t.defaultProps)for(s in l=t.defaultProps,l)n[s]===void 0&&(n[s]=l[s]);return{$$typeof:tl,type:t,key:a,ref:i,props:n,_owner:of.current}}function lb(t,e){return{$$typeof:tl,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function lf(t){return typeof t=="object"&&t!==null&&t.$$typeof===tl}function cb(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var Vm=/\/+/g;function Bd(t,e){return typeof t=="object"&&t!==null&&t.key!=null?cb(""+t.key):e.toString(36)}function oc(t,e,r,s,n){var a=typeof t;(a==="undefined"||a==="boolean")&&(t=null);var i=!1;if(t===null)i=!0;else switch(a){case"string":case"number":i=!0;break;case"object":switch(t.$$typeof){case tl:case Qx:i=!0}}if(i)return i=t,n=n(i),t=s===""?"."+Bd(i,0):s,Bm(n)?(r="",t!=null&&(r=t.replace(Vm,"$&/")+"/"),oc(n,e,r,"",function(d){return d})):n!=null&&(lf(n)&&(n=lb(n,r+(!n.key||i&&i.key===n.key?"":(""+n.key).replace(Vm,"$&/")+"/")+t)),e.push(n)),1;if(i=0,s=s===""?".":s+":",Bm(t))for(var l=0;l<t.length;l++){a=t[l];var c=s+Bd(a,l);i+=oc(a,e,r,c,n)}else if(c=ib(t),typeof c=="function")for(t=c.call(t),l=0;!(a=t.next()).done;)a=a.value,c=s+Bd(a,l++),i+=oc(a,e,r,c,n);else if(a==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return i}function hl(t,e,r){if(t==null)return t;var s=[],n=0;return oc(t,s,"","",function(a){return e.call(r,a,n++)}),s}function db(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var $r={current:null},ic={transition:null},ub={ReactCurrentDispatcher:$r,ReactCurrentBatchConfig:ic,ReactCurrentOwner:of};function by(){throw Error("act(...) is not supported in production builds of React.")}Ve.Children={map:hl,forEach:function(t,e,r){hl(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return hl(t,function(){e++}),e},toArray:function(t){return hl(t,function(e){return e})||[]},only:function(t){if(!lf(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Ve.Component=So;Ve.Fragment=Zx;Ve.Profiler=eb;Ve.PureComponent=nf;Ve.StrictMode=Xx;Ve.Suspense=nb;Ve.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ub;Ve.act=by;Ve.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var s=py({},t.props),n=t.key,a=t.ref,i=t._owner;if(e!=null){if(e.ref!==void 0&&(a=e.ref,i=of.current),e.key!==void 0&&(n=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)yy.call(e,c)&&!vy.hasOwnProperty(c)&&(s[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)s.children=r;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];s.children=l}return{$$typeof:tl,type:t.type,key:n,ref:a,props:s,_owner:i}};Ve.createContext=function(t){return t={$$typeof:rb,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:tb,_context:t},t.Consumer=t};Ve.createElement=xy;Ve.createFactory=function(t){var e=xy.bind(null,t);return e.type=t,e};Ve.createRef=function(){return{current:null}};Ve.forwardRef=function(t){return{$$typeof:sb,render:t}};Ve.isValidElement=lf;Ve.lazy=function(t){return{$$typeof:ob,_payload:{_status:-1,_result:t},_init:db}};Ve.memo=function(t,e){return{$$typeof:ab,type:t,compare:e===void 0?null:e}};Ve.startTransition=function(t){var e=ic.transition;ic.transition={};try{t()}finally{ic.transition=e}};Ve.unstable_act=by;Ve.useCallback=function(t,e){return $r.current.useCallback(t,e)};Ve.useContext=function(t){return $r.current.useContext(t)};Ve.useDebugValue=function(){};Ve.useDeferredValue=function(t){return $r.current.useDeferredValue(t)};Ve.useEffect=function(t,e){return $r.current.useEffect(t,e)};Ve.useId=function(){return $r.current.useId()};Ve.useImperativeHandle=function(t,e,r){return $r.current.useImperativeHandle(t,e,r)};Ve.useInsertionEffect=function(t,e){return $r.current.useInsertionEffect(t,e)};Ve.useLayoutEffect=function(t,e){return $r.current.useLayoutEffect(t,e)};Ve.useMemo=function(t,e){return $r.current.useMemo(t,e)};Ve.useReducer=function(t,e,r){return $r.current.useReducer(t,e,r)};Ve.useRef=function(t){return $r.current.useRef(t)};Ve.useState=function(t){return $r.current.useState(t)};Ve.useSyncExternalStore=function(t,e,r){return $r.current.useSyncExternalStore(t,e,r)};Ve.useTransition=function(){return $r.current.useTransition()};Ve.version="18.3.1";fy.exports=Ve;var S=fy.exports;const Kr=Kx(S),hb=uy({__proto__:null,default:Kr},[S]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fb=S,mb=Symbol.for("react.element"),pb=Symbol.for("react.fragment"),gb=Object.prototype.hasOwnProperty,_b=fb.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,yb={key:!0,ref:!0,__self:!0,__source:!0};function wy(t,e,r){var s,n={},a=null,i=null;r!==void 0&&(a=""+r),e.key!==void 0&&(a=""+e.key),e.ref!==void 0&&(i=e.ref);for(s in e)gb.call(e,s)&&!yb.hasOwnProperty(s)&&(n[s]=e[s]);if(t&&t.defaultProps)for(s in e=t.defaultProps,e)n[s]===void 0&&(n[s]=e[s]);return{$$typeof:mb,type:t,key:a,ref:i,props:n,_owner:_b.current}}md.Fragment=pb;md.jsx=wy;md.jsxs=wy;hy.exports=md;var o=hy.exports,Vu={},Sy={exports:{}},ls={},jy={exports:{}},Cy={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(L,B){var O=L.length;L.push(B);e:for(;0<O;){var M=O-1>>>1,R=L[M];if(0<n(R,B))L[M]=B,L[O]=R,O=M;else break e}}function r(L){return L.length===0?null:L[0]}function s(L){if(L.length===0)return null;var B=L[0],O=L.pop();if(O!==B){L[0]=O;e:for(var M=0,R=L.length,ie=R>>>1;M<ie;){var Z=2*(M+1)-1,Ie=L[Z],Te=Z+1,Ke=L[Te];if(0>n(Ie,O))Te<R&&0>n(Ke,Ie)?(L[M]=Ke,L[Te]=O,M=Te):(L[M]=Ie,L[Z]=O,M=Z);else if(Te<R&&0>n(Ke,O))L[M]=Ke,L[Te]=O,M=Te;else break e}}return B}function n(L,B){var O=L.sortIndex-B.sortIndex;return O!==0?O:L.id-B.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var i=Date,l=i.now();t.unstable_now=function(){return i.now()-l}}var c=[],d=[],u=1,h=null,f=3,p=!1,_=!1,v=!1,x=typeof setTimeout=="function"?setTimeout:null,m=typeof clearTimeout=="function"?clearTimeout:null,g=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(L){for(var B=r(d);B!==null;){if(B.callback===null)s(d);else if(B.startTime<=L)s(d),B.sortIndex=B.expirationTime,e(c,B);else break;B=r(d)}}function w(L){if(v=!1,y(L),!_)if(r(c)!==null)_=!0,z(b);else{var B=r(d);B!==null&&H(w,B.startTime-L)}}function b(L,B){_=!1,v&&(v=!1,m(I),I=-1),p=!0;var O=f;try{for(y(B),h=r(c);h!==null&&(!(h.expirationTime>B)||L&&!T());){var M=h.callback;if(typeof M=="function"){h.callback=null,f=h.priorityLevel;var R=M(h.expirationTime<=B);B=t.unstable_now(),typeof R=="function"?h.callback=R:h===r(c)&&s(c),y(B)}else s(c);h=r(c)}if(h!==null)var ie=!0;else{var Z=r(d);Z!==null&&H(w,Z.startTime-B),ie=!1}return ie}finally{h=null,f=O,p=!1}}var C=!1,j=null,I=-1,k=5,E=-1;function T(){return!(t.unstable_now()-E<k)}function D(){if(j!==null){var L=t.unstable_now();E=L;var B=!0;try{B=j(!0,L)}finally{B?N():(C=!1,j=null)}}else C=!1}var N;if(typeof g=="function")N=function(){g(D)};else if(typeof MessageChannel<"u"){var A=new MessageChannel,$=A.port2;A.port1.onmessage=D,N=function(){$.postMessage(null)}}else N=function(){x(D,0)};function z(L){j=L,C||(C=!0,N())}function H(L,B){I=x(function(){L(t.unstable_now())},B)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(L){L.callback=null},t.unstable_continueExecution=function(){_||p||(_=!0,z(b))},t.unstable_forceFrameRate=function(L){0>L||125<L?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<L?Math.floor(1e3/L):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(L){switch(f){case 1:case 2:case 3:var B=3;break;default:B=f}var O=f;f=B;try{return L()}finally{f=O}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(L,B){switch(L){case 1:case 2:case 3:case 4:case 5:break;default:L=3}var O=f;f=L;try{return B()}finally{f=O}},t.unstable_scheduleCallback=function(L,B,O){var M=t.unstable_now();switch(typeof O=="object"&&O!==null?(O=O.delay,O=typeof O=="number"&&0<O?M+O:M):O=M,L){case 1:var R=-1;break;case 2:R=250;break;case 5:R=1073741823;break;case 4:R=1e4;break;default:R=5e3}return R=O+R,L={id:u++,callback:B,priorityLevel:L,startTime:O,expirationTime:R,sortIndex:-1},O>M?(L.sortIndex=O,e(d,L),r(c)===null&&L===r(d)&&(v?(m(I),I=-1):v=!0,H(w,O-M))):(L.sortIndex=R,e(c,L),_||p||(_=!0,z(b))),L},t.unstable_shouldYield=T,t.unstable_wrapCallback=function(L){var B=f;return function(){var O=f;f=B;try{return L.apply(this,arguments)}finally{f=O}}}})(Cy);jy.exports=Cy;var vb=jy.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xb=S,is=vb;function G(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Ny=new Set,Ii={};function Ea(t,e){fo(t,e),fo(t+"Capture",e)}function fo(t,e){for(Ii[t]=e,t=0;t<e.length;t++)Ny.add(e[t])}var on=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Hu=Object.prototype.hasOwnProperty,bb=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Hm={},zm={};function wb(t){return Hu.call(zm,t)?!0:Hu.call(Hm,t)?!1:bb.test(t)?zm[t]=!0:(Hm[t]=!0,!1)}function Sb(t,e,r,s){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return s?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function jb(t,e,r,s){if(e===null||typeof e>"u"||Sb(t,e,r,s))return!0;if(s)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Fr(t,e,r,s,n,a,i){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=s,this.attributeNamespace=n,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=a,this.removeEmptyString=i}var vr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){vr[t]=new Fr(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];vr[e]=new Fr(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){vr[t]=new Fr(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){vr[t]=new Fr(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){vr[t]=new Fr(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){vr[t]=new Fr(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){vr[t]=new Fr(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){vr[t]=new Fr(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){vr[t]=new Fr(t,5,!1,t.toLowerCase(),null,!1,!1)});var cf=/[\-:]([a-z])/g;function df(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(cf,df);vr[e]=new Fr(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(cf,df);vr[e]=new Fr(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(cf,df);vr[e]=new Fr(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){vr[t]=new Fr(t,1,!1,t.toLowerCase(),null,!1,!1)});vr.xlinkHref=new Fr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){vr[t]=new Fr(t,1,!1,t.toLowerCase(),null,!0,!0)});function uf(t,e,r,s){var n=vr.hasOwnProperty(e)?vr[e]:null;(n!==null?n.type!==0:s||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(jb(e,r,n,s)&&(r=null),s||n===null?wb(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):n.mustUseProperty?t[n.propertyName]=r===null?n.type===3?!1:"":r:(e=n.attributeName,s=n.attributeNamespace,r===null?t.removeAttribute(e):(n=n.type,r=n===3||n===4&&r===!0?"":""+r,s?t.setAttributeNS(s,e,r):t.setAttribute(e,r))))}var hn=xb.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,fl=Symbol.for("react.element"),Ua=Symbol.for("react.portal"),Wa=Symbol.for("react.fragment"),hf=Symbol.for("react.strict_mode"),zu=Symbol.for("react.profiler"),Iy=Symbol.for("react.provider"),ky=Symbol.for("react.context"),ff=Symbol.for("react.forward_ref"),qu=Symbol.for("react.suspense"),Uu=Symbol.for("react.suspense_list"),mf=Symbol.for("react.memo"),vn=Symbol.for("react.lazy"),Ey=Symbol.for("react.offscreen"),qm=Symbol.iterator;function Po(t){return t===null||typeof t!="object"?null:(t=qm&&t[qm]||t["@@iterator"],typeof t=="function"?t:null)}var Rt=Object.assign,Vd;function Yo(t){if(Vd===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);Vd=e&&e[1]||""}return`
`+Vd+t}var Hd=!1;function zd(t,e){if(!t||Hd)return"";Hd=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var s=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){s=d}t.call(e.prototype)}else{try{throw Error()}catch(d){s=d}t()}}catch(d){if(d&&s&&typeof d.stack=="string"){for(var n=d.stack.split(`
`),a=s.stack.split(`
`),i=n.length-1,l=a.length-1;1<=i&&0<=l&&n[i]!==a[l];)l--;for(;1<=i&&0<=l;i--,l--)if(n[i]!==a[l]){if(i!==1||l!==1)do if(i--,l--,0>l||n[i]!==a[l]){var c=`
`+n[i].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=i&&0<=l);break}}}finally{Hd=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?Yo(t):""}function Cb(t){switch(t.tag){case 5:return Yo(t.type);case 16:return Yo("Lazy");case 13:return Yo("Suspense");case 19:return Yo("SuspenseList");case 0:case 2:case 15:return t=zd(t.type,!1),t;case 11:return t=zd(t.type.render,!1),t;case 1:return t=zd(t.type,!0),t;default:return""}}function Wu(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Wa:return"Fragment";case Ua:return"Portal";case zu:return"Profiler";case hf:return"StrictMode";case qu:return"Suspense";case Uu:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case ky:return(t.displayName||"Context")+".Consumer";case Iy:return(t._context.displayName||"Context")+".Provider";case ff:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case mf:return e=t.displayName||null,e!==null?e:Wu(t.type)||"Memo";case vn:e=t._payload,t=t._init;try{return Wu(t(e))}catch{}}return null}function Nb(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Wu(e);case 8:return e===hf?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Vn(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Ty(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Ib(t){var e=Ty(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),s=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var n=r.get,a=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return n.call(this)},set:function(i){s=""+i,a.call(this,i)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return s},setValue:function(i){s=""+i},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function ml(t){t._valueTracker||(t._valueTracker=Ib(t))}function Ly(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),s="";return t&&(s=Ty(t)?t.checked?"true":"false":t.value),t=s,t!==r?(e.setValue(t),!0):!1}function wc(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Gu(t,e){var r=e.checked;return Rt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function Um(t,e){var r=e.defaultValue==null?"":e.defaultValue,s=e.checked!=null?e.checked:e.defaultChecked;r=Vn(e.value!=null?e.value:r),t._wrapperState={initialChecked:s,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Ay(t,e){e=e.checked,e!=null&&uf(t,"checked",e,!1)}function Ju(t,e){Ay(t,e);var r=Vn(e.value),s=e.type;if(r!=null)s==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(s==="submit"||s==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Ku(t,e.type,r):e.hasOwnProperty("defaultValue")&&Ku(t,e.type,Vn(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Wm(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var s=e.type;if(!(s!=="submit"&&s!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function Ku(t,e,r){(e!=="number"||wc(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var Qo=Array.isArray;function so(t,e,r,s){if(t=t.options,e){e={};for(var n=0;n<r.length;n++)e["$"+r[n]]=!0;for(r=0;r<t.length;r++)n=e.hasOwnProperty("$"+t[r].value),t[r].selected!==n&&(t[r].selected=n),n&&s&&(t[r].defaultSelected=!0)}else{for(r=""+Vn(r),e=null,n=0;n<t.length;n++){if(t[n].value===r){t[n].selected=!0,s&&(t[n].defaultSelected=!0);return}e!==null||t[n].disabled||(e=t[n])}e!==null&&(e.selected=!0)}}function Yu(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(G(91));return Rt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Gm(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(G(92));if(Qo(r)){if(1<r.length)throw Error(G(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:Vn(r)}}function Dy(t,e){var r=Vn(e.value),s=Vn(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),s!=null&&(t.defaultValue=""+s)}function Jm(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function My(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Qu(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?My(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var pl,Ry=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,s,n){MSApp.execUnsafeLocalFunction(function(){return t(e,r,s,n)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(pl=pl||document.createElement("div"),pl.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=pl.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function ki(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var li={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},kb=["Webkit","ms","Moz","O"];Object.keys(li).forEach(function(t){kb.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),li[e]=li[t]})});function Py(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||li.hasOwnProperty(t)&&li[t]?(""+e).trim():e+"px"}function Oy(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var s=r.indexOf("--")===0,n=Py(r,e[r],s);r==="float"&&(r="cssFloat"),s?t.setProperty(r,n):t[r]=n}}var Eb=Rt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Zu(t,e){if(e){if(Eb[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(G(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(G(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(G(61))}if(e.style!=null&&typeof e.style!="object")throw Error(G(62))}}function Xu(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var eh=null;function pf(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var th=null,no=null,ao=null;function Km(t){if(t=nl(t)){if(typeof th!="function")throw Error(G(280));var e=t.stateNode;e&&(e=vd(e),th(t.stateNode,t.type,e))}}function $y(t){no?ao?ao.push(t):ao=[t]:no=t}function Fy(){if(no){var t=no,e=ao;if(ao=no=null,Km(t),e)for(t=0;t<e.length;t++)Km(e[t])}}function By(t,e){return t(e)}function Vy(){}var qd=!1;function Hy(t,e,r){if(qd)return t(e,r);qd=!0;try{return By(t,e,r)}finally{qd=!1,(no!==null||ao!==null)&&(Vy(),Fy())}}function Ei(t,e){var r=t.stateNode;if(r===null)return null;var s=vd(r);if(s===null)return null;r=s[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(t=t.type,s=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!s;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(G(231,e,typeof r));return r}var rh=!1;if(on)try{var Oo={};Object.defineProperty(Oo,"passive",{get:function(){rh=!0}}),window.addEventListener("test",Oo,Oo),window.removeEventListener("test",Oo,Oo)}catch{rh=!1}function Tb(t,e,r,s,n,a,i,l,c){var d=Array.prototype.slice.call(arguments,3);try{e.apply(r,d)}catch(u){this.onError(u)}}var ci=!1,Sc=null,jc=!1,sh=null,Lb={onError:function(t){ci=!0,Sc=t}};function Ab(t,e,r,s,n,a,i,l,c){ci=!1,Sc=null,Tb.apply(Lb,arguments)}function Db(t,e,r,s,n,a,i,l,c){if(Ab.apply(this,arguments),ci){if(ci){var d=Sc;ci=!1,Sc=null}else throw Error(G(198));jc||(jc=!0,sh=d)}}function Ta(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function zy(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Ym(t){if(Ta(t)!==t)throw Error(G(188))}function Mb(t){var e=t.alternate;if(!e){if(e=Ta(t),e===null)throw Error(G(188));return e!==t?null:t}for(var r=t,s=e;;){var n=r.return;if(n===null)break;var a=n.alternate;if(a===null){if(s=n.return,s!==null){r=s;continue}break}if(n.child===a.child){for(a=n.child;a;){if(a===r)return Ym(n),t;if(a===s)return Ym(n),e;a=a.sibling}throw Error(G(188))}if(r.return!==s.return)r=n,s=a;else{for(var i=!1,l=n.child;l;){if(l===r){i=!0,r=n,s=a;break}if(l===s){i=!0,s=n,r=a;break}l=l.sibling}if(!i){for(l=a.child;l;){if(l===r){i=!0,r=a,s=n;break}if(l===s){i=!0,s=a,r=n;break}l=l.sibling}if(!i)throw Error(G(189))}}if(r.alternate!==s)throw Error(G(190))}if(r.tag!==3)throw Error(G(188));return r.stateNode.current===r?t:e}function qy(t){return t=Mb(t),t!==null?Uy(t):null}function Uy(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Uy(t);if(e!==null)return e;t=t.sibling}return null}var Wy=is.unstable_scheduleCallback,Qm=is.unstable_cancelCallback,Rb=is.unstable_shouldYield,Pb=is.unstable_requestPaint,Ht=is.unstable_now,Ob=is.unstable_getCurrentPriorityLevel,gf=is.unstable_ImmediatePriority,Gy=is.unstable_UserBlockingPriority,Cc=is.unstable_NormalPriority,$b=is.unstable_LowPriority,Jy=is.unstable_IdlePriority,pd=null,Ws=null;function Fb(t){if(Ws&&typeof Ws.onCommitFiberRoot=="function")try{Ws.onCommitFiberRoot(pd,t,void 0,(t.current.flags&128)===128)}catch{}}var As=Math.clz32?Math.clz32:Hb,Bb=Math.log,Vb=Math.LN2;function Hb(t){return t>>>=0,t===0?32:31-(Bb(t)/Vb|0)|0}var gl=64,_l=4194304;function Zo(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Nc(t,e){var r=t.pendingLanes;if(r===0)return 0;var s=0,n=t.suspendedLanes,a=t.pingedLanes,i=r&268435455;if(i!==0){var l=i&~n;l!==0?s=Zo(l):(a&=i,a!==0&&(s=Zo(a)))}else i=r&~n,i!==0?s=Zo(i):a!==0&&(s=Zo(a));if(s===0)return 0;if(e!==0&&e!==s&&!(e&n)&&(n=s&-s,a=e&-e,n>=a||n===16&&(a&4194240)!==0))return e;if(s&4&&(s|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=s;0<e;)r=31-As(e),n=1<<r,s|=t[r],e&=~n;return s}function zb(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function qb(t,e){for(var r=t.suspendedLanes,s=t.pingedLanes,n=t.expirationTimes,a=t.pendingLanes;0<a;){var i=31-As(a),l=1<<i,c=n[i];c===-1?(!(l&r)||l&s)&&(n[i]=zb(l,e)):c<=e&&(t.expiredLanes|=l),a&=~l}}function nh(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Ky(){var t=gl;return gl<<=1,!(gl&4194240)&&(gl=64),t}function Ud(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function rl(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-As(e),t[e]=r}function Ub(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var s=t.eventTimes;for(t=t.expirationTimes;0<r;){var n=31-As(r),a=1<<n;e[n]=0,s[n]=-1,t[n]=-1,r&=~a}}function _f(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var s=31-As(r),n=1<<s;n&e|t[s]&e&&(t[s]|=e),r&=~n}}var ut=0;function Yy(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Qy,yf,Zy,Xy,e1,ah=!1,yl=[],An=null,Dn=null,Mn=null,Ti=new Map,Li=new Map,bn=[],Wb="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Zm(t,e){switch(t){case"focusin":case"focusout":An=null;break;case"dragenter":case"dragleave":Dn=null;break;case"mouseover":case"mouseout":Mn=null;break;case"pointerover":case"pointerout":Ti.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Li.delete(e.pointerId)}}function $o(t,e,r,s,n,a){return t===null||t.nativeEvent!==a?(t={blockedOn:e,domEventName:r,eventSystemFlags:s,nativeEvent:a,targetContainers:[n]},e!==null&&(e=nl(e),e!==null&&yf(e)),t):(t.eventSystemFlags|=s,e=t.targetContainers,n!==null&&e.indexOf(n)===-1&&e.push(n),t)}function Gb(t,e,r,s,n){switch(e){case"focusin":return An=$o(An,t,e,r,s,n),!0;case"dragenter":return Dn=$o(Dn,t,e,r,s,n),!0;case"mouseover":return Mn=$o(Mn,t,e,r,s,n),!0;case"pointerover":var a=n.pointerId;return Ti.set(a,$o(Ti.get(a)||null,t,e,r,s,n)),!0;case"gotpointercapture":return a=n.pointerId,Li.set(a,$o(Li.get(a)||null,t,e,r,s,n)),!0}return!1}function t1(t){var e=fa(t.target);if(e!==null){var r=Ta(e);if(r!==null){if(e=r.tag,e===13){if(e=zy(r),e!==null){t.blockedOn=e,e1(t.priority,function(){Zy(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function lc(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=oh(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var s=new r.constructor(r.type,r);eh=s,r.target.dispatchEvent(s),eh=null}else return e=nl(r),e!==null&&yf(e),t.blockedOn=r,!1;e.shift()}return!0}function Xm(t,e,r){lc(t)&&r.delete(e)}function Jb(){ah=!1,An!==null&&lc(An)&&(An=null),Dn!==null&&lc(Dn)&&(Dn=null),Mn!==null&&lc(Mn)&&(Mn=null),Ti.forEach(Xm),Li.forEach(Xm)}function Fo(t,e){t.blockedOn===e&&(t.blockedOn=null,ah||(ah=!0,is.unstable_scheduleCallback(is.unstable_NormalPriority,Jb)))}function Ai(t){function e(n){return Fo(n,t)}if(0<yl.length){Fo(yl[0],t);for(var r=1;r<yl.length;r++){var s=yl[r];s.blockedOn===t&&(s.blockedOn=null)}}for(An!==null&&Fo(An,t),Dn!==null&&Fo(Dn,t),Mn!==null&&Fo(Mn,t),Ti.forEach(e),Li.forEach(e),r=0;r<bn.length;r++)s=bn[r],s.blockedOn===t&&(s.blockedOn=null);for(;0<bn.length&&(r=bn[0],r.blockedOn===null);)t1(r),r.blockedOn===null&&bn.shift()}var oo=hn.ReactCurrentBatchConfig,Ic=!0;function Kb(t,e,r,s){var n=ut,a=oo.transition;oo.transition=null;try{ut=1,vf(t,e,r,s)}finally{ut=n,oo.transition=a}}function Yb(t,e,r,s){var n=ut,a=oo.transition;oo.transition=null;try{ut=4,vf(t,e,r,s)}finally{ut=n,oo.transition=a}}function vf(t,e,r,s){if(Ic){var n=oh(t,e,r,s);if(n===null)tu(t,e,s,kc,r),Zm(t,s);else if(Gb(n,t,e,r,s))s.stopPropagation();else if(Zm(t,s),e&4&&-1<Wb.indexOf(t)){for(;n!==null;){var a=nl(n);if(a!==null&&Qy(a),a=oh(t,e,r,s),a===null&&tu(t,e,s,kc,r),a===n)break;n=a}n!==null&&s.stopPropagation()}else tu(t,e,s,null,r)}}var kc=null;function oh(t,e,r,s){if(kc=null,t=pf(s),t=fa(t),t!==null)if(e=Ta(t),e===null)t=null;else if(r=e.tag,r===13){if(t=zy(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return kc=t,null}function r1(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ob()){case gf:return 1;case Gy:return 4;case Cc:case $b:return 16;case Jy:return 536870912;default:return 16}default:return 16}}var Cn=null,xf=null,cc=null;function s1(){if(cc)return cc;var t,e=xf,r=e.length,s,n="value"in Cn?Cn.value:Cn.textContent,a=n.length;for(t=0;t<r&&e[t]===n[t];t++);var i=r-t;for(s=1;s<=i&&e[r-s]===n[a-s];s++);return cc=n.slice(t,1<s?1-s:void 0)}function dc(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function vl(){return!0}function ep(){return!1}function cs(t){function e(r,s,n,a,i){this._reactName=r,this._targetInst=n,this.type=s,this.nativeEvent=a,this.target=i,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(r=t[l],this[l]=r?r(a):a[l]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?vl:ep,this.isPropagationStopped=ep,this}return Rt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=vl)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=vl)},persist:function(){},isPersistent:vl}),e}var jo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},bf=cs(jo),sl=Rt({},jo,{view:0,detail:0}),Qb=cs(sl),Wd,Gd,Bo,gd=Rt({},sl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:wf,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Bo&&(Bo&&t.type==="mousemove"?(Wd=t.screenX-Bo.screenX,Gd=t.screenY-Bo.screenY):Gd=Wd=0,Bo=t),Wd)},movementY:function(t){return"movementY"in t?t.movementY:Gd}}),tp=cs(gd),Zb=Rt({},gd,{dataTransfer:0}),Xb=cs(Zb),ew=Rt({},sl,{relatedTarget:0}),Jd=cs(ew),tw=Rt({},jo,{animationName:0,elapsedTime:0,pseudoElement:0}),rw=cs(tw),sw=Rt({},jo,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),nw=cs(sw),aw=Rt({},jo,{data:0}),rp=cs(aw),ow={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},iw={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},lw={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function cw(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=lw[t])?!!e[t]:!1}function wf(){return cw}var dw=Rt({},sl,{key:function(t){if(t.key){var e=ow[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=dc(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?iw[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:wf,charCode:function(t){return t.type==="keypress"?dc(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?dc(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),uw=cs(dw),hw=Rt({},gd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),sp=cs(hw),fw=Rt({},sl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:wf}),mw=cs(fw),pw=Rt({},jo,{propertyName:0,elapsedTime:0,pseudoElement:0}),gw=cs(pw),_w=Rt({},gd,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),yw=cs(_w),vw=[9,13,27,32],Sf=on&&"CompositionEvent"in window,di=null;on&&"documentMode"in document&&(di=document.documentMode);var xw=on&&"TextEvent"in window&&!di,n1=on&&(!Sf||di&&8<di&&11>=di),np=" ",ap=!1;function a1(t,e){switch(t){case"keyup":return vw.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function o1(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Ga=!1;function bw(t,e){switch(t){case"compositionend":return o1(e);case"keypress":return e.which!==32?null:(ap=!0,np);case"textInput":return t=e.data,t===np&&ap?null:t;default:return null}}function ww(t,e){if(Ga)return t==="compositionend"||!Sf&&a1(t,e)?(t=s1(),cc=xf=Cn=null,Ga=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return n1&&e.locale!=="ko"?null:e.data;default:return null}}var Sw={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function op(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!Sw[t.type]:e==="textarea"}function i1(t,e,r,s){$y(s),e=Ec(e,"onChange"),0<e.length&&(r=new bf("onChange","change",null,r,s),t.push({event:r,listeners:e}))}var ui=null,Di=null;function jw(t){y1(t,0)}function _d(t){var e=Ya(t);if(Ly(e))return t}function Cw(t,e){if(t==="change")return e}var l1=!1;if(on){var Kd;if(on){var Yd="oninput"in document;if(!Yd){var ip=document.createElement("div");ip.setAttribute("oninput","return;"),Yd=typeof ip.oninput=="function"}Kd=Yd}else Kd=!1;l1=Kd&&(!document.documentMode||9<document.documentMode)}function lp(){ui&&(ui.detachEvent("onpropertychange",c1),Di=ui=null)}function c1(t){if(t.propertyName==="value"&&_d(Di)){var e=[];i1(e,Di,t,pf(t)),Hy(jw,e)}}function Nw(t,e,r){t==="focusin"?(lp(),ui=e,Di=r,ui.attachEvent("onpropertychange",c1)):t==="focusout"&&lp()}function Iw(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return _d(Di)}function kw(t,e){if(t==="click")return _d(e)}function Ew(t,e){if(t==="input"||t==="change")return _d(e)}function Tw(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Ms=typeof Object.is=="function"?Object.is:Tw;function Mi(t,e){if(Ms(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),s=Object.keys(e);if(r.length!==s.length)return!1;for(s=0;s<r.length;s++){var n=r[s];if(!Hu.call(e,n)||!Ms(t[n],e[n]))return!1}return!0}function cp(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function dp(t,e){var r=cp(t);t=0;for(var s;r;){if(r.nodeType===3){if(s=t+r.textContent.length,t<=e&&s>=e)return{node:r,offset:e-t};t=s}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=cp(r)}}function d1(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?d1(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function u1(){for(var t=window,e=wc();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=wc(t.document)}return e}function jf(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function Lw(t){var e=u1(),r=t.focusedElem,s=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&d1(r.ownerDocument.documentElement,r)){if(s!==null&&jf(r)){if(e=s.start,t=s.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var n=r.textContent.length,a=Math.min(s.start,n);s=s.end===void 0?a:Math.min(s.end,n),!t.extend&&a>s&&(n=s,s=a,a=n),n=dp(r,a);var i=dp(r,s);n&&i&&(t.rangeCount!==1||t.anchorNode!==n.node||t.anchorOffset!==n.offset||t.focusNode!==i.node||t.focusOffset!==i.offset)&&(e=e.createRange(),e.setStart(n.node,n.offset),t.removeAllRanges(),a>s?(t.addRange(e),t.extend(i.node,i.offset)):(e.setEnd(i.node,i.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Aw=on&&"documentMode"in document&&11>=document.documentMode,Ja=null,ih=null,hi=null,lh=!1;function up(t,e,r){var s=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;lh||Ja==null||Ja!==wc(s)||(s=Ja,"selectionStart"in s&&jf(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),hi&&Mi(hi,s)||(hi=s,s=Ec(ih,"onSelect"),0<s.length&&(e=new bf("onSelect","select",null,e,r),t.push({event:e,listeners:s}),e.target=Ja)))}function xl(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var Ka={animationend:xl("Animation","AnimationEnd"),animationiteration:xl("Animation","AnimationIteration"),animationstart:xl("Animation","AnimationStart"),transitionend:xl("Transition","TransitionEnd")},Qd={},h1={};on&&(h1=document.createElement("div").style,"AnimationEvent"in window||(delete Ka.animationend.animation,delete Ka.animationiteration.animation,delete Ka.animationstart.animation),"TransitionEvent"in window||delete Ka.transitionend.transition);function yd(t){if(Qd[t])return Qd[t];if(!Ka[t])return t;var e=Ka[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in h1)return Qd[t]=e[r];return t}var f1=yd("animationend"),m1=yd("animationiteration"),p1=yd("animationstart"),g1=yd("transitionend"),_1=new Map,hp="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function qn(t,e){_1.set(t,e),Ea(e,[t])}for(var Zd=0;Zd<hp.length;Zd++){var Xd=hp[Zd],Dw=Xd.toLowerCase(),Mw=Xd[0].toUpperCase()+Xd.slice(1);qn(Dw,"on"+Mw)}qn(f1,"onAnimationEnd");qn(m1,"onAnimationIteration");qn(p1,"onAnimationStart");qn("dblclick","onDoubleClick");qn("focusin","onFocus");qn("focusout","onBlur");qn(g1,"onTransitionEnd");fo("onMouseEnter",["mouseout","mouseover"]);fo("onMouseLeave",["mouseout","mouseover"]);fo("onPointerEnter",["pointerout","pointerover"]);fo("onPointerLeave",["pointerout","pointerover"]);Ea("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ea("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ea("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ea("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ea("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ea("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Xo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Rw=new Set("cancel close invalid load scroll toggle".split(" ").concat(Xo));function fp(t,e,r){var s=t.type||"unknown-event";t.currentTarget=r,Db(s,e,void 0,t),t.currentTarget=null}function y1(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var s=t[r],n=s.event;s=s.listeners;e:{var a=void 0;if(e)for(var i=s.length-1;0<=i;i--){var l=s[i],c=l.instance,d=l.currentTarget;if(l=l.listener,c!==a&&n.isPropagationStopped())break e;fp(n,l,d),a=c}else for(i=0;i<s.length;i++){if(l=s[i],c=l.instance,d=l.currentTarget,l=l.listener,c!==a&&n.isPropagationStopped())break e;fp(n,l,d),a=c}}}if(jc)throw t=sh,jc=!1,sh=null,t}function bt(t,e){var r=e[fh];r===void 0&&(r=e[fh]=new Set);var s=t+"__bubble";r.has(s)||(v1(e,t,2,!1),r.add(s))}function eu(t,e,r){var s=0;e&&(s|=4),v1(r,t,s,e)}var bl="_reactListening"+Math.random().toString(36).slice(2);function Ri(t){if(!t[bl]){t[bl]=!0,Ny.forEach(function(r){r!=="selectionchange"&&(Rw.has(r)||eu(r,!1,t),eu(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[bl]||(e[bl]=!0,eu("selectionchange",!1,e))}}function v1(t,e,r,s){switch(r1(e)){case 1:var n=Kb;break;case 4:n=Yb;break;default:n=vf}r=n.bind(null,e,r,t),n=void 0,!rh||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(n=!0),s?n!==void 0?t.addEventListener(e,r,{capture:!0,passive:n}):t.addEventListener(e,r,!0):n!==void 0?t.addEventListener(e,r,{passive:n}):t.addEventListener(e,r,!1)}function tu(t,e,r,s,n){var a=s;if(!(e&1)&&!(e&2)&&s!==null)e:for(;;){if(s===null)return;var i=s.tag;if(i===3||i===4){var l=s.stateNode.containerInfo;if(l===n||l.nodeType===8&&l.parentNode===n)break;if(i===4)for(i=s.return;i!==null;){var c=i.tag;if((c===3||c===4)&&(c=i.stateNode.containerInfo,c===n||c.nodeType===8&&c.parentNode===n))return;i=i.return}for(;l!==null;){if(i=fa(l),i===null)return;if(c=i.tag,c===5||c===6){s=a=i;continue e}l=l.parentNode}}s=s.return}Hy(function(){var d=a,u=pf(r),h=[];e:{var f=_1.get(t);if(f!==void 0){var p=bf,_=t;switch(t){case"keypress":if(dc(r)===0)break e;case"keydown":case"keyup":p=uw;break;case"focusin":_="focus",p=Jd;break;case"focusout":_="blur",p=Jd;break;case"beforeblur":case"afterblur":p=Jd;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=tp;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=Xb;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=mw;break;case f1:case m1:case p1:p=rw;break;case g1:p=gw;break;case"scroll":p=Qb;break;case"wheel":p=yw;break;case"copy":case"cut":case"paste":p=nw;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=sp}var v=(e&4)!==0,x=!v&&t==="scroll",m=v?f!==null?f+"Capture":null:f;v=[];for(var g=d,y;g!==null;){y=g;var w=y.stateNode;if(y.tag===5&&w!==null&&(y=w,m!==null&&(w=Ei(g,m),w!=null&&v.push(Pi(g,w,y)))),x)break;g=g.return}0<v.length&&(f=new p(f,_,null,r,u),h.push({event:f,listeners:v}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",p=t==="mouseout"||t==="pointerout",f&&r!==eh&&(_=r.relatedTarget||r.fromElement)&&(fa(_)||_[ln]))break e;if((p||f)&&(f=u.window===u?u:(f=u.ownerDocument)?f.defaultView||f.parentWindow:window,p?(_=r.relatedTarget||r.toElement,p=d,_=_?fa(_):null,_!==null&&(x=Ta(_),_!==x||_.tag!==5&&_.tag!==6)&&(_=null)):(p=null,_=d),p!==_)){if(v=tp,w="onMouseLeave",m="onMouseEnter",g="mouse",(t==="pointerout"||t==="pointerover")&&(v=sp,w="onPointerLeave",m="onPointerEnter",g="pointer"),x=p==null?f:Ya(p),y=_==null?f:Ya(_),f=new v(w,g+"leave",p,r,u),f.target=x,f.relatedTarget=y,w=null,fa(u)===d&&(v=new v(m,g+"enter",_,r,u),v.target=y,v.relatedTarget=x,w=v),x=w,p&&_)t:{for(v=p,m=_,g=0,y=v;y;y=La(y))g++;for(y=0,w=m;w;w=La(w))y++;for(;0<g-y;)v=La(v),g--;for(;0<y-g;)m=La(m),y--;for(;g--;){if(v===m||m!==null&&v===m.alternate)break t;v=La(v),m=La(m)}v=null}else v=null;p!==null&&mp(h,f,p,v,!1),_!==null&&x!==null&&mp(h,x,_,v,!0)}}e:{if(f=d?Ya(d):window,p=f.nodeName&&f.nodeName.toLowerCase(),p==="select"||p==="input"&&f.type==="file")var b=Cw;else if(op(f))if(l1)b=Ew;else{b=Iw;var C=Nw}else(p=f.nodeName)&&p.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(b=kw);if(b&&(b=b(t,d))){i1(h,b,r,u);break e}C&&C(t,f,d),t==="focusout"&&(C=f._wrapperState)&&C.controlled&&f.type==="number"&&Ku(f,"number",f.value)}switch(C=d?Ya(d):window,t){case"focusin":(op(C)||C.contentEditable==="true")&&(Ja=C,ih=d,hi=null);break;case"focusout":hi=ih=Ja=null;break;case"mousedown":lh=!0;break;case"contextmenu":case"mouseup":case"dragend":lh=!1,up(h,r,u);break;case"selectionchange":if(Aw)break;case"keydown":case"keyup":up(h,r,u)}var j;if(Sf)e:{switch(t){case"compositionstart":var I="onCompositionStart";break e;case"compositionend":I="onCompositionEnd";break e;case"compositionupdate":I="onCompositionUpdate";break e}I=void 0}else Ga?a1(t,r)&&(I="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(I="onCompositionStart");I&&(n1&&r.locale!=="ko"&&(Ga||I!=="onCompositionStart"?I==="onCompositionEnd"&&Ga&&(j=s1()):(Cn=u,xf="value"in Cn?Cn.value:Cn.textContent,Ga=!0)),C=Ec(d,I),0<C.length&&(I=new rp(I,t,null,r,u),h.push({event:I,listeners:C}),j?I.data=j:(j=o1(r),j!==null&&(I.data=j)))),(j=xw?bw(t,r):ww(t,r))&&(d=Ec(d,"onBeforeInput"),0<d.length&&(u=new rp("onBeforeInput","beforeinput",null,r,u),h.push({event:u,listeners:d}),u.data=j))}y1(h,e)})}function Pi(t,e,r){return{instance:t,listener:e,currentTarget:r}}function Ec(t,e){for(var r=e+"Capture",s=[];t!==null;){var n=t,a=n.stateNode;n.tag===5&&a!==null&&(n=a,a=Ei(t,r),a!=null&&s.unshift(Pi(t,a,n)),a=Ei(t,e),a!=null&&s.push(Pi(t,a,n))),t=t.return}return s}function La(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function mp(t,e,r,s,n){for(var a=e._reactName,i=[];r!==null&&r!==s;){var l=r,c=l.alternate,d=l.stateNode;if(c!==null&&c===s)break;l.tag===5&&d!==null&&(l=d,n?(c=Ei(r,a),c!=null&&i.unshift(Pi(r,c,l))):n||(c=Ei(r,a),c!=null&&i.push(Pi(r,c,l)))),r=r.return}i.length!==0&&t.push({event:e,listeners:i})}var Pw=/\r\n?/g,Ow=/\u0000|\uFFFD/g;function pp(t){return(typeof t=="string"?t:""+t).replace(Pw,`
`).replace(Ow,"")}function wl(t,e,r){if(e=pp(e),pp(t)!==e&&r)throw Error(G(425))}function Tc(){}var ch=null,dh=null;function uh(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var hh=typeof setTimeout=="function"?setTimeout:void 0,$w=typeof clearTimeout=="function"?clearTimeout:void 0,gp=typeof Promise=="function"?Promise:void 0,Fw=typeof queueMicrotask=="function"?queueMicrotask:typeof gp<"u"?function(t){return gp.resolve(null).then(t).catch(Bw)}:hh;function Bw(t){setTimeout(function(){throw t})}function ru(t,e){var r=e,s=0;do{var n=r.nextSibling;if(t.removeChild(r),n&&n.nodeType===8)if(r=n.data,r==="/$"){if(s===0){t.removeChild(n),Ai(e);return}s--}else r!=="$"&&r!=="$?"&&r!=="$!"||s++;r=n}while(r);Ai(e)}function Rn(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function _p(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var Co=Math.random().toString(36).slice(2),Us="__reactFiber$"+Co,Oi="__reactProps$"+Co,ln="__reactContainer$"+Co,fh="__reactEvents$"+Co,Vw="__reactListeners$"+Co,Hw="__reactHandles$"+Co;function fa(t){var e=t[Us];if(e)return e;for(var r=t.parentNode;r;){if(e=r[ln]||r[Us]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=_p(t);t!==null;){if(r=t[Us])return r;t=_p(t)}return e}t=r,r=t.parentNode}return null}function nl(t){return t=t[Us]||t[ln],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Ya(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(G(33))}function vd(t){return t[Oi]||null}var mh=[],Qa=-1;function Un(t){return{current:t}}function jt(t){0>Qa||(t.current=mh[Qa],mh[Qa]=null,Qa--)}function yt(t,e){Qa++,mh[Qa]=t.current,t.current=e}var Hn={},kr=Un(Hn),Zr=Un(!1),wa=Hn;function mo(t,e){var r=t.type.contextTypes;if(!r)return Hn;var s=t.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===e)return s.__reactInternalMemoizedMaskedChildContext;var n={},a;for(a in r)n[a]=e[a];return s&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=n),n}function Xr(t){return t=t.childContextTypes,t!=null}function Lc(){jt(Zr),jt(kr)}function yp(t,e,r){if(kr.current!==Hn)throw Error(G(168));yt(kr,e),yt(Zr,r)}function x1(t,e,r){var s=t.stateNode;if(e=e.childContextTypes,typeof s.getChildContext!="function")return r;s=s.getChildContext();for(var n in s)if(!(n in e))throw Error(G(108,Nb(t)||"Unknown",n));return Rt({},r,s)}function Ac(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Hn,wa=kr.current,yt(kr,t),yt(Zr,Zr.current),!0}function vp(t,e,r){var s=t.stateNode;if(!s)throw Error(G(169));r?(t=x1(t,e,wa),s.__reactInternalMemoizedMergedChildContext=t,jt(Zr),jt(kr),yt(kr,t)):jt(Zr),yt(Zr,r)}var tn=null,xd=!1,su=!1;function b1(t){tn===null?tn=[t]:tn.push(t)}function zw(t){xd=!0,b1(t)}function Wn(){if(!su&&tn!==null){su=!0;var t=0,e=ut;try{var r=tn;for(ut=1;t<r.length;t++){var s=r[t];do s=s(!0);while(s!==null)}tn=null,xd=!1}catch(n){throw tn!==null&&(tn=tn.slice(t+1)),Wy(gf,Wn),n}finally{ut=e,su=!1}}return null}var Za=[],Xa=0,Dc=null,Mc=0,ms=[],ps=0,Sa=null,sn=1,nn="";function aa(t,e){Za[Xa++]=Mc,Za[Xa++]=Dc,Dc=t,Mc=e}function w1(t,e,r){ms[ps++]=sn,ms[ps++]=nn,ms[ps++]=Sa,Sa=t;var s=sn;t=nn;var n=32-As(s)-1;s&=~(1<<n),r+=1;var a=32-As(e)+n;if(30<a){var i=n-n%5;a=(s&(1<<i)-1).toString(32),s>>=i,n-=i,sn=1<<32-As(e)+n|r<<n|s,nn=a+t}else sn=1<<a|r<<n|s,nn=t}function Cf(t){t.return!==null&&(aa(t,1),w1(t,1,0))}function Nf(t){for(;t===Dc;)Dc=Za[--Xa],Za[Xa]=null,Mc=Za[--Xa],Za[Xa]=null;for(;t===Sa;)Sa=ms[--ps],ms[ps]=null,nn=ms[--ps],ms[ps]=null,sn=ms[--ps],ms[ps]=null}var os=null,as=null,kt=!1,Ls=null;function S1(t,e){var r=gs(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function xp(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,os=t,as=Rn(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,os=t,as=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=Sa!==null?{id:sn,overflow:nn}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=gs(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,os=t,as=null,!0):!1;default:return!1}}function ph(t){return(t.mode&1)!==0&&(t.flags&128)===0}function gh(t){if(kt){var e=as;if(e){var r=e;if(!xp(t,e)){if(ph(t))throw Error(G(418));e=Rn(r.nextSibling);var s=os;e&&xp(t,e)?S1(s,r):(t.flags=t.flags&-4097|2,kt=!1,os=t)}}else{if(ph(t))throw Error(G(418));t.flags=t.flags&-4097|2,kt=!1,os=t}}}function bp(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;os=t}function Sl(t){if(t!==os)return!1;if(!kt)return bp(t),kt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!uh(t.type,t.memoizedProps)),e&&(e=as)){if(ph(t))throw j1(),Error(G(418));for(;e;)S1(t,e),e=Rn(e.nextSibling)}if(bp(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(G(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){as=Rn(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}as=null}}else as=os?Rn(t.stateNode.nextSibling):null;return!0}function j1(){for(var t=as;t;)t=Rn(t.nextSibling)}function po(){as=os=null,kt=!1}function If(t){Ls===null?Ls=[t]:Ls.push(t)}var qw=hn.ReactCurrentBatchConfig;function Vo(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(G(309));var s=r.stateNode}if(!s)throw Error(G(147,t));var n=s,a=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===a?e.ref:(e=function(i){var l=n.refs;i===null?delete l[a]:l[a]=i},e._stringRef=a,e)}if(typeof t!="string")throw Error(G(284));if(!r._owner)throw Error(G(290,t))}return t}function jl(t,e){throw t=Object.prototype.toString.call(e),Error(G(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function wp(t){var e=t._init;return e(t._payload)}function C1(t){function e(m,g){if(t){var y=m.deletions;y===null?(m.deletions=[g],m.flags|=16):y.push(g)}}function r(m,g){if(!t)return null;for(;g!==null;)e(m,g),g=g.sibling;return null}function s(m,g){for(m=new Map;g!==null;)g.key!==null?m.set(g.key,g):m.set(g.index,g),g=g.sibling;return m}function n(m,g){return m=Fn(m,g),m.index=0,m.sibling=null,m}function a(m,g,y){return m.index=y,t?(y=m.alternate,y!==null?(y=y.index,y<g?(m.flags|=2,g):y):(m.flags|=2,g)):(m.flags|=1048576,g)}function i(m){return t&&m.alternate===null&&(m.flags|=2),m}function l(m,g,y,w){return g===null||g.tag!==6?(g=du(y,m.mode,w),g.return=m,g):(g=n(g,y),g.return=m,g)}function c(m,g,y,w){var b=y.type;return b===Wa?u(m,g,y.props.children,w,y.key):g!==null&&(g.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===vn&&wp(b)===g.type)?(w=n(g,y.props),w.ref=Vo(m,g,y),w.return=m,w):(w=_c(y.type,y.key,y.props,null,m.mode,w),w.ref=Vo(m,g,y),w.return=m,w)}function d(m,g,y,w){return g===null||g.tag!==4||g.stateNode.containerInfo!==y.containerInfo||g.stateNode.implementation!==y.implementation?(g=uu(y,m.mode,w),g.return=m,g):(g=n(g,y.children||[]),g.return=m,g)}function u(m,g,y,w,b){return g===null||g.tag!==7?(g=va(y,m.mode,w,b),g.return=m,g):(g=n(g,y),g.return=m,g)}function h(m,g,y){if(typeof g=="string"&&g!==""||typeof g=="number")return g=du(""+g,m.mode,y),g.return=m,g;if(typeof g=="object"&&g!==null){switch(g.$$typeof){case fl:return y=_c(g.type,g.key,g.props,null,m.mode,y),y.ref=Vo(m,null,g),y.return=m,y;case Ua:return g=uu(g,m.mode,y),g.return=m,g;case vn:var w=g._init;return h(m,w(g._payload),y)}if(Qo(g)||Po(g))return g=va(g,m.mode,y,null),g.return=m,g;jl(m,g)}return null}function f(m,g,y,w){var b=g!==null?g.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return b!==null?null:l(m,g,""+y,w);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case fl:return y.key===b?c(m,g,y,w):null;case Ua:return y.key===b?d(m,g,y,w):null;case vn:return b=y._init,f(m,g,b(y._payload),w)}if(Qo(y)||Po(y))return b!==null?null:u(m,g,y,w,null);jl(m,y)}return null}function p(m,g,y,w,b){if(typeof w=="string"&&w!==""||typeof w=="number")return m=m.get(y)||null,l(g,m,""+w,b);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case fl:return m=m.get(w.key===null?y:w.key)||null,c(g,m,w,b);case Ua:return m=m.get(w.key===null?y:w.key)||null,d(g,m,w,b);case vn:var C=w._init;return p(m,g,y,C(w._payload),b)}if(Qo(w)||Po(w))return m=m.get(y)||null,u(g,m,w,b,null);jl(g,w)}return null}function _(m,g,y,w){for(var b=null,C=null,j=g,I=g=0,k=null;j!==null&&I<y.length;I++){j.index>I?(k=j,j=null):k=j.sibling;var E=f(m,j,y[I],w);if(E===null){j===null&&(j=k);break}t&&j&&E.alternate===null&&e(m,j),g=a(E,g,I),C===null?b=E:C.sibling=E,C=E,j=k}if(I===y.length)return r(m,j),kt&&aa(m,I),b;if(j===null){for(;I<y.length;I++)j=h(m,y[I],w),j!==null&&(g=a(j,g,I),C===null?b=j:C.sibling=j,C=j);return kt&&aa(m,I),b}for(j=s(m,j);I<y.length;I++)k=p(j,m,I,y[I],w),k!==null&&(t&&k.alternate!==null&&j.delete(k.key===null?I:k.key),g=a(k,g,I),C===null?b=k:C.sibling=k,C=k);return t&&j.forEach(function(T){return e(m,T)}),kt&&aa(m,I),b}function v(m,g,y,w){var b=Po(y);if(typeof b!="function")throw Error(G(150));if(y=b.call(y),y==null)throw Error(G(151));for(var C=b=null,j=g,I=g=0,k=null,E=y.next();j!==null&&!E.done;I++,E=y.next()){j.index>I?(k=j,j=null):k=j.sibling;var T=f(m,j,E.value,w);if(T===null){j===null&&(j=k);break}t&&j&&T.alternate===null&&e(m,j),g=a(T,g,I),C===null?b=T:C.sibling=T,C=T,j=k}if(E.done)return r(m,j),kt&&aa(m,I),b;if(j===null){for(;!E.done;I++,E=y.next())E=h(m,E.value,w),E!==null&&(g=a(E,g,I),C===null?b=E:C.sibling=E,C=E);return kt&&aa(m,I),b}for(j=s(m,j);!E.done;I++,E=y.next())E=p(j,m,I,E.value,w),E!==null&&(t&&E.alternate!==null&&j.delete(E.key===null?I:E.key),g=a(E,g,I),C===null?b=E:C.sibling=E,C=E);return t&&j.forEach(function(D){return e(m,D)}),kt&&aa(m,I),b}function x(m,g,y,w){if(typeof y=="object"&&y!==null&&y.type===Wa&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case fl:e:{for(var b=y.key,C=g;C!==null;){if(C.key===b){if(b=y.type,b===Wa){if(C.tag===7){r(m,C.sibling),g=n(C,y.props.children),g.return=m,m=g;break e}}else if(C.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===vn&&wp(b)===C.type){r(m,C.sibling),g=n(C,y.props),g.ref=Vo(m,C,y),g.return=m,m=g;break e}r(m,C);break}else e(m,C);C=C.sibling}y.type===Wa?(g=va(y.props.children,m.mode,w,y.key),g.return=m,m=g):(w=_c(y.type,y.key,y.props,null,m.mode,w),w.ref=Vo(m,g,y),w.return=m,m=w)}return i(m);case Ua:e:{for(C=y.key;g!==null;){if(g.key===C)if(g.tag===4&&g.stateNode.containerInfo===y.containerInfo&&g.stateNode.implementation===y.implementation){r(m,g.sibling),g=n(g,y.children||[]),g.return=m,m=g;break e}else{r(m,g);break}else e(m,g);g=g.sibling}g=uu(y,m.mode,w),g.return=m,m=g}return i(m);case vn:return C=y._init,x(m,g,C(y._payload),w)}if(Qo(y))return _(m,g,y,w);if(Po(y))return v(m,g,y,w);jl(m,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,g!==null&&g.tag===6?(r(m,g.sibling),g=n(g,y),g.return=m,m=g):(r(m,g),g=du(y,m.mode,w),g.return=m,m=g),i(m)):r(m,g)}return x}var go=C1(!0),N1=C1(!1),Rc=Un(null),Pc=null,eo=null,kf=null;function Ef(){kf=eo=Pc=null}function Tf(t){var e=Rc.current;jt(Rc),t._currentValue=e}function _h(t,e,r){for(;t!==null;){var s=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,s!==null&&(s.childLanes|=e)):s!==null&&(s.childLanes&e)!==e&&(s.childLanes|=e),t===r)break;t=t.return}}function io(t,e){Pc=t,kf=eo=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Yr=!0),t.firstContext=null)}function vs(t){var e=t._currentValue;if(kf!==t)if(t={context:t,memoizedValue:e,next:null},eo===null){if(Pc===null)throw Error(G(308));eo=t,Pc.dependencies={lanes:0,firstContext:t}}else eo=eo.next=t;return e}var ma=null;function Lf(t){ma===null?ma=[t]:ma.push(t)}function I1(t,e,r,s){var n=e.interleaved;return n===null?(r.next=r,Lf(e)):(r.next=n.next,n.next=r),e.interleaved=r,cn(t,s)}function cn(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var xn=!1;function Af(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function k1(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function an(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Pn(t,e,r){var s=t.updateQueue;if(s===null)return null;if(s=s.shared,Xe&2){var n=s.pending;return n===null?e.next=e:(e.next=n.next,n.next=e),s.pending=e,cn(t,r)}return n=s.interleaved,n===null?(e.next=e,Lf(s)):(e.next=n.next,n.next=e),s.interleaved=e,cn(t,r)}function uc(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var s=e.lanes;s&=t.pendingLanes,r|=s,e.lanes=r,_f(t,r)}}function Sp(t,e){var r=t.updateQueue,s=t.alternate;if(s!==null&&(s=s.updateQueue,r===s)){var n=null,a=null;if(r=r.firstBaseUpdate,r!==null){do{var i={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};a===null?n=a=i:a=a.next=i,r=r.next}while(r!==null);a===null?n=a=e:a=a.next=e}else n=a=e;r={baseState:s.baseState,firstBaseUpdate:n,lastBaseUpdate:a,shared:s.shared,effects:s.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function Oc(t,e,r,s){var n=t.updateQueue;xn=!1;var a=n.firstBaseUpdate,i=n.lastBaseUpdate,l=n.shared.pending;if(l!==null){n.shared.pending=null;var c=l,d=c.next;c.next=null,i===null?a=d:i.next=d,i=c;var u=t.alternate;u!==null&&(u=u.updateQueue,l=u.lastBaseUpdate,l!==i&&(l===null?u.firstBaseUpdate=d:l.next=d,u.lastBaseUpdate=c))}if(a!==null){var h=n.baseState;i=0,u=d=c=null,l=a;do{var f=l.lane,p=l.eventTime;if((s&f)===f){u!==null&&(u=u.next={eventTime:p,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var _=t,v=l;switch(f=e,p=r,v.tag){case 1:if(_=v.payload,typeof _=="function"){h=_.call(p,h,f);break e}h=_;break e;case 3:_.flags=_.flags&-65537|128;case 0:if(_=v.payload,f=typeof _=="function"?_.call(p,h,f):_,f==null)break e;h=Rt({},h,f);break e;case 2:xn=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,f=n.effects,f===null?n.effects=[l]:f.push(l))}else p={eventTime:p,lane:f,tag:l.tag,payload:l.payload,callback:l.callback,next:null},u===null?(d=u=p,c=h):u=u.next=p,i|=f;if(l=l.next,l===null){if(l=n.shared.pending,l===null)break;f=l,l=f.next,f.next=null,n.lastBaseUpdate=f,n.shared.pending=null}}while(!0);if(u===null&&(c=h),n.baseState=c,n.firstBaseUpdate=d,n.lastBaseUpdate=u,e=n.shared.interleaved,e!==null){n=e;do i|=n.lane,n=n.next;while(n!==e)}else a===null&&(n.shared.lanes=0);Ca|=i,t.lanes=i,t.memoizedState=h}}function jp(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var s=t[e],n=s.callback;if(n!==null){if(s.callback=null,s=r,typeof n!="function")throw Error(G(191,n));n.call(s)}}}var al={},Gs=Un(al),$i=Un(al),Fi=Un(al);function pa(t){if(t===al)throw Error(G(174));return t}function Df(t,e){switch(yt(Fi,e),yt($i,t),yt(Gs,al),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Qu(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Qu(e,t)}jt(Gs),yt(Gs,e)}function _o(){jt(Gs),jt($i),jt(Fi)}function E1(t){pa(Fi.current);var e=pa(Gs.current),r=Qu(e,t.type);e!==r&&(yt($i,t),yt(Gs,r))}function Mf(t){$i.current===t&&(jt(Gs),jt($i))}var Dt=Un(0);function $c(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var nu=[];function Rf(){for(var t=0;t<nu.length;t++)nu[t]._workInProgressVersionPrimary=null;nu.length=0}var hc=hn.ReactCurrentDispatcher,au=hn.ReactCurrentBatchConfig,ja=0,Mt=null,or=null,ur=null,Fc=!1,fi=!1,Bi=0,Uw=0;function xr(){throw Error(G(321))}function Pf(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!Ms(t[r],e[r]))return!1;return!0}function Of(t,e,r,s,n,a){if(ja=a,Mt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,hc.current=t===null||t.memoizedState===null?Kw:Yw,t=r(s,n),fi){a=0;do{if(fi=!1,Bi=0,25<=a)throw Error(G(301));a+=1,ur=or=null,e.updateQueue=null,hc.current=Qw,t=r(s,n)}while(fi)}if(hc.current=Bc,e=or!==null&&or.next!==null,ja=0,ur=or=Mt=null,Fc=!1,e)throw Error(G(300));return t}function $f(){var t=Bi!==0;return Bi=0,t}function Hs(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ur===null?Mt.memoizedState=ur=t:ur=ur.next=t,ur}function xs(){if(or===null){var t=Mt.alternate;t=t!==null?t.memoizedState:null}else t=or.next;var e=ur===null?Mt.memoizedState:ur.next;if(e!==null)ur=e,or=t;else{if(t===null)throw Error(G(310));or=t,t={memoizedState:or.memoizedState,baseState:or.baseState,baseQueue:or.baseQueue,queue:or.queue,next:null},ur===null?Mt.memoizedState=ur=t:ur=ur.next=t}return ur}function Vi(t,e){return typeof e=="function"?e(t):e}function ou(t){var e=xs(),r=e.queue;if(r===null)throw Error(G(311));r.lastRenderedReducer=t;var s=or,n=s.baseQueue,a=r.pending;if(a!==null){if(n!==null){var i=n.next;n.next=a.next,a.next=i}s.baseQueue=n=a,r.pending=null}if(n!==null){a=n.next,s=s.baseState;var l=i=null,c=null,d=a;do{var u=d.lane;if((ja&u)===u)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),s=d.hasEagerState?d.eagerState:t(s,d.action);else{var h={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(l=c=h,i=s):c=c.next=h,Mt.lanes|=u,Ca|=u}d=d.next}while(d!==null&&d!==a);c===null?i=s:c.next=l,Ms(s,e.memoizedState)||(Yr=!0),e.memoizedState=s,e.baseState=i,e.baseQueue=c,r.lastRenderedState=s}if(t=r.interleaved,t!==null){n=t;do a=n.lane,Mt.lanes|=a,Ca|=a,n=n.next;while(n!==t)}else n===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function iu(t){var e=xs(),r=e.queue;if(r===null)throw Error(G(311));r.lastRenderedReducer=t;var s=r.dispatch,n=r.pending,a=e.memoizedState;if(n!==null){r.pending=null;var i=n=n.next;do a=t(a,i.action),i=i.next;while(i!==n);Ms(a,e.memoizedState)||(Yr=!0),e.memoizedState=a,e.baseQueue===null&&(e.baseState=a),r.lastRenderedState=a}return[a,s]}function T1(){}function L1(t,e){var r=Mt,s=xs(),n=e(),a=!Ms(s.memoizedState,n);if(a&&(s.memoizedState=n,Yr=!0),s=s.queue,Ff(M1.bind(null,r,s,t),[t]),s.getSnapshot!==e||a||ur!==null&&ur.memoizedState.tag&1){if(r.flags|=2048,Hi(9,D1.bind(null,r,s,n,e),void 0,null),fr===null)throw Error(G(349));ja&30||A1(r,e,n)}return n}function A1(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=Mt.updateQueue,e===null?(e={lastEffect:null,stores:null},Mt.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function D1(t,e,r,s){e.value=r,e.getSnapshot=s,R1(e)&&P1(t)}function M1(t,e,r){return r(function(){R1(e)&&P1(t)})}function R1(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!Ms(t,r)}catch{return!0}}function P1(t){var e=cn(t,1);e!==null&&Ds(e,t,1,-1)}function Cp(t){var e=Hs();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Vi,lastRenderedState:t},e.queue=t,t=t.dispatch=Jw.bind(null,Mt,t),[e.memoizedState,t]}function Hi(t,e,r,s){return t={tag:t,create:e,destroy:r,deps:s,next:null},e=Mt.updateQueue,e===null?(e={lastEffect:null,stores:null},Mt.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(s=r.next,r.next=t,t.next=s,e.lastEffect=t)),t}function O1(){return xs().memoizedState}function fc(t,e,r,s){var n=Hs();Mt.flags|=t,n.memoizedState=Hi(1|e,r,void 0,s===void 0?null:s)}function bd(t,e,r,s){var n=xs();s=s===void 0?null:s;var a=void 0;if(or!==null){var i=or.memoizedState;if(a=i.destroy,s!==null&&Pf(s,i.deps)){n.memoizedState=Hi(e,r,a,s);return}}Mt.flags|=t,n.memoizedState=Hi(1|e,r,a,s)}function Np(t,e){return fc(8390656,8,t,e)}function Ff(t,e){return bd(2048,8,t,e)}function $1(t,e){return bd(4,2,t,e)}function F1(t,e){return bd(4,4,t,e)}function B1(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function V1(t,e,r){return r=r!=null?r.concat([t]):null,bd(4,4,B1.bind(null,e,t),r)}function Bf(){}function H1(t,e){var r=xs();e=e===void 0?null:e;var s=r.memoizedState;return s!==null&&e!==null&&Pf(e,s[1])?s[0]:(r.memoizedState=[t,e],t)}function z1(t,e){var r=xs();e=e===void 0?null:e;var s=r.memoizedState;return s!==null&&e!==null&&Pf(e,s[1])?s[0]:(t=t(),r.memoizedState=[t,e],t)}function q1(t,e,r){return ja&21?(Ms(r,e)||(r=Ky(),Mt.lanes|=r,Ca|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Yr=!0),t.memoizedState=r)}function Ww(t,e){var r=ut;ut=r!==0&&4>r?r:4,t(!0);var s=au.transition;au.transition={};try{t(!1),e()}finally{ut=r,au.transition=s}}function U1(){return xs().memoizedState}function Gw(t,e,r){var s=$n(t);if(r={lane:s,action:r,hasEagerState:!1,eagerState:null,next:null},W1(t))G1(e,r);else if(r=I1(t,e,r,s),r!==null){var n=Or();Ds(r,t,s,n),J1(r,e,s)}}function Jw(t,e,r){var s=$n(t),n={lane:s,action:r,hasEagerState:!1,eagerState:null,next:null};if(W1(t))G1(e,n);else{var a=t.alternate;if(t.lanes===0&&(a===null||a.lanes===0)&&(a=e.lastRenderedReducer,a!==null))try{var i=e.lastRenderedState,l=a(i,r);if(n.hasEagerState=!0,n.eagerState=l,Ms(l,i)){var c=e.interleaved;c===null?(n.next=n,Lf(e)):(n.next=c.next,c.next=n),e.interleaved=n;return}}catch{}finally{}r=I1(t,e,n,s),r!==null&&(n=Or(),Ds(r,t,s,n),J1(r,e,s))}}function W1(t){var e=t.alternate;return t===Mt||e!==null&&e===Mt}function G1(t,e){fi=Fc=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function J1(t,e,r){if(r&4194240){var s=e.lanes;s&=t.pendingLanes,r|=s,e.lanes=r,_f(t,r)}}var Bc={readContext:vs,useCallback:xr,useContext:xr,useEffect:xr,useImperativeHandle:xr,useInsertionEffect:xr,useLayoutEffect:xr,useMemo:xr,useReducer:xr,useRef:xr,useState:xr,useDebugValue:xr,useDeferredValue:xr,useTransition:xr,useMutableSource:xr,useSyncExternalStore:xr,useId:xr,unstable_isNewReconciler:!1},Kw={readContext:vs,useCallback:function(t,e){return Hs().memoizedState=[t,e===void 0?null:e],t},useContext:vs,useEffect:Np,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,fc(4194308,4,B1.bind(null,e,t),r)},useLayoutEffect:function(t,e){return fc(4194308,4,t,e)},useInsertionEffect:function(t,e){return fc(4,2,t,e)},useMemo:function(t,e){var r=Hs();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var s=Hs();return e=r!==void 0?r(e):e,s.memoizedState=s.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},s.queue=t,t=t.dispatch=Gw.bind(null,Mt,t),[s.memoizedState,t]},useRef:function(t){var e=Hs();return t={current:t},e.memoizedState=t},useState:Cp,useDebugValue:Bf,useDeferredValue:function(t){return Hs().memoizedState=t},useTransition:function(){var t=Cp(!1),e=t[0];return t=Ww.bind(null,t[1]),Hs().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var s=Mt,n=Hs();if(kt){if(r===void 0)throw Error(G(407));r=r()}else{if(r=e(),fr===null)throw Error(G(349));ja&30||A1(s,e,r)}n.memoizedState=r;var a={value:r,getSnapshot:e};return n.queue=a,Np(M1.bind(null,s,a,t),[t]),s.flags|=2048,Hi(9,D1.bind(null,s,a,r,e),void 0,null),r},useId:function(){var t=Hs(),e=fr.identifierPrefix;if(kt){var r=nn,s=sn;r=(s&~(1<<32-As(s)-1)).toString(32)+r,e=":"+e+"R"+r,r=Bi++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=Uw++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},Yw={readContext:vs,useCallback:H1,useContext:vs,useEffect:Ff,useImperativeHandle:V1,useInsertionEffect:$1,useLayoutEffect:F1,useMemo:z1,useReducer:ou,useRef:O1,useState:function(){return ou(Vi)},useDebugValue:Bf,useDeferredValue:function(t){var e=xs();return q1(e,or.memoizedState,t)},useTransition:function(){var t=ou(Vi)[0],e=xs().memoizedState;return[t,e]},useMutableSource:T1,useSyncExternalStore:L1,useId:U1,unstable_isNewReconciler:!1},Qw={readContext:vs,useCallback:H1,useContext:vs,useEffect:Ff,useImperativeHandle:V1,useInsertionEffect:$1,useLayoutEffect:F1,useMemo:z1,useReducer:iu,useRef:O1,useState:function(){return iu(Vi)},useDebugValue:Bf,useDeferredValue:function(t){var e=xs();return or===null?e.memoizedState=t:q1(e,or.memoizedState,t)},useTransition:function(){var t=iu(Vi)[0],e=xs().memoizedState;return[t,e]},useMutableSource:T1,useSyncExternalStore:L1,useId:U1,unstable_isNewReconciler:!1};function Is(t,e){if(t&&t.defaultProps){e=Rt({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function yh(t,e,r,s){e=t.memoizedState,r=r(s,e),r=r==null?e:Rt({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var wd={isMounted:function(t){return(t=t._reactInternals)?Ta(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var s=Or(),n=$n(t),a=an(s,n);a.payload=e,r!=null&&(a.callback=r),e=Pn(t,a,n),e!==null&&(Ds(e,t,n,s),uc(e,t,n))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var s=Or(),n=$n(t),a=an(s,n);a.tag=1,a.payload=e,r!=null&&(a.callback=r),e=Pn(t,a,n),e!==null&&(Ds(e,t,n,s),uc(e,t,n))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=Or(),s=$n(t),n=an(r,s);n.tag=2,e!=null&&(n.callback=e),e=Pn(t,n,s),e!==null&&(Ds(e,t,s,r),uc(e,t,s))}};function Ip(t,e,r,s,n,a,i){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(s,a,i):e.prototype&&e.prototype.isPureReactComponent?!Mi(r,s)||!Mi(n,a):!0}function K1(t,e,r){var s=!1,n=Hn,a=e.contextType;return typeof a=="object"&&a!==null?a=vs(a):(n=Xr(e)?wa:kr.current,s=e.contextTypes,a=(s=s!=null)?mo(t,n):Hn),e=new e(r,a),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=wd,t.stateNode=e,e._reactInternals=t,s&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=n,t.__reactInternalMemoizedMaskedChildContext=a),e}function kp(t,e,r,s){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,s),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,s),e.state!==t&&wd.enqueueReplaceState(e,e.state,null)}function vh(t,e,r,s){var n=t.stateNode;n.props=r,n.state=t.memoizedState,n.refs={},Af(t);var a=e.contextType;typeof a=="object"&&a!==null?n.context=vs(a):(a=Xr(e)?wa:kr.current,n.context=mo(t,a)),n.state=t.memoizedState,a=e.getDerivedStateFromProps,typeof a=="function"&&(yh(t,e,a,r),n.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof n.getSnapshotBeforeUpdate=="function"||typeof n.UNSAFE_componentWillMount!="function"&&typeof n.componentWillMount!="function"||(e=n.state,typeof n.componentWillMount=="function"&&n.componentWillMount(),typeof n.UNSAFE_componentWillMount=="function"&&n.UNSAFE_componentWillMount(),e!==n.state&&wd.enqueueReplaceState(n,n.state,null),Oc(t,r,n,s),n.state=t.memoizedState),typeof n.componentDidMount=="function"&&(t.flags|=4194308)}function yo(t,e){try{var r="",s=e;do r+=Cb(s),s=s.return;while(s);var n=r}catch(a){n=`
Error generating stack: `+a.message+`
`+a.stack}return{value:t,source:e,stack:n,digest:null}}function lu(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function xh(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var Zw=typeof WeakMap=="function"?WeakMap:Map;function Y1(t,e,r){r=an(-1,r),r.tag=3,r.payload={element:null};var s=e.value;return r.callback=function(){Hc||(Hc=!0,Th=s),xh(t,e)},r}function Q1(t,e,r){r=an(-1,r),r.tag=3;var s=t.type.getDerivedStateFromError;if(typeof s=="function"){var n=e.value;r.payload=function(){return s(n)},r.callback=function(){xh(t,e)}}var a=t.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(r.callback=function(){xh(t,e),typeof s!="function"&&(On===null?On=new Set([this]):On.add(this));var i=e.stack;this.componentDidCatch(e.value,{componentStack:i!==null?i:""})}),r}function Ep(t,e,r){var s=t.pingCache;if(s===null){s=t.pingCache=new Zw;var n=new Set;s.set(e,n)}else n=s.get(e),n===void 0&&(n=new Set,s.set(e,n));n.has(r)||(n.add(r),t=h2.bind(null,t,e,r),e.then(t,t))}function Tp(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Lp(t,e,r,s,n){return t.mode&1?(t.flags|=65536,t.lanes=n,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=an(-1,1),e.tag=2,Pn(r,e,1))),r.lanes|=1),t)}var Xw=hn.ReactCurrentOwner,Yr=!1;function Mr(t,e,r,s){e.child=t===null?N1(e,null,r,s):go(e,t.child,r,s)}function Ap(t,e,r,s,n){r=r.render;var a=e.ref;return io(e,n),s=Of(t,e,r,s,a,n),r=$f(),t!==null&&!Yr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~n,dn(t,e,n)):(kt&&r&&Cf(e),e.flags|=1,Mr(t,e,s,n),e.child)}function Dp(t,e,r,s,n){if(t===null){var a=r.type;return typeof a=="function"&&!Jf(a)&&a.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=a,Z1(t,e,a,s,n)):(t=_c(r.type,null,s,e,e.mode,n),t.ref=e.ref,t.return=e,e.child=t)}if(a=t.child,!(t.lanes&n)){var i=a.memoizedProps;if(r=r.compare,r=r!==null?r:Mi,r(i,s)&&t.ref===e.ref)return dn(t,e,n)}return e.flags|=1,t=Fn(a,s),t.ref=e.ref,t.return=e,e.child=t}function Z1(t,e,r,s,n){if(t!==null){var a=t.memoizedProps;if(Mi(a,s)&&t.ref===e.ref)if(Yr=!1,e.pendingProps=s=a,(t.lanes&n)!==0)t.flags&131072&&(Yr=!0);else return e.lanes=t.lanes,dn(t,e,n)}return bh(t,e,r,s,n)}function X1(t,e,r){var s=e.pendingProps,n=s.children,a=t!==null?t.memoizedState:null;if(s.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},yt(ro,rs),rs|=r;else{if(!(r&1073741824))return t=a!==null?a.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,yt(ro,rs),rs|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=a!==null?a.baseLanes:r,yt(ro,rs),rs|=s}else a!==null?(s=a.baseLanes|r,e.memoizedState=null):s=r,yt(ro,rs),rs|=s;return Mr(t,e,n,r),e.child}function ev(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function bh(t,e,r,s,n){var a=Xr(r)?wa:kr.current;return a=mo(e,a),io(e,n),r=Of(t,e,r,s,a,n),s=$f(),t!==null&&!Yr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~n,dn(t,e,n)):(kt&&s&&Cf(e),e.flags|=1,Mr(t,e,r,n),e.child)}function Mp(t,e,r,s,n){if(Xr(r)){var a=!0;Ac(e)}else a=!1;if(io(e,n),e.stateNode===null)mc(t,e),K1(e,r,s),vh(e,r,s,n),s=!0;else if(t===null){var i=e.stateNode,l=e.memoizedProps;i.props=l;var c=i.context,d=r.contextType;typeof d=="object"&&d!==null?d=vs(d):(d=Xr(r)?wa:kr.current,d=mo(e,d));var u=r.getDerivedStateFromProps,h=typeof u=="function"||typeof i.getSnapshotBeforeUpdate=="function";h||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(l!==s||c!==d)&&kp(e,i,s,d),xn=!1;var f=e.memoizedState;i.state=f,Oc(e,s,i,n),c=e.memoizedState,l!==s||f!==c||Zr.current||xn?(typeof u=="function"&&(yh(e,r,u,s),c=e.memoizedState),(l=xn||Ip(e,r,l,s,f,c,d))?(h||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(e.flags|=4194308)):(typeof i.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=s,e.memoizedState=c),i.props=s,i.state=c,i.context=d,s=l):(typeof i.componentDidMount=="function"&&(e.flags|=4194308),s=!1)}else{i=e.stateNode,k1(t,e),l=e.memoizedProps,d=e.type===e.elementType?l:Is(e.type,l),i.props=d,h=e.pendingProps,f=i.context,c=r.contextType,typeof c=="object"&&c!==null?c=vs(c):(c=Xr(r)?wa:kr.current,c=mo(e,c));var p=r.getDerivedStateFromProps;(u=typeof p=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(l!==h||f!==c)&&kp(e,i,s,c),xn=!1,f=e.memoizedState,i.state=f,Oc(e,s,i,n);var _=e.memoizedState;l!==h||f!==_||Zr.current||xn?(typeof p=="function"&&(yh(e,r,p,s),_=e.memoizedState),(d=xn||Ip(e,r,d,s,f,_,c)||!1)?(u||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(s,_,c),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(s,_,c)),typeof i.componentDidUpdate=="function"&&(e.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof i.componentDidUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=s,e.memoizedState=_),i.props=s,i.state=_,i.context=c,s=d):(typeof i.componentDidUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),s=!1)}return wh(t,e,r,s,a,n)}function wh(t,e,r,s,n,a){ev(t,e);var i=(e.flags&128)!==0;if(!s&&!i)return n&&vp(e,r,!1),dn(t,e,a);s=e.stateNode,Xw.current=e;var l=i&&typeof r.getDerivedStateFromError!="function"?null:s.render();return e.flags|=1,t!==null&&i?(e.child=go(e,t.child,null,a),e.child=go(e,null,l,a)):Mr(t,e,l,a),e.memoizedState=s.state,n&&vp(e,r,!0),e.child}function tv(t){var e=t.stateNode;e.pendingContext?yp(t,e.pendingContext,e.pendingContext!==e.context):e.context&&yp(t,e.context,!1),Df(t,e.containerInfo)}function Rp(t,e,r,s,n){return po(),If(n),e.flags|=256,Mr(t,e,r,s),e.child}var Sh={dehydrated:null,treeContext:null,retryLane:0};function jh(t){return{baseLanes:t,cachePool:null,transitions:null}}function rv(t,e,r){var s=e.pendingProps,n=Dt.current,a=!1,i=(e.flags&128)!==0,l;if((l=i)||(l=t!==null&&t.memoizedState===null?!1:(n&2)!==0),l?(a=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(n|=1),yt(Dt,n&1),t===null)return gh(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(i=s.children,t=s.fallback,a?(s=e.mode,a=e.child,i={mode:"hidden",children:i},!(s&1)&&a!==null?(a.childLanes=0,a.pendingProps=i):a=Cd(i,s,0,null),t=va(t,s,r,null),a.return=e,t.return=e,a.sibling=t,e.child=a,e.child.memoizedState=jh(r),e.memoizedState=Sh,t):Vf(e,i));if(n=t.memoizedState,n!==null&&(l=n.dehydrated,l!==null))return e2(t,e,i,s,l,n,r);if(a){a=s.fallback,i=e.mode,n=t.child,l=n.sibling;var c={mode:"hidden",children:s.children};return!(i&1)&&e.child!==n?(s=e.child,s.childLanes=0,s.pendingProps=c,e.deletions=null):(s=Fn(n,c),s.subtreeFlags=n.subtreeFlags&14680064),l!==null?a=Fn(l,a):(a=va(a,i,r,null),a.flags|=2),a.return=e,s.return=e,s.sibling=a,e.child=s,s=a,a=e.child,i=t.child.memoizedState,i=i===null?jh(r):{baseLanes:i.baseLanes|r,cachePool:null,transitions:i.transitions},a.memoizedState=i,a.childLanes=t.childLanes&~r,e.memoizedState=Sh,s}return a=t.child,t=a.sibling,s=Fn(a,{mode:"visible",children:s.children}),!(e.mode&1)&&(s.lanes=r),s.return=e,s.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=s,e.memoizedState=null,s}function Vf(t,e){return e=Cd({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Cl(t,e,r,s){return s!==null&&If(s),go(e,t.child,null,r),t=Vf(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function e2(t,e,r,s,n,a,i){if(r)return e.flags&256?(e.flags&=-257,s=lu(Error(G(422))),Cl(t,e,i,s)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(a=s.fallback,n=e.mode,s=Cd({mode:"visible",children:s.children},n,0,null),a=va(a,n,i,null),a.flags|=2,s.return=e,a.return=e,s.sibling=a,e.child=s,e.mode&1&&go(e,t.child,null,i),e.child.memoizedState=jh(i),e.memoizedState=Sh,a);if(!(e.mode&1))return Cl(t,e,i,null);if(n.data==="$!"){if(s=n.nextSibling&&n.nextSibling.dataset,s)var l=s.dgst;return s=l,a=Error(G(419)),s=lu(a,s,void 0),Cl(t,e,i,s)}if(l=(i&t.childLanes)!==0,Yr||l){if(s=fr,s!==null){switch(i&-i){case 4:n=2;break;case 16:n=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:n=32;break;case 536870912:n=268435456;break;default:n=0}n=n&(s.suspendedLanes|i)?0:n,n!==0&&n!==a.retryLane&&(a.retryLane=n,cn(t,n),Ds(s,t,n,-1))}return Gf(),s=lu(Error(G(421))),Cl(t,e,i,s)}return n.data==="$?"?(e.flags|=128,e.child=t.child,e=f2.bind(null,t),n._reactRetry=e,null):(t=a.treeContext,as=Rn(n.nextSibling),os=e,kt=!0,Ls=null,t!==null&&(ms[ps++]=sn,ms[ps++]=nn,ms[ps++]=Sa,sn=t.id,nn=t.overflow,Sa=e),e=Vf(e,s.children),e.flags|=4096,e)}function Pp(t,e,r){t.lanes|=e;var s=t.alternate;s!==null&&(s.lanes|=e),_h(t.return,e,r)}function cu(t,e,r,s,n){var a=t.memoizedState;a===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:s,tail:r,tailMode:n}:(a.isBackwards=e,a.rendering=null,a.renderingStartTime=0,a.last=s,a.tail=r,a.tailMode=n)}function sv(t,e,r){var s=e.pendingProps,n=s.revealOrder,a=s.tail;if(Mr(t,e,s.children,r),s=Dt.current,s&2)s=s&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Pp(t,r,e);else if(t.tag===19)Pp(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}s&=1}if(yt(Dt,s),!(e.mode&1))e.memoizedState=null;else switch(n){case"forwards":for(r=e.child,n=null;r!==null;)t=r.alternate,t!==null&&$c(t)===null&&(n=r),r=r.sibling;r=n,r===null?(n=e.child,e.child=null):(n=r.sibling,r.sibling=null),cu(e,!1,n,r,a);break;case"backwards":for(r=null,n=e.child,e.child=null;n!==null;){if(t=n.alternate,t!==null&&$c(t)===null){e.child=n;break}t=n.sibling,n.sibling=r,r=n,n=t}cu(e,!0,r,null,a);break;case"together":cu(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function mc(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function dn(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),Ca|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(G(153));if(e.child!==null){for(t=e.child,r=Fn(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=Fn(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function t2(t,e,r){switch(e.tag){case 3:tv(e),po();break;case 5:E1(e);break;case 1:Xr(e.type)&&Ac(e);break;case 4:Df(e,e.stateNode.containerInfo);break;case 10:var s=e.type._context,n=e.memoizedProps.value;yt(Rc,s._currentValue),s._currentValue=n;break;case 13:if(s=e.memoizedState,s!==null)return s.dehydrated!==null?(yt(Dt,Dt.current&1),e.flags|=128,null):r&e.child.childLanes?rv(t,e,r):(yt(Dt,Dt.current&1),t=dn(t,e,r),t!==null?t.sibling:null);yt(Dt,Dt.current&1);break;case 19:if(s=(r&e.childLanes)!==0,t.flags&128){if(s)return sv(t,e,r);e.flags|=128}if(n=e.memoizedState,n!==null&&(n.rendering=null,n.tail=null,n.lastEffect=null),yt(Dt,Dt.current),s)break;return null;case 22:case 23:return e.lanes=0,X1(t,e,r)}return dn(t,e,r)}var nv,Ch,av,ov;nv=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Ch=function(){};av=function(t,e,r,s){var n=t.memoizedProps;if(n!==s){t=e.stateNode,pa(Gs.current);var a=null;switch(r){case"input":n=Gu(t,n),s=Gu(t,s),a=[];break;case"select":n=Rt({},n,{value:void 0}),s=Rt({},s,{value:void 0}),a=[];break;case"textarea":n=Yu(t,n),s=Yu(t,s),a=[];break;default:typeof n.onClick!="function"&&typeof s.onClick=="function"&&(t.onclick=Tc)}Zu(r,s);var i;r=null;for(d in n)if(!s.hasOwnProperty(d)&&n.hasOwnProperty(d)&&n[d]!=null)if(d==="style"){var l=n[d];for(i in l)l.hasOwnProperty(i)&&(r||(r={}),r[i]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(Ii.hasOwnProperty(d)?a||(a=[]):(a=a||[]).push(d,null));for(d in s){var c=s[d];if(l=n!=null?n[d]:void 0,s.hasOwnProperty(d)&&c!==l&&(c!=null||l!=null))if(d==="style")if(l){for(i in l)!l.hasOwnProperty(i)||c&&c.hasOwnProperty(i)||(r||(r={}),r[i]="");for(i in c)c.hasOwnProperty(i)&&l[i]!==c[i]&&(r||(r={}),r[i]=c[i])}else r||(a||(a=[]),a.push(d,r)),r=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(a=a||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(a=a||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(Ii.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&bt("scroll",t),a||l===c||(a=[])):(a=a||[]).push(d,c))}r&&(a=a||[]).push("style",r);var d=a;(e.updateQueue=d)&&(e.flags|=4)}};ov=function(t,e,r,s){r!==s&&(e.flags|=4)};function Ho(t,e){if(!kt)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var s=null;r!==null;)r.alternate!==null&&(s=r),r=r.sibling;s===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:s.sibling=null}}function br(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,s=0;if(e)for(var n=t.child;n!==null;)r|=n.lanes|n.childLanes,s|=n.subtreeFlags&14680064,s|=n.flags&14680064,n.return=t,n=n.sibling;else for(n=t.child;n!==null;)r|=n.lanes|n.childLanes,s|=n.subtreeFlags,s|=n.flags,n.return=t,n=n.sibling;return t.subtreeFlags|=s,t.childLanes=r,e}function r2(t,e,r){var s=e.pendingProps;switch(Nf(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return br(e),null;case 1:return Xr(e.type)&&Lc(),br(e),null;case 3:return s=e.stateNode,_o(),jt(Zr),jt(kr),Rf(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(t===null||t.child===null)&&(Sl(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Ls!==null&&(Dh(Ls),Ls=null))),Ch(t,e),br(e),null;case 5:Mf(e);var n=pa(Fi.current);if(r=e.type,t!==null&&e.stateNode!=null)av(t,e,r,s,n),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!s){if(e.stateNode===null)throw Error(G(166));return br(e),null}if(t=pa(Gs.current),Sl(e)){s=e.stateNode,r=e.type;var a=e.memoizedProps;switch(s[Us]=e,s[Oi]=a,t=(e.mode&1)!==0,r){case"dialog":bt("cancel",s),bt("close",s);break;case"iframe":case"object":case"embed":bt("load",s);break;case"video":case"audio":for(n=0;n<Xo.length;n++)bt(Xo[n],s);break;case"source":bt("error",s);break;case"img":case"image":case"link":bt("error",s),bt("load",s);break;case"details":bt("toggle",s);break;case"input":Um(s,a),bt("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!a.multiple},bt("invalid",s);break;case"textarea":Gm(s,a),bt("invalid",s)}Zu(r,a),n=null;for(var i in a)if(a.hasOwnProperty(i)){var l=a[i];i==="children"?typeof l=="string"?s.textContent!==l&&(a.suppressHydrationWarning!==!0&&wl(s.textContent,l,t),n=["children",l]):typeof l=="number"&&s.textContent!==""+l&&(a.suppressHydrationWarning!==!0&&wl(s.textContent,l,t),n=["children",""+l]):Ii.hasOwnProperty(i)&&l!=null&&i==="onScroll"&&bt("scroll",s)}switch(r){case"input":ml(s),Wm(s,a,!0);break;case"textarea":ml(s),Jm(s);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(s.onclick=Tc)}s=n,e.updateQueue=s,s!==null&&(e.flags|=4)}else{i=n.nodeType===9?n:n.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=My(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=i.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof s.is=="string"?t=i.createElement(r,{is:s.is}):(t=i.createElement(r),r==="select"&&(i=t,s.multiple?i.multiple=!0:s.size&&(i.size=s.size))):t=i.createElementNS(t,r),t[Us]=e,t[Oi]=s,nv(t,e,!1,!1),e.stateNode=t;e:{switch(i=Xu(r,s),r){case"dialog":bt("cancel",t),bt("close",t),n=s;break;case"iframe":case"object":case"embed":bt("load",t),n=s;break;case"video":case"audio":for(n=0;n<Xo.length;n++)bt(Xo[n],t);n=s;break;case"source":bt("error",t),n=s;break;case"img":case"image":case"link":bt("error",t),bt("load",t),n=s;break;case"details":bt("toggle",t),n=s;break;case"input":Um(t,s),n=Gu(t,s),bt("invalid",t);break;case"option":n=s;break;case"select":t._wrapperState={wasMultiple:!!s.multiple},n=Rt({},s,{value:void 0}),bt("invalid",t);break;case"textarea":Gm(t,s),n=Yu(t,s),bt("invalid",t);break;default:n=s}Zu(r,n),l=n;for(a in l)if(l.hasOwnProperty(a)){var c=l[a];a==="style"?Oy(t,c):a==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&Ry(t,c)):a==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&ki(t,c):typeof c=="number"&&ki(t,""+c):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(Ii.hasOwnProperty(a)?c!=null&&a==="onScroll"&&bt("scroll",t):c!=null&&uf(t,a,c,i))}switch(r){case"input":ml(t),Wm(t,s,!1);break;case"textarea":ml(t),Jm(t);break;case"option":s.value!=null&&t.setAttribute("value",""+Vn(s.value));break;case"select":t.multiple=!!s.multiple,a=s.value,a!=null?so(t,!!s.multiple,a,!1):s.defaultValue!=null&&so(t,!!s.multiple,s.defaultValue,!0);break;default:typeof n.onClick=="function"&&(t.onclick=Tc)}switch(r){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return br(e),null;case 6:if(t&&e.stateNode!=null)ov(t,e,t.memoizedProps,s);else{if(typeof s!="string"&&e.stateNode===null)throw Error(G(166));if(r=pa(Fi.current),pa(Gs.current),Sl(e)){if(s=e.stateNode,r=e.memoizedProps,s[Us]=e,(a=s.nodeValue!==r)&&(t=os,t!==null))switch(t.tag){case 3:wl(s.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&wl(s.nodeValue,r,(t.mode&1)!==0)}a&&(e.flags|=4)}else s=(r.nodeType===9?r:r.ownerDocument).createTextNode(s),s[Us]=e,e.stateNode=s}return br(e),null;case 13:if(jt(Dt),s=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(kt&&as!==null&&e.mode&1&&!(e.flags&128))j1(),po(),e.flags|=98560,a=!1;else if(a=Sl(e),s!==null&&s.dehydrated!==null){if(t===null){if(!a)throw Error(G(318));if(a=e.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(G(317));a[Us]=e}else po(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;br(e),a=!1}else Ls!==null&&(Dh(Ls),Ls=null),a=!0;if(!a)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(s=s!==null,s!==(t!==null&&t.memoizedState!==null)&&s&&(e.child.flags|=8192,e.mode&1&&(t===null||Dt.current&1?ir===0&&(ir=3):Gf())),e.updateQueue!==null&&(e.flags|=4),br(e),null);case 4:return _o(),Ch(t,e),t===null&&Ri(e.stateNode.containerInfo),br(e),null;case 10:return Tf(e.type._context),br(e),null;case 17:return Xr(e.type)&&Lc(),br(e),null;case 19:if(jt(Dt),a=e.memoizedState,a===null)return br(e),null;if(s=(e.flags&128)!==0,i=a.rendering,i===null)if(s)Ho(a,!1);else{if(ir!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(i=$c(t),i!==null){for(e.flags|=128,Ho(a,!1),s=i.updateQueue,s!==null&&(e.updateQueue=s,e.flags|=4),e.subtreeFlags=0,s=r,r=e.child;r!==null;)a=r,t=s,a.flags&=14680066,i=a.alternate,i===null?(a.childLanes=0,a.lanes=t,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=i.childLanes,a.lanes=i.lanes,a.child=i.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=i.memoizedProps,a.memoizedState=i.memoizedState,a.updateQueue=i.updateQueue,a.type=i.type,t=i.dependencies,a.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return yt(Dt,Dt.current&1|2),e.child}t=t.sibling}a.tail!==null&&Ht()>vo&&(e.flags|=128,s=!0,Ho(a,!1),e.lanes=4194304)}else{if(!s)if(t=$c(i),t!==null){if(e.flags|=128,s=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),Ho(a,!0),a.tail===null&&a.tailMode==="hidden"&&!i.alternate&&!kt)return br(e),null}else 2*Ht()-a.renderingStartTime>vo&&r!==1073741824&&(e.flags|=128,s=!0,Ho(a,!1),e.lanes=4194304);a.isBackwards?(i.sibling=e.child,e.child=i):(r=a.last,r!==null?r.sibling=i:e.child=i,a.last=i)}return a.tail!==null?(e=a.tail,a.rendering=e,a.tail=e.sibling,a.renderingStartTime=Ht(),e.sibling=null,r=Dt.current,yt(Dt,s?r&1|2:r&1),e):(br(e),null);case 22:case 23:return Wf(),s=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==s&&(e.flags|=8192),s&&e.mode&1?rs&1073741824&&(br(e),e.subtreeFlags&6&&(e.flags|=8192)):br(e),null;case 24:return null;case 25:return null}throw Error(G(156,e.tag))}function s2(t,e){switch(Nf(e),e.tag){case 1:return Xr(e.type)&&Lc(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return _o(),jt(Zr),jt(kr),Rf(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Mf(e),null;case 13:if(jt(Dt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(G(340));po()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return jt(Dt),null;case 4:return _o(),null;case 10:return Tf(e.type._context),null;case 22:case 23:return Wf(),null;case 24:return null;default:return null}}var Nl=!1,Nr=!1,n2=typeof WeakSet=="function"?WeakSet:Set,oe=null;function to(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(s){Bt(t,e,s)}else r.current=null}function Nh(t,e,r){try{r()}catch(s){Bt(t,e,s)}}var Op=!1;function a2(t,e){if(ch=Ic,t=u1(),jf(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var s=r.getSelection&&r.getSelection();if(s&&s.rangeCount!==0){r=s.anchorNode;var n=s.anchorOffset,a=s.focusNode;s=s.focusOffset;try{r.nodeType,a.nodeType}catch{r=null;break e}var i=0,l=-1,c=-1,d=0,u=0,h=t,f=null;t:for(;;){for(var p;h!==r||n!==0&&h.nodeType!==3||(l=i+n),h!==a||s!==0&&h.nodeType!==3||(c=i+s),h.nodeType===3&&(i+=h.nodeValue.length),(p=h.firstChild)!==null;)f=h,h=p;for(;;){if(h===t)break t;if(f===r&&++d===n&&(l=i),f===a&&++u===s&&(c=i),(p=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=p}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(dh={focusedElem:t,selectionRange:r},Ic=!1,oe=e;oe!==null;)if(e=oe,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,oe=t;else for(;oe!==null;){e=oe;try{var _=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(_!==null){var v=_.memoizedProps,x=_.memoizedState,m=e.stateNode,g=m.getSnapshotBeforeUpdate(e.elementType===e.type?v:Is(e.type,v),x);m.__reactInternalSnapshotBeforeUpdate=g}break;case 3:var y=e.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(G(163))}}catch(w){Bt(e,e.return,w)}if(t=e.sibling,t!==null){t.return=e.return,oe=t;break}oe=e.return}return _=Op,Op=!1,_}function mi(t,e,r){var s=e.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var n=s=s.next;do{if((n.tag&t)===t){var a=n.destroy;n.destroy=void 0,a!==void 0&&Nh(e,r,a)}n=n.next}while(n!==s)}}function Sd(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var s=r.create;r.destroy=s()}r=r.next}while(r!==e)}}function Ih(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function iv(t){var e=t.alternate;e!==null&&(t.alternate=null,iv(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Us],delete e[Oi],delete e[fh],delete e[Vw],delete e[Hw])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function lv(t){return t.tag===5||t.tag===3||t.tag===4}function $p(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||lv(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function kh(t,e,r){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=Tc));else if(s!==4&&(t=t.child,t!==null))for(kh(t,e,r),t=t.sibling;t!==null;)kh(t,e,r),t=t.sibling}function Eh(t,e,r){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(s!==4&&(t=t.child,t!==null))for(Eh(t,e,r),t=t.sibling;t!==null;)Eh(t,e,r),t=t.sibling}var gr=null,Es=!1;function fn(t,e,r){for(r=r.child;r!==null;)cv(t,e,r),r=r.sibling}function cv(t,e,r){if(Ws&&typeof Ws.onCommitFiberUnmount=="function")try{Ws.onCommitFiberUnmount(pd,r)}catch{}switch(r.tag){case 5:Nr||to(r,e);case 6:var s=gr,n=Es;gr=null,fn(t,e,r),gr=s,Es=n,gr!==null&&(Es?(t=gr,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):gr.removeChild(r.stateNode));break;case 18:gr!==null&&(Es?(t=gr,r=r.stateNode,t.nodeType===8?ru(t.parentNode,r):t.nodeType===1&&ru(t,r),Ai(t)):ru(gr,r.stateNode));break;case 4:s=gr,n=Es,gr=r.stateNode.containerInfo,Es=!0,fn(t,e,r),gr=s,Es=n;break;case 0:case 11:case 14:case 15:if(!Nr&&(s=r.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){n=s=s.next;do{var a=n,i=a.destroy;a=a.tag,i!==void 0&&(a&2||a&4)&&Nh(r,e,i),n=n.next}while(n!==s)}fn(t,e,r);break;case 1:if(!Nr&&(to(r,e),s=r.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=r.memoizedProps,s.state=r.memoizedState,s.componentWillUnmount()}catch(l){Bt(r,e,l)}fn(t,e,r);break;case 21:fn(t,e,r);break;case 22:r.mode&1?(Nr=(s=Nr)||r.memoizedState!==null,fn(t,e,r),Nr=s):fn(t,e,r);break;default:fn(t,e,r)}}function Fp(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new n2),e.forEach(function(s){var n=m2.bind(null,t,s);r.has(s)||(r.add(s),s.then(n,n))})}}function ws(t,e){var r=e.deletions;if(r!==null)for(var s=0;s<r.length;s++){var n=r[s];try{var a=t,i=e,l=i;e:for(;l!==null;){switch(l.tag){case 5:gr=l.stateNode,Es=!1;break e;case 3:gr=l.stateNode.containerInfo,Es=!0;break e;case 4:gr=l.stateNode.containerInfo,Es=!0;break e}l=l.return}if(gr===null)throw Error(G(160));cv(a,i,n),gr=null,Es=!1;var c=n.alternate;c!==null&&(c.return=null),n.return=null}catch(d){Bt(n,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)dv(e,t),e=e.sibling}function dv(t,e){var r=t.alternate,s=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(ws(e,t),Os(t),s&4){try{mi(3,t,t.return),Sd(3,t)}catch(v){Bt(t,t.return,v)}try{mi(5,t,t.return)}catch(v){Bt(t,t.return,v)}}break;case 1:ws(e,t),Os(t),s&512&&r!==null&&to(r,r.return);break;case 5:if(ws(e,t),Os(t),s&512&&r!==null&&to(r,r.return),t.flags&32){var n=t.stateNode;try{ki(n,"")}catch(v){Bt(t,t.return,v)}}if(s&4&&(n=t.stateNode,n!=null)){var a=t.memoizedProps,i=r!==null?r.memoizedProps:a,l=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{l==="input"&&a.type==="radio"&&a.name!=null&&Ay(n,a),Xu(l,i);var d=Xu(l,a);for(i=0;i<c.length;i+=2){var u=c[i],h=c[i+1];u==="style"?Oy(n,h):u==="dangerouslySetInnerHTML"?Ry(n,h):u==="children"?ki(n,h):uf(n,u,h,d)}switch(l){case"input":Ju(n,a);break;case"textarea":Dy(n,a);break;case"select":var f=n._wrapperState.wasMultiple;n._wrapperState.wasMultiple=!!a.multiple;var p=a.value;p!=null?so(n,!!a.multiple,p,!1):f!==!!a.multiple&&(a.defaultValue!=null?so(n,!!a.multiple,a.defaultValue,!0):so(n,!!a.multiple,a.multiple?[]:"",!1))}n[Oi]=a}catch(v){Bt(t,t.return,v)}}break;case 6:if(ws(e,t),Os(t),s&4){if(t.stateNode===null)throw Error(G(162));n=t.stateNode,a=t.memoizedProps;try{n.nodeValue=a}catch(v){Bt(t,t.return,v)}}break;case 3:if(ws(e,t),Os(t),s&4&&r!==null&&r.memoizedState.isDehydrated)try{Ai(e.containerInfo)}catch(v){Bt(t,t.return,v)}break;case 4:ws(e,t),Os(t);break;case 13:ws(e,t),Os(t),n=t.child,n.flags&8192&&(a=n.memoizedState!==null,n.stateNode.isHidden=a,!a||n.alternate!==null&&n.alternate.memoizedState!==null||(qf=Ht())),s&4&&Fp(t);break;case 22:if(u=r!==null&&r.memoizedState!==null,t.mode&1?(Nr=(d=Nr)||u,ws(e,t),Nr=d):ws(e,t),Os(t),s&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!u&&t.mode&1)for(oe=t,u=t.child;u!==null;){for(h=oe=u;oe!==null;){switch(f=oe,p=f.child,f.tag){case 0:case 11:case 14:case 15:mi(4,f,f.return);break;case 1:to(f,f.return);var _=f.stateNode;if(typeof _.componentWillUnmount=="function"){s=f,r=f.return;try{e=s,_.props=e.memoizedProps,_.state=e.memoizedState,_.componentWillUnmount()}catch(v){Bt(s,r,v)}}break;case 5:to(f,f.return);break;case 22:if(f.memoizedState!==null){Vp(h);continue}}p!==null?(p.return=f,oe=p):Vp(h)}u=u.sibling}e:for(u=null,h=t;;){if(h.tag===5){if(u===null){u=h;try{n=h.stateNode,d?(a=n.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(l=h.stateNode,c=h.memoizedProps.style,i=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=Py("display",i))}catch(v){Bt(t,t.return,v)}}}else if(h.tag===6){if(u===null)try{h.stateNode.nodeValue=d?"":h.memoizedProps}catch(v){Bt(t,t.return,v)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:ws(e,t),Os(t),s&4&&Fp(t);break;case 21:break;default:ws(e,t),Os(t)}}function Os(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(lv(r)){var s=r;break e}r=r.return}throw Error(G(160))}switch(s.tag){case 5:var n=s.stateNode;s.flags&32&&(ki(n,""),s.flags&=-33);var a=$p(t);Eh(t,a,n);break;case 3:case 4:var i=s.stateNode.containerInfo,l=$p(t);kh(t,l,i);break;default:throw Error(G(161))}}catch(c){Bt(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function o2(t,e,r){oe=t,uv(t)}function uv(t,e,r){for(var s=(t.mode&1)!==0;oe!==null;){var n=oe,a=n.child;if(n.tag===22&&s){var i=n.memoizedState!==null||Nl;if(!i){var l=n.alternate,c=l!==null&&l.memoizedState!==null||Nr;l=Nl;var d=Nr;if(Nl=i,(Nr=c)&&!d)for(oe=n;oe!==null;)i=oe,c=i.child,i.tag===22&&i.memoizedState!==null?Hp(n):c!==null?(c.return=i,oe=c):Hp(n);for(;a!==null;)oe=a,uv(a),a=a.sibling;oe=n,Nl=l,Nr=d}Bp(t)}else n.subtreeFlags&8772&&a!==null?(a.return=n,oe=a):Bp(t)}}function Bp(t){for(;oe!==null;){var e=oe;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Nr||Sd(5,e);break;case 1:var s=e.stateNode;if(e.flags&4&&!Nr)if(r===null)s.componentDidMount();else{var n=e.elementType===e.type?r.memoizedProps:Is(e.type,r.memoizedProps);s.componentDidUpdate(n,r.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var a=e.updateQueue;a!==null&&jp(e,a,s);break;case 3:var i=e.updateQueue;if(i!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}jp(e,i,r)}break;case 5:var l=e.stateNode;if(r===null&&e.flags&4){r=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var u=d.memoizedState;if(u!==null){var h=u.dehydrated;h!==null&&Ai(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(G(163))}Nr||e.flags&512&&Ih(e)}catch(f){Bt(e,e.return,f)}}if(e===t){oe=null;break}if(r=e.sibling,r!==null){r.return=e.return,oe=r;break}oe=e.return}}function Vp(t){for(;oe!==null;){var e=oe;if(e===t){oe=null;break}var r=e.sibling;if(r!==null){r.return=e.return,oe=r;break}oe=e.return}}function Hp(t){for(;oe!==null;){var e=oe;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{Sd(4,e)}catch(c){Bt(e,r,c)}break;case 1:var s=e.stateNode;if(typeof s.componentDidMount=="function"){var n=e.return;try{s.componentDidMount()}catch(c){Bt(e,n,c)}}var a=e.return;try{Ih(e)}catch(c){Bt(e,a,c)}break;case 5:var i=e.return;try{Ih(e)}catch(c){Bt(e,i,c)}}}catch(c){Bt(e,e.return,c)}if(e===t){oe=null;break}var l=e.sibling;if(l!==null){l.return=e.return,oe=l;break}oe=e.return}}var i2=Math.ceil,Vc=hn.ReactCurrentDispatcher,Hf=hn.ReactCurrentOwner,ys=hn.ReactCurrentBatchConfig,Xe=0,fr=null,Qt=null,yr=0,rs=0,ro=Un(0),ir=0,zi=null,Ca=0,jd=0,zf=0,pi=null,Gr=null,qf=0,vo=1/0,Xs=null,Hc=!1,Th=null,On=null,Il=!1,Nn=null,zc=0,gi=0,Lh=null,pc=-1,gc=0;function Or(){return Xe&6?Ht():pc!==-1?pc:pc=Ht()}function $n(t){return t.mode&1?Xe&2&&yr!==0?yr&-yr:qw.transition!==null?(gc===0&&(gc=Ky()),gc):(t=ut,t!==0||(t=window.event,t=t===void 0?16:r1(t.type)),t):1}function Ds(t,e,r,s){if(50<gi)throw gi=0,Lh=null,Error(G(185));rl(t,r,s),(!(Xe&2)||t!==fr)&&(t===fr&&(!(Xe&2)&&(jd|=r),ir===4&&wn(t,yr)),es(t,s),r===1&&Xe===0&&!(e.mode&1)&&(vo=Ht()+500,xd&&Wn()))}function es(t,e){var r=t.callbackNode;qb(t,e);var s=Nc(t,t===fr?yr:0);if(s===0)r!==null&&Qm(r),t.callbackNode=null,t.callbackPriority=0;else if(e=s&-s,t.callbackPriority!==e){if(r!=null&&Qm(r),e===1)t.tag===0?zw(zp.bind(null,t)):b1(zp.bind(null,t)),Fw(function(){!(Xe&6)&&Wn()}),r=null;else{switch(Yy(s)){case 1:r=gf;break;case 4:r=Gy;break;case 16:r=Cc;break;case 536870912:r=Jy;break;default:r=Cc}r=vv(r,hv.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function hv(t,e){if(pc=-1,gc=0,Xe&6)throw Error(G(327));var r=t.callbackNode;if(lo()&&t.callbackNode!==r)return null;var s=Nc(t,t===fr?yr:0);if(s===0)return null;if(s&30||s&t.expiredLanes||e)e=qc(t,s);else{e=s;var n=Xe;Xe|=2;var a=mv();(fr!==t||yr!==e)&&(Xs=null,vo=Ht()+500,ya(t,e));do try{d2();break}catch(l){fv(t,l)}while(!0);Ef(),Vc.current=a,Xe=n,Qt!==null?e=0:(fr=null,yr=0,e=ir)}if(e!==0){if(e===2&&(n=nh(t),n!==0&&(s=n,e=Ah(t,n))),e===1)throw r=zi,ya(t,0),wn(t,s),es(t,Ht()),r;if(e===6)wn(t,s);else{if(n=t.current.alternate,!(s&30)&&!l2(n)&&(e=qc(t,s),e===2&&(a=nh(t),a!==0&&(s=a,e=Ah(t,a))),e===1))throw r=zi,ya(t,0),wn(t,s),es(t,Ht()),r;switch(t.finishedWork=n,t.finishedLanes=s,e){case 0:case 1:throw Error(G(345));case 2:oa(t,Gr,Xs);break;case 3:if(wn(t,s),(s&130023424)===s&&(e=qf+500-Ht(),10<e)){if(Nc(t,0)!==0)break;if(n=t.suspendedLanes,(n&s)!==s){Or(),t.pingedLanes|=t.suspendedLanes&n;break}t.timeoutHandle=hh(oa.bind(null,t,Gr,Xs),e);break}oa(t,Gr,Xs);break;case 4:if(wn(t,s),(s&4194240)===s)break;for(e=t.eventTimes,n=-1;0<s;){var i=31-As(s);a=1<<i,i=e[i],i>n&&(n=i),s&=~a}if(s=n,s=Ht()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*i2(s/1960))-s,10<s){t.timeoutHandle=hh(oa.bind(null,t,Gr,Xs),s);break}oa(t,Gr,Xs);break;case 5:oa(t,Gr,Xs);break;default:throw Error(G(329))}}}return es(t,Ht()),t.callbackNode===r?hv.bind(null,t):null}function Ah(t,e){var r=pi;return t.current.memoizedState.isDehydrated&&(ya(t,e).flags|=256),t=qc(t,e),t!==2&&(e=Gr,Gr=r,e!==null&&Dh(e)),t}function Dh(t){Gr===null?Gr=t:Gr.push.apply(Gr,t)}function l2(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var s=0;s<r.length;s++){var n=r[s],a=n.getSnapshot;n=n.value;try{if(!Ms(a(),n))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function wn(t,e){for(e&=~zf,e&=~jd,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-As(e),s=1<<r;t[r]=-1,e&=~s}}function zp(t){if(Xe&6)throw Error(G(327));lo();var e=Nc(t,0);if(!(e&1))return es(t,Ht()),null;var r=qc(t,e);if(t.tag!==0&&r===2){var s=nh(t);s!==0&&(e=s,r=Ah(t,s))}if(r===1)throw r=zi,ya(t,0),wn(t,e),es(t,Ht()),r;if(r===6)throw Error(G(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,oa(t,Gr,Xs),es(t,Ht()),null}function Uf(t,e){var r=Xe;Xe|=1;try{return t(e)}finally{Xe=r,Xe===0&&(vo=Ht()+500,xd&&Wn())}}function Na(t){Nn!==null&&Nn.tag===0&&!(Xe&6)&&lo();var e=Xe;Xe|=1;var r=ys.transition,s=ut;try{if(ys.transition=null,ut=1,t)return t()}finally{ut=s,ys.transition=r,Xe=e,!(Xe&6)&&Wn()}}function Wf(){rs=ro.current,jt(ro)}function ya(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,$w(r)),Qt!==null)for(r=Qt.return;r!==null;){var s=r;switch(Nf(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&Lc();break;case 3:_o(),jt(Zr),jt(kr),Rf();break;case 5:Mf(s);break;case 4:_o();break;case 13:jt(Dt);break;case 19:jt(Dt);break;case 10:Tf(s.type._context);break;case 22:case 23:Wf()}r=r.return}if(fr=t,Qt=t=Fn(t.current,null),yr=rs=e,ir=0,zi=null,zf=jd=Ca=0,Gr=pi=null,ma!==null){for(e=0;e<ma.length;e++)if(r=ma[e],s=r.interleaved,s!==null){r.interleaved=null;var n=s.next,a=r.pending;if(a!==null){var i=a.next;a.next=n,s.next=i}r.pending=s}ma=null}return t}function fv(t,e){do{var r=Qt;try{if(Ef(),hc.current=Bc,Fc){for(var s=Mt.memoizedState;s!==null;){var n=s.queue;n!==null&&(n.pending=null),s=s.next}Fc=!1}if(ja=0,ur=or=Mt=null,fi=!1,Bi=0,Hf.current=null,r===null||r.return===null){ir=1,zi=e,Qt=null;break}e:{var a=t,i=r.return,l=r,c=e;if(e=yr,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,u=l,h=u.tag;if(!(u.mode&1)&&(h===0||h===11||h===15)){var f=u.alternate;f?(u.updateQueue=f.updateQueue,u.memoizedState=f.memoizedState,u.lanes=f.lanes):(u.updateQueue=null,u.memoizedState=null)}var p=Tp(i);if(p!==null){p.flags&=-257,Lp(p,i,l,a,e),p.mode&1&&Ep(a,d,e),e=p,c=d;var _=e.updateQueue;if(_===null){var v=new Set;v.add(c),e.updateQueue=v}else _.add(c);break e}else{if(!(e&1)){Ep(a,d,e),Gf();break e}c=Error(G(426))}}else if(kt&&l.mode&1){var x=Tp(i);if(x!==null){!(x.flags&65536)&&(x.flags|=256),Lp(x,i,l,a,e),If(yo(c,l));break e}}a=c=yo(c,l),ir!==4&&(ir=2),pi===null?pi=[a]:pi.push(a),a=i;do{switch(a.tag){case 3:a.flags|=65536,e&=-e,a.lanes|=e;var m=Y1(a,c,e);Sp(a,m);break e;case 1:l=c;var g=a.type,y=a.stateNode;if(!(a.flags&128)&&(typeof g.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(On===null||!On.has(y)))){a.flags|=65536,e&=-e,a.lanes|=e;var w=Q1(a,l,e);Sp(a,w);break e}}a=a.return}while(a!==null)}gv(r)}catch(b){e=b,Qt===r&&r!==null&&(Qt=r=r.return);continue}break}while(!0)}function mv(){var t=Vc.current;return Vc.current=Bc,t===null?Bc:t}function Gf(){(ir===0||ir===3||ir===2)&&(ir=4),fr===null||!(Ca&268435455)&&!(jd&268435455)||wn(fr,yr)}function qc(t,e){var r=Xe;Xe|=2;var s=mv();(fr!==t||yr!==e)&&(Xs=null,ya(t,e));do try{c2();break}catch(n){fv(t,n)}while(!0);if(Ef(),Xe=r,Vc.current=s,Qt!==null)throw Error(G(261));return fr=null,yr=0,ir}function c2(){for(;Qt!==null;)pv(Qt)}function d2(){for(;Qt!==null&&!Rb();)pv(Qt)}function pv(t){var e=yv(t.alternate,t,rs);t.memoizedProps=t.pendingProps,e===null?gv(t):Qt=e,Hf.current=null}function gv(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=s2(r,e),r!==null){r.flags&=32767,Qt=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{ir=6,Qt=null;return}}else if(r=r2(r,e,rs),r!==null){Qt=r;return}if(e=e.sibling,e!==null){Qt=e;return}Qt=e=t}while(e!==null);ir===0&&(ir=5)}function oa(t,e,r){var s=ut,n=ys.transition;try{ys.transition=null,ut=1,u2(t,e,r,s)}finally{ys.transition=n,ut=s}return null}function u2(t,e,r,s){do lo();while(Nn!==null);if(Xe&6)throw Error(G(327));r=t.finishedWork;var n=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(G(177));t.callbackNode=null,t.callbackPriority=0;var a=r.lanes|r.childLanes;if(Ub(t,a),t===fr&&(Qt=fr=null,yr=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Il||(Il=!0,vv(Cc,function(){return lo(),null})),a=(r.flags&15990)!==0,r.subtreeFlags&15990||a){a=ys.transition,ys.transition=null;var i=ut;ut=1;var l=Xe;Xe|=4,Hf.current=null,a2(t,r),dv(r,t),Lw(dh),Ic=!!ch,dh=ch=null,t.current=r,o2(r),Pb(),Xe=l,ut=i,ys.transition=a}else t.current=r;if(Il&&(Il=!1,Nn=t,zc=n),a=t.pendingLanes,a===0&&(On=null),Fb(r.stateNode),es(t,Ht()),e!==null)for(s=t.onRecoverableError,r=0;r<e.length;r++)n=e[r],s(n.value,{componentStack:n.stack,digest:n.digest});if(Hc)throw Hc=!1,t=Th,Th=null,t;return zc&1&&t.tag!==0&&lo(),a=t.pendingLanes,a&1?t===Lh?gi++:(gi=0,Lh=t):gi=0,Wn(),null}function lo(){if(Nn!==null){var t=Yy(zc),e=ys.transition,r=ut;try{if(ys.transition=null,ut=16>t?16:t,Nn===null)var s=!1;else{if(t=Nn,Nn=null,zc=0,Xe&6)throw Error(G(331));var n=Xe;for(Xe|=4,oe=t.current;oe!==null;){var a=oe,i=a.child;if(oe.flags&16){var l=a.deletions;if(l!==null){for(var c=0;c<l.length;c++){var d=l[c];for(oe=d;oe!==null;){var u=oe;switch(u.tag){case 0:case 11:case 15:mi(8,u,a)}var h=u.child;if(h!==null)h.return=u,oe=h;else for(;oe!==null;){u=oe;var f=u.sibling,p=u.return;if(iv(u),u===d){oe=null;break}if(f!==null){f.return=p,oe=f;break}oe=p}}}var _=a.alternate;if(_!==null){var v=_.child;if(v!==null){_.child=null;do{var x=v.sibling;v.sibling=null,v=x}while(v!==null)}}oe=a}}if(a.subtreeFlags&2064&&i!==null)i.return=a,oe=i;else e:for(;oe!==null;){if(a=oe,a.flags&2048)switch(a.tag){case 0:case 11:case 15:mi(9,a,a.return)}var m=a.sibling;if(m!==null){m.return=a.return,oe=m;break e}oe=a.return}}var g=t.current;for(oe=g;oe!==null;){i=oe;var y=i.child;if(i.subtreeFlags&2064&&y!==null)y.return=i,oe=y;else e:for(i=g;oe!==null;){if(l=oe,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Sd(9,l)}}catch(b){Bt(l,l.return,b)}if(l===i){oe=null;break e}var w=l.sibling;if(w!==null){w.return=l.return,oe=w;break e}oe=l.return}}if(Xe=n,Wn(),Ws&&typeof Ws.onPostCommitFiberRoot=="function")try{Ws.onPostCommitFiberRoot(pd,t)}catch{}s=!0}return s}finally{ut=r,ys.transition=e}}return!1}function qp(t,e,r){e=yo(r,e),e=Y1(t,e,1),t=Pn(t,e,1),e=Or(),t!==null&&(rl(t,1,e),es(t,e))}function Bt(t,e,r){if(t.tag===3)qp(t,t,r);else for(;e!==null;){if(e.tag===3){qp(e,t,r);break}else if(e.tag===1){var s=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(On===null||!On.has(s))){t=yo(r,t),t=Q1(e,t,1),e=Pn(e,t,1),t=Or(),e!==null&&(rl(e,1,t),es(e,t));break}}e=e.return}}function h2(t,e,r){var s=t.pingCache;s!==null&&s.delete(e),e=Or(),t.pingedLanes|=t.suspendedLanes&r,fr===t&&(yr&r)===r&&(ir===4||ir===3&&(yr&130023424)===yr&&500>Ht()-qf?ya(t,0):zf|=r),es(t,e)}function _v(t,e){e===0&&(t.mode&1?(e=_l,_l<<=1,!(_l&130023424)&&(_l=4194304)):e=1);var r=Or();t=cn(t,e),t!==null&&(rl(t,e,r),es(t,r))}function f2(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),_v(t,r)}function m2(t,e){var r=0;switch(t.tag){case 13:var s=t.stateNode,n=t.memoizedState;n!==null&&(r=n.retryLane);break;case 19:s=t.stateNode;break;default:throw Error(G(314))}s!==null&&s.delete(e),_v(t,r)}var yv;yv=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||Zr.current)Yr=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return Yr=!1,t2(t,e,r);Yr=!!(t.flags&131072)}else Yr=!1,kt&&e.flags&1048576&&w1(e,Mc,e.index);switch(e.lanes=0,e.tag){case 2:var s=e.type;mc(t,e),t=e.pendingProps;var n=mo(e,kr.current);io(e,r),n=Of(null,e,s,t,n,r);var a=$f();return e.flags|=1,typeof n=="object"&&n!==null&&typeof n.render=="function"&&n.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Xr(s)?(a=!0,Ac(e)):a=!1,e.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,Af(e),n.updater=wd,e.stateNode=n,n._reactInternals=e,vh(e,s,t,r),e=wh(null,e,s,!0,a,r)):(e.tag=0,kt&&a&&Cf(e),Mr(null,e,n,r),e=e.child),e;case 16:s=e.elementType;e:{switch(mc(t,e),t=e.pendingProps,n=s._init,s=n(s._payload),e.type=s,n=e.tag=g2(s),t=Is(s,t),n){case 0:e=bh(null,e,s,t,r);break e;case 1:e=Mp(null,e,s,t,r);break e;case 11:e=Ap(null,e,s,t,r);break e;case 14:e=Dp(null,e,s,Is(s.type,t),r);break e}throw Error(G(306,s,""))}return e;case 0:return s=e.type,n=e.pendingProps,n=e.elementType===s?n:Is(s,n),bh(t,e,s,n,r);case 1:return s=e.type,n=e.pendingProps,n=e.elementType===s?n:Is(s,n),Mp(t,e,s,n,r);case 3:e:{if(tv(e),t===null)throw Error(G(387));s=e.pendingProps,a=e.memoizedState,n=a.element,k1(t,e),Oc(e,s,null,r);var i=e.memoizedState;if(s=i.element,a.isDehydrated)if(a={element:s,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},e.updateQueue.baseState=a,e.memoizedState=a,e.flags&256){n=yo(Error(G(423)),e),e=Rp(t,e,s,r,n);break e}else if(s!==n){n=yo(Error(G(424)),e),e=Rp(t,e,s,r,n);break e}else for(as=Rn(e.stateNode.containerInfo.firstChild),os=e,kt=!0,Ls=null,r=N1(e,null,s,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(po(),s===n){e=dn(t,e,r);break e}Mr(t,e,s,r)}e=e.child}return e;case 5:return E1(e),t===null&&gh(e),s=e.type,n=e.pendingProps,a=t!==null?t.memoizedProps:null,i=n.children,uh(s,n)?i=null:a!==null&&uh(s,a)&&(e.flags|=32),ev(t,e),Mr(t,e,i,r),e.child;case 6:return t===null&&gh(e),null;case 13:return rv(t,e,r);case 4:return Df(e,e.stateNode.containerInfo),s=e.pendingProps,t===null?e.child=go(e,null,s,r):Mr(t,e,s,r),e.child;case 11:return s=e.type,n=e.pendingProps,n=e.elementType===s?n:Is(s,n),Ap(t,e,s,n,r);case 7:return Mr(t,e,e.pendingProps,r),e.child;case 8:return Mr(t,e,e.pendingProps.children,r),e.child;case 12:return Mr(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(s=e.type._context,n=e.pendingProps,a=e.memoizedProps,i=n.value,yt(Rc,s._currentValue),s._currentValue=i,a!==null)if(Ms(a.value,i)){if(a.children===n.children&&!Zr.current){e=dn(t,e,r);break e}}else for(a=e.child,a!==null&&(a.return=e);a!==null;){var l=a.dependencies;if(l!==null){i=a.child;for(var c=l.firstContext;c!==null;){if(c.context===s){if(a.tag===1){c=an(-1,r&-r),c.tag=2;var d=a.updateQueue;if(d!==null){d=d.shared;var u=d.pending;u===null?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}a.lanes|=r,c=a.alternate,c!==null&&(c.lanes|=r),_h(a.return,r,e),l.lanes|=r;break}c=c.next}}else if(a.tag===10)i=a.type===e.type?null:a.child;else if(a.tag===18){if(i=a.return,i===null)throw Error(G(341));i.lanes|=r,l=i.alternate,l!==null&&(l.lanes|=r),_h(i,r,e),i=a.sibling}else i=a.child;if(i!==null)i.return=a;else for(i=a;i!==null;){if(i===e){i=null;break}if(a=i.sibling,a!==null){a.return=i.return,i=a;break}i=i.return}a=i}Mr(t,e,n.children,r),e=e.child}return e;case 9:return n=e.type,s=e.pendingProps.children,io(e,r),n=vs(n),s=s(n),e.flags|=1,Mr(t,e,s,r),e.child;case 14:return s=e.type,n=Is(s,e.pendingProps),n=Is(s.type,n),Dp(t,e,s,n,r);case 15:return Z1(t,e,e.type,e.pendingProps,r);case 17:return s=e.type,n=e.pendingProps,n=e.elementType===s?n:Is(s,n),mc(t,e),e.tag=1,Xr(s)?(t=!0,Ac(e)):t=!1,io(e,r),K1(e,s,n),vh(e,s,n,r),wh(null,e,s,!0,t,r);case 19:return sv(t,e,r);case 22:return X1(t,e,r)}throw Error(G(156,e.tag))};function vv(t,e){return Wy(t,e)}function p2(t,e,r,s){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function gs(t,e,r,s){return new p2(t,e,r,s)}function Jf(t){return t=t.prototype,!(!t||!t.isReactComponent)}function g2(t){if(typeof t=="function")return Jf(t)?1:0;if(t!=null){if(t=t.$$typeof,t===ff)return 11;if(t===mf)return 14}return 2}function Fn(t,e){var r=t.alternate;return r===null?(r=gs(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function _c(t,e,r,s,n,a){var i=2;if(s=t,typeof t=="function")Jf(t)&&(i=1);else if(typeof t=="string")i=5;else e:switch(t){case Wa:return va(r.children,n,a,e);case hf:i=8,n|=8;break;case zu:return t=gs(12,r,e,n|2),t.elementType=zu,t.lanes=a,t;case qu:return t=gs(13,r,e,n),t.elementType=qu,t.lanes=a,t;case Uu:return t=gs(19,r,e,n),t.elementType=Uu,t.lanes=a,t;case Ey:return Cd(r,n,a,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Iy:i=10;break e;case ky:i=9;break e;case ff:i=11;break e;case mf:i=14;break e;case vn:i=16,s=null;break e}throw Error(G(130,t==null?t:typeof t,""))}return e=gs(i,r,e,n),e.elementType=t,e.type=s,e.lanes=a,e}function va(t,e,r,s){return t=gs(7,t,s,e),t.lanes=r,t}function Cd(t,e,r,s){return t=gs(22,t,s,e),t.elementType=Ey,t.lanes=r,t.stateNode={isHidden:!1},t}function du(t,e,r){return t=gs(6,t,null,e),t.lanes=r,t}function uu(t,e,r){return e=gs(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function _2(t,e,r,s,n){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ud(0),this.expirationTimes=Ud(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ud(0),this.identifierPrefix=s,this.onRecoverableError=n,this.mutableSourceEagerHydrationData=null}function Kf(t,e,r,s,n,a,i,l,c){return t=new _2(t,e,r,l,c),e===1?(e=1,a===!0&&(e|=8)):e=0,a=gs(3,null,null,e),t.current=a,a.stateNode=t,a.memoizedState={element:s,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Af(a),t}function y2(t,e,r){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ua,key:s==null?null:""+s,children:t,containerInfo:e,implementation:r}}function xv(t){if(!t)return Hn;t=t._reactInternals;e:{if(Ta(t)!==t||t.tag!==1)throw Error(G(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Xr(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(G(171))}if(t.tag===1){var r=t.type;if(Xr(r))return x1(t,r,e)}return e}function bv(t,e,r,s,n,a,i,l,c){return t=Kf(r,s,!0,t,n,a,i,l,c),t.context=xv(null),r=t.current,s=Or(),n=$n(r),a=an(s,n),a.callback=e??null,Pn(r,a,n),t.current.lanes=n,rl(t,n,s),es(t,s),t}function Nd(t,e,r,s){var n=e.current,a=Or(),i=$n(n);return r=xv(r),e.context===null?e.context=r:e.pendingContext=r,e=an(a,i),e.payload={element:t},s=s===void 0?null:s,s!==null&&(e.callback=s),t=Pn(n,e,i),t!==null&&(Ds(t,n,i,a),uc(t,n,i)),i}function Uc(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Up(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function Yf(t,e){Up(t,e),(t=t.alternate)&&Up(t,e)}function v2(){return null}var wv=typeof reportError=="function"?reportError:function(t){console.error(t)};function Qf(t){this._internalRoot=t}Id.prototype.render=Qf.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(G(409));Nd(t,e,null,null)};Id.prototype.unmount=Qf.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Na(function(){Nd(null,t,null,null)}),e[ln]=null}};function Id(t){this._internalRoot=t}Id.prototype.unstable_scheduleHydration=function(t){if(t){var e=Xy();t={blockedOn:null,target:t,priority:e};for(var r=0;r<bn.length&&e!==0&&e<bn[r].priority;r++);bn.splice(r,0,t),r===0&&t1(t)}};function Zf(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function kd(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Wp(){}function x2(t,e,r,s,n){if(n){if(typeof s=="function"){var a=s;s=function(){var d=Uc(i);a.call(d)}}var i=bv(e,s,t,0,null,!1,!1,"",Wp);return t._reactRootContainer=i,t[ln]=i.current,Ri(t.nodeType===8?t.parentNode:t),Na(),i}for(;n=t.lastChild;)t.removeChild(n);if(typeof s=="function"){var l=s;s=function(){var d=Uc(c);l.call(d)}}var c=Kf(t,0,!1,null,null,!1,!1,"",Wp);return t._reactRootContainer=c,t[ln]=c.current,Ri(t.nodeType===8?t.parentNode:t),Na(function(){Nd(e,c,r,s)}),c}function Ed(t,e,r,s,n){var a=r._reactRootContainer;if(a){var i=a;if(typeof n=="function"){var l=n;n=function(){var c=Uc(i);l.call(c)}}Nd(e,i,t,n)}else i=x2(r,e,t,n,s);return Uc(i)}Qy=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=Zo(e.pendingLanes);r!==0&&(_f(e,r|1),es(e,Ht()),!(Xe&6)&&(vo=Ht()+500,Wn()))}break;case 13:Na(function(){var s=cn(t,1);if(s!==null){var n=Or();Ds(s,t,1,n)}}),Yf(t,1)}};yf=function(t){if(t.tag===13){var e=cn(t,134217728);if(e!==null){var r=Or();Ds(e,t,134217728,r)}Yf(t,134217728)}};Zy=function(t){if(t.tag===13){var e=$n(t),r=cn(t,e);if(r!==null){var s=Or();Ds(r,t,e,s)}Yf(t,e)}};Xy=function(){return ut};e1=function(t,e){var r=ut;try{return ut=t,e()}finally{ut=r}};th=function(t,e,r){switch(e){case"input":if(Ju(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var s=r[e];if(s!==t&&s.form===t.form){var n=vd(s);if(!n)throw Error(G(90));Ly(s),Ju(s,n)}}}break;case"textarea":Dy(t,r);break;case"select":e=r.value,e!=null&&so(t,!!r.multiple,e,!1)}};By=Uf;Vy=Na;var b2={usingClientEntryPoint:!1,Events:[nl,Ya,vd,$y,Fy,Uf]},zo={findFiberByHostInstance:fa,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},w2={bundleType:zo.bundleType,version:zo.version,rendererPackageName:zo.rendererPackageName,rendererConfig:zo.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:hn.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=qy(t),t===null?null:t.stateNode},findFiberByHostInstance:zo.findFiberByHostInstance||v2,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var kl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!kl.isDisabled&&kl.supportsFiber)try{pd=kl.inject(w2),Ws=kl}catch{}}ls.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=b2;ls.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Zf(e))throw Error(G(200));return y2(t,e,null,r)};ls.createRoot=function(t,e){if(!Zf(t))throw Error(G(299));var r=!1,s="",n=wv;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(s=e.identifierPrefix),e.onRecoverableError!==void 0&&(n=e.onRecoverableError)),e=Kf(t,1,!1,null,null,r,!1,s,n),t[ln]=e.current,Ri(t.nodeType===8?t.parentNode:t),new Qf(e)};ls.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(G(188)):(t=Object.keys(t).join(","),Error(G(268,t)));return t=qy(e),t=t===null?null:t.stateNode,t};ls.flushSync=function(t){return Na(t)};ls.hydrate=function(t,e,r){if(!kd(e))throw Error(G(200));return Ed(null,t,e,!0,r)};ls.hydrateRoot=function(t,e,r){if(!Zf(t))throw Error(G(405));var s=r!=null&&r.hydratedSources||null,n=!1,a="",i=wv;if(r!=null&&(r.unstable_strictMode===!0&&(n=!0),r.identifierPrefix!==void 0&&(a=r.identifierPrefix),r.onRecoverableError!==void 0&&(i=r.onRecoverableError)),e=bv(e,null,t,1,r??null,n,!1,a,i),t[ln]=e.current,Ri(t),s)for(t=0;t<s.length;t++)r=s[t],n=r._getVersion,n=n(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,n]:e.mutableSourceEagerHydrationData.push(r,n);return new Id(e)};ls.render=function(t,e,r){if(!kd(e))throw Error(G(200));return Ed(null,t,e,!1,r)};ls.unmountComponentAtNode=function(t){if(!kd(t))throw Error(G(40));return t._reactRootContainer?(Na(function(){Ed(null,null,t,!1,function(){t._reactRootContainer=null,t[ln]=null})}),!0):!1};ls.unstable_batchedUpdates=Uf;ls.unstable_renderSubtreeIntoContainer=function(t,e,r,s){if(!kd(r))throw Error(G(200));if(t==null||t._reactInternals===void 0)throw Error(G(38));return Ed(t,e,r,!1,s)};ls.version="18.3.1-next-f1338f8080-20240426";function Sv(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Sv)}catch(t){console.error(t)}}Sv(),Sy.exports=ls;var S2=Sy.exports,Gp=S2;Vu.createRoot=Gp.createRoot,Vu.hydrateRoot=Gp.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function qi(){return qi=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},qi.apply(this,arguments)}var In;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(In||(In={}));const Jp="popstate";function j2(t){t===void 0&&(t={});function e(s,n){let{pathname:a,search:i,hash:l}=s.location;return Mh("",{pathname:a,search:i,hash:l},n.state&&n.state.usr||null,n.state&&n.state.key||"default")}function r(s,n){return typeof n=="string"?n:Cv(n)}return N2(e,r,null,t)}function Xt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function jv(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function C2(){return Math.random().toString(36).substr(2,8)}function Kp(t,e){return{usr:t.state,key:t.key,idx:e}}function Mh(t,e,r,s){return r===void 0&&(r=null),qi({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?No(e):e,{state:r,key:e&&e.key||s||C2()})}function Cv(t){let{pathname:e="/",search:r="",hash:s=""}=t;return r&&r!=="?"&&(e+=r.charAt(0)==="?"?r:"?"+r),s&&s!=="#"&&(e+=s.charAt(0)==="#"?s:"#"+s),e}function No(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substr(r),t=t.substr(0,r));let s=t.indexOf("?");s>=0&&(e.search=t.substr(s),t=t.substr(0,s)),t&&(e.pathname=t)}return e}function N2(t,e,r,s){s===void 0&&(s={});let{window:n=document.defaultView,v5Compat:a=!1}=s,i=n.history,l=In.Pop,c=null,d=u();d==null&&(d=0,i.replaceState(qi({},i.state,{idx:d}),""));function u(){return(i.state||{idx:null}).idx}function h(){l=In.Pop;let x=u(),m=x==null?null:x-d;d=x,c&&c({action:l,location:v.location,delta:m})}function f(x,m){l=In.Push;let g=Mh(v.location,x,m);d=u()+1;let y=Kp(g,d),w=v.createHref(g);try{i.pushState(y,"",w)}catch(b){if(b instanceof DOMException&&b.name==="DataCloneError")throw b;n.location.assign(w)}a&&c&&c({action:l,location:v.location,delta:1})}function p(x,m){l=In.Replace;let g=Mh(v.location,x,m);d=u();let y=Kp(g,d),w=v.createHref(g);i.replaceState(y,"",w),a&&c&&c({action:l,location:v.location,delta:0})}function _(x){let m=n.location.origin!=="null"?n.location.origin:n.location.href,g=typeof x=="string"?x:Cv(x);return g=g.replace(/ $/,"%20"),Xt(m,"No window.location.(origin|href) available to create URL for href: "+g),new URL(g,m)}let v={get action(){return l},get location(){return t(n,i)},listen(x){if(c)throw new Error("A history only accepts one active listener");return n.addEventListener(Jp,h),c=x,()=>{n.removeEventListener(Jp,h),c=null}},createHref(x){return e(n,x)},createURL:_,encodeLocation(x){let m=_(x);return{pathname:m.pathname,search:m.search,hash:m.hash}},push:f,replace:p,go(x){return i.go(x)}};return v}var Yp;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(Yp||(Yp={}));function I2(t,e,r){return r===void 0&&(r="/"),k2(t,e,r)}function k2(t,e,r,s){let n=typeof e=="string"?No(e):e,a=kv(n.pathname||"/",r);if(a==null)return null;let i=Nv(t);E2(i);let l=null;for(let c=0;l==null&&c<i.length;++c){let d=V2(a);l=$2(i[c],d)}return l}function Nv(t,e,r,s){e===void 0&&(e=[]),r===void 0&&(r=[]),s===void 0&&(s="");let n=(a,i,l)=>{let c={relativePath:l===void 0?a.path||"":l,caseSensitive:a.caseSensitive===!0,childrenIndex:i,route:a};c.relativePath.startsWith("/")&&(Xt(c.relativePath.startsWith(s),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(s.length));let d=xa([s,c.relativePath]),u=r.concat(c);a.children&&a.children.length>0&&(Xt(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),Nv(a.children,e,u,d)),!(a.path==null&&!a.index)&&e.push({path:d,score:P2(d,a.index),routesMeta:u})};return t.forEach((a,i)=>{var l;if(a.path===""||!((l=a.path)!=null&&l.includes("?")))n(a,i);else for(let c of Iv(a.path))n(a,i,c)}),e}function Iv(t){let e=t.split("/");if(e.length===0)return[];let[r,...s]=e,n=r.endsWith("?"),a=r.replace(/\?$/,"");if(s.length===0)return n?[a,""]:[a];let i=Iv(s.join("/")),l=[];return l.push(...i.map(c=>c===""?a:[a,c].join("/"))),n&&l.push(...i),l.map(c=>t.startsWith("/")&&c===""?"/":c)}function E2(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:O2(e.routesMeta.map(s=>s.childrenIndex),r.routesMeta.map(s=>s.childrenIndex)))}const T2=/^:[\w-]+$/,L2=3,A2=2,D2=1,M2=10,R2=-2,Qp=t=>t==="*";function P2(t,e){let r=t.split("/"),s=r.length;return r.some(Qp)&&(s+=R2),e&&(s+=A2),r.filter(n=>!Qp(n)).reduce((n,a)=>n+(T2.test(a)?L2:a===""?D2:M2),s)}function O2(t,e){return t.length===e.length&&t.slice(0,-1).every((s,n)=>s===e[n])?t[t.length-1]-e[e.length-1]:0}function $2(t,e,r){let{routesMeta:s}=t,n={},a="/",i=[];for(let l=0;l<s.length;++l){let c=s[l],d=l===s.length-1,u=a==="/"?e:e.slice(a.length)||"/",h=F2({path:c.relativePath,caseSensitive:c.caseSensitive,end:d},u),f=c.route;if(!h)return null;Object.assign(n,h.params),i.push({params:n,pathname:xa([a,h.pathname]),pathnameBase:U2(xa([a,h.pathnameBase])),route:f}),h.pathnameBase!=="/"&&(a=xa([a,h.pathnameBase]))}return i}function F2(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,s]=B2(t.path,t.caseSensitive,t.end),n=e.match(r);if(!n)return null;let a=n[0],i=a.replace(/(.)\/+$/,"$1"),l=n.slice(1);return{params:s.reduce((d,u,h)=>{let{paramName:f,isOptional:p}=u;if(f==="*"){let v=l[h]||"";i=a.slice(0,a.length-v.length).replace(/(.)\/+$/,"$1")}const _=l[h];return p&&!_?d[f]=void 0:d[f]=(_||"").replace(/%2F/g,"/"),d},{}),pathname:a,pathnameBase:i,pattern:t}}function B2(t,e,r){e===void 0&&(e=!1),r===void 0&&(r=!0),jv(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let s=[],n="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,l,c)=>(s.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(s.push({paramName:"*"}),n+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?n+="\\/*$":t!==""&&t!=="/"&&(n+="(?:(?=\\/|$))"),[new RegExp(n,e?void 0:"i"),s]}function V2(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return jv(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function kv(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,s=t.charAt(r);return s&&s!=="/"?null:t.slice(r)||"/"}function H2(t,e){e===void 0&&(e="/");let{pathname:r,search:s="",hash:n=""}=typeof t=="string"?No(t):t;return{pathname:r?r.startsWith("/")?r:z2(r,e):e,search:W2(s),hash:G2(n)}}function z2(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(n=>{n===".."?r.length>1&&r.pop():n!=="."&&r.push(n)}),r.length>1?r.join("/"):"/"}function hu(t,e,r,s){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(s)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function q2(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function Ev(t,e){let r=q2(t);return e?r.map((s,n)=>n===r.length-1?s.pathname:s.pathnameBase):r.map(s=>s.pathnameBase)}function Tv(t,e,r,s){s===void 0&&(s=!1);let n;typeof t=="string"?n=No(t):(n=qi({},t),Xt(!n.pathname||!n.pathname.includes("?"),hu("?","pathname","search",n)),Xt(!n.pathname||!n.pathname.includes("#"),hu("#","pathname","hash",n)),Xt(!n.search||!n.search.includes("#"),hu("#","search","hash",n)));let a=t===""||n.pathname==="",i=a?"/":n.pathname,l;if(i==null)l=r;else{let h=e.length-1;if(!s&&i.startsWith("..")){let f=i.split("/");for(;f[0]==="..";)f.shift(),h-=1;n.pathname=f.join("/")}l=h>=0?e[h]:"/"}let c=H2(n,l),d=i&&i!=="/"&&i.endsWith("/"),u=(a||i===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(d||u)&&(c.pathname+="/"),c}const xa=t=>t.join("/").replace(/\/\/+/g,"/"),U2=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),W2=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,G2=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function J2(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const Lv=["post","put","patch","delete"];new Set(Lv);const K2=["get",...Lv];new Set(K2);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ui(){return Ui=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},Ui.apply(this,arguments)}const Xf=S.createContext(null),Y2=S.createContext(null),ol=S.createContext(null),Td=S.createContext(null),Gn=S.createContext({outlet:null,matches:[],isDataRoute:!1}),Av=S.createContext(null);function il(){return S.useContext(Td)!=null}function ll(){return il()||Xt(!1),S.useContext(Td).location}function Dv(t){S.useContext(ol).static||S.useLayoutEffect(t)}function Io(){let{isDataRoute:t}=S.useContext(Gn);return t?dS():Q2()}function Q2(){il()||Xt(!1);let t=S.useContext(Xf),{basename:e,future:r,navigator:s}=S.useContext(ol),{matches:n}=S.useContext(Gn),{pathname:a}=ll(),i=JSON.stringify(Ev(n,r.v7_relativeSplatPath)),l=S.useRef(!1);return Dv(()=>{l.current=!0}),S.useCallback(function(d,u){if(u===void 0&&(u={}),!l.current)return;if(typeof d=="number"){s.go(d);return}let h=Tv(d,JSON.parse(i),a,u.relative==="path");t==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:xa([e,h.pathname])),(u.replace?s.replace:s.push)(h,u.state,u)},[e,s,i,a,t])}function Z2(){let{matches:t}=S.useContext(Gn),e=t[t.length-1];return e?e.params:{}}function X2(t,e){return eS(t,e)}function eS(t,e,r,s){il()||Xt(!1);let{navigator:n}=S.useContext(ol),{matches:a}=S.useContext(Gn),i=a[a.length-1],l=i?i.params:{};i&&i.pathname;let c=i?i.pathnameBase:"/";i&&i.route;let d=ll(),u;if(e){var h;let x=typeof e=="string"?No(e):e;c==="/"||(h=x.pathname)!=null&&h.startsWith(c)||Xt(!1),u=x}else u=d;let f=u.pathname||"/",p=f;if(c!=="/"){let x=c.replace(/^\//,"").split("/");p="/"+f.replace(/^\//,"").split("/").slice(x.length).join("/")}let _=I2(t,{pathname:p}),v=aS(_&&_.map(x=>Object.assign({},x,{params:Object.assign({},l,x.params),pathname:xa([c,n.encodeLocation?n.encodeLocation(x.pathname).pathname:x.pathname]),pathnameBase:x.pathnameBase==="/"?c:xa([c,n.encodeLocation?n.encodeLocation(x.pathnameBase).pathname:x.pathnameBase])})),a,r,s);return e&&v?S.createElement(Td.Provider,{value:{location:Ui({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:In.Pop}},v):v}function tS(){let t=cS(),e=J2(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,n={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return S.createElement(S.Fragment,null,S.createElement("h2",null,"Unexpected Application Error!"),S.createElement("h3",{style:{fontStyle:"italic"}},e),r?S.createElement("pre",{style:n},r):null,null)}const rS=S.createElement(tS,null);class sS extends S.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,r){return r.location!==e.location||r.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:r.error,location:r.location,revalidation:e.revalidation||r.revalidation}}componentDidCatch(e,r){console.error("React Router caught the following error during render",e,r)}render(){return this.state.error!==void 0?S.createElement(Gn.Provider,{value:this.props.routeContext},S.createElement(Av.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function nS(t){let{routeContext:e,match:r,children:s}=t,n=S.useContext(Xf);return n&&n.static&&n.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=r.route.id),S.createElement(Gn.Provider,{value:e},s)}function aS(t,e,r,s){var n;if(e===void 0&&(e=[]),r===void 0&&(r=null),s===void 0&&(s=null),t==null){var a;if(!r)return null;if(r.errors)t=r.matches;else if((a=s)!=null&&a.v7_partialHydration&&e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let i=t,l=(n=r)==null?void 0:n.errors;if(l!=null){let u=i.findIndex(h=>h.route.id&&(l==null?void 0:l[h.route.id])!==void 0);u>=0||Xt(!1),i=i.slice(0,Math.min(i.length,u+1))}let c=!1,d=-1;if(r&&s&&s.v7_partialHydration)for(let u=0;u<i.length;u++){let h=i[u];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(d=u),h.route.id){let{loaderData:f,errors:p}=r,_=h.route.loader&&f[h.route.id]===void 0&&(!p||p[h.route.id]===void 0);if(h.route.lazy||_){c=!0,d>=0?i=i.slice(0,d+1):i=[i[0]];break}}}return i.reduceRight((u,h,f)=>{let p,_=!1,v=null,x=null;r&&(p=l&&h.route.id?l[h.route.id]:void 0,v=h.route.errorElement||rS,c&&(d<0&&f===0?(uS("route-fallback"),_=!0,x=null):d===f&&(_=!0,x=h.route.hydrateFallbackElement||null)));let m=e.concat(i.slice(0,f+1)),g=()=>{let y;return p?y=v:_?y=x:h.route.Component?y=S.createElement(h.route.Component,null):h.route.element?y=h.route.element:y=u,S.createElement(nS,{match:h,routeContext:{outlet:u,matches:m,isDataRoute:r!=null},children:y})};return r&&(h.route.ErrorBoundary||h.route.errorElement||f===0)?S.createElement(sS,{location:r.location,revalidation:r.revalidation,component:v,error:p,children:g(),routeContext:{outlet:null,matches:m,isDataRoute:!0}}):g()},null)}var Mv=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(Mv||{}),Rv=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(Rv||{});function oS(t){let e=S.useContext(Xf);return e||Xt(!1),e}function iS(t){let e=S.useContext(Y2);return e||Xt(!1),e}function lS(t){let e=S.useContext(Gn);return e||Xt(!1),e}function Pv(t){let e=lS(),r=e.matches[e.matches.length-1];return r.route.id||Xt(!1),r.route.id}function cS(){var t;let e=S.useContext(Av),r=iS(),s=Pv();return e!==void 0?e:(t=r.errors)==null?void 0:t[s]}function dS(){let{router:t}=oS(Mv.UseNavigateStable),e=Pv(Rv.UseNavigateStable),r=S.useRef(!1);return Dv(()=>{r.current=!0}),S.useCallback(function(n,a){a===void 0&&(a={}),r.current&&(typeof n=="number"?t.navigate(n):t.navigate(n,Ui({fromRouteId:e},a)))},[t,e])}const Zp={};function uS(t,e,r){Zp[t]||(Zp[t]=!0)}function hS(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function Wi(t){let{to:e,replace:r,state:s,relative:n}=t;il()||Xt(!1);let{future:a,static:i}=S.useContext(ol),{matches:l}=S.useContext(Gn),{pathname:c}=ll(),d=Io(),u=Tv(e,Ev(l,a.v7_relativeSplatPath),c,n==="path"),h=JSON.stringify(u);return S.useEffect(()=>d(JSON.parse(h),{replace:r,state:s,relative:n}),[d,h,n,r,s]),null}function mt(t){Xt(!1)}function fS(t){let{basename:e="/",children:r=null,location:s,navigationType:n=In.Pop,navigator:a,static:i=!1,future:l}=t;il()&&Xt(!1);let c=e.replace(/^\/*/,"/"),d=S.useMemo(()=>({basename:c,navigator:a,static:i,future:Ui({v7_relativeSplatPath:!1},l)}),[c,l,a,i]);typeof s=="string"&&(s=No(s));let{pathname:u="/",search:h="",hash:f="",state:p=null,key:_="default"}=s,v=S.useMemo(()=>{let x=kv(u,c);return x==null?null:{location:{pathname:x,search:h,hash:f,state:p,key:_},navigationType:n}},[c,u,h,f,p,_,n]);return v==null?null:S.createElement(ol.Provider,{value:d},S.createElement(Td.Provider,{children:r,value:v}))}function mS(t){let{children:e,location:r}=t;return X2(Rh(e),r)}new Promise(()=>{});function Rh(t,e){e===void 0&&(e=[]);let r=[];return S.Children.forEach(t,(s,n)=>{if(!S.isValidElement(s))return;let a=[...e,n];if(s.type===S.Fragment){r.push.apply(r,Rh(s.props.children,a));return}s.type!==mt&&Xt(!1),!s.props.index||!s.props.children||Xt(!1);let i={id:s.props.id||a.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(i.children=Rh(s.props.children,a)),r.push(i)}),r}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const pS="6";try{window.__reactRouterVersion=pS}catch{}const gS="startTransition",Xp=hb[gS];function _S(t){let{basename:e,children:r,future:s,window:n}=t,a=S.useRef();a.current==null&&(a.current=j2({window:n,v5Compat:!0}));let i=a.current,[l,c]=S.useState({action:i.action,location:i.location}),{v7_startTransition:d}=s||{},u=S.useCallback(h=>{d&&Xp?Xp(()=>c(h)):c(h)},[c,d]);return S.useLayoutEffect(()=>i.listen(u),[i,u]),S.useEffect(()=>hS(s),[s]),S.createElement(fS,{basename:e,children:r,location:l.location,navigationType:l.action,navigator:i,future:s})}var eg;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(eg||(eg={}));var tg;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(tg||(tg={}));var Ph=function(t,e){return Ph=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,s){r.__proto__=s}||function(r,s){for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(r[n]=s[n])},Ph(t,e)};function Ov(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Ph(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Wc=function(){return Wc=Object.assign||function(e){for(var r,s=1,n=arguments.length;s<n;s++){r=arguments[s];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Wc.apply(this,arguments)};function ko(t,e){var r={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(r[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(t);n<s.length;n++)e.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(t,s[n])&&(r[s[n]]=t[s[n]]);return r}function $v(t,e,r,s){var n=arguments.length,a=n<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,r):s,i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(t,e,r,s);else for(var l=t.length-1;l>=0;l--)(i=t[l])&&(a=(n<3?i(a):n>3?i(e,r,a):i(e,r))||a);return n>3&&a&&Object.defineProperty(e,r,a),a}function Fv(t,e){return function(r,s){e(r,s,t)}}function Bv(t,e,r,s,n,a){function i(m){if(m!==void 0&&typeof m!="function")throw new TypeError("Function expected");return m}for(var l=s.kind,c=l==="getter"?"get":l==="setter"?"set":"value",d=!e&&t?s.static?t:t.prototype:null,u=e||(d?Object.getOwnPropertyDescriptor(d,s.name):{}),h,f=!1,p=r.length-1;p>=0;p--){var _={};for(var v in s)_[v]=v==="access"?{}:s[v];for(var v in s.access)_.access[v]=s.access[v];_.addInitializer=function(m){if(f)throw new TypeError("Cannot add initializers after decoration has completed");a.push(i(m||null))};var x=(0,r[p])(l==="accessor"?{get:u.get,set:u.set}:u[c],_);if(l==="accessor"){if(x===void 0)continue;if(x===null||typeof x!="object")throw new TypeError("Object expected");(h=i(x.get))&&(u.get=h),(h=i(x.set))&&(u.set=h),(h=i(x.init))&&n.unshift(h)}else(h=i(x))&&(l==="field"?n.unshift(h):u[c]=h)}d&&Object.defineProperty(d,s.name,u),f=!0}function Vv(t,e,r){for(var s=arguments.length>2,n=0;n<e.length;n++)r=s?e[n].call(t,r):e[n].call(t);return s?r:void 0}function Hv(t){return typeof t=="symbol"?t:"".concat(t)}function zv(t,e,r){return typeof e=="symbol"&&(e=e.description?"[".concat(e.description,"]"):""),Object.defineProperty(t,"name",{configurable:!0,value:r?"".concat(r," ",e):e})}function qv(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function pe(t,e,r,s){function n(a){return a instanceof r?a:new r(function(i){i(a)})}return new(r||(r=Promise))(function(a,i){function l(u){try{d(s.next(u))}catch(h){i(h)}}function c(u){try{d(s.throw(u))}catch(h){i(h)}}function d(u){u.done?a(u.value):n(u.value).then(l,c)}d((s=s.apply(t,e||[])).next())})}function Uv(t,e){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},s,n,a,i=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function l(d){return function(u){return c([d,u])}}function c(d){if(s)throw new TypeError("Generator is already executing.");for(;i&&(i=0,d[0]&&(r=0)),r;)try{if(s=1,n&&(a=d[0]&2?n.return:d[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,d[1])).done)return a;switch(n=0,a&&(d=[d[0]&2,a.value]),d[0]){case 0:case 1:a=d;break;case 4:return r.label++,{value:d[1],done:!1};case 5:r.label++,n=d[1],d=[0];continue;case 7:d=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(d[0]===6||d[0]===2)){r=0;continue}if(d[0]===3&&(!a||d[1]>a[0]&&d[1]<a[3])){r.label=d[1];break}if(d[0]===6&&r.label<a[1]){r.label=a[1],a=d;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(d);break}a[2]&&r.ops.pop(),r.trys.pop();continue}d=e.call(t,r)}catch(u){d=[6,u],n=0}finally{s=a=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}}var Ld=Object.create?function(t,e,r,s){s===void 0&&(s=r);var n=Object.getOwnPropertyDescriptor(e,r);(!n||("get"in n?!e.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,s,n)}:function(t,e,r,s){s===void 0&&(s=r),t[s]=e[r]};function Wv(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&Ld(e,t,r)}function Gc(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],s=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&s>=t.length&&(t=void 0),{value:t&&t[s++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function em(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var s=r.call(t),n,a=[],i;try{for(;(e===void 0||e-- >0)&&!(n=s.next()).done;)a.push(n.value)}catch(l){i={error:l}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}return a}function Gv(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(em(arguments[e]));return t}function Jv(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var s=Array(t),n=0,e=0;e<r;e++)for(var a=arguments[e],i=0,l=a.length;i<l;i++,n++)s[n]=a[i];return s}function Kv(t,e,r){if(r||arguments.length===2)for(var s=0,n=e.length,a;s<n;s++)(a||!(s in e))&&(a||(a=Array.prototype.slice.call(e,0,s)),a[s]=e[s]);return t.concat(a||Array.prototype.slice.call(e))}function xo(t){return this instanceof xo?(this.v=t,this):new xo(t)}function Yv(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=r.apply(t,e||[]),n,a=[];return n=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),l("next"),l("throw"),l("return",i),n[Symbol.asyncIterator]=function(){return this},n;function i(p){return function(_){return Promise.resolve(_).then(p,h)}}function l(p,_){s[p]&&(n[p]=function(v){return new Promise(function(x,m){a.push([p,v,x,m])>1||c(p,v)})},_&&(n[p]=_(n[p])))}function c(p,_){try{d(s[p](_))}catch(v){f(a[0][3],v)}}function d(p){p.value instanceof xo?Promise.resolve(p.value.v).then(u,h):f(a[0][2],p)}function u(p){c("next",p)}function h(p){c("throw",p)}function f(p,_){p(_),a.shift(),a.length&&c(a[0][0],a[0][1])}}function Qv(t){var e,r;return e={},s("next"),s("throw",function(n){throw n}),s("return"),e[Symbol.iterator]=function(){return this},e;function s(n,a){e[n]=t[n]?function(i){return(r=!r)?{value:xo(t[n](i)),done:!1}:a?a(i):i}:a}}function Zv(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof Gc=="function"?Gc(t):t[Symbol.iterator](),r={},s("next"),s("throw"),s("return"),r[Symbol.asyncIterator]=function(){return this},r);function s(a){r[a]=t[a]&&function(i){return new Promise(function(l,c){i=t[a](i),n(l,c,i.done,i.value)})}}function n(a,i,l,c){Promise.resolve(c).then(function(d){a({value:d,done:l})},i)}}function Xv(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}var yS=Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e},Oh=function(t){return Oh=Object.getOwnPropertyNames||function(e){var r=[];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(r[r.length]=s);return r},Oh(t)};function e0(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r=Oh(t),s=0;s<r.length;s++)r[s]!=="default"&&Ld(e,t,r[s]);return yS(e,t),e}function t0(t){return t&&t.__esModule?t:{default:t}}function r0(t,e,r,s){if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?s:r==="a"?s.call(t):s?s.value:e.get(t)}function s0(t,e,r,s,n){if(s==="m")throw new TypeError("Private method is not writable");if(s==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return s==="a"?n.call(t,r):n?n.value=r:e.set(t,r),r}function n0(t,e){if(e===null||typeof e!="object"&&typeof e!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof t=="function"?e===t:t.has(e)}function a0(t,e,r){if(e!=null){if(typeof e!="object"&&typeof e!="function")throw new TypeError("Object expected.");var s,n;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");s=e[Symbol.asyncDispose]}if(s===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");s=e[Symbol.dispose],r&&(n=s)}if(typeof s!="function")throw new TypeError("Object not disposable.");n&&(s=function(){try{n.call(this)}catch(a){return Promise.reject(a)}}),t.stack.push({value:e,dispose:s,async:r})}else r&&t.stack.push({async:!0});return e}var vS=typeof SuppressedError=="function"?SuppressedError:function(t,e,r){var s=new Error(r);return s.name="SuppressedError",s.error=t,s.suppressed=e,s};function o0(t){function e(a){t.error=t.hasError?new vS(a,t.error,"An error was suppressed during disposal."):a,t.hasError=!0}var r,s=0;function n(){for(;r=t.stack.pop();)try{if(!r.async&&s===1)return s=0,t.stack.push(r),Promise.resolve().then(n);if(r.dispose){var a=r.dispose.call(r.value);if(r.async)return s|=2,Promise.resolve(a).then(n,function(i){return e(i),n()})}else s|=1}catch(i){e(i)}if(s===1)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}return n()}function i0(t,e){return typeof t=="string"&&/^\.\.?\//.test(t)?t.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(r,s,n,a,i){return s?e?".jsx":".js":n&&(!a||!i)?r:n+a+"."+i.toLowerCase()+"js"}):t}const xS={__extends:Ov,__assign:Wc,__rest:ko,__decorate:$v,__param:Fv,__esDecorate:Bv,__runInitializers:Vv,__propKey:Hv,__setFunctionName:zv,__metadata:qv,__awaiter:pe,__generator:Uv,__createBinding:Ld,__exportStar:Wv,__values:Gc,__read:em,__spread:Gv,__spreadArrays:Jv,__spreadArray:Kv,__await:xo,__asyncGenerator:Yv,__asyncDelegator:Qv,__asyncValues:Zv,__makeTemplateObject:Xv,__importStar:e0,__importDefault:t0,__classPrivateFieldGet:r0,__classPrivateFieldSet:s0,__classPrivateFieldIn:n0,__addDisposableResource:a0,__disposeResources:o0,__rewriteRelativeImportExtension:i0},bS=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:a0,get __assign(){return Wc},__asyncDelegator:Qv,__asyncGenerator:Yv,__asyncValues:Zv,__await:xo,__awaiter:pe,__classPrivateFieldGet:r0,__classPrivateFieldIn:n0,__classPrivateFieldSet:s0,__createBinding:Ld,__decorate:$v,__disposeResources:o0,__esDecorate:Bv,__exportStar:Wv,__extends:Ov,__generator:Uv,__importDefault:t0,__importStar:e0,__makeTemplateObject:Xv,__metadata:qv,__param:Fv,__propKey:Hv,__read:em,__rest:ko,__rewriteRelativeImportExtension:i0,__runInitializers:Vv,__setFunctionName:zv,__spread:Gv,__spreadArray:Kv,__spreadArrays:Jv,__values:Gc,default:xS},Symbol.toStringTag,{value:"Module"})),wS=t=>t?(...e)=>t(...e):(...e)=>fetch(...e);class tm extends Error{constructor(e,r="FunctionsError",s){super(e),this.name=r,this.context=s}}class rg extends tm{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class sg extends tm{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class ng extends tm{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var $h;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})($h||($h={}));class SS{constructor(e,{headers:r={},customFetch:s,region:n=$h.Any}={}){this.url=e,this.headers=r,this.region=n,this.fetch=wS(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return pe(this,arguments,void 0,function*(r,s={}){var n;try{const{headers:a,method:i,body:l,signal:c}=s;let d={},{region:u}=s;u||(u=this.region);const h=new URL(`${this.url}/${r}`);u&&u!=="any"&&(d["x-region"]=u,h.searchParams.set("forceFunctionRegion",u));let f;l&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)?typeof Blob<"u"&&l instanceof Blob||l instanceof ArrayBuffer?(d["Content-Type"]="application/octet-stream",f=l):typeof l=="string"?(d["Content-Type"]="text/plain",f=l):typeof FormData<"u"&&l instanceof FormData?f=l:(d["Content-Type"]="application/json",f=JSON.stringify(l)):f=l;const p=yield this.fetch(h.toString(),{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},d),this.headers),a),body:f,signal:c}).catch(m=>{throw m.name==="AbortError"?m:new rg(m)}),_=p.headers.get("x-relay-error");if(_&&_==="true")throw new sg(p);if(!p.ok)throw new ng(p);let v=((n=p.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),x;return v==="application/json"?x=yield p.json():v==="application/octet-stream"||v==="application/pdf"?x=yield p.blob():v==="text/event-stream"?x=p:v==="multipart/form-data"?x=yield p.formData():x=yield p.text(),{data:x,error:null,response:p}}catch(a){return a instanceof Error&&a.name==="AbortError"?{data:null,error:new rg(a)}:{data:null,error:a,response:a instanceof ng||a instanceof sg?a.context:void 0}}})}}var Pr={};const Eo=Yx(bS);var El={},Tl={},Ll={},Al={},Dl={},Ml={},ag;function l0(){if(ag)return Ml;ag=1,Object.defineProperty(Ml,"__esModule",{value:!0});class t extends Error{constructor(r){super(r.message),this.name="PostgrestError",this.details=r.details,this.hint=r.hint,this.code=r.code}}return Ml.default=t,Ml}var og;function c0(){if(og)return Dl;og=1,Object.defineProperty(Dl,"__esModule",{value:!0});const e=Eo.__importDefault(l0());class r{constructor(n){var a,i;this.shouldThrowOnError=!1,this.method=n.method,this.url=n.url,this.headers=new Headers(n.headers),this.schema=n.schema,this.body=n.body,this.shouldThrowOnError=(a=n.shouldThrowOnError)!==null&&a!==void 0?a:!1,this.signal=n.signal,this.isMaybeSingle=(i=n.isMaybeSingle)!==null&&i!==void 0?i:!1,n.fetch?this.fetch=n.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(n,a){return this.headers=new Headers(this.headers),this.headers.set(n,a),this}then(n,a){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const i=this.fetch;let l=i(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async c=>{var d,u,h,f;let p=null,_=null,v=null,x=c.status,m=c.statusText;if(c.ok){if(this.method!=="HEAD"){const b=await c.text();b===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((d=this.headers.get("Accept"))===null||d===void 0)&&d.includes("application/vnd.pgrst.plan+text"))?_=b:_=JSON.parse(b))}const y=(u=this.headers.get("Prefer"))===null||u===void 0?void 0:u.match(/count=(exact|planned|estimated)/),w=(h=c.headers.get("content-range"))===null||h===void 0?void 0:h.split("/");y&&w&&w.length>1&&(v=parseInt(w[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(_)&&(_.length>1?(p={code:"PGRST116",details:`Results contain ${_.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},_=null,v=null,x=406,m="Not Acceptable"):_.length===1?_=_[0]:_=null)}else{const y=await c.text();try{p=JSON.parse(y),Array.isArray(p)&&c.status===404&&(_=[],p=null,x=200,m="OK")}catch{c.status===404&&y===""?(x=204,m="No Content"):p={message:y}}if(p&&this.isMaybeSingle&&(!((f=p==null?void 0:p.details)===null||f===void 0)&&f.includes("0 rows"))&&(p=null,x=200,m="OK"),p&&this.shouldThrowOnError)throw new e.default(p)}return{error:p,data:_,count:v,status:x,statusText:m}});return this.shouldThrowOnError||(l=l.catch(c=>{var d,u,h;return{error:{message:`${(d=c==null?void 0:c.name)!==null&&d!==void 0?d:"FetchError"}: ${c==null?void 0:c.message}`,details:`${(u=c==null?void 0:c.stack)!==null&&u!==void 0?u:""}`,hint:"",code:`${(h=c==null?void 0:c.code)!==null&&h!==void 0?h:""}`},data:null,count:null,status:0,statusText:""}})),l.then(n,a)}returns(){return this}overrideTypes(){return this}}return Dl.default=r,Dl}var ig;function d0(){if(ig)return Al;ig=1,Object.defineProperty(Al,"__esModule",{value:!0});const e=Eo.__importDefault(c0());class r extends e.default{select(n){let a=!1;const i=(n??"*").split("").map(l=>/\s/.test(l)&&!a?"":(l==='"'&&(a=!a),l)).join("");return this.url.searchParams.set("select",i),this.headers.append("Prefer","return=representation"),this}order(n,{ascending:a=!0,nullsFirst:i,foreignTable:l,referencedTable:c=l}={}){const d=c?`${c}.order`:"order",u=this.url.searchParams.get(d);return this.url.searchParams.set(d,`${u?`${u},`:""}${n}.${a?"asc":"desc"}${i===void 0?"":i?".nullsfirst":".nullslast"}`),this}limit(n,{foreignTable:a,referencedTable:i=a}={}){const l=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(l,`${n}`),this}range(n,a,{foreignTable:i,referencedTable:l=i}={}){const c=typeof l>"u"?"offset":`${l}.offset`,d=typeof l>"u"?"limit":`${l}.limit`;return this.url.searchParams.set(c,`${n}`),this.url.searchParams.set(d,`${a-n+1}`),this}abortSignal(n){return this.signal=n,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:n=!1,verbose:a=!1,settings:i=!1,buffers:l=!1,wal:c=!1,format:d="text"}={}){var u;const h=[n?"analyze":null,a?"verbose":null,i?"settings":null,l?"buffers":null,c?"wal":null].filter(Boolean).join("|"),f=(u=this.headers.get("Accept"))!==null&&u!==void 0?u:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${d}; for="${f}"; options=${h};`),d==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(n){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${n}`),this}}return Al.default=r,Al}var lg;function rm(){if(lg)return Ll;lg=1,Object.defineProperty(Ll,"__esModule",{value:!0});const e=Eo.__importDefault(d0()),r=new RegExp("[,()]");class s extends e.default{eq(a,i){return this.url.searchParams.append(a,`eq.${i}`),this}neq(a,i){return this.url.searchParams.append(a,`neq.${i}`),this}gt(a,i){return this.url.searchParams.append(a,`gt.${i}`),this}gte(a,i){return this.url.searchParams.append(a,`gte.${i}`),this}lt(a,i){return this.url.searchParams.append(a,`lt.${i}`),this}lte(a,i){return this.url.searchParams.append(a,`lte.${i}`),this}like(a,i){return this.url.searchParams.append(a,`like.${i}`),this}likeAllOf(a,i){return this.url.searchParams.append(a,`like(all).{${i.join(",")}}`),this}likeAnyOf(a,i){return this.url.searchParams.append(a,`like(any).{${i.join(",")}}`),this}ilike(a,i){return this.url.searchParams.append(a,`ilike.${i}`),this}ilikeAllOf(a,i){return this.url.searchParams.append(a,`ilike(all).{${i.join(",")}}`),this}ilikeAnyOf(a,i){return this.url.searchParams.append(a,`ilike(any).{${i.join(",")}}`),this}is(a,i){return this.url.searchParams.append(a,`is.${i}`),this}in(a,i){const l=Array.from(new Set(i)).map(c=>typeof c=="string"&&r.test(c)?`"${c}"`:`${c}`).join(",");return this.url.searchParams.append(a,`in.(${l})`),this}contains(a,i){return typeof i=="string"?this.url.searchParams.append(a,`cs.${i}`):Array.isArray(i)?this.url.searchParams.append(a,`cs.{${i.join(",")}}`):this.url.searchParams.append(a,`cs.${JSON.stringify(i)}`),this}containedBy(a,i){return typeof i=="string"?this.url.searchParams.append(a,`cd.${i}`):Array.isArray(i)?this.url.searchParams.append(a,`cd.{${i.join(",")}}`):this.url.searchParams.append(a,`cd.${JSON.stringify(i)}`),this}rangeGt(a,i){return this.url.searchParams.append(a,`sr.${i}`),this}rangeGte(a,i){return this.url.searchParams.append(a,`nxl.${i}`),this}rangeLt(a,i){return this.url.searchParams.append(a,`sl.${i}`),this}rangeLte(a,i){return this.url.searchParams.append(a,`nxr.${i}`),this}rangeAdjacent(a,i){return this.url.searchParams.append(a,`adj.${i}`),this}overlaps(a,i){return typeof i=="string"?this.url.searchParams.append(a,`ov.${i}`):this.url.searchParams.append(a,`ov.{${i.join(",")}}`),this}textSearch(a,i,{config:l,type:c}={}){let d="";c==="plain"?d="pl":c==="phrase"?d="ph":c==="websearch"&&(d="w");const u=l===void 0?"":`(${l})`;return this.url.searchParams.append(a,`${d}fts${u}.${i}`),this}match(a){return Object.entries(a).forEach(([i,l])=>{this.url.searchParams.append(i,`eq.${l}`)}),this}not(a,i,l){return this.url.searchParams.append(a,`not.${i}.${l}`),this}or(a,{foreignTable:i,referencedTable:l=i}={}){const c=l?`${l}.or`:"or";return this.url.searchParams.append(c,`(${a})`),this}filter(a,i,l){return this.url.searchParams.append(a,`${i}.${l}`),this}}return Ll.default=s,Ll}var cg;function u0(){if(cg)return Tl;cg=1,Object.defineProperty(Tl,"__esModule",{value:!0});const e=Eo.__importDefault(rm());class r{constructor(n,{headers:a={},schema:i,fetch:l}){this.url=n,this.headers=new Headers(a),this.schema=i,this.fetch=l}select(n,a){const{head:i=!1,count:l}=a??{},c=i?"HEAD":"GET";let d=!1;const u=(n??"*").split("").map(h=>/\s/.test(h)&&!d?"":(h==='"'&&(d=!d),h)).join("");return this.url.searchParams.set("select",u),l&&this.headers.append("Prefer",`count=${l}`),new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(n,{count:a,defaultToNull:i=!0}={}){var l;const c="POST";if(a&&this.headers.append("Prefer",`count=${a}`),i||this.headers.append("Prefer","missing=default"),Array.isArray(n)){const d=n.reduce((u,h)=>u.concat(Object.keys(h)),[]);if(d.length>0){const u=[...new Set(d)].map(h=>`"${h}"`);this.url.searchParams.set("columns",u.join(","))}}return new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}upsert(n,{onConflict:a,ignoreDuplicates:i=!1,count:l,defaultToNull:c=!0}={}){var d;const u="POST";if(this.headers.append("Prefer",`resolution=${i?"ignore":"merge"}-duplicates`),a!==void 0&&this.url.searchParams.set("on_conflict",a),l&&this.headers.append("Prefer",`count=${l}`),c||this.headers.append("Prefer","missing=default"),Array.isArray(n)){const h=n.reduce((f,p)=>f.concat(Object.keys(p)),[]);if(h.length>0){const f=[...new Set(h)].map(p=>`"${p}"`);this.url.searchParams.set("columns",f.join(","))}}return new e.default({method:u,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}update(n,{count:a}={}){var i;const l="PATCH";return a&&this.headers.append("Prefer",`count=${a}`),new e.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}delete({count:n}={}){var a;const i="DELETE";return n&&this.headers.append("Prefer",`count=${n}`),new e.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}}return Tl.default=r,Tl}var dg;function jS(){if(dg)return El;dg=1,Object.defineProperty(El,"__esModule",{value:!0});const t=Eo,e=t.__importDefault(u0()),r=t.__importDefault(rm());class s{constructor(a,{headers:i={},schema:l,fetch:c}={}){this.url=a,this.headers=new Headers(i),this.schemaName=l,this.fetch=c}from(a){const i=new URL(`${this.url}/${a}`);return new e.default(i,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(a){return new s(this.url,{headers:this.headers,schema:a,fetch:this.fetch})}rpc(a,i={},{head:l=!1,get:c=!1,count:d}={}){var u;let h;const f=new URL(`${this.url}/rpc/${a}`);let p;l||c?(h=l?"HEAD":"GET",Object.entries(i).filter(([v,x])=>x!==void 0).map(([v,x])=>[v,Array.isArray(x)?`{${x.join(",")}}`:`${x}`]).forEach(([v,x])=>{f.searchParams.append(v,x)})):(h="POST",p=i);const _=new Headers(this.headers);return d&&_.set("Prefer",`count=${d}`),new r.default({method:h,url:f,headers:_,schema:this.schemaName,body:p,fetch:(u=this.fetch)!==null&&u!==void 0?u:fetch})}}return El.default=s,El}Object.defineProperty(Pr,"__esModule",{value:!0});var h0=Pr.PostgrestError=w0=Pr.PostgrestBuilder=x0=Pr.PostgrestTransformBuilder=y0=Pr.PostgrestFilterBuilder=g0=Pr.PostgrestQueryBuilder=m0=Pr.PostgrestClient=void 0;const To=Eo,f0=To.__importDefault(jS());var m0=Pr.PostgrestClient=f0.default;const p0=To.__importDefault(u0());var g0=Pr.PostgrestQueryBuilder=p0.default;const _0=To.__importDefault(rm());var y0=Pr.PostgrestFilterBuilder=_0.default;const v0=To.__importDefault(d0());var x0=Pr.PostgrestTransformBuilder=v0.default;const b0=To.__importDefault(c0());var w0=Pr.PostgrestBuilder=b0.default;const S0=To.__importDefault(l0());h0=Pr.PostgrestError=S0.default;var j0=Pr.default={PostgrestClient:f0.default,PostgrestQueryBuilder:p0.default,PostgrestFilterBuilder:_0.default,PostgrestTransformBuilder:v0.default,PostgrestBuilder:b0.default,PostgrestError:S0.default};const CS=uy({__proto__:null,get PostgrestBuilder(){return w0},get PostgrestClient(){return m0},get PostgrestError(){return h0},get PostgrestFilterBuilder(){return y0},get PostgrestQueryBuilder(){return g0},get PostgrestTransformBuilder(){return x0},default:j0},[Pr]),{PostgrestClient:NS,PostgrestQueryBuilder:mee,PostgrestFilterBuilder:pee,PostgrestTransformBuilder:gee,PostgrestBuilder:_ee,PostgrestError:yee}=j0||CS;class IS{static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const s=r.node,n=parseInt(s.replace(/^v/,"").split(".")[0]);return n>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${n} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${n} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let r=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(r+=`

Suggested solution: ${e.workaround}`),new Error(r)}static createWebSocket(e,r){const s=this.getWebSocketConstructor();return new s(e,r)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const kS="2.79.0",ES=`realtime-js/${kS}`,TS="1.0.0",Fh=1e4,LS=1e3,AS=100;var _i;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(_i||(_i={}));var ar;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(ar||(ar={}));var Ts;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(Ts||(Ts={}));var Bh;(function(t){t.websocket="websocket"})(Bh||(Bh={}));var ca;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(ca||(ca={}));class DS{constructor(){this.HEADER_LENGTH=1}decode(e,r){return e.constructor===ArrayBuffer?r(this._binaryDecode(e)):r(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const r=new DataView(e),s=new TextDecoder;return this._decodeBroadcast(e,r,s)}_decodeBroadcast(e,r,s){const n=r.getUint8(1),a=r.getUint8(2);let i=this.HEADER_LENGTH+2;const l=s.decode(e.slice(i,i+n));i=i+n;const c=s.decode(e.slice(i,i+a));i=i+a;const d=JSON.parse(s.decode(e.slice(i,e.byteLength)));return{ref:null,topic:l,event:c,payload:d}}}class C0{constructor(e,r){this.callback=e,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var _t;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(_t||(_t={}));const ug=(t,e,r={})=>{var s;const n=(s=r.skipTypes)!==null&&s!==void 0?s:[];return e?Object.keys(e).reduce((a,i)=>(a[i]=MS(i,t,e,n),a),{}):{}},MS=(t,e,r,s)=>{const n=e.find(l=>l.name===t),a=n==null?void 0:n.type,i=r[t];return a&&!s.includes(a)?N0(a,i):Vh(i)},N0=(t,e)=>{if(t.charAt(0)==="_"){const r=t.slice(1,t.length);return $S(e,r)}switch(t){case _t.bool:return RS(e);case _t.float4:case _t.float8:case _t.int2:case _t.int4:case _t.int8:case _t.numeric:case _t.oid:return PS(e);case _t.json:case _t.jsonb:return OS(e);case _t.timestamp:return FS(e);case _t.abstime:case _t.date:case _t.daterange:case _t.int4range:case _t.int8range:case _t.money:case _t.reltime:case _t.text:case _t.time:case _t.timestamptz:case _t.timetz:case _t.tsrange:case _t.tstzrange:return Vh(e);default:return Vh(e)}},Vh=t=>t,RS=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},PS=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},OS=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},$S=(t,e)=>{if(typeof t!="string")return t;const r=t.length-1,s=t[r];if(t[0]==="{"&&s==="}"){let a;const i=t.slice(1,r);try{a=JSON.parse("["+i+"]")}catch{a=i?i.split(","):[]}return a.map(l=>N0(e,l))}return t},FS=t=>typeof t=="string"?t.replace(" ","T"):t,I0=t=>{const e=new URL(t);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class fu{constructor(e,r,s={},n=Fh){this.channel=e,this.event=r,this.payload=s,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,r){var s;return this._hasReceived(e)&&r((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:e,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:r}){this.recHooks.filter(s=>s.status===e).forEach(s=>s.callback(r))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var hg;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(hg||(hg={}));class yi{constructor(e,r){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},n=>{const{onJoin:a,onLeave:i,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=yi.syncState(this.state,n,a,i),this.pendingDiffs.forEach(c=>{this.state=yi.syncDiff(this.state,c,a,i)}),this.pendingDiffs=[],l()}),this.channel._on(s.diff,{},n=>{const{onJoin:a,onLeave:i,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(n):(this.state=yi.syncDiff(this.state,n,a,i),l())}),this.onJoin((n,a,i)=>{this.channel._trigger("presence",{event:"join",key:n,currentPresences:a,newPresences:i})}),this.onLeave((n,a,i)=>{this.channel._trigger("presence",{event:"leave",key:n,currentPresences:a,leftPresences:i})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,r,s,n){const a=this.cloneDeep(e),i=this.transformState(r),l={},c={};return this.map(a,(d,u)=>{i[d]||(c[d]=u)}),this.map(i,(d,u)=>{const h=a[d];if(h){const f=u.map(x=>x.presence_ref),p=h.map(x=>x.presence_ref),_=u.filter(x=>p.indexOf(x.presence_ref)<0),v=h.filter(x=>f.indexOf(x.presence_ref)<0);_.length>0&&(l[d]=_),v.length>0&&(c[d]=v)}else l[d]=u}),this.syncDiff(a,{joins:l,leaves:c},s,n)}static syncDiff(e,r,s,n){const{joins:a,leaves:i}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return s||(s=()=>{}),n||(n=()=>{}),this.map(a,(l,c)=>{var d;const u=(d=e[l])!==null&&d!==void 0?d:[];if(e[l]=this.cloneDeep(c),u.length>0){const h=e[l].map(p=>p.presence_ref),f=u.filter(p=>h.indexOf(p.presence_ref)<0);e[l].unshift(...f)}s(l,u,c)}),this.map(i,(l,c)=>{let d=e[l];if(!d)return;const u=c.map(h=>h.presence_ref);d=d.filter(h=>u.indexOf(h.presence_ref)<0),e[l]=d,n(l,d,c),d.length===0&&delete e[l]}),e}static map(e,r){return Object.getOwnPropertyNames(e).map(s=>r(s,e[s]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((r,s)=>{const n=e[s];return"metas"in n?r[s]=n.metas.map(a=>(a.presence_ref=a.phx_ref,delete a.phx_ref,delete a.phx_ref_prev,a)):r[s]=n,r},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var fg;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(fg||(fg={}));var vi;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(vi||(vi={}));var en;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(en||(en={}));class sm{constructor(e,r={config:{}},s){var n,a;if(this.topic=e,this.params=r,this.socket=s,this.bindings={},this.state=ar.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new fu(this,Ts.join,this.params,this.timeout),this.rejoinTimer=new C0(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=ar.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=ar.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=ar.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=ar.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=ar.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Ts.reply,{},(i,l)=>{this._trigger(this._replyEventName(l),i)}),this.presence=new yi(this),this.broadcastEndpointURL=I0(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((a=(n=this.params.config)===null||n===void 0?void 0:n.broadcast)===null||a===void 0)&&a.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,r=this.timeout){var s,n,a;if(this.socket.isConnected()||this.socket.connect(),this.state==ar.closed){const{config:{broadcast:i,presence:l,private:c}}=this.params,d=(n=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(p=>p.filter))!==null&&n!==void 0?n:[],u=!!this.bindings[vi.PRESENCE]&&this.bindings[vi.PRESENCE].length>0||((a=this.params.config.presence)===null||a===void 0?void 0:a.enabled)===!0,h={},f={broadcast:i,presence:Object.assign(Object.assign({},l),{enabled:u}),postgres_changes:d,private:c};this.socket.accessTokenValue&&(h.access_token=this.socket.accessTokenValue),this._onError(p=>e==null?void 0:e(en.CHANNEL_ERROR,p)),this._onClose(()=>e==null?void 0:e(en.CLOSED)),this.updateJoinPayload(Object.assign({config:f},h)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:p})=>{var _;if(this.socket.setAuth(),p===void 0){e==null||e(en.SUBSCRIBED);return}else{const v=this.bindings.postgres_changes,x=(_=v==null?void 0:v.length)!==null&&_!==void 0?_:0,m=[];for(let g=0;g<x;g++){const y=v[g],{filter:{event:w,schema:b,table:C,filter:j}}=y,I=p&&p[g];if(I&&I.event===w&&I.schema===b&&I.table===C&&I.filter===j)m.push(Object.assign(Object.assign({},y),{id:I.id}));else{this.unsubscribe(),this.state=ar.errored,e==null||e(en.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=m,e&&e(en.SUBSCRIBED);return}}).receive("error",p=>{this.state=ar.errored,e==null||e(en.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(p).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(en.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,r={}){return await this.send({type:"presence",event:"track",payload:e},r.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,r,s){return this.state===ar.joined&&e===vi.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,r,s)}async httpSend(e,r,s={}){var n;const a=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(r==null)return Promise.reject("Payload is required for httpSend()");const i={method:"POST",headers:{Authorization:a,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:r,private:this.private}]})},l=await this._fetchWithTimeout(this.broadcastEndpointURL,i,(n=s.timeout)!==null&&n!==void 0?n:this.timeout);if(l.status===202)return{success:!0};let c=l.statusText;try{const d=await l.json();c=d.error||d.message||c}catch{}return Promise.reject(new Error(c))}async send(e,r={}){var s,n;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:a,payload:i}=e,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:i,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(s=r.timeout)!==null&&s!==void 0?s:this.timeout);return await((n=d.body)===null||n===void 0?void 0:n.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(a=>{var i,l,c;const d=this._push(e.type,e,r.timeout||this.timeout);e.type==="broadcast"&&!(!((c=(l=(i=this.params)===null||i===void 0?void 0:i.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&a("ok"),d.receive("ok",()=>a("ok")),d.receive("error",()=>a("error")),d.receive("timeout",()=>a("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=ar.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Ts.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(n=>{s=new fu(this,Ts.leave,{},e),s.receive("ok",()=>{r(),n("ok")}).receive("timeout",()=>{r(),n("timed out")}).receive("error",()=>{n("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{s==null||s.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=ar.closed,this.bindings={}}async _fetchWithTimeout(e,r,s){const n=new AbortController,a=setTimeout(()=>n.abort(),s),i=await this.socket.fetch(e,Object.assign(Object.assign({},r),{signal:n.signal}));return clearTimeout(a),i}_push(e,r,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new fu(this,e,r,s);return this._canPush()?n.send():this._addToPushBuffer(n),n}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>AS){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(e,r,s){return r}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,r,s){var n,a;const i=e.toLocaleLowerCase(),{close:l,error:c,leave:d,join:u}=Ts;if(s&&[l,c,d,u].indexOf(i)>=0&&s!==this._joinRef())return;let f=this._onMessage(i,r,s);if(r&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?(n=this.bindings.postgres_changes)===null||n===void 0||n.filter(p=>{var _,v,x;return((_=p.filter)===null||_===void 0?void 0:_.event)==="*"||((x=(v=p.filter)===null||v===void 0?void 0:v.event)===null||x===void 0?void 0:x.toLocaleLowerCase())===i}).map(p=>p.callback(f,s)):(a=this.bindings[i])===null||a===void 0||a.filter(p=>{var _,v,x,m,g,y;if(["broadcast","presence","postgres_changes"].includes(i))if("id"in p){const w=p.id,b=(_=p.filter)===null||_===void 0?void 0:_.event;return w&&((v=r.ids)===null||v===void 0?void 0:v.includes(w))&&(b==="*"||(b==null?void 0:b.toLocaleLowerCase())===((x=r.data)===null||x===void 0?void 0:x.type.toLocaleLowerCase()))}else{const w=(g=(m=p==null?void 0:p.filter)===null||m===void 0?void 0:m.event)===null||g===void 0?void 0:g.toLocaleLowerCase();return w==="*"||w===((y=r==null?void 0:r.event)===null||y===void 0?void 0:y.toLocaleLowerCase())}else return p.type.toLocaleLowerCase()===i}).map(p=>{if(typeof f=="object"&&"ids"in f){const _=f.data,{schema:v,table:x,commit_timestamp:m,type:g,errors:y}=_;f=Object.assign(Object.assign({},{schema:v,table:x,commit_timestamp:m,eventType:g,new:{},old:{},errors:y}),this._getPayloadRecords(_))}p.callback(f,s)})}_isClosed(){return this.state===ar.closed}_isJoined(){return this.state===ar.joined}_isJoining(){return this.state===ar.joining}_isLeaving(){return this.state===ar.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,r,s){const n=e.toLocaleLowerCase(),a={type:n,filter:r,callback:s};return this.bindings[n]?this.bindings[n].push(a):this.bindings[n]=[a],this}_off(e,r){const s=e.toLocaleLowerCase();return this.bindings[s]&&(this.bindings[s]=this.bindings[s].filter(n=>{var a;return!(((a=n.type)===null||a===void 0?void 0:a.toLocaleLowerCase())===s&&sm.isEqual(n.filter,r))})),this}static isEqual(e,r){if(Object.keys(e).length!==Object.keys(r).length)return!1;for(const s in e)if(e[s]!==r[s])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Ts.close,{},e)}_onError(e){this._on(Ts.error,{},r=>e(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=ar.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const r={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(r.new=ug(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(r.old=ug(e.columns,e.old_record)),r}}const mu=()=>{},Rl={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},BS=[1e3,2e3,5e3,1e4],VS=1e4,HS=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class zS{constructor(e,r){var s;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Fh,this.transport=null,this.heartbeatIntervalMs=Rl.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=mu,this.ref=0,this.reconnectTimer=null,this.logger=mu,this.conn=null,this.sendBuffer=[],this.serializer=new DS,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=n=>n?(...a)=>n(...a):(...a)=>fetch(...a),!(!((s=r==null?void 0:r.params)===null||s===void 0)&&s.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${e}/${Bh.websocket}`,this.httpEndpoint=I0(e),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=IS.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const r=e.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:TS}))}disconnect(e,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const s=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(s),this._setConnectionState("disconnected")},e?this.conn.close(e,r??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const r=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const e=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,r,s){this.logger(e,r,s)}connectionState(){switch(this.conn&&this.conn.readyState){case _i.connecting:return ca.Connecting;case _i.open:return ca.Open;case _i.closing:return ca.Closing;default:return ca.Closed}}isConnected(){return this.connectionState()===ca.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,r={config:{}}){const s=`realtime:${e}`,n=this.getChannels().find(a=>a.topic===s);if(n)return n;{const a=new sm(`realtime:${e}`,r,this);return this.channels.push(a),a}}push(e){const{topic:r,event:s,payload:n,ref:a}=e,i=()=>{this.encode(e,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${r} ${s} (${a})`,n),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(LS,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},Rl.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let r=this.channels.find(s=>s.topic===e&&(s._isJoined()||s._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${e}"`),r.unsubscribe())}_remove(e){this.channels=this.channels.filter(r=>r.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(d){this.log("error","error in heartbeat callback",d)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:s,event:n,payload:a,ref:i}=r,l=i?`(${i})`:"",c=a.status||"";this.log("receive",`${c} ${s} ${n} ${l}`.trim(),a),this.channels.filter(d=>d._isMember(s)).forEach(d=>d._trigger(n,a,i)),this._triggerStateCallbacks("message",r)})}_clearTimer(e){var r;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var r;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(Ts.error))}_appendParams(e,r){if(Object.keys(r).length===0)return e;const s=e.match(/\?/)?"&":"?",n=new URLSearchParams(r);return`${e}${s}${n}`}_workerObjectUrl(e){let r;if(e)r=e;else{const s=new Blob([HS],{type:"application/javascript"});r=URL.createObjectURL(s)}return r}_setConnectionState(e,r=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(e=null){let r;e?r=e:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(s=>{const n={access_token:r,version:ES};r&&s.updateJoinPayload(n),s.joinedOnce&&s._isJoined()&&s._push(Ts.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${e}`,r)})}_triggerStateCallbacks(e,r){try{this.stateChangeCallbacks[e].forEach(s=>{try{s(r)}catch(n){this.log("error",`error in ${e} callback`,n)}})}catch(s){this.log("error",`error triggering ${e} callbacks`,s)}}_setupReconnectionTimer(){this.reconnectTimer=new C0(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Rl.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var r,s,n,a,i,l,c,d,u;if(this.transport=(r=e==null?void 0:e.transport)!==null&&r!==void 0?r:null,this.timeout=(s=e==null?void 0:e.timeout)!==null&&s!==void 0?s:Fh,this.heartbeatIntervalMs=(n=e==null?void 0:e.heartbeatIntervalMs)!==null&&n!==void 0?n:Rl.HEARTBEAT_INTERVAL,this.worker=(a=e==null?void 0:e.worker)!==null&&a!==void 0?a:!1,this.accessToken=(i=e==null?void 0:e.accessToken)!==null&&i!==void 0?i:null,this.heartbeatCallback=(l=e==null?void 0:e.heartbeatCallback)!==null&&l!==void 0?l:mu,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(c=e==null?void 0:e.reconnectAfterMs)!==null&&c!==void 0?c:h=>BS[h-1]||VS,this.encode=(d=e==null?void 0:e.encode)!==null&&d!==void 0?d:(h,f)=>f(JSON.stringify(h)),this.decode=(u=e==null?void 0:e.decode)!==null&&u!==void 0?u:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}class nm extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function At(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class qS extends nm{constructor(e,r,s){super(e),this.name="StorageApiError",this.status=r,this.statusCode=s}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Hh extends nm{constructor(e,r){super(e),this.name="StorageUnknownError",this.originalError=r}}const am=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),US=()=>Response,zh=t=>{if(Array.isArray(t))return t.map(r=>zh(r));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([r,s])=>{const n=r.replace(/([-_][a-z])/gi,a=>a.toUpperCase().replace(/[-_]/g,""));e[n]=zh(s)}),e},WS=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},pu=t=>{var e;return t.msg||t.message||t.error_description||(typeof t.error=="string"?t.error:(e=t.error)===null||e===void 0?void 0:e.message)||JSON.stringify(t)},GS=(t,e,r)=>pe(void 0,void 0,void 0,function*(){const s=yield US();t instanceof s&&!(r!=null&&r.noResolveJson)?t.json().then(n=>{const a=t.status||500,i=(n==null?void 0:n.statusCode)||a+"";e(new qS(pu(n),a,i))}).catch(n=>{e(new Hh(pu(n),n))}):e(new Hh(pu(t),t))}),JS=(t,e,r,s)=>{const n={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"||!s?n:(WS(s)?(n.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),n.body=JSON.stringify(s)):n.body=s,e!=null&&e.duplex&&(n.duplex=e.duplex),Object.assign(Object.assign({},n),r))};function cl(t,e,r,s,n,a){return pe(this,void 0,void 0,function*(){return new Promise((i,l)=>{t(r,JS(e,s,n,a)).then(c=>{if(!c.ok)throw c;return s!=null&&s.noResolveJson?c:c.json()}).then(c=>i(c)).catch(c=>GS(c,l,s))})})}function Gi(t,e,r,s){return pe(this,void 0,void 0,function*(){return cl(t,"GET",e,r,s)})}function ks(t,e,r,s,n){return pe(this,void 0,void 0,function*(){return cl(t,"POST",e,s,n,r)})}function qh(t,e,r,s,n){return pe(this,void 0,void 0,function*(){return cl(t,"PUT",e,s,n,r)})}function KS(t,e,r,s){return pe(this,void 0,void 0,function*(){return cl(t,"HEAD",e,Object.assign(Object.assign({},r),{noResolveJson:!0}),s)})}function om(t,e,r,s,n){return pe(this,void 0,void 0,function*(){return cl(t,"DELETE",e,s,n,r)})}class YS{constructor(e,r){this.downloadFn=e,this.shouldThrowOnError=r}then(e,r){return this.execute().then(e,r)}execute(){return pe(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(At(e))return{data:null,error:e};throw e}})}}var k0;class QS{constructor(e,r){this.downloadFn=e,this.shouldThrowOnError=r,this[k0]="BlobDownloadBuilder",this.promise=null}asStream(){return new YS(this.downloadFn,this.shouldThrowOnError)}then(e,r){return this.getPromise().then(e,r)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return pe(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(At(e))return{data:null,error:e};throw e}})}}k0=Symbol.toStringTag;const ZS={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},mg={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class XS{constructor(e,r={},s,n){this.shouldThrowOnError=!1,this.url=e,this.headers=r,this.bucketId=s,this.fetch=am(n)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,r,s,n){return pe(this,void 0,void 0,function*(){try{let a;const i=Object.assign(Object.assign({},mg),n);let l=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(i.upsert)});const c=i.metadata;typeof Blob<"u"&&s instanceof Blob?(a=new FormData,a.append("cacheControl",i.cacheControl),c&&a.append("metadata",this.encodeMetadata(c)),a.append("",s)):typeof FormData<"u"&&s instanceof FormData?(a=s,a.has("cacheControl")||a.append("cacheControl",i.cacheControl),c&&!a.has("metadata")&&a.append("metadata",this.encodeMetadata(c))):(a=s,l["cache-control"]=`max-age=${i.cacheControl}`,l["content-type"]=i.contentType,c&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(c))),(typeof ReadableStream<"u"&&a instanceof ReadableStream||a&&typeof a=="object"&&"pipe"in a&&typeof a.pipe=="function")&&!i.duplex&&(i.duplex="half")),n!=null&&n.headers&&(l=Object.assign(Object.assign({},l),n.headers));const d=this._removeEmptyFolders(r),u=this._getFinalPath(d),h=yield(e=="PUT"?qh:ks)(this.fetch,`${this.url}/object/${u}`,a,Object.assign({headers:l},i!=null&&i.duplex?{duplex:i.duplex}:{}));return{data:{path:d,id:h.Id,fullPath:h.Key},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(At(a))return{data:null,error:a};throw a}})}upload(e,r,s){return pe(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,r,s)})}uploadToSignedUrl(e,r,s,n){return pe(this,void 0,void 0,function*(){const a=this._removeEmptyFolders(e),i=this._getFinalPath(a),l=new URL(this.url+`/object/upload/sign/${i}`);l.searchParams.set("token",r);try{let c;const d=Object.assign({upsert:mg.upsert},n),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(d.upsert)});typeof Blob<"u"&&s instanceof Blob?(c=new FormData,c.append("cacheControl",d.cacheControl),c.append("",s)):typeof FormData<"u"&&s instanceof FormData?(c=s,c.append("cacheControl",d.cacheControl)):(c=s,u["cache-control"]=`max-age=${d.cacheControl}`,u["content-type"]=d.contentType);const h=yield qh(this.fetch,l.toString(),c,{headers:u});return{data:{path:a,fullPath:h.Key},error:null}}catch(c){if(this.shouldThrowOnError)throw c;if(At(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(e,r){return pe(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e);const n=Object.assign({},this.headers);r!=null&&r.upsert&&(n["x-upsert"]="true");const a=yield ks(this.fetch,`${this.url}/object/upload/sign/${s}`,{},{headers:n}),i=new URL(this.url+a.url),l=i.searchParams.get("token");if(!l)throw new nm("No token returned by API");return{data:{signedUrl:i.toString(),path:e,token:l},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(At(s))return{data:null,error:s};throw s}})}update(e,r,s){return pe(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,r,s)})}move(e,r,s){return pe(this,void 0,void 0,function*(){try{return{data:yield ks(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(At(n))return{data:null,error:n};throw n}})}copy(e,r,s){return pe(this,void 0,void 0,function*(){try{return{data:{path:(yield ks(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers})).Key},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(At(n))return{data:null,error:n};throw n}})}createSignedUrl(e,r,s){return pe(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e),a=yield ks(this.fetch,`${this.url}/object/sign/${n}`,Object.assign({expiresIn:r},s!=null&&s.transform?{transform:s.transform}:{}),{headers:this.headers});const i=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return a={signedUrl:encodeURI(`${this.url}${a.signedURL}${i}`)},{data:a,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(At(n))return{data:null,error:n};throw n}})}createSignedUrls(e,r,s){return pe(this,void 0,void 0,function*(){try{const n=yield ks(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:e},{headers:this.headers}),a=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return{data:n.map(i=>Object.assign(Object.assign({},i),{signedUrl:i.signedURL?encodeURI(`${this.url}${i.signedURL}${a}`):null})),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(At(n))return{data:null,error:n};throw n}})}download(e,r){const n=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",a=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),i=a?`?${a}`:"",l=this._getFinalPath(e),c=()=>Gi(this.fetch,`${this.url}/${n}/${l}${i}`,{headers:this.headers,noResolveJson:!0});return new QS(c,this.shouldThrowOnError)}info(e){return pe(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{const s=yield Gi(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:zh(s),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(At(s))return{data:null,error:s};throw s}})}exists(e){return pe(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{return yield KS(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(At(s)&&s instanceof Hh){const n=s.originalError;if([400,404].includes(n==null?void 0:n.status))return{data:!1,error:s}}throw s}})}getPublicUrl(e,r){const s=this._getFinalPath(e),n=[],a=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";a!==""&&n.push(a);const l=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});c!==""&&n.push(c);let d=n.join("&");return d!==""&&(d=`?${d}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${s}${d}`)}}}remove(e){return pe(this,void 0,void 0,function*(){try{return{data:yield om(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(At(r))return{data:null,error:r};throw r}})}list(e,r,s){return pe(this,void 0,void 0,function*(){try{const n=Object.assign(Object.assign(Object.assign({},ZS),r),{prefix:e||""});return{data:yield ks(this.fetch,`${this.url}/object/list/${this.bucketId}`,n,{headers:this.headers},s),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(At(n))return{data:null,error:n};throw n}})}listV2(e,r){return pe(this,void 0,void 0,function*(){try{const s=Object.assign({},e);return{data:yield ks(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,s,{headers:this.headers},r),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(At(s))return{data:null,error:s};throw s}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const r=[];return e.width&&r.push(`width=${e.width}`),e.height&&r.push(`height=${e.height}`),e.resize&&r.push(`resize=${e.resize}`),e.format&&r.push(`format=${e.format}`),e.quality&&r.push(`quality=${e.quality}`),r.join("&")}}const E0="2.79.0",T0={"X-Client-Info":`storage-js/${E0}`};class ej{constructor(e,r={},s,n){this.shouldThrowOnError=!1;const a=new URL(e);n!=null&&n.useNewHostname&&/supabase\.(co|in|red)$/.test(a.hostname)&&!a.hostname.includes("storage.supabase.")&&(a.hostname=a.hostname.replace("supabase.","storage.supabase.")),this.url=a.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},T0),r),this.fetch=am(s)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(e){return pe(this,void 0,void 0,function*(){try{const r=this.listBucketOptionsToQueryString(e);return{data:yield Gi(this.fetch,`${this.url}/bucket${r}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(At(r))return{data:null,error:r};throw r}})}getBucket(e){return pe(this,void 0,void 0,function*(){try{return{data:yield Gi(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(At(r))return{data:null,error:r};throw r}})}createBucket(e){return pe(this,arguments,void 0,function*(r,s={public:!1}){try{return{data:yield ks(this.fetch,`${this.url}/bucket`,{id:r,name:r,type:s.type,public:s.public,file_size_limit:s.fileSizeLimit,allowed_mime_types:s.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(At(n))return{data:null,error:n};throw n}})}updateBucket(e,r){return pe(this,void 0,void 0,function*(){try{return{data:yield qh(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(At(s))return{data:null,error:s};throw s}})}emptyBucket(e){return pe(this,void 0,void 0,function*(){try{return{data:yield ks(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(At(r))return{data:null,error:r};throw r}})}deleteBucket(e){return pe(this,void 0,void 0,function*(){try{return{data:yield om(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(At(r))return{data:null,error:r};throw r}})}listBucketOptionsToQueryString(e){const r={};return e&&("limit"in e&&(r.limit=String(e.limit)),"offset"in e&&(r.offset=String(e.offset)),e.search&&(r.search=e.search),e.sortColumn&&(r.sortColumn=e.sortColumn),e.sortOrder&&(r.sortOrder=e.sortOrder)),Object.keys(r).length>0?"?"+new URLSearchParams(r).toString():""}}class tj{constructor(e,r={},s){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},T0),r),this.fetch=am(s)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return pe(this,void 0,void 0,function*(){try{return{data:yield ks(this.fetch,`${this.url}/bucket`,{name:e},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(At(r))return{data:null,error:r};throw r}})}listBuckets(e){return pe(this,void 0,void 0,function*(){try{const r=new URLSearchParams;(e==null?void 0:e.limit)!==void 0&&r.set("limit",e.limit.toString()),(e==null?void 0:e.offset)!==void 0&&r.set("offset",e.offset.toString()),e!=null&&e.sortColumn&&r.set("sortColumn",e.sortColumn),e!=null&&e.sortOrder&&r.set("sortOrder",e.sortOrder),e!=null&&e.search&&r.set("search",e.search);const s=r.toString(),n=s?`${this.url}/bucket?${s}`:`${this.url}/bucket`;return{data:yield Gi(this.fetch,n,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(At(r))return{data:null,error:r};throw r}})}deleteBucket(e){return pe(this,void 0,void 0,function*(){try{return{data:yield om(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(At(r))return{data:null,error:r};throw r}})}}const im={"X-Client-Info":`storage-js/${E0}`,"Content-Type":"application/json"};class L0 extends Error{constructor(e){super(e),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function ss(t){return typeof t=="object"&&t!==null&&"__isStorageVectorsError"in t}class gu extends L0{constructor(e,r,s){super(e),this.name="StorageVectorsApiError",this.status=r,this.statusCode=s}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class rj extends L0{constructor(e,r){super(e),this.name="StorageVectorsUnknownError",this.originalError=r}}var pg;(function(t){t.InternalError="InternalError",t.S3VectorConflictException="S3VectorConflictException",t.S3VectorNotFoundException="S3VectorNotFoundException",t.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",t.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",t.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(pg||(pg={}));const lm=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),sj=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},gg=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),nj=(t,e,r)=>pe(void 0,void 0,void 0,function*(){if(t&&typeof t=="object"&&"status"in t&&"ok"in t&&typeof t.status=="number"&&!(r!=null&&r.noResolveJson)){const n=t.status||500,a=t;if(typeof a.json=="function")a.json().then(i=>{const l=(i==null?void 0:i.statusCode)||(i==null?void 0:i.code)||n+"";e(new gu(gg(i),n,l))}).catch(()=>{const i=n+"",l=a.statusText||`HTTP ${n} error`;e(new gu(l,n,i))});else{const i=n+"",l=a.statusText||`HTTP ${n} error`;e(new gu(l,n,i))}}else e(new rj(gg(t),t))}),aj=(t,e,r,s)=>{const n={method:t,headers:(e==null?void 0:e.headers)||{}};return s?(sj(s)?(n.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),n.body=JSON.stringify(s)):n.body=s,Object.assign(Object.assign({},n),r)):n};function oj(t,e,r,s,n,a){return pe(this,void 0,void 0,function*(){return new Promise((i,l)=>{t(r,aj(e,s,n,a)).then(c=>{if(!c.ok)throw c;if(s!=null&&s.noResolveJson)return c;const d=c.headers.get("content-type");return!d||!d.includes("application/json")?{}:c.json()}).then(c=>i(c)).catch(c=>nj(c,l,s))})})}function ns(t,e,r,s,n){return pe(this,void 0,void 0,function*(){return oj(t,"POST",e,s,n,r)})}class ij{constructor(e,r={},s){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},im),r),this.fetch=lm(s)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(e){return pe(this,void 0,void 0,function*(){try{return{data:(yield ns(this.fetch,`${this.url}/CreateIndex`,e,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ss(r))return{data:null,error:r};throw r}})}getIndex(e,r){return pe(this,void 0,void 0,function*(){try{return{data:yield ns(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:e,indexName:r},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(ss(s))return{data:null,error:s};throw s}})}listIndexes(e){return pe(this,void 0,void 0,function*(){try{return{data:yield ns(this.fetch,`${this.url}/ListIndexes`,e,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ss(r))return{data:null,error:r};throw r}})}deleteIndex(e,r){return pe(this,void 0,void 0,function*(){try{return{data:(yield ns(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:e,indexName:r},{headers:this.headers}))||{},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(ss(s))return{data:null,error:s};throw s}})}}class lj{constructor(e,r={},s){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},im),r),this.fetch=lm(s)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(e){return pe(this,void 0,void 0,function*(){try{if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield ns(this.fetch,`${this.url}/PutVectors`,e,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ss(r))return{data:null,error:r};throw r}})}getVectors(e){return pe(this,void 0,void 0,function*(){try{return{data:yield ns(this.fetch,`${this.url}/GetVectors`,e,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ss(r))return{data:null,error:r};throw r}})}listVectors(e){return pe(this,void 0,void 0,function*(){try{if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return{data:yield ns(this.fetch,`${this.url}/ListVectors`,e,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ss(r))return{data:null,error:r};throw r}})}queryVectors(e){return pe(this,void 0,void 0,function*(){try{return{data:yield ns(this.fetch,`${this.url}/QueryVectors`,e,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ss(r))return{data:null,error:r};throw r}})}deleteVectors(e){return pe(this,void 0,void 0,function*(){try{if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield ns(this.fetch,`${this.url}/DeleteVectors`,e,{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ss(r))return{data:null,error:r};throw r}})}}class cj{constructor(e,r={},s){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},im),r),this.fetch=lm(s)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return pe(this,void 0,void 0,function*(){try{return{data:(yield ns(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ss(r))return{data:null,error:r};throw r}})}getBucket(e){return pe(this,void 0,void 0,function*(){try{return{data:yield ns(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:e},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ss(r))return{data:null,error:r};throw r}})}listBuckets(){return pe(this,arguments,void 0,function*(e={}){try{return{data:yield ns(this.fetch,`${this.url}/ListVectorBuckets`,e,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ss(r))return{data:null,error:r};throw r}})}deleteBucket(e){return pe(this,void 0,void 0,function*(){try{return{data:(yield ns(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(ss(r))return{data:null,error:r};throw r}})}}class dj extends cj{constructor(e,r={}){super(e,r.headers||{},r.fetch)}from(e){return new uj(this.url,this.headers,e,this.fetch)}}class uj extends ij{constructor(e,r,s,n){super(e,r,n),this.vectorBucketName=s}createIndex(e){const r=Object.create(null,{createIndex:{get:()=>super.createIndex}});return pe(this,void 0,void 0,function*(){return r.createIndex.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const e=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return pe(this,arguments,void 0,function*(r={}){return e.listIndexes.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName}))})}getIndex(e){const r=Object.create(null,{getIndex:{get:()=>super.getIndex}});return pe(this,void 0,void 0,function*(){return r.getIndex.call(this,this.vectorBucketName,e)})}deleteIndex(e){const r=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return pe(this,void 0,void 0,function*(){return r.deleteIndex.call(this,this.vectorBucketName,e)})}index(e){return new hj(this.url,this.headers,this.vectorBucketName,e,this.fetch)}}class hj extends lj{constructor(e,r,s,n,a){super(e,r,a),this.vectorBucketName=s,this.indexName=n}putVectors(e){const r=Object.create(null,{putVectors:{get:()=>super.putVectors}});return pe(this,void 0,void 0,function*(){return r.putVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(e){const r=Object.create(null,{getVectors:{get:()=>super.getVectors}});return pe(this,void 0,void 0,function*(){return r.getVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const e=Object.create(null,{listVectors:{get:()=>super.listVectors}});return pe(this,arguments,void 0,function*(r={}){return e.listVectors.call(this,Object.assign(Object.assign({},r),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(e){const r=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return pe(this,void 0,void 0,function*(){return r.queryVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(e){const r=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return pe(this,void 0,void 0,function*(){return r.deleteVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class fj extends ej{constructor(e,r={},s,n){super(e,r,s,n)}from(e){return new XS(this.url,this.headers,e,this.fetch)}get vectors(){return new dj(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new tj(this.url+"/iceberg",this.headers,this.fetch)}}const mj="2.79.0";let ei="";typeof Deno<"u"?ei="deno":typeof document<"u"?ei="web":typeof navigator<"u"&&navigator.product==="ReactNative"?ei="react-native":ei="node";const pj={"X-Client-Info":`supabase-js-${ei}/${mj}`},gj={headers:pj},_j={schema:"public"},yj={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},vj={},xj=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),bj=()=>Headers,wj=(t,e,r)=>{const s=xj(r),n=bj();return async(a,i)=>{var l;const c=(l=await e())!==null&&l!==void 0?l:t;let d=new n(i==null?void 0:i.headers);return d.has("apikey")||d.set("apikey",t),d.has("Authorization")||d.set("Authorization",`Bearer ${c}`),s(a,Object.assign(Object.assign({},i),{headers:d}))}};function Sj(t){return t.endsWith("/")?t:t+"/"}function jj(t,e){var r,s;const{db:n,auth:a,realtime:i,global:l}=t,{db:c,auth:d,realtime:u,global:h}=e,f={db:Object.assign(Object.assign({},c),n),auth:Object.assign(Object.assign({},d),a),realtime:Object.assign(Object.assign({},u),i),storage:{},global:Object.assign(Object.assign(Object.assign({},h),l),{headers:Object.assign(Object.assign({},(r=h==null?void 0:h.headers)!==null&&r!==void 0?r:{}),(s=l==null?void 0:l.headers)!==null&&s!==void 0?s:{})}),accessToken:async()=>""};return t.accessToken?f.accessToken=t.accessToken:delete f.accessToken,f}function Cj(t){const e=t==null?void 0:t.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(Sj(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const A0="2.79.0",Ha=30*1e3,Uh=3,_u=Uh*Ha,Nj="http://localhost:9999",Ij="supabase.auth.token",kj={"X-Client-Info":`gotrue-js/${A0}`},Wh="X-Supabase-Api-Version",D0={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Ej=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Tj=10*60*1e3;class Ji extends Error{constructor(e,r,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=s}}function be(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class Lj extends Ji{constructor(e,r,s){super(e,r,s),this.name="AuthApiError",this.status=r,this.code=s}}function Aj(t){return be(t)&&t.name==="AuthApiError"}class da extends Ji{constructor(e,r){super(e),this.name="AuthUnknownError",this.originalError=r}}class Jn extends Ji{constructor(e,r,s,n){super(e,s,n),this.name=r,this.status=s}}class Cs extends Jn{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Dj(t){return be(t)&&t.name==="AuthSessionMissingError"}class Aa extends Jn{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Pl extends Jn{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Ol extends Jn{constructor(e,r=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Mj(t){return be(t)&&t.name==="AuthImplicitGrantRedirectError"}class _g extends Jn{constructor(e,r=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Gh extends Jn{constructor(e,r){super(e,"AuthRetryableFetchError",r,void 0)}}function yu(t){return be(t)&&t.name==="AuthRetryableFetchError"}class yg extends Jn{constructor(e,r,s){super(e,"AuthWeakPasswordError",r,"weak_password"),this.reasons=s}}class Jh extends Jn{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Jc="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),vg=` 	
\r=`.split(""),Rj=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<vg.length;e+=1)t[vg[e].charCodeAt(0)]=-2;for(let e=0;e<Jc.length;e+=1)t[Jc[e].charCodeAt(0)]=e;return t})();function xg(t,e,r){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;r(Jc[s]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;r(Jc[s]),e.queuedBits-=6}}function M0(t,e,r){const s=Rj[t];if(s>-1)for(e.queue=e.queue<<6|s,e.queuedBits+=6;e.queuedBits>=8;)r(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(s===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function bg(t){const e=[],r=i=>{e.push(String.fromCodePoint(i))},s={utf8seq:0,codepoint:0},n={queue:0,queuedBits:0},a=i=>{$j(i,s,r)};for(let i=0;i<t.length;i+=1)M0(t.charCodeAt(i),n,a);return e.join("")}function Pj(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function Oj(t,e){for(let r=0;r<t.length;r+=1){let s=t.charCodeAt(r);if(s>55295&&s<=56319){const n=(s-55296)*1024&65535;s=(t.charCodeAt(r+1)-56320&65535|n)+65536,r+=1}Pj(s,e)}}function $j(t,e,r){if(e.utf8seq===0){if(t<=127){r(t);return}for(let s=1;s<6;s+=1)if(!(t>>7-s&1)){e.utf8seq=s;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&r(e.codepoint)}}function co(t){const e=[],r={queue:0,queuedBits:0},s=n=>{e.push(n)};for(let n=0;n<t.length;n+=1)M0(t.charCodeAt(n),r,s);return new Uint8Array(e)}function Fj(t){const e=[];return Oj(t,r=>e.push(r)),new Uint8Array(e)}function ga(t){const e=[],r={queue:0,queuedBits:0},s=n=>{e.push(n)};return t.forEach(n=>xg(n,r,s)),xg(null,r,s),e.join("")}function Bj(t){return Math.round(Date.now()/1e3)+t}function Vj(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const Cr=()=>typeof window<"u"&&typeof document<"u",Kn={tested:!1,writable:!1},R0=()=>{if(!Cr())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Kn.tested)return Kn.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),Kn.tested=!0,Kn.writable=!0}catch{Kn.tested=!0,Kn.writable=!1}return Kn.writable};function Hj(t){const e={},r=new URL(t);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((n,a)=>{e[a]=n})}catch{}return r.searchParams.forEach((s,n)=>{e[n]=s}),e}const P0=t=>t?(...e)=>t(...e):(...e)=>fetch(...e),zj=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",za=async(t,e,r)=>{await t.setItem(e,JSON.stringify(r))},Yn=async(t,e)=>{const r=await t.getItem(e);if(!r)return null;try{return JSON.parse(r)}catch{return r}},mn=async(t,e)=>{await t.removeItem(e)};class Ad{constructor(){this.promise=new Ad.promiseConstructor((e,r)=>{this.resolve=e,this.reject=r})}}Ad.promiseConstructor=Promise;function vu(t){const e=t.split(".");if(e.length!==3)throw new Jh("Invalid JWT structure");for(let s=0;s<e.length;s++)if(!Ej.test(e[s]))throw new Jh("JWT not in base64url format");return{header:JSON.parse(bg(e[0])),payload:JSON.parse(bg(e[1])),signature:co(e[2]),raw:{header:e[0],payload:e[1]}}}async function qj(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function Uj(t,e){return new Promise((s,n)=>{(async()=>{for(let a=0;a<1/0;a++)try{const i=await t(a);if(!e(a,null,i)){s(i);return}}catch(i){if(!e(a,i)){n(i);return}}})()})}function Wj(t){return("0"+t.toString(16)).substr(-2)}function Gj(){const e=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=r.length;let n="";for(let a=0;a<56;a++)n+=r.charAt(Math.floor(Math.random()*s));return n}return crypto.getRandomValues(e),Array.from(e,Wj).join("")}async function Jj(t){const r=new TextEncoder().encode(t),s=await crypto.subtle.digest("SHA-256",r),n=new Uint8Array(s);return Array.from(n).map(a=>String.fromCharCode(a)).join("")}async function Kj(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const r=await Jj(t);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Da(t,e,r=!1){const s=Gj();let n=s;r&&(n+="/PASSWORD_RECOVERY"),await za(t,`${e}-code-verifier`,n);const a=await Kj(s);return[a,s===a?"plain":"s256"]}const Yj=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Qj(t){const e=t.headers.get(Wh);if(!e||!e.match(Yj))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function Zj(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function Xj(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const eC=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Ma(t){if(!eC.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function xu(){const t={};return new Proxy(t,{get:(e,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const s=r.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function tC(t,e){return new Proxy(t,{get:(r,s,n)=>{if(s==="__isInsecureUserWarningProxy")return!0;if(typeof s=="symbol"){const a=s.toString();if(a==="Symbol(Symbol.toPrimitive)"||a==="Symbol(Symbol.toStringTag)"||a==="Symbol(util.inspect.custom)"||a==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,s,n)}return!e.value&&typeof s=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(r,s,n)}})}function wg(t){return JSON.parse(JSON.stringify(t))}const ia=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),rC=[502,503,504];async function Sg(t){var e;if(!zj(t))throw new Gh(ia(t),0);if(rC.includes(t.status))throw new Gh(ia(t),t.status);let r;try{r=await t.json()}catch(a){throw new da(ia(a),a)}let s;const n=Qj(t);if(n&&n.getTime()>=D0["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?s=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(s=r.error_code),s){if(s==="weak_password")throw new yg(ia(r),t.status,((e=r.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(s==="session_not_found")throw new Cs}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((a,i)=>a&&typeof i=="string",!0))throw new yg(ia(r),t.status,r.weak_password.reasons);throw new Lj(ia(r),t.status||500,s)}const sC=(t,e,r,s)=>{const n={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),n.body=JSON.stringify(s),Object.assign(Object.assign({},n),r))};async function Ee(t,e,r,s){var n;const a=Object.assign({},s==null?void 0:s.headers);a[Wh]||(a[Wh]=D0["2024-01-01"].name),s!=null&&s.jwt&&(a.Authorization=`Bearer ${s.jwt}`);const i=(n=s==null?void 0:s.query)!==null&&n!==void 0?n:{};s!=null&&s.redirectTo&&(i.redirect_to=s.redirectTo);const l=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",c=await nC(t,e,r+l,{headers:a,noResolveJson:s==null?void 0:s.noResolveJson},{},s==null?void 0:s.body);return s!=null&&s.xform?s==null?void 0:s.xform(c):{data:Object.assign({},c),error:null}}async function nC(t,e,r,s,n,a){const i=sC(e,s,n,a);let l;try{l=await t(r,Object.assign({},i))}catch(c){throw console.error(c),new Gh(ia(c),0)}if(l.ok||await Sg(l),s!=null&&s.noResolveJson)return l;try{return await l.json()}catch(c){await Sg(c)}}function Ns(t){var e;let r=null;iC(t)&&(r=Object.assign({},t),t.expires_at||(r.expires_at=Bj(t.expires_in)));const s=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:r,user:s},error:null}}function jg(t){const e=Ns(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((r,s)=>r&&typeof s=="string",!0)&&(e.data.weak_password=t.weak_password),e}function Sn(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function aC(t){return{data:t,error:null}}function oC(t){const{action_link:e,email_otp:r,hashed_token:s,redirect_to:n,verification_type:a}=t,i=ko(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:e,email_otp:r,hashed_token:s,redirect_to:n,verification_type:a},c=Object.assign({},i);return{data:{properties:l,user:c},error:null}}function Cg(t){return t}function iC(t){return t.access_token&&t.refresh_token&&t.expires_in}const bu=["global","local","others"];class lC{constructor({url:e="",headers:r={},fetch:s}){this.url=e,this.headers=r,this.fetch=P0(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,r=bu[0]){if(bu.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${bu.join(", ")}`);try{return await Ee(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(be(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e,r={}){try{return await Ee(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Sn})}catch(s){if(be(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:r}=e,s=ko(e,["options"]),n=Object.assign(Object.assign({},s),r);return"newEmail"in s&&(n.new_email=s==null?void 0:s.newEmail,delete n.newEmail),await Ee(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:oC,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(be(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(e){try{return await Ee(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Sn})}catch(r){if(be(r))return{data:{user:null},error:r};throw r}}async listUsers(e){var r,s,n,a,i,l,c;try{const d={nextPage:null,lastPage:0,total:0},u=await Ee(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(r=e==null?void 0:e.page)===null||r===void 0?void 0:r.toString())!==null&&s!==void 0?s:"",per_page:(a=(n=e==null?void 0:e.perPage)===null||n===void 0?void 0:n.toString())!==null&&a!==void 0?a:""},xform:Cg});if(u.error)throw u.error;const h=await u.json(),f=(i=u.headers.get("x-total-count"))!==null&&i!==void 0?i:0,p=(c=(l=u.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return p.length>0&&(p.forEach(_=>{const v=parseInt(_.split(";")[0].split("=")[1].substring(0,1)),x=JSON.parse(_.split(";")[1].split("=")[1]);d[`${x}Page`]=v}),d.total=parseInt(f)),{data:Object.assign(Object.assign({},h),d),error:null}}catch(d){if(be(d))return{data:{users:[]},error:d};throw d}}async getUserById(e){Ma(e);try{return await Ee(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Sn})}catch(r){if(be(r))return{data:{user:null},error:r};throw r}}async updateUserById(e,r){Ma(e);try{return await Ee(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:r,headers:this.headers,xform:Sn})}catch(s){if(be(s))return{data:{user:null},error:s};throw s}}async deleteUser(e,r=!1){Ma(e);try{return await Ee(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:r},xform:Sn})}catch(s){if(be(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){Ma(e.userId);try{const{data:r,error:s}=await Ee(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:n=>({data:{factors:n},error:null})});return{data:r,error:s}}catch(r){if(be(r))return{data:null,error:r};throw r}}async _deleteFactor(e){Ma(e.userId),Ma(e.id);try{return{data:await Ee(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(r){if(be(r))return{data:null,error:r};throw r}}async _listOAuthClients(e){var r,s,n,a,i,l,c;try{const d={nextPage:null,lastPage:0,total:0},u=await Ee(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(r=e==null?void 0:e.page)===null||r===void 0?void 0:r.toString())!==null&&s!==void 0?s:"",per_page:(a=(n=e==null?void 0:e.perPage)===null||n===void 0?void 0:n.toString())!==null&&a!==void 0?a:""},xform:Cg});if(u.error)throw u.error;const h=await u.json(),f=(i=u.headers.get("x-total-count"))!==null&&i!==void 0?i:0,p=(c=(l=u.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return p.length>0&&(p.forEach(_=>{const v=parseInt(_.split(";")[0].split("=")[1].substring(0,1)),x=JSON.parse(_.split(";")[1].split("=")[1]);d[`${x}Page`]=v}),d.total=parseInt(f)),{data:Object.assign(Object.assign({},h),d),error:null}}catch(d){if(be(d))return{data:{clients:[]},error:d};throw d}}async _createOAuthClient(e){try{return await Ee(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(be(r))return{data:null,error:r};throw r}}async _getOAuthClient(e){try{return await Ee(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(be(r))return{data:null,error:r};throw r}}async _updateOAuthClient(e,r){try{return await Ee(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:r,headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(be(s))return{data:null,error:s};throw s}}async _deleteOAuthClient(e){try{return await Ee(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(be(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(e){try{return await Ee(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(be(r))return{data:null,error:r};throw r}}}function Ng(t={}){return{getItem:e=>t[e]||null,setItem:(e,r)=>{t[e]=r},removeItem:e=>{delete t[e]}}}const Ra={debug:!!(globalThis&&R0()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class O0 extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class cC extends O0{}async function dC(t,e,r){Ra.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const s=new globalThis.AbortController;return e>0&&setTimeout(()=>{s.abort(),Ra.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async n=>{if(n){Ra.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,n.name);try{return await r()}finally{Ra.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,n.name)}}else{if(e===0)throw Ra.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new cC(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(Ra.debug)try{const a=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(a,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function uC(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function $0(t){if(!/^0x[a-fA-F0-9]{40}$/.test(t))throw new Error(`@supabase/auth-js: Address "${t}" is invalid.`);return t.toLowerCase()}function hC(t){return parseInt(t,16)}function fC(t){const e=new TextEncoder().encode(t);return"0x"+Array.from(e,s=>s.toString(16).padStart(2,"0")).join("")}function mC(t){var e;const{chainId:r,domain:s,expirationTime:n,issuedAt:a=new Date,nonce:i,notBefore:l,requestId:c,resources:d,scheme:u,uri:h,version:f}=t;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!s)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(i&&i.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${i}`);if(!h)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(f!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${f}`);if(!((e=t.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${t.statement}`)}const p=$0(t.address),_=u?`${u}://${s}`:s,v=t.statement?`${t.statement}
`:"",x=`${_} wants you to sign in with your Ethereum account:
${p}

${v}`;let m=`URI: ${h}
Version: ${f}
Chain ID: ${r}${i?`
Nonce: ${i}`:""}
Issued At: ${a.toISOString()}`;if(n&&(m+=`
Expiration Time: ${n.toISOString()}`),l&&(m+=`
Not Before: ${l.toISOString()}`),c&&(m+=`
Request ID: ${c}`),d){let g=`
Resources:`;for(const y of d){if(!y||typeof y!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${y}`);g+=`
- ${y}`}m+=g}return`${x}
${m}`}class Yt extends Error{constructor({message:e,code:r,cause:s,name:n}){var a;super(e,{cause:s}),this.__isWebAuthnError=!0,this.name=(a=n??(s instanceof Error?s.name:void 0))!==null&&a!==void 0?a:"Unknown Error",this.code=r}}class Kc extends Yt{constructor(e,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:e}),this.name="WebAuthnUnknownError",this.originalError=r}}function pC({error:t,options:e}){var r,s,n;const{publicKey:a}=e;if(!a)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Yt({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else if(t.name==="ConstraintError"){if(((r=a.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new Yt({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:t});if(e.mediation==="conditional"&&((s=a.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new Yt({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:t});if(((n=a.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new Yt({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:t})}else{if(t.name==="InvalidStateError")return new Yt({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:t});if(t.name==="NotAllowedError")return new Yt({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="NotSupportedError")return a.pubKeyCredParams.filter(l=>l.type==="public-key").length===0?new Yt({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:t}):new Yt({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:t});if(t.name==="SecurityError"){const i=window.location.hostname;if(F0(i)){if(a.rp.id!==i)return new Yt({message:`The RP ID "${a.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new Yt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="TypeError"){if(a.user.id.byteLength<1||a.user.id.byteLength>64)return new Yt({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:t})}else if(t.name==="UnknownError")return new Yt({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new Yt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}function gC({error:t,options:e}){const{publicKey:r}=e;if(!r)throw Error("options was missing required publicKey property");if(t.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Yt({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:t})}else{if(t.name==="NotAllowedError")return new Yt({message:t.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t});if(t.name==="SecurityError"){const s=window.location.hostname;if(F0(s)){if(r.rpId!==s)return new Yt({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:t})}else return new Yt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:t})}else if(t.name==="UnknownError")return new Yt({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:t})}return new Yt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t})}class _C{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const yC=new _C;function vC(t){if(!t)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(t);const{challenge:e,user:r,excludeCredentials:s}=t,n=ko(t,["challenge","user","excludeCredentials"]),a=co(e).buffer,i=Object.assign(Object.assign({},r),{id:co(r.id).buffer}),l=Object.assign(Object.assign({},n),{challenge:a,user:i});if(s&&s.length>0){l.excludeCredentials=new Array(s.length);for(let c=0;c<s.length;c++){const d=s[c];l.excludeCredentials[c]=Object.assign(Object.assign({},d),{id:co(d.id).buffer,type:d.type||"public-key",transports:d.transports})}}return l}function xC(t){if(!t)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(t);const{challenge:e,allowCredentials:r}=t,s=ko(t,["challenge","allowCredentials"]),n=co(e).buffer,a=Object.assign(Object.assign({},s),{challenge:n});if(r&&r.length>0){a.allowCredentials=new Array(r.length);for(let i=0;i<r.length;i++){const l=r[i];a.allowCredentials[i]=Object.assign(Object.assign({},l),{id:co(l.id).buffer,type:l.type||"public-key",transports:l.transports})}}return a}function bC(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const r=t;return{id:t.id,rawId:t.id,response:{attestationObject:ga(new Uint8Array(t.response.attestationObject)),clientDataJSON:ga(new Uint8Array(t.response.clientDataJSON))},type:"public-key",clientExtensionResults:t.getClientExtensionResults(),authenticatorAttachment:(e=r.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function wC(t){var e;if("toJSON"in t&&typeof t.toJSON=="function")return t.toJSON();const r=t,s=t.getClientExtensionResults(),n=t.response;return{id:t.id,rawId:t.id,response:{authenticatorData:ga(new Uint8Array(n.authenticatorData)),clientDataJSON:ga(new Uint8Array(n.clientDataJSON)),signature:ga(new Uint8Array(n.signature)),userHandle:n.userHandle?ga(new Uint8Array(n.userHandle)):void 0},type:"public-key",clientExtensionResults:s,authenticatorAttachment:(e=r.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function F0(t){return t==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(t)}function Ig(){var t,e;return!!(Cr()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.create)=="function"&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.get)=="function")}async function SC(t){try{const e=await navigator.credentials.create(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Kc("Browser returned unexpected credential type",e)}:{data:null,error:new Kc("Empty credential response",e)}}catch(e){return{data:null,error:pC({error:e,options:t})}}}async function jC(t){try{const e=await navigator.credentials.get(t);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new Kc("Browser returned unexpected credential type",e)}:{data:null,error:new Kc("Empty credential response",e)}}catch(e){return{data:null,error:gC({error:e,options:t})}}}const CC={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"none"},NC={userVerification:"preferred",hints:["security-key"]};function Yc(...t){const e=n=>n!==null&&typeof n=="object"&&!Array.isArray(n),r=n=>n instanceof ArrayBuffer||ArrayBuffer.isView(n),s={};for(const n of t)if(n)for(const a in n){const i=n[a];if(i!==void 0)if(Array.isArray(i))s[a]=i;else if(r(i))s[a]=i;else if(e(i)){const l=s[a];e(l)?s[a]=Yc(l,i):s[a]=Yc(i)}else s[a]=i}return s}function IC(t,e){return Yc(CC,t,e||{})}function kC(t,e){return Yc(NC,t,e||{})}class EC{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:r,friendlyName:s,signal:n},a){try{const{data:i,error:l}=await this.client.mfa.challenge({factorId:e,webauthn:r});if(!i)return{data:null,error:l};const c=n??yC.createNewAbortSignal();if(i.webauthn.type==="create"){const{user:d}=i.webauthn.credential_options.publicKey;d.name||(d.name=`${d.id}:${s}`),d.displayName||(d.displayName=d.name)}switch(i.webauthn.type){case"create":{const d=IC(i.webauthn.credential_options.publicKey,a==null?void 0:a.create),{data:u,error:h}=await SC({publicKey:d,signal:c});return u?{data:{factorId:e,challengeId:i.id,webauthn:{type:i.webauthn.type,credential_response:u}},error:null}:{data:null,error:h}}case"request":{const d=kC(i.webauthn.credential_options.publicKey,a==null?void 0:a.request),{data:u,error:h}=await jC(Object.assign(Object.assign({},i.webauthn.credential_options),{publicKey:d,signal:c}));return u?{data:{factorId:e,challengeId:i.id,webauthn:{type:i.webauthn.type,credential_response:u}},error:null}:{data:null,error:h}}}}catch(i){return be(i)?{data:null,error:i}:{data:null,error:new da("Unexpected error in challenge",i)}}}async _verify({challengeId:e,factorId:r,webauthn:s}){return this.client.mfa.verify({factorId:r,challengeId:e,webauthn:s})}async _authenticate({factorId:e,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:n}},a){if(!r)return{data:null,error:new Ji("rpId is required for WebAuthn authentication")};try{if(!Ig())return{data:null,error:new da("Browser does not support WebAuthn",null)};const{data:i,error:l}=await this.challenge({factorId:e,webauthn:{rpId:r,rpOrigins:s},signal:n},{request:a});if(!i)return{data:null,error:l};const{webauthn:c}=i;return this._verify({factorId:e,challengeId:i.challengeId,webauthn:{type:c.type,rpId:r,rpOrigins:s,credential_response:c.credential_response}})}catch(i){return be(i)?{data:null,error:i}:{data:null,error:new da("Unexpected error in authenticate",i)}}}async _register({friendlyName:e,rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:n},a){if(!r)return{data:null,error:new Ji("rpId is required for WebAuthn registration")};try{if(!Ig())return{data:null,error:new da("Browser does not support WebAuthn",null)};const{data:i,error:l}=await this._enroll({friendlyName:e});if(!i)return await this.client.mfa.listFactors().then(u=>{var h;return(h=u.data)===null||h===void 0?void 0:h.all.find(f=>f.factor_type==="webauthn"&&f.friendly_name===e&&f.status!=="unverified")}).then(u=>u?this.client.mfa.unenroll({factorId:u==null?void 0:u.id}):void 0),{data:null,error:l};const{data:c,error:d}=await this._challenge({factorId:i.id,friendlyName:i.friendly_name,webauthn:{rpId:r,rpOrigins:s},signal:n},{create:a});return c?this._verify({factorId:i.id,challengeId:c.challengeId,webauthn:{rpId:r,rpOrigins:s,type:c.webauthn.type,credential_response:c.webauthn.credential_response}}):{data:null,error:d}}catch(i){return be(i)?{data:null,error:i}:{data:null,error:new da("Unexpected error in register",i)}}}}uC();const TC={url:Nj,storageKey:Ij,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:kj,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function kg(t,e,r){return await r()}const Pa={};class Ki{get jwks(){var e,r;return(r=(e=Pa[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(e){Pa[this.storageKey]=Object.assign(Object.assign({},Pa[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,r;return(r=(e=Pa[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Pa[this.storageKey]=Object.assign(Object.assign({},Pa[this.storageKey]),{cachedAt:e})}constructor(e){var r,s;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Ki.nextInstanceID,Ki.nextInstanceID+=1,this.instanceID>0&&Cr()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const n=Object.assign(Object.assign({},TC),e);if(this.logDebugMessages=!!n.debug,typeof n.debug=="function"&&(this.logger=n.debug),this.persistSession=n.persistSession,this.storageKey=n.storageKey,this.autoRefreshToken=n.autoRefreshToken,this.admin=new lC({url:n.url,headers:n.headers,fetch:n.fetch}),this.url=n.url,this.headers=n.headers,this.fetch=P0(n.fetch),this.lock=n.lock||kg,this.detectSessionInUrl=n.detectSessionInUrl,this.flowType=n.flowType,this.hasCustomAuthorizationHeader=n.hasCustomAuthorizationHeader,this.throwOnError=n.throwOnError,n.lock?this.lock=n.lock:Cr()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=dC:this.lock=kg,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new EC(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this)},this.persistSession?(n.storage?this.storage=n.storage:R0()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Ng(this.memoryStorage)),n.userStorage&&(this.userStorage=n.userStorage)):(this.memoryStorage={},this.storage=Ng(this.memoryStorage)),Cr()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(a){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",a)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async a=>{this._debug("received broadcast notification from other tab or client",a),await this._notifyAllSubscribers(a.data.event,a.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${A0}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let r={},s="none";if(Cr()&&(r=Hj(window.location.href),this._isImplicitGrantCallback(r)?s="implicit":await this._isPKCECallback(r)&&(s="pkce")),Cr()&&this.detectSessionInUrl&&s!=="none"){const{data:n,error:a}=await this._getSessionFromURL(r,s);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),Mj(a)){const c=(e=a.details)===null||e===void 0?void 0:e.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:a}}return await this._removeSession(),{error:a}}const{session:i,redirectType:l}=n;return this._debug("#_initialize()","detected session in URL",i,"redirect type",l),await this._saveSession(i),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return be(r)?this._returnResult({error:r}):this._returnResult({error:new da("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var r,s,n;try{const a=await Ee(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(r=e==null?void 0:e.options)===null||r===void 0?void 0:r.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.captchaToken}},xform:Ns}),{data:i,error:l}=a;if(l||!i)return this._returnResult({data:{user:null,session:null},error:l});const c=i.session,d=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:d,session:c},error:null})}catch(a){if(be(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signUp(e){var r,s,n;try{let a;if("email"in e){const{email:u,password:h,options:f}=e;let p=null,_=null;this.flowType==="pkce"&&([p,_]=await Da(this.storage,this.storageKey)),a=await Ee(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f==null?void 0:f.emailRedirectTo,body:{email:u,password:h,data:(r=f==null?void 0:f.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:p,code_challenge_method:_},xform:Ns})}else if("phone"in e){const{phone:u,password:h,options:f}=e;a=await Ee(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:h,data:(s=f==null?void 0:f.data)!==null&&s!==void 0?s:{},channel:(n=f==null?void 0:f.channel)!==null&&n!==void 0?n:"sms",gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:Ns})}else throw new Pl("You must provide either an email or phone number and a password");const{data:i,error:l}=a;if(l||!i)return this._returnResult({data:{user:null,session:null},error:l});const c=i.session,d=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:d,session:c},error:null})}catch(a){if(be(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithPassword(e){try{let r;if("email"in e){const{email:a,password:i,options:l}=e;r=await Ee(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:a,password:i,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:jg})}else if("phone"in e){const{phone:a,password:i,options:l}=e;r=await Ee(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:a,password:i,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:jg})}else throw new Pl("You must provide either an email or phone number and a password");const{data:s,error:n}=r;if(n)return this._returnResult({data:{user:null,session:null},error:n});if(!s||!s.session||!s.user){const a=new Aa;return this._returnResult({data:{user:null,session:null},error:a})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:n})}catch(r){if(be(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(e){var r,s,n,a;return await this._handleProviderSignIn(e.provider,{redirectTo:(r=e.options)===null||r===void 0?void 0:r.redirectTo,scopes:(s=e.options)===null||s===void 0?void 0:s.scopes,queryParams:(n=e.options)===null||n===void 0?void 0:n.queryParams,skipBrowserRedirect:(a=e.options)===null||a===void 0?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:r}=e;switch(r){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(e){var r,s,n,a,i,l,c,d,u,h,f;let p,_;if("message"in e)p=e.message,_=e.signature;else{const{chain:v,wallet:x,statement:m,options:g}=e;let y;if(Cr())if(typeof x=="object")y=x;else{const k=window;if("ethereum"in k&&typeof k.ethereum=="object"&&"request"in k.ethereum&&typeof k.ethereum.request=="function")y=k.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof x!="object"||!(g!=null&&g.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");y=x}const w=new URL((r=g==null?void 0:g.url)!==null&&r!==void 0?r:window.location.href),b=await y.request({method:"eth_requestAccounts"}).then(k=>k).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!b||b.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const C=$0(b[0]);let j=(s=g==null?void 0:g.signInWithEthereum)===null||s===void 0?void 0:s.chainId;if(!j){const k=await y.request({method:"eth_chainId"});j=hC(k)}const I={domain:w.host,address:C,statement:m,uri:w.href,version:"1",chainId:j,nonce:(n=g==null?void 0:g.signInWithEthereum)===null||n===void 0?void 0:n.nonce,issuedAt:(i=(a=g==null?void 0:g.signInWithEthereum)===null||a===void 0?void 0:a.issuedAt)!==null&&i!==void 0?i:new Date,expirationTime:(l=g==null?void 0:g.signInWithEthereum)===null||l===void 0?void 0:l.expirationTime,notBefore:(c=g==null?void 0:g.signInWithEthereum)===null||c===void 0?void 0:c.notBefore,requestId:(d=g==null?void 0:g.signInWithEthereum)===null||d===void 0?void 0:d.requestId,resources:(u=g==null?void 0:g.signInWithEthereum)===null||u===void 0?void 0:u.resources};p=mC(I),_=await y.request({method:"personal_sign",params:[fC(p),C]})}try{const{data:v,error:x}=await Ee(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:p,signature:_},!((h=e.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(f=e.options)===null||f===void 0?void 0:f.captchaToken}}:null),xform:Ns});if(x)throw x;if(!v||!v.session||!v.user){const m=new Aa;return this._returnResult({data:{user:null,session:null},error:m})}return v.session&&(await this._saveSession(v.session),await this._notifyAllSubscribers("SIGNED_IN",v.session)),this._returnResult({data:Object.assign({},v),error:x})}catch(v){if(be(v))return this._returnResult({data:{user:null,session:null},error:v});throw v}}async signInWithSolana(e){var r,s,n,a,i,l,c,d,u,h,f,p;let _,v;if("message"in e)_=e.message,v=e.signature;else{const{chain:x,wallet:m,statement:g,options:y}=e;let w;if(Cr())if(typeof m=="object")w=m;else{const C=window;if("solana"in C&&typeof C.solana=="object"&&("signIn"in C.solana&&typeof C.solana.signIn=="function"||"signMessage"in C.solana&&typeof C.solana.signMessage=="function"))w=C.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof m!="object"||!(y!=null&&y.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");w=m}const b=new URL((r=y==null?void 0:y.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in w&&w.signIn){const C=await w.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},y==null?void 0:y.signInWithSolana),{version:"1",domain:b.host,uri:b.href}),g?{statement:g}:null));let j;if(Array.isArray(C)&&C[0]&&typeof C[0]=="object")j=C[0];else if(C&&typeof C=="object"&&"signedMessage"in C&&"signature"in C)j=C;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in j&&"signature"in j&&(typeof j.signedMessage=="string"||j.signedMessage instanceof Uint8Array)&&j.signature instanceof Uint8Array)_=typeof j.signedMessage=="string"?j.signedMessage:new TextDecoder().decode(j.signedMessage),v=j.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in w)||typeof w.signMessage!="function"||!("publicKey"in w)||typeof w!="object"||!w.publicKey||!("toBase58"in w.publicKey)||typeof w.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");_=[`${b.host} wants you to sign in with your Solana account:`,w.publicKey.toBase58(),...g?["",g,""]:[""],"Version: 1",`URI: ${b.href}`,`Issued At: ${(n=(s=y==null?void 0:y.signInWithSolana)===null||s===void 0?void 0:s.issuedAt)!==null&&n!==void 0?n:new Date().toISOString()}`,...!((a=y==null?void 0:y.signInWithSolana)===null||a===void 0)&&a.notBefore?[`Not Before: ${y.signInWithSolana.notBefore}`]:[],...!((i=y==null?void 0:y.signInWithSolana)===null||i===void 0)&&i.expirationTime?[`Expiration Time: ${y.signInWithSolana.expirationTime}`]:[],...!((l=y==null?void 0:y.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${y.signInWithSolana.chainId}`]:[],...!((c=y==null?void 0:y.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${y.signInWithSolana.nonce}`]:[],...!((d=y==null?void 0:y.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${y.signInWithSolana.requestId}`]:[],...!((h=(u=y==null?void 0:y.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||h===void 0)&&h.length?["Resources",...y.signInWithSolana.resources.map(j=>`- ${j}`)]:[]].join(`
`);const C=await w.signMessage(new TextEncoder().encode(_),"utf8");if(!C||!(C instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");v=C}}try{const{data:x,error:m}=await Ee(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:_,signature:ga(v)},!((f=e.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(p=e.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:Ns});if(m)throw m;if(!x||!x.session||!x.user){const g=new Aa;return this._returnResult({data:{user:null,session:null},error:g})}return x.session&&(await this._saveSession(x.session),await this._notifyAllSubscribers("SIGNED_IN",x.session)),this._returnResult({data:Object.assign({},x),error:m})}catch(x){if(be(x))return this._returnResult({data:{user:null,session:null},error:x});throw x}}async _exchangeCodeForSession(e){const r=await Yn(this.storage,`${this.storageKey}-code-verifier`),[s,n]=(r??"").split("/");try{const{data:a,error:i}=await Ee(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:Ns});if(await mn(this.storage,`${this.storageKey}-code-verifier`),i)throw i;if(!a||!a.session||!a.user){const l=new Aa;return this._returnResult({data:{user:null,session:null,redirectType:null},error:l})}return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),this._returnResult({data:Object.assign(Object.assign({},a),{redirectType:n??null}),error:i})}catch(a){if(be(a))return this._returnResult({data:{user:null,session:null,redirectType:null},error:a});throw a}}async signInWithIdToken(e){try{const{options:r,provider:s,token:n,access_token:a,nonce:i}=e,l=await Ee(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:n,access_token:a,nonce:i,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:Ns}),{data:c,error:d}=l;if(d)return this._returnResult({data:{user:null,session:null},error:d});if(!c||!c.session||!c.user){const u=new Aa;return this._returnResult({data:{user:null,session:null},error:u})}return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),this._returnResult({data:c,error:d})}catch(r){if(be(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(e){var r,s,n,a,i;try{if("email"in e){const{email:l,options:c}=e;let d=null,u=null;this.flowType==="pkce"&&([d,u]=await Da(this.storage,this.storageKey));const{error:h}=await Ee(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(r=c==null?void 0:c.data)!==null&&r!==void 0?r:{},create_user:(s=c==null?void 0:c.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:d,code_challenge_method:u},redirectTo:c==null?void 0:c.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:h})}if("phone"in e){const{phone:l,options:c}=e,{data:d,error:u}=await Ee(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(n=c==null?void 0:c.data)!==null&&n!==void 0?n:{},create_user:(a=c==null?void 0:c.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(i=c==null?void 0:c.channel)!==null&&i!==void 0?i:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:d==null?void 0:d.message_id},error:u})}throw new Pl("You must provide either an email or phone number.")}catch(l){if(be(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async verifyOtp(e){var r,s;try{let n,a;"options"in e&&(n=(r=e.options)===null||r===void 0?void 0:r.redirectTo,a=(s=e.options)===null||s===void 0?void 0:s.captchaToken);const{data:i,error:l}=await Ee(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:a}}),redirectTo:n,xform:Ns});if(l)throw l;if(!i)throw new Error("An error occurred on token verification.");const c=i.session,d=i.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),this._returnResult({data:{user:d,session:c},error:null})}catch(n){if(be(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithSSO(e){var r,s,n;try{let a=null,i=null;this.flowType==="pkce"&&([a,i]=await Da(this.storage,this.storageKey));const l=await Ee(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(s=(r=e.options)===null||r===void 0?void 0:r.redirectTo)!==null&&s!==void 0?s:void 0}),!((n=e==null?void 0:e.options)===null||n===void 0)&&n.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:a,code_challenge_method:i}),headers:this.headers,xform:aC});return this._returnResult(l)}catch(a){if(be(a))return this._returnResult({data:null,error:a});throw a}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:r},error:s}=e;if(s)throw s;if(!r)throw new Cs;const{error:n}=await Ee(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:n})})}catch(e){if(be(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const r=`${this.url}/resend`;if("email"in e){const{email:s,type:n,options:a}=e,{error:i}=await Ee(this.fetch,"POST",r,{headers:this.headers,body:{email:s,type:n,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},redirectTo:a==null?void 0:a.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:i})}else if("phone"in e){const{phone:s,type:n,options:a}=e,{data:i,error:l}=await Ee(this.fetch,"POST",r,{headers:this.headers,body:{phone:s,type:n,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:i==null?void 0:i.message_id},error:l})}throw new Pl("You must provide either an email or phone number and a type")}catch(r){if(be(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(e,r){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await s,await r()))();return this.pendingInLock.push((async()=>{try{await n}catch{}})()),n}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=r();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const n=[...this.pendingInLock];await Promise.all(n),this.pendingInLock.splice(0,n.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await e(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const r=await Yn(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?e=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=e.expires_at?e.expires_at*1e3-Date.now()<_u:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.userStorage){const i=await Yn(this.userStorage,this.storageKey+"-user");i!=null&&i.user?e.user=i.user:e.user=xu()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const i={value:this.suppressGetSessionWarning};e.user=tC(e.user,i),i.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:n,error:a}=await this._callRefreshToken(e.refresh_token);return a?this._returnResult({data:{session:null},error:a}):this._returnResult({data:{session:n},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await Ee(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Sn}):await this._useSession(async r=>{var s,n,a;const{data:i,error:l}=r;if(l)throw l;return!(!((s=i.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Cs}:await Ee(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(a=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:void 0,xform:Sn})})}catch(r){if(be(r))return Dj(r)&&(await this._removeSession(),await mn(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(e,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,r))}async _updateUser(e,r={}){try{return await this._useSession(async s=>{const{data:n,error:a}=s;if(a)throw a;if(!n.session)throw new Cs;const i=n.session;let l=null,c=null;this.flowType==="pkce"&&e.email!=null&&([l,c]=await Da(this.storage,this.storageKey));const{data:d,error:u}=await Ee(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:l,code_challenge_method:c}),jwt:i.access_token,xform:Sn});if(u)throw u;return i.user=d.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),this._returnResult({data:{user:i.user},error:null})})}catch(s){if(be(s))return this._returnResult({data:{user:null},error:s});throw s}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Cs;const r=Date.now()/1e3;let s=r,n=!0,a=null;const{payload:i}=vu(e.access_token);if(i.exp&&(s=i.exp,n=s<=r),n){const{data:l,error:c}=await this._callRefreshToken(e.refresh_token);if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!l)return{data:{user:null,session:null},error:null};a=l}else{const{data:l,error:c}=await this._getUser(e.access_token);if(c)throw c;a={access_token:e.access_token,refresh_token:e.refresh_token,user:l.user,token_type:"bearer",expires_in:s-r,expires_at:s},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return this._returnResult({data:{user:a.user,session:a},error:null})}catch(r){if(be(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async r=>{var s;if(!e){const{data:i,error:l}=r;if(l)throw l;e=(s=i.session)!==null&&s!==void 0?s:void 0}if(!(e!=null&&e.refresh_token))throw new Cs;const{data:n,error:a}=await this._callRefreshToken(e.refresh_token);return a?this._returnResult({data:{user:null,session:null},error:a}):n?this._returnResult({data:{user:n.user,session:n},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(be(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(e,r){try{if(!Cr())throw new Ol("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Ol(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new _g("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Ol("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new _g("No code detected.");const{data:g,error:y}=await this._exchangeCodeForSession(e.code);if(y)throw y;const w=new URL(window.location.href);return w.searchParams.delete("code"),window.history.replaceState(window.history.state,"",w.toString()),{data:{session:g.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:n,access_token:a,refresh_token:i,expires_in:l,expires_at:c,token_type:d}=e;if(!a||!l||!i||!d)throw new Ol("No session defined in URL");const u=Math.round(Date.now()/1e3),h=parseInt(l);let f=u+h;c&&(f=parseInt(c));const p=f-u;p*1e3<=Ha&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${p}s, should have been closer to ${h}s`);const _=f-h;u-_>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",_,f,u):u-_<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",_,f,u);const{data:v,error:x}=await this._getUser(a);if(x)throw x;const m={provider_token:s,provider_refresh_token:n,access_token:a,expires_in:h,expires_at:f,refresh_token:i,token_type:d,user:v.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:m,redirectType:e.type},error:null})}catch(s){if(be(s))return this._returnResult({data:{session:null,redirectType:null},error:s});throw s}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const r=await Yn(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&r)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async r=>{var s;const{data:n,error:a}=r;if(a)return this._returnResult({error:a});const i=(s=n.session)===null||s===void 0?void 0:s.access_token;if(i){const{error:l}=await this.admin.signOut(i,e);if(l&&!(Aj(l)&&(l.status===404||l.status===401||l.status===403)))return this._returnResult({error:l})}return e!=="others"&&(await this._removeSession(),await mn(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const r=Vj(),s={id:r,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,s),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async r=>{var s,n;try{const{data:{session:a},error:i}=r;if(i)throw i;await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",a)),this._debug("INITIAL_SESSION","callback id",e,"session",a)}catch(a){await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",a),console.error(a)}})}async resetPasswordForEmail(e,r={}){let s=null,n=null;this.flowType==="pkce"&&([s,n]=await Da(this.storage,this.storageKey,!0));try{return await Ee(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:n,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(a){if(be(a))return this._returnResult({data:null,error:a});throw a}}async getUserIdentities(){var e;try{const{data:r,error:s}=await this.getUser();if(s)throw s;return this._returnResult({data:{identities:(e=r.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(r){if(be(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var r;try{const{data:s,error:n}=await this._useSession(async a=>{var i,l,c,d,u;const{data:h,error:f}=a;if(f)throw f;const p=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(i=e.options)===null||i===void 0?void 0:i.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=e.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await Ee(this.fetch,"GET",p,{headers:this.headers,jwt:(u=(d=h.session)===null||d===void 0?void 0:d.access_token)!==null&&u!==void 0?u:void 0})});if(n)throw n;return Cr()&&!(!((r=e.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(s==null?void 0:s.url),this._returnResult({data:{provider:e.provider,url:s==null?void 0:s.url},error:null})}catch(s){if(be(s))return this._returnResult({data:{provider:e.provider,url:null},error:s});throw s}}async linkIdentityIdToken(e){return await this._useSession(async r=>{var s;try{const{error:n,data:{session:a}}=r;if(n)throw n;const{options:i,provider:l,token:c,access_token:d,nonce:u}=e,h=await Ee(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(s=a==null?void 0:a.access_token)!==null&&s!==void 0?s:void 0,body:{provider:l,id_token:c,access_token:d,nonce:u,link_identity:!0,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},xform:Ns}),{data:f,error:p}=h;return p?this._returnResult({data:{user:null,session:null},error:p}):!f||!f.session||!f.user?this._returnResult({data:{user:null,session:null},error:new Aa}):(f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("USER_UPDATED",f.session)),this._returnResult({data:f,error:p}))}catch(n){if(be(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}})}async unlinkIdentity(e){try{return await this._useSession(async r=>{var s,n;const{data:a,error:i}=r;if(i)throw i;return await Ee(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(n=(s=a.session)===null||s===void 0?void 0:s.access_token)!==null&&n!==void 0?n:void 0})})}catch(r){if(be(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(e){const r=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{const s=Date.now();return await Uj(async n=>(n>0&&await qj(200*Math.pow(2,n-1)),this._debug(r,"refreshing attempt",n),await Ee(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Ns})),(n,a)=>{const i=200*Math.pow(2,n);return a&&yu(a)&&Date.now()+i-s<Ha})}catch(s){if(this._debug(r,"error",s),be(s))return this._returnResult({data:{session:null,user:null},error:s});throw s}finally{this._debug(r,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,r){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",r,"url",s),Cr()&&!r.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e,r;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const n=await Yn(this.storage,this.storageKey);if(n&&this.userStorage){let i=await Yn(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!i&&(i={user:n.user},await za(this.userStorage,this.storageKey+"-user",i)),n.user=(e=i==null?void 0:i.user)!==null&&e!==void 0?e:xu()}else if(n&&!n.user&&!n.user){const i=await Yn(this.storage,this.storageKey+"-user");i&&(i!=null&&i.user)?(n.user=i.user,await mn(this.storage,this.storageKey+"-user"),await za(this.storage,this.storageKey,n)):n.user=xu()}if(this._debug(s,"session from storage",n),!this._isValidSession(n)){this._debug(s,"session is not valid"),n!==null&&await this._removeSession();return}const a=((r=n.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<_u;if(this._debug(s,`session has${a?"":" not"} expired with margin of ${_u}s`),a){if(this.autoRefreshToken&&n.refresh_token){const{error:i}=await this._callRefreshToken(n.refresh_token);i&&(console.error(i),yu(i)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else if(n.user&&n.user.__isUserNotAvailableProxy===!0)try{const{data:i,error:l}=await this._getUser(n.access_token);!l&&(i!=null&&i.user)?(n.user=i.user,await this._saveSession(n),await this._notifyAllSubscribers("SIGNED_IN",n)):this._debug(s,"could not get user data, skipping SIGNED_IN notification")}catch(i){console.error("Error getting user data:",i),this._debug(s,"error getting user data, skipping SIGNED_IN notification",i)}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(s,"error",n),console.error(n);return}finally{this._debug(s,"end")}}async _callRefreshToken(e){var r,s;if(!e)throw new Cs;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new Ad;const{data:a,error:i}=await this._refreshAccessToken(e);if(i)throw i;if(!a.session)throw new Cs;await this._saveSession(a.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",a.session);const l={data:a.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(a){if(this._debug(n,"error",a),be(a)){const i={data:null,error:a};return yu(a)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(i),i}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(a),a}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(e,r,s=!0){const n=`#_notifyAllSubscribers(${e})`;this._debug(n,"begin",r,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:r});const a=[],i=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(e,r)}catch(c){a.push(c)}});if(await Promise.all(i),a.length>0){for(let l=0;l<a.length;l+=1)console.error(a[l]);throw a[0]}}finally{this._debug(n,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const r=Object.assign({},e),s=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!s&&r.user&&await za(this.userStorage,this.storageKey+"-user",{user:r.user});const n=Object.assign({},r);delete n.user;const a=wg(n);await za(this.storage,this.storageKey,a)}else{const n=wg(r);await za(this.storage,this.storageKey,n)}}async _removeSession(){this._debug("#_removeSession()"),await mn(this.storage,this.storageKey),await mn(this.storage,this.storageKey+"-code-verifier"),await mn(this.storage,this.storageKey+"-user"),this.userStorage&&await mn(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Cr()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Ha);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async r=>{const{data:{session:s}}=r;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const n=Math.floor((s.expires_at*1e3-e)/Ha);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts ${Ha}ms, refresh threshold is ${Uh} ticks`),n<=Uh&&await this._callRefreshToken(s.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof O0)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Cr()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const r=`#_onVisibilityChanged(${e})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,r,s){const n=[`provider=${encodeURIComponent(r)}`];if(s!=null&&s.redirectTo&&n.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s!=null&&s.scopes&&n.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[a,i]=await Da(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(i)}`});n.push(l.toString())}if(s!=null&&s.queryParams){const a=new URLSearchParams(s.queryParams);n.push(a.toString())}return s!=null&&s.skipBrowserRedirect&&n.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${n.join("&")}`}async _unenroll(e){try{return await this._useSession(async r=>{var s;const{data:n,error:a}=r;return a?this._returnResult({data:null,error:a}):await Ee(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(s=n==null?void 0:n.session)===null||s===void 0?void 0:s.access_token})})}catch(r){if(be(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(e){try{return await this._useSession(async r=>{var s,n;const{data:a,error:i}=r;if(i)return this._returnResult({data:null,error:i});const l=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:c,error:d}=await Ee(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(s=a==null?void 0:a.session)===null||s===void 0?void 0:s.access_token});return d?this._returnResult({data:null,error:d}):(e.factorType==="totp"&&c.type==="totp"&&(!((n=c==null?void 0:c.totp)===null||n===void 0)&&n.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),this._returnResult({data:c,error:null}))})}catch(r){if(be(r))return this._returnResult({data:null,error:r});throw r}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var s;const{data:n,error:a}=r;if(a)return this._returnResult({data:null,error:a});const i=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?bC(e.webauthn.credential_response):wC(e.webauthn.credential_response)})}:{code:e.code}),{data:l,error:c}=await Ee(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:i,headers:this.headers,jwt:(s=n==null?void 0:n.session)===null||s===void 0?void 0:s.access_token});return c?this._returnResult({data:null,error:c}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),this._returnResult({data:l,error:c}))})}catch(r){if(be(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var s;const{data:n,error:a}=r;if(a)return this._returnResult({data:null,error:a});const i=await Ee(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(s=n==null?void 0:n.session)===null||s===void 0?void 0:s.access_token});if(i.error)return i;const{data:l}=i;if(l.type!=="webauthn")return{data:l,error:null};switch(l.webauthn.type){case"create":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:vC(l.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:xC(l.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(be(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(e){const{data:r,error:s}=await this._challenge({factorId:e.factorId});return s?this._returnResult({data:null,error:s}):await this._verify({factorId:e.factorId,challengeId:r.id,code:e.code})}async _listFactors(){var e;const{data:{user:r},error:s}=await this.getUser();if(s)return{data:null,error:s};const n={all:[],phone:[],totp:[],webauthn:[]};for(const a of(e=r==null?void 0:r.factors)!==null&&e!==void 0?e:[])n.all.push(a),a.status==="verified"&&n[a.factor_type].push(a);return{data:n,error:null}}async _getAuthenticatorAssuranceLevel(){var e,r;const{data:{session:s},error:n}=await this.getSession();if(n)return this._returnResult({data:null,error:n});if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:a}=vu(s.access_token);let i=null;a.aal&&(i=a.aal);let l=i;((r=(e=s.user.factors)===null||e===void 0?void 0:e.filter(u=>u.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(l="aal2");const d=a.amr||[];return{data:{currentLevel:i,nextLevel:l,currentAuthenticationMethods:d},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async r=>{const{data:{session:s},error:n}=r;return n?this._returnResult({data:null,error:n}):s?await Ee(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:s.access_token,xform:a=>({data:a,error:null})}):this._returnResult({data:null,error:new Cs})})}catch(r){if(be(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(e,r){try{return await this._useSession(async s=>{const{data:{session:n},error:a}=s;if(a)return this._returnResult({data:null,error:a});if(!n)return this._returnResult({data:null,error:new Cs});const i=await Ee(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:n.access_token,body:{action:"approve"},xform:l=>({data:l,error:null})});return i.data&&i.data.redirect_url&&Cr()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(i.data.redirect_url),i})}catch(s){if(be(s))return this._returnResult({data:null,error:s});throw s}}async _denyAuthorization(e,r){try{return await this._useSession(async s=>{const{data:{session:n},error:a}=s;if(a)return this._returnResult({data:null,error:a});if(!n)return this._returnResult({data:null,error:new Cs});const i=await Ee(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:n.access_token,body:{action:"deny"},xform:l=>({data:l,error:null})});return i.data&&i.data.redirect_url&&Cr()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(i.data.redirect_url),i})}catch(s){if(be(s))return this._returnResult({data:null,error:s});throw s}}async fetchJwk(e,r={keys:[]}){let s=r.keys.find(l=>l.kid===e);if(s)return s;const n=Date.now();if(s=this.jwks.keys.find(l=>l.kid===e),s&&this.jwks_cached_at+Tj>n)return s;const{data:a,error:i}=await Ee(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;return!a.keys||a.keys.length===0||(this.jwks=a,this.jwks_cached_at=n,s=a.keys.find(l=>l.kid===e),!s)?null:s}async getClaims(e,r={}){try{let s=e;if(!s){const{data:p,error:_}=await this.getSession();if(_||!p.session)return this._returnResult({data:null,error:_});s=p.session.access_token}const{header:n,payload:a,signature:i,raw:{header:l,payload:c}}=vu(s);r!=null&&r.allowExpired||Zj(a.exp);const d=!n.alg||n.alg.startsWith("HS")||!n.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(n.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!d){const{error:p}=await this.getUser(s);if(p)throw p;return{data:{claims:a,header:n,signature:i},error:null}}const u=Xj(n.alg),h=await crypto.subtle.importKey("jwk",d,u,!0,["verify"]);if(!await crypto.subtle.verify(u,h,i,Fj(`${l}.${c}`)))throw new Jh("Invalid JWT signature");return{data:{claims:a,header:n,signature:i},error:null}}catch(s){if(be(s))return this._returnResult({data:null,error:s});throw s}}}Ki.nextInstanceID=0;const LC=Ki;class AC extends LC{constructor(e){super(e)}}class DC{constructor(e,r,s){var n,a,i;this.supabaseUrl=e,this.supabaseKey=r;const l=Cj(e);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,d={db:_j,realtime:vj,auth:Object.assign(Object.assign({},yj),{storageKey:c}),global:gj},u=jj(s??{},d);this.storageKey=(n=u.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(a=u.global.headers)!==null&&a!==void 0?a:{},u.accessToken?(this.accessToken=u.accessToken,this.auth=new Proxy({},{get:(h,f)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(f)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((i=u.auth)!==null&&i!==void 0?i:{},this.headers,u.global.fetch),this.fetch=wj(r,this._getAccessToken.bind(this),u.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},u.realtime)),this.rest=new NS(new URL("rest/v1",l).href,{headers:this.headers,schema:u.db.schema,fetch:this.fetch}),this.storage=new fj(this.storageUrl.href,this.headers,this.fetch,s==null?void 0:s.storage),u.accessToken||this._listenForAuthEvents()}get functions(){return new SS(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,r={},s={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,r,s)}channel(e,r={config:{}}){return this.realtime.channel(e,r)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e,r;if(this.accessToken)return await this.accessToken();const{data:s}=await this.auth.getSession();return(r=(e=s.session)===null||e===void 0?void 0:e.access_token)!==null&&r!==void 0?r:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:r,detectSessionInUrl:s,storage:n,userStorage:a,storageKey:i,flowType:l,lock:c,debug:d,throwOnError:u},h,f){const p={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new AC({url:this.authUrl.href,headers:Object.assign(Object.assign({},p),h),storageKey:i,autoRefreshToken:e,persistSession:r,detectSessionInUrl:s,storage:n,userStorage:a,flowType:l,lock:c,debug:d,throwOnError:u,fetch:f,hasCustomAuthorizationHeader:Object.keys(this.headers).some(_=>_.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new zS(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,s)=>{this._handleTokenChanged(r,"CLIENT",s==null?void 0:s.access_token)})}_handleTokenChanged(e,r,s){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==s?(this.changedAccessToken=s,this.realtime.setAuth(s)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const MC=(t,e,r)=>new DC(t,e,r);function RC(){if(typeof window<"u"||typeof process>"u")return!1;const t=process.version;if(t==null)return!1;const e=t.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}RC()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const PC="https://atkekzwgukdvucqntryo.supabase.co",OC="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImF0a2VrendndWtkdnVjcW50cnlvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDI4OTQwMjIsImV4cCI6MjA1ODQ3MDAyMn0.G4WqAmLvQSqYEfMWIpFOAZOYtnT0kxCxj8dVGhuUYO8",ha=class ha{constructor(){W(this,"client");this.client=MC(PC,OC,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0,storage:window.localStorage}}),console.log("Supabase initialized successfully with persistence")}static getInstance(){return ha.instance||(ha.instance=new ha),ha.instance}getClient(){return this.client}get auth(){return this.client.auth}from(e){return this.client.from(e)}async rpc(e,r){const{data:s,error:n}=await this.client.rpc(e,r);if(n)throw n;return s}};W(ha,"instance");let bo=ha;class B0{constructor(){W(this,"supabase");this.supabase=bo.getInstance().getClient()}async signIn(e,r){try{const{data:s,error:n}=await this.supabase.auth.signInWithPassword({email:e,password:r});if(n)throw n;return{success:!0,user:s.user,session:s.session}}catch(s){return console.error("Login error:",s),{success:!1,error:s instanceof Error?s.message:"Unknown error"}}}async signUp(e,r,s={}){try{const{data:n,error:a}=await this.supabase.auth.signUp({email:e,password:r,options:{data:s}});if(a)throw a;return{success:!0,user:n.user,session:n.session}}catch(n){return console.error("Signup error:",n),{success:!1,error:n instanceof Error?n.message:"Unknown error"}}}async signOut(){try{const{error:e}=await this.supabase.auth.signOut();return e&&console.warn("Supabase signout error:",e),localStorage.removeItem("user"),localStorage.removeItem("session"),localStorage.removeItem("companyChoosen"),localStorage.removeItem("storeChoosen"),sessionStorage.clear(),{success:!0}}catch(e){return console.error("Logout error:",e),localStorage.removeItem("user"),localStorage.removeItem("session"),localStorage.removeItem("companyChoosen"),localStorage.removeItem("storeChoosen"),sessionStorage.clear(),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}async getCurrentUser(){try{const{data:{session:e}}=await this.supabase.auth.getSession();if(!e)return{success:!0,user:null};const{data:{user:r},error:s}=await this.supabase.auth.getUser();if(s)throw s;return{success:!0,user:r}}catch(e){return console.error("Get user error:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error",user:null}}}async getCurrentSession(){try{const{data:{session:e},error:r}=await this.supabase.auth.getSession();if(r)throw r;return{success:!0,session:e}}catch(e){return console.error("Get session error:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}onAuthStateChange(e){return this.supabase.auth.onAuthStateChange((r,s)=>{e(r,s)})}async resetPassword(e){try{const r=`${window.location.origin}/auth/reset-password`,{error:s}=await this.supabase.auth.resetPasswordForEmail(e,{redirectTo:r});if(s)throw s;return{success:!0}}catch(r){return console.error("Reset password error:",r),{success:!1,error:r instanceof Error?r.message:"Unknown error"}}}}class V0{constructor(){W(this,"supabase");this.supabase=bo.getInstance().getClient()}async uploadImage(e,r,s,n){try{let a;typeof s=="string"?a=await(await fetch(s)).blob():a=s;const{data:i,error:l}=await this.supabase.storage.from(e).upload(r,a,{cacheControl:"3600",upsert:(n==null?void 0:n.upsert)??!1});if(l)return console.error("Upload error:",l),{success:!1,error:l.message};const{data:{publicUrl:c}}=this.supabase.storage.from(e).getPublicUrl(r);return{success:!0,data:c}}catch(a){return console.error("Upload error:",a),{success:!1,error:a instanceof Error?a.message:"Unknown error"}}}async deleteImage(e,r){try{const{error:s}=await this.supabase.storage.from(e).remove([r]);return s?(console.error("Delete error:",s),{success:!1,error:s.message}):{success:!0}}catch(s){return console.error("Delete error:",s),{success:!1,error:s instanceof Error?s.message:"Unknown error"}}}getPublicUrl(e,r){const{data:{publicUrl:s}}=this.supabase.storage.from(e).getPublicUrl(r);return s}}class H0{constructor(){W(this,"supabase");this.supabase=bo.getInstance().getClient()}async getUserCompaniesAndStores(){try{const{data:e,error:r}=await this.supabase.rpc("get_user_companies_and_stores");if(r)throw r;return{success:!0,data:e}}catch(e){return console.error("Get companies error:",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}async getCategoriesWithFeatures(e){try{const{data:r,error:s}=await this.supabase.rpc("get_categories_with_features",{p_company_id:e});if(s)throw s;return{success:!0,data:r}}catch(r){return console.error("Get categories error:",r),{success:!1,error:r instanceof Error?r.message:"Unknown error"}}}async query(e,r={}){try{let s=this.supabase.from(e).select(r.select||"*");r.filters&&Object.entries(r.filters).forEach(([i,l])=>{s=s.eq(i,l)}),r.orderBy&&(s=s.order(r.orderBy.column,{ascending:r.orderBy.ascending!==!1})),r.limit&&(s=s.limit(r.limit));const{data:n,error:a}=await s;if(a)throw a;return{success:!0,data:n}}catch(s){return console.error("Query error:",s),{success:!1,error:s instanceof Error?s.message:"Unknown error"}}}}const se=bo.getInstance(),yn=new B0;new H0;const cm=new V0,$C=Object.freeze(Object.defineProperty({__proto__:null,AuthService:B0,DatabaseService:H0,StorageService:V0,authService:yn,storageService:cm,supabaseService:se},Symbol.toStringTag,{value:"Module"})),z0=S.createContext(void 0),FC=({children:t})=>{var _;const[e,r]=S.useState(null),[s,n]=S.useState(null),[a,i]=S.useState([]),[l,c]=S.useState(null),[d,u]=S.useState([]),h=async()=>{var v;try{const{data:{session:x},error:m}=await se.getClient().auth.getSession();if(m||!x)return;const{data:g,error:y}=await se.getClient().rpc("get_user_companies_and_stores",{p_user_id:x.user.id});if(y){console.error("Failed to load user companies:",y);return}if(g&&(localStorage.setItem("user",JSON.stringify(g)),g.user_id&&g.email?c({user_id:g.user_id,email:g.email,name:g.name||g.email}):c({user_id:x.user.id,email:x.user.email||"",name:((v=x.user.user_metadata)==null?void 0:v.name)||x.user.email||""})),g&&g.companies&&g.companies.length>0){i(g.companies);const w=localStorage.getItem("companyChoosen");let b=g.companies[0];if(w){const C=g.companies.find(j=>j.company_id===w);C&&(b=C)}if(r(b),localStorage.setItem("companyChoosen",b.company_id),b.stores&&b.stores.length>0){const C=b.stores[0];n(C),localStorage.setItem("storeChoosen",C.store_id)}}else i([])}catch(x){console.error("Error loading user data:",x)}},f=async()=>{try{const{data:{session:v},error:x}=await se.getClient().auth.getSession();if(x||!v)return;const m=localStorage.getItem("categoryFeatures");if(m)try{const w=JSON.parse(m);u(w)}catch(w){console.error("Failed to parse stored category features:",w)}const{data:g,error:y}=await se.getClient().rpc("get_categories_with_features");if(y){console.error("Failed to load category features:",y);return}g&&(localStorage.setItem("categoryFeatures",JSON.stringify(g)),u(g))}catch(v){console.error("Error loading category features:",v)}};S.useEffect(()=>{(async()=>{var m;const{data:{session:x}}=await se.getClient().auth.getSession();if(x){const g=localStorage.getItem("companyChoosen"),y=localStorage.getItem("storeChoosen"),w=localStorage.getItem("user");if(g&&w)try{const b=JSON.parse(w);if(b.user_id&&b.email?c({user_id:b.user_id,email:b.email,name:b.name||b.email}):x&&c({user_id:x.user.id,email:x.user.email||"",name:((m=x.user.user_metadata)==null?void 0:m.name)||x.user.email||""}),b.companies&&b.companies.length>0){i(b.companies);const C=b.companies.find(j=>j.company_id===g);if(C){if(r(C),y&&C.stores&&C.stores.length>0){const j=C.stores.find(I=>I.store_id===y);j?n(j):C.stores.length>0&&n(C.stores[0])}}else{const j=b.companies[0];r(j),j.stores&&j.stores.length>0&&n(j.stores[0])}}}catch(b){console.error("Failed to parse stored user data:",b)}await h(),await f()}})()},[]);const p={currentCompany:e,currentStore:s,companies:a,currentUser:l,categoryFeatures:d,permissions:((_=e==null?void 0:e.role)==null?void 0:_.permissions)||[],setCurrentCompany:r,setCurrentStore:n,setCurrentUser:c,loadUserData:h,loadCategoryFeatures:f};return o.jsx(z0.Provider,{value:p,children:t})},ht=()=>{const t=S.useContext(z0);if(!t)throw new Error("useAppState must be used within AppStateProvider");return t},Eg=t=>{let e;const r=new Set,s=(d,u)=>{const h=typeof d=="function"?d(e):d;if(!Object.is(h,e)){const f=e;e=u??(typeof h!="object"||h===null)?h:Object.assign({},e,h),r.forEach(p=>p(e,f))}},n=()=>e,l={setState:s,getState:n,getInitialState:()=>c,subscribe:d=>(r.add(d),()=>r.delete(d))},c=e=t(s,n,l);return l},BC=t=>t?Eg(t):Eg,VC=t=>t;function HC(t,e=VC){const r=Kr.useSyncExternalStore(t.subscribe,Kr.useCallback(()=>e(t.getState()),[t,e]),Kr.useCallback(()=>e(t.getInitialState()),[t,e]));return Kr.useDebugValue(r),r}const Tg=t=>{const e=BC(t),r=s=>HC(e,s);return Object.assign(r,e),r},er=t=>t?Tg(t):Tg,zC="modulepreload",qC=function(t){return"/"+t},Lg={},dm=function(e,r,s){let n=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),l=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));n=Promise.allSettled(r.map(c=>{if(c=qC(c),c in Lg)return;Lg[c]=!0;const d=c.endsWith(".css"),u=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${u}`))return;const h=document.createElement("link");if(h.rel=d?"stylesheet":zC,d||(h.as="script"),h.crossOrigin="",h.href=c,l&&h.setAttribute("nonce",l),document.head.appendChild(h),d)return new Promise((f,p)=>{h.addEventListener("load",f),h.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${c}`)))})}))}function a(i){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=i,window.dispatchEvent(l),!l.defaultPrevented)throw i}return n.then(i=>{for(const l of i||[])l.status==="rejected"&&a(l.reason);return e().catch(a)})};class q0{async signIn(e,r){return await yn.signIn(e,r)}async signUp(e,r,s,n,a){let i;try{i=Intl.DateTimeFormat().resolvedOptions().timeZone||"Asia/Ho_Chi_Minh",(i.startsWith("+")||i.startsWith("-")||i.length<3)&&(i="Asia/Ho_Chi_Minh")}catch(c){i="Asia/Ho_Chi_Minh",console.warn(" Failed to detect timezone, using default:",c)}const l=await yn.signUp(e,r,{first_name:s,last_name:n,full_name:`${s} ${n}`,preferred_timezone:i,...a});if(!l.user)return l;try{const{supabaseService:c}=await dm(async()=>{const{supabaseService:u}=await Promise.resolve().then(()=>$C);return{supabaseService:u}},void 0),d=new Date().toISOString();await c.from("users").upsert({user_id:l.user.id,email:e,first_name:s,last_name:n,preferred_timezone:i,created_at:d,updated_at:d},{onConflict:"user_id"})}catch(c){console.error(" ERROR: Failed to create user profile for",l.user.id),console.error("Error:",c)}return l}async signOut(){return await yn.signOut()}async getCurrentUser(){return await yn.getCurrentUser()}async getCurrentSession(){return await yn.getCurrentSession()}async resetPassword(e){return await yn.resetPassword(e)}onAuthStateChange(e){return yn.onAuthStateChange(e)}}class Qc{constructor(e,r,s,n,a,i,l,c={},d=null,u=null,h="Asia/Ho_Chi_Minh",f=!1,p=null){this.id=e,this.email=r,this.firstName=s,this.lastName=n,this.emailConfirmed=a,this.createdAt=i,this.lastSignIn=l,this.metadata=c,this.userPhoneNumber=d,this.profileImage=u,this.preferredTimezone=h,this.isDeleted=f,this.updatedAt=p}get displayName(){return this.firstName&&this.lastName?`${this.firstName} ${this.lastName}`:this.metadata.full_name||this.email.split("@")[0]}get initials(){return this.firstName&&this.lastName?`${this.firstName[0]}${this.lastName[0]}`.toUpperCase():this.metadata.full_name?this.metadata.full_name.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2):this.email.slice(0,2).toUpperCase()}get isEmailVerified(){return this.emailConfirmed}static create(e){return new Qc(e.id,e.email,e.firstName||null,e.lastName||null,e.emailConfirmed,e.createdAt instanceof Date?e.createdAt:new Date(e.createdAt),e.lastSignIn?e.lastSignIn instanceof Date?e.lastSignIn:new Date(e.lastSignIn):null,e.metadata||{},e.userPhoneNumber||null,e.profileImage||null,e.preferredTimezone||"Asia/Ho_Chi_Minh",e.isDeleted||!1,e.updatedAt?e.updatedAt instanceof Date?e.updatedAt:new Date(e.updatedAt):null)}}class yc{static fromSupabase(e){var r,s,n,a,i;return Qc.create({id:e.id,email:e.email,firstName:((r=e.user_metadata)==null?void 0:r.first_name)||null,lastName:((s=e.user_metadata)==null?void 0:s.last_name)||null,emailConfirmed:e.email_confirmed_at!==null,createdAt:e.created_at,lastSignIn:e.last_sign_in_at,metadata:e.user_metadata||{},userPhoneNumber:((n=e.user_metadata)==null?void 0:n.user_phone_number)||null,profileImage:((a=e.user_metadata)==null?void 0:a.profile_image)||null,preferredTimezone:((i=e.user_metadata)==null?void 0:i.preferred_timezone)||"Asia/Ho_Chi_Minh",isDeleted:!1,updatedAt:e.updated_at||null})}static fromUsersTable(e){return Qc.create({id:e.user_id,email:e.email,firstName:e.first_name,lastName:e.last_name,emailConfirmed:e.email_confirmed_at!==null,createdAt:e.created_at,lastSignIn:e.last_sign_in_at||null,metadata:{},userPhoneNumber:e.user_phone_number||null,profileImage:e.profile_image||null,preferredTimezone:e.preferred_timezone||"Asia/Ho_Chi_Minh",isDeleted:e.is_deleted||!1,updatedAt:e.updated_at||null})}static toInsertMap(e){const r={user_id:e.id,email:e.email,created_at:e.createdAt.toISOString(),updated_at:new Date().toISOString()};return e.firstName&&(r.first_name=e.firstName),e.lastName&&(r.last_name=e.lastName),e.userPhoneNumber&&(r.user_phone_number=e.userPhoneNumber),e.profileImage&&(r.profile_image=e.profileImage),e.preferredTimezone&&(r.preferred_timezone=e.preferredTimezone),r}static toJson(e){var r,s;return{id:e.id,email:e.email,first_name:e.firstName,last_name:e.lastName,email_confirmed:e.emailConfirmed,created_at:e.createdAt.toISOString(),last_sign_in_at:((r=e.lastSignIn)==null?void 0:r.toISOString())||null,metadata:e.metadata,user_phone_number:e.userPhoneNumber,profile_image:e.profileImage,preferred_timezone:e.preferredTimezone,is_deleted:e.isDeleted,updated_at:((s=e.updatedAt)==null?void 0:s.toISOString())||null}}static toUpdateMap(e){const r={updated_at:new Date().toISOString()};return e.firstName&&(r.first_name=e.firstName),e.lastName&&(r.last_name=e.lastName),e.userPhoneNumber&&(r.user_phone_number=e.userPhoneNumber),e.profileImage&&(r.profile_image=e.profileImage),e.preferredTimezone&&(r.preferred_timezone=e.preferredTimezone),r}}class UC{constructor(){W(this,"dataSource");this.dataSource=new q0}async signIn(e){try{const r=await this.dataSource.signIn(e.email,e.password);return!r.success||!r.user?{success:!1,error:r.error||"Login failed"}:(e.rememberMe!==void 0&&localStorage.setItem("rememberMe",e.rememberMe?"true":"false"),{success:!0,user:yc.fromSupabase(r.user)})}catch(r){return{success:!1,error:r instanceof Error?r.message:"An unexpected error occurred"}}}async signUp(e){try{const r=await this.dataSource.signUp(e.email,e.password,e.firstName,e.lastName,e.metadata);return!r.success||!r.user?{success:!1,error:r.error||"Signup failed"}:{success:!0,user:yc.fromSupabase(r.user)}}catch(r){return{success:!1,error:r instanceof Error?r.message:"An unexpected error occurred"}}}async signOut(){try{return await this.dataSource.signOut()}catch(e){return{success:!1,error:e instanceof Error?e.message:"Sign out failed"}}}async getCurrentUser(){try{const e=await this.dataSource.getCurrentUser();return!e.success||!e.user?null:yc.fromSupabase(e.user)}catch(e){return console.error("Get current user error:",e),null}}async isAuthenticated(){try{const e=await this.dataSource.getCurrentSession();return e.success&&e.session!==null}catch{return!1}}async resetPassword(e){try{return await this.dataSource.resetPassword(e)}catch(r){return{success:!1,error:r instanceof Error?r.message:"Password reset failed"}}}}class Ag{static validateEmail(e){return!e||e.trim()===""?{field:"email",message:"Email is required"}:/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)?null:{field:"email",message:"Invalid email format"}}static validatePassword(e){return!e||e.trim()===""?{field:"password",message:"Password is required"}:e.length<6?{field:"password",message:"Password must be at least 6 characters"}:null}static validatePasswordConfirmation(e,r){return e!==r?{field:"passwordConfirmation",message:"Passwords do not match"}:null}static validateName(e,r){return!e||e.trim()===""?{field:r.toLowerCase().replace(" ",""),message:`${r} is required`}:e.trim().length<2?{field:r.toLowerCase().replace(" ",""),message:`${r} must be at least 2 characters`}:null}static validateLoginCredentials(e,r){const s=[],n=this.validateEmail(e);n&&s.push(n);const a=this.validatePassword(r);return a&&s.push(a),s}static validateSignupCredentials(e,r,s,n,a){const i=[],l=this.validateEmail(e);l&&i.push(l);const c=this.validatePassword(r);c&&i.push(c);const d=this.validatePasswordConfirmation(r,s);d&&i.push(d);const u=this.validateName(n,"First name");u&&i.push(u);const h=this.validateName(a,"Last name");return h&&i.push(h),i}}const $l=new UC,Fl=new q0,hr=er((t,e)=>({user:null,loading:!0,authenticated:!1,error:null,sessionId:null,loginLoading:!1,loginError:null,loginFieldErrors:{},registerLoading:!1,registerError:null,registerFieldErrors:{},setUser:r=>t({user:r}),setLoading:r=>t({loading:r}),setAuthenticated:r=>t({authenticated:r}),setError:r=>t({error:r}),setSessionId:r=>t({sessionId:r}),reset:()=>t({user:null,authenticated:!1,error:null,sessionId:null,loginLoading:!1,loginError:null,loginFieldErrors:{},registerLoading:!1,registerError:null,registerFieldErrors:{}}),checkAuth:async()=>{var r;t({loading:!0,error:null});try{const s=await $l.getCurrentUser(),a=((r=(await Fl.getCurrentSession()).session)==null?void 0:r.access_token)||null;t({user:s,authenticated:s!==null,sessionId:a,loading:!1})}catch(s){console.error("Auth check error:",s),t({user:null,authenticated:!1,sessionId:null,error:s instanceof Error?s.message:"Authentication check failed",loading:!1})}},login:async(r,s,n=!1)=>{var a;t({loginLoading:!0,loginError:null,loginFieldErrors:{}});try{const i=Ag.validateLoginCredentials(r,s);if(i.length>0){const c={};return i.forEach(d=>{c[d.field]=d.message}),t({loginFieldErrors:c,loginLoading:!1}),{success:!1,error:"Validation failed"}}const l=await $l.signIn({email:r,password:s,rememberMe:n});if(l.success&&l.user){const d=((a=(await Fl.getCurrentSession()).session)==null?void 0:a.access_token)||null;return t({user:l.user,authenticated:!0,sessionId:d,loginLoading:!1,loginError:null,loginFieldErrors:{}}),{success:!0}}else return t({loginError:l.error||"Login failed. Please try again.",loginLoading:!1}),{success:!1,error:l.error||"Login failed. Please try again."}}catch(i){const l=i instanceof Error?i.message:"An unexpected error occurred";return t({loginError:l,loginLoading:!1}),{success:!1,error:l}}},register:async(r,s,n,a,i)=>{var l;t({registerLoading:!0,registerError:null,registerFieldErrors:{}});try{const c=Ag.validateSignupCredentials(r,s,n,a,i);if(c.length>0){const u={};return c.forEach(h=>{u[h.field]=h.message}),t({registerFieldErrors:u,registerLoading:!1}),{success:!1,error:"Validation failed"}}const d=await $l.signUp({email:r,password:s,firstName:a,lastName:i});if(d.success&&d.user){const h=((l=(await Fl.getCurrentSession()).session)==null?void 0:l.access_token)||null;return t({user:d.user,authenticated:!0,sessionId:h,registerLoading:!1,registerError:null,registerFieldErrors:{}}),{success:!0}}else return t({registerError:d.error||"Registration failed. Please try again.",registerLoading:!1}),{success:!1,error:d.error||"Registration failed. Please try again."}}catch(c){const d=c instanceof Error?c.message:"An unexpected error occurred";return t({registerError:d,registerLoading:!1}),{success:!1,error:d}}},signOut:async()=>{t({loading:!0,error:null});try{const r=await $l.signOut();return r.success?(e().reset(),t({loading:!1}),{success:!0}):(t({error:r.error||"Sign out failed",loading:!1}),{success:!1,error:r.error})}catch(r){const s=r instanceof Error?r.message:"Sign out failed";return t({error:s,loading:!1}),{success:!1,error:s}}},refreshAuth:async()=>{await e().checkAuth()},subscribeToAuthChanges:()=>{const{data:r}=Fl.onAuthStateChange(async(s,n)=>{if(console.log("Auth state changed:",s),s==="SIGNED_IN"||s==="TOKEN_REFRESHED"||s==="USER_UPDATED"){if(n!=null&&n.user){const a=yc.fromSupabase(n.user);t({user:a,authenticated:!0,sessionId:n.access_token,error:null})}}else s==="SIGNED_OUT"&&e().reset()});return{unsubscribe:()=>{var s;(s=r==null?void 0:r.subscription)==null||s.unsubscribe()}}}})),WC=({children:t})=>{const e=hr(s=>s.checkAuth),r=hr(s=>s.subscribeToAuthChanges);return S.useEffect(()=>{e();const{unsubscribe:s}=r();return()=>{s()}},[]),o.jsx(o.Fragment,{children:t})},dl=()=>{const t=hr(c=>c.user),e=hr(c=>c.loading),r=hr(c=>c.authenticated),s=hr(c=>c.error),n=hr(c=>c.sessionId),a=hr(c=>c.checkAuth),i=hr(c=>c.signOut),l=hr(c=>c.refreshAuth);return{user:t,loading:e,authenticated:r,error:s,sessionId:n,signOut:i,refreshAuth:l,checkAuth:a}},GC="_backdrop_w92d8_7",JC="_backdropClosing_w92d8_22",KC="_dialog_w92d8_27",YC="_dialogClosing_w92d8_44",QC="_iconContainer_w92d8_49",ZC="_title_w92d8_62",XC="_message_w92d8_72",eN="_buttonContainer_w92d8_88",tN="_confirmButton_w92d8_95",rN="_cancelButton_w92d8_96",$s={backdrop:GC,backdropClosing:JC,dialog:KC,dialogClosing:YC,iconContainer:QC,title:ZC,message:XC,buttonContainer:eN,confirmButton:tN,cancelButton:rN},sN={error:o.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 48 48",fill:"none",children:[o.jsx("circle",{cx:"24",cy:"24",r:"20",fill:"currentColor",opacity:"0.1"}),o.jsx("path",{d:"M24 14v12m0 4h.01",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round"})]}),warning:o.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 48 48",fill:"none",children:[o.jsx("path",{d:"M24 14v12m0 4h.01",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round"}),o.jsx("path",{d:"M21 36h6l1-16h-8l1 16z",fill:"currentColor",opacity:"0.1"})]}),info:o.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 48 48",fill:"none",children:[o.jsx("circle",{cx:"24",cy:"24",r:"20",stroke:"currentColor",strokeWidth:"2.5",fill:"none"}),o.jsx("path",{d:"M24 22v12m0-16h.01",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round"})]}),success:o.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 48 48",fill:"none",children:[o.jsx("circle",{cx:"24",cy:"24",r:"20",fill:"currentColor",opacity:"0.1"}),o.jsx("path",{d:"M16 24l6 6 12-12",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"})]})},$e=({variant:t="info",title:e,message:r,isOpen:s,onClose:n,confirmText:a="OK",cancelText:i="Cancel",showCancelButton:l=!1,onConfirm:c,autoCloseDuration:d=0,closeOnBackdropClick:u=!0,closeOnEscape:h=!0,className:f="",zIndex:p=1e3,icon:_,showIcon:v=!0,dialogWidth:x,dialogMaxWidth:m,dialogMinHeight:g,dialogPadding:y,dialogBackgroundColor:w,dialogBorderRadius:b,dialogBoxShadow:C,backdropColor:j,backdropOpacity:I,titleFontSize:k,titleFontWeight:E,titleColor:T,titleMarginBottom:D,messageFontSize:N,messageFontWeight:A,messageColor:$,messageLineHeight:z,messageMarginBottom:H,iconSize:L,iconColor:B,iconMarginBottom:O,buttonHeight:M,buttonPadding:R,buttonFontSize:ie,buttonFontWeight:Z,buttonBorderRadius:Ie,buttonGap:Te,confirmButtonColor:Ke,confirmButtonBackgroundColor:ye,confirmButtonHoverBackgroundColor:P,cancelButtonColor:xe,cancelButtonBackgroundColor:je,cancelButtonBorderColor:ne,cancelButtonHoverBackgroundColor:Ce,animationDuration:Ue})=>{const[J,U]=S.useState(!1);S.useEffect(()=>{if(!s||d<=0)return;const Er=setTimeout(()=>{ue()},d);return()=>clearTimeout(Er)},[s,d]),S.useEffect(()=>{if(!s||!h)return;const Er=Ro=>{Ro.key==="Escape"&&ue()};return document.addEventListener("keydown",Er),()=>document.removeEventListener("keydown",Er)},[s,h]),S.useEffect(()=>(s?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[s]);const ue=S.useCallback(()=>{U(!0),setTimeout(()=>{n(),U(!1)},parseFloat(Ue||"0.2")*1e3)},[n,Ue]),ee=S.useCallback(Er=>{u&&Er.target===Er.currentTarget&&ue()},[u,ue]),F=S.useCallback(()=>{c&&c(),ue()},[c,ue]);if(!s&&!J)return null;const Y=_!==void 0?_:v?sN[t]:null,le={success:"#00C896",error:"#FF5847",warning:"#FF9500",info:"#0064FF"},ve={backgroundColor:j||`rgba(0, 0, 0, ${I??.3})`,zIndex:p},ot={width:x,maxWidth:m,minHeight:g,padding:y,backgroundColor:w,borderRadius:b,boxShadow:C},He={width:L,height:L,color:B||le[t],marginBottom:O},Pt={fontSize:k,fontWeight:E,color:T,marginBottom:D},Br={fontSize:N,fontWeight:A,color:$,lineHeight:z,marginBottom:H},Ao={gap:Te},Do={height:M,padding:R,fontSize:ie,fontWeight:Z,borderRadius:Ie,color:Ke,backgroundColor:ye},Mo={height:M,padding:R,fontSize:ie,fontWeight:Z,borderRadius:Ie,color:xe,backgroundColor:je,borderColor:ne};return o.jsx("div",{className:`${$s.backdrop} ${J?$s.backdropClosing:""}`,style:ve,onClick:ee,role:"presentation",children:o.jsxs("div",{className:`${$s.dialog} ${J?$s.dialogClosing:""} ${f}`,style:ot,role:"alertdialog","aria-modal":"true","aria-labelledby":e?"alert-title":void 0,"aria-describedby":"alert-message",onClick:Er=>Er.stopPropagation(),children:[Y&&o.jsx("div",{className:$s.iconContainer,style:He,children:Y}),e&&o.jsx("h2",{id:"alert-title",className:$s.title,style:Pt,children:e}),o.jsx("p",{id:"alert-message",className:$s.message,style:Br,children:r}),o.jsxs("div",{className:$s.buttonContainer,style:Ao,children:[l&&o.jsx("button",{type:"button",className:$s.cancelButton,onClick:ue,style:Mo,children:i}),o.jsx("button",{type:"button",className:$s.confirmButton,onClick:F,style:Do,autoFocus:!0,children:a})]})]})})},nN="_container_1ygeh_7",aN="_spinner_1ygeh_22",oN="_spin_1ygeh_22",iN="_small_1ygeh_38",lN="_medium_1ygeh_44",cN="_large_1ygeh_50",wu={container:nN,spinner:aN,spin:oN,small:iN,medium:lN,large:cN},Me=({size:t="medium",className:e="",fullscreen:r=!1})=>{const s=`${wu.spinner} ${wu[t]} ${e}`;return r?o.jsx("div",{className:wu.container,children:o.jsx("div",{className:s})}):o.jsx("div",{className:s})},$t=({children:t,requiredFeatureId:e})=>{const{authenticated:r,loading:s}=dl(),{permissions:n}=ht(),[a,i]=S.useState(!1),[l,c]=S.useState(!1);return S.useEffect(()=>{i(!1),c(!1)},[e]),s?o.jsx(Me,{fullscreen:!0,size:"large"}):r?e&&!n.includes(e)?(a||i(!0),o.jsxs(o.Fragment,{children:[o.jsx($e,{variant:"warning",title:"Access Denied",message:"You don't have permission to access this page. Please contact your administrator.",isOpen:a,onClose:()=>{i(!1),c(!0)},autoCloseDuration:3e3}),l&&o.jsx(Wi,{to:"/dashboard",replace:!0})]})):o.jsx(o.Fragment,{children:t}):o.jsx(Wi,{to:"/login",replace:!0})},Dg=({children:t})=>{const{authenticated:e,loading:r}=dl();return r?o.jsx(Me,{fullscreen:!0,size:"large"}):e?o.jsx(Wi,{to:"/dashboard",replace:!0}):o.jsx(o.Fragment,{children:t})},dN="_inputGroup_1usn9_7",uN="_fullWidth_1usn9_14",hN="_label_1usn9_19",fN="_required_1usn9_27",mN="_inputWrapper_1usn9_33",pN="_input_1usn9_7",gN="_withIconLeft_1usn9_125",_N="_withIconRight_1usn9_129",yN="_iconLeft_1usn9_133",vN="_iconRight_1usn9_134",xN="_footer_1usn9_173",bN="_errorMessage_1usn9_182",wN="_successMessage_1usn9_183",SN="_helperText_1usn9_184",jN="_charCount_1usn9_202",CN="_focused_1usn9_215",qt={inputGroup:dN,fullWidth:uN,label:hN,required:fN,inputWrapper:mN,input:pN,"size-sm":"_size-sm_1usn9_74","size-md":"_size-md_1usn9_80","size-lg":"_size-lg_1usn9_86","variant-default":"_variant-default_1usn9_93","variant-error":"_variant-error_1usn9_97","variant-success":"_variant-success_1usn9_106","variant-warning":"_variant-warning_1usn9_115",withIconLeft:gN,withIconRight:_N,iconLeft:yN,iconRight:vN,footer:xN,errorMessage:bN,successMessage:wN,helperText:SN,charCount:jN,focused:CN},jn=S.forwardRef(({label:t,variant:e="default",size:r="md",error:s,success:n,helperText:a,iconLeft:i,iconRight:l,showPasswordToggle:c,showCharCount:d=!1,required:u=!1,fullWidth:h=!1,type:f="text",className:p="",maxLength:_,value:v,onChange:x,onFocus:m,onBlur:g,...y},w)=>{const[b,C]=S.useState(!1),[j,I]=S.useState(!1),k=S.useId(),E=s?"error":n?"success":e,T=f==="password"&&(c===void 0||c),D=f==="password"&&j?"text":f,N=typeof v=="string"?v.length:0,A=[qt.input,qt[`size-${r}`],qt[`variant-${E}`],i&&qt.withIconLeft,(l||T)&&qt.withIconRight,h&&qt.fullWidth,b&&qt.focused,p].filter(Boolean).join(" "),$=L=>{C(!0),m==null||m(L)},z=L=>{C(!1),g==null||g(L)},H=()=>{I(L=>!L)};return o.jsxs("div",{className:`${qt.inputGroup} ${h?qt.fullWidth:""}`,children:[t&&o.jsxs("label",{htmlFor:k,className:qt.label,children:[t,u&&o.jsx("span",{className:qt.required,children:"*"})]}),o.jsxs("div",{className:qt.inputWrapper,children:[i&&o.jsx("span",{className:qt.iconLeft,children:i}),o.jsx("input",{ref:w,id:k,type:D,className:A,value:v,onChange:x,onFocus:$,onBlur:z,maxLength:_,required:u,...y}),T?o.jsx("button",{type:"button",className:qt.iconRight,onClick:H,tabIndex:-1,children:j?o.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"currentColor",children:[o.jsx("path",{d:"M2 2l16 16M6.71 6.71A9.78 9.78 0 0010 6c5 0 8.27 4.11 9 7a13.16 13.16 0 01-1.67 2.68"}),o.jsx("path",{d:"M12 12a3 3 0 11-4.24-4.24"}),o.jsx("path",{d:"M6.61 6.61A13.526 13.526 0 001 10s3.27 7 9 7a9.74 9.74 0 005.39-1.61"})]}):o.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"currentColor",children:[o.jsx("path",{d:"M10 3C5 3 1.73 7.11 1 10c.73 2.89 4 7 9 7s8.27-4.11 9-7c-.73-2.89-4-7-9-7z"}),o.jsx("circle",{cx:"10",cy:"10",r:"3"})]})}):l&&o.jsx("span",{className:qt.iconRight,children:l})]}),o.jsxs("div",{className:qt.footer,children:[s&&o.jsx("span",{className:qt.errorMessage,children:s}),!s&&n&&o.jsx("span",{className:qt.successMessage,children:n}),!s&&!n&&a&&o.jsx("span",{className:qt.helperText,children:a}),d&&_&&o.jsxs("span",{className:qt.charCount,children:[N,"/",_]})]})]})});jn.displayName="TossInput";const NN="_tossButton_1rg9o_7",IN="_fullWidth_1rg9o_59",kN="_disabled_1rg9o_170",EN="_loading_1rg9o_177",TN="_content_1rg9o_183",LN="_label_1rg9o_192",AN="_iconLeft_1rg9o_197",DN="_iconRight_1rg9o_198",MN="_spinner_1rg9o_214",RN="_spinnerSvg_1rg9o_220",PN="_spin_1rg9o_214",ON="_spinnerCircle_1rg9o_226",$N="_rippleContainer_1rg9o_243",FN="_ripple_1rg9o_243",BN="_rippleEffect_1rg9o_1",Tr={tossButton:NN,"size-sm":"_size-sm_1rg9o_34","size-md":"_size-md_1rg9o_40","size-lg":"_size-lg_1rg9o_46","size-xl":"_size-xl_1rg9o_52",fullWidth:IN,"variant-primary":"_variant-primary_1rg9o_65","variant-secondary":"_variant-secondary_1rg9o_81","variant-outline":"_variant-outline_1rg9o_92","variant-ghost":"_variant-ghost_1rg9o_103","variant-text":"_variant-text_1rg9o_113","variant-success":"_variant-success_1rg9o_125","variant-error":"_variant-error_1rg9o_136","variant-warning":"_variant-warning_1rg9o_147","variant-info":"_variant-info_1rg9o_158",disabled:kN,loading:EN,content:TN,label:LN,iconLeft:AN,iconRight:DN,spinner:MN,spinnerSvg:RN,spin:PN,spinnerCircle:ON,rippleContainer:$N,ripple:FN,rippleEffect:BN},Ne=({label:t,variant:e="primary",size:r="md",onClick:s,disabled:n=!1,fullWidth:a=!1,loading:i=!1,icon:l,iconPosition:c="left",children:d,type:u="button",className:h="",customStyles:f,...p})=>{const[_,v]=S.useState([]),x=S.useRef(null),m=S.useRef(0),g=j=>{if(!(n||i)){if(x.current){const I=x.current.getBoundingClientRect(),k=j.clientX-I.left,E=j.clientY-I.top,T=m.current++;v(D=>[...D,{x:k,y:E,id:T}]),setTimeout(()=>{v(D=>D.filter(N=>N.id!==T))},600)}s&&s(j)}},y=[Tr.tossButton,Tr[`variant-${e}`],Tr[`size-${r}`],a&&Tr.fullWidth,n&&Tr.disabled,i&&Tr.loading,h].filter(Boolean).join(" "),w=d||t,b=l&&!i,C={...(f==null?void 0:f.backgroundColor)&&{backgroundColor:f.backgroundColor},...(f==null?void 0:f.color)&&{color:f.color},...(f==null?void 0:f.borderColor)&&{borderColor:f.borderColor},...(f==null?void 0:f.borderWidth)&&{borderWidth:f.borderWidth},...(f==null?void 0:f.borderRadius)&&{borderRadius:f.borderRadius},...(f==null?void 0:f.width)&&{width:f.width},...(f==null?void 0:f.height)&&{height:f.height},...(f==null?void 0:f.padding)&&{padding:f.padding},...(f==null?void 0:f.fontSize)&&{fontSize:f.fontSize},...(f==null?void 0:f.fontWeight)&&{fontWeight:f.fontWeight}};return o.jsxs("button",{ref:x,type:u,className:y,style:C,onClick:g,disabled:n||i,...p,children:[o.jsx("span",{className:Tr.rippleContainer,children:_.map(j=>o.jsx("span",{className:Tr.ripple,style:{left:j.x,top:j.y}},j.id))}),o.jsxs("span",{className:Tr.content,children:[i&&o.jsx("span",{className:Tr.spinner,children:o.jsx("svg",{className:Tr.spinnerSvg,viewBox:"0 0 24 24",children:o.jsx("circle",{className:Tr.spinnerCircle,cx:"12",cy:"12",r:"10",fill:"none",strokeWidth:"3"})})}),b&&c==="left"&&o.jsx("span",{className:Tr.iconLeft,children:l}),w&&o.jsx("span",{className:Tr.label,children:w}),b&&c==="right"&&o.jsx("span",{className:Tr.iconRight,children:l})]})]})},VN=()=>{const t=hr(n=>n.loginLoading),e=hr(n=>n.loginError),r=hr(n=>n.loginFieldErrors);return{login:hr(n=>n.login),loading:t,error:e,fieldErrors:r}},HN="_form_190hk_5",zN="_checkboxGroup_190hk_13",qN="_checkboxLabel_190hk_17",UN="_checkbox_190hk_13",WN="_errorAlert_190hk_39",GN="_forgotPassword_190hk_50",Oa={form:HN,checkboxGroup:zN,checkboxLabel:qN,checkbox:UN,errorAlert:WN,forgotPassword:GN},JN=({onSuccess:t,onError:e,showRememberMe:r=!0,showForgotPassword:s=!0})=>{const[n,a]=S.useState(""),[i,l]=S.useState(""),[c,d]=S.useState(!1),{login:u,loading:h,error:f,fieldErrors:p}=VN(),_=async v=>{v.preventDefault();const x=await u(n,i,c);if(x.success)t==null||t();else{const m=x.error||f||Object.values(p).join(", ")||"Login failed";e==null||e(m)}};return o.jsxs("form",{className:Oa.form,onSubmit:_,children:[o.jsx(jn,{label:"Email Address",type:"email",name:"email",value:n,onChange:v=>a(v.target.value),placeholder:"Enter your email address",error:p.email,required:!0,fullWidth:!0,autoComplete:"email",iconLeft:o.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"currentColor",children:[o.jsx("path",{d:"M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z"}),o.jsx("path",{d:"M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z"})]})}),o.jsx(jn,{label:"Password",type:"password",name:"password",value:i,onChange:v=>l(v.target.value),placeholder:"Enter your password",error:p.password,required:!0,fullWidth:!0,autoComplete:"current-password",minLength:6,showPasswordToggle:!0}),r&&o.jsx("div",{className:Oa.checkboxGroup,children:o.jsxs("label",{className:Oa.checkboxLabel,children:[o.jsx("input",{type:"checkbox",checked:c,onChange:v=>d(v.target.checked),className:Oa.checkbox}),o.jsx("span",{children:"Remember me (Stay logged in on this device)"})]})}),f&&o.jsx("div",{className:Oa.errorAlert,children:f}),o.jsx(Ne,{type:"submit",variant:"primary",size:"lg",fullWidth:!0,loading:h,disabled:h,children:h?"Signing In...":"Sign In"}),s&&o.jsx("div",{className:Oa.forgotPassword,children:o.jsx("a",{href:"/auth/forgot-password",children:"Forgot your password?"})})]})},U0={appIcon:"/assets/images/app-icon.png"},KN="_container_125n9_6",YN="_card_125n9_15",QN="_header_125n9_38",ZN="_logo_125n9_43",XN="_title_125n9_56",eI="_subtitle_125n9_64",tI="_divider_125n9_71",rI="_actions_125n9_96",sI="_footer_125n9_101",nI="_loadingContainer_125n9_126",aI="_spinner_125n9_136",oI="_loadingText_125n9_143",Vr={container:KN,card:YN,header:QN,logo:ZN,title:XN,subtitle:eI,divider:tI,actions:rI,footer:sI,loadingContainer:nI,spinner:aI,loadingText:oI},iI=({redirectUrl:t})=>{var p,_;const e=Io(),r=ll(),{authenticated:s,loading:n}=dl(),{loadUserData:a,loadCategoryFeatures:i}=ht(),[l,c]=S.useState(!1),d=((_=(p=r.state)==null?void 0:p.from)==null?void 0:_.pathname)||t||"/dashboard";S.useEffect(()=>{!n&&s&&e(d,{replace:!0})},[s,n,e,d]);const u=async()=>{try{c(!0),await Promise.all([a(),i()]),e(d,{replace:!0})}catch(v){console.error("Failed to load user data:",v),e(d,{replace:!0})}finally{c(!1)}},h=v=>{console.error("Login error:",v)},f=()=>{e("/register")};return n?o.jsx("div",{className:Vr.loadingContainer,children:o.jsx("div",{className:Vr.spinner,children:"Loading..."})}):l?o.jsxs("div",{className:Vr.loadingContainer,children:[o.jsx("div",{className:Vr.spinner,children:"Loading your data..."}),o.jsx("p",{className:Vr.loadingText,children:"Please wait while we set up your workspace"})]}):s?null:o.jsx("div",{className:Vr.container,children:o.jsxs("div",{className:Vr.card,children:[o.jsxs("div",{className:Vr.header,children:[o.jsx("div",{className:Vr.logo,children:o.jsx("img",{src:U0.appIcon,alt:"Store Base Logo"})}),o.jsx("h1",{className:Vr.title,children:"Welcome to Store Base"}),o.jsx("p",{className:Vr.subtitle,children:"Sign in to manage your store"})]}),o.jsx(JN,{onSuccess:u,onError:h}),o.jsx("div",{className:Vr.divider,children:o.jsx("span",{children:"Or"})}),o.jsx("div",{className:Vr.actions,children:o.jsx(Ne,{variant:"outline",size:"lg",fullWidth:!0,onClick:f,children:"Create New Account"})}),o.jsx("div",{className:Vr.footer,children:o.jsxs("p",{children:["By signing in, you agree to our"," ",o.jsx("a",{href:"/terms",children:"Terms of Service"})," and"," ",o.jsx("a",{href:"/privacy",children:"Privacy Policy"})]})})]})})},lI=()=>{const t=hr(n=>n.registerLoading),e=hr(n=>n.registerError),r=hr(n=>n.registerFieldErrors);return{register:hr(n=>n.register),loading:t,error:e,fieldErrors:r}},cI="_form_bewng_5",dI="_nameRow_bewng_13",uI="_errorAlert_bewng_20",hI="_loginLink_bewng_31",Bl={form:cI,nameRow:dI,errorAlert:uI,loginLink:hI},fI=({onSuccess:t,onError:e,showLoginLink:r=!0})=>{const[s,n]=S.useState(""),[a,i]=S.useState(""),[l,c]=S.useState(""),[d,u]=S.useState(""),[h,f]=S.useState(""),{register:p,loading:_,error:v,fieldErrors:x}=lI(),m=async g=>{g.preventDefault();const y=await p(s,a,l,d,h);if(y.success)t==null||t();else{const w=y.error||v||Object.values(x).join(", ")||"Registration failed";e==null||e(w)}};return o.jsxs("form",{className:Bl.form,onSubmit:m,children:[o.jsxs("div",{className:Bl.nameRow,children:[o.jsx(jn,{label:"First Name",type:"text",name:"firstName",value:d,onChange:g=>u(g.target.value),placeholder:"First name",error:x.firstName,required:!0,fullWidth:!0,autoComplete:"given-name"}),o.jsx(jn,{label:"Last Name",type:"text",name:"lastName",value:h,onChange:g=>f(g.target.value),placeholder:"Last name",error:x.lastName,required:!0,fullWidth:!0,autoComplete:"family-name"})]}),o.jsx(jn,{label:"Email Address",type:"email",name:"email",value:s,onChange:g=>n(g.target.value),placeholder:"Enter your email address",error:x.email,required:!0,fullWidth:!0,autoComplete:"email",iconLeft:o.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"currentColor",children:[o.jsx("path",{d:"M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z"}),o.jsx("path",{d:"M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z"})]})}),o.jsx(jn,{label:"Password",type:"password",name:"password",value:a,onChange:g=>i(g.target.value),placeholder:"Enter your password",error:x.password,required:!0,fullWidth:!0,autoComplete:"new-password",minLength:6,showPasswordToggle:!0}),o.jsx(jn,{label:"Confirm Password",type:"password",name:"passwordConfirmation",value:l,onChange:g=>c(g.target.value),placeholder:"Confirm your password",error:x.passwordConfirmation,required:!0,fullWidth:!0,autoComplete:"new-password",minLength:6,showPasswordToggle:!0}),v&&o.jsx("div",{className:Bl.errorAlert,children:v}),o.jsx(Ne,{type:"submit",variant:"primary",size:"lg",fullWidth:!0,loading:_,disabled:_,children:_?"Creating Account...":"Create Account"}),r&&o.jsxs("div",{className:Bl.loginLink,children:["Already have an account? ",o.jsx("a",{href:"/auth/login",children:"Sign in"})]})]})},mI="_container_g4l96_6",pI="_card_g4l96_15",gI="_header_g4l96_38",_I="_logo_g4l96_43",yI="_title_g4l96_56",vI="_subtitle_g4l96_64",xI="_divider_g4l96_71",bI="_actions_g4l96_96",wI="_footer_g4l96_101",SI="_loadingContainer_g4l96_126",jI="_spinner_g4l96_136",CI="_loadingText_g4l96_143",Hr={container:mI,card:pI,header:gI,logo:_I,title:yI,subtitle:vI,divider:xI,actions:bI,footer:wI,loadingContainer:SI,spinner:jI,loadingText:CI},NI=({redirectUrl:t})=>{var p,_;const e=Io(),r=ll(),{authenticated:s,loading:n}=dl(),{loadUserData:a,loadCategoryFeatures:i}=ht(),[l,c]=S.useState(!1),d=((_=(p=r.state)==null?void 0:p.from)==null?void 0:_.pathname)||t||"/dashboard";S.useEffect(()=>{!n&&s&&e(d,{replace:!0})},[s,n,e,d]);const u=async()=>{try{c(!0),await Promise.all([a(),i()]),e(d,{replace:!0})}catch(v){console.error("Failed to load user data:",v),e(d,{replace:!0})}finally{c(!1)}},h=v=>{console.error("Registration error:",v)},f=()=>{e("/auth/login")};return n?o.jsx("div",{className:Hr.loadingContainer,children:o.jsx("div",{className:Hr.spinner,children:"Loading..."})}):l?o.jsxs("div",{className:Hr.loadingContainer,children:[o.jsx("div",{className:Hr.spinner,children:"Setting up your account..."}),o.jsx("p",{className:Hr.loadingText,children:"Please wait while we create your workspace"})]}):s?null:o.jsx("div",{className:Hr.container,children:o.jsxs("div",{className:Hr.card,children:[o.jsxs("div",{className:Hr.header,children:[o.jsx("div",{className:Hr.logo,children:o.jsx("img",{src:U0.appIcon,alt:"Store Base Logo"})}),o.jsx("h1",{className:Hr.title,children:"Create Your Account"}),o.jsx("p",{className:Hr.subtitle,children:"Join Store Base to manage your store"})]}),o.jsx(fI,{onSuccess:u,onError:h}),o.jsx("div",{className:Hr.divider,children:o.jsx("span",{children:"Or"})}),o.jsx("div",{className:Hr.actions,children:o.jsx(Ne,{variant:"outline",size:"lg",fullWidth:!0,onClick:f,children:"Sign In to Existing Account"})}),o.jsx("div",{className:Hr.footer,children:o.jsxs("p",{children:["By creating an account, you agree to our"," ",o.jsx("a",{href:"/terms",children:"Terms of Service"})," and"," ",o.jsx("a",{href:"/privacy",children:"Privacy Policy"})]})})]})})},qe={errors:{loadFailed:"Failed to load dashboard data",loadFailedTitle:"Data Load Failed",noDataReturned:"No data returned from server",invalidCompanyId:"Invalid company ID",companyIdRequired:"Company ID is required",invalidCompanyIdFormat:"Invalid company ID format (UUID required)",invalidDate:"Invalid date format",dateRequired:"Date is required",invalidDateFormat:"Invalid date format (ISO 8601 format required)",rpcFailed:"Failed to communicate with server",rpcError:"An error occurred during server request",unknownError:"An unknown error occurred",unexpectedError:"An unexpected error occurred",negativeRevenue:"Today revenue cannot be negative",negativeExpense:"Today expense cannot be negative",negativeMonthRevenue:"This month revenue cannot be negative",negativeLastMonthRevenue:"Last month revenue cannot be negative",currencySymbolRequired:"Currency symbol is required",currencyCodeRequired:"Currency code is required",expensePercentageInvalid:"Expense breakdown percentages do not sum to 100%"},warnings:{noExpenseData:"No expense data for this month",noTransactions:"No recent transactions",noDataAvailable:"No data available to display",dataValidationWarnings:"Data validation warnings exist"},info:{loading:"Loading...",loadingData:"Loading data...",noCompanySelected:"Please select a company"},success:{dataLoaded:"Dashboard data loaded successfully",refreshed:"Data refreshed successfully"},emptyStates:{noDashboardData:"No dashboard data available",noExpenseData:"No expense data for this month",noRecentActivity:"No recent activity",noTransactions:"No transactions"},actions:{retry:"Retry",close:"Close",refresh:"Refresh",ok:"OK",cancel:"Cancel"},technical:{expenseItemCategoryRequired:t=>`Expense item ${t+1}: Category is required`,expenseItemNegative:t=>`Expense item ${t+1}: Amount cannot be negative`,expenseItemPercentageInvalid:t=>`Expense item ${t+1}: Percentage must be between 0-100`,transactionIdRequired:t=>`Transaction ${t+1}: ID is required`,transactionDateRequired:t=>`Transaction ${t+1}: Date is required`,transactionDescriptionRequired:t=>`Transaction ${t+1}: Description is required`,transactionAmountNegative:t=>`Transaction ${t+1}: Amount cannot be negative`,transactionTypeInvalid:t=>`Transaction ${t+1}: Type must be 'income' or 'expense'`,rpcDebugFetch:t=>` Fetching dashboard data: ${JSON.stringify(t)}`,rpcDebugResponse:(t,e)=>` Dashboard RPC response: ${JSON.stringify({data:t,error:e})}`,rpcDebugError:t=>` Dashboard RPC error: ${t}`,rpcDebugSuccess:" Dashboard data fetched successfully",rpcDebugNoData:" No data returned from dashboard RPC",datasourceError:t=>` Dashboard datasource error: ${t}`,validationWarnings:t=>` Dashboard data validation warnings: ${t.join(", ")}`}};class II{async getDashboardData(e,r){try{const s=se.getClient(),{data:n,error:a}=await s.rpc("get_dashboard_page",{p_company_id:e,p_date:r});return a?(console.error("Dashboard RPC error:",a.message),{success:!1,error:a.message||qe.errors.rpcFailed}):n?{success:!0,data:n}:{success:!1,error:qe.errors.noDataReturned}}catch(s){return console.error("Dashboard datasource error:",s),{success:!1,error:s instanceof Error?s.message:qe.errors.unknownError}}}}class um{constructor(e,r,s,n,a,i,l){this.todayRevenue=e,this.todayExpense=r,this.thisMonthRevenue=s,this.lastMonthRevenue=n,this.currency=a,this.expenseBreakdown=i,this.recentTransactions=l}get todayProfit(){return this.todayRevenue-this.todayExpense}get monthOverMonthGrowth(){return this.lastMonthRevenue===0?0:(this.thisMonthRevenue-this.lastMonthRevenue)/this.lastMonthRevenue*100}get isGrowthPositive(){return this.monthOverMonthGrowth>0}formatCurrency(e){const r=e||0;return`${this.currency.symbol}${r.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})}`}get formattedTodayRevenue(){return this.formatCurrency(this.todayRevenue)}get formattedTodayExpense(){return this.formatCurrency(this.todayExpense)}get formattedThisMonthRevenue(){return this.formatCurrency(this.thisMonthRevenue)}get formattedLastMonthRevenue(){return this.formatCurrency(this.lastMonthRevenue)}static create(e){return new um(e.today_revenue||0,e.today_expense||0,e.this_month_revenue||0,e.last_month_revenue||0,e.currency||{symbol:"$",currency_code:"USD"},e.expense_breakdown||[],e.recent_transactions||[])}}class re{static toUtc(e){return e.toISOString()}static nowUtc(){return new Date().toISOString()}static toLocal(e){if(!e.includes("Z")&&!e.includes("+")&&!e.includes("-",e.length-6)){const r=e.replace(" ","T");return new Date(`${r}Z`)}return new Date(e)}static toLocalSafe(e){if(!e||e.trim()==="")return null;try{return this.toLocal(e)}catch(r){return console.error("Failed to parse date:",e,r),null}}static toDateOnly(e){const r=e.getFullYear(),s=String(e.getMonth()+1).padStart(2,"0"),n=String(e.getDate()).padStart(2,"0");return`${r}-${s}-${n}`}static toUtcDateOnly(e=new Date){const r=e.getUTCFullYear(),s=String(e.getUTCMonth()+1).padStart(2,"0"),n=String(e.getUTCDate()).padStart(2,"0");return`${r}-${s}-${n}`}static nowUtcDate(){return this.toUtcDateOnly(new Date)}static toRpcFormat(e){return e.toISOString().replace("T"," ").split(".")[0]}static format(e){const r=e.getFullYear(),s=String(e.getMonth()+1).padStart(2,"0"),n=String(e.getDate()).padStart(2,"0"),a=String(e.getHours()).padStart(2,"0"),i=String(e.getMinutes()).padStart(2,"0");return`${r}-${s}-${n} ${a}:${i}`}static formatCustom(e,r={},s="ko-KR"){return new Intl.DateTimeFormat(s,r).format(e)}static formatDateOnly(e){return this.toDateOnly(e)}static formatTimeOnly(e){const r=String(e.getHours()).padStart(2,"0"),s=String(e.getMinutes()).padStart(2,"0");return`${r}:${s}`}static formatRelative(e,r="ko-KR"){const n=new Date().getTime()-e.getTime(),a=Math.floor(n/1e3),i=Math.floor(a/60),l=Math.floor(i/60),c=Math.floor(l/24),d=new Intl.RelativeTimeFormat(r,{numeric:"auto"});return a<60?d.format(-a,"second"):i<60?d.format(-i,"minute"):l<24?d.format(-l,"hour"):c<30?d.format(-c,"day"):this.format(e)}static isSameDay(e,r){return e.getFullYear()===r.getFullYear()&&e.getMonth()===r.getMonth()&&e.getDate()===r.getDate()}static addDays(e,r){const s=new Date(e);return s.setDate(s.getDate()+r),s}static startOfDay(e){const r=new Date(e);return r.setHours(0,0,0,0),r}static endOfDay(e){const r=new Date(e);return r.setHours(23,59,59,999),r}static formatTransactionDate(e){try{const r=new Date(e);if(isNaN(r.getTime()))return"Invalid Date";const s={month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0};return r.toLocaleString("en-US",s)}catch(r){return console.error("Date formatting error:",r),"Invalid Date"}}}class kI{static fromSupabase(e){var s,n;const r=(e.recent_transactions||[]).map(a=>{var d,u;const i=(d=a.lines)==null?void 0:d.some(h=>h.account_type==="income"),l=(u=a.lines)==null?void 0:u.some(h=>h.account_type==="expense"),c=a.created_at||a.entry_date;return{id:a.journal_id,date:re.toLocal(c).toISOString(),description:a.description||"No description",amount:a.total_amount||0,type:i?"income":l?"expense":"income"}});return um.create({today_revenue:e.today_revenue||0,today_expense:e.today_expense||0,this_month_revenue:e.this_month_revenue||0,last_month_revenue:e.last_month_revenue||0,currency:{symbol:((s=e.currency)==null?void 0:s.symbol)||"$",currency_code:((n=e.currency)==null?void 0:n.currency_code)||"USD"},expense_breakdown:e.expense_breakdown||[],recent_transactions:r})}}class EI{constructor(){W(this,"dataSource");this.dataSource=new II}async getDashboardData(e,r){try{const s=await this.dataSource.getDashboardData(e,r);return!s.success||!s.data?{success:!1,error:s.error||"Failed to fetch dashboard data"}:{success:!0,data:kI.fromSupabase(s.data)}}catch(s){return{success:!1,error:s instanceof Error?s.message:"An unexpected error occurred"}}}}class Su{static validateDashboardData(e){const r=[];if(e.todayRevenue!==void 0&&e.todayRevenue<0&&r.push(qe.errors.negativeRevenue),e.todayExpense!==void 0&&e.todayExpense<0&&r.push(qe.errors.negativeExpense),e.thisMonthRevenue!==void 0&&e.thisMonthRevenue<0&&r.push(qe.errors.negativeMonthRevenue),e.lastMonthRevenue!==void 0&&e.lastMonthRevenue<0&&r.push(qe.errors.negativeLastMonthRevenue),e.currency&&((!e.currency.symbol||e.currency.symbol.trim()==="")&&r.push(qe.errors.currencySymbolRequired),(!e.currency.currency_code||e.currency.currency_code.trim()==="")&&r.push(qe.errors.currencyCodeRequired)),e.expenseBreakdown&&e.expenseBreakdown.length>0){const s=e.expenseBreakdown.reduce((n,a)=>n+a.percentage,0);Math.abs(s-100)>.1&&s>0&&r.push(qe.errors.expensePercentageInvalid),e.expenseBreakdown.forEach((n,a)=>{(!n.category||n.category.trim()==="")&&r.push(qe.technical.expenseItemCategoryRequired(a)),n.amount<0&&r.push(qe.technical.expenseItemNegative(a)),(n.percentage<0||n.percentage>100)&&r.push(qe.technical.expenseItemPercentageInvalid(a))})}return e.recentTransactions&&e.recentTransactions.length>0&&e.recentTransactions.forEach((s,n)=>{(!s.id||s.id.trim()==="")&&r.push(qe.technical.transactionIdRequired(n)),s.date||r.push(qe.technical.transactionDateRequired(n)),(!s.description||s.description.trim()==="")&&r.push(qe.technical.transactionDescriptionRequired(n)),s.amount<0&&r.push(qe.technical.transactionAmountNegative(n)),["income","expense"].includes(s.type)||r.push(qe.technical.transactionTypeInvalid(n))}),{isValid:r.length===0,errors:r}}static validateDateFormat(e){if(!e||e.trim()==="")return{isValid:!1,error:qe.errors.dateRequired};const r=new Date(e);return isNaN(r.getTime())?{isValid:!1,error:qe.errors.invalidDateFormat}:{isValid:!0}}static validateCompanyId(e){return!e||e.trim()===""?{isValid:!1,error:qe.errors.companyIdRequired}:/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e)?{isValid:!0}:{isValid:!1,error:qe.errors.invalidCompanyIdFormat}}}const TI=new EI,Qn=er((t,e)=>({data:null,loading:!0,error:null,errorDialog:{variant:"error",title:qe.errors.loadFailedTitle,message:"",isOpen:!1},setData:r=>t({data:r}),setLoading:r=>t({loading:r}),setError:r=>t({error:r,errorDialog:{variant:"error",title:qe.errors.loadFailedTitle,message:r||"",isOpen:!!r&&!e().loading}}),clearError:()=>t({error:null,errorDialog:{variant:"error",title:qe.errors.loadFailedTitle,message:"",isOpen:!1}}),loadDashboardData:async(r,s)=>{const n=Su.validateCompanyId(r);if(!n.isValid){t({error:n.error||qe.errors.invalidCompanyId,loading:!1}),e().setError(n.error||qe.errors.invalidCompanyId);return}t({loading:!0,error:null}),e().clearError();try{const a=Su.validateDateFormat(s);if(!a.isValid){t({error:a.error||qe.errors.invalidDate,loading:!1}),e().setError(a.error||qe.errors.invalidDate);return}const i=await TI.getDashboardData(r,s);if(!i.success||!i.data){t({error:i.error||qe.errors.loadFailed,data:null,loading:!1}),e().setError(i.error||qe.errors.loadFailed);return}const l=Su.validateDashboardData({todayRevenue:i.data.todayRevenue,todayExpense:i.data.todayExpense,thisMonthRevenue:i.data.thisMonthRevenue,lastMonthRevenue:i.data.lastMonthRevenue,currency:i.data.currency,expenseBreakdown:i.data.expenseBreakdown,recentTransactions:i.data.recentTransactions});t({data:i.data,loading:!1,error:null}),e().clearError()}catch(a){const i=a instanceof Error?a.message:qe.errors.unexpectedError;t({error:i,data:null,loading:!1}),e().setError(i)}},refresh:async r=>{const s=re.nowUtcDate();await e().loadDashboardData(r,s)}})),LI=(t,e={})=>{const{autoLoad:r=!0}=e,s=Qn(h=>h.data),n=Qn(h=>h.loading),a=Qn(h=>h.error),i=Qn(h=>h.errorDialog),l=Qn(h=>h.loadDashboardData),c=Qn(h=>h.refresh),d=Qn(h=>h.clearError);return S.useEffect(()=>{if(t&&r){const h=re.nowUtcDate();l(t,h)}},[t,r,l]),{data:s,loading:n,error:a,errorDialog:i,refresh:()=>{c(t)},clearError:d}},AI="_card_s6ren_5",DI="_header_s6ren_17",MI="_iconWrapper_s6ren_23",RI="_title_s6ren_35",PI="_value_s6ren_42",OI="_change_s6ren_51",$I="_positive_s6ren_59",FI="_negative_s6ren_63",BI="_arrow_s6ren_67",VI="_skeleton_s6ren_72",HI="_skeletonIcon_s6ren_85",wr={card:AI,header:DI,iconWrapper:MI,title:RI,value:PI,change:OI,positive:$I,negative:FI,arrow:BI,skeleton:VI,skeletonIcon:HI},Vl=({title:t,value:e,icon:r,changePercentage:s,isPositive:n=!0,loading:a=!1})=>{const i=()=>{if(s==null)return null;const l=n?wr.positive:wr.negative,c=n?"":"";return o.jsxs("div",{className:`${wr.change} ${l}`,children:[o.jsx("span",{className:wr.arrow,children:c}),o.jsxs("span",{children:[Math.abs(s).toFixed(1),"%"]})]})};return a?o.jsxs("div",{className:wr.card,children:[o.jsxs("div",{className:wr.header,children:[o.jsx("div",{className:`${wr.iconWrapper} ${wr.skeletonIcon}`}),o.jsx("div",{className:wr.title,children:t})]}),o.jsx("div",{className:wr.value,children:o.jsx("div",{className:wr.skeleton})})]}):o.jsxs("div",{className:wr.card,children:[o.jsxs("div",{className:wr.header,children:[o.jsx("div",{className:wr.iconWrapper,children:r}),o.jsx("div",{className:wr.title,children:t})]}),o.jsx("div",{className:wr.value,children:e}),i()]})};/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function ul(t){return t+.5|0}const kn=(t,e,r)=>Math.max(Math.min(t,r),e);function ti(t){return kn(ul(t*2.55),0,255)}function Bn(t){return kn(ul(t*255),0,255)}function rn(t){return kn(ul(t/2.55)/100,0,1)}function Mg(t){return kn(ul(t*100),0,100)}const hs={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},Kh=[..."0123456789ABCDEF"],zI=t=>Kh[t&15],qI=t=>Kh[(t&240)>>4]+Kh[t&15],Hl=t=>(t&240)>>4===(t&15),UI=t=>Hl(t.r)&&Hl(t.g)&&Hl(t.b)&&Hl(t.a);function WI(t){var e=t.length,r;return t[0]==="#"&&(e===4||e===5?r={r:255&hs[t[1]]*17,g:255&hs[t[2]]*17,b:255&hs[t[3]]*17,a:e===5?hs[t[4]]*17:255}:(e===7||e===9)&&(r={r:hs[t[1]]<<4|hs[t[2]],g:hs[t[3]]<<4|hs[t[4]],b:hs[t[5]]<<4|hs[t[6]],a:e===9?hs[t[7]]<<4|hs[t[8]]:255})),r}const GI=(t,e)=>t<255?e(t):"";function JI(t){var e=UI(t)?zI:qI;return t?"#"+e(t.r)+e(t.g)+e(t.b)+GI(t.a,e):void 0}const KI=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function W0(t,e,r){const s=e*Math.min(r,1-r),n=(a,i=(a+t/30)%12)=>r-s*Math.max(Math.min(i-3,9-i,1),-1);return[n(0),n(8),n(4)]}function YI(t,e,r){const s=(n,a=(n+t/60)%6)=>r-r*e*Math.max(Math.min(a,4-a,1),0);return[s(5),s(3),s(1)]}function QI(t,e,r){const s=W0(t,1,.5);let n;for(e+r>1&&(n=1/(e+r),e*=n,r*=n),n=0;n<3;n++)s[n]*=1-e-r,s[n]+=e;return s}function ZI(t,e,r,s,n){return t===n?(e-r)/s+(e<r?6:0):e===n?(r-t)/s+2:(t-e)/s+4}function hm(t){const r=t.r/255,s=t.g/255,n=t.b/255,a=Math.max(r,s,n),i=Math.min(r,s,n),l=(a+i)/2;let c,d,u;return a!==i&&(u=a-i,d=l>.5?u/(2-a-i):u/(a+i),c=ZI(r,s,n,u,a),c=c*60+.5),[c|0,d||0,l]}function fm(t,e,r,s){return(Array.isArray(e)?t(e[0],e[1],e[2]):t(e,r,s)).map(Bn)}function mm(t,e,r){return fm(W0,t,e,r)}function XI(t,e,r){return fm(QI,t,e,r)}function ek(t,e,r){return fm(YI,t,e,r)}function G0(t){return(t%360+360)%360}function tk(t){const e=KI.exec(t);let r=255,s;if(!e)return;e[5]!==s&&(r=e[6]?ti(+e[5]):Bn(+e[5]));const n=G0(+e[2]),a=+e[3]/100,i=+e[4]/100;return e[1]==="hwb"?s=XI(n,a,i):e[1]==="hsv"?s=ek(n,a,i):s=mm(n,a,i),{r:s[0],g:s[1],b:s[2],a:r}}function rk(t,e){var r=hm(t);r[0]=G0(r[0]+e),r=mm(r),t.r=r[0],t.g=r[1],t.b=r[2]}function sk(t){if(!t)return;const e=hm(t),r=e[0],s=Mg(e[1]),n=Mg(e[2]);return t.a<255?`hsla(${r}, ${s}%, ${n}%, ${rn(t.a)})`:`hsl(${r}, ${s}%, ${n}%)`}const Rg={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},Pg={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function nk(){const t={},e=Object.keys(Pg),r=Object.keys(Rg);let s,n,a,i,l;for(s=0;s<e.length;s++){for(i=l=e[s],n=0;n<r.length;n++)a=r[n],l=l.replace(a,Rg[a]);a=parseInt(Pg[i],16),t[l]=[a>>16&255,a>>8&255,a&255]}return t}let zl;function ak(t){zl||(zl=nk(),zl.transparent=[0,0,0,0]);const e=zl[t.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}const ok=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function ik(t){const e=ok.exec(t);let r=255,s,n,a;if(e){if(e[7]!==s){const i=+e[7];r=e[8]?ti(i):kn(i*255,0,255)}return s=+e[1],n=+e[3],a=+e[5],s=255&(e[2]?ti(s):kn(s,0,255)),n=255&(e[4]?ti(n):kn(n,0,255)),a=255&(e[6]?ti(a):kn(a,0,255)),{r:s,g:n,b:a,a:r}}}function lk(t){return t&&(t.a<255?`rgba(${t.r}, ${t.g}, ${t.b}, ${rn(t.a)})`:`rgb(${t.r}, ${t.g}, ${t.b})`)}const ju=t=>t<=.0031308?t*12.92:Math.pow(t,1/2.4)*1.055-.055,$a=t=>t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4);function ck(t,e,r){const s=$a(rn(t.r)),n=$a(rn(t.g)),a=$a(rn(t.b));return{r:Bn(ju(s+r*($a(rn(e.r))-s))),g:Bn(ju(n+r*($a(rn(e.g))-n))),b:Bn(ju(a+r*($a(rn(e.b))-a))),a:t.a+r*(e.a-t.a)}}function ql(t,e,r){if(t){let s=hm(t);s[e]=Math.max(0,Math.min(s[e]+s[e]*r,e===0?360:1)),s=mm(s),t.r=s[0],t.g=s[1],t.b=s[2]}}function J0(t,e){return t&&Object.assign(e||{},t)}function Og(t){var e={r:0,g:0,b:0,a:255};return Array.isArray(t)?t.length>=3&&(e={r:t[0],g:t[1],b:t[2],a:255},t.length>3&&(e.a=Bn(t[3]))):(e=J0(t,{r:0,g:0,b:0,a:1}),e.a=Bn(e.a)),e}function dk(t){return t.charAt(0)==="r"?ik(t):tk(t)}class Yi{constructor(e){if(e instanceof Yi)return e;const r=typeof e;let s;r==="object"?s=Og(e):r==="string"&&(s=WI(e)||ak(e)||dk(e)),this._rgb=s,this._valid=!!s}get valid(){return this._valid}get rgb(){var e=J0(this._rgb);return e&&(e.a=rn(e.a)),e}set rgb(e){this._rgb=Og(e)}rgbString(){return this._valid?lk(this._rgb):void 0}hexString(){return this._valid?JI(this._rgb):void 0}hslString(){return this._valid?sk(this._rgb):void 0}mix(e,r){if(e){const s=this.rgb,n=e.rgb;let a;const i=r===a?.5:r,l=2*i-1,c=s.a-n.a,d=((l*c===-1?l:(l+c)/(1+l*c))+1)/2;a=1-d,s.r=255&d*s.r+a*n.r+.5,s.g=255&d*s.g+a*n.g+.5,s.b=255&d*s.b+a*n.b+.5,s.a=i*s.a+(1-i)*n.a,this.rgb=s}return this}interpolate(e,r){return e&&(this._rgb=ck(this._rgb,e._rgb,r)),this}clone(){return new Yi(this.rgb)}alpha(e){return this._rgb.a=Bn(e),this}clearer(e){const r=this._rgb;return r.a*=1-e,this}greyscale(){const e=this._rgb,r=ul(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=r,this}opaquer(e){const r=this._rgb;return r.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return ql(this._rgb,2,e),this}darken(e){return ql(this._rgb,2,-e),this}saturate(e){return ql(this._rgb,1,e),this}desaturate(e){return ql(this._rgb,1,-e),this}rotate(e){return rk(this._rgb,e),this}}/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */function Ys(){}const uk=(()=>{let t=0;return()=>t++})();function Ir(t){return t==null}function _r(t){if(Array.isArray&&Array.isArray(t))return!0;const e=Object.prototype.toString.call(t);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function tt(t){return t!==null&&Object.prototype.toString.call(t)==="[object Object]"}function un(t){return(typeof t=="number"||t instanceof Number)&&isFinite(+t)}function Fs(t,e){return un(t)?t:e}function dt(t,e){return typeof t>"u"?e:t}const hk=(t,e)=>typeof t=="string"&&t.endsWith("%")?parseFloat(t)/100:+t/e,K0=(t,e)=>typeof t=="string"&&t.endsWith("%")?parseFloat(t)/100*e:+t;function wt(t,e,r){if(t&&typeof t.call=="function")return t.apply(r,e)}function ct(t,e,r,s){let n,a,i;if(_r(t))for(a=t.length,n=0;n<a;n++)e.call(r,t[n],n);else if(tt(t))for(i=Object.keys(t),a=i.length,n=0;n<a;n++)e.call(r,t[i[n]],i[n])}function Zc(t,e){let r,s,n,a;if(!t||!e||t.length!==e.length)return!1;for(r=0,s=t.length;r<s;++r)if(n=t[r],a=e[r],n.datasetIndex!==a.datasetIndex||n.index!==a.index)return!1;return!0}function Xc(t){if(_r(t))return t.map(Xc);if(tt(t)){const e=Object.create(null),r=Object.keys(t),s=r.length;let n=0;for(;n<s;++n)e[r[n]]=Xc(t[r[n]]);return e}return t}function Y0(t){return["__proto__","prototype","constructor"].indexOf(t)===-1}function fk(t,e,r,s){if(!Y0(t))return;const n=e[t],a=r[t];tt(n)&&tt(a)?Qi(n,a,s):e[t]=Xc(a)}function Qi(t,e,r){const s=_r(e)?e:[e],n=s.length;if(!tt(t))return t;r=r||{};const a=r.merger||fk;let i;for(let l=0;l<n;++l){if(i=s[l],!tt(i))continue;const c=Object.keys(i);for(let d=0,u=c.length;d<u;++d)a(c[d],t,i,r)}return t}function xi(t,e){return Qi(t,e,{merger:mk})}function mk(t,e,r){if(!Y0(t))return;const s=e[t],n=r[t];tt(s)&&tt(n)?xi(s,n):Object.prototype.hasOwnProperty.call(e,t)||(e[t]=Xc(n))}const $g={"":t=>t,x:t=>t.x,y:t=>t.y};function pk(t){const e=t.split("."),r=[];let s="";for(const n of e)s+=n,s.endsWith("\\")?s=s.slice(0,-1)+".":(r.push(s),s="");return r}function gk(t){const e=pk(t);return r=>{for(const s of e){if(s==="")break;r=r&&r[s]}return r}}function Zi(t,e){return($g[e]||($g[e]=gk(e)))(t)}function pm(t){return t.charAt(0).toUpperCase()+t.slice(1)}const ed=t=>typeof t<"u",zn=t=>typeof t=="function",Fg=(t,e)=>{if(t.size!==e.size)return!1;for(const r of t)if(!e.has(r))return!1;return!0};function _k(t){return t.type==="mouseup"||t.type==="click"||t.type==="contextmenu"}const St=Math.PI,Zt=2*St,td=Number.POSITIVE_INFINITY,yk=St/180,lr=St/2,Zn=St/4,Bg=St*2/3,Vg=Math.sign;function vk(t){const e=[],r=Math.sqrt(t);let s;for(s=1;s<r;s++)t%s===0&&(e.push(s),e.push(t/s));return r===(r|0)&&e.push(r),e.sort((n,a)=>n-a).pop(),e}function xk(t){return typeof t=="symbol"||typeof t=="object"&&t!==null&&!(Symbol.toPrimitive in t||"toString"in t||"valueOf"in t)}function rd(t){return!xk(t)&&!isNaN(parseFloat(t))&&isFinite(t)}function _a(t){return t*(St/180)}function bk(t){return t*(180/St)}function Q0(t,e){const r=e.x-t.x,s=e.y-t.y,n=Math.sqrt(r*r+s*s);let a=Math.atan2(s,r);return a<-.5*St&&(a+=Zt),{angle:a,distance:n}}function wk(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function qs(t){return(t%Zt+Zt)%Zt}function sd(t,e,r,s){const n=qs(t),a=qs(e),i=qs(r),l=qs(a-n),c=qs(i-n),d=qs(n-a),u=qs(n-i);return n===a||n===i||s&&a===i||l>c&&d<u}function _s(t,e,r){return Math.max(e,Math.min(r,t))}function Sk(t){return _s(t,-32768,32767)}function ri(t,e,r,s=1e-6){return t>=Math.min(e,r)-s&&t<=Math.max(e,r)+s}function gm(t,e,r){r=r||(i=>t[i]<e);let s=t.length-1,n=0,a;for(;s-n>1;)a=n+s>>1,r(a)?n=a:s=a;return{lo:n,hi:s}}const Yh=(t,e,r,s)=>gm(t,r,s?n=>{const a=t[n][e];return a<r||a===r&&t[n+1][e]===r}:n=>t[n][e]<r),jk=(t,e,r)=>gm(t,r,s=>t[s][e]>=r);function Ck(t,e,r){let s=0,n=t.length;for(;s<n&&t[s]<e;)s++;for(;n>s&&t[n-1]>r;)n--;return s>0||n<t.length?t.slice(s,n):t}const Z0=["push","pop","shift","splice","unshift"];function Nk(t,e){if(t._chartjs){t._chartjs.listeners.push(e);return}Object.defineProperty(t,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),Z0.forEach(r=>{const s="_onData"+pm(r),n=t[r];Object.defineProperty(t,r,{configurable:!0,enumerable:!1,value(...a){const i=n.apply(this,a);return t._chartjs.listeners.forEach(l=>{typeof l[s]=="function"&&l[s](...a)}),i}})})}function Hg(t,e){const r=t._chartjs;if(!r)return;const s=r.listeners,n=s.indexOf(e);n!==-1&&s.splice(n,1),!(s.length>0)&&(Z0.forEach(a=>{delete t[a]}),delete t._chartjs)}function Ik(t){const e=new Set(t);return e.size===t.length?t:Array.from(e)}const X0=function(){return typeof window>"u"?function(t){return t()}:window.requestAnimationFrame}();function ex(t,e){let r=[],s=!1;return function(...n){r=n,s||(s=!0,X0.call(window,()=>{s=!1,t.apply(e,r)}))}}function kk(t,e){let r;return function(...s){return e?(clearTimeout(r),r=setTimeout(t,e,s)):t.apply(this,s),e}}const tx=t=>t==="start"?"left":t==="end"?"right":"center",ts=(t,e,r)=>t==="start"?e:t==="end"?r:(e+r)/2,Ek=(t,e,r,s)=>t===(s?"left":"right")?r:t==="center"?(e+r)/2:e,Ul=t=>t===0||t===1,zg=(t,e,r)=>-(Math.pow(2,10*(t-=1))*Math.sin((t-e)*Zt/r)),qg=(t,e,r)=>Math.pow(2,-10*t)*Math.sin((t-e)*Zt/r)+1,bi={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>-t*(t-2),easeInOutQuad:t=>(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1),easeInCubic:t=>t*t*t,easeOutCubic:t=>(t-=1)*t*t+1,easeInOutCubic:t=>(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2),easeInQuart:t=>t*t*t*t,easeOutQuart:t=>-((t-=1)*t*t*t-1),easeInOutQuart:t=>(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2),easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>(t-=1)*t*t*t*t+1,easeInOutQuint:t=>(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2),easeInSine:t=>-Math.cos(t*lr)+1,easeOutSine:t=>Math.sin(t*lr),easeInOutSine:t=>-.5*(Math.cos(St*t)-1),easeInExpo:t=>t===0?0:Math.pow(2,10*(t-1)),easeOutExpo:t=>t===1?1:-Math.pow(2,-10*t)+1,easeInOutExpo:t=>Ul(t)?t:t<.5?.5*Math.pow(2,10*(t*2-1)):.5*(-Math.pow(2,-10*(t*2-1))+2),easeInCirc:t=>t>=1?t:-(Math.sqrt(1-t*t)-1),easeOutCirc:t=>Math.sqrt(1-(t-=1)*t),easeInOutCirc:t=>(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1),easeInElastic:t=>Ul(t)?t:zg(t,.075,.3),easeOutElastic:t=>Ul(t)?t:qg(t,.075,.3),easeInOutElastic(t){return Ul(t)?t:t<.5?.5*zg(t*2,.1125,.45):.5+.5*qg(t*2-1,.1125,.45)},easeInBack(t){return t*t*((1.70158+1)*t-1.70158)},easeOutBack(t){return(t-=1)*t*((1.70158+1)*t+1.70158)+1},easeInOutBack(t){let e=1.70158;return(t/=.5)<1?.5*(t*t*(((e*=1.525)+1)*t-e)):.5*((t-=2)*t*(((e*=1.525)+1)*t+e)+2)},easeInBounce:t=>1-bi.easeOutBounce(1-t),easeOutBounce(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},easeInOutBounce:t=>t<.5?bi.easeInBounce(t*2)*.5:bi.easeOutBounce(t*2-1)*.5+.5};function rx(t){if(t&&typeof t=="object"){const e=t.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function Ug(t){return rx(t)?t:new Yi(t)}function Cu(t){return rx(t)?t:new Yi(t).saturate(.5).darken(.1).hexString()}const Tk=["x","y","borderWidth","radius","tension"],Lk=["color","borderColor","backgroundColor"];function Ak(t){t.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),t.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),t.set("animations",{colors:{type:"color",properties:Lk},numbers:{type:"number",properties:Tk}}),t.describe("animations",{_fallback:"animation"}),t.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function Dk(t){t.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const Wg=new Map;function Mk(t,e){e=e||{};const r=t+JSON.stringify(e);let s=Wg.get(r);return s||(s=new Intl.NumberFormat(t,e),Wg.set(r,s)),s}function Rk(t,e,r){return Mk(e,r).format(t)}const Pk={values(t){return _r(t)?t:""+t}};var Ok={formatters:Pk};function $k(t){t.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,r)=>r.lineWidth,tickColor:(e,r)=>r.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:Ok.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),t.route("scale.ticks","color","","color"),t.route("scale.grid","color","","borderColor"),t.route("scale.border","color","","borderColor"),t.route("scale.title","color","","color"),t.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),t.describe("scales",{_fallback:"scale"}),t.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}const Ia=Object.create(null),Qh=Object.create(null);function wi(t,e){if(!e)return t;const r=e.split(".");for(let s=0,n=r.length;s<n;++s){const a=r[s];t=t[a]||(t[a]=Object.create(null))}return t}function Nu(t,e,r){return typeof e=="string"?Qi(wi(t,e),r):Qi(wi(t,""),e)}class Fk{constructor(e,r){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=s=>s.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(s,n)=>Cu(n.backgroundColor),this.hoverBorderColor=(s,n)=>Cu(n.borderColor),this.hoverColor=(s,n)=>Cu(n.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(r)}set(e,r){return Nu(this,e,r)}get(e){return wi(this,e)}describe(e,r){return Nu(Qh,e,r)}override(e,r){return Nu(Ia,e,r)}route(e,r,s,n){const a=wi(this,e),i=wi(this,s),l="_"+r;Object.defineProperties(a,{[l]:{value:a[r],writable:!0},[r]:{enumerable:!0,get(){const c=this[l],d=i[n];return tt(c)?Object.assign({},d,c):dt(c,d)},set(c){this[l]=c}}})}apply(e){e.forEach(r=>r(this))}}var zt=new Fk({_scriptable:t=>!t.startsWith("on"),_indexable:t=>t!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[Ak,Dk,$k]);function Bk(t){return!t||Ir(t.size)||Ir(t.family)?null:(t.style?t.style+" ":"")+(t.weight?t.weight+" ":"")+t.size+"px "+t.family}function Gg(t,e,r,s,n){let a=e[n];return a||(a=e[n]=t.measureText(n).width,r.push(n)),a>s&&(s=a),s}function Xn(t,e,r){const s=t.currentDevicePixelRatio,n=r!==0?Math.max(r/2,.5):0;return Math.round((e-n)*s)/s+n}function Jg(t,e){!e&&!t||(e=e||t.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,t.width,t.height),e.restore())}function Kg(t,e,r,s){sx(t,e,r,s,null)}function sx(t,e,r,s,n){let a,i,l,c,d,u,h,f;const p=e.pointStyle,_=e.rotation,v=e.radius;let x=(_||0)*yk;if(p&&typeof p=="object"&&(a=p.toString(),a==="[object HTMLImageElement]"||a==="[object HTMLCanvasElement]")){t.save(),t.translate(r,s),t.rotate(x),t.drawImage(p,-p.width/2,-p.height/2,p.width,p.height),t.restore();return}if(!(isNaN(v)||v<=0)){switch(t.beginPath(),p){default:n?t.ellipse(r,s,n/2,v,0,0,Zt):t.arc(r,s,v,0,Zt),t.closePath();break;case"triangle":u=n?n/2:v,t.moveTo(r+Math.sin(x)*u,s-Math.cos(x)*v),x+=Bg,t.lineTo(r+Math.sin(x)*u,s-Math.cos(x)*v),x+=Bg,t.lineTo(r+Math.sin(x)*u,s-Math.cos(x)*v),t.closePath();break;case"rectRounded":d=v*.516,c=v-d,i=Math.cos(x+Zn)*c,h=Math.cos(x+Zn)*(n?n/2-d:c),l=Math.sin(x+Zn)*c,f=Math.sin(x+Zn)*(n?n/2-d:c),t.arc(r-h,s-l,d,x-St,x-lr),t.arc(r+f,s-i,d,x-lr,x),t.arc(r+h,s+l,d,x,x+lr),t.arc(r-f,s+i,d,x+lr,x+St),t.closePath();break;case"rect":if(!_){c=Math.SQRT1_2*v,u=n?n/2:c,t.rect(r-u,s-c,2*u,2*c);break}x+=Zn;case"rectRot":h=Math.cos(x)*(n?n/2:v),i=Math.cos(x)*v,l=Math.sin(x)*v,f=Math.sin(x)*(n?n/2:v),t.moveTo(r-h,s-l),t.lineTo(r+f,s-i),t.lineTo(r+h,s+l),t.lineTo(r-f,s+i),t.closePath();break;case"crossRot":x+=Zn;case"cross":h=Math.cos(x)*(n?n/2:v),i=Math.cos(x)*v,l=Math.sin(x)*v,f=Math.sin(x)*(n?n/2:v),t.moveTo(r-h,s-l),t.lineTo(r+h,s+l),t.moveTo(r+f,s-i),t.lineTo(r-f,s+i);break;case"star":h=Math.cos(x)*(n?n/2:v),i=Math.cos(x)*v,l=Math.sin(x)*v,f=Math.sin(x)*(n?n/2:v),t.moveTo(r-h,s-l),t.lineTo(r+h,s+l),t.moveTo(r+f,s-i),t.lineTo(r-f,s+i),x+=Zn,h=Math.cos(x)*(n?n/2:v),i=Math.cos(x)*v,l=Math.sin(x)*v,f=Math.sin(x)*(n?n/2:v),t.moveTo(r-h,s-l),t.lineTo(r+h,s+l),t.moveTo(r+f,s-i),t.lineTo(r-f,s+i);break;case"line":i=n?n/2:Math.cos(x)*v,l=Math.sin(x)*v,t.moveTo(r-i,s-l),t.lineTo(r+i,s+l);break;case"dash":t.moveTo(r,s),t.lineTo(r+Math.cos(x)*(n?n/2:v),s+Math.sin(x)*v);break;case!1:t.closePath();break}t.fill(),e.borderWidth>0&&t.stroke()}}function nx(t,e,r){return r=r||.5,!e||t&&t.x>e.left-r&&t.x<e.right+r&&t.y>e.top-r&&t.y<e.bottom+r}function _m(t,e){t.save(),t.beginPath(),t.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),t.clip()}function ym(t){t.restore()}function Vk(t,e){e.translation&&t.translate(e.translation[0],e.translation[1]),Ir(e.rotation)||t.rotate(e.rotation),e.color&&(t.fillStyle=e.color),e.textAlign&&(t.textAlign=e.textAlign),e.textBaseline&&(t.textBaseline=e.textBaseline)}function Hk(t,e,r,s,n){if(n.strikethrough||n.underline){const a=t.measureText(s),i=e-a.actualBoundingBoxLeft,l=e+a.actualBoundingBoxRight,c=r-a.actualBoundingBoxAscent,d=r+a.actualBoundingBoxDescent,u=n.strikethrough?(c+d)/2:d;t.strokeStyle=t.fillStyle,t.beginPath(),t.lineWidth=n.decorationWidth||2,t.moveTo(i,u),t.lineTo(l,u),t.stroke()}}function zk(t,e){const r=t.fillStyle;t.fillStyle=e.color,t.fillRect(e.left,e.top,e.width,e.height),t.fillStyle=r}function nd(t,e,r,s,n,a={}){const i=_r(e)?e:[e],l=a.strokeWidth>0&&a.strokeColor!=="";let c,d;for(t.save(),t.font=n.string,Vk(t,a),c=0;c<i.length;++c)d=i[c],a.backdrop&&zk(t,a.backdrop),l&&(a.strokeColor&&(t.strokeStyle=a.strokeColor),Ir(a.strokeWidth)||(t.lineWidth=a.strokeWidth),t.strokeText(d,r,s,a.maxWidth)),t.fillText(d,r,s,a.maxWidth),Hk(t,r,s,d,a),s+=Number(n.lineHeight);t.restore()}function Zh(t,e){const{x:r,y:s,w:n,h:a,radius:i}=e;t.arc(r+i.topLeft,s+i.topLeft,i.topLeft,1.5*St,St,!0),t.lineTo(r,s+a-i.bottomLeft),t.arc(r+i.bottomLeft,s+a-i.bottomLeft,i.bottomLeft,St,lr,!0),t.lineTo(r+n-i.bottomRight,s+a),t.arc(r+n-i.bottomRight,s+a-i.bottomRight,i.bottomRight,lr,0,!0),t.lineTo(r+n,s+i.topRight),t.arc(r+n-i.topRight,s+i.topRight,i.topRight,0,-lr,!0),t.lineTo(r+i.topLeft,s)}const qk=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,Uk=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function Wk(t,e){const r=(""+t).match(qk);if(!r||r[1]==="normal")return e*1.2;switch(t=+r[2],r[3]){case"px":return t;case"%":t/=100;break}return e*t}const Gk=t=>+t||0;function vm(t,e){const r={},s=tt(e),n=s?Object.keys(e):e,a=tt(t)?s?i=>dt(t[i],t[e[i]]):i=>t[i]:()=>t;for(const i of n)r[i]=Gk(a(i));return r}function Jk(t){return vm(t,{top:"y",right:"x",bottom:"y",left:"x"})}function Si(t){return vm(t,["topLeft","topRight","bottomLeft","bottomRight"])}function Rs(t){const e=Jk(t);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function Qr(t,e){t=t||{},e=e||zt.font;let r=dt(t.size,e.size);typeof r=="string"&&(r=parseInt(r,10));let s=dt(t.style,e.style);s&&!(""+s).match(Uk)&&(console.warn('Invalid font style specified: "'+s+'"'),s=void 0);const n={family:dt(t.family,e.family),lineHeight:Wk(dt(t.lineHeight,e.lineHeight),r),size:r,style:s,weight:dt(t.weight,e.weight),string:""};return n.string=Bk(n),n}function Wl(t,e,r,s){let n,a,i;for(n=0,a=t.length;n<a;++n)if(i=t[n],i!==void 0&&i!==void 0)return i}function Kk(t,e,r){const{min:s,max:n}=t,a=K0(e,(n-s)/2),i=(l,c)=>r&&l===0?0:l+c;return{min:i(s,-Math.abs(a)),max:i(n,a)}}function Lo(t,e){return Object.assign(Object.create(t),e)}function xm(t,e=[""],r,s,n=()=>t[0]){const a=r||t;typeof s>"u"&&(s=lx("_fallback",t));const i={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:t,_rootScopes:a,_fallback:s,_getTarget:n,override:l=>xm([l,...t],e,a,s)};return new Proxy(i,{deleteProperty(l,c){return delete l[c],delete l._keys,delete t[0][c],!0},get(l,c){return ox(l,c,()=>sE(c,e,t,l))},getOwnPropertyDescriptor(l,c){return Reflect.getOwnPropertyDescriptor(l._scopes[0],c)},getPrototypeOf(){return Reflect.getPrototypeOf(t[0])},has(l,c){return Qg(l).includes(c)},ownKeys(l){return Qg(l)},set(l,c,d){const u=l._storage||(l._storage=n());return l[c]=u[c]=d,delete l._keys,!0}})}function wo(t,e,r,s){const n={_cacheable:!1,_proxy:t,_context:e,_subProxy:r,_stack:new Set,_descriptors:ax(t,s),setContext:a=>wo(t,a,r,s),override:a=>wo(t.override(a),e,r,s)};return new Proxy(n,{deleteProperty(a,i){return delete a[i],delete t[i],!0},get(a,i,l){return ox(a,i,()=>Qk(a,i,l))},getOwnPropertyDescriptor(a,i){return a._descriptors.allKeys?Reflect.has(t,i)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(t,i)},getPrototypeOf(){return Reflect.getPrototypeOf(t)},has(a,i){return Reflect.has(t,i)},ownKeys(){return Reflect.ownKeys(t)},set(a,i,l){return t[i]=l,delete a[i],!0}})}function ax(t,e={scriptable:!0,indexable:!0}){const{_scriptable:r=e.scriptable,_indexable:s=e.indexable,_allKeys:n=e.allKeys}=t;return{allKeys:n,scriptable:r,indexable:s,isScriptable:zn(r)?r:()=>r,isIndexable:zn(s)?s:()=>s}}const Yk=(t,e)=>t?t+pm(e):e,bm=(t,e)=>tt(e)&&t!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function ox(t,e,r){if(Object.prototype.hasOwnProperty.call(t,e)||e==="constructor")return t[e];const s=r();return t[e]=s,s}function Qk(t,e,r){const{_proxy:s,_context:n,_subProxy:a,_descriptors:i}=t;let l=s[e];return zn(l)&&i.isScriptable(e)&&(l=Zk(e,l,t,r)),_r(l)&&l.length&&(l=Xk(e,l,t,i.isIndexable)),bm(e,l)&&(l=wo(l,n,a&&a[e],i)),l}function Zk(t,e,r,s){const{_proxy:n,_context:a,_subProxy:i,_stack:l}=r;if(l.has(t))throw new Error("Recursion detected: "+Array.from(l).join("->")+"->"+t);l.add(t);let c=e(a,i||s);return l.delete(t),bm(t,c)&&(c=wm(n._scopes,n,t,c)),c}function Xk(t,e,r,s){const{_proxy:n,_context:a,_subProxy:i,_descriptors:l}=r;if(typeof a.index<"u"&&s(t))return e[a.index%e.length];if(tt(e[0])){const c=e,d=n._scopes.filter(u=>u!==c);e=[];for(const u of c){const h=wm(d,n,t,u);e.push(wo(h,a,i&&i[t],l))}}return e}function ix(t,e,r){return zn(t)?t(e,r):t}const eE=(t,e)=>t===!0?e:typeof t=="string"?Zi(e,t):void 0;function tE(t,e,r,s,n){for(const a of e){const i=eE(r,a);if(i){t.add(i);const l=ix(i._fallback,r,n);if(typeof l<"u"&&l!==r&&l!==s)return l}else if(i===!1&&typeof s<"u"&&r!==s)return null}return!1}function wm(t,e,r,s){const n=e._rootScopes,a=ix(e._fallback,r,s),i=[...t,...n],l=new Set;l.add(s);let c=Yg(l,i,r,a||r,s);return c===null||typeof a<"u"&&a!==r&&(c=Yg(l,i,a,c,s),c===null)?!1:xm(Array.from(l),[""],n,a,()=>rE(e,r,s))}function Yg(t,e,r,s,n){for(;r;)r=tE(t,e,r,s,n);return r}function rE(t,e,r){const s=t._getTarget();e in s||(s[e]={});const n=s[e];return _r(n)&&tt(r)?r:n||{}}function sE(t,e,r,s){let n;for(const a of e)if(n=lx(Yk(a,t),r),typeof n<"u")return bm(t,n)?wm(r,s,t,n):n}function lx(t,e){for(const r of e){if(!r)continue;const s=r[t];if(typeof s<"u")return s}}function Qg(t){let e=t._keys;return e||(e=t._keys=nE(t._scopes)),e}function nE(t){const e=new Set;for(const r of t)for(const s of Object.keys(r).filter(n=>!n.startsWith("_")))e.add(s);return Array.from(e)}function Sm(){return typeof window<"u"&&typeof document<"u"}function jm(t){let e=t.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function ad(t,e,r){let s;return typeof t=="string"?(s=parseInt(t,10),t.indexOf("%")!==-1&&(s=s/100*e.parentNode[r])):s=t,s}const Dd=t=>t.ownerDocument.defaultView.getComputedStyle(t,null);function aE(t,e){return Dd(t).getPropertyValue(e)}const oE=["top","right","bottom","left"];function ba(t,e,r){const s={};r=r?"-"+r:"";for(let n=0;n<4;n++){const a=oE[n];s[a]=parseFloat(t[e+"-"+a+r])||0}return s.width=s.left+s.right,s.height=s.top+s.bottom,s}const iE=(t,e,r)=>(t>0||e>0)&&(!r||!r.shadowRoot);function lE(t,e){const r=t.touches,s=r&&r.length?r[0]:t,{offsetX:n,offsetY:a}=s;let i=!1,l,c;if(iE(n,a,t.target))l=n,c=a;else{const d=e.getBoundingClientRect();l=s.clientX-d.left,c=s.clientY-d.top,i=!0}return{x:l,y:c,box:i}}function la(t,e){if("native"in t)return t;const{canvas:r,currentDevicePixelRatio:s}=e,n=Dd(r),a=n.boxSizing==="border-box",i=ba(n,"padding"),l=ba(n,"border","width"),{x:c,y:d,box:u}=lE(t,r),h=i.left+(u&&l.left),f=i.top+(u&&l.top);let{width:p,height:_}=e;return a&&(p-=i.width+l.width,_-=i.height+l.height),{x:Math.round((c-h)/p*r.width/s),y:Math.round((d-f)/_*r.height/s)}}function cE(t,e,r){let s,n;if(e===void 0||r===void 0){const a=t&&jm(t);if(!a)e=t.clientWidth,r=t.clientHeight;else{const i=a.getBoundingClientRect(),l=Dd(a),c=ba(l,"border","width"),d=ba(l,"padding");e=i.width-d.width-c.width,r=i.height-d.height-c.height,s=ad(l.maxWidth,a,"clientWidth"),n=ad(l.maxHeight,a,"clientHeight")}}return{width:e,height:r,maxWidth:s||td,maxHeight:n||td}}const En=t=>Math.round(t*10)/10;function dE(t,e,r,s){const n=Dd(t),a=ba(n,"margin"),i=ad(n.maxWidth,t,"clientWidth")||td,l=ad(n.maxHeight,t,"clientHeight")||td,c=cE(t,e,r);let{width:d,height:u}=c;if(n.boxSizing==="content-box"){const f=ba(n,"border","width"),p=ba(n,"padding");d-=p.width+f.width,u-=p.height+f.height}return d=Math.max(0,d-a.width),u=Math.max(0,s?d/s:u-a.height),d=En(Math.min(d,i,c.maxWidth)),u=En(Math.min(u,l,c.maxHeight)),d&&!u&&(u=En(d/2)),(e!==void 0||r!==void 0)&&s&&c.height&&u>c.height&&(u=c.height,d=En(Math.floor(u*s))),{width:d,height:u}}function Zg(t,e,r){const s=e||1,n=En(t.height*s),a=En(t.width*s);t.height=En(t.height),t.width=En(t.width);const i=t.canvas;return i.style&&(r||!i.style.height&&!i.style.width)&&(i.style.height=`${t.height}px`,i.style.width=`${t.width}px`),t.currentDevicePixelRatio!==s||i.height!==n||i.width!==a?(t.currentDevicePixelRatio=s,i.height=n,i.width=a,t.ctx.setTransform(s,0,0,s,0,0),!0):!1}const uE=function(){let t=!1;try{const e={get passive(){return t=!0,!1}};Sm()&&(window.addEventListener("test",null,e),window.removeEventListener("test",null,e))}catch{}return t}();function Xg(t,e){const r=aE(t,e),s=r&&r.match(/^(\d+)(\.\d+)?px$/);return s?+s[1]:void 0}const hE=function(t,e){return{x(r){return t+t+e-r},setWidth(r){e=r},textAlign(r){return r==="center"?r:r==="right"?"left":"right"},xPlus(r,s){return r-s},leftForLtr(r,s){return r-s}}},fE=function(){return{x(t){return t},setWidth(t){},textAlign(t){return t},xPlus(t,e){return t+e},leftForLtr(t,e){return t}}};function uo(t,e,r){return t?hE(e,r):fE()}function cx(t,e){let r,s;(e==="ltr"||e==="rtl")&&(r=t.canvas.style,s=[r.getPropertyValue("direction"),r.getPropertyPriority("direction")],r.setProperty("direction",e,"important"),t.prevTextDirection=s)}function dx(t,e){e!==void 0&&(delete t.prevTextDirection,t.canvas.style.setProperty("direction",e[0],e[1]))}function Gl(t,e,r){return t.options.clip?t[r]:e[r]}function mE(t,e){const{xScale:r,yScale:s}=t;return r&&s?{left:Gl(r,e,"left"),right:Gl(r,e,"right"),top:Gl(s,e,"top"),bottom:Gl(s,e,"bottom")}:e}function pE(t,e){const r=e._clip;if(r.disabled)return!1;const s=mE(e,t.chartArea);return{left:r.left===!1?0:s.left-(r.left===!0?0:r.left),right:r.right===!1?t.width:s.right+(r.right===!0?0:r.right),top:r.top===!1?0:s.top-(r.top===!0?0:r.top),bottom:r.bottom===!1?t.height:s.bottom+(r.bottom===!0?0:r.bottom)}}/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */class gE{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,r,s,n){const a=r.listeners[n],i=r.duration;a.forEach(l=>l({chart:e,initial:r.initial,numSteps:i,currentStep:Math.min(s-r.start,i)}))}_refresh(){this._request||(this._running=!0,this._request=X0.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let r=0;this._charts.forEach((s,n)=>{if(!s.running||!s.items.length)return;const a=s.items;let i=a.length-1,l=!1,c;for(;i>=0;--i)c=a[i],c._active?(c._total>s.duration&&(s.duration=c._total),c.tick(e),l=!0):(a[i]=a[a.length-1],a.pop());l&&(n.draw(),this._notify(n,s,e,"progress")),a.length||(s.running=!1,this._notify(n,s,e,"complete"),s.initial=!1),r+=a.length}),this._lastDate=e,r===0&&(this._running=!1)}_getAnims(e){const r=this._charts;let s=r.get(e);return s||(s={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},r.set(e,s)),s}listen(e,r,s){this._getAnims(e).listeners[r].push(s)}add(e,r){!r||!r.length||this._getAnims(e).items.push(...r)}has(e){return this._getAnims(e).items.length>0}start(e){const r=this._charts.get(e);r&&(r.running=!0,r.start=Date.now(),r.duration=r.items.reduce((s,n)=>Math.max(s,n._duration),0),this._refresh())}running(e){if(!this._running)return!1;const r=this._charts.get(e);return!(!r||!r.running||!r.items.length)}stop(e){const r=this._charts.get(e);if(!r||!r.items.length)return;const s=r.items;let n=s.length-1;for(;n>=0;--n)s[n].cancel();r.items=[],this._notify(e,r,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var Qs=new gE;const e_="transparent",_E={boolean(t,e,r){return r>.5?e:t},color(t,e,r){const s=Ug(t||e_),n=s.valid&&Ug(e||e_);return n&&n.valid?n.mix(s,r).hexString():e},number(t,e,r){return t+(e-t)*r}};class yE{constructor(e,r,s,n){const a=r[s];n=Wl([e.to,n,a,e.from]);const i=Wl([e.from,a,n]);this._active=!0,this._fn=e.fn||_E[e.type||typeof i],this._easing=bi[e.easing]||bi.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=r,this._prop=s,this._from=i,this._to=n,this._promises=void 0}active(){return this._active}update(e,r,s){if(this._active){this._notify(!1);const n=this._target[this._prop],a=s-this._start,i=this._duration-a;this._start=s,this._duration=Math.floor(Math.max(i,e.duration)),this._total+=a,this._loop=!!e.loop,this._to=Wl([e.to,r,n,e.from]),this._from=Wl([e.from,n,r])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const r=e-this._start,s=this._duration,n=this._prop,a=this._from,i=this._loop,l=this._to;let c;if(this._active=a!==l&&(i||r<s),!this._active){this._target[n]=l,this._notify(!0);return}if(r<0){this._target[n]=a;return}c=r/s%2,c=i&&c>1?2-c:c,c=this._easing(Math.min(1,Math.max(0,c))),this._target[n]=this._fn(a,l,c)}wait(){const e=this._promises||(this._promises=[]);return new Promise((r,s)=>{e.push({res:r,rej:s})})}_notify(e){const r=e?"res":"rej",s=this._promises||[];for(let n=0;n<s.length;n++)s[n][r]()}}class ux{constructor(e,r){this._chart=e,this._properties=new Map,this.configure(r)}configure(e){if(!tt(e))return;const r=Object.keys(zt.animation),s=this._properties;Object.getOwnPropertyNames(e).forEach(n=>{const a=e[n];if(!tt(a))return;const i={};for(const l of r)i[l]=a[l];(_r(a.properties)&&a.properties||[n]).forEach(l=>{(l===n||!s.has(l))&&s.set(l,i)})})}_animateOptions(e,r){const s=r.options,n=xE(e,s);if(!n)return[];const a=this._createAnimations(n,s);return s.$shared&&vE(e.options.$animations,s).then(()=>{e.options=s},()=>{}),a}_createAnimations(e,r){const s=this._properties,n=[],a=e.$animations||(e.$animations={}),i=Object.keys(r),l=Date.now();let c;for(c=i.length-1;c>=0;--c){const d=i[c];if(d.charAt(0)==="$")continue;if(d==="options"){n.push(...this._animateOptions(e,r));continue}const u=r[d];let h=a[d];const f=s.get(d);if(h)if(f&&h.active()){h.update(f,u,l);continue}else h.cancel();if(!f||!f.duration){e[d]=u;continue}a[d]=h=new yE(f,e,d,u),n.push(h)}return n}update(e,r){if(this._properties.size===0){Object.assign(e,r);return}const s=this._createAnimations(e,r);if(s.length)return Qs.add(this._chart,s),!0}}function vE(t,e){const r=[],s=Object.keys(e);for(let n=0;n<s.length;n++){const a=t[s[n]];a&&a.active()&&r.push(a.wait())}return Promise.all(r)}function xE(t,e){if(!e)return;let r=t.options;if(!r){t.options=e;return}return r.$shared&&(t.options=r=Object.assign({},r,{$shared:!1,$animations:{}})),r}function t_(t,e){const r=t&&t.options||{},s=r.reverse,n=r.min===void 0?e:0,a=r.max===void 0?e:0;return{start:s?a:n,end:s?n:a}}function bE(t,e,r){if(r===!1)return!1;const s=t_(t,r),n=t_(e,r);return{top:n.end,right:s.end,bottom:n.start,left:s.start}}function wE(t){let e,r,s,n;return tt(t)?(e=t.top,r=t.right,s=t.bottom,n=t.left):e=r=s=n=t,{top:e,right:r,bottom:s,left:n,disabled:t===!1}}function hx(t,e){const r=[],s=t._getSortedDatasetMetas(e);let n,a;for(n=0,a=s.length;n<a;++n)r.push(s[n].index);return r}function r_(t,e,r,s={}){const n=t.keys,a=s.mode==="single";let i,l,c,d;if(e===null)return;let u=!1;for(i=0,l=n.length;i<l;++i){if(c=+n[i],c===r){if(u=!0,s.all)continue;break}d=t.values[c],un(d)&&(a||e===0||Vg(e)===Vg(d))&&(e+=d)}return!u&&!s.all?0:e}function SE(t,e){const{iScale:r,vScale:s}=e,n=r.axis==="x"?"x":"y",a=s.axis==="x"?"x":"y",i=Object.keys(t),l=new Array(i.length);let c,d,u;for(c=0,d=i.length;c<d;++c)u=i[c],l[c]={[n]:u,[a]:t[u]};return l}function Iu(t,e){const r=t&&t.options.stacked;return r||r===void 0&&e.stack!==void 0}function jE(t,e,r){return`${t.id}.${e.id}.${r.stack||r.type}`}function CE(t){const{min:e,max:r,minDefined:s,maxDefined:n}=t.getUserBounds();return{min:s?e:Number.NEGATIVE_INFINITY,max:n?r:Number.POSITIVE_INFINITY}}function NE(t,e,r){const s=t[e]||(t[e]={});return s[r]||(s[r]={})}function s_(t,e,r,s){for(const n of e.getMatchingVisibleMetas(s).reverse()){const a=t[n.index];if(r&&a>0||!r&&a<0)return n.index}return null}function n_(t,e){const{chart:r,_cachedMeta:s}=t,n=r._stacks||(r._stacks={}),{iScale:a,vScale:i,index:l}=s,c=a.axis,d=i.axis,u=jE(a,i,s),h=e.length;let f;for(let p=0;p<h;++p){const _=e[p],{[c]:v,[d]:x}=_,m=_._stacks||(_._stacks={});f=m[d]=NE(n,u,v),f[l]=x,f._top=s_(f,i,!0,s.type),f._bottom=s_(f,i,!1,s.type);const g=f._visualValues||(f._visualValues={});g[l]=x}}function ku(t,e){const r=t.scales;return Object.keys(r).filter(s=>r[s].axis===e).shift()}function IE(t,e){return Lo(t,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function kE(t,e,r){return Lo(t,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:r,index:e,mode:"default",type:"data"})}function qo(t,e){const r=t.controller.index,s=t.vScale&&t.vScale.axis;if(s){e=e||t._parsed;for(const n of e){const a=n._stacks;if(!a||a[s]===void 0||a[s][r]===void 0)return;delete a[s][r],a[s]._visualValues!==void 0&&a[s]._visualValues[r]!==void 0&&delete a[s]._visualValues[r]}}}const Eu=t=>t==="reset"||t==="none",a_=(t,e)=>e?t:Object.assign({},t),EE=(t,e,r)=>t&&!e.hidden&&e._stacked&&{keys:hx(r,!0),values:null};class ji{constructor(e,r){this.chart=e,this._ctx=e.ctx,this.index=r,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=Iu(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&qo(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,r=this._cachedMeta,s=this.getDataset(),n=(h,f,p,_)=>h==="x"?f:h==="r"?_:p,a=r.xAxisID=dt(s.xAxisID,ku(e,"x")),i=r.yAxisID=dt(s.yAxisID,ku(e,"y")),l=r.rAxisID=dt(s.rAxisID,ku(e,"r")),c=r.indexAxis,d=r.iAxisID=n(c,a,i,l),u=r.vAxisID=n(c,i,a,l);r.xScale=this.getScaleForId(a),r.yScale=this.getScaleForId(i),r.rScale=this.getScaleForId(l),r.iScale=this.getScaleForId(d),r.vScale=this.getScaleForId(u)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const r=this._cachedMeta;return e===r.iScale?r.vScale:r.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&Hg(this._data,this),e._stacked&&qo(e)}_dataCheck(){const e=this.getDataset(),r=e.data||(e.data=[]),s=this._data;if(tt(r)){const n=this._cachedMeta;this._data=SE(r,n)}else if(s!==r){if(s){Hg(s,this);const n=this._cachedMeta;qo(n),n._parsed=[]}r&&Object.isExtensible(r)&&Nk(r,this),this._syncList=[],this._data=r}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const r=this._cachedMeta,s=this.getDataset();let n=!1;this._dataCheck();const a=r._stacked;r._stacked=Iu(r.vScale,r),r.stack!==s.stack&&(n=!0,qo(r),r.stack=s.stack),this._resyncElements(e),(n||a!==r._stacked)&&(n_(this,r._parsed),r._stacked=Iu(r.vScale,r))}configure(){const e=this.chart.config,r=e.datasetScopeKeys(this._type),s=e.getOptionScopes(this.getDataset(),r,!0);this.options=e.createResolver(s,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,r){const{_cachedMeta:s,_data:n}=this,{iScale:a,_stacked:i}=s,l=a.axis;let c=e===0&&r===n.length?!0:s._sorted,d=e>0&&s._parsed[e-1],u,h,f;if(this._parsing===!1)s._parsed=n,s._sorted=!0,f=n;else{_r(n[e])?f=this.parseArrayData(s,n,e,r):tt(n[e])?f=this.parseObjectData(s,n,e,r):f=this.parsePrimitiveData(s,n,e,r);const p=()=>h[l]===null||d&&h[l]<d[l];for(u=0;u<r;++u)s._parsed[u+e]=h=f[u],c&&(p()&&(c=!1),d=h);s._sorted=c}i&&n_(this,f)}parsePrimitiveData(e,r,s,n){const{iScale:a,vScale:i}=e,l=a.axis,c=i.axis,d=a.getLabels(),u=a===i,h=new Array(n);let f,p,_;for(f=0,p=n;f<p;++f)_=f+s,h[f]={[l]:u||a.parse(d[_],_),[c]:i.parse(r[_],_)};return h}parseArrayData(e,r,s,n){const{xScale:a,yScale:i}=e,l=new Array(n);let c,d,u,h;for(c=0,d=n;c<d;++c)u=c+s,h=r[u],l[c]={x:a.parse(h[0],u),y:i.parse(h[1],u)};return l}parseObjectData(e,r,s,n){const{xScale:a,yScale:i}=e,{xAxisKey:l="x",yAxisKey:c="y"}=this._parsing,d=new Array(n);let u,h,f,p;for(u=0,h=n;u<h;++u)f=u+s,p=r[f],d[u]={x:a.parse(Zi(p,l),f),y:i.parse(Zi(p,c),f)};return d}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,r,s){const n=this.chart,a=this._cachedMeta,i=r[e.axis],l={keys:hx(n,!0),values:r._stacks[e.axis]._visualValues};return r_(l,i,a.index,{mode:s})}updateRangeFromParsed(e,r,s,n){const a=s[r.axis];let i=a===null?NaN:a;const l=n&&s._stacks[r.axis];n&&l&&(n.values=l,i=r_(n,a,this._cachedMeta.index)),e.min=Math.min(e.min,i),e.max=Math.max(e.max,i)}getMinMax(e,r){const s=this._cachedMeta,n=s._parsed,a=s._sorted&&e===s.iScale,i=n.length,l=this._getOtherScale(e),c=EE(r,s,this.chart),d={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:u,max:h}=CE(l);let f,p;function _(){p=n[f];const v=p[l.axis];return!un(p[e.axis])||u>v||h<v}for(f=0;f<i&&!(!_()&&(this.updateRangeFromParsed(d,e,p,c),a));++f);if(a){for(f=i-1;f>=0;--f)if(!_()){this.updateRangeFromParsed(d,e,p,c);break}}return d}getAllParsedValues(e){const r=this._cachedMeta._parsed,s=[];let n,a,i;for(n=0,a=r.length;n<a;++n)i=r[n][e.axis],un(i)&&s.push(i);return s}getMaxOverflow(){return!1}getLabelAndValue(e){const r=this._cachedMeta,s=r.iScale,n=r.vScale,a=this.getParsed(e);return{label:s?""+s.getLabelForValue(a[s.axis]):"",value:n?""+n.getLabelForValue(a[n.axis]):""}}_update(e){const r=this._cachedMeta;this.update(e||"default"),r._clip=wE(dt(this.options.clip,bE(r.xScale,r.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,r=this.chart,s=this._cachedMeta,n=s.data||[],a=r.chartArea,i=[],l=this._drawStart||0,c=this._drawCount||n.length-l,d=this.options.drawActiveElementsOnTop;let u;for(s.dataset&&s.dataset.draw(e,a,l,c),u=l;u<l+c;++u){const h=n[u];h.hidden||(h.active&&d?i.push(h):h.draw(e,a))}for(u=0;u<i.length;++u)i[u].draw(e,a)}getStyle(e,r){const s=r?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(s):this.resolveDataElementOptions(e||0,s)}getContext(e,r,s){const n=this.getDataset();let a;if(e>=0&&e<this._cachedMeta.data.length){const i=this._cachedMeta.data[e];a=i.$context||(i.$context=kE(this.getContext(),e,i)),a.parsed=this.getParsed(e),a.raw=n.data[e],a.index=a.dataIndex=e}else a=this.$context||(this.$context=IE(this.chart.getContext(),this.index)),a.dataset=n,a.index=a.datasetIndex=this.index;return a.active=!!r,a.mode=s,a}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,r){return this._resolveElementOptions(this.dataElementType.id,r,e)}_resolveElementOptions(e,r="default",s){const n=r==="active",a=this._cachedDataOpts,i=e+"-"+r,l=a[i],c=this.enableOptionSharing&&ed(s);if(l)return a_(l,c);const d=this.chart.config,u=d.datasetElementScopeKeys(this._type,e),h=n?[`${e}Hover`,"hover",e,""]:[e,""],f=d.getOptionScopes(this.getDataset(),u),p=Object.keys(zt.elements[e]),_=()=>this.getContext(s,n,r),v=d.resolveNamedOptions(f,p,_,h);return v.$shared&&(v.$shared=c,a[i]=Object.freeze(a_(v,c))),v}_resolveAnimations(e,r,s){const n=this.chart,a=this._cachedDataOpts,i=`animation-${r}`,l=a[i];if(l)return l;let c;if(n.options.animation!==!1){const u=this.chart.config,h=u.datasetAnimationScopeKeys(this._type,r),f=u.getOptionScopes(this.getDataset(),h);c=u.createResolver(f,this.getContext(e,s,r))}const d=new ux(n,c&&c.animations);return c&&c._cacheable&&(a[i]=Object.freeze(d)),d}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,r){return!r||Eu(e)||this.chart._animationsDisabled}_getSharedOptions(e,r){const s=this.resolveDataElementOptions(e,r),n=this._sharedOptions,a=this.getSharedOptions(s),i=this.includeOptions(r,a)||a!==n;return this.updateSharedOptions(a,r,s),{sharedOptions:a,includeOptions:i}}updateElement(e,r,s,n){Eu(n)?Object.assign(e,s):this._resolveAnimations(r,n).update(e,s)}updateSharedOptions(e,r,s){e&&!Eu(r)&&this._resolveAnimations(void 0,r).update(e,s)}_setStyle(e,r,s,n){e.active=n;const a=this.getStyle(r,n);this._resolveAnimations(r,s,n).update(e,{options:!n&&this.getSharedOptions(a)||a})}removeHoverStyle(e,r,s){this._setStyle(e,s,"active",!1)}setHoverStyle(e,r,s){this._setStyle(e,s,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const r=this._data,s=this._cachedMeta.data;for(const[l,c,d]of this._syncList)this[l](c,d);this._syncList=[];const n=s.length,a=r.length,i=Math.min(a,n);i&&this.parse(0,i),a>n?this._insertElements(n,a-n,e):a<n&&this._removeElements(a,n-a)}_insertElements(e,r,s=!0){const n=this._cachedMeta,a=n.data,i=e+r;let l;const c=d=>{for(d.length+=r,l=d.length-1;l>=i;l--)d[l]=d[l-r]};for(c(a),l=e;l<i;++l)a[l]=new this.dataElementType;this._parsing&&c(n._parsed),this.parse(e,r),s&&this.updateElements(a,e,r,"reset")}updateElements(e,r,s,n){}_removeElements(e,r){const s=this._cachedMeta;if(this._parsing){const n=s._parsed.splice(e,r);s._stacked&&qo(s,n)}s.data.splice(e,r)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[r,s,n]=e;this[r](s,n)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,r){r&&this._sync(["_removeElements",e,r]);const s=arguments.length-2;s&&this._sync(["_insertElements",e,s])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}W(ji,"defaults",{}),W(ji,"datasetElementType",null),W(ji,"dataElementType",null);function TE(t,e,r){let s=1,n=1,a=0,i=0;if(e<Zt){const l=t,c=l+e,d=Math.cos(l),u=Math.sin(l),h=Math.cos(c),f=Math.sin(c),p=(y,w,b)=>sd(y,l,c,!0)?1:Math.max(w,w*r,b,b*r),_=(y,w,b)=>sd(y,l,c,!0)?-1:Math.min(w,w*r,b,b*r),v=p(0,d,h),x=p(lr,u,f),m=_(St,d,h),g=_(St+lr,u,f);s=(v-m)/2,n=(x-g)/2,a=-(v+m)/2,i=-(x+g)/2}return{ratioX:s,ratioY:n,offsetX:a,offsetY:i}}class si extends ji{constructor(e,r){super(e,r),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,r){const s=this.getDataset().data,n=this._cachedMeta;if(this._parsing===!1)n._parsed=s;else{let a=c=>+s[c];if(tt(s[e])){const{key:c="value"}=this._parsing;a=d=>+Zi(s[d],c)}let i,l;for(i=e,l=e+r;i<l;++i)n._parsed[i]=a(i)}}_getRotation(){return _a(this.options.rotation-90)}_getCircumference(){return _a(this.options.circumference)}_getRotationExtents(){let e=Zt,r=-Zt;for(let s=0;s<this.chart.data.datasets.length;++s)if(this.chart.isDatasetVisible(s)&&this.chart.getDatasetMeta(s).type===this._type){const n=this.chart.getDatasetMeta(s).controller,a=n._getRotation(),i=n._getCircumference();e=Math.min(e,a),r=Math.max(r,a+i)}return{rotation:e,circumference:r-e}}update(e){const r=this.chart,{chartArea:s}=r,n=this._cachedMeta,a=n.data,i=this.getMaxBorderWidth()+this.getMaxOffset(a)+this.options.spacing,l=Math.max((Math.min(s.width,s.height)-i)/2,0),c=Math.min(hk(this.options.cutout,l),1),d=this._getRingWeight(this.index),{circumference:u,rotation:h}=this._getRotationExtents(),{ratioX:f,ratioY:p,offsetX:_,offsetY:v}=TE(h,u,c),x=(s.width-i)/f,m=(s.height-i)/p,g=Math.max(Math.min(x,m)/2,0),y=K0(this.options.radius,g),w=Math.max(y*c,0),b=(y-w)/this._getVisibleDatasetWeightTotal();this.offsetX=_*y,this.offsetY=v*y,n.total=this.calculateTotal(),this.outerRadius=y-b*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-b*d,0),this.updateElements(a,0,a.length,e)}_circumference(e,r){const s=this.options,n=this._cachedMeta,a=this._getCircumference();return r&&s.animation.animateRotate||!this.chart.getDataVisibility(e)||n._parsed[e]===null||n.data[e].hidden?0:this.calculateCircumference(n._parsed[e]*a/Zt)}updateElements(e,r,s,n){const a=n==="reset",i=this.chart,l=i.chartArea,d=i.options.animation,u=(l.left+l.right)/2,h=(l.top+l.bottom)/2,f=a&&d.animateScale,p=f?0:this.innerRadius,_=f?0:this.outerRadius,{sharedOptions:v,includeOptions:x}=this._getSharedOptions(r,n);let m=this._getRotation(),g;for(g=0;g<r;++g)m+=this._circumference(g,a);for(g=r;g<r+s;++g){const y=this._circumference(g,a),w=e[g],b={x:u+this.offsetX,y:h+this.offsetY,startAngle:m,endAngle:m+y,circumference:y,outerRadius:_,innerRadius:p};x&&(b.options=v||this.resolveDataElementOptions(g,w.active?"active":n)),m+=y,this.updateElement(w,g,b,n)}}calculateTotal(){const e=this._cachedMeta,r=e.data;let s=0,n;for(n=0;n<r.length;n++){const a=e._parsed[n];a!==null&&!isNaN(a)&&this.chart.getDataVisibility(n)&&!r[n].hidden&&(s+=Math.abs(a))}return s}calculateCircumference(e){const r=this._cachedMeta.total;return r>0&&!isNaN(e)?Zt*(Math.abs(e)/r):0}getLabelAndValue(e){const r=this._cachedMeta,s=this.chart,n=s.data.labels||[],a=Rk(r._parsed[e],s.options.locale);return{label:n[e]||"",value:a}}getMaxBorderWidth(e){let r=0;const s=this.chart;let n,a,i,l,c;if(!e){for(n=0,a=s.data.datasets.length;n<a;++n)if(s.isDatasetVisible(n)){i=s.getDatasetMeta(n),e=i.data,l=i.controller;break}}if(!e)return 0;for(n=0,a=e.length;n<a;++n)c=l.resolveDataElementOptions(n),c.borderAlign!=="inner"&&(r=Math.max(r,c.borderWidth||0,c.hoverBorderWidth||0));return r}getMaxOffset(e){let r=0;for(let s=0,n=e.length;s<n;++s){const a=this.resolveDataElementOptions(s);r=Math.max(r,a.offset||0,a.hoverOffset||0)}return r}_getRingWeightOffset(e){let r=0;for(let s=0;s<e;++s)this.chart.isDatasetVisible(s)&&(r+=this._getRingWeight(s));return r}_getRingWeight(e){return Math.max(dt(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}W(si,"id","doughnut"),W(si,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),W(si,"descriptors",{_scriptable:e=>e!=="spacing",_indexable:e=>e!=="spacing"&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")}),W(si,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const r=e.data,{labels:{pointStyle:s,textAlign:n,color:a,useBorderRadius:i,borderRadius:l}}=e.legend.options;return r.labels.length&&r.datasets.length?r.labels.map((c,d)=>{const h=e.getDatasetMeta(0).controller.getStyle(d);return{text:c,fillStyle:h.backgroundColor,fontColor:a,hidden:!e.getDataVisibility(d),lineDash:h.borderDash,lineDashOffset:h.borderDashOffset,lineJoin:h.borderJoinStyle,lineWidth:h.borderWidth,strokeStyle:h.borderColor,textAlign:n,pointStyle:s,borderRadius:i&&(l||h.borderRadius),index:d}}):[]}},onClick(e,r,s){s.chart.toggleDataVisibility(r.index),s.chart.update()}}}});function ea(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class Cm{constructor(e){W(this,"options");this.options=e||{}}static override(e){Object.assign(Cm.prototype,e)}init(){}formats(){return ea()}parse(){return ea()}format(){return ea()}add(){return ea()}diff(){return ea()}startOf(){return ea()}endOf(){return ea()}}var LE={_date:Cm};function AE(t,e,r,s){const{controller:n,data:a,_sorted:i}=t,l=n._cachedMeta.iScale,c=t.dataset&&t.dataset.options?t.dataset.options.spanGaps:null;if(l&&e===l.axis&&e!=="r"&&i&&a.length){const d=l._reversePixels?jk:Yh;if(s){if(n._sharedOptions){const u=a[0],h=typeof u.getRange=="function"&&u.getRange(e);if(h){const f=d(a,e,r-h),p=d(a,e,r+h);return{lo:f.lo,hi:p.hi}}}}else{const u=d(a,e,r);if(c){const{vScale:h}=n._cachedMeta,{_parsed:f}=t,p=f.slice(0,u.lo+1).reverse().findIndex(v=>!Ir(v[h.axis]));u.lo-=Math.max(0,p);const _=f.slice(u.hi).findIndex(v=>!Ir(v[h.axis]));u.hi+=Math.max(0,_)}return u}}return{lo:0,hi:a.length-1}}function Md(t,e,r,s,n){const a=t.getSortedVisibleDatasetMetas(),i=r[e];for(let l=0,c=a.length;l<c;++l){const{index:d,data:u}=a[l],{lo:h,hi:f}=AE(a[l],e,i,n);for(let p=h;p<=f;++p){const _=u[p];_.skip||s(_,d,p)}}}function DE(t){const e=t.indexOf("x")!==-1,r=t.indexOf("y")!==-1;return function(s,n){const a=e?Math.abs(s.x-n.x):0,i=r?Math.abs(s.y-n.y):0;return Math.sqrt(Math.pow(a,2)+Math.pow(i,2))}}function Tu(t,e,r,s,n){const a=[];return!n&&!t.isPointInArea(e)||Md(t,r,e,function(l,c,d){!n&&!nx(l,t.chartArea,0)||l.inRange(e.x,e.y,s)&&a.push({element:l,datasetIndex:c,index:d})},!0),a}function ME(t,e,r,s){let n=[];function a(i,l,c){const{startAngle:d,endAngle:u}=i.getProps(["startAngle","endAngle"],s),{angle:h}=Q0(i,{x:e.x,y:e.y});sd(h,d,u)&&n.push({element:i,datasetIndex:l,index:c})}return Md(t,r,e,a),n}function RE(t,e,r,s,n,a){let i=[];const l=DE(r);let c=Number.POSITIVE_INFINITY;function d(u,h,f){const p=u.inRange(e.x,e.y,n);if(s&&!p)return;const _=u.getCenterPoint(n);if(!(!!a||t.isPointInArea(_))&&!p)return;const x=l(e,_);x<c?(i=[{element:u,datasetIndex:h,index:f}],c=x):x===c&&i.push({element:u,datasetIndex:h,index:f})}return Md(t,r,e,d),i}function Lu(t,e,r,s,n,a){return!a&&!t.isPointInArea(e)?[]:r==="r"&&!s?ME(t,e,r,n):RE(t,e,r,s,n,a)}function o_(t,e,r,s,n){const a=[],i=r==="x"?"inXRange":"inYRange";let l=!1;return Md(t,r,e,(c,d,u)=>{c[i]&&c[i](e[r],n)&&(a.push({element:c,datasetIndex:d,index:u}),l=l||c.inRange(e.x,e.y,n))}),s&&!l?[]:a}var PE={modes:{index(t,e,r,s){const n=la(e,t),a=r.axis||"x",i=r.includeInvisible||!1,l=r.intersect?Tu(t,n,a,s,i):Lu(t,n,a,!1,s,i),c=[];return l.length?(t.getSortedVisibleDatasetMetas().forEach(d=>{const u=l[0].index,h=d.data[u];h&&!h.skip&&c.push({element:h,datasetIndex:d.index,index:u})}),c):[]},dataset(t,e,r,s){const n=la(e,t),a=r.axis||"xy",i=r.includeInvisible||!1;let l=r.intersect?Tu(t,n,a,s,i):Lu(t,n,a,!1,s,i);if(l.length>0){const c=l[0].datasetIndex,d=t.getDatasetMeta(c).data;l=[];for(let u=0;u<d.length;++u)l.push({element:d[u],datasetIndex:c,index:u})}return l},point(t,e,r,s){const n=la(e,t),a=r.axis||"xy",i=r.includeInvisible||!1;return Tu(t,n,a,s,i)},nearest(t,e,r,s){const n=la(e,t),a=r.axis||"xy",i=r.includeInvisible||!1;return Lu(t,n,a,r.intersect,s,i)},x(t,e,r,s){const n=la(e,t);return o_(t,n,"x",r.intersect,s)},y(t,e,r,s){const n=la(e,t);return o_(t,n,"y",r.intersect,s)}}};const fx=["left","top","right","bottom"];function Uo(t,e){return t.filter(r=>r.pos===e)}function i_(t,e){return t.filter(r=>fx.indexOf(r.pos)===-1&&r.box.axis===e)}function Wo(t,e){return t.sort((r,s)=>{const n=e?s:r,a=e?r:s;return n.weight===a.weight?n.index-a.index:n.weight-a.weight})}function OE(t){const e=[];let r,s,n,a,i,l;for(r=0,s=(t||[]).length;r<s;++r)n=t[r],{position:a,options:{stack:i,stackWeight:l=1}}=n,e.push({index:r,box:n,pos:a,horizontal:n.isHorizontal(),weight:n.weight,stack:i&&a+i,stackWeight:l});return e}function $E(t){const e={};for(const r of t){const{stack:s,pos:n,stackWeight:a}=r;if(!s||!fx.includes(n))continue;const i=e[s]||(e[s]={count:0,placed:0,weight:0,size:0});i.count++,i.weight+=a}return e}function FE(t,e){const r=$E(t),{vBoxMaxWidth:s,hBoxMaxHeight:n}=e;let a,i,l;for(a=0,i=t.length;a<i;++a){l=t[a];const{fullSize:c}=l.box,d=r[l.stack],u=d&&l.stackWeight/d.weight;l.horizontal?(l.width=u?u*s:c&&e.availableWidth,l.height=n):(l.width=s,l.height=u?u*n:c&&e.availableHeight)}return r}function BE(t){const e=OE(t),r=Wo(e.filter(d=>d.box.fullSize),!0),s=Wo(Uo(e,"left"),!0),n=Wo(Uo(e,"right")),a=Wo(Uo(e,"top"),!0),i=Wo(Uo(e,"bottom")),l=i_(e,"x"),c=i_(e,"y");return{fullSize:r,leftAndTop:s.concat(a),rightAndBottom:n.concat(c).concat(i).concat(l),chartArea:Uo(e,"chartArea"),vertical:s.concat(n).concat(c),horizontal:a.concat(i).concat(l)}}function l_(t,e,r,s){return Math.max(t[r],e[r])+Math.max(t[s],e[s])}function mx(t,e){t.top=Math.max(t.top,e.top),t.left=Math.max(t.left,e.left),t.bottom=Math.max(t.bottom,e.bottom),t.right=Math.max(t.right,e.right)}function VE(t,e,r,s){const{pos:n,box:a}=r,i=t.maxPadding;if(!tt(n)){r.size&&(t[n]-=r.size);const h=s[r.stack]||{size:0,count:1};h.size=Math.max(h.size,r.horizontal?a.height:a.width),r.size=h.size/h.count,t[n]+=r.size}a.getPadding&&mx(i,a.getPadding());const l=Math.max(0,e.outerWidth-l_(i,t,"left","right")),c=Math.max(0,e.outerHeight-l_(i,t,"top","bottom")),d=l!==t.w,u=c!==t.h;return t.w=l,t.h=c,r.horizontal?{same:d,other:u}:{same:u,other:d}}function HE(t){const e=t.maxPadding;function r(s){const n=Math.max(e[s]-t[s],0);return t[s]+=n,n}t.y+=r("top"),t.x+=r("left"),r("right"),r("bottom")}function zE(t,e){const r=e.maxPadding;function s(n){const a={left:0,top:0,right:0,bottom:0};return n.forEach(i=>{a[i]=Math.max(e[i],r[i])}),a}return s(t?["left","right"]:["top","bottom"])}function ni(t,e,r,s){const n=[];let a,i,l,c,d,u;for(a=0,i=t.length,d=0;a<i;++a){l=t[a],c=l.box,c.update(l.width||e.w,l.height||e.h,zE(l.horizontal,e));const{same:h,other:f}=VE(e,r,l,s);d|=h&&n.length,u=u||f,c.fullSize||n.push(l)}return d&&ni(n,e,r,s)||u}function Jl(t,e,r,s,n){t.top=r,t.left=e,t.right=e+s,t.bottom=r+n,t.width=s,t.height=n}function c_(t,e,r,s){const n=r.padding;let{x:a,y:i}=e;for(const l of t){const c=l.box,d=s[l.stack]||{placed:0,weight:1},u=l.stackWeight/d.weight||1;if(l.horizontal){const h=e.w*u,f=d.size||c.height;ed(d.start)&&(i=d.start),c.fullSize?Jl(c,n.left,i,r.outerWidth-n.right-n.left,f):Jl(c,e.left+d.placed,i,h,f),d.start=i,d.placed+=h,i=c.bottom}else{const h=e.h*u,f=d.size||c.width;ed(d.start)&&(a=d.start),c.fullSize?Jl(c,a,n.top,f,r.outerHeight-n.bottom-n.top):Jl(c,a,e.top+d.placed,f,h),d.start=a,d.placed+=h,a=c.right}}e.x=a,e.y=i}var Tn={addBox(t,e){t.boxes||(t.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(r){e.draw(r)}}]},t.boxes.push(e)},removeBox(t,e){const r=t.boxes?t.boxes.indexOf(e):-1;r!==-1&&t.boxes.splice(r,1)},configure(t,e,r){e.fullSize=r.fullSize,e.position=r.position,e.weight=r.weight},update(t,e,r,s){if(!t)return;const n=Rs(t.options.layout.padding),a=Math.max(e-n.width,0),i=Math.max(r-n.height,0),l=BE(t.boxes),c=l.vertical,d=l.horizontal;ct(t.boxes,v=>{typeof v.beforeLayout=="function"&&v.beforeLayout()});const u=c.reduce((v,x)=>x.box.options&&x.box.options.display===!1?v:v+1,0)||1,h=Object.freeze({outerWidth:e,outerHeight:r,padding:n,availableWidth:a,availableHeight:i,vBoxMaxWidth:a/2/u,hBoxMaxHeight:i/2}),f=Object.assign({},n);mx(f,Rs(s));const p=Object.assign({maxPadding:f,w:a,h:i,x:n.left,y:n.top},n),_=FE(c.concat(d),h);ni(l.fullSize,p,h,_),ni(c,p,h,_),ni(d,p,h,_)&&ni(c,p,h,_),HE(p),c_(l.leftAndTop,p,h,_),p.x+=p.w,p.y+=p.h,c_(l.rightAndBottom,p,h,_),t.chartArea={left:p.left,top:p.top,right:p.left+p.w,bottom:p.top+p.h,height:p.h,width:p.w},ct(l.chartArea,v=>{const x=v.box;Object.assign(x,t.chartArea),x.update(p.w,p.h,{left:0,top:0,right:0,bottom:0})})}};class px{acquireContext(e,r){}releaseContext(e){return!1}addEventListener(e,r,s){}removeEventListener(e,r,s){}getDevicePixelRatio(){return 1}getMaximumSize(e,r,s,n){return r=Math.max(0,r||e.width),s=s||e.height,{width:r,height:Math.max(0,n?Math.floor(r/n):s)}}isAttached(e){return!0}updateConfig(e){}}class qE extends px{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const vc="$chartjs",UE={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},d_=t=>t===null||t==="";function WE(t,e){const r=t.style,s=t.getAttribute("height"),n=t.getAttribute("width");if(t[vc]={initial:{height:s,width:n,style:{display:r.display,height:r.height,width:r.width}}},r.display=r.display||"block",r.boxSizing=r.boxSizing||"border-box",d_(n)){const a=Xg(t,"width");a!==void 0&&(t.width=a)}if(d_(s))if(t.style.height==="")t.height=t.width/(e||2);else{const a=Xg(t,"height");a!==void 0&&(t.height=a)}return t}const gx=uE?{passive:!0}:!1;function GE(t,e,r){t&&t.addEventListener(e,r,gx)}function JE(t,e,r){t&&t.canvas&&t.canvas.removeEventListener(e,r,gx)}function KE(t,e){const r=UE[t.type]||t.type,{x:s,y:n}=la(t,e);return{type:r,chart:e,native:t,x:s!==void 0?s:null,y:n!==void 0?n:null}}function od(t,e){for(const r of t)if(r===e||r.contains(e))return!0}function YE(t,e,r){const s=t.canvas,n=new MutationObserver(a=>{let i=!1;for(const l of a)i=i||od(l.addedNodes,s),i=i&&!od(l.removedNodes,s);i&&r()});return n.observe(document,{childList:!0,subtree:!0}),n}function QE(t,e,r){const s=t.canvas,n=new MutationObserver(a=>{let i=!1;for(const l of a)i=i||od(l.removedNodes,s),i=i&&!od(l.addedNodes,s);i&&r()});return n.observe(document,{childList:!0,subtree:!0}),n}const Xi=new Map;let u_=0;function _x(){const t=window.devicePixelRatio;t!==u_&&(u_=t,Xi.forEach((e,r)=>{r.currentDevicePixelRatio!==t&&e()}))}function ZE(t,e){Xi.size||window.addEventListener("resize",_x),Xi.set(t,e)}function XE(t){Xi.delete(t),Xi.size||window.removeEventListener("resize",_x)}function e4(t,e,r){const s=t.canvas,n=s&&jm(s);if(!n)return;const a=ex((l,c)=>{const d=n.clientWidth;r(l,c),d<n.clientWidth&&r()},window),i=new ResizeObserver(l=>{const c=l[0],d=c.contentRect.width,u=c.contentRect.height;d===0&&u===0||a(d,u)});return i.observe(n),ZE(t,a),i}function Au(t,e,r){r&&r.disconnect(),e==="resize"&&XE(t)}function t4(t,e,r){const s=t.canvas,n=ex(a=>{t.ctx!==null&&r(KE(a,t))},t);return GE(s,e,n),n}class r4 extends px{acquireContext(e,r){const s=e&&e.getContext&&e.getContext("2d");return s&&s.canvas===e?(WE(e,r),s):null}releaseContext(e){const r=e.canvas;if(!r[vc])return!1;const s=r[vc].initial;["height","width"].forEach(a=>{const i=s[a];Ir(i)?r.removeAttribute(a):r.setAttribute(a,i)});const n=s.style||{};return Object.keys(n).forEach(a=>{r.style[a]=n[a]}),r.width=r.width,delete r[vc],!0}addEventListener(e,r,s){this.removeEventListener(e,r);const n=e.$proxies||(e.$proxies={}),i={attach:YE,detach:QE,resize:e4}[r]||t4;n[r]=i(e,r,s)}removeEventListener(e,r){const s=e.$proxies||(e.$proxies={}),n=s[r];if(!n)return;({attach:Au,detach:Au,resize:Au}[r]||JE)(e,r,n),s[r]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,r,s,n){return dE(e,r,s,n)}isAttached(e){const r=e&&jm(e);return!!(r&&r.isConnected)}}function s4(t){return!Sm()||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas?qE:r4}class ka{constructor(){W(this,"x");W(this,"y");W(this,"active",!1);W(this,"options");W(this,"$animations")}tooltipPosition(e){const{x:r,y:s}=this.getProps(["x","y"],e);return{x:r,y:s}}hasValue(){return rd(this.x)&&rd(this.y)}getProps(e,r){const s=this.$animations;if(!r||!s)return this;const n={};return e.forEach(a=>{n[a]=s[a]&&s[a].active()?s[a]._to:this[a]}),n}}W(ka,"defaults",{}),W(ka,"defaultRoutes");function n4(t,e){const r=t.options.ticks,s=a4(t),n=Math.min(r.maxTicksLimit||s,s),a=r.major.enabled?i4(e):[],i=a.length,l=a[0],c=a[i-1],d=[];if(i>n)return l4(e,d,a,i/n),d;const u=o4(a,e,n);if(i>0){let h,f;const p=i>1?Math.round((c-l)/(i-1)):null;for(Kl(e,d,u,Ir(p)?0:l-p,l),h=0,f=i-1;h<f;h++)Kl(e,d,u,a[h],a[h+1]);return Kl(e,d,u,c,Ir(p)?e.length:c+p),d}return Kl(e,d,u),d}function a4(t){const e=t.options.offset,r=t._tickSize(),s=t._length/r+(e?0:1),n=t._maxLength/r;return Math.floor(Math.min(s,n))}function o4(t,e,r){const s=c4(t),n=e.length/r;if(!s)return Math.max(n,1);const a=vk(s);for(let i=0,l=a.length-1;i<l;i++){const c=a[i];if(c>n)return c}return Math.max(n,1)}function i4(t){const e=[];let r,s;for(r=0,s=t.length;r<s;r++)t[r].major&&e.push(r);return e}function l4(t,e,r,s){let n=0,a=r[0],i;for(s=Math.ceil(s),i=0;i<t.length;i++)i===a&&(e.push(t[i]),n++,a=r[n*s])}function Kl(t,e,r,s,n){const a=dt(s,0),i=Math.min(dt(n,t.length),t.length);let l=0,c,d,u;for(r=Math.ceil(r),n&&(c=n-s,r=c/Math.floor(c/r)),u=a;u<0;)l++,u=Math.round(a+l*r);for(d=Math.max(a,0);d<i;d++)d===u&&(e.push(t[d]),l++,u=Math.round(a+l*r))}function c4(t){const e=t.length;let r,s;if(e<2)return!1;for(s=t[0],r=1;r<e;++r)if(t[r]-t[r-1]!==s)return!1;return s}const d4=t=>t==="left"?"right":t==="right"?"left":t,h_=(t,e,r)=>e==="top"||e==="left"?t[e]+r:t[e]-r,f_=(t,e)=>Math.min(e||t,t);function m_(t,e){const r=[],s=t.length/e,n=t.length;let a=0;for(;a<n;a+=s)r.push(t[Math.floor(a)]);return r}function u4(t,e,r){const s=t.ticks.length,n=Math.min(e,s-1),a=t._startPixel,i=t._endPixel,l=1e-6;let c=t.getPixelForTick(n),d;if(!(r&&(s===1?d=Math.max(c-a,i-c):e===0?d=(t.getPixelForTick(1)-c)/2:d=(c-t.getPixelForTick(n-1))/2,c+=n<e?d:-d,c<a-l||c>i+l)))return c}function h4(t,e){ct(t,r=>{const s=r.gc,n=s.length/2;let a;if(n>e){for(a=0;a<n;++a)delete r.data[s[a]];s.splice(0,n)}})}function Go(t){return t.drawTicks?t.tickLength:0}function p_(t,e){if(!t.display)return 0;const r=Qr(t.font,e),s=Rs(t.padding);return(_r(t.text)?t.text.length:1)*r.lineHeight+s.height}function f4(t,e){return Lo(t,{scale:e,type:"scale"})}function m4(t,e,r){return Lo(t,{tick:r,index:e,type:"tick"})}function p4(t,e,r){let s=tx(t);return(r&&e!=="right"||!r&&e==="right")&&(s=d4(s)),s}function g4(t,e,r,s){const{top:n,left:a,bottom:i,right:l,chart:c}=t,{chartArea:d,scales:u}=c;let h=0,f,p,_;const v=i-n,x=l-a;if(t.isHorizontal()){if(p=ts(s,a,l),tt(r)){const m=Object.keys(r)[0],g=r[m];_=u[m].getPixelForValue(g)+v-e}else r==="center"?_=(d.bottom+d.top)/2+v-e:_=h_(t,r,e);f=l-a}else{if(tt(r)){const m=Object.keys(r)[0],g=r[m];p=u[m].getPixelForValue(g)-x+e}else r==="center"?p=(d.left+d.right)/2-x+e:p=h_(t,r,e);_=ts(s,i,n),h=r==="left"?-lr:lr}return{titleX:p,titleY:_,maxWidth:f,rotation:h}}class Rd extends ka{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,r){return e}getUserBounds(){let{_userMin:e,_userMax:r,_suggestedMin:s,_suggestedMax:n}=this;return e=Fs(e,Number.POSITIVE_INFINITY),r=Fs(r,Number.NEGATIVE_INFINITY),s=Fs(s,Number.POSITIVE_INFINITY),n=Fs(n,Number.NEGATIVE_INFINITY),{min:Fs(e,s),max:Fs(r,n),minDefined:un(e),maxDefined:un(r)}}getMinMax(e){let{min:r,max:s,minDefined:n,maxDefined:a}=this.getUserBounds(),i;if(n&&a)return{min:r,max:s};const l=this.getMatchingVisibleMetas();for(let c=0,d=l.length;c<d;++c)i=l[c].controller.getMinMax(this,e),n||(r=Math.min(r,i.min)),a||(s=Math.max(s,i.max));return r=a&&r>s?s:r,s=n&&r>s?r:s,{min:Fs(r,Fs(s,r)),max:Fs(s,Fs(r,s))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){wt(this.options.beforeUpdate,[this])}update(e,r,s){const{beginAtZero:n,grace:a,ticks:i}=this.options,l=i.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=r,this._margins=s=Object.assign({left:0,right:0,top:0,bottom:0},s),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+s.left+s.right:this.height+s.top+s.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=Kk(this,a,n),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const c=l<this.ticks.length;this._convertTicksToLabels(c?m_(this.ticks,l):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),i.display&&(i.autoSkip||i.source==="auto")&&(this.ticks=n4(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),c&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,r,s;this.isHorizontal()?(r=this.left,s=this.right):(r=this.top,s=this.bottom,e=!e),this._startPixel=r,this._endPixel=s,this._reversePixels=e,this._length=s-r,this._alignToPixels=this.options.alignToPixels}afterUpdate(){wt(this.options.afterUpdate,[this])}beforeSetDimensions(){wt(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){wt(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),wt(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){wt(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const r=this.options.ticks;let s,n,a;for(s=0,n=e.length;s<n;s++)a=e[s],a.label=wt(r.callback,[a.value,s,e],this)}afterTickToLabelConversion(){wt(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){wt(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,r=e.ticks,s=f_(this.ticks.length,e.ticks.maxTicksLimit),n=r.minRotation||0,a=r.maxRotation;let i=n,l,c,d;if(!this._isVisible()||!r.display||n>=a||s<=1||!this.isHorizontal()){this.labelRotation=n;return}const u=this._getLabelSizes(),h=u.widest.width,f=u.highest.height,p=_s(this.chart.width-h,0,this.maxWidth);l=e.offset?this.maxWidth/s:p/(s-1),h+6>l&&(l=p/(s-(e.offset?.5:1)),c=this.maxHeight-Go(e.grid)-r.padding-p_(e.title,this.chart.options.font),d=Math.sqrt(h*h+f*f),i=bk(Math.min(Math.asin(_s((u.highest.height+6)/l,-1,1)),Math.asin(_s(c/d,-1,1))-Math.asin(_s(f/d,-1,1)))),i=Math.max(n,Math.min(a,i))),this.labelRotation=i}afterCalculateLabelRotation(){wt(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){wt(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:r,options:{ticks:s,title:n,grid:a}}=this,i=this._isVisible(),l=this.isHorizontal();if(i){const c=p_(n,r.options.font);if(l?(e.width=this.maxWidth,e.height=Go(a)+c):(e.height=this.maxHeight,e.width=Go(a)+c),s.display&&this.ticks.length){const{first:d,last:u,widest:h,highest:f}=this._getLabelSizes(),p=s.padding*2,_=_a(this.labelRotation),v=Math.cos(_),x=Math.sin(_);if(l){const m=s.mirror?0:x*h.width+v*f.height;e.height=Math.min(this.maxHeight,e.height+m+p)}else{const m=s.mirror?0:v*h.width+x*f.height;e.width=Math.min(this.maxWidth,e.width+m+p)}this._calculatePadding(d,u,x,v)}}this._handleMargins(),l?(this.width=this._length=r.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=r.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,r,s,n){const{ticks:{align:a,padding:i},position:l}=this.options,c=this.labelRotation!==0,d=l!=="top"&&this.axis==="x";if(this.isHorizontal()){const u=this.getPixelForTick(0)-this.left,h=this.right-this.getPixelForTick(this.ticks.length-1);let f=0,p=0;c?d?(f=n*e.width,p=s*r.height):(f=s*e.height,p=n*r.width):a==="start"?p=r.width:a==="end"?f=e.width:a!=="inner"&&(f=e.width/2,p=r.width/2),this.paddingLeft=Math.max((f-u+i)*this.width/(this.width-u),0),this.paddingRight=Math.max((p-h+i)*this.width/(this.width-h),0)}else{let u=r.height/2,h=e.height/2;a==="start"?(u=0,h=e.height):a==="end"&&(u=r.height,h=0),this.paddingTop=u+i,this.paddingBottom=h+i}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){wt(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:r}=this.options;return r==="top"||r==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let r,s;for(r=0,s=e.length;r<s;r++)Ir(e[r].label)&&(e.splice(r,1),s--,r--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const r=this.options.ticks.sampleSize;let s=this.ticks;r<s.length&&(s=m_(s,r)),this._labelSizes=e=this._computeLabelSizes(s,s.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,r,s){const{ctx:n,_longestTextCache:a}=this,i=[],l=[],c=Math.floor(r/f_(r,s));let d=0,u=0,h,f,p,_,v,x,m,g,y,w,b;for(h=0;h<r;h+=c){if(_=e[h].label,v=this._resolveTickFontOptions(h),n.font=x=v.string,m=a[x]=a[x]||{data:{},gc:[]},g=v.lineHeight,y=w=0,!Ir(_)&&!_r(_))y=Gg(n,m.data,m.gc,y,_),w=g;else if(_r(_))for(f=0,p=_.length;f<p;++f)b=_[f],!Ir(b)&&!_r(b)&&(y=Gg(n,m.data,m.gc,y,b),w+=g);i.push(y),l.push(w),d=Math.max(y,d),u=Math.max(w,u)}h4(a,r);const C=i.indexOf(d),j=l.indexOf(u),I=k=>({width:i[k]||0,height:l[k]||0});return{first:I(0),last:I(r-1),widest:I(C),highest:I(j),widths:i,heights:l}}getLabelForValue(e){return e}getPixelForValue(e,r){return NaN}getValueForPixel(e){}getPixelForTick(e){const r=this.ticks;return e<0||e>r.length-1?null:this.getPixelForValue(r[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const r=this._startPixel+e*this._length;return Sk(this._alignToPixels?Xn(this.chart,r,0):r)}getDecimalForPixel(e){const r=(e-this._startPixel)/this._length;return this._reversePixels?1-r:r}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:r}=this;return e<0&&r<0?r:e>0&&r>0?e:0}getContext(e){const r=this.ticks||[];if(e>=0&&e<r.length){const s=r[e];return s.$context||(s.$context=m4(this.getContext(),e,s))}return this.$context||(this.$context=f4(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,r=_a(this.labelRotation),s=Math.abs(Math.cos(r)),n=Math.abs(Math.sin(r)),a=this._getLabelSizes(),i=e.autoSkipPadding||0,l=a?a.widest.width+i:0,c=a?a.highest.height+i:0;return this.isHorizontal()?c*s>l*n?l/s:c/n:c*n<l*s?c/s:l/n}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const r=this.axis,s=this.chart,n=this.options,{grid:a,position:i,border:l}=n,c=a.offset,d=this.isHorizontal(),h=this.ticks.length+(c?1:0),f=Go(a),p=[],_=l.setContext(this.getContext()),v=_.display?_.width:0,x=v/2,m=function(z){return Xn(s,z,v)};let g,y,w,b,C,j,I,k,E,T,D,N;if(i==="top")g=m(this.bottom),j=this.bottom-f,k=g-x,T=m(e.top)+x,N=e.bottom;else if(i==="bottom")g=m(this.top),T=e.top,N=m(e.bottom)-x,j=g+x,k=this.top+f;else if(i==="left")g=m(this.right),C=this.right-f,I=g-x,E=m(e.left)+x,D=e.right;else if(i==="right")g=m(this.left),E=e.left,D=m(e.right)-x,C=g+x,I=this.left+f;else if(r==="x"){if(i==="center")g=m((e.top+e.bottom)/2+.5);else if(tt(i)){const z=Object.keys(i)[0],H=i[z];g=m(this.chart.scales[z].getPixelForValue(H))}T=e.top,N=e.bottom,j=g+x,k=j+f}else if(r==="y"){if(i==="center")g=m((e.left+e.right)/2);else if(tt(i)){const z=Object.keys(i)[0],H=i[z];g=m(this.chart.scales[z].getPixelForValue(H))}C=g-x,I=C-f,E=e.left,D=e.right}const A=dt(n.ticks.maxTicksLimit,h),$=Math.max(1,Math.ceil(h/A));for(y=0;y<h;y+=$){const z=this.getContext(y),H=a.setContext(z),L=l.setContext(z),B=H.lineWidth,O=H.color,M=L.dash||[],R=L.dashOffset,ie=H.tickWidth,Z=H.tickColor,Ie=H.tickBorderDash||[],Te=H.tickBorderDashOffset;w=u4(this,y,c),w!==void 0&&(b=Xn(s,w,B),d?C=I=E=D=b:j=k=T=N=b,p.push({tx1:C,ty1:j,tx2:I,ty2:k,x1:E,y1:T,x2:D,y2:N,width:B,color:O,borderDash:M,borderDashOffset:R,tickWidth:ie,tickColor:Z,tickBorderDash:Ie,tickBorderDashOffset:Te}))}return this._ticksLength=h,this._borderValue=g,p}_computeLabelItems(e){const r=this.axis,s=this.options,{position:n,ticks:a}=s,i=this.isHorizontal(),l=this.ticks,{align:c,crossAlign:d,padding:u,mirror:h}=a,f=Go(s.grid),p=f+u,_=h?-u:p,v=-_a(this.labelRotation),x=[];let m,g,y,w,b,C,j,I,k,E,T,D,N="middle";if(n==="top")C=this.bottom-_,j=this._getXAxisLabelAlignment();else if(n==="bottom")C=this.top+_,j=this._getXAxisLabelAlignment();else if(n==="left"){const $=this._getYAxisLabelAlignment(f);j=$.textAlign,b=$.x}else if(n==="right"){const $=this._getYAxisLabelAlignment(f);j=$.textAlign,b=$.x}else if(r==="x"){if(n==="center")C=(e.top+e.bottom)/2+p;else if(tt(n)){const $=Object.keys(n)[0],z=n[$];C=this.chart.scales[$].getPixelForValue(z)+p}j=this._getXAxisLabelAlignment()}else if(r==="y"){if(n==="center")b=(e.left+e.right)/2-p;else if(tt(n)){const $=Object.keys(n)[0],z=n[$];b=this.chart.scales[$].getPixelForValue(z)}j=this._getYAxisLabelAlignment(f).textAlign}r==="y"&&(c==="start"?N="top":c==="end"&&(N="bottom"));const A=this._getLabelSizes();for(m=0,g=l.length;m<g;++m){y=l[m],w=y.label;const $=a.setContext(this.getContext(m));I=this.getPixelForTick(m)+a.labelOffset,k=this._resolveTickFontOptions(m),E=k.lineHeight,T=_r(w)?w.length:1;const z=T/2,H=$.color,L=$.textStrokeColor,B=$.textStrokeWidth;let O=j;i?(b=I,j==="inner"&&(m===g-1?O=this.options.reverse?"left":"right":m===0?O=this.options.reverse?"right":"left":O="center"),n==="top"?d==="near"||v!==0?D=-T*E+E/2:d==="center"?D=-A.highest.height/2-z*E+E:D=-A.highest.height+E/2:d==="near"||v!==0?D=E/2:d==="center"?D=A.highest.height/2-z*E:D=A.highest.height-T*E,h&&(D*=-1),v!==0&&!$.showLabelBackdrop&&(b+=E/2*Math.sin(v))):(C=I,D=(1-T)*E/2);let M;if($.showLabelBackdrop){const R=Rs($.backdropPadding),ie=A.heights[m],Z=A.widths[m];let Ie=D-R.top,Te=0-R.left;switch(N){case"middle":Ie-=ie/2;break;case"bottom":Ie-=ie;break}switch(j){case"center":Te-=Z/2;break;case"right":Te-=Z;break;case"inner":m===g-1?Te-=Z:m>0&&(Te-=Z/2);break}M={left:Te,top:Ie,width:Z+R.width,height:ie+R.height,color:$.backdropColor}}x.push({label:w,font:k,textOffset:D,options:{rotation:v,color:H,strokeColor:L,strokeWidth:B,textAlign:O,textBaseline:N,translation:[b,C],backdrop:M}})}return x}_getXAxisLabelAlignment(){const{position:e,ticks:r}=this.options;if(-_a(this.labelRotation))return e==="top"?"left":"right";let n="center";return r.align==="start"?n="left":r.align==="end"?n="right":r.align==="inner"&&(n="inner"),n}_getYAxisLabelAlignment(e){const{position:r,ticks:{crossAlign:s,mirror:n,padding:a}}=this.options,i=this._getLabelSizes(),l=e+a,c=i.widest.width;let d,u;return r==="left"?n?(u=this.right+a,s==="near"?d="left":s==="center"?(d="center",u+=c/2):(d="right",u+=c)):(u=this.right-l,s==="near"?d="right":s==="center"?(d="center",u-=c/2):(d="left",u=this.left)):r==="right"?n?(u=this.left+a,s==="near"?d="right":s==="center"?(d="center",u-=c/2):(d="left",u-=c)):(u=this.left+l,s==="near"?d="left":s==="center"?(d="center",u+=c/2):(d="right",u=this.right)):d="right",{textAlign:d,x:u}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,r=this.options.position;if(r==="left"||r==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(r==="top"||r==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:r},left:s,top:n,width:a,height:i}=this;r&&(e.save(),e.fillStyle=r,e.fillRect(s,n,a,i),e.restore())}getLineWidthForValue(e){const r=this.options.grid;if(!this._isVisible()||!r.display)return 0;const n=this.ticks.findIndex(a=>a.value===e);return n>=0?r.setContext(this.getContext(n)).lineWidth:0}drawGrid(e){const r=this.options.grid,s=this.ctx,n=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let a,i;const l=(c,d,u)=>{!u.width||!u.color||(s.save(),s.lineWidth=u.width,s.strokeStyle=u.color,s.setLineDash(u.borderDash||[]),s.lineDashOffset=u.borderDashOffset,s.beginPath(),s.moveTo(c.x,c.y),s.lineTo(d.x,d.y),s.stroke(),s.restore())};if(r.display)for(a=0,i=n.length;a<i;++a){const c=n[a];r.drawOnChartArea&&l({x:c.x1,y:c.y1},{x:c.x2,y:c.y2},c),r.drawTicks&&l({x:c.tx1,y:c.ty1},{x:c.tx2,y:c.ty2},{color:c.tickColor,width:c.tickWidth,borderDash:c.tickBorderDash,borderDashOffset:c.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:r,options:{border:s,grid:n}}=this,a=s.setContext(this.getContext()),i=s.display?a.width:0;if(!i)return;const l=n.setContext(this.getContext(0)).lineWidth,c=this._borderValue;let d,u,h,f;this.isHorizontal()?(d=Xn(e,this.left,i)-i/2,u=Xn(e,this.right,l)+l/2,h=f=c):(h=Xn(e,this.top,i)-i/2,f=Xn(e,this.bottom,l)+l/2,d=u=c),r.save(),r.lineWidth=a.width,r.strokeStyle=a.color,r.beginPath(),r.moveTo(d,h),r.lineTo(u,f),r.stroke(),r.restore()}drawLabels(e){if(!this.options.ticks.display)return;const s=this.ctx,n=this._computeLabelArea();n&&_m(s,n);const a=this.getLabelItems(e);for(const i of a){const l=i.options,c=i.font,d=i.label,u=i.textOffset;nd(s,d,0,u,c,l)}n&&ym(s)}drawTitle(){const{ctx:e,options:{position:r,title:s,reverse:n}}=this;if(!s.display)return;const a=Qr(s.font),i=Rs(s.padding),l=s.align;let c=a.lineHeight/2;r==="bottom"||r==="center"||tt(r)?(c+=i.bottom,_r(s.text)&&(c+=a.lineHeight*(s.text.length-1))):c+=i.top;const{titleX:d,titleY:u,maxWidth:h,rotation:f}=g4(this,c,r,l);nd(e,s.text,0,0,a,{color:s.color,maxWidth:h,rotation:f,textAlign:p4(l,r,n),textBaseline:"middle",translation:[d,u]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,r=e.ticks&&e.ticks.z||0,s=dt(e.grid&&e.grid.z,-1),n=dt(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==Rd.prototype.draw?[{z:r,draw:a=>{this.draw(a)}}]:[{z:s,draw:a=>{this.drawBackground(),this.drawGrid(a),this.drawTitle()}},{z:n,draw:()=>{this.drawBorder()}},{z:r,draw:a=>{this.drawLabels(a)}}]}getMatchingVisibleMetas(e){const r=this.chart.getSortedVisibleDatasetMetas(),s=this.axis+"AxisID",n=[];let a,i;for(a=0,i=r.length;a<i;++a){const l=r[a];l[s]===this.id&&(!e||l.type===e)&&n.push(l)}return n}_resolveTickFontOptions(e){const r=this.options.ticks.setContext(this.getContext(e));return Qr(r.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class Yl{constructor(e,r,s){this.type=e,this.scope=r,this.override=s,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const r=Object.getPrototypeOf(e);let s;v4(r)&&(s=this.register(r));const n=this.items,a=e.id,i=this.scope+"."+a;if(!a)throw new Error("class does not have id: "+e);return a in n||(n[a]=e,_4(e,i,s),this.override&&zt.override(e.id,e.overrides)),i}get(e){return this.items[e]}unregister(e){const r=this.items,s=e.id,n=this.scope;s in r&&delete r[s],n&&s in zt[n]&&(delete zt[n][s],this.override&&delete Ia[s])}}function _4(t,e,r){const s=Qi(Object.create(null),[r?zt.get(r):{},zt.get(e),t.defaults]);zt.set(e,s),t.defaultRoutes&&y4(e,t.defaultRoutes),t.descriptors&&zt.describe(e,t.descriptors)}function y4(t,e){Object.keys(e).forEach(r=>{const s=r.split("."),n=s.pop(),a=[t].concat(s).join("."),i=e[r].split("."),l=i.pop(),c=i.join(".");zt.route(a,n,c,l)})}function v4(t){return"id"in t&&"defaults"in t}class x4{constructor(){this.controllers=new Yl(ji,"datasets",!0),this.elements=new Yl(ka,"elements"),this.plugins=new Yl(Object,"plugins"),this.scales=new Yl(Rd,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,r,s){[...r].forEach(n=>{const a=s||this._getRegistryForType(n);s||a.isForType(n)||a===this.plugins&&n.id?this._exec(e,a,n):ct(n,i=>{const l=s||this._getRegistryForType(i);this._exec(e,l,i)})})}_exec(e,r,s){const n=pm(e);wt(s["before"+n],[],s),r[e](s),wt(s["after"+n],[],s)}_getRegistryForType(e){for(let r=0;r<this._typedRegistries.length;r++){const s=this._typedRegistries[r];if(s.isForType(e))return s}return this.plugins}_get(e,r,s){const n=r.get(e);if(n===void 0)throw new Error('"'+e+'" is not a registered '+s+".");return n}}var zs=new x4;class b4{constructor(){this._init=void 0}notify(e,r,s,n){if(r==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install")),this._init===void 0)return;const a=n?this._descriptors(e).filter(n):this._descriptors(e),i=this._notify(a,e,r,s);return r==="afterDestroy"&&(this._notify(a,e,"stop"),this._notify(this._init,e,"uninstall"),this._init=void 0),i}_notify(e,r,s,n){n=n||{};for(const a of e){const i=a.plugin,l=i[s],c=[r,n,a.options];if(wt(l,c,i)===!1&&n.cancelable)return!1}return!0}invalidate(){Ir(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const r=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),r}_createDescriptors(e,r){const s=e&&e.config,n=dt(s.options&&s.options.plugins,{}),a=w4(s);return n===!1&&!r?[]:j4(e,a,n,r)}_notifyStateChanges(e){const r=this._oldCache||[],s=this._cache,n=(a,i)=>a.filter(l=>!i.some(c=>l.plugin.id===c.plugin.id));this._notify(n(r,s),e,"stop"),this._notify(n(s,r),e,"start")}}function w4(t){const e={},r=[],s=Object.keys(zs.plugins.items);for(let a=0;a<s.length;a++)r.push(zs.getPlugin(s[a]));const n=t.plugins||[];for(let a=0;a<n.length;a++){const i=n[a];r.indexOf(i)===-1&&(r.push(i),e[i.id]=!0)}return{plugins:r,localIds:e}}function S4(t,e){return!e&&t===!1?null:t===!0?{}:t}function j4(t,{plugins:e,localIds:r},s,n){const a=[],i=t.getContext();for(const l of e){const c=l.id,d=S4(s[c],n);d!==null&&a.push({plugin:l,options:C4(t.config,{plugin:l,local:r[c]},d,i)})}return a}function C4(t,{plugin:e,local:r},s,n){const a=t.pluginScopeKeys(e),i=t.getOptionScopes(s,a);return r&&e.defaults&&i.push(e.defaults),t.createResolver(i,n,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function Xh(t,e){const r=zt.datasets[t]||{};return((e.datasets||{})[t]||{}).indexAxis||e.indexAxis||r.indexAxis||"x"}function N4(t,e){let r=t;return t==="_index_"?r=e:t==="_value_"&&(r=e==="x"?"y":"x"),r}function I4(t,e){return t===e?"_index_":"_value_"}function g_(t){if(t==="x"||t==="y"||t==="r")return t}function k4(t){if(t==="top"||t==="bottom")return"x";if(t==="left"||t==="right")return"y"}function ef(t,...e){if(g_(t))return t;for(const r of e){const s=r.axis||k4(r.position)||t.length>1&&g_(t[0].toLowerCase());if(s)return s}throw new Error(`Cannot determine type of '${t}' axis. Please provide 'axis' or 'position' option.`)}function __(t,e,r){if(r[e+"AxisID"]===t)return{axis:e}}function E4(t,e){if(e.data&&e.data.datasets){const r=e.data.datasets.filter(s=>s.xAxisID===t||s.yAxisID===t);if(r.length)return __(t,"x",r[0])||__(t,"y",r[0])}return{}}function T4(t,e){const r=Ia[t.type]||{scales:{}},s=e.scales||{},n=Xh(t.type,e),a=Object.create(null);return Object.keys(s).forEach(i=>{const l=s[i];if(!tt(l))return console.error(`Invalid scale configuration for scale: ${i}`);if(l._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${i}`);const c=ef(i,l,E4(i,t),zt.scales[l.type]),d=I4(c,n),u=r.scales||{};a[i]=xi(Object.create(null),[{axis:c},l,u[c],u[d]])}),t.data.datasets.forEach(i=>{const l=i.type||t.type,c=i.indexAxis||Xh(l,e),u=(Ia[l]||{}).scales||{};Object.keys(u).forEach(h=>{const f=N4(h,c),p=i[f+"AxisID"]||f;a[p]=a[p]||Object.create(null),xi(a[p],[{axis:f},s[p],u[h]])})}),Object.keys(a).forEach(i=>{const l=a[i];xi(l,[zt.scales[l.type],zt.scale])}),a}function yx(t){const e=t.options||(t.options={});e.plugins=dt(e.plugins,{}),e.scales=T4(t,e)}function vx(t){return t=t||{},t.datasets=t.datasets||[],t.labels=t.labels||[],t}function L4(t){return t=t||{},t.data=vx(t.data),yx(t),t}const y_=new Map,xx=new Set;function Ql(t,e){let r=y_.get(t);return r||(r=e(),y_.set(t,r),xx.add(r)),r}const Jo=(t,e,r)=>{const s=Zi(e,r);s!==void 0&&t.add(s)};class A4{constructor(e){this._config=L4(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=vx(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),yx(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return Ql(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,r){return Ql(`${e}.transition.${r}`,()=>[[`datasets.${e}.transitions.${r}`,`transitions.${r}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,r){return Ql(`${e}-${r}`,()=>[[`datasets.${e}.elements.${r}`,`datasets.${e}`,`elements.${r}`,""]])}pluginScopeKeys(e){const r=e.id,s=this.type;return Ql(`${s}-plugin-${r}`,()=>[[`plugins.${r}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,r){const s=this._scopeCache;let n=s.get(e);return(!n||r)&&(n=new Map,s.set(e,n)),n}getOptionScopes(e,r,s){const{options:n,type:a}=this,i=this._cachedScopes(e,s),l=i.get(r);if(l)return l;const c=new Set;r.forEach(u=>{e&&(c.add(e),u.forEach(h=>Jo(c,e,h))),u.forEach(h=>Jo(c,n,h)),u.forEach(h=>Jo(c,Ia[a]||{},h)),u.forEach(h=>Jo(c,zt,h)),u.forEach(h=>Jo(c,Qh,h))});const d=Array.from(c);return d.length===0&&d.push(Object.create(null)),xx.has(r)&&i.set(r,d),d}chartOptionScopes(){const{options:e,type:r}=this;return[e,Ia[r]||{},zt.datasets[r]||{},{type:r},zt,Qh]}resolveNamedOptions(e,r,s,n=[""]){const a={$shared:!0},{resolver:i,subPrefixes:l}=v_(this._resolverCache,e,n);let c=i;if(M4(i,r)){a.$shared=!1,s=zn(s)?s():s;const d=this.createResolver(e,s,l);c=wo(i,s,d)}for(const d of r)a[d]=c[d];return a}createResolver(e,r,s=[""],n){const{resolver:a}=v_(this._resolverCache,e,s);return tt(r)?wo(a,r,void 0,n):a}}function v_(t,e,r){let s=t.get(e);s||(s=new Map,t.set(e,s));const n=r.join();let a=s.get(n);return a||(a={resolver:xm(e,r),subPrefixes:r.filter(l=>!l.toLowerCase().includes("hover"))},s.set(n,a)),a}const D4=t=>tt(t)&&Object.getOwnPropertyNames(t).some(e=>zn(t[e]));function M4(t,e){const{isScriptable:r,isIndexable:s}=ax(t);for(const n of e){const a=r(n),i=s(n),l=(i||a)&&t[n];if(a&&(zn(l)||D4(l))||i&&_r(l))return!0}return!1}var R4="4.5.1";const P4=["top","bottom","left","right","chartArea"];function x_(t,e){return t==="top"||t==="bottom"||P4.indexOf(t)===-1&&e==="x"}function b_(t,e){return function(r,s){return r[t]===s[t]?r[e]-s[e]:r[t]-s[t]}}function w_(t){const e=t.chart,r=e.options.animation;e.notifyPlugins("afterRender"),wt(r&&r.onComplete,[t],e)}function O4(t){const e=t.chart,r=e.options.animation;wt(r&&r.onProgress,[t],e)}function bx(t){return Sm()&&typeof t=="string"?t=document.getElementById(t):t&&t.length&&(t=t[0]),t&&t.canvas&&(t=t.canvas),t}const xc={},S_=t=>{const e=bx(t);return Object.values(xc).filter(r=>r.canvas===e).pop()};function $4(t,e,r){const s=Object.keys(t);for(const n of s){const a=+n;if(a>=e){const i=t[n];delete t[n],(r>0||a>e)&&(t[a+r]=i)}}}function F4(t,e,r,s){return!r||t.type==="mouseout"?null:s?e:t}var _n;let Pd=(_n=class{static register(...e){zs.add(...e),j_()}static unregister(...e){zs.remove(...e),j_()}constructor(e,r){const s=this.config=new A4(r),n=bx(e),a=S_(n);if(a)throw new Error("Canvas is already in use. Chart with ID '"+a.id+"' must be destroyed before the canvas with ID '"+a.canvas.id+"' can be reused.");const i=s.createResolver(s.chartOptionScopes(),this.getContext());this.platform=new(s.platform||s4(n)),this.platform.updateConfig(s);const l=this.platform.acquireContext(n,i.aspectRatio),c=l&&l.canvas,d=c&&c.height,u=c&&c.width;if(this.id=uk(),this.ctx=l,this.canvas=c,this.width=u,this.height=d,this._options=i,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new b4,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=kk(h=>this.update(h),i.resizeDelay||0),this._dataChanges=[],xc[this.id]=this,!l||!c){console.error("Failed to create chart: can't acquire context from the given item");return}Qs.listen(this,"complete",w_),Qs.listen(this,"progress",O4),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:r},width:s,height:n,_aspectRatio:a}=this;return Ir(e)?r&&a?a:n?s/n:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return zs}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():Zg(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return Jg(this.canvas,this.ctx),this}stop(){return Qs.stop(this),this}resize(e,r){Qs.running(this)?this._resizeBeforeDraw={width:e,height:r}:this._resize(e,r)}_resize(e,r){const s=this.options,n=this.canvas,a=s.maintainAspectRatio&&this.aspectRatio,i=this.platform.getMaximumSize(n,e,r,a),l=s.devicePixelRatio||this.platform.getDevicePixelRatio(),c=this.width?"resize":"attach";this.width=i.width,this.height=i.height,this._aspectRatio=this.aspectRatio,Zg(this,l,!0)&&(this.notifyPlugins("resize",{size:i}),wt(s.onResize,[this,i],this),this.attached&&this._doResize(c)&&this.render())}ensureScalesHaveIDs(){const r=this.options.scales||{};ct(r,(s,n)=>{s.id=n})}buildOrUpdateScales(){const e=this.options,r=e.scales,s=this.scales,n=Object.keys(s).reduce((i,l)=>(i[l]=!1,i),{});let a=[];r&&(a=a.concat(Object.keys(r).map(i=>{const l=r[i],c=ef(i,l),d=c==="r",u=c==="x";return{options:l,dposition:d?"chartArea":u?"bottom":"left",dtype:d?"radialLinear":u?"category":"linear"}}))),ct(a,i=>{const l=i.options,c=l.id,d=ef(c,l),u=dt(l.type,i.dtype);(l.position===void 0||x_(l.position,d)!==x_(i.dposition))&&(l.position=i.dposition),n[c]=!0;let h=null;if(c in s&&s[c].type===u)h=s[c];else{const f=zs.getScale(u);h=new f({id:c,type:u,ctx:this.ctx,chart:this}),s[h.id]=h}h.init(l,e)}),ct(n,(i,l)=>{i||delete s[l]}),ct(s,i=>{Tn.configure(this,i,i.options),Tn.addBox(this,i)})}_updateMetasets(){const e=this._metasets,r=this.data.datasets.length,s=e.length;if(e.sort((n,a)=>n.index-a.index),s>r){for(let n=r;n<s;++n)this._destroyDatasetMeta(n);e.splice(r,s-r)}this._sortedMetasets=e.slice(0).sort(b_("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:r}}=this;e.length>r.length&&delete this._stacks,e.forEach((s,n)=>{r.filter(a=>a===s._dataset).length===0&&this._destroyDatasetMeta(n)})}buildOrUpdateControllers(){const e=[],r=this.data.datasets;let s,n;for(this._removeUnreferencedMetasets(),s=0,n=r.length;s<n;s++){const a=r[s];let i=this.getDatasetMeta(s);const l=a.type||this.config.type;if(i.type&&i.type!==l&&(this._destroyDatasetMeta(s),i=this.getDatasetMeta(s)),i.type=l,i.indexAxis=a.indexAxis||Xh(l,this.options),i.order=a.order||0,i.index=s,i.label=""+a.label,i.visible=this.isDatasetVisible(s),i.controller)i.controller.updateIndex(s),i.controller.linkScales();else{const c=zs.getController(l),{datasetElementType:d,dataElementType:u}=zt.datasets[l];Object.assign(c,{dataElementType:zs.getElement(u),datasetElementType:d&&zs.getElement(d)}),i.controller=new c(this,s),e.push(i.controller)}}return this._updateMetasets(),e}_resetElements(){ct(this.data.datasets,(e,r)=>{this.getDatasetMeta(r).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const r=this.config;r.update();const s=this._options=r.createResolver(r.chartOptionScopes(),this.getContext()),n=this._animationsDisabled=!s.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const a=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let i=0;for(let d=0,u=this.data.datasets.length;d<u;d++){const{controller:h}=this.getDatasetMeta(d),f=!n&&a.indexOf(h)===-1;h.buildOrUpdateElements(f),i=Math.max(+h.getMaxOverflow(),i)}i=this._minPadding=s.layout.autoPadding?i:0,this._updateLayout(i),n||ct(a,d=>{d.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(b_("z","_idx"));const{_active:l,_lastEvent:c}=this;c?this._eventHandler(c,!0):l.length&&this._updateHoverStyles(l,l,!0),this.render()}_updateScales(){ct(this.scales,e=>{Tn.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,r=new Set(Object.keys(this._listeners)),s=new Set(e.events);(!Fg(r,s)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,r=this._getUniformDataChanges()||[];for(const{method:s,start:n,count:a}of r){const i=s==="_removeElements"?-a:a;$4(e,n,i)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const r=this.data.datasets.length,s=a=>new Set(e.filter(i=>i[0]===a).map((i,l)=>l+","+i.splice(1).join(","))),n=s(0);for(let a=1;a<r;a++)if(!Fg(n,s(a)))return;return Array.from(n).map(a=>a.split(",")).map(a=>({method:a[1],start:+a[2],count:+a[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;Tn.update(this,this.width,this.height,e);const r=this.chartArea,s=r.width<=0||r.height<=0;this._layers=[],ct(this.boxes,n=>{s&&n.position==="chartArea"||(n.configure&&n.configure(),this._layers.push(...n._layers()))},this),this._layers.forEach((n,a)=>{n._idx=a}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let r=0,s=this.data.datasets.length;r<s;++r)this.getDatasetMeta(r).controller.configure();for(let r=0,s=this.data.datasets.length;r<s;++r)this._updateDataset(r,zn(e)?e({datasetIndex:r}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,r){const s=this.getDatasetMeta(e),n={meta:s,index:e,mode:r,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",n)!==!1&&(s.controller._update(r),n.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",n))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(Qs.has(this)?this.attached&&!Qs.running(this)&&Qs.start(this):(this.draw(),w_({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:s,height:n}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(s,n)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const r=this._layers;for(e=0;e<r.length&&r[e].z<=0;++e)r[e].draw(this.chartArea);for(this._drawDatasets();e<r.length;++e)r[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const r=this._sortedMetasets,s=[];let n,a;for(n=0,a=r.length;n<a;++n){const i=r[n];(!e||i.visible)&&s.push(i)}return s}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let r=e.length-1;r>=0;--r)this._drawDataset(e[r]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const r=this.ctx,s={meta:e,index:e.index,cancelable:!0},n=pE(this,e);this.notifyPlugins("beforeDatasetDraw",s)!==!1&&(n&&_m(r,n),e.controller.draw(),n&&ym(r),s.cancelable=!1,this.notifyPlugins("afterDatasetDraw",s))}isPointInArea(e){return nx(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,r,s,n){const a=PE.modes[r];return typeof a=="function"?a(this,e,s,n):[]}getDatasetMeta(e){const r=this.data.datasets[e],s=this._metasets;let n=s.filter(a=>a&&a._dataset===r).pop();return n||(n={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:r&&r.order||0,index:e,_dataset:r,_parsed:[],_sorted:!1},s.push(n)),n}getContext(){return this.$context||(this.$context=Lo(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const r=this.data.datasets[e];if(!r)return!1;const s=this.getDatasetMeta(e);return typeof s.hidden=="boolean"?!s.hidden:!r.hidden}setDatasetVisibility(e,r){const s=this.getDatasetMeta(e);s.hidden=!r}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,r,s){const n=s?"show":"hide",a=this.getDatasetMeta(e),i=a.controller._resolveAnimations(void 0,n);ed(r)?(a.data[r].hidden=!s,this.update()):(this.setDatasetVisibility(e,s),i.update(a,{visible:s}),this.update(l=>l.datasetIndex===e?n:void 0))}hide(e,r){this._updateVisibility(e,r,!1)}show(e,r){this._updateVisibility(e,r,!0)}_destroyDatasetMeta(e){const r=this._metasets[e];r&&r.controller&&r.controller._destroy(),delete this._metasets[e]}_stop(){let e,r;for(this.stop(),Qs.remove(this),e=0,r=this.data.datasets.length;e<r;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:r}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),Jg(e,r),this.platform.releaseContext(r),this.canvas=null,this.ctx=null),delete xc[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,r=this.platform,s=(a,i)=>{r.addEventListener(this,a,i),e[a]=i},n=(a,i,l)=>{a.offsetX=i,a.offsetY=l,this._eventHandler(a)};ct(this.options.events,a=>s(a,n))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,r=this.platform,s=(c,d)=>{r.addEventListener(this,c,d),e[c]=d},n=(c,d)=>{e[c]&&(r.removeEventListener(this,c,d),delete e[c])},a=(c,d)=>{this.canvas&&this.resize(c,d)};let i;const l=()=>{n("attach",l),this.attached=!0,this.resize(),s("resize",a),s("detach",i)};i=()=>{this.attached=!1,n("resize",a),this._stop(),this._resize(0,0),s("attach",l)},r.isAttached(this.canvas)?l():i()}unbindEvents(){ct(this._listeners,(e,r)=>{this.platform.removeEventListener(this,r,e)}),this._listeners={},ct(this._responsiveListeners,(e,r)=>{this.platform.removeEventListener(this,r,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,r,s){const n=s?"set":"remove";let a,i,l,c;for(r==="dataset"&&(a=this.getDatasetMeta(e[0].datasetIndex),a.controller["_"+n+"DatasetHoverStyle"]()),l=0,c=e.length;l<c;++l){i=e[l];const d=i&&this.getDatasetMeta(i.datasetIndex).controller;d&&d[n+"HoverStyle"](i.element,i.datasetIndex,i.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const r=this._active||[],s=e.map(({datasetIndex:a,index:i})=>{const l=this.getDatasetMeta(a);if(!l)throw new Error("No dataset found at index "+a);return{datasetIndex:a,element:l.data[i],index:i}});!Zc(s,r)&&(this._active=s,this._lastEvent=null,this._updateHoverStyles(s,r))}notifyPlugins(e,r,s){return this._plugins.notify(this,e,r,s)}isPluginEnabled(e){return this._plugins._cache.filter(r=>r.plugin.id===e).length===1}_updateHoverStyles(e,r,s){const n=this.options.hover,a=(c,d)=>c.filter(u=>!d.some(h=>u.datasetIndex===h.datasetIndex&&u.index===h.index)),i=a(r,e),l=s?e:a(e,r);i.length&&this.updateHoverStyle(i,n.mode,!1),l.length&&n.mode&&this.updateHoverStyle(l,n.mode,!0)}_eventHandler(e,r){const s={event:e,replay:r,cancelable:!0,inChartArea:this.isPointInArea(e)},n=i=>(i.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",s,n)===!1)return;const a=this._handleEvent(e,r,s.inChartArea);return s.cancelable=!1,this.notifyPlugins("afterEvent",s,n),(a||s.changed)&&this.render(),this}_handleEvent(e,r,s){const{_active:n=[],options:a}=this,i=r,l=this._getActiveElements(e,n,s,i),c=_k(e),d=F4(e,this._lastEvent,s,c);s&&(this._lastEvent=null,wt(a.onHover,[e,l,this],this),c&&wt(a.onClick,[e,l,this],this));const u=!Zc(l,n);return(u||r)&&(this._active=l,this._updateHoverStyles(l,n,r)),this._lastEvent=d,u}_getActiveElements(e,r,s,n){if(e.type==="mouseout")return[];if(!s)return r;const a=this.options.hover;return this.getElementsAtEventForMode(e,a.mode,a,n)}},W(_n,"defaults",zt),W(_n,"instances",xc),W(_n,"overrides",Ia),W(_n,"registry",zs),W(_n,"version",R4),W(_n,"getChart",S_),_n);function j_(){return ct(Pd.instances,t=>t._plugins.invalidate())}function B4(t,e,r){const{startAngle:s,x:n,y:a,outerRadius:i,innerRadius:l,options:c}=e,{borderWidth:d,borderJoinStyle:u}=c,h=Math.min(d/i,qs(s-r));if(t.beginPath(),t.arc(n,a,i-d/2,s+h/2,r-h/2),l>0){const f=Math.min(d/l,qs(s-r));t.arc(n,a,l+d/2,r-f/2,s+f/2,!0)}else{const f=Math.min(d/2,i*qs(s-r));if(u==="round")t.arc(n,a,f,r-St/2,s+St/2,!0);else if(u==="bevel"){const p=2*f*f,_=-p*Math.cos(r+St/2)+n,v=-p*Math.sin(r+St/2)+a,x=p*Math.cos(s+St/2)+n,m=p*Math.sin(s+St/2)+a;t.lineTo(_,v),t.lineTo(x,m)}}t.closePath(),t.moveTo(0,0),t.rect(0,0,t.canvas.width,t.canvas.height),t.clip("evenodd")}function V4(t,e,r){const{startAngle:s,pixelMargin:n,x:a,y:i,outerRadius:l,innerRadius:c}=e;let d=n/l;t.beginPath(),t.arc(a,i,l,s-d,r+d),c>n?(d=n/c,t.arc(a,i,c,r+d,s-d,!0)):t.arc(a,i,n,r+lr,s-lr),t.closePath(),t.clip()}function H4(t){return vm(t,["outerStart","outerEnd","innerStart","innerEnd"])}function z4(t,e,r,s){const n=H4(t.options.borderRadius),a=(r-e)/2,i=Math.min(a,s*e/2),l=c=>{const d=(r-Math.min(a,c))*s/2;return _s(c,0,Math.min(a,d))};return{outerStart:l(n.outerStart),outerEnd:l(n.outerEnd),innerStart:_s(n.innerStart,0,i),innerEnd:_s(n.innerEnd,0,i)}}function Fa(t,e,r,s){return{x:r+t*Math.cos(e),y:s+t*Math.sin(e)}}function id(t,e,r,s,n,a){const{x:i,y:l,startAngle:c,pixelMargin:d,innerRadius:u}=e,h=Math.max(e.outerRadius+s+r-d,0),f=u>0?u+s+r+d:0;let p=0;const _=n-c;if(s){const $=u>0?u-s:0,z=h>0?h-s:0,H=($+z)/2,L=H!==0?_*H/(H+s):_;p=(_-L)/2}const v=Math.max(.001,_*h-r/St)/h,x=(_-v)/2,m=c+x+p,g=n-x-p,{outerStart:y,outerEnd:w,innerStart:b,innerEnd:C}=z4(e,f,h,g-m),j=h-y,I=h-w,k=m+y/j,E=g-w/I,T=f+b,D=f+C,N=m+b/T,A=g-C/D;if(t.beginPath(),a){const $=(k+E)/2;if(t.arc(i,l,h,k,$),t.arc(i,l,h,$,E),w>0){const B=Fa(I,E,i,l);t.arc(B.x,B.y,w,E,g+lr)}const z=Fa(D,g,i,l);if(t.lineTo(z.x,z.y),C>0){const B=Fa(D,A,i,l);t.arc(B.x,B.y,C,g+lr,A+Math.PI)}const H=(g-C/f+(m+b/f))/2;if(t.arc(i,l,f,g-C/f,H,!0),t.arc(i,l,f,H,m+b/f,!0),b>0){const B=Fa(T,N,i,l);t.arc(B.x,B.y,b,N+Math.PI,m-lr)}const L=Fa(j,m,i,l);if(t.lineTo(L.x,L.y),y>0){const B=Fa(j,k,i,l);t.arc(B.x,B.y,y,m-lr,k)}}else{t.moveTo(i,l);const $=Math.cos(k)*h+i,z=Math.sin(k)*h+l;t.lineTo($,z);const H=Math.cos(E)*h+i,L=Math.sin(E)*h+l;t.lineTo(H,L)}t.closePath()}function q4(t,e,r,s,n){const{fullCircles:a,startAngle:i,circumference:l}=e;let c=e.endAngle;if(a){id(t,e,r,s,c,n);for(let d=0;d<a;++d)t.fill();isNaN(l)||(c=i+(l%Zt||Zt))}return id(t,e,r,s,c,n),t.fill(),c}function U4(t,e,r,s,n){const{fullCircles:a,startAngle:i,circumference:l,options:c}=e,{borderWidth:d,borderJoinStyle:u,borderDash:h,borderDashOffset:f,borderRadius:p}=c,_=c.borderAlign==="inner";if(!d)return;t.setLineDash(h||[]),t.lineDashOffset=f,_?(t.lineWidth=d*2,t.lineJoin=u||"round"):(t.lineWidth=d,t.lineJoin=u||"bevel");let v=e.endAngle;if(a){id(t,e,r,s,v,n);for(let x=0;x<a;++x)t.stroke();isNaN(l)||(v=i+(l%Zt||Zt))}_&&V4(t,e,v),c.selfJoin&&v-i>=St&&p===0&&u!=="miter"&&B4(t,e,v),a||(id(t,e,r,s,v,n),t.stroke())}class ai extends ka{constructor(r){super();W(this,"circumference");W(this,"endAngle");W(this,"fullCircles");W(this,"innerRadius");W(this,"outerRadius");W(this,"pixelMargin");W(this,"startAngle");this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,r&&Object.assign(this,r)}inRange(r,s,n){const a=this.getProps(["x","y"],n),{angle:i,distance:l}=Q0(a,{x:r,y:s}),{startAngle:c,endAngle:d,innerRadius:u,outerRadius:h,circumference:f}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],n),p=(this.options.spacing+this.options.borderWidth)/2,_=dt(f,d-c),v=sd(i,c,d)&&c!==d,x=_>=Zt||v,m=ri(l,u+p,h+p);return x&&m}getCenterPoint(r){const{x:s,y:n,startAngle:a,endAngle:i,innerRadius:l,outerRadius:c}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],r),{offset:d,spacing:u}=this.options,h=(a+i)/2,f=(l+c+u+d)/2;return{x:s+Math.cos(h)*f,y:n+Math.sin(h)*f}}tooltipPosition(r){return this.getCenterPoint(r)}draw(r){const{options:s,circumference:n}=this,a=(s.offset||0)/4,i=(s.spacing||0)/2,l=s.circular;if(this.pixelMargin=s.borderAlign==="inner"?.33:0,this.fullCircles=n>Zt?Math.floor(n/Zt):0,n===0||this.innerRadius<0||this.outerRadius<0)return;r.save();const c=(this.startAngle+this.endAngle)/2;r.translate(Math.cos(c)*a,Math.sin(c)*a);const d=1-Math.sin(Math.min(St,n||0)),u=a*d;r.fillStyle=s.backgroundColor,r.strokeStyle=s.borderColor,q4(r,this,u,i,l),U4(r,this,u,i,l),r.restore()}}W(ai,"id","arc"),W(ai,"defaults",{borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1}),W(ai,"defaultRoutes",{backgroundColor:"backgroundColor"}),W(ai,"descriptors",{_scriptable:!0,_indexable:r=>r!=="borderDash"});const C_=(t,e)=>{let{boxHeight:r=e,boxWidth:s=e}=t;return t.usePointStyle&&(r=Math.min(r,e),s=t.pointStyleWidth||Math.min(s,e)),{boxWidth:s,boxHeight:r,itemHeight:Math.max(e,r)}},W4=(t,e)=>t!==null&&e!==null&&t.datasetIndex===e.datasetIndex&&t.index===e.index;class N_ extends ka{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,r,s){this.maxWidth=e,this.maxHeight=r,this._margins=s,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let r=wt(e.generateLabels,[this.chart],this)||[];e.filter&&(r=r.filter(s=>e.filter(s,this.chart.data))),e.sort&&(r=r.sort((s,n)=>e.sort(s,n,this.chart.data))),this.options.reverse&&r.reverse(),this.legendItems=r}fit(){const{options:e,ctx:r}=this;if(!e.display){this.width=this.height=0;return}const s=e.labels,n=Qr(s.font),a=n.size,i=this._computeTitleHeight(),{boxWidth:l,itemHeight:c}=C_(s,a);let d,u;r.font=n.string,this.isHorizontal()?(d=this.maxWidth,u=this._fitRows(i,a,l,c)+10):(u=this.maxHeight,d=this._fitCols(i,n,l,c)+10),this.width=Math.min(d,e.maxWidth||this.maxWidth),this.height=Math.min(u,e.maxHeight||this.maxHeight)}_fitRows(e,r,s,n){const{ctx:a,maxWidth:i,options:{labels:{padding:l}}}=this,c=this.legendHitBoxes=[],d=this.lineWidths=[0],u=n+l;let h=e;a.textAlign="left",a.textBaseline="middle";let f=-1,p=-u;return this.legendItems.forEach((_,v)=>{const x=s+r/2+a.measureText(_.text).width;(v===0||d[d.length-1]+x+2*l>i)&&(h+=u,d[d.length-(v>0?0:1)]=0,p+=u,f++),c[v]={left:0,top:p,row:f,width:x,height:n},d[d.length-1]+=x+l}),h}_fitCols(e,r,s,n){const{ctx:a,maxHeight:i,options:{labels:{padding:l}}}=this,c=this.legendHitBoxes=[],d=this.columnSizes=[],u=i-e;let h=l,f=0,p=0,_=0,v=0;return this.legendItems.forEach((x,m)=>{const{itemWidth:g,itemHeight:y}=G4(s,r,a,x,n);m>0&&p+y+2*l>u&&(h+=f+l,d.push({width:f,height:p}),_+=f+l,v++,f=p=0),c[m]={left:_,top:p,col:v,width:g,height:y},f=Math.max(f,g),p+=y+l}),h+=f,d.push({width:f,height:p}),h}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:r,options:{align:s,labels:{padding:n},rtl:a}}=this,i=uo(a,this.left,this.width);if(this.isHorizontal()){let l=0,c=ts(s,this.left+n,this.right-this.lineWidths[l]);for(const d of r)l!==d.row&&(l=d.row,c=ts(s,this.left+n,this.right-this.lineWidths[l])),d.top+=this.top+e+n,d.left=i.leftForLtr(i.x(c),d.width),c+=d.width+n}else{let l=0,c=ts(s,this.top+e+n,this.bottom-this.columnSizes[l].height);for(const d of r)d.col!==l&&(l=d.col,c=ts(s,this.top+e+n,this.bottom-this.columnSizes[l].height)),d.top=c,d.left+=this.left+n,d.left=i.leftForLtr(i.x(d.left),d.width),c+=d.height+n}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;_m(e,this),this._draw(),ym(e)}}_draw(){const{options:e,columnSizes:r,lineWidths:s,ctx:n}=this,{align:a,labels:i}=e,l=zt.color,c=uo(e.rtl,this.left,this.width),d=Qr(i.font),{padding:u}=i,h=d.size,f=h/2;let p;this.drawTitle(),n.textAlign=c.textAlign("left"),n.textBaseline="middle",n.lineWidth=.5,n.font=d.string;const{boxWidth:_,boxHeight:v,itemHeight:x}=C_(i,h),m=function(C,j,I){if(isNaN(_)||_<=0||isNaN(v)||v<0)return;n.save();const k=dt(I.lineWidth,1);if(n.fillStyle=dt(I.fillStyle,l),n.lineCap=dt(I.lineCap,"butt"),n.lineDashOffset=dt(I.lineDashOffset,0),n.lineJoin=dt(I.lineJoin,"miter"),n.lineWidth=k,n.strokeStyle=dt(I.strokeStyle,l),n.setLineDash(dt(I.lineDash,[])),i.usePointStyle){const E={radius:v*Math.SQRT2/2,pointStyle:I.pointStyle,rotation:I.rotation,borderWidth:k},T=c.xPlus(C,_/2),D=j+f;sx(n,E,T,D,i.pointStyleWidth&&_)}else{const E=j+Math.max((h-v)/2,0),T=c.leftForLtr(C,_),D=Si(I.borderRadius);n.beginPath(),Object.values(D).some(N=>N!==0)?Zh(n,{x:T,y:E,w:_,h:v,radius:D}):n.rect(T,E,_,v),n.fill(),k!==0&&n.stroke()}n.restore()},g=function(C,j,I){nd(n,I.text,C,j+x/2,d,{strikethrough:I.hidden,textAlign:c.textAlign(I.textAlign)})},y=this.isHorizontal(),w=this._computeTitleHeight();y?p={x:ts(a,this.left+u,this.right-s[0]),y:this.top+u+w,line:0}:p={x:this.left+u,y:ts(a,this.top+w+u,this.bottom-r[0].height),line:0},cx(this.ctx,e.textDirection);const b=x+u;this.legendItems.forEach((C,j)=>{n.strokeStyle=C.fontColor,n.fillStyle=C.fontColor;const I=n.measureText(C.text).width,k=c.textAlign(C.textAlign||(C.textAlign=i.textAlign)),E=_+f+I;let T=p.x,D=p.y;c.setWidth(this.width),y?j>0&&T+E+u>this.right&&(D=p.y+=b,p.line++,T=p.x=ts(a,this.left+u,this.right-s[p.line])):j>0&&D+b>this.bottom&&(T=p.x=T+r[p.line].width+u,p.line++,D=p.y=ts(a,this.top+w+u,this.bottom-r[p.line].height));const N=c.x(T);if(m(N,D,C),T=Ek(k,T+_+f,y?T+E:this.right,e.rtl),g(c.x(T),D,C),y)p.x+=E+u;else if(typeof C.text!="string"){const A=d.lineHeight;p.y+=wx(C,A)+u}else p.y+=b}),dx(this.ctx,e.textDirection)}drawTitle(){const e=this.options,r=e.title,s=Qr(r.font),n=Rs(r.padding);if(!r.display)return;const a=uo(e.rtl,this.left,this.width),i=this.ctx,l=r.position,c=s.size/2,d=n.top+c;let u,h=this.left,f=this.width;if(this.isHorizontal())f=Math.max(...this.lineWidths),u=this.top+d,h=ts(e.align,h,this.right-f);else{const _=this.columnSizes.reduce((v,x)=>Math.max(v,x.height),0);u=d+ts(e.align,this.top,this.bottom-_-e.labels.padding-this._computeTitleHeight())}const p=ts(l,h,h+f);i.textAlign=a.textAlign(tx(l)),i.textBaseline="middle",i.strokeStyle=r.color,i.fillStyle=r.color,i.font=s.string,nd(i,r.text,p,u,s)}_computeTitleHeight(){const e=this.options.title,r=Qr(e.font),s=Rs(e.padding);return e.display?r.lineHeight+s.height:0}_getLegendItemAt(e,r){let s,n,a;if(ri(e,this.left,this.right)&&ri(r,this.top,this.bottom)){for(a=this.legendHitBoxes,s=0;s<a.length;++s)if(n=a[s],ri(e,n.left,n.left+n.width)&&ri(r,n.top,n.top+n.height))return this.legendItems[s]}return null}handleEvent(e){const r=this.options;if(!Y4(e.type,r))return;const s=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const n=this._hoveredItem,a=W4(n,s);n&&!a&&wt(r.onLeave,[e,n,this],this),this._hoveredItem=s,s&&!a&&wt(r.onHover,[e,s,this],this)}else s&&wt(r.onClick,[e,s,this],this)}}function G4(t,e,r,s,n){const a=J4(s,t,e,r),i=K4(n,s,e.lineHeight);return{itemWidth:a,itemHeight:i}}function J4(t,e,r,s){let n=t.text;return n&&typeof n!="string"&&(n=n.reduce((a,i)=>a.length>i.length?a:i)),e+r.size/2+s.measureText(n).width}function K4(t,e,r){let s=t;return typeof e.text!="string"&&(s=wx(e,r)),s}function wx(t,e){const r=t.text?t.text.length:0;return e*r}function Y4(t,e){return!!((t==="mousemove"||t==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(t==="click"||t==="mouseup"))}var Q4={id:"legend",_element:N_,start(t,e,r){const s=t.legend=new N_({ctx:t.ctx,options:r,chart:t});Tn.configure(t,s,r),Tn.addBox(t,s)},stop(t){Tn.removeBox(t,t.legend),delete t.legend},beforeUpdate(t,e,r){const s=t.legend;Tn.configure(t,s,r),s.options=r},afterUpdate(t){const e=t.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(t,e){e.replay||t.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(t,e,r){const s=e.datasetIndex,n=r.chart;n.isDatasetVisible(s)?(n.hide(s),e.hidden=!0):(n.show(s),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:t=>t.chart.options.color,boxWidth:40,padding:10,generateLabels(t){const e=t.data.datasets,{labels:{usePointStyle:r,pointStyle:s,textAlign:n,color:a,useBorderRadius:i,borderRadius:l}}=t.legend.options;return t._getSortedDatasetMetas().map(c=>{const d=c.controller.getStyle(r?0:void 0),u=Rs(d.borderWidth);return{text:e[c.index].label,fillStyle:d.backgroundColor,fontColor:a,hidden:!c.visible,lineCap:d.borderCapStyle,lineDash:d.borderDash,lineDashOffset:d.borderDashOffset,lineJoin:d.borderJoinStyle,lineWidth:(u.width+u.height)/4,strokeStyle:d.borderColor,pointStyle:s||d.pointStyle,rotation:d.rotation,textAlign:n||d.textAlign,borderRadius:i&&(l||d.borderRadius),datasetIndex:c.index}},this)}},title:{color:t=>t.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:t=>!t.startsWith("on"),labels:{_scriptable:t=>!["generateLabels","filter","sort"].includes(t)}}};const oi={average(t){if(!t.length)return!1;let e,r,s=new Set,n=0,a=0;for(e=0,r=t.length;e<r;++e){const l=t[e].element;if(l&&l.hasValue()){const c=l.tooltipPosition();s.add(c.x),n+=c.y,++a}}return a===0||s.size===0?!1:{x:[...s].reduce((l,c)=>l+c)/s.size,y:n/a}},nearest(t,e){if(!t.length)return!1;let r=e.x,s=e.y,n=Number.POSITIVE_INFINITY,a,i,l;for(a=0,i=t.length;a<i;++a){const c=t[a].element;if(c&&c.hasValue()){const d=c.getCenterPoint(),u=wk(e,d);u<n&&(n=u,l=c)}}if(l){const c=l.tooltipPosition();r=c.x,s=c.y}return{x:r,y:s}}};function Vs(t,e){return e&&(_r(e)?Array.prototype.push.apply(t,e):t.push(e)),t}function Zs(t){return(typeof t=="string"||t instanceof String)&&t.indexOf(`
`)>-1?t.split(`
`):t}function Z4(t,e){const{element:r,datasetIndex:s,index:n}=e,a=t.getDatasetMeta(s).controller,{label:i,value:l}=a.getLabelAndValue(n);return{chart:t,label:i,parsed:a.getParsed(n),raw:t.data.datasets[s].data[n],formattedValue:l,dataset:a.getDataset(),dataIndex:n,datasetIndex:s,element:r}}function I_(t,e){const r=t.chart.ctx,{body:s,footer:n,title:a}=t,{boxWidth:i,boxHeight:l}=e,c=Qr(e.bodyFont),d=Qr(e.titleFont),u=Qr(e.footerFont),h=a.length,f=n.length,p=s.length,_=Rs(e.padding);let v=_.height,x=0,m=s.reduce((w,b)=>w+b.before.length+b.lines.length+b.after.length,0);if(m+=t.beforeBody.length+t.afterBody.length,h&&(v+=h*d.lineHeight+(h-1)*e.titleSpacing+e.titleMarginBottom),m){const w=e.displayColors?Math.max(l,c.lineHeight):c.lineHeight;v+=p*w+(m-p)*c.lineHeight+(m-1)*e.bodySpacing}f&&(v+=e.footerMarginTop+f*u.lineHeight+(f-1)*e.footerSpacing);let g=0;const y=function(w){x=Math.max(x,r.measureText(w).width+g)};return r.save(),r.font=d.string,ct(t.title,y),r.font=c.string,ct(t.beforeBody.concat(t.afterBody),y),g=e.displayColors?i+2+e.boxPadding:0,ct(s,w=>{ct(w.before,y),ct(w.lines,y),ct(w.after,y)}),g=0,r.font=u.string,ct(t.footer,y),r.restore(),x+=_.width,{width:x,height:v}}function X4(t,e){const{y:r,height:s}=e;return r<s/2?"top":r>t.height-s/2?"bottom":"center"}function e5(t,e,r,s){const{x:n,width:a}=s,i=r.caretSize+r.caretPadding;if(t==="left"&&n+a+i>e.width||t==="right"&&n-a-i<0)return!0}function t5(t,e,r,s){const{x:n,width:a}=r,{width:i,chartArea:{left:l,right:c}}=t;let d="center";return s==="center"?d=n<=(l+c)/2?"left":"right":n<=a/2?d="left":n>=i-a/2&&(d="right"),e5(d,t,e,r)&&(d="center"),d}function k_(t,e,r){const s=r.yAlign||e.yAlign||X4(t,r);return{xAlign:r.xAlign||e.xAlign||t5(t,e,r,s),yAlign:s}}function r5(t,e){let{x:r,width:s}=t;return e==="right"?r-=s:e==="center"&&(r-=s/2),r}function s5(t,e,r){let{y:s,height:n}=t;return e==="top"?s+=r:e==="bottom"?s-=n+r:s-=n/2,s}function E_(t,e,r,s){const{caretSize:n,caretPadding:a,cornerRadius:i}=t,{xAlign:l,yAlign:c}=r,d=n+a,{topLeft:u,topRight:h,bottomLeft:f,bottomRight:p}=Si(i);let _=r5(e,l);const v=s5(e,c,d);return c==="center"?l==="left"?_+=d:l==="right"&&(_-=d):l==="left"?_-=Math.max(u,f)+n:l==="right"&&(_+=Math.max(h,p)+n),{x:_s(_,0,s.width-e.width),y:_s(v,0,s.height-e.height)}}function Zl(t,e,r){const s=Rs(r.padding);return e==="center"?t.x+t.width/2:e==="right"?t.x+t.width-s.right:t.x+s.left}function T_(t){return Vs([],Zs(t))}function n5(t,e,r){return Lo(t,{tooltip:e,tooltipItems:r,type:"tooltip"})}function L_(t,e){const r=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return r?t.override(r):t}const Sx={beforeTitle:Ys,title(t){if(t.length>0){const e=t[0],r=e.chart.data.labels,s=r?r.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(s>0&&e.dataIndex<s)return r[e.dataIndex]}return""},afterTitle:Ys,beforeBody:Ys,beforeLabel:Ys,label(t){if(this&&this.options&&this.options.mode==="dataset")return t.label+": "+t.formattedValue||t.formattedValue;let e=t.dataset.label||"";e&&(e+=": ");const r=t.formattedValue;return Ir(r)||(e+=r),e},labelColor(t){const r=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{borderColor:r.borderColor,backgroundColor:r.backgroundColor,borderWidth:r.borderWidth,borderDash:r.borderDash,borderDashOffset:r.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(t){const r=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{pointStyle:r.pointStyle,rotation:r.rotation}},afterLabel:Ys,afterBody:Ys,beforeFooter:Ys,footer:Ys,afterFooter:Ys};function zr(t,e,r,s){const n=t[e].call(r,s);return typeof n>"u"?Sx[e].call(r,s):n}class tf extends ka{constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const r=this.chart,s=this.options.setContext(this.getContext()),n=s.enabled&&r.options.animation&&s.animations,a=new ux(this.chart,n);return n._cacheable&&(this._cachedAnimations=Object.freeze(a)),a}getContext(){return this.$context||(this.$context=n5(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,r){const{callbacks:s}=r,n=zr(s,"beforeTitle",this,e),a=zr(s,"title",this,e),i=zr(s,"afterTitle",this,e);let l=[];return l=Vs(l,Zs(n)),l=Vs(l,Zs(a)),l=Vs(l,Zs(i)),l}getBeforeBody(e,r){return T_(zr(r.callbacks,"beforeBody",this,e))}getBody(e,r){const{callbacks:s}=r,n=[];return ct(e,a=>{const i={before:[],lines:[],after:[]},l=L_(s,a);Vs(i.before,Zs(zr(l,"beforeLabel",this,a))),Vs(i.lines,zr(l,"label",this,a)),Vs(i.after,Zs(zr(l,"afterLabel",this,a))),n.push(i)}),n}getAfterBody(e,r){return T_(zr(r.callbacks,"afterBody",this,e))}getFooter(e,r){const{callbacks:s}=r,n=zr(s,"beforeFooter",this,e),a=zr(s,"footer",this,e),i=zr(s,"afterFooter",this,e);let l=[];return l=Vs(l,Zs(n)),l=Vs(l,Zs(a)),l=Vs(l,Zs(i)),l}_createItems(e){const r=this._active,s=this.chart.data,n=[],a=[],i=[];let l=[],c,d;for(c=0,d=r.length;c<d;++c)l.push(Z4(this.chart,r[c]));return e.filter&&(l=l.filter((u,h,f)=>e.filter(u,h,f,s))),e.itemSort&&(l=l.sort((u,h)=>e.itemSort(u,h,s))),ct(l,u=>{const h=L_(e.callbacks,u);n.push(zr(h,"labelColor",this,u)),a.push(zr(h,"labelPointStyle",this,u)),i.push(zr(h,"labelTextColor",this,u))}),this.labelColors=n,this.labelPointStyles=a,this.labelTextColors=i,this.dataPoints=l,l}update(e,r){const s=this.options.setContext(this.getContext()),n=this._active;let a,i=[];if(!n.length)this.opacity!==0&&(a={opacity:0});else{const l=oi[s.position].call(this,n,this._eventPosition);i=this._createItems(s),this.title=this.getTitle(i,s),this.beforeBody=this.getBeforeBody(i,s),this.body=this.getBody(i,s),this.afterBody=this.getAfterBody(i,s),this.footer=this.getFooter(i,s);const c=this._size=I_(this,s),d=Object.assign({},l,c),u=k_(this.chart,s,d),h=E_(s,d,u,this.chart);this.xAlign=u.xAlign,this.yAlign=u.yAlign,a={opacity:1,x:h.x,y:h.y,width:c.width,height:c.height,caretX:l.x,caretY:l.y}}this._tooltipItems=i,this.$context=void 0,a&&this._resolveAnimations().update(this,a),e&&s.external&&s.external.call(this,{chart:this.chart,tooltip:this,replay:r})}drawCaret(e,r,s,n){const a=this.getCaretPosition(e,s,n);r.lineTo(a.x1,a.y1),r.lineTo(a.x2,a.y2),r.lineTo(a.x3,a.y3)}getCaretPosition(e,r,s){const{xAlign:n,yAlign:a}=this,{caretSize:i,cornerRadius:l}=s,{topLeft:c,topRight:d,bottomLeft:u,bottomRight:h}=Si(l),{x:f,y:p}=e,{width:_,height:v}=r;let x,m,g,y,w,b;return a==="center"?(w=p+v/2,n==="left"?(x=f,m=x-i,y=w+i,b=w-i):(x=f+_,m=x+i,y=w-i,b=w+i),g=x):(n==="left"?m=f+Math.max(c,u)+i:n==="right"?m=f+_-Math.max(d,h)-i:m=this.caretX,a==="top"?(y=p,w=y-i,x=m-i,g=m+i):(y=p+v,w=y+i,x=m+i,g=m-i),b=y),{x1:x,x2:m,x3:g,y1:y,y2:w,y3:b}}drawTitle(e,r,s){const n=this.title,a=n.length;let i,l,c;if(a){const d=uo(s.rtl,this.x,this.width);for(e.x=Zl(this,s.titleAlign,s),r.textAlign=d.textAlign(s.titleAlign),r.textBaseline="middle",i=Qr(s.titleFont),l=s.titleSpacing,r.fillStyle=s.titleColor,r.font=i.string,c=0;c<a;++c)r.fillText(n[c],d.x(e.x),e.y+i.lineHeight/2),e.y+=i.lineHeight+l,c+1===a&&(e.y+=s.titleMarginBottom-l)}}_drawColorBox(e,r,s,n,a){const i=this.labelColors[s],l=this.labelPointStyles[s],{boxHeight:c,boxWidth:d}=a,u=Qr(a.bodyFont),h=Zl(this,"left",a),f=n.x(h),p=c<u.lineHeight?(u.lineHeight-c)/2:0,_=r.y+p;if(a.usePointStyle){const v={radius:Math.min(d,c)/2,pointStyle:l.pointStyle,rotation:l.rotation,borderWidth:1},x=n.leftForLtr(f,d)+d/2,m=_+c/2;e.strokeStyle=a.multiKeyBackground,e.fillStyle=a.multiKeyBackground,Kg(e,v,x,m),e.strokeStyle=i.borderColor,e.fillStyle=i.backgroundColor,Kg(e,v,x,m)}else{e.lineWidth=tt(i.borderWidth)?Math.max(...Object.values(i.borderWidth)):i.borderWidth||1,e.strokeStyle=i.borderColor,e.setLineDash(i.borderDash||[]),e.lineDashOffset=i.borderDashOffset||0;const v=n.leftForLtr(f,d),x=n.leftForLtr(n.xPlus(f,1),d-2),m=Si(i.borderRadius);Object.values(m).some(g=>g!==0)?(e.beginPath(),e.fillStyle=a.multiKeyBackground,Zh(e,{x:v,y:_,w:d,h:c,radius:m}),e.fill(),e.stroke(),e.fillStyle=i.backgroundColor,e.beginPath(),Zh(e,{x,y:_+1,w:d-2,h:c-2,radius:m}),e.fill()):(e.fillStyle=a.multiKeyBackground,e.fillRect(v,_,d,c),e.strokeRect(v,_,d,c),e.fillStyle=i.backgroundColor,e.fillRect(x,_+1,d-2,c-2))}e.fillStyle=this.labelTextColors[s]}drawBody(e,r,s){const{body:n}=this,{bodySpacing:a,bodyAlign:i,displayColors:l,boxHeight:c,boxWidth:d,boxPadding:u}=s,h=Qr(s.bodyFont);let f=h.lineHeight,p=0;const _=uo(s.rtl,this.x,this.width),v=function(I){r.fillText(I,_.x(e.x+p),e.y+f/2),e.y+=f+a},x=_.textAlign(i);let m,g,y,w,b,C,j;for(r.textAlign=i,r.textBaseline="middle",r.font=h.string,e.x=Zl(this,x,s),r.fillStyle=s.bodyColor,ct(this.beforeBody,v),p=l&&x!=="right"?i==="center"?d/2+u:d+2+u:0,w=0,C=n.length;w<C;++w){for(m=n[w],g=this.labelTextColors[w],r.fillStyle=g,ct(m.before,v),y=m.lines,l&&y.length&&(this._drawColorBox(r,e,w,_,s),f=Math.max(h.lineHeight,c)),b=0,j=y.length;b<j;++b)v(y[b]),f=h.lineHeight;ct(m.after,v)}p=0,f=h.lineHeight,ct(this.afterBody,v),e.y-=a}drawFooter(e,r,s){const n=this.footer,a=n.length;let i,l;if(a){const c=uo(s.rtl,this.x,this.width);for(e.x=Zl(this,s.footerAlign,s),e.y+=s.footerMarginTop,r.textAlign=c.textAlign(s.footerAlign),r.textBaseline="middle",i=Qr(s.footerFont),r.fillStyle=s.footerColor,r.font=i.string,l=0;l<a;++l)r.fillText(n[l],c.x(e.x),e.y+i.lineHeight/2),e.y+=i.lineHeight+s.footerSpacing}}drawBackground(e,r,s,n){const{xAlign:a,yAlign:i}=this,{x:l,y:c}=e,{width:d,height:u}=s,{topLeft:h,topRight:f,bottomLeft:p,bottomRight:_}=Si(n.cornerRadius);r.fillStyle=n.backgroundColor,r.strokeStyle=n.borderColor,r.lineWidth=n.borderWidth,r.beginPath(),r.moveTo(l+h,c),i==="top"&&this.drawCaret(e,r,s,n),r.lineTo(l+d-f,c),r.quadraticCurveTo(l+d,c,l+d,c+f),i==="center"&&a==="right"&&this.drawCaret(e,r,s,n),r.lineTo(l+d,c+u-_),r.quadraticCurveTo(l+d,c+u,l+d-_,c+u),i==="bottom"&&this.drawCaret(e,r,s,n),r.lineTo(l+p,c+u),r.quadraticCurveTo(l,c+u,l,c+u-p),i==="center"&&a==="left"&&this.drawCaret(e,r,s,n),r.lineTo(l,c+h),r.quadraticCurveTo(l,c,l+h,c),r.closePath(),r.fill(),n.borderWidth>0&&r.stroke()}_updateAnimationTarget(e){const r=this.chart,s=this.$animations,n=s&&s.x,a=s&&s.y;if(n||a){const i=oi[e.position].call(this,this._active,this._eventPosition);if(!i)return;const l=this._size=I_(this,e),c=Object.assign({},i,this._size),d=k_(r,e,c),u=E_(e,c,d,r);(n._to!==u.x||a._to!==u.y)&&(this.xAlign=d.xAlign,this.yAlign=d.yAlign,this.width=l.width,this.height=l.height,this.caretX=i.x,this.caretY=i.y,this._resolveAnimations().update(this,u))}}_willRender(){return!!this.opacity}draw(e){const r=this.options.setContext(this.getContext());let s=this.opacity;if(!s)return;this._updateAnimationTarget(r);const n={width:this.width,height:this.height},a={x:this.x,y:this.y};s=Math.abs(s)<.001?0:s;const i=Rs(r.padding),l=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;r.enabled&&l&&(e.save(),e.globalAlpha=s,this.drawBackground(a,e,n,r),cx(e,r.textDirection),a.y+=i.top,this.drawTitle(a,e,r),this.drawBody(a,e,r),this.drawFooter(a,e,r),dx(e,r.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,r){const s=this._active,n=e.map(({datasetIndex:l,index:c})=>{const d=this.chart.getDatasetMeta(l);if(!d)throw new Error("Cannot find a dataset at index "+l);return{datasetIndex:l,element:d.data[c],index:c}}),a=!Zc(s,n),i=this._positionChanged(n,r);(a||i)&&(this._active=n,this._eventPosition=r,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,r,s=!0){if(r&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const n=this.options,a=this._active||[],i=this._getActiveElements(e,a,r,s),l=this._positionChanged(i,e),c=r||!Zc(i,a)||l;return c&&(this._active=i,(n.enabled||n.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,r))),c}_getActiveElements(e,r,s,n){const a=this.options;if(e.type==="mouseout")return[];if(!n)return r.filter(l=>this.chart.data.datasets[l.datasetIndex]&&this.chart.getDatasetMeta(l.datasetIndex).controller.getParsed(l.index)!==void 0);const i=this.chart.getElementsAtEventForMode(e,a.mode,a,s);return a.reverse&&i.reverse(),i}_positionChanged(e,r){const{caretX:s,caretY:n,options:a}=this,i=oi[a.position].call(this,e,r);return i!==!1&&(s!==i.x||n!==i.y)}}W(tf,"positioners",oi);var a5={id:"tooltip",_element:tf,positioners:oi,afterInit(t,e,r){r&&(t.tooltip=new tf({chart:t,options:r}))},beforeUpdate(t,e,r){t.tooltip&&t.tooltip.initialize(r)},reset(t,e,r){t.tooltip&&t.tooltip.initialize(r)},afterDraw(t){const e=t.tooltip;if(e&&e._willRender()){const r={tooltip:e};if(t.notifyPlugins("beforeTooltipDraw",{...r,cancelable:!0})===!1)return;e.draw(t.ctx),t.notifyPlugins("afterTooltipDraw",r)}},afterEvent(t,e){if(t.tooltip){const r=e.replay;t.tooltip.handleEvent(e.event,r,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(t,e)=>e.bodyFont.size,boxWidth:(t,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:Sx},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:t=>t!=="filter"&&t!=="itemSort"&&t!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const Od={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Jr=Object.keys(Od);function A_(t,e){return t-e}function D_(t,e){if(Ir(e))return null;const r=t._adapter,{parser:s,round:n,isoWeekday:a}=t._parseOpts;let i=e;return typeof s=="function"&&(i=s(i)),un(i)||(i=typeof s=="string"?r.parse(i,s):r.parse(i)),i===null?null:(n&&(i=n==="week"&&(rd(a)||a===!0)?r.startOf(i,"isoWeek",a):r.startOf(i,n)),+i)}function M_(t,e,r,s){const n=Jr.length;for(let a=Jr.indexOf(t);a<n-1;++a){const i=Od[Jr[a]],l=i.steps?i.steps:Number.MAX_SAFE_INTEGER;if(i.common&&Math.ceil((r-e)/(l*i.size))<=s)return Jr[a]}return Jr[n-1]}function o5(t,e,r,s,n){for(let a=Jr.length-1;a>=Jr.indexOf(r);a--){const i=Jr[a];if(Od[i].common&&t._adapter.diff(n,s,i)>=e-1)return i}return Jr[r?Jr.indexOf(r):0]}function i5(t){for(let e=Jr.indexOf(t)+1,r=Jr.length;e<r;++e)if(Od[Jr[e]].common)return Jr[e]}function R_(t,e,r){if(!r)t[e]=!0;else if(r.length){const{lo:s,hi:n}=gm(r,e),a=r[s]>=e?r[s]:r[n];t[a]=!0}}function l5(t,e,r,s){const n=t._adapter,a=+n.startOf(e[0].value,s),i=e[e.length-1].value;let l,c;for(l=a;l<=i;l=+n.add(l,1,s))c=r[l],c>=0&&(e[c].major=!0);return e}function P_(t,e,r){const s=[],n={},a=e.length;let i,l;for(i=0;i<a;++i)l=e[i],n[l]=i,s.push({value:l,major:!1});return a===0||!r?s:l5(t,s,n,r)}class ld extends Rd{constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,r={}){const s=e.time||(e.time={}),n=this._adapter=new LE._date(e.adapters.date);n.init(r),xi(s.displayFormats,n.formats()),this._parseOpts={parser:s.parser,round:s.round,isoWeekday:s.isoWeekday},super.init(e),this._normalized=r.normalized}parse(e,r){return e===void 0?null:D_(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,r=this._adapter,s=e.time.unit||"day";let{min:n,max:a,minDefined:i,maxDefined:l}=this.getUserBounds();function c(d){!i&&!isNaN(d.min)&&(n=Math.min(n,d.min)),!l&&!isNaN(d.max)&&(a=Math.max(a,d.max))}(!i||!l)&&(c(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&c(this.getMinMax(!1))),n=un(n)&&!isNaN(n)?n:+r.startOf(Date.now(),s),a=un(a)&&!isNaN(a)?a:+r.endOf(Date.now(),s)+1,this.min=Math.min(n,a-1),this.max=Math.max(n+1,a)}_getLabelBounds(){const e=this.getLabelTimestamps();let r=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;return e.length&&(r=e[0],s=e[e.length-1]),{min:r,max:s}}buildTicks(){const e=this.options,r=e.time,s=e.ticks,n=s.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&n.length&&(this.min=this._userMin||n[0],this.max=this._userMax||n[n.length-1]);const a=this.min,i=this.max,l=Ck(n,a,i);return this._unit=r.unit||(s.autoSkip?M_(r.minUnit,this.min,this.max,this._getLabelCapacity(a)):o5(this,l.length,r.minUnit,this.min,this.max)),this._majorUnit=!s.major.enabled||this._unit==="year"?void 0:i5(this._unit),this.initOffsets(n),e.reverse&&l.reverse(),P_(this,l,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let r=0,s=0,n,a;this.options.offset&&e.length&&(n=this.getDecimalForValue(e[0]),e.length===1?r=1-n:r=(this.getDecimalForValue(e[1])-n)/2,a=this.getDecimalForValue(e[e.length-1]),e.length===1?s=a:s=(a-this.getDecimalForValue(e[e.length-2]))/2);const i=e.length<3?.5:.25;r=_s(r,0,i),s=_s(s,0,i),this._offsets={start:r,end:s,factor:1/(r+1+s)}}_generate(){const e=this._adapter,r=this.min,s=this.max,n=this.options,a=n.time,i=a.unit||M_(a.minUnit,r,s,this._getLabelCapacity(r)),l=dt(n.ticks.stepSize,1),c=i==="week"?a.isoWeekday:!1,d=rd(c)||c===!0,u={};let h=r,f,p;if(d&&(h=+e.startOf(h,"isoWeek",c)),h=+e.startOf(h,d?"day":i),e.diff(s,r,i)>1e5*l)throw new Error(r+" and "+s+" are too far apart with stepSize of "+l+" "+i);const _=n.ticks.source==="data"&&this.getDataTimestamps();for(f=h,p=0;f<s;f=+e.add(f,l,i),p++)R_(u,f,_);return(f===s||n.bounds==="ticks"||p===1)&&R_(u,f,_),Object.keys(u).sort(A_).map(v=>+v)}getLabelForValue(e){const r=this._adapter,s=this.options.time;return s.tooltipFormat?r.format(e,s.tooltipFormat):r.format(e,s.displayFormats.datetime)}format(e,r){const n=this.options.time.displayFormats,a=this._unit,i=r||n[a];return this._adapter.format(e,i)}_tickFormatFunction(e,r,s,n){const a=this.options,i=a.ticks.callback;if(i)return wt(i,[e,r,s],this);const l=a.time.displayFormats,c=this._unit,d=this._majorUnit,u=c&&l[c],h=d&&l[d],f=s[r],p=d&&h&&f&&f.major;return this._adapter.format(e,n||(p?h:u))}generateTickLabels(e){let r,s,n;for(r=0,s=e.length;r<s;++r)n=e[r],n.label=this._tickFormatFunction(n.value,r,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const r=this._offsets,s=this.getDecimalForValue(e);return this.getPixelForDecimal((r.start+s)*r.factor)}getValueForPixel(e){const r=this._offsets,s=this.getDecimalForPixel(e)/r.factor-r.end;return this.min+s*(this.max-this.min)}_getLabelSize(e){const r=this.options.ticks,s=this.ctx.measureText(e).width,n=_a(this.isHorizontal()?r.maxRotation:r.minRotation),a=Math.cos(n),i=Math.sin(n),l=this._resolveTickFontOptions(0).size;return{w:s*a+l*i,h:s*i+l*a}}_getLabelCapacity(e){const r=this.options.time,s=r.displayFormats,n=s[r.unit]||s.millisecond,a=this._tickFormatFunction(e,0,P_(this,[e],this._majorUnit),n),i=this._getLabelSize(a),l=Math.floor(this.isHorizontal()?this.width/i.w:this.height/i.h)-1;return l>0?l:1}getDataTimestamps(){let e=this._cache.data||[],r,s;if(e.length)return e;const n=this.getMatchingVisibleMetas();if(this._normalized&&n.length)return this._cache.data=n[0].controller.getAllParsedValues(this);for(r=0,s=n.length;r<s;++r)e=e.concat(n[r].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let r,s;if(e.length)return e;const n=this.getLabels();for(r=0,s=n.length;r<s;++r)e.push(D_(this,n[r]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return Ik(e.sort(A_))}}W(ld,"id","time"),W(ld,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function Xl(t,e,r){let s=0,n=t.length-1,a,i,l,c;r?(e>=t[s].pos&&e<=t[n].pos&&({lo:s,hi:n}=Yh(t,"pos",e)),{pos:a,time:l}=t[s],{pos:i,time:c}=t[n]):(e>=t[s].time&&e<=t[n].time&&({lo:s,hi:n}=Yh(t,"time",e)),{time:a,pos:l}=t[s],{time:i,pos:c}=t[n]);const d=i-a;return d?l+(c-l)*(e-a)/d:l}class O_ extends ld{constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),r=this._table=this.buildLookupTable(e);this._minPos=Xl(r,this.min),this._tableRange=Xl(r,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:r,max:s}=this,n=[],a=[];let i,l,c,d,u;for(i=0,l=e.length;i<l;++i)d=e[i],d>=r&&d<=s&&n.push(d);if(n.length<2)return[{time:r,pos:0},{time:s,pos:1}];for(i=0,l=n.length;i<l;++i)u=n[i+1],c=n[i-1],d=n[i],Math.round((u+c)/2)!==d&&a.push({time:d,pos:i/(l-1)});return a}_generate(){const e=this.min,r=this.max;let s=super.getDataTimestamps();return(!s.includes(e)||!s.length)&&s.splice(0,0,e),(!s.includes(r)||s.length===1)&&s.push(r),s.sort((n,a)=>n-a)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const r=this.getDataTimestamps(),s=this.getLabelTimestamps();return r.length&&s.length?e=this.normalize(r.concat(s)):e=r.length?r:s,e=this._cache.all=e,e}getDecimalForValue(e){return(Xl(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const r=this._offsets,s=this.getDecimalForPixel(e)/r.factor-r.end;return Xl(this._table,s*this._tableRange+this._minPos,!0)}}W(O_,"id","timeseries"),W(O_,"defaults",ld.defaults);const jx="label";function $_(t,e){typeof t=="function"?t(e):t&&(t.current=e)}function c5(t,e){const r=t.options;r&&e&&Object.assign(r,e)}function Cx(t,e){t.labels=e}function Nx(t,e,r=jx){const s=[];t.datasets=e.map(n=>{const a=t.datasets.find(i=>i[r]===n[r]);return!a||!n.data||s.includes(a)?{...n}:(s.push(a),Object.assign(a,n),a)})}function d5(t,e=jx){const r={labels:[],datasets:[]};return Cx(r,t.labels),Nx(r,t.datasets,e),r}function u5(t,e){const{height:r=150,width:s=300,redraw:n=!1,datasetIdKey:a,type:i,data:l,options:c,plugins:d=[],fallbackContent:u,updateMode:h,...f}=t,p=S.useRef(null),_=S.useRef(null),v=()=>{p.current&&(_.current=new Pd(p.current,{type:i,data:d5(l,a),options:c&&{...c},plugins:d}),$_(e,_.current))},x=()=>{$_(e,null),_.current&&(_.current.destroy(),_.current=null)};return S.useEffect(()=>{!n&&_.current&&c&&c5(_.current,c)},[n,c]),S.useEffect(()=>{!n&&_.current&&Cx(_.current.config.data,l.labels)},[n,l.labels]),S.useEffect(()=>{!n&&_.current&&l.datasets&&Nx(_.current.config.data,l.datasets,a)},[n,l.datasets]),S.useEffect(()=>{_.current&&(n?(x(),setTimeout(v)):_.current.update(h))},[n,c,l.labels,l.datasets,h]),S.useEffect(()=>{_.current&&(x(),setTimeout(v))},[i]),S.useEffect(()=>(v(),()=>x()),[]),o.jsx("canvas",{ref:p,role:"img",height:r,width:s,...f,children:u})}const h5=S.forwardRef(u5);function f5(t,e){return Pd.register(e),S.forwardRef((r,s)=>o.jsx(h5,{...r,ref:s,type:t}))}const m5=f5("doughnut",si),p5="_chartContainer_1q10w_5",g5="_emptyChart_1q10w_11",F_={chartContainer:p5,emptyChart:g5};Pd.register(ai,a5,Q4);const _5=({data:t,formatCurrency:e})=>{if(!t||t.length===0)return o.jsx("div",{className:F_.emptyChart,children:o.jsx("p",{children:"No expense data available for this month"})});const r=a=>{const i=["#0064FF","#00C896","#FF9500","#FF5847","#6C757D","#8B4FC3","#00D2FF","#FFD700","#FF69B4","#32CD32"],l=[];for(let c=0;c<a;c++)l.push(i[c%i.length]);return l},s={labels:t.map(a=>a.category),datasets:[{data:t.map(a=>a.amount),backgroundColor:r(t.length),borderWidth:0,hoverOffset:4}]},n={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"right",labels:{usePointStyle:!0,font:{family:'Inter, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',size:14},color:"#495057",padding:12,generateLabels:a=>{const i=a.data.datasets;return a.data.labels.map((l,c)=>{var u;const d=((u=t[c])==null?void 0:u.percentage)||0;return{text:`${l} (${d.toFixed(1)}%)`,fillStyle:i[0].backgroundColor[c],strokeStyle:i[0].backgroundColor[c],lineWidth:0,hidden:!1,index:c}})}}},tooltip:{callbacks:{label:function(a){var d;const i=a.label||"",l=a.parsed||0,c=((d=t[a.dataIndex])==null?void 0:d.percentage)||0;return`${i}: ${e(l)} (${c.toFixed(1)}%)`}}}},cutout:"65%",animation:{animateRotate:!0,duration:1e3}};return o.jsx("div",{className:F_.chartContainer,children:o.jsx(m5,{data:s,options:n})})},y5="_container_zmpws_6",v5="_selectButton_zmpws_15",x5="_active_zmpws_40",b5="_selectValue_zmpws_47",w5="_arrow_zmpws_55",S5="_menu_zmpws_69",j5="_show_zmpws_89",C5="_searchWrapper_zmpws_96",N5="_searchInput_zmpws_102",I5="_optionsList_zmpws_125",k5="_option_zmpws_125",E5="_selected_zmpws_150",T5="_optionLabel_zmpws_159",L5="_optionDescription_zmpws_165",A5="_emptyState_zmpws_171",Lr={container:y5,selectButton:v5,active:x5,selectValue:b5,arrow:w5,menu:S5,show:j5,searchWrapper:C5,searchInput:N5,optionsList:I5,option:k5,selected:E5,optionLabel:T5,optionDescription:L5,emptyState:A5},D5=({companies:t,selectedCompanyId:e,onChange:r,className:s=""})=>{const[n,a]=S.useState(!1),[i,l]=S.useState(""),c=S.useRef(null),d=S.useRef(null),u=t.find(x=>x.company_id===e),h=t.filter(x=>x.company_name.toLowerCase().includes(i.toLowerCase()));S.useEffect(()=>{const x=m=>{c.current&&!c.current.contains(m.target)&&a(!1)};return n&&document.addEventListener("mousedown",x),()=>{document.removeEventListener("mousedown",x)}},[n]),S.useEffect(()=>{n&&d.current&&d.current.focus()},[n]);const f=()=>{a(!n),l("")},p=x=>{r(x.company_id,x),a(!1),l("")},_=x=>{l(x.target.value)},v=u?u.company_name:"Select Company";return o.jsxs("div",{ref:c,className:`${Lr.container} ${s}`,children:[o.jsxs("button",{type:"button",className:`${Lr.selectButton} ${n?Lr.active:""}`,onClick:f,"aria-haspopup":"listbox","aria-expanded":n,children:[o.jsx("span",{className:Lr.selectValue,children:v}),o.jsx("svg",{className:Lr.arrow,viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M7 10l5 5 5-5z"})})]}),o.jsxs("div",{className:`${Lr.menu} ${n?Lr.show:""}`,children:[t.length>5&&o.jsx("div",{className:Lr.searchWrapper,children:o.jsx("input",{ref:d,type:"text",className:Lr.searchInput,placeholder:"Search companies...",value:i,onChange:_})}),o.jsx("div",{className:Lr.optionsList,children:h.length>0?h.map(x=>{var m,g;return o.jsxs("div",{className:`${Lr.option} ${x.company_id===e?Lr.selected:""}`,onClick:()=>p(x),role:"option","aria-selected":x.company_id===e,children:[o.jsx("div",{className:Lr.optionLabel,children:x.company_name}),o.jsxs("div",{className:Lr.optionDescription,children:[((m=x.stores)==null?void 0:m.length)||0," store",((g=x.stores)==null?void 0:g.length)!==1?"s":""]})]},x.company_id)}):o.jsx("div",{className:Lr.emptyState,children:"No companies found"})})]})]})},M5="_navbarComponent_2f9ud_7",R5="_navbarInner_2f9ud_16",P5="_navbarBrand_2f9ud_47",O5="_navbarLogo_2f9ud_55",$5="_navbarTitle_2f9ud_63",F5="_navbarMenu_2f9ud_71",B5="_navbarNavItem_2f9ud_79",V5="_navbarNavLink_2f9ud_84",H5="_active_2f9ud_102",z5="_navbarDropdownMenu_2f9ud_108",q5="_show_2f9ud_126",U5="_navbarDropdownSection_2f9ud_133",W5="_navbarDropdownTitle_2f9ud_141",G5="_navbarDropdownLink_2f9ud_151",J5="_navbarUser_2f9ud_191",K5="_navbarUserProfile_2f9ud_227",Y5="_navbarUserAvatar_2f9ud_241",Q5="_navbarUserInfo_2f9ud_254",Z5="_navbarBtnSell_2f9ud_268",X5="_navbarBtnSellActive_2f9ud_291",eT="_navbarBtnSignout_2f9ud_298",Et={navbarComponent:M5,navbarInner:R5,navbarBrand:P5,navbarLogo:O5,navbarTitle:$5,navbarMenu:F5,navbarNavItem:B5,navbarNavLink:V5,active:H5,navbarDropdownMenu:z5,show:q5,navbarDropdownSection:U5,navbarDropdownTitle:W5,navbarDropdownLink:G5,navbarUser:J5,navbarUserProfile:K5,navbarUserAvatar:Y5,navbarUserInfo:Q5,navbarBtnSell:Z5,navbarBtnSellActive:X5,navbarBtnSignout:eT},Se=({activeItem:t="dashboard",user:e,onSignOut:r})=>{const{currentCompany:s,companies:n,setCurrentCompany:a}=ht(),[i,l]=S.useState((e==null?void 0:e.name)||"Loading..."),[c,d]=S.useState((e==null?void 0:e.email)||"Loading..."),[u,h]=S.useState(null),[f,p]=S.useState(null),[_,v]=S.useState(!1),x=S.useRef({}),m=[{id:"dashboard",label:"Dashboard",href:"/dashboard",active:t==="dashboard"},{id:"product",label:"Product",href:"#",dropdown:[{section:"Product Management",items:[{label:"Inventory",href:"/product/inventory",action:"Inventory"},{label:"Invoice",href:"/product/invoice",action:"Invoice"},{label:"Sale Product",href:"/product/create-invoice",action:"Sale Product"},{label:"Order",href:"/product/order",action:"Order"},{label:"Product Receive",href:"/product/product-receive",action:"Product Receive"},{label:"Tracking",href:"/product/tracking",action:"Tracking"}]}]},{id:"marketing",label:"Marketing",href:"#",dropdown:[{section:"Marketing Tools",items:[{label:"Marketing Plan",href:"/marketing/marketing-plan",action:"Marketing Plan"}]}]},{id:"finance",label:"Finance",href:"#",dropdown:[{section:"Financial Reports",items:[{label:"Balance Sheet",href:"/finance/balance-sheet",action:"Balance Sheet"},{label:"Income Statement",href:"/finance/income-statement",action:"Income Statement"}]},{section:"Transactions",items:[{label:"Journal Input",href:"/finance/journal-input",action:"Journal Input"},{label:"Transaction History",href:"/finance/transaction-history",action:"Transaction History"},{label:"Cash Ending",href:"/finance/cash-ending",action:"Cash Ending"}]}]},{id:"employee",label:"Employee",href:"#",dropdown:[{section:"Employee Management",items:[{label:"Schedule",href:"/employee/schedule",action:"Schedule"},{label:"Employee Setting",href:"/employee/employee-setting",action:"Employee Setting"},{label:"Salary",href:"/employee/salary",action:"Salary"}]}]},{id:"setting",label:"Setting",href:"#",dropdown:[{section:"General Settings",items:[{label:"Currency",href:"/settings/currency",action:"Currency"},{label:"Company & Store Setting",href:"/settings/store-setting",action:"Company & Store Setting"}]},{section:"Financial Settings",items:[{label:"Account Mapping",href:"/settings/account-mapping",action:"Account Mapping"},{label:"Counterparty",href:"/settings/counterparty",action:"Counterparty"}]}]}];S.useEffect(()=>{(()=>{const T=window.location.pathname,D={"product/inventory":"Inventory","product/invoice":"Invoice","product/create-invoice":"Sale Product","product/order":"Order","product/product-receive":"Product Receive","product/tracking":"Tracking","finance/balance-sheet":"Balance Sheet","finance/income-statement":"Income Statement","finance/journal-input":"Journal Input","finance/transaction-history":"Transaction History","finance/cash-ending":"Cash Ending","employee/schedule":"Schedule","employee/employee-setting":"Employee Setting","employee/salary":"Salary","marketing/marketing-plan":"Marketing Plan","settings/currency":"Currency","settings/store-setting":"Company & Store Setting","settings/account-mapping":"Account Mapping","settings/counterparty":"Counterparty",dashboard:"Dashboard"};for(const[N,A]of Object.entries(D))if(T.includes(N))return p(A),N==="product/create-invoice"&&v(!0),A;return v(!1),null})()},[]),S.useEffect(()=>{e||(async()=>{var T,D,N;try{const A=se.getClient(),{data:{session:$}}=await A.auth.getSession();if($&&$.user){let z=((T=$.user.user_metadata)==null?void 0:T.full_name)||((D=$.user.user_metadata)==null?void 0:D.name)||((N=$.user.user_metadata)==null?void 0:N.display_name);!z&&$.user.email&&(z=$.user.email.split("@")[0].replace(/[._]/g," ").split(" ").map(L=>L.charAt(0).toUpperCase()+L.slice(1)).join(" ")),l(z||"User"),d($.user.email||"")}}catch(A){console.error("Error loading user info:",A)}})()},[e]),S.useEffect(()=>{const E=T=>{T.target.closest(`.${Et.navbarNavItem}`)||h(null)};return document.addEventListener("click",E),()=>document.removeEventListener("click",E)},[]);const g=(E,T,D)=>{E==="dashboard"?window.location.href="/dashboard":D||console.log(`Navigation clicked: ${T}`)},y=E=>{h(u===E?null:E)},w=(E,T)=>{console.log(`Dropdown action: ${E}`),window.location.href=T},b=async()=>{try{await se.getClient().auth.signOut(),localStorage.removeItem("user"),localStorage.removeItem("session"),localStorage.removeItem("companyChoosen"),localStorage.removeItem("storeChoosen"),r?r():window.location.href="/login"}catch(E){console.error("Sign out error:",E)}},C=(E,T)=>{localStorage.setItem("companyChoosen",E),T.stores&&T.stores.length>0?localStorage.setItem("storeChoosen",T.stores[0].store_id):localStorage.removeItem("storeChoosen"),a(T),window.dispatchEvent(new CustomEvent("companyChanged",{detail:{companyId:E,companyName:T.company_name,company:T}})),typeof window.onCompanyChange=="function"&&window.onCompanyChange(E)},j=E=>f===E,k=(()=>{for(const E of m)if(E.dropdown){for(const T of E.dropdown)for(const D of T.items)if(D.action===f)return E.id}return t})();return o.jsx("nav",{className:Et.navbarComponent,children:o.jsxs("div",{className:Et.navbarInner,children:[o.jsxs("a",{href:"/dashboard",className:Et.navbarBrand,children:[o.jsx("div",{className:Et.navbarLogo,children:o.jsx("img",{src:"/assets/app icon.png",alt:"Store Base",style:{height:"30px",objectFit:"contain"}})}),o.jsx("h1",{className:Et.navbarTitle,children:"Store Base"})]}),o.jsx("div",{className:Et.navbarMenu,children:m.map(E=>{const T=E.dropdown&&E.dropdown.length>0,D=E.id===k;return o.jsxs("div",{className:Et.navbarNavItem,onMouseEnter:()=>T&&h(E.id),onMouseLeave:()=>T&&h(null),children:[o.jsx("a",{href:E.href,className:`${Et.navbarNavLink} ${D?Et.active:""}`,onClick:N=>{T?(N.preventDefault(),y(E.id)):g(E.id,E.label,T)},children:E.label}),T&&o.jsx("div",{className:`${Et.navbarDropdownMenu} ${u===E.id?Et.show:""}`,ref:N=>x.current[E.id]=N,children:E.dropdown.map((N,A)=>o.jsxs("div",{className:Et.navbarDropdownSection,children:[o.jsx("div",{className:Et.navbarDropdownTitle,children:N.section}),N.items.map(($,z)=>{const H=j($.action);return o.jsx("a",{href:$.href,className:`${Et.navbarDropdownLink} ${H?Et.active:""}`,onClick:L=>{L.preventDefault(),w($.action,$.href)},children:$.label},z)})]},A))})]},E.id)})}),o.jsxs("div",{className:Et.navbarUser,children:[o.jsxs("button",{className:`${Et.navbarBtnSell} ${_?Et.navbarBtnSellActive:""}`,onClick:()=>window.location.href="/product/create-invoice",children:[o.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M17,18C15.89,18 15,18.89 15,20A2,2 0 0,0 17,22A2,2 0 0,0 19,20C19,18.89 18.1,18 17,18M1,2V4H3L6.6,11.59L5.24,14.04C5.09,14.32 5,14.65 5,15A2,2 0 0,0 7,17H19V15H7.42A0.25,0.25 0 0,1 7.17,14.75C7.17,14.7 7.18,14.66 7.2,14.63L8.1,13H15.55C16.3,13 16.96,12.58 17.3,11.97L20.88,5.5C20.95,5.34 21,5.17 21,5A1,1 0 0,0 20,4H5.21L4.27,2M7,18C5.89,18 5,18.89 5,20A2,2 0 0,0 7,22A2,2 0 0,0 9,20C9,18.89 8.1,18 7,18Z"})}),"Sell"]}),n&&n.length>0&&o.jsx(D5,{companies:n,selectedCompanyId:(s==null?void 0:s.company_id)||"",onChange:(E,T)=>{C(E,T)}}),o.jsxs("div",{className:Et.navbarUserProfile,children:[o.jsx("div",{className:Et.navbarUserAvatar,children:i.charAt(0).toUpperCase()}),o.jsxs("div",{className:Et.navbarUserInfo,children:[o.jsx("h4",{children:i}),o.jsx("p",{children:c})]})]}),o.jsx("button",{className:Et.navbarBtnSignout,onClick:b,children:"Sign Out"})]})]})})},tT="_pageLayout_1572z_6",rT="_container_1572z_36",sT="_header_1572z_43",nT="_title_1572z_48",aT="_overviewGrid_1572z_67",oT="_contentGrid_1572z_86",iT="_contentSection_1572z_93",lT="_sectionHeader_1572z_100",cT="_sectionTitle_1572z_108",dT="_viewAllLink_1572z_115",uT="_sectionContent_1572z_126",hT="_transactionsList_1572z_202",fT="_transactionItem_1572z_208",mT="_transactionIcon_1572z_220",pT="_transactionInfo_1572z_233",gT="_transactionDescription_1572z_240",_T="_transactionDate_1572z_247",yT="_transactionAmount_1572z_253",vT="_income_1572z_260",xT="_expense_1572z_160",bT="_emptyTransactions_1572z_268",wT="_emptyState_1572z_307",Ye={pageLayout:tT,container:rT,header:sT,title:nT,overviewGrid:aT,contentGrid:oT,contentSection:iT,sectionHeader:lT,sectionTitle:cT,viewAllLink:dT,sectionContent:uT,transactionsList:hT,transactionItem:fT,transactionIcon:mT,transactionInfo:pT,transactionDescription:gT,transactionDate:_T,transactionAmount:yT,income:vT,expense:xT,emptyTransactions:bT,emptyState:wT},ST="7e1fd11a-f632-427d-aefc-8b3dd6734faa",jT=()=>{const t=Io(),{currentCompany:e,permissions:r}=ht(),s=(e==null?void 0:e.company_id)||"",{data:n,loading:a,errorDialog:i,refresh:l,clearError:c}=LI(s),[d,u]=S.useState(!1),h=_=>{_.preventDefault(),r.includes(ST)?t("/finance/transaction-history"):u(!0)};if(!e)return o.jsxs(o.Fragment,{children:[o.jsx(Se,{activeItem:"dashboard"}),o.jsx("div",{className:Ye.pageLayout,children:o.jsx("div",{className:Ye.container,children:o.jsx(Me,{size:"large",fullscreen:!0})})})]});if(a)return o.jsxs(o.Fragment,{children:[o.jsx(Se,{activeItem:"dashboard"}),o.jsx("div",{className:Ye.pageLayout,children:o.jsx("div",{className:Ye.container,children:o.jsx(Me,{size:"large",fullscreen:!0})})})]});if(!n&&!a)return o.jsxs(o.Fragment,{children:[o.jsx(Se,{activeItem:"dashboard"}),o.jsx("div",{className:Ye.pageLayout,children:o.jsxs("div",{className:Ye.container,children:[o.jsx("div",{className:Ye.header,children:o.jsx("h1",{className:Ye.title,children:"Dashboard"})}),o.jsx("div",{className:Ye.emptyState,children:o.jsx("p",{children:qe.emptyStates.noDashboardData})})]})}),o.jsx($e,{variant:i.variant,title:i.title,message:i.message,isOpen:i.isOpen,onClose:c,confirmText:qe.actions.retry,onConfirm:l})]});const f=0,p=(n==null?void 0:n.monthOverMonthGrowth)||0;return o.jsxs(o.Fragment,{children:[o.jsx(Se,{activeItem:"dashboard"}),o.jsx("div",{className:Ye.pageLayout,children:o.jsxs("div",{className:Ye.container,children:[o.jsx("div",{className:Ye.header,children:o.jsx("h1",{className:Ye.title,children:"Dashboard"})}),o.jsxs("div",{className:Ye.overviewGrid,children:[o.jsx(Vl,{title:"Today Revenue",value:(n==null?void 0:n.formattedTodayRevenue)||"0",icon:o.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M11.8,10.9C9.53,10.31 8.8,9.7 8.8,8.75C8.8,7.66 9.81,6.9 11.5,6.9C13.28,6.9 13.94,7.75 14,9H16.21C16.14,7.28 15.09,5.7 13,5.19V3H10V5.16C8.06,5.58 6.5,6.84 6.5,8.77C6.5,11.08 8.41,12.23 11.2,12.9C13.7,13.5 14.2,14.38 14.2,15.31C14.2,16 13.71,17.1 11.5,17.1C9.44,17.1 8.63,16.18 8.52,15H6.32C6.44,17.19 8.08,18.42 10,18.83V21H13V18.85C14.95,18.5 16.5,17.35 16.5,15.3C16.5,12.46 14.07,11.5 11.8,10.9Z"})}),changePercentage:f,isPositive:f>=0},"today-revenue"),o.jsx(Vl,{title:"Today Expense",value:(n==null?void 0:n.formattedTodayExpense)||"0",icon:o.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M3,6H21V18H3V6M12,9A3,3 0 0,1 15,12A3,3 0 0,1 12,15A3,3 0 0,1 9,12A3,3 0 0,1 12,9M7,8A2,2 0 0,1 5,10V14A2,2 0 0,1 7,16H17A2,2 0 0,1 19,14V10A2,2 0 0,1 17,8H7Z"})})},"today-expense"),o.jsx(Vl,{title:"This Month Revenue",value:(n==null?void 0:n.formattedThisMonthRevenue)||"0",icon:o.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M16,6L18.29,8.29L13.41,13.17L9.41,9.17L2,16.59L3.41,18L9.41,12L13.41,16L19.71,9.71L22,12V6H16Z"})}),changePercentage:p,isPositive:(n==null?void 0:n.isGrowthPositive)||!1},"this-month-revenue"),o.jsx(Vl,{title:"Last Month Revenue",value:(n==null?void 0:n.formattedLastMonthRevenue)||"0",icon:o.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M22,21H2V3H4V19H6V10H10V19H12V6H16V19H18V14H22V21Z"})})},"last-month-revenue")]}),o.jsxs("div",{className:Ye.contentGrid,children:[o.jsxs("div",{className:Ye.contentSection,children:[o.jsx("div",{className:Ye.sectionHeader,children:o.jsx("h2",{className:Ye.sectionTitle,children:"This Month Expenses"})}),o.jsx("div",{className:Ye.sectionContent,children:o.jsx(_5,{data:(n==null?void 0:n.expenseBreakdown)||[],formatCurrency:(n==null?void 0:n.formatCurrency)||(_=>`${_.toLocaleString()}`)})})]}),o.jsxs("div",{className:Ye.contentSection,children:[o.jsxs("div",{className:Ye.sectionHeader,children:[o.jsx("h2",{className:Ye.sectionTitle,children:"Recent Activity"}),o.jsx("a",{href:"/finance/transaction-history",className:Ye.viewAllLink,onClick:h,children:"View All"})]}),o.jsx("div",{className:Ye.sectionContent,children:n&&n.recentTransactions.length>0?o.jsx("div",{className:Ye.transactionsList,children:n.recentTransactions.slice(0,5).map(_=>o.jsxs("div",{className:Ye.transactionItem,children:[o.jsx("div",{className:Ye.transactionIcon,children:_.type==="income"?o.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M7,15H9C9,16.08 10.37,17 12,17C13.63,17 15,16.08 15,15C15,13.9 13.96,13.5 11.76,12.97C9.64,12.44 7,11.78 7,9C7,7.21 8.47,5.69 10.5,5.18V3H13.5V5.18C15.53,5.69 17,7.21 17,9H15C15,7.92 13.63,7 12,7C10.37,7 9,7.92 9,9C9,10.1 10.04,10.5 12.24,11.03C14.36,11.56 17,12.22 17,15C17,16.79 15.53,18.31 13.5,18.82V21H10.5V18.82C8.47,18.31 7,16.79 7,15Z"})}):o.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"})})}),o.jsxs("div",{className:Ye.transactionInfo,children:[o.jsx("p",{className:Ye.transactionDescription,children:_.description}),o.jsx("p",{className:Ye.transactionDate,children:re.formatTransactionDate(_.date)})]}),o.jsxs("div",{className:`${Ye.transactionAmount} ${_.type==="income"?Ye.income:Ye.expense}`,children:[_.type==="income"?"+":"-",(n==null?void 0:n.formatCurrency(_.amount))||`${_.amount.toLocaleString()}`]})]},_.id))}):o.jsx("div",{className:Ye.emptyTransactions,children:o.jsx("p",{children:qe.emptyStates.noTransactions})})})]})]})]})}),o.jsx($e,{variant:i.variant,title:i.title,message:i.message,isOpen:i.isOpen,onClose:c,confirmText:qe.actions.retry,onConfirm:l}),o.jsx($e,{variant:"warning",title:"Access Denied",message:"You don't have permission to access the Transaction History page. Please contact your administrator.",isOpen:d,onClose:()=>u(!1),confirmText:"OK"})]})};class CT{async getAccountMappings(e){const r=se.getClient(),{data:s,error:n}=await r.rpc("get_account_mapping_page",{p_company_id:e});if(n)throw console.error("Error fetching account mappings:",n),new Error(n.message);return s||{}}async createAccountMapping(e,r,s,n,a,i){const l=se.getClient(),{data:c,error:d}=await l.rpc("insert_account_mapping_with_company",{p_my_company_id:e,p_counterparty_company_id:r,p_my_account_id:s,p_linked_account_id:n,p_direction:a,p_created_by:i});if(d)throw console.error("Error creating account mapping:",d),new Error(d.message);return c}async deleteAccountMapping(e){const r=se.getClient(),{error:s}=await r.from("account_mappings").update({is_deleted:!0,updated_at:re.nowUtc()}).eq("mapping_id",e);if(s)throw console.error("Error deleting account mapping:",s),new Error(s.message)}async getCompanyAccounts(e){const r=se.getClient(),{data:s,error:n}=await r.rpc("get_account_mapping_page",{p_company_id:e});if(n)throw console.error("Error fetching company accounts:",n),new Error(n.message);return s||{}}}class NT{constructor(e,r,s,n,a,i,l,c,d,u,h,f,p=!1){this.mappingId=e,this.myCompanyId=r,this.myAccountName=s,this.myAccountCode=n,this.myCategoryTag=a,this.linkedCompanyId=i,this.linkedCompanyName=l,this.linkedAccountName=c,this.linkedAccountCode=d,this.linkedCategoryTag=u,this.direction=h,this.createdAt=f,this.isReadOnly=p}getCategoryDisplay(e){switch(e){case"payable":return"Payable";case"receivable":return"Receivable";case"contra_asset":return"Contra Asset";case"cash":return"Cash";case"general":return"General";case"fixed_asset":return"Fixed Asset";case"equity":return"Equity";default:return e}}get directionDisplay(){switch(this.direction){case"outgoing":return"Outgoing";case"incoming":return"Incoming";case"both":return"Both Ways";default:return this.direction}}get isEditable(){return!this.isReadOnly}get isDeletable(){return!this.isReadOnly}get formattedCreatedDate(){return this.createdAt.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}}class B_{static fromJson(e,r=!1){const s=re.toLocalSafe(e.created_at)||new Date;return new NT(e.mapping_id,e.my_company_id,e.my_account_name,e.my_account_code||null,e.my_category_tag,e.linked_company_id,e.linked_company_name,e.linked_account_name,e.linked_account_code||null,e.linked_category_tag,e.direction||"outgoing",s,r)}static toJson(e){return{mapping_id:e.mappingId,my_company_id:e.myCompanyId,my_account_name:e.myAccountName,my_account_code:e.myAccountCode,my_category_tag:e.myCategoryTag,linked_company_id:e.linkedCompanyId,linked_company_name:e.linkedCompanyName,linked_account_name:e.linkedAccountName,linked_account_code:e.linkedAccountCode,linked_category_tag:e.linkedCategoryTag,direction:e.direction,created_at:re.toUtc(e.createdAt)}}static fromJsonArray(e,r=!1){return e.map(s=>this.fromJson(s,r))}static toJsonArray(e){return e.map(r=>this.toJson(r))}static parseRPCResponse(e){const r=e.account_mappings||[],s=e.reverse_account_mappings||[],n=this.fromJsonArray(r,!1),a=this.fromJsonArray(s,!0),i=[...n,...a];return{outgoingMappings:n,incomingMappings:a,allMappings:i}}static extractAccounts(e){return e.accounts||[]}static isValidDTO(e){return typeof e=="object"&&e!==null&&typeof e.mapping_id=="string"&&typeof e.my_company_id=="string"&&typeof e.my_account_name=="string"&&typeof e.linked_company_id=="string"&&typeof e.linked_company_name=="string"&&typeof e.linked_account_name=="string"&&typeof e.created_at=="string"}}class IT{constructor(){W(this,"dataSource");this.dataSource=new CT}async getAccountMappings(e){try{const r=await this.dataSource.getAccountMappings(e),{allMappings:s}=B_.parseRPCResponse(r);return{success:!0,data:s}}catch(r){return console.error("Repository error fetching account mappings:",r),{success:!1,error:r instanceof Error?r.message:"Failed to fetch account mappings"}}}async createAccountMapping(e,r,s,n,a,i){try{return await this.dataSource.createAccountMapping(e,r,s,n,a,i),{success:!0,data:void 0}}catch(l){return console.error("Repository error creating account mapping:",l),{success:!1,error:l instanceof Error?l.message:"Failed to create account mapping"}}}async getCompanyAccounts(e){try{const r=await this.dataSource.getCompanyAccounts(e);return{success:!0,data:B_.extractAccounts(r)}}catch(r){return console.error("Repository error fetching company accounts:",r),{success:!1,error:r instanceof Error?r.message:"Failed to fetch company accounts"}}}async deleteAccountMapping(e){try{return await this.dataSource.deleteAccountMapping(e),{success:!0}}catch(r){return console.error("Repository error deleting account mapping:",r),{success:!1,error:r instanceof Error?r.message:"Failed to delete account mapping"}}}}class V_{static validateAccountSelection(e){return!e||e.trim()===""?{field:"account",message:"Account is required"}:null}static validateCompanySelection(e){return!e||e.trim()===""?{field:"company",message:"Company is required"}:null}static validateDirection(e){if(!e||e.trim()==="")return{field:"direction",message:"Direction is required"};const r=["outgoing","incoming","both"];return r.includes(e)?null:{field:"direction",message:`Direction must be one of: ${r.join(", ")}`}}static validateUserId(e){return!e||e.trim()===""?{field:"user",message:"User ID is required"}:null}static validateCreateMapping(e){const r=[],s=this.validateCompanySelection(e.myCompanyId);s&&r.push(s),this.validateCompanySelection(e.counterpartyCompanyId)&&r.push({field:"counterpartyCompany",message:"Counterparty company is required"}),this.validateAccountSelection(e.myAccountId)&&r.push({field:"myAccount",message:"My account is required"}),this.validateAccountSelection(e.linkedAccountId)&&r.push({field:"linkedAccount",message:"Linked account is required"});const l=this.validateDirection(e.direction);l&&r.push(l);const c=this.validateUserId(e.createdBy);return c&&r.push(c),e.myCompanyId===e.counterpartyCompanyId&&r.push({field:"counterpartyCompany",message:"Cannot create mapping to the same company"}),r}static validateDeleteMapping(e){return!e||e.trim()===""?{field:"mappingId",message:"Mapping ID is required"}:null}static canEdit(e){return e?{allowed:!1,reason:"This mapping is read-only and cannot be edited"}:{allowed:!0}}static canDelete(e){return e?{allowed:!1,reason:"This mapping is read-only and cannot be deleted"}:{allowed:!0}}}const ec=new IT,pt=er((t,e)=>({companyId:"",mappings:[],availableAccounts:[],availableCompanies:[],loading:!1,isCreating:!1,isDeleting:!1,error:null,showAddModal:!1,showDeleteConfirm:!1,deletingMappingId:null,deletingMappingInfo:null,showErrorMessage:!1,errorMessageText:"",getOutgoingMappings:()=>{const{mappings:r}=e();return r.filter(s=>!s.isReadOnly)},getIncomingMappings:()=>{const{mappings:r}=e();return r.filter(s=>s.isReadOnly)},setCompanyId:r=>t({companyId:r}),setMappings:r=>t({mappings:r}),setLoading:r=>t({loading:r}),setError:r=>t({error:r}),setShowAddModal:r=>t({showAddModal:r}),setShowDeleteConfirm:r=>t({showDeleteConfirm:r}),setDeletingMappingId:r=>t({deletingMappingId:r}),setDeletingMappingInfo:r=>t({deletingMappingInfo:r}),setAvailableAccounts:r=>t({availableAccounts:r}),setAvailableCompanies:r=>t({availableCompanies:r}),setShowErrorMessage:r=>t({showErrorMessage:r}),setErrorMessageText:r=>t({errorMessageText:r}),loadMappings:async()=>{const{companyId:r}=e();if(!r){t({mappings:[],loading:!1});return}t({loading:!0,error:null});try{const s=await ec.getAccountMappings(r);if(!s.success){t({error:s.error||"Failed to load account mappings",mappings:[],loading:!1});return}t({mappings:s.data||[],loading:!1,error:null})}catch(s){t({error:s instanceof Error?s.message:"An unexpected error occurred",mappings:[],loading:!1})}},createMapping:async(r,s,n,a,i)=>{const{companyId:l,loadMappings:c}=e(),d=V_.validateCreateMapping({myCompanyId:l,counterpartyCompanyId:r,myAccountId:s,linkedAccountId:n,direction:a,createdBy:i});if(d.length>0)return{success:!1,error:d.map(h=>h.message).join(", ")};t({isCreating:!0});try{const u=await ec.createAccountMapping(l,r,s,n,a,i);return u.success&&await c(),u}catch(u){return{success:!1,error:u instanceof Error?u.message:"Failed to create mapping"}}finally{t({isCreating:!1})}},deleteMapping:async r=>{const{loadMappings:s}=e(),n=V_.validateDeleteMapping(r);if(n)return{success:!1,error:n.message};t({isDeleting:!0});try{const a=await ec.deleteAccountMapping(r);return a.success&&await s(),a}catch(a){return{success:!1,error:a instanceof Error?a.message:"Failed to delete mapping"}}finally{t({isDeleting:!1})}},getCompanyAccounts:async r=>{try{return await ec.getCompanyAccounts(r)}catch(s){return{success:!1,error:s instanceof Error?s.message:"Failed to fetch company accounts"}}},loadModalData:async r=>{const{companyId:s,getCompanyAccounts:n}=e();if(s)try{const a=await n(s);a.success&&a.data&&t({availableAccounts:a.data});const i=r.filter(l=>l.company_id!==s).map(l=>({company_id:l.company_id,company_name:l.company_name}));t({availableCompanies:i})}catch(a){console.error("Error loading modal data:",a)}},refresh:async()=>{const{loadMappings:r}=e();await r()},reset:()=>t({companyId:"",mappings:[],availableAccounts:[],availableCompanies:[],loading:!1,isCreating:!1,isDeleting:!1,error:null,showAddModal:!1,showDeleteConfirm:!1,deletingMappingId:null,deletingMappingInfo:null,showErrorMessage:!1,errorMessageText:""}),openAddModal:()=>t({showAddModal:!0}),closeAddModal:()=>t({showAddModal:!1}),openDeleteConfirm:(r,s,n)=>t({showDeleteConfirm:!0,deletingMappingId:r,deletingMappingInfo:{myAccount:s,linkedAccount:n}}),closeDeleteConfirm:()=>t({showDeleteConfirm:!1,deletingMappingId:null,deletingMappingInfo:null}),showError:r=>t({showErrorMessage:!0,errorMessageText:r}),hideError:()=>t({showErrorMessage:!1,errorMessageText:""})})),kT=t=>{const e=pt(N=>N.mappings),r=pt(N=>N.availableAccounts),s=pt(N=>N.availableCompanies),n=pt(N=>N.loading),a=pt(N=>N.isCreating),i=pt(N=>N.isDeleting),l=pt(N=>N.error),c=pt(N=>N.showErrorMessage),d=pt(N=>N.errorMessageText),u=pt(N=>N.showAddModal),h=pt(N=>N.showDeleteConfirm),f=pt(N=>N.deletingMappingId),p=pt(N=>N.deletingMappingInfo),_=pt(N=>N.setCompanyId),v=pt(N=>N.loadMappings),x=pt(N=>N.createMapping),m=pt(N=>N.deleteMapping),g=pt(N=>N.getCompanyAccounts),y=pt(N=>N.loadModalData),w=pt(N=>N.refresh),b=pt(N=>N.openAddModal),C=pt(N=>N.closeAddModal),j=pt(N=>N.openDeleteConfirm),I=pt(N=>N.closeDeleteConfirm),k=pt(N=>N.showError),E=pt(N=>N.hideError),T=e.filter(N=>!N.isReadOnly),D=e.filter(N=>N.isReadOnly);return S.useEffect(()=>{_(t),v()},[t]),{mappings:e,availableAccounts:r,availableCompanies:s,loading:n,isCreating:a,isDeleting:i,error:l,showErrorMessage:c,errorMessageText:d,showAddModal:u,showDeleteConfirm:h,deletingMappingId:f,deletingMappingInfo:p,outgoingMappings:T,incomingMappings:D,createMapping:x,deleteMapping:m,getCompanyAccounts:g,loadModalData:y,refresh:w,setCompanyId:_,openAddModal:b,closeAddModal:C,openDeleteConfirm:j,closeDeleteConfirm:I,showError:k,hideError:E}},ET="_tossSelectorGroup_ar4qc_7",TT="_fullWidth_ar4qc_14",LT="_inline_ar4qc_19",AT="_tossSelect_ar4qc_7",DT="_tossSelectActive_ar4qc_53",MT="_tossSelectLabel_ar4qc_60",RT="_required_ar4qc_67",PT="_tossSelectContainer_ar4qc_74",OT="_tossSelectError_ar4qc_119",$T="_disabled_ar4qc_123",FT="_tossSelectValue_ar4qc_132",BT="_tossSelectPlaceholder_ar4qc_140",VT="_tossSelectArrow_ar4qc_145",HT="_tossSelectMenu_ar4qc_176",zT="_tossSelectMenuShow_ar4qc_196",qT="_tossSelectSearch_ar4qc_203",UT="_tossSelectSearchInput_ar4qc_209",WT="_tossSelectOptions_ar4qc_226",GT="_tossSelectOption_ar4qc_226",JT="_tossSelectOptionHighlighted_ar4qc_245",KT="_tossSelectOptionSelected_ar4qc_249",YT="_tossSelectOptionDisabled_ar4qc_258",QT="_tossSelectOptionLabel_ar4qc_265",ZT="_tossSelectOptionDescription_ar4qc_269",XT="_tossSelectOptionContent_ar4qc_275",eL="_tossSelectOptionBadge_ar4qc_310",tL="_tossSelectEmpty_ar4qc_334",rL="_tossSelectLoading_ar4qc_342",sL="_tossSelectFooter_ar4qc_354",nL="_tossSelectAction_ar4qc_361",aL="_tossSelectActionIcon_ar4qc_383",oL="_tossSelectActionLabel_ar4qc_390",iL="_tossSelectMessage_ar4qc_396",lL="_tossSelectMessageError_ar4qc_405",cL="_tossSelectMessageInfo_ar4qc_409",We={tossSelectorGroup:ET,fullWidth:TT,inline:LT,tossSelect:AT,tossSelectActive:DT,tossSelectLabel:MT,required:RT,tossSelectContainer:PT,tossSelectError:OT,disabled:$T,tossSelectValue:FT,tossSelectPlaceholder:BT,tossSelectArrow:VT,tossSelectMenu:HT,tossSelectMenuShow:zT,tossSelectSearch:qT,tossSelectSearchInput:UT,tossSelectOptions:WT,tossSelectOption:GT,tossSelectOptionHighlighted:JT,tossSelectOptionSelected:KT,tossSelectOptionDisabled:YT,tossSelectOptionLabel:QT,tossSelectOptionDescription:ZT,tossSelectOptionContent:XT,tossSelectOptionBadge:eL,tossSelectEmpty:tL,tossSelectLoading:rL,tossSelectFooter:sL,tossSelectAction:nL,tossSelectActionIcon:aL,tossSelectActionLabel:oL,tossSelectMessage:iL,tossSelectMessageError:lL,tossSelectMessageInfo:cL},Ze=S.forwardRef(({id:t,name:e,label:r,placeholder:s="Select an option",value:n,options:a,onChange:i,onSelect:l,showAddButton:c=!1,addButtonText:d="Add new",onAddClick:u,disabled:h=!1,error:f=!1,errorMessage:p,helperText:_,required:v=!1,fullWidth:x=!1,loading:m=!1,className:g="",searchable:y=!1,maxHeight:w="320px",showDescriptions:b=!1,emptyMessage:C="No options available",showBadges:j=!1,inline:I=!1,editable:k=!1},E)=>{const[T,D]=S.useState(!1),[N,A]=S.useState(""),[$,z]=S.useState(!1),[H,L]=S.useState(-1),B=S.useRef(null),O=S.useRef(null),M=S.useRef(null),R=S.useRef({}),ie=E||M,Z=y&&N?a.filter(U=>U.label.toLowerCase().includes(N.toLowerCase())||U.description&&U.description.toLowerCase().includes(N.toLowerCase())):a,Ie=a.find(U=>U.value===n),Te=Ie?Ie.label:"";S.useEffect(()=>{const U=ue=>{B.current&&!B.current.contains(ue.target)&&(D(!1),A(""),z(!1),L(-1))};return T&&document.addEventListener("mousedown",U),()=>{document.removeEventListener("mousedown",U)}},[T]),S.useEffect(()=>{T&&y&&O.current&&setTimeout(()=>{var U;(U=O.current)==null||U.focus()},100),T&&L(-1)},[T,y]),S.useEffect(()=>{if(H>=0&&H<Z.length){const U=R.current[H];U&&U.scrollIntoView({block:"nearest",behavior:"smooth"})}},[H,Z.length]);const Ke=()=>{h||D(!T)},ye=U=>{const ue=a.find(ee=>ee.value===U);ue&&!ue.disabled&&(i(U,ue),D(!1),A(""),z(!1),L(-1),l&&l(U,ue))},P=U=>{A(U.target.value),z(!0),T||D(!0)},xe=()=>{!h&&I&&D(!0)},je=U=>{if(U.key==="Enter"&&Z.length>0){U.preventDefault();const ue=H>=0?H:0,ee=Z[ue];ee&&!ee.disabled&&ye(ee.value)}else U.key==="Escape"?(D(!1),A(""),z(!1),L(-1)):U.key==="ArrowDown"?(U.preventDefault(),L(ue=>{const ee=ue+1;return ee>=Z.length?0:ee})):U.key==="ArrowUp"&&(U.preventDefault(),L(ue=>{const ee=ue-1;return ee<0?Z.length-1:ee}))},ne=U=>{U.stopPropagation(),u&&(u(),D(!1))},Ce=[We.tossSelectorGroup,x?We.fullWidth:"",I?We.inline:"",g].filter(Boolean).join(" "),Ue=[We.tossSelect,T?We.tossSelectActive:"",f?We.tossSelectError:"",h?We.disabled:""].filter(Boolean).join(" "),J=[We.tossSelectMenu,T?We.tossSelectMenuShow:""].filter(Boolean).join(" ");return o.jsxs("div",{className:Ce,ref:B,children:[r&&!I&&o.jsx("label",{htmlFor:t,className:`${We.tossSelectLabel} ${v?We.required:""}`,children:r}),o.jsxs("div",{className:We.tossSelectContainer,children:[I?o.jsx("input",{ref:ie,type:"text",id:t,className:Ue,value:$?N:Te,onChange:P,onFocus:xe,onKeyDown:je,placeholder:s,disabled:h||m,"aria-haspopup":"listbox","aria-expanded":T}):o.jsxs("button",{type:"button",id:t,className:Ue,onClick:Ke,disabled:h||m,"aria-haspopup":"listbox","aria-expanded":T,children:[o.jsx("span",{className:`${We.tossSelectValue} ${Te?"":We.tossSelectPlaceholder}`,children:Te||s}),m?o.jsx(Me,{size:"small"}):o.jsx("svg",{className:We.tossSelectArrow,viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M7 10l5 5 5-5z"})})]}),o.jsxs("div",{className:J,style:{maxHeight:w},children:[y&&!I&&o.jsx("div",{className:We.tossSelectSearch,children:o.jsx("input",{ref:O,type:"text",className:We.tossSelectSearchInput,placeholder:"Search...",value:N,onChange:U=>A(U.target.value),onClick:U=>U.stopPropagation(),onKeyDown:U=>{if(U.key==="Enter"&&Z.length>0){U.preventDefault();const ue=H>=0?H:0,ee=Z[ue];ee&&!ee.disabled&&ye(ee.value)}else U.key==="Escape"?(D(!1),A(""),L(-1)):U.key==="ArrowDown"?(U.preventDefault(),L(ue=>{const ee=ue+1;return ee>=Z.length?0:ee})):U.key==="ArrowUp"&&(U.preventDefault(),L(ue=>{const ee=ue-1;return ee<0?Z.length-1:ee}))}})}),o.jsx("div",{className:We.tossSelectOptions,children:m?o.jsx("div",{className:We.tossSelectLoading,children:o.jsx(Me,{size:"medium"})}):Z.length===0?o.jsx("div",{className:We.tossSelectEmpty,children:C}):Z.map((U,ue)=>{const ee=U.value===n,F=ue===H,Y=[We.tossSelectOption,ee?We.tossSelectOptionSelected:"",F?We.tossSelectOptionHighlighted:"",U.disabled?We.tossSelectOptionDisabled:""].filter(Boolean).join(" ");return o.jsxs("div",{ref:le=>R.current[ue]=le,className:Y,onClick:()=>ye(U.value),onMouseEnter:()=>L(ue),role:"option","aria-selected":ee,children:[j&&U.badge&&o.jsx("span",{className:We.tossSelectOptionBadge,style:U.badgeColor?{backgroundColor:U.badgeColor}:void 0,children:U.badge}),o.jsxs("div",{className:We.tossSelectOptionContent,children:[o.jsx("div",{className:We.tossSelectOptionLabel,children:U.label}),b&&U.description&&o.jsx("div",{className:We.tossSelectOptionDescription,style:{backgroundColor:U.descriptionBgColor,color:U.descriptionColor},children:U.description})]})]},U.value)})}),c&&u&&Z.length>0&&o.jsx("div",{className:We.tossSelectFooter,children:o.jsxs("div",{className:We.tossSelectAction,onClick:ne,children:[o.jsx("svg",{className:We.tossSelectActionIcon,viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm5 11h-4v4h-2v-4H7v-2h4V7h2v4h4v2z"})}),o.jsx("span",{className:We.tossSelectActionLabel,children:d})]})})]})]}),f&&p||_?o.jsx("p",{className:`${We.tossSelectMessage} ${f?We.tossSelectMessageError:We.tossSelectMessageInfo}`,children:f&&p?p:_}):null]})});Ze.displayName="TossSelector";const dL="_modalOverlay_9mx2e_5",uL="_modal_9mx2e_5",hL="_modalHeader_9mx2e_33",fL="_closeButton_9mx2e_48",mL="_modalBody_9mx2e_67",pL="_formGroup_9mx2e_73",gL="_formLabel_9mx2e_77",_L="_companyDisplay_9mx2e_85",yL="_modalFooter_9mx2e_96",vL="_cancelButton_9mx2e_103",xL="_saveButton_9mx2e_104",qr={modalOverlay:dL,modal:uL,modalHeader:hL,closeButton:fL,modalBody:mL,formGroup:pL,formLabel:gL,companyDisplay:_L,modalFooter:yL,cancelButton:vL,saveButton:xL},bL=({isOpen:t,onClose:e,onSubmit:r,getCompanyAccounts:s,availableCompanies:n,availableAccounts:a})=>{const{currentCompany:i,currentUser:l}=ht(),[c,d]=S.useState(""),[u,h]=S.useState(""),[f,p]=S.useState(""),[_,v]=S.useState([]),[x,m]=S.useState(!1),[g,y]=S.useState(!1),[w,b]=S.useState(!1),[C,j]=S.useState("");S.useEffect(()=>{t||(d(""),h(""),p(""),v([]),b(!1),j(""))},[t]);const I=L=>{switch(L==null?void 0:L.toLowerCase()){case"payable":return"rgba(239, 68, 68, 0.15)";case"receivable":return"rgba(59, 130, 246, 0.15)";case"contra_asset":return"rgba(107, 114, 128, 0.15)";case"cash":return"rgba(34, 197, 94, 0.15)";case"general":return"rgba(107, 114, 128, 0.15)";case"fixed_asset":return"rgba(168, 85, 247, 0.15)";case"equity":return"rgba(14, 165, 233, 0.15)";default:return"rgba(107, 114, 128, 0.15)"}},k=L=>{switch(L==null?void 0:L.toLowerCase()){case"payable":return"rgb(239, 68, 68)";case"receivable":return"rgb(59, 130, 246)";case"contra_asset":return"rgb(107, 114, 128)";case"cash":return"rgb(34, 197, 94)";case"general":return"rgb(107, 114, 128)";case"fixed_asset":return"rgb(168, 85, 247)";case"equity":return"rgb(14, 165, 233)";default:return"rgb(107, 114, 128)"}},E=L=>L?L.replace(/_/g," ").replace(/\b\w/g,B=>B.toUpperCase()):"General",T=L=>{if(!L)return"??";const B=L.trim().split(" ");return B.length===1?L.substring(0,2).toUpperCase():B.slice(0,2).map(O=>O[0]).join("").toUpperCase()},D=S.useMemo(()=>a.map(L=>({value:L.account_id,label:L.account_name,badge:T(L.account_name),description:L.category_tag&&L.category_tag.toLowerCase()!=="general"?E(L.category_tag):void 0,descriptionBgColor:L.category_tag?I(L.category_tag):void 0,descriptionColor:L.category_tag?k(L.category_tag):void 0})),[a]),N=S.useMemo(()=>n.map(L=>({value:L.company_id,label:L.company_name,badge:T(L.company_name)})),[n]),A=S.useMemo(()=>_.map(L=>({value:L.account_id,label:L.account_name,badge:T(L.account_name),description:L.category_tag&&L.category_tag.toLowerCase()!=="general"?E(L.category_tag):void 0,descriptionBgColor:L.category_tag?I(L.category_tag):void 0,descriptionColor:L.category_tag?k(L.category_tag):void 0})),[_]),$=async L=>{h(L),p(""),m(!0);try{const B=await s(L);B.success&&B.data?v(B.data):v([])}catch(B){console.error("Error loading counter accounts:",B),v([])}finally{m(!1)}},z=async()=>{if(!(!c||!u||!f)){if(!i||!l){j("Missing company or user data"),b(!0);return}y(!0);try{const L=a.find(M=>M.account_id===c),B=(L==null?void 0:L.category_tag)||"both",O=await r(u,c,f,B,l.user_id);O.success?e():(j(O.error||"Failed to create mapping"),b(!0))}catch(L){console.error("Error creating mapping:",L),j("Failed to create mapping"),b(!0)}finally{y(!1)}}},H=c&&u&&f;return t?o.jsx("div",{className:qr.modalOverlay,onClick:e,children:o.jsxs("div",{className:qr.modal,onClick:L=>L.stopPropagation(),children:[o.jsxs("div",{className:qr.modalHeader,children:[o.jsx("h2",{children:"Add Account Mapping"}),o.jsx("button",{onClick:e,className:qr.closeButton,children:o.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"})})})]}),o.jsxs("div",{className:qr.modalBody,children:[o.jsxs("div",{className:qr.formGroup,children:[o.jsx("label",{className:qr.formLabel,children:"My Company"}),o.jsx("div",{className:qr.companyDisplay,children:i==null?void 0:i.company_name})]}),o.jsx("div",{className:qr.formGroup,children:o.jsx(Ze,{label:"My Account",placeholder:"Select Account",value:c,options:D,onChange:L=>d(L),searchable:!0,showBadges:!1,showDescriptions:!0,required:!0,fullWidth:!0})}),o.jsx("div",{className:qr.formGroup,children:o.jsx(Ze,{label:"Company",placeholder:"Select Company",value:u,options:N,onChange:$,searchable:!0,showBadges:!1,required:!0,fullWidth:!0})}),o.jsx("div",{className:qr.formGroup,children:o.jsx(Ze,{label:"Account",placeholder:u?"Select Account":"Select Company First",value:f,options:A,onChange:L=>p(L),searchable:!0,showBadges:!1,showDescriptions:!0,required:!0,fullWidth:!0,disabled:!u||x,loading:x})})]}),o.jsxs("div",{className:qr.modalFooter,children:[o.jsx("button",{onClick:e,className:qr.cancelButton,children:"Cancel"}),o.jsx("button",{onClick:z,className:qr.saveButton,disabled:!H||g,children:g?"Creating...":"Create Mapping"})]}),o.jsx($e,{variant:"error",isOpen:w,onClose:()=>b(!1),message:C,zIndex:10001})]})}):null},wL="_modalOverlay_1g955_7",SL="_modalContainer_1g955_30",jL="_modalHeader_1g955_52",CL="_headerIcon_1g955_62",NL="_headerContent_1g955_73",IL="_modalTitle_1g955_77",kL="_modalBody_1g955_86",EL="_warningSection_1g955_91",TL="_warningIcon_1g955_103",LL="_warningContent_1g955_109",AL="_warningText_1g955_113",DL="_contentSection_1g955_122",ML="_modalFooter_1g955_129",RL="_cancelButton_1g955_139",PL="_confirmButton_1g955_162",OL="_confirmButtonPrimary_1g955_184",$L="_confirmButtonError_1g955_196",FL="_confirmButtonSuccess_1g955_208",BL="_confirmButtonWarning_1g955_220",Ut={modalOverlay:wL,modalContainer:SL,modalHeader:jL,headerIcon:CL,headerContent:NL,modalTitle:IL,modalBody:kL,warningSection:EL,warningIcon:TL,warningContent:LL,warningText:AL,contentSection:DL,modalFooter:ML,cancelButton:RL,confirmButton:PL,confirmButtonPrimary:OL,confirmButtonError:$L,confirmButtonSuccess:FL,confirmButtonWarning:BL},VL={info:o.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M12,2A7,7 0 0,1 19,9C19,11.38 17.81,13.47 16,14.74V17A1,1 0 0,1 15,18H9A1,1 0 0,1 8,17V14.74C6.19,13.47 5,11.38 5,9A7,7 0 0,1 12,2M9,21V20H15V21A1,1 0 0,1 14,22H10A1,1 0 0,1 9,21M12,4A5,5 0 0,0 7,9C7,11.05 8.23,12.81 10,13.58V16H14V13.58C15.77,12.81 17,11.05 17,9A5,5 0 0,0 12,4Z"})}),warning:o.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M12,2L1,21H23M12,6L19.53,19H4.47M11,10V14H13V10M11,16V18H13V16"})}),error:o.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M12,2L1,21H23M12,6L19.53,19H4.47M11,10V14H13V10M11,16V18H13V16"})}),success:o.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2M12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20A8,8 0 0,0 20,12A8,8 0 0,0 12,4M11,16.5L6.5,12L7.91,10.59L11,13.67L16.59,8.09L18,9.5L11,16.5Z"})})},HL=o.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"white",children:o.jsx("path",{d:"M9,20.42L2.79,14.21L5.62,11.38L9,14.77L18.88,4.88L21.71,7.71L9,20.42Z"})}),zL=o.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"#F59E0B",children:o.jsx("path",{d:"M12,2L1,21H23M12,6L19.53,19H4.47M11,10V14H13V10M11,16V18H13V16"})}),Nm=({isOpen:t,onClose:e,onConfirm:r,variant:s="info",title:n,headerIcon:a,message:i,messageIcon:l,showWarningSection:c,warningSectionBackground:d="#FFF9E6",warningSectionBorder:u="#FFE5B4",children:h,isLoading:f=!1,confirmText:p="OK",cancelText:_="Cancel",confirmButtonVariant:v="error",showConfirmIcon:x=!0,confirmIcon:m,width:g="500px",headerBackground:y,closeOnBackdropClick:w=!1,closeOnEscape:b=!0,zIndex:C=1e3,className:j=""})=>{S.useEffect(()=>{if(!b||!t||f)return;const z=H=>{H.key==="Escape"&&e()};return document.addEventListener("keydown",z),()=>document.removeEventListener("keydown",z)},[t,b,f,e]);const I=S.useCallback(z=>{w&&!f&&z.target===z.currentTarget&&e()},[w,f,e]),k=S.useCallback(async()=>{if(!f)try{const z=r();z&&typeof z=="object"&&"then"in z&&await z}catch(z){console.error("ConfirmModal: Error in onConfirm:",z)}},[f,r]),E=S.useCallback(()=>{f||e()},[f,e]);if(!t)return null;const T=()=>{if(y)return y;switch(s){case"info":return"#4169E1";case"warning":return"#FF9500";case"error":return"#FF5847";case"success":return"#00C896";default:return"#4169E1"}},D=()=>{switch(v){case"primary":return Ut.confirmButtonPrimary;case"error":return Ut.confirmButtonError;case"success":return Ut.confirmButtonSuccess;case"warning":return Ut.confirmButtonWarning;default:return Ut.confirmButtonError}},N=c??(i!==void 0&&i!==""),A=a!==void 0?a:VL[s],$=m!==void 0?m:HL;return o.jsx("div",{className:Ut.modalOverlay,onClick:I,style:{zIndex:C},children:o.jsxs("div",{className:`${Ut.modalContainer} ${j}`,style:{maxWidth:g,zIndex:C+1},children:[o.jsxs("div",{className:Ut.modalHeader,style:{background:T()},children:[A&&o.jsx("div",{className:Ut.headerIcon,children:A}),o.jsx("div",{className:Ut.headerContent,children:o.jsx("h2",{className:Ut.modalTitle,children:n})})]}),o.jsxs("div",{className:Ut.modalBody,children:[N&&o.jsxs("div",{className:Ut.warningSection,style:{background:d,borderColor:u},children:[o.jsx("div",{className:Ut.warningIcon,children:l!==void 0?l:zL}),o.jsx("div",{className:Ut.warningContent,children:o.jsx("div",{className:Ut.warningText,children:i})})]}),h&&o.jsx("div",{className:Ut.contentSection,children:h})]}),o.jsxs("div",{className:Ut.modalFooter,children:[o.jsx("button",{className:Ut.cancelButton,onClick:E,disabled:f,type:"button",children:_}),o.jsx("button",{className:`${Ut.confirmButton} ${D()}`,onClick:k,disabled:f,type:"button",children:f?o.jsx(Me,{size:"small"}):o.jsxs(o.Fragment,{children:[x&&$,p]})})]})]})})},qL="_pageLayout_13qpl_7",UL="_container_13qpl_17",WL="_pageHeader_13qpl_22",GL="_pageTitle_13qpl_31",JL="_pageSubtitle_13qpl_38",KL="_addButton_13qpl_44",YL="_errorState_13qpl_88",QL="_errorMessage_13qpl_93",ZL="_retryButton_13qpl_99",XL="_emptyState_13qpl_116",eA="_emptySection_13qpl_124",tA="_section_13qpl_134",rA="_sectionTitle_13qpl_138",sA="_sectionSubtitle_13qpl_148",nA="_lockBadge_13qpl_154",aA="_cardsGrid_13qpl_167",oA="_card_13qpl_167",iA="_readOnly_13qpl_190",lA="_cardHeader_13qpl_205",cA="_directionBadge_13qpl_217",dA="_readOnlyIndicator_13qpl_232",uA="_deleteButton_13qpl_238",hA="_accountDetails_13qpl_259",fA="_mappingItem_13qpl_266",mA="_accountIcon_13qpl_279",pA="_accountInfo_13qpl_297",gA="_accountName_13qpl_303",_A="_accountCode_13qpl_315",yA="_mappingConnection_13qpl_343",vA="_mappingArrow_13qpl_351",xA="_companyBadge_13qpl_362",he={pageLayout:qL,container:UL,pageHeader:WL,pageTitle:GL,pageSubtitle:JL,addButton:KL,errorState:YL,errorMessage:QL,retryButton:ZL,emptyState:XL,emptySection:eA,section:tA,sectionTitle:rA,sectionSubtitle:sA,lockBadge:nA,cardsGrid:aA,card:oA,readOnly:iA,cardHeader:lA,directionBadge:cA,readOnlyIndicator:dA,deleteButton:uA,accountDetails:hA,mappingItem:fA,accountIcon:mA,accountInfo:pA,accountName:gA,accountCode:_A,mappingConnection:yA,mappingArrow:vA,companyBadge:xA},tc=t=>{if(!t)return"??";const e=t.trim().split(" ");return e.length===1?t.substring(0,2).toUpperCase():e.slice(0,2).map(r=>r[0]).join("").toUpperCase()},bA=()=>{const{currentCompany:t,companies:e}=ht(),{outgoingMappings:r,incomingMappings:s,availableAccounts:n,availableCompanies:a,loading:i,isDeleting:l,error:c,showErrorMessage:d,errorMessageText:u,showAddModal:h,showDeleteConfirm:f,deletingMappingId:p,deletingMappingInfo:_,createMapping:v,deleteMapping:x,getCompanyAccounts:m,loadModalData:g,refresh:y,openAddModal:w,closeAddModal:b,openDeleteConfirm:C,closeDeleteConfirm:j,showError:I,hideError:k}=kT((t==null?void 0:t.company_id)||"");S.useEffect(()=>{h&&t&&g(e)},[h,t==null?void 0:t.company_id]);const E=(N,A,$)=>{C(N,A,$)},T=async()=>{if(!p)return;const N=await x(p);N.success?j():(j(),I(N.error||"Failed to delete mapping"))},D=()=>{j()};return t?i?o.jsxs(o.Fragment,{children:[o.jsx(Se,{activeItem:"setting"}),o.jsx("div",{className:he.container,children:o.jsx(Me,{fullscreen:!0})})]}):c?o.jsxs(o.Fragment,{children:[o.jsx(Se,{activeItem:"setting"}),o.jsx("div",{className:he.container,children:o.jsxs("div",{className:he.errorState,children:[o.jsx("p",{className:he.errorMessage,children:c}),o.jsx("button",{onClick:y,className:he.retryButton,children:"Retry"})]})})]}):o.jsxs(o.Fragment,{children:[o.jsx(Se,{activeItem:"setting"}),o.jsx("div",{className:he.pageLayout,children:o.jsxs("div",{className:he.container,children:[o.jsxs("div",{className:he.pageHeader,children:[o.jsxs("div",{children:[o.jsx("h1",{className:he.pageTitle,children:"Account Mapping"}),o.jsx("p",{className:he.pageSubtitle,children:"Configure chart of accounts"})]}),o.jsxs("button",{onClick:w,className:he.addButton,children:[o.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"})}),"Add Account Mapping"]})]}),o.jsxs("div",{className:he.section,children:[o.jsx("h2",{className:he.sectionTitle,children:"My Company Mappings"}),o.jsx("p",{className:he.sectionSubtitle,children:"Account mappings created by your company"}),r.length===0?o.jsx("div",{className:he.emptySection,children:o.jsx("p",{children:"No account mappings yet"})}):o.jsx("div",{className:he.cardsGrid,children:r.map(N=>o.jsxs("div",{className:he.card,children:[o.jsxs("div",{className:he.cardHeader,children:[o.jsx("span",{className:he.directionBadge,children:N.directionDisplay}),N.isDeletable&&o.jsx("button",{onClick:()=>E(N.mappingId,N.myAccountName,N.linkedAccountName),className:he.deleteButton,title:"Delete",children:o.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"})})})]}),o.jsxs("div",{className:he.accountDetails,children:[o.jsxs("div",{className:he.mappingItem,children:[o.jsx("div",{className:he.accountIcon,children:tc(N.myAccountName)}),o.jsxs("div",{className:he.accountInfo,children:[o.jsx("div",{className:he.accountName,children:N.myAccountName}),o.jsx("div",{className:he.accountCode,children:N.getCategoryDisplay(N.myCategoryTag)})]})]}),o.jsx("div",{className:he.mappingConnection,children:o.jsxs("div",{className:he.mappingArrow,children:[o.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M12 4l-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8z"})}),o.jsx("span",{children:N.linkedCompanyName||"Direct Link"})]})}),o.jsxs("div",{className:he.mappingItem,children:[o.jsx("div",{className:he.accountIcon,children:tc(N.linkedAccountName)}),o.jsxs("div",{className:he.accountInfo,children:[o.jsx("div",{className:he.accountName,children:N.linkedAccountName}),o.jsxs("div",{className:he.accountCode,children:[N.getCategoryDisplay(N.linkedCategoryTag),o.jsx("span",{className:he.companyBadge,children:N.linkedCompanyName})]})]})]})]})]},N.mappingId))})]}),s.length>0&&o.jsxs("div",{className:he.section,children:[o.jsxs("h2",{className:he.sectionTitle,children:["Reverse Mappings",o.jsxs("span",{className:he.lockBadge,children:[o.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M12,17C10.89,17 10,16.1 10,15C10,13.89 10.89,13 12,13A2,2 0 0,1 14,15A2,2 0 0,1 12,17M18,20V10H6V20H18M18,8A2,2 0 0,1 20,10V20A2,2 0 0,1 18,22H6C4.89,22 4,21.1 4,20V10C4,8.89 4.89,8 6,8H7V6A5,5 0 0,1 12,1A5,5 0 0,1 17,6V8H18M12,3A3,3 0 0,0 9,6V8H15V6A3,3 0 0,0 12,3Z"})}),"Read-Only"]})]}),o.jsx("p",{className:he.sectionSubtitle,children:"Mappings created by other companies (cannot be modified)"}),o.jsx("div",{className:he.cardsGrid,children:s.map(N=>o.jsxs("div",{className:`${he.card} ${he.readOnly}`,children:[o.jsxs("div",{className:he.cardHeader,children:[o.jsx("span",{className:he.directionBadge,children:N.directionDisplay}),o.jsx("div",{className:he.readOnlyIndicator,title:`Created by ${N.linkedCompanyName}. Cannot be edited from here.`,children:o.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"var(--toss-gray-400)",children:o.jsx("path",{d:"M12 17c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm6-9h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zM8.9 6c0-1.71 1.39-3.1 3.1-3.1s3.1 1.39 3.1 3.1v2H8.9V6zM18 20H6V10h12v10z"})})})]}),o.jsxs("div",{className:he.accountDetails,children:[o.jsxs("div",{className:he.mappingItem,children:[o.jsx("div",{className:he.accountIcon,children:tc(N.myAccountName)}),o.jsxs("div",{className:he.accountInfo,children:[o.jsx("div",{className:he.accountName,children:N.myAccountName}),o.jsx("div",{className:he.accountCode,children:N.getCategoryDisplay(N.myCategoryTag)})]})]}),o.jsx("div",{className:he.mappingConnection,children:o.jsxs("div",{className:he.mappingArrow,children:[o.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"})}),o.jsx("span",{children:N.linkedCompanyName||"Direct Link"})]})}),o.jsxs("div",{className:he.mappingItem,children:[o.jsx("div",{className:he.accountIcon,children:tc(N.linkedAccountName)}),o.jsxs("div",{className:he.accountInfo,children:[o.jsx("div",{className:he.accountName,children:N.linkedAccountName}),o.jsxs("div",{className:he.accountCode,children:[N.getCategoryDisplay(N.linkedCategoryTag),o.jsx("span",{className:he.companyBadge,children:N.linkedCompanyName})]})]})]})]})]},N.mappingId))})]}),o.jsx(bL,{isOpen:h,onClose:b,onSubmit:v,getCompanyAccounts:m,availableCompanies:a,availableAccounts:n}),o.jsx(Nm,{isOpen:f,onClose:D,onConfirm:T,variant:"error",title:"Delete Account Mapping",message:"Are you sure you want to delete this account mapping?",confirmText:"Delete",cancelText:"Cancel",confirmButtonVariant:"error",isLoading:l,closeOnBackdropClick:!l,closeOnEscape:!l,children:_&&o.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"var(--space-3)",padding:"var(--space-4)",background:"var(--toss-gray-50)",borderRadius:"var(--radius-md)",fontSize:"var(--font-small)"},children:[o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"var(--space-2)"},children:[o.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"var(--text-tertiary)",children:o.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"})}),o.jsxs("span",{children:["Your Account: ",o.jsx("strong",{children:_.myAccount})]})]}),o.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"var(--space-2)"},children:[o.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"var(--text-tertiary)",children:o.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"})}),o.jsxs("span",{children:["Linked Account: ",o.jsx("strong",{children:_.linkedAccount})]})]}),o.jsx("div",{style:{color:"var(--toss-error)",fontSize:"var(--font-small)",marginTop:"var(--space-2)",fontWeight:500},children:"This action cannot be undone."})]})}),o.jsx($e,{variant:"error",isOpen:d,onClose:k,message:u,zIndex:1e4})]})})]}):o.jsxs(o.Fragment,{children:[o.jsx(Se,{activeItem:"setting"}),o.jsx("div",{className:he.container,children:o.jsx("div",{className:he.emptyState,children:o.jsx("p",{children:"Please select a company to view account mappings"})})})]})};class wA{async getBalanceSheet(e,r,s,n){const a=se.getClient(),i={p_company_id:e,p_store_id:r,p_start_date:s,p_end_date:n};console.log("Calling get_balance_sheet RPC with params:",i);const{data:l,error:c}=await a.rpc("get_balance_sheet",i);if(c)throw console.error("Error fetching balance sheet:",c),new Error(c.message);return console.log("Balance sheet data received:",l),l}}class SA{constructor(e,r,s,n,a,i,l,c,d,u,h,f,p,_,v,x){this.totalAssets=e,this.totalLiabilities=r,this.totalEquity=s,this.totalLiabilitiesAndEquity=n,this.totalCurrentAssets=a,this.totalNonCurrentAssets=i,this.totalCurrentLiabilities=l,this.totalNonCurrentLiabilities=c,this.currentAssets=d,this.nonCurrentAssets=u,this.currentLiabilities=h,this.nonCurrentLiabilities=f,this.equity=p,this.comprehensiveIncome=_,this.currencySymbol=v,this.asOfDate=x}get isBalanced(){return Math.abs(this.totalAssets-this.totalLiabilitiesAndEquity)<.01}get balanceDifference(){return this.totalAssets-this.totalLiabilitiesAndEquity}formatCurrency(e){return`${this.currencySymbol}${e.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})}`}calculatePercentage(e,r){return r===0?0:e/r*100}get assetsPercentage(){return"100% of Total"}get currentAssetsPercentage(){return`Current: ${this.calculatePercentage(this.totalCurrentAssets,this.totalAssets).toFixed(1)}%`}get liabilitiesPercentage(){const e=this.totalLiabilities+this.totalEquity;return`${this.calculatePercentage(this.totalLiabilities,e).toFixed(1)}% of Total`}get equityPercentage(){const e=this.totalLiabilities+this.totalEquity;return`${this.calculatePercentage(this.totalEquity,e).toFixed(1)}% of Total`}get formattedDate(){const[e,r,s]=this.asOfDate.split("-").map(Number);return new Date(e,r-1,s).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}}class H_{static mapAccount(e){return{accountId:e.account_id,accountName:e.account_name,balance:e.balance,formattedBalance:e.formatted_balance||e.balance.toLocaleString("en-US")}}static mapSection(e,r,s){return{title:e,total:r,accounts:(s||[]).map(n=>this.mapAccount(n))}}static fromServerResponse(e,r){var h,f;const s=e.data,n=s.totals;console.log(" Model - Mapping server response to entity"),console.log(" Model - Totals:",n),console.log(" Model - Current Assets sample:",(h=s.current_assets)==null?void 0:h[0]);const a=this.mapSection("Current Assets",(n==null?void 0:n.total_current_assets)||0,s.current_assets),i=this.mapSection("Non-Current Assets",(n==null?void 0:n.total_non_current_assets)||0,s.non_current_assets),l=this.mapSection("Current Liabilities",(n==null?void 0:n.total_current_liabilities)||0,s.current_liabilities),c=this.mapSection("Non-Current Liabilities",(n==null?void 0:n.total_non_current_liabilities)||0,s.non_current_liabilities),d=this.mapSection("Equity",(n==null?void 0:n.total_equity)||0,s.equity),u=this.mapSection("Other Comprehensive Income",0,s.comprehensive_income);return new SA((n==null?void 0:n.total_assets)||0,(n==null?void 0:n.total_liabilities)||0,(n==null?void 0:n.total_equity)||0,(n==null?void 0:n.total_liabilities_and_equity)||0,(n==null?void 0:n.total_current_assets)||0,(n==null?void 0:n.total_non_current_assets)||0,(n==null?void 0:n.total_current_liabilities)||0,(n==null?void 0:n.total_non_current_liabilities)||0,a,i,l,c,d,u,((f=e.company_info)==null?void 0:f.currency_symbol)||"",r||new Date().toISOString().split("T")[0])}static isValidResponse(e){return e&&typeof e=="object"&&e.success===!0&&e.data&&typeof e.data=="object"&&e.data.totals&&typeof e.data.totals=="object"}}class jA{constructor(){W(this,"dataSource");this.dataSource=new wA}async getBalanceSheet(e,r,s,n){try{const a=await this.dataSource.getBalanceSheet(e,r,s,n);if(console.log(" Repository - Received response from data source"),!H_.isValidResponse(a))return{success:!1,error:"Invalid balance sheet data structure"};const i=H_.fromServerResponse(a,n);return console.log(" Repository - Successfully mapped to entity"),{success:!0,data:i}}catch(a){return console.error("Repository error fetching balance sheet:",a),{success:!1,error:a instanceof Error?a.message:"Failed to fetch balance sheet"}}}}class cd{static validateCompanyId(e){return!e||e.trim()===""?{field:"companyId",message:"Company ID is required"}:null}static validateStoreId(e){return e==null?null:e.trim()===""?{field:"storeId",message:"Store ID cannot be empty string"}:null}static validateDateFormat(e){if(!e)return null;if(!/^\d{4}-\d{2}-\d{2}$/.test(e))return{field:"date",message:"Date must be in YYYY-MM-DD format"};const s=new Date(e);return isNaN(s.getTime())?{field:"date",message:"Invalid date value"}:null}static validateDateRange(e,r){if(!e||!r)return null;const s=this.validateDateFormat(e);if(s)return{field:"startDate",message:s.message};const n=this.validateDateFormat(r);if(n)return{field:"endDate",message:n.message};const a=new Date(e),i=new Date(r);return a>i?{field:"dateRange",message:"Start date must be before or equal to end date"}:null}static validateDateNotFuture(e){if(!e)return null;const r=new Date(e),s=new Date;return s.setHours(0,0,0,0),r>s?{field:"date",message:"Date cannot be in the future"}:null}static validateFilters(e){const r=[],s=this.validateCompanyId(e.companyId);s&&r.push(s);const n=this.validateStoreId(e.storeId);if(n&&r.push(n),e.startDate){const i=this.validateDateFormat(e.startDate);i&&r.push({field:"startDate",message:i.message})}if(e.endDate){const i=this.validateDateFormat(e.endDate);i&&r.push({field:"endDate",message:i.message})}const a=this.validateDateRange(e.startDate,e.endDate);return a&&r.push(a),r}static validateBalanceEquation(e,r,s=.01){const n=Math.abs(e-r);return n>s?{valid:!1,difference:n,message:`Balance sheet equation not satisfied. Assets (${e})  Liabilities + Equity (${r}). Difference: ${n.toFixed(2)}`}:{valid:!0,difference:n}}static validateTotalConsistency(e,r,s=.01){const n=r.reduce((i,l)=>i+l,0),a=Math.abs(e-n);return a>s?{valid:!1,difference:a,message:`Total (${e}) does not match sum of sections (${n}). Difference: ${a.toFixed(2)}`}:{valid:!0,difference:a}}}const CA=new jA,Du=()=>{const t=new Date,e=new Date(t.getFullYear(),t.getMonth(),1);return re.toDateOnly(e)},Mu=()=>{const t=new Date,e=new Date(t.getFullYear(),t.getMonth()+1,0);return re.toDateOnly(e)},mr=er((t,e)=>({companyId:"",storeId:null,startDate:Du(),endDate:Mu(),balanceSheet:null,loading:!1,error:null,validationErrors:{},setCompanyId:r=>{t({companyId:r})},setStoreId:r=>{t({storeId:r,validationErrors:{}})},setDateRange:(r,s)=>{t({startDate:r,endDate:s,validationErrors:{}})},setStartDate:r=>{t({startDate:r,validationErrors:{}})},setEndDate:r=>{t({endDate:r,validationErrors:{}})},loadBalanceSheet:async(r,s,n)=>{const a=e(),i=r!==void 0?r:a.storeId,l=s!==void 0?s:a.startDate,c=n!==void 0?n:a.endDate,d=cd.validateFilters({companyId:a.companyId,storeId:i,startDate:l,endDate:c});if(d.length>0){console.log(" Validation errors:",d);const u={};return d.forEach(h=>{u[h.field]=h.message}),t({validationErrors:u,error:"Please fix validation errors",balanceSheet:null}),{success:!1,error:"Validation failed"}}t({validationErrors:{},loading:!0,error:null});try{const u=await CA.getBalanceSheet(a.companyId,i,l,c);if(!u.success)return t({error:u.error||"Failed to load balance sheet",balanceSheet:null,loading:!1}),{success:!1,error:u.error};if(u.data){const h=cd.validateBalanceEquation(u.data.totalAssets,u.data.totalLiabilitiesAndEquity);h.valid||console.warn(" Balance equation warning:",h.message)}return t({balanceSheet:u.data||null,loading:!1}),{success:!0}}catch(u){const h=u instanceof Error?u.message:"An unexpected error occurred";return t({error:h,balanceSheet:null,loading:!1}),{success:!1,error:h}}},refresh:async()=>{await e().loadBalanceSheet()},reset:()=>{t({storeId:null,startDate:Du(),endDate:Mu(),balanceSheet:null,loading:!1,error:null,validationErrors:{}})},clearFilters:()=>{t({storeId:null,startDate:Du(),endDate:Mu(),validationErrors:{}})}})),Ix=()=>{const t=mr(m=>m.companyId),e=mr(m=>m.storeId),r=mr(m=>m.startDate),s=mr(m=>m.endDate),n=mr(m=>m.balanceSheet),a=mr(m=>m.loading),i=mr(m=>m.error),l=mr(m=>m.validationErrors),c=mr(m=>m.setCompanyId),d=mr(m=>m.setStoreId),u=mr(m=>m.setDateRange),h=mr(m=>m.setStartDate),f=mr(m=>m.setEndDate),p=mr(m=>m.loadBalanceSheet),_=mr(m=>m.refresh),v=mr(m=>m.reset),x=mr(m=>m.clearFilters);return{companyId:t,storeId:e,startDate:r,endDate:s,balanceSheet:n,loading:a,error:i,validationErrors:l,setCompanyId:c,setStoreId:d,setDateRange:u,setStartDate:h,setEndDate:f,loadBalanceSheet:p,refresh:_,reset:v,clearFilters:x,changeStore:d,changeDateRange:u}},NA="_storeSelector_9mu2c_12",IA="_disabled_9mu2c_18",kA="_control_9mu2c_24",EA="_open_9mu2c_43",TA="_controlIcon_9mu2c_49",LA="_controlLabel_9mu2c_56",AA="_controlArrow_9mu2c_66",DA="_dropdown_9mu2c_79",MA="_active_9mu2c_97",RA="_option_9mu2c_123",PA="_selected_9mu2c_138",OA="_optionIcon_9mu2c_147",$A="_optionText_9mu2c_158",FA="_checkmarkIcon_9mu2c_173",BA="_emptyState_9mu2c_182",Wt={storeSelector:NA,disabled:IA,control:kA,open:EA,controlIcon:TA,controlLabel:LA,controlArrow:AA,dropdown:DA,active:MA,option:RA,selected:PA,optionIcon:OA,optionText:$A,checkmarkIcon:FA,emptyState:BA},ds=({stores:t,selectedStoreId:e,onStoreSelect:r,companyId:s,width:n="280px",maxHeight:a="380px",className:i="",showAllStoresOption:l=!0,allStoresLabel:c="All Stores",disabled:d=!1})=>{const[u,h]=S.useState(!1),f=S.useRef(null);S.useEffect(()=>{const m=g=>{f.current&&!f.current.contains(g.target)&&h(!1)};return u&&document.addEventListener("mousedown",m),()=>{document.removeEventListener("mousedown",m)}},[u]);const p=(m,g)=>{g==null||g.stopPropagation(),r(m),h(!1)},_=()=>{d||h(!u)},v=()=>{if(!e)return c;const m=t.find(g=>g.store_id===e);return(m==null?void 0:m.store_name)||c},x=t&&t.length>0;return o.jsxs("div",{ref:f,className:`${Wt.storeSelector} ${d?Wt.disabled:""} ${i}`,style:{"--store-selector-width":n,"--store-selector-max-height":a},children:[o.jsxs("div",{className:`${Wt.control} ${u?Wt.open:""}`,onClick:_,children:[o.jsx("svg",{className:Wt.controlIcon,fill:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{d:"M10,20V14H14V20H19V12H22L12,3L2,12H5V20H10Z"})}),o.jsx("span",{className:Wt.controlLabel,children:v()}),o.jsx("svg",{className:Wt.controlArrow,fill:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{d:"M7.41,8.58L12,13.17L16.59,8.58L18,10L12,16L6,10L7.41,8.58Z"})})]}),o.jsxs("div",{className:`${Wt.dropdown} ${u?Wt.active:""}`,children:[!x&&o.jsx("div",{className:Wt.emptyState,children:"No stores available"}),x&&o.jsxs(o.Fragment,{children:[l&&o.jsxs("div",{className:`${Wt.option} ${e?"":Wt.selected}`,onClick:m=>p(null,m),children:[o.jsx("svg",{className:Wt.optionIcon,fill:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{d:"M10,20V14H14V20H19V12H22L12,3L2,12H5V20H10Z"})}),o.jsx("span",{className:Wt.optionText,children:c}),!e&&o.jsx("svg",{className:Wt.checkmarkIcon,fill:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{d:"M9,20.42L2.79,14.21L5.62,11.38L9,14.77L18.88,4.88L21.71,7.71L9,20.42Z"})})]}),t.map(m=>{const g=e===m.store_id;return o.jsxs("div",{className:`${Wt.option} ${g?Wt.selected:""}`,onClick:y=>p(m.store_id,y),children:[o.jsx("svg",{className:Wt.optionIcon,fill:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{d:"M10,20V14H14V20H19V12H22L12,3L2,12H5V20H10Z"})}),o.jsx("span",{className:Wt.optionText,children:m.store_name}),g&&o.jsx("svg",{className:Wt.checkmarkIcon,fill:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{d:"M9,20.42L2.79,14.21L5.62,11.38L9,14.77L18.88,4.88L21.71,7.71L9,20.42Z"})})]},m.store_id)})]})]})]})},Ps=()=>{const[t,e]=S.useState({variant:"error",message:"",isOpen:!1}),r=S.useCallback(()=>{e(c=>({...c,isOpen:!1}))},[]),s=S.useCallback((c,d)=>{e({variant:c,...d,isOpen:!0})},[]),n=S.useCallback(c=>{s("error",c)},[s]),a=S.useCallback(c=>{s("warning",c)},[s]),i=S.useCallback(c=>{s("info",c)},[s]),l=S.useCallback(c=>{s("success",c)},[s]);return{messageState:t,closeMessage:r,showError:n,showWarning:a,showInfo:i,showSuccess:l}},VA="_filterContainer_19r4t_3",HA="_filterHeader_19r4t_13",zA="_filterTitle_19r4t_21",qA="_filterContent_19r4t_34",UA="_filterRow_19r4t_38",WA="_filterField_19r4t_46",GA="_filterLabel_19r4t_54",JA="_dateInput_19r4t_62",KA="_filterActions_19r4t_85",Ur={filterContainer:VA,filterHeader:HA,filterTitle:zA,filterContent:qA,filterRow:UA,filterField:WA,filterLabel:GA,dateInput:JA,filterActions:KA},YA=({stores:t=[],companyId:e,onSearch:r,onClear:s})=>{const{messageState:n,closeMessage:a,showWarning:i}=Ps(),{storeId:l,startDate:c,endDate:d,setStoreId:u,setStartDate:h,setEndDate:f}=Ix(),p=()=>{const v=cd.validateDateRange(c,d);if(v){i({title:"Invalid Date Range",message:v.message,confirmText:"OK"});return}if(l){const x=cd.validateStoreId(l);if(x){i({title:"Invalid Store",message:x.message,confirmText:"OK"});return}}r({storeId:l,startDate:c||null,endDate:d||null})},_=()=>{s()};return o.jsxs("div",{className:Ur.filterContainer,children:[o.jsx("div",{className:Ur.filterHeader,children:o.jsxs("div",{className:Ur.filterTitle,children:[o.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"})}),o.jsx("span",{children:"Search Balance Sheet"})]})}),o.jsxs("div",{className:Ur.filterContent,children:[o.jsxs("div",{className:Ur.filterRow,children:[o.jsxs("div",{className:Ur.filterField,children:[o.jsx("label",{className:Ur.filterLabel,children:"STORE"}),o.jsx(ds,{stores:t,selectedStoreId:l,onStoreSelect:u,companyId:e||"",showAllStoresOption:!0,allStoresLabel:"All Stores",width:"100%"})]}),o.jsxs("div",{className:Ur.filterField,children:[o.jsx("label",{className:Ur.filterLabel,children:"FROM DATE"}),o.jsx("input",{type:"date",className:Ur.dateInput,value:c||"",onChange:v=>h(v.target.value)})]}),o.jsxs("div",{className:Ur.filterField,children:[o.jsx("label",{className:Ur.filterLabel,children:"TO DATE"}),o.jsx("input",{type:"date",className:Ur.dateInput,value:d||"",onChange:v=>f(v.target.value)})]})]}),o.jsxs("div",{className:Ur.filterActions,children:[o.jsx(Ne,{onClick:_,variant:"secondary",children:"Clear All"}),o.jsxs(Ne,{onClick:p,variant:"primary",children:[o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("circle",{cx:"11",cy:"11",r:"8"}),o.jsx("path",{d:"m21 21-4.35-4.35"})]}),"Search"]})]})]}),o.jsx($e,{variant:n.variant,title:n.title,message:n.message,isOpen:n.isOpen,onClose:a,confirmText:n.confirmText||"OK"})]})},QA="_pageLayout_1w518_4",ZA="_container_1w518_40",XA="_pageHeader_1w518_47",eD="_pageTitle_1w518_51",tD="_pageSubtitle_1w518_58",rD="_contentCard_1w518_66",sD="_emptyState_1w518_76",nD="_emptyIcon_1w518_85",aD="_emptyTitle_1w518_91",oD="_emptyText_1w518_98",iD="_loadingState_1w518_107",lD="_spinner_1w518_114",cD="_errorContainer_1w518_131",dD="_errorIcon_1w518_141",uD="_errorTitle_1w518_148",hD="_errorMessage_1w518_155",fD="_summaryCards_1w518_164",mD="_summaryCard_1w518_164",pD="_assets_1w518_184",gD="_liabilities_1w518_189",_D="_equity_1w518_194",yD="_summaryCardLabel_1w518_199",vD="_summaryCardValue_1w518_208",xD="_summaryCardPercent_1w518_217",bD="_balanceSheetColumns_1w518_224",wD="_sectionCard_1w518_238",SD="_sectionHeader_1w518_247",jD="_sectionTitle_1w518_256",CD="_sectionTotal_1w518_265",ND="_accountList_1w518_274",ID="_accountItem_1w518_280",kD="_accountName_1w518_293",ED="_accountBalance_1w518_299",ce={pageLayout:QA,container:ZA,pageHeader:XA,pageTitle:eD,pageSubtitle:tD,contentCard:rD,emptyState:sD,emptyIcon:nD,emptyTitle:aD,emptyText:oD,loadingState:iD,spinner:lD,errorContainer:cD,errorIcon:dD,errorTitle:uD,errorMessage:hD,summaryCards:fD,summaryCard:mD,assets:pD,liabilities:gD,equity:_D,summaryCardLabel:yD,summaryCardValue:vD,summaryCardPercent:xD,balanceSheetColumns:bD,sectionCard:wD,sectionHeader:SD,sectionTitle:jD,sectionTotal:CD,accountList:ND,accountItem:ID,accountName:kD,accountBalance:ED},TD=()=>{const{currentCompany:t}=ht(),e=(t==null?void 0:t.company_id)||"",{balanceSheet:r,loading:s,error:n,setCompanyId:a,setDateRange:i,setStoreId:l,loadBalanceSheet:c,clearFilters:d}=Ix();S.useEffect(()=>{e&&a(e)},[e]);const u=p=>{console.log("Searching with filters:",p),l(p.storeId),i(p.startDate,p.endDate),c(p.storeId,p.startDate,p.endDate)},h=()=>{console.log("Filters cleared"),d()},f=p=>!p||p.accounts.length===0?o.jsx("div",{className:ce.emptyState,children:o.jsx("p",{children:"No accounts in this section"})}):o.jsx("div",{className:ce.accountList,children:p.accounts.map(_=>o.jsxs("div",{className:ce.accountItem,children:[o.jsx("span",{className:ce.accountName,children:_.accountName}),o.jsx("span",{className:ce.accountBalance,children:_.formattedBalance})]},_.accountId))});return o.jsxs(o.Fragment,{children:[o.jsx(Se,{activeItem:"finance"}),o.jsx("div",{className:ce.pageLayout,children:o.jsxs("div",{className:ce.container,children:[o.jsxs("div",{className:ce.pageHeader,children:[o.jsx("h1",{className:ce.pageTitle,children:"Balance Sheet"}),o.jsx("p",{className:ce.pageSubtitle,children:"View your company's financial position"})]}),o.jsx(YA,{stores:(t==null?void 0:t.stores)||[],companyId:e,onSearch:u,onClear:h}),o.jsxs("div",{className:ce.contentCard,children:[s&&o.jsx("div",{className:ce.loadingState,children:o.jsx("div",{className:ce.spinner,children:"Loading balance sheet..."})}),n&&!s&&o.jsxs("div",{className:ce.errorContainer,children:[o.jsxs("svg",{className:ce.errorIcon,width:"120",height:"120",viewBox:"0 0 120 120",fill:"none",children:[o.jsx("circle",{cx:"60",cy:"60",r:"50",fill:"#FFEFED"}),o.jsx("circle",{cx:"60",cy:"60",r:"30",fill:"#FF5847"}),o.jsx("path",{d:"M60 45 L60 65",stroke:"white",strokeWidth:"4",strokeLinecap:"round"}),o.jsx("circle",{cx:"60",cy:"73",r:"2.5",fill:"white"}),o.jsx("rect",{x:"40",y:"25",width:"40",height:"50",rx:"4",fill:"white",stroke:"#FF5847",strokeWidth:"2"}),o.jsx("line",{x1:"48",y1:"35",x2:"72",y2:"35",stroke:"#FFE5E5",strokeWidth:"2",strokeLinecap:"round"}),o.jsx("line",{x1:"48",y1:"42",x2:"65",y2:"42",stroke:"#FFE5E5",strokeWidth:"2",strokeLinecap:"round"})]}),o.jsx("h2",{className:ce.errorTitle,children:"Failed to Load Balance Sheet"}),o.jsx("p",{className:ce.errorMessage,children:n}),o.jsx(Ne,{onClick:()=>c(),variant:"primary",children:"Try Again"})]}),!r&&!s&&!n&&o.jsxs("div",{className:ce.emptyState,children:[o.jsxs("svg",{className:ce.emptyIcon,width:"120",height:"120",viewBox:"0 0 120 120",fill:"none",children:[o.jsx("circle",{cx:"60",cy:"60",r:"50",fill:"#F0F6FF"}),o.jsx("rect",{x:"35",y:"40",width:"50",height:"60",rx:"4",fill:"white",stroke:"#0064FF",strokeWidth:"2"}),o.jsx("rect",{x:"40",y:"35",width:"50",height:"60",rx:"4",fill:"white",stroke:"#0064FF",strokeWidth:"2"}),o.jsx("line",{x1:"48",y1:"45",x2:"75",y2:"45",stroke:"#E9ECEF",strokeWidth:"2",strokeLinecap:"round"}),o.jsx("line",{x1:"48",y1:"52",x2:"70",y2:"52",stroke:"#E9ECEF",strokeWidth:"2",strokeLinecap:"round"}),o.jsx("line",{x1:"48",y1:"59",x2:"72",y2:"59",stroke:"#E9ECEF",strokeWidth:"2",strokeLinecap:"round"}),o.jsx("circle",{cx:"60",cy:"75",r:"12",fill:"#0064FF"}),o.jsx("path",{d:"M54 75 L56 77 L62 71",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),o.jsx("h3",{className:ce.emptyTitle,children:"Select Filters to Load Balance Sheet"}),o.jsx("p",{className:ce.emptyText,children:"Choose your filters and click Search to view the balance sheet data."})]}),r&&!s&&!n&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:ce.summaryCards,children:[o.jsxs("div",{className:`${ce.summaryCard} ${ce.assets}`,children:[o.jsx("div",{className:ce.summaryCardLabel,children:"Total Assets"}),o.jsx("div",{className:ce.summaryCardValue,children:r.formatCurrency(r.totalAssets)}),o.jsx("div",{className:ce.summaryCardPercent,children:r.assetsPercentage})]}),o.jsxs("div",{className:`${ce.summaryCard} ${ce.liabilities}`,children:[o.jsx("div",{className:ce.summaryCardLabel,children:"Total Liabilities"}),o.jsx("div",{className:ce.summaryCardValue,children:r.formatCurrency(r.totalLiabilities)}),o.jsx("div",{className:ce.summaryCardPercent,children:r.liabilitiesPercentage})]}),o.jsxs("div",{className:`${ce.summaryCard} ${ce.equity}`,children:[o.jsx("div",{className:ce.summaryCardLabel,children:"Total Equity"}),o.jsx("div",{className:ce.summaryCardValue,children:r.formatCurrency(r.totalEquity)}),o.jsx("div",{className:ce.summaryCardPercent,children:r.equityPercentage})]})]}),o.jsxs("div",{className:ce.balanceSheetColumns,children:[o.jsxs("div",{children:[o.jsxs("div",{className:ce.sectionCard,children:[o.jsxs("div",{className:ce.sectionHeader,children:[o.jsx("h3",{className:ce.sectionTitle,children:r.currentAssets.title}),o.jsx("div",{className:ce.sectionTotal,children:r.formatCurrency(r.currentAssets.total)})]}),f(r.currentAssets)]}),o.jsxs("div",{className:ce.sectionCard,children:[o.jsxs("div",{className:ce.sectionHeader,children:[o.jsx("h3",{className:ce.sectionTitle,children:r.nonCurrentAssets.title}),o.jsx("div",{className:ce.sectionTotal,children:r.formatCurrency(r.nonCurrentAssets.total)})]}),f(r.nonCurrentAssets)]})]}),o.jsxs("div",{children:[o.jsxs("div",{className:ce.sectionCard,children:[o.jsxs("div",{className:ce.sectionHeader,children:[o.jsx("h3",{className:ce.sectionTitle,children:r.currentLiabilities.title}),o.jsx("div",{className:ce.sectionTotal,children:r.formatCurrency(r.currentLiabilities.total)})]}),f(r.currentLiabilities)]}),o.jsxs("div",{className:ce.sectionCard,children:[o.jsxs("div",{className:ce.sectionHeader,children:[o.jsx("h3",{className:ce.sectionTitle,children:r.nonCurrentLiabilities.title}),o.jsx("div",{className:ce.sectionTotal,children:r.formatCurrency(r.nonCurrentLiabilities.total)})]}),f(r.nonCurrentLiabilities)]}),o.jsxs("div",{className:ce.sectionCard,children:[o.jsxs("div",{className:ce.sectionHeader,children:[o.jsx("h3",{className:ce.sectionTitle,children:r.equity.title}),o.jsx("div",{className:ce.sectionTotal,children:r.formatCurrency(r.equity.total)})]}),f(r.equity)]}),r.comprehensiveIncome.accounts.length>0&&o.jsxs("div",{className:ce.sectionCard,children:[o.jsxs("div",{className:ce.sectionHeader,children:[o.jsx("h3",{className:ce.sectionTitle,children:r.comprehensiveIncome.title}),o.jsx("div",{className:ce.sectionTotal,children:r.formatCurrency(r.comprehensiveIncome.total)})]}),f(r.comprehensiveIncome)]})]})]}),!r.isBalanced&&o.jsxs("div",{style:{marginTop:"16px",padding:"12px",background:"#FEE",borderRadius:"8px",color:"#C00"},children:[" Warning: Balance sheet equation not satisfied. Difference:"," ",r.formatCurrency(Math.abs(r.balanceDifference))]})]})]})]})})]})};function rc(t){return t.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:2})}function sc(t){return t==null||t===0?"0 ":t.toLocaleString("vi-VN")+" "}function LD(t){return new Date(t).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}function AD(t){if(!t)return"";switch(t.toLowerCase()){case"fixedasset":return"Fixed Asset";default:return t.charAt(0).toUpperCase()+t.slice(1)}}function DD(t){return{USD:"$",EUR:"",GBP:"",JPY:"",KRW:"",CNY:"",INR:"",AUD:"A$",CAD:"C$",CHF:"Fr",HKD:"HK$",SGD:"S$",SEK:"kr",NOK:"kr",DKK:"kr",NZD:"NZ$",MXN:"Mex$",TRY:"",RUB:"",BRL:"R$",ZAR:"R"}[t]||t+" "}class MD{async getCashLocations(e){const r=se.getClient(),{data:s,error:n}=await r.from("cash_locations").select("cash_location_id, store_id, location_name, location_type").eq("company_id",e).eq("is_deleted",!1);if(n)throw console.error("Error fetching cash locations:",n),new Error(n.message);return s||[]}async getBalanceAndActualAmounts(e,r){const s=se.getClient(),n={p_company_id:e};r&&(n.p_store_id=r);const{data:a,error:i}=await s.rpc("get_cash_balance_amounts",n);if(i)throw console.error("Error fetching balance amounts:",i),new Error(i.message);return a}async createJournalEntry(e){try{const r=se.getClient();if(!r)return{success:!1,error:"Supabase client not available"};const{data:s,error:n}=await r.rpc("insert_journal_with_everything",e);return n?(console.error("RPC Error:",n),{success:!1,error:n.message||"Failed to create journal entry"}):{success:!0,data:s}}catch(r){const s=r instanceof Error?r.message:"Unknown error occurred";return console.error("Error in createJournalEntry:",r),{success:!1,error:s}}}}class Ru{constructor(e,r,s,n,a,i,l,c,d,u,h,f,p){this.cashEndingId=e,this.locationId=r,this.locationName=s,this.storeId=n,this.date=a,this.openingBalance=i,this.totalInflow=l,this.totalOutflow=c,this.expectedBalance=d,this.actualBalance=u,this.difference=h,this.status=f,this.currencySymbol=p}get isBalanced(){return Math.abs(this.difference)<.01}get statusDisplay(){switch(this.status){case"pending":return"Pending";case"completed":return"Completed";case"verified":return"Verified";default:return this.status}}formatCurrency(e){return`${this.currencySymbol}${e.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})}`}get formattedDate(){const[e,r,s]=this.date.split("-").map(Number);return new Date(e,r-1,s).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}}class z_{static fromLocation(e,r,s){const n=(r==null?void 0:r.balance_amount)||0,a=(s==null?void 0:s.actual_amount)||0,i=a-n,l=s?"completed":"pending";return new Ru(e.cash_location_id,e.cash_location_id,e.location_name,e.store_id,re.toDateOnly(new Date),0,n,0,n,a,i,l,"")}static fromRpcResult(e){const r=e.date?re.toDateOnly(re.toLocal(e.date)):re.toDateOnly(new Date);return new Ru(e.cash_ending_id||e.cash_location_id,e.location_id||e.cash_location_id,e.location_name,e.store_id,r,e.opening_balance||0,e.total_inflow||0,e.total_outflow||0,e.expected_balance||0,e.actual_balance||0,e.difference||0,e.status||"pending",e.currency_symbol||"")}static toDto(e){return{cash_ending_id:e.cashEndingId,location_id:e.locationId,location_name:e.locationName,store_id:e.storeId,date:e.date,opening_balance:e.openingBalance,total_inflow:e.totalInflow,total_outflow:e.totalOutflow,expected_balance:e.expectedBalance,actual_balance:e.actualBalance,difference:e.difference,status:e.status,currency_symbol:e.currencySymbol}}static fromLocationList(e,r,s){return e.map(n=>{const a=r.find(l=>l.cash_location_id===n.cash_location_id),i=s.find(l=>l.cash_location_id===n.cash_location_id);return this.fromLocation(n,a,i)})}static parseBalanceActualResponse(e){let r=[],s=[];return e?(e.success&&e.data?(r=e.data.balance||[],s=e.data.actual||[]):(e.balance||e.actual)&&(r=e.balance||[],s=e.actual||[]),{balance:r,actual:s}):{balance:r,actual:s}}static create(e){return new Ru(e.cash_ending_id||"",e.location_id||"",e.location_name||"",e.store_id||null,e.date||re.toDateOnly(new Date),e.opening_balance||0,e.total_inflow||0,e.total_outflow||0,e.expected_balance||0,e.actual_balance||0,e.difference||0,e.status||"pending",e.currency_symbol||"")}}const Ci={CASH:"d4a7a16e-45a1-47fe-992b-ff807c8673f0",SALES_REVENUE:"e45e7d41-7fda-43a1-ac55-9779f3e59697",MAKE_ERROR:"a45fac5d-010c-4b1b-92e9-ddcf8f3222bf",EXCHANGE_RATE_DIFFERENCE:"80b311db-f548-46e3-9854-67c5ff6766e8"};class RD{constructor(){W(this,"dataSource");this.dataSource=new MD}async getCashEndings(e,r){try{const s=await this.dataSource.getCashLocations(e),n=await this.dataSource.getBalanceAndActualAmounts(e,r);console.log("Cash locations:",s),console.log("Balance data:",n);const{balance:a,actual:i}=z_.parseBalanceActualResponse(n);return{success:!0,data:z_.fromLocationList(s,a,i)}}catch(s){return console.error("Repository error fetching cash endings:",s),{success:!1,error:s instanceof Error?s.message:"Failed to fetch cash endings"}}}async createJournalEntry(e){const{companyId:r,userId:s,storeId:n,cashLocationId:a,difference:i,type:l}=e;try{const c=new Date,d=re.toRpcFormat(c),u=l==="error"?`Make Error ${d}`:`Exchange Rate Difference ${d}`,h=Math.abs(i),f=Ci.CASH,p=Ci.MAKE_ERROR,_=Ci.EXCHANGE_RATE_DIFFERENCE,v=l==="error"?p:_,x=[];i>0?(x.push({account_id:f,description:u,debit:h,credit:0,cash:{cash_location_id:a}}),x.push({account_id:v,description:u,debit:0,credit:h})):(x.push({account_id:f,description:u,debit:0,credit:h,cash:{cash_location_id:a}}),x.push({account_id:v,description:u,debit:h,credit:0}));const m={p_base_amount:h,p_company_id:r,p_created_by:s,p_description:u,p_entry_date:d,p_lines:x,p_store_id:n};console.log("Calling insert_journal_with_everything with params:",m);const g=await this.dataSource.createJournalEntry(m);return g.success?(console.log("Journal entry created successfully:",g.data),{success:!0}):{success:!1,error:g.error}}catch(c){const d=c instanceof Error?c.message:"Unknown error occurred";return console.error("Error in createJournalEntry:",c),{success:!1,error:d}}}}class PD{static validateCompanyId(e){return!e||e.trim()===""?{field:"companyId",message:"Company ID is required"}:/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e)?null:{field:"companyId",message:"Company ID must be a valid UUID"}}static validateUserId(e){return!e||e.trim()===""?{field:"userId",message:"User ID is required"}:/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e)?null:{field:"userId",message:"User ID must be a valid UUID"}}static validateCashLocationId(e){return!e||e.trim()===""?{field:"cashLocationId",message:"Cash location ID is required"}:/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e)?null:{field:"cashLocationId",message:"Cash location ID must be a valid UUID"}}static validateDifference(e){return e==null?{field:"difference",message:"Difference amount is required"}:typeof e!="number"||isNaN(e)?{field:"difference",message:"Difference must be a valid number"}:e===0?{field:"difference",message:"Difference cannot be zero"}:null}static validateType(e){return!e||e.trim()===""?{field:"type",message:"Journal entry type is required"}:e!=="error"&&e!=="exchange"?{field:"type",message:'Type must be either "error" or "exchange"'}:null}static validateAccountId(e,r="accountId"){return!e||e.trim()===""?{field:r,message:`${r} is required`}:/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e)?null:{field:r,message:`${r} must be a valid UUID`}}static validateJournalParams(e){const r=[],s=this.validateCompanyId(e.companyId);s&&r.push(s);const n=this.validateUserId(e.userId);n&&r.push(n);const a=this.validateCashLocationId(e.cashLocationId);a&&r.push(a);const i=this.validateDifference(e.difference);i&&r.push(i);const l=this.validateType(e.type);return l&&r.push(l),r}static validateJournalLine(e){const r=[],s=this.validateAccountId(e.account_id,"account_id");return s&&r.push(s),(!e.description||e.description.trim()==="")&&r.push({field:"description",message:"Description is required"}),(typeof e.debit!="number"||isNaN(e.debit)||e.debit<0)&&r.push({field:"debit",message:"Debit must be a non-negative number"}),(typeof e.credit!="number"||isNaN(e.credit)||e.credit<0)&&r.push({field:"credit",message:"Credit must be a non-negative number"}),e.debit>0&&e.credit>0&&r.push({field:"debit_credit",message:"A line cannot have both debit and credit amounts"}),e.debit===0&&e.credit===0&&r.push({field:"debit_credit",message:"Either debit or credit must be greater than zero"}),r}static isBalanced(e){const r=e.reduce((n,a)=>n+a.debit,0),s=e.reduce((n,a)=>n+a.credit,0);return Math.abs(r-s)<.01}}const q_=new RD,nc={isOpen:!1,type:null,locationId:null,locationName:"",storeId:null,difference:0},Rr=er((t,e)=>({cashEndings:[],selectedDate:re.toDateOnly(new Date),companyId:"",storeId:null,isLoading:!1,isCreatingJournal:!1,error:null,journalError:null,modalState:nc,setCashEndings:r=>t({cashEndings:r}),setSelectedDate:r=>t({selectedDate:r}),setCompanyId:r=>t({companyId:r}),setStoreId:r=>t({storeId:r}),setLoading:r=>t({isLoading:r}),setCreatingJournal:r=>t({isCreatingJournal:r}),setError:r=>t({error:r}),setJournalError:r=>t({journalError:r}),clearErrors:()=>t({error:null,journalError:null}),openErrorModal:r=>{t({modalState:{isOpen:!0,type:"error",locationId:r.locationId,locationName:r.locationName,storeId:r.storeId,difference:r.difference}})},openExchangeModal:r=>{t({modalState:{isOpen:!0,type:"exchange",locationId:r.locationId,locationName:r.locationName,storeId:r.storeId,difference:r.difference}})},closeModal:()=>{t({modalState:nc})},resetModal:()=>{t({modalState:nc})},loadCashEndings:async(r,s)=>{t({isLoading:!0,error:null});try{const n=await q_.getCashEndings(r,s);return n.success?(t({cashEndings:n.data||[],companyId:r,storeId:s,error:null,isLoading:!1}),{success:!0}):(t({error:n.error||"Failed to load cash endings",cashEndings:[],isLoading:!1}),{success:!1,error:n.error||"Failed to load cash endings"})}catch(n){const a=n instanceof Error?n.message:"An unexpected error occurred";return t({error:a,cashEndings:[],isLoading:!1}),{success:!1,error:a}}},refresh:async()=>{const r=e();return await r.loadCashEndings(r.companyId,r.storeId)},createJournalEntry:async r=>{t({isCreatingJournal:!0,journalError:null});try{const s=PD.validateJournalParams(r);if(s.length>0){const a=s.map(i=>i.message).join(", ");return t({journalError:a,isCreatingJournal:!1}),{success:!1,error:a}}const n=await q_.createJournalEntry(r);return n.success?(t({isCreatingJournal:!1,journalError:null}),{success:!0}):(t({journalError:n.error||"Failed to create journal entry",isCreatingJournal:!1}),{success:!1,error:n.error||"Failed to create journal entry"})}catch(s){const n=s instanceof Error?s.message:"Unknown error occurred";return console.error("Error in createJournalEntry:",s),t({journalError:n,isCreatingJournal:!1}),{success:!1,error:n}}},reset:()=>{t({cashEndings:[],selectedDate:re.toDateOnly(new Date),companyId:"",storeId:null,isLoading:!1,isCreatingJournal:!1,error:null,journalError:null,modalState:nc})}})),OD=(t,e)=>{const r=Rr(u=>u.cashEndings),s=Rr(u=>u.isLoading),n=Rr(u=>u.error),a=Rr(u=>u.selectedDate),i=Rr(u=>u.setSelectedDate),l=Rr(u=>u.loadCashEndings),c=Rr(u=>u.refresh);S.useEffect(()=>{t&&l(t,e)},[t,e,l]);const d=S.useCallback(u=>{i(u)},[i]);return{cashEndings:r,loading:s,error:n,selectedDate:a,changeDate:d,refresh:c}},$D=()=>{const t=Rr(s=>s.isCreatingJournal),e=Rr(s=>s.journalError);return{createJournalEntry:Rr(s=>s.createJournalEntry),isLoading:t,error:e}},FD=()=>{const t=Rr(a=>a.modalState),e=Rr(a=>a.openErrorModal),r=Rr(a=>a.openExchangeModal),s=Rr(a=>a.closeModal),n=Rr(a=>a.resetModal);return{modalState:t,openErrorModal:e,openExchangeModal:r,closeModal:s,resetModal:n}},BD="_pageLayout_2cv4d_7",VD="_container_2cv4d_39",HD="_header_2cv4d_45",zD="_title_2cv4d_49",qD="_subtitle_2cv4d_56",UD="_cashEndingContainer_2cv4d_64",WD="_comparisonSplit_2cv4d_74",GD="_comparisonHeaders_2cv4d_79",JD="_headerBalance_2cv4d_85",KD="_headerActual_2cv4d_86",YD="_headerIcon_2cv4d_104",QD="_headerContent_2cv4d_109",ZD="_headerTitle_2cv4d_113",XD="_headerSubtitle_2cv4d_120",e3="_comparisonRows_2cv4d_128",t3="_comparisonRow_2cv4d_128",r3="_balanceCard_2cv4d_149",s3="_actualCard_2cv4d_150",n3="_notSet_2cv4d_163",a3="_locationHeader_2cv4d_167",o3="_locationIconWrap_2cv4d_175",i3="_locationDetails_2cv4d_190",l3="_locationName_2cv4d_195",c3="_locationType_2cv4d_206",d3="_notSetLabel_2cv4d_213",u3="_balanceAmount_2cv4d_218",h3="_actualAmountDisplay_2cv4d_229",f3="_pending_2cv4d_240",m3="_emptyState_2cv4d_246",p3="_emptyIcon_2cv4d_253",g3="_emptyTitle_2cv4d_260",_3="_emptyText_2cv4d_267",y3="_errorContainer_2cv4d_274",v3="_errorIcon_2cv4d_284",x3="_errorTitle_2cv4d_291",b3="_errorMessage_2cv4d_298",w3="_differenceSection_2cv4d_306",S3="_differenceHeader_2cv4d_315",j3="_sectionIcon_2cv4d_324",C3="_differenceTitle_2cv4d_328",N3="_differenceSubtitle_2cv4d_335",I3="_differenceItems_2cv4d_342",k3="_differenceItem_2cv4d_342",E3="_differenceLocationName_2cv4d_366",T3="_differenceAmountActions_2cv4d_372",L3="_differenceAmount_2cv4d_372",A3="_differencePositive_2cv4d_388",D3="_differenceNegative_2cv4d_392",M3="_differenceZero_2cv4d_396",R3="_actionButtonsSimple_2cv4d_401",P3="_actionBtnSimple_2cv4d_406",O3="_errorBtnSimple_2cv4d_436",$3="_exchangeBtnSimple_2cv4d_451",X={pageLayout:BD,container:VD,header:HD,title:zD,subtitle:qD,cashEndingContainer:UD,comparisonSplit:WD,comparisonHeaders:GD,headerBalance:JD,headerActual:KD,headerIcon:YD,headerContent:QD,headerTitle:ZD,headerSubtitle:XD,comparisonRows:e3,comparisonRow:t3,balanceCard:r3,actualCard:s3,notSet:n3,locationHeader:a3,locationIconWrap:o3,locationDetails:i3,locationName:l3,locationType:c3,notSetLabel:d3,balanceAmount:u3,actualAmountDisplay:h3,pending:f3,emptyState:m3,emptyIcon:p3,emptyTitle:g3,emptyText:_3,errorContainer:y3,errorIcon:v3,errorTitle:x3,errorMessage:b3,differenceSection:w3,differenceHeader:S3,sectionIcon:j3,differenceTitle:C3,differenceSubtitle:N3,differenceItems:I3,differenceItem:k3,differenceLocationName:E3,differenceAmountActions:T3,differenceAmount:L3,differencePositive:A3,differenceNegative:D3,differenceZero:M3,actionButtonsSimple:R3,actionBtnSimple:P3,errorBtnSimple:O3,exchangeBtnSimple:$3},U_=t=>{switch(t){case"bank":return o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:[o.jsx("path",{d:"M12 4L4 8V9H20V9L12 4Z",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"}),o.jsx("rect",{x:"6",y:"10",width:"2",height:"6",stroke:"currentColor",strokeWidth:"2"}),o.jsx("rect",{x:"11",y:"10",width:"2",height:"6",stroke:"currentColor",strokeWidth:"2"}),o.jsx("rect",{x:"16",y:"10",width:"2",height:"6",stroke:"currentColor",strokeWidth:"2"}),o.jsx("rect",{x:"4",y:"17",width:"16",height:"2",fill:"currentColor"})]});case"vault":return o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:[o.jsx("rect",{x:"5",y:"5",width:"16",height:"16",rx:"2",stroke:"currentColor",strokeWidth:"2.5"}),o.jsx("circle",{cx:"12",cy:"12",r:"3",stroke:"currentColor",strokeWidth:"2"}),o.jsx("circle",{cx:"12",cy:"12",r:"1",fill:"currentColor"})]});case"cash":default:return o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",children:[o.jsx("ellipse",{cx:"12",cy:"8",rx:"6",ry:"2.5",stroke:"currentColor",strokeWidth:"2.5"}),o.jsx("path",{d:"M6 8V12C6 13.1 8.686 14 12 14C15.314 14 18 13.1 18 12V8",stroke:"currentColor",strokeWidth:"2.5"}),o.jsx("path",{d:"M6 12V16C6 17.1 8.686 18 12 18C15.314 18 18 17.1 18 16V12",stroke:"currentColor",strokeWidth:"2.5"})]})}},W_=t=>{switch(t){case"bank":return"#E3F2FD";case"vault":return"#FFF3E0";case"cash":return"#E8F5E9";default:return"#F5F5F5"}},G_=t=>{switch(t){case"bank":return"#1976D2";case"vault":return"#F57C00";case"cash":return"#2E7D32";default:return"#616161"}},F3=()=>{const{currentCompany:t,currentStore:e,setCurrentStore:r,currentUser:s}=ht(),n=(t==null?void 0:t.company_id)||"",a=(e==null?void 0:e.store_id)||null,{cashEndings:i,loading:l,error:c,refresh:d}=OD(n,a),{createJournalEntry:u,isLoading:h,error:f}=$D(),{modalState:p,openErrorModal:_,openExchangeModal:v,closeModal:x}=FD(),{messageState:m,closeMessage:g,showError:y,showSuccess:w}=Ps(),b=I=>{var k;if(!I)r(null);else{const E=(k=t==null?void 0:t.stores)==null?void 0:k.find(T=>T.store_id===I);E&&r(E)}},C=async()=>{if(!p.type||!p.locationId){console.error("Missing modal state data");return}const I=s==null?void 0:s.user_id;if(!n||!I){console.error("Missing company ID or user ID"),y({title:"Session Error",message:"Missing required session data. Please refresh the page."});return}const k=await u({companyId:n,userId:I,storeId:p.storeId,cashLocationId:p.locationId,difference:p.difference,type:p.type});k.success?(x(),w({message:p.type==="error"?"Error entry created successfully":"Exchange rate entry created successfully",autoCloseDuration:3e3}),d()):y({title:"Creation Failed",message:k.error||f||"Failed to create journal entry. Please try again."})};if(!t)return o.jsxs(o.Fragment,{children:[o.jsx(Se,{activeItem:"finance"}),o.jsx("div",{className:X.pageLayout,children:o.jsxs("div",{className:X.container,children:[o.jsxs("div",{className:X.header,children:[o.jsx("h1",{className:X.title,children:"Cash Ending"}),o.jsx("p",{className:X.subtitle,children:"Manage daily cash ending processes and records"})]}),o.jsx(Me,{fullscreen:!0,size:"large"})]})})]});if(l)return o.jsxs(o.Fragment,{children:[o.jsx(Se,{activeItem:"finance"}),o.jsx("div",{className:X.pageLayout,children:o.jsxs("div",{className:X.container,children:[o.jsxs("div",{className:X.header,children:[o.jsx("h1",{className:X.title,children:"Cash Ending"}),o.jsx("p",{className:X.subtitle,children:"Manage daily cash ending processes and records"})]}),o.jsx(Me,{fullscreen:!0,size:"large"})]})})]});if(c)return o.jsxs(o.Fragment,{children:[o.jsx(Se,{activeItem:"finance"}),o.jsx("div",{className:X.pageLayout,children:o.jsxs("div",{className:X.container,children:[o.jsxs("div",{className:X.header,children:[o.jsx("h1",{className:X.title,children:"Cash Ending"}),o.jsx("p",{className:X.subtitle,children:"Manage daily cash ending processes and records"})]}),o.jsxs("div",{className:X.errorContainer,children:[o.jsxs("svg",{className:X.errorIcon,width:"120",height:"120",viewBox:"0 0 120 120",fill:"none",children:[o.jsx("circle",{cx:"60",cy:"60",r:"50",fill:"#FFEFED"}),o.jsx("circle",{cx:"60",cy:"60",r:"30",fill:"#FF5847"}),o.jsx("path",{d:"M60 45 L60 65",stroke:"white",strokeWidth:"4",strokeLinecap:"round"}),o.jsx("circle",{cx:"60",cy:"73",r:"2.5",fill:"white"}),o.jsx("rect",{x:"40",y:"25",width:"40",height:"50",rx:"4",fill:"white",stroke:"#FF5847",strokeWidth:"2"}),o.jsx("line",{x1:"48",y1:"35",x2:"72",y2:"35",stroke:"#FFE5E5",strokeWidth:"2",strokeLinecap:"round"}),o.jsx("line",{x1:"48",y1:"42",x2:"65",y2:"42",stroke:"#FFE5E5",strokeWidth:"2",strokeLinecap:"round"})]}),o.jsx("h2",{className:X.errorTitle,children:"Failed to Load Cash Endings"}),o.jsx("p",{className:X.errorMessage,children:c})]})]})})]});const j=[...i].sort((I,k)=>{const E={cash:1,bank:2,vault:3},T=i.find(z=>z.locationId===I.locationId)||I,D=i.find(z=>z.locationId===k.locationId)||k,N=z=>z.toLowerCase().includes("bank")?"bank":z.toLowerCase().includes("vault")?"vault":"cash",A=E[N(T.locationName)]||999,$=E[N(D.locationName)]||999;return A!==$?A-$:I.locationName.localeCompare(k.locationName)});return o.jsxs(o.Fragment,{children:[o.jsx(Se,{activeItem:"finance"}),o.jsx("div",{className:X.pageLayout,children:o.jsxs("div",{className:X.container,children:[o.jsxs("div",{className:X.header,children:[o.jsx("h1",{className:X.title,children:"Cash Ending"}),o.jsx("p",{className:X.subtitle,children:"Manage daily cash ending processes and records"})]}),o.jsx("div",{style:{marginBottom:"24px"},children:o.jsx(ds,{stores:(t==null?void 0:t.stores)||[],selectedStoreId:a,onStoreSelect:b,companyId:n,width:"280px",showAllStoresOption:!0,allStoresLabel:"All Stores"})}),i.length===0?o.jsxs("div",{className:X.emptyState,children:[o.jsxs("svg",{className:X.emptyIcon,width:"120",height:"120",viewBox:"0 0 120 120",fill:"none",children:[o.jsx("circle",{cx:"60",cy:"60",r:"50",fill:"#F0F6FF"}),o.jsx("ellipse",{cx:"60",cy:"45",rx:"25",ry:"8",fill:"white",stroke:"#0064FF",strokeWidth:"2"}),o.jsx("path",{d:"M35 45 V55 C35 58 45 61 60 61 C75 61 85 58 85 55 V45",fill:"white",stroke:"#0064FF",strokeWidth:"2"}),o.jsx("path",{d:"M35 55 V65 C35 68 45 71 60 71 C75 71 85 68 85 65 V55",fill:"white",stroke:"#0064FF",strokeWidth:"2"}),o.jsx("circle",{cx:"60",cy:"80",r:"12",fill:"#0064FF"}),o.jsx("path",{d:"M58 74 L58 86 M62 74 L62 86 M56 77 L60 77 C61.5 77 63 78 63 80 C63 82 61.5 83 60 83 L56 83 M60 83 L64 83 C65.5 83 67 82 67 80",stroke:"white",strokeWidth:"2",strokeLinecap:"round"})]}),o.jsx("h3",{className:X.emptyTitle,children:"No Cash Endings"}),o.jsx("p",{className:X.emptyText,children:"No cash ending records found for the selected period"})]}):o.jsxs("div",{className:X.cashEndingContainer,children:[o.jsxs("div",{className:X.comparisonSplit,children:[o.jsxs("div",{className:X.comparisonHeaders,children:[o.jsxs("div",{className:X.headerBalance,children:[o.jsxs("svg",{className:X.headerIcon,width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",children:[o.jsx("rect",{x:"3",y:"10",width:"4",height:"11",rx:"1",fill:"currentColor"}),o.jsx("rect",{x:"10",y:"6",width:"4",height:"15",rx:"1",fill:"currentColor"}),o.jsx("rect",{x:"17",y:"13",width:"4",height:"8",rx:"1",fill:"currentColor"})]}),o.jsxs("div",{className:X.headerContent,children:[o.jsx("div",{className:X.headerTitle,children:"Balance"}),o.jsx("div",{className:X.headerSubtitle,children:"Based on Balance Sheet"})]})]}),o.jsxs("div",{className:X.headerActual,children:[o.jsxs("svg",{className:X.headerIcon,width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",children:[o.jsx("path",{d:"M12 2L2 7V11C2 16.5 5.8 21.5 12 23C18.2 21.5 22 16.5 22 11V7L12 2Z",stroke:"currentColor",strokeWidth:"2",fill:"none"}),o.jsx("path",{d:"M9 12L11 14L15 10",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),o.jsxs("div",{className:X.headerContent,children:[o.jsx("div",{className:X.headerTitle,children:"Actual Cash"}),o.jsx("div",{className:X.headerSubtitle,children:"Cash ending input for today"})]})]})]}),o.jsx("div",{className:X.comparisonRows,children:j.map(I=>{const k=I.locationName.toLowerCase().includes("bank")?"bank":I.locationName.toLowerCase().includes("vault")?"vault":"cash",E=I.actualBalance>0||I.status==="completed";return o.jsxs("div",{className:X.comparisonRow,children:[o.jsxs("div",{className:X.balanceCard,children:[o.jsxs("div",{className:X.locationHeader,children:[o.jsx("div",{className:X.locationIconWrap,style:{background:W_(k),color:G_(k)},children:U_(k)}),o.jsxs("div",{className:X.locationDetails,children:[o.jsx("div",{className:X.locationName,children:I.locationName}),o.jsx("div",{className:X.locationType,children:"From Balance Sheet"})]})]}),o.jsx("div",{className:X.balanceAmount,children:sc(I.expectedBalance)})]}),o.jsxs("div",{className:`${X.actualCard} ${E?"":X.notSet}`,children:[o.jsxs("div",{className:X.locationHeader,children:[o.jsx("div",{className:X.locationIconWrap,style:{background:W_(k),color:G_(k)},children:U_(k)}),o.jsxs("div",{className:X.locationDetails,children:[o.jsx("div",{className:X.locationName,children:I.locationName}),o.jsx("div",{className:`${X.locationType} ${E?"":X.notSetLabel}`,children:E?"Not updated today":"NOT SET"})]})]}),o.jsx("div",{className:`${X.actualAmountDisplay} ${E?"":X.pending}`,children:sc(I.actualBalance)})]})]},I.cashEndingId)})})]}),o.jsxs("div",{className:X.differenceSection,children:[o.jsxs("div",{className:X.differenceHeader,children:[o.jsxs("svg",{className:X.sectionIcon,width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",children:[o.jsx("rect",{x:"4",y:"6",width:"7",height:"2",rx:"1",fill:"currentColor"}),o.jsx("rect",{x:"4",y:"11",width:"7",height:"2",rx:"1",fill:"currentColor"}),o.jsx("rect",{x:"4",y:"16",width:"7",height:"2",rx:"1",fill:"currentColor"}),o.jsx("rect",{x:"13",y:"6",width:"7",height:"2",rx:"1",fill:"currentColor"}),o.jsx("rect",{x:"13",y:"11",width:"5",height:"2",rx:"1",fill:"currentColor"}),o.jsx("rect",{x:"13",y:"16",width:"6",height:"2",rx:"1",fill:"currentColor"})]}),o.jsxs("div",{children:[o.jsx("h3",{className:X.differenceTitle,children:"Difference"}),o.jsx("p",{className:X.differenceSubtitle,children:"Difference Between Balance & Actual"})]})]}),o.jsx("div",{className:X.differenceItems,children:j.map(I=>{const k=I.difference,E=k>0?X.differencePositive:k<0?X.differenceNegative:X.differenceZero;return o.jsxs("div",{className:X.differenceItem,children:[o.jsx("div",{className:X.differenceLocationName,children:I.locationName}),o.jsxs("div",{className:X.differenceAmountActions,children:[o.jsxs("div",{className:`${X.differenceAmount} ${E}`,children:[k>0?"+":"",sc(Math.abs(k))]}),o.jsxs("div",{className:X.actionButtonsSimple,children:[o.jsxs("button",{className:`${X.actionBtnSimple} ${X.errorBtnSimple}`,onClick:()=>_(I),disabled:k===0,children:[o.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M13,14H11V10H13M13,18H11V16H13M1,21H23L12,2L1,21Z"})}),"Make Error"]}),o.jsxs("button",{className:`${X.actionBtnSimple} ${X.exchangeBtnSimple}`,onClick:()=>v(I),disabled:k===0,children:[o.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M17.9,17.39C17.64,16.59 16.89,16 16,16H15V13A1,1 0 0,0 14,12H8V10H10A1,1 0 0,0 11,9V7H13A2,2 0 0,0 15,5V4.59C17.93,5.77 20,8.64 20,12C20,14.08 19.2,15.97 17.9,17.39M11,19.93C7.05,19.44 4,16.08 4,12C4,11.38 4.08,10.78 4.21,10.21L9,15V16A2,2 0 0,0 11,18M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z"})}),"Foreign Currency Translation"]})]})]})]},`diff-${I.cashEndingId}`)})})]})]}),o.jsx(Nm,{isOpen:p.isOpen,onClose:x,onConfirm:C,title:p.type==="error"?"Make Error":"Foreign Currency Translation",message:p.type==="error"?"Are you sure you want to record this variance as an error?":"Are you sure you want to record this variance as a foreign exchange gain/loss?",variant:"info",confirmButtonVariant:"primary",isLoading:h,children:o.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[o.jsx("span",{style:{fontWeight:600,color:"#6C757D"},children:"Location:"}),o.jsx("span",{style:{fontWeight:600,color:"#212529"},children:p.locationName})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[o.jsx("span",{style:{fontWeight:600,color:"#6C757D"},children:"Variance:"}),o.jsx("span",{style:{fontFamily:"Pretendard, -apple-system, BlinkMacSystemFont, system-ui, sans-serif",fontWeight:700,color:"#FF5847"},children:sc(Math.abs(p.difference))})]})]})}),o.jsx($e,{variant:m.variant,title:m.title,message:m.message,isOpen:m.isOpen,onClose:g})]})})]})};let B3=class{async getCounterparties(e){const r=se.getClient(),{data:s,error:n}=await r.from("counterparties").select("counterparty_id, company_id, name, type, is_internal, linked_company_id, email, phone, notes, is_deleted, created_at").eq("company_id",e).eq("is_deleted",!1).order("name",{ascending:!0});if(n)throw new Error(n.message);return s||[]}async createCounterparty(e,r,s,n,a,i,l,c){const d=se.getClient(),{data:u,error:h}=await d.from("counterparties").insert({company_id:e,name:r,type:s,is_internal:n,linked_company_id:a,email:i,phone:l,notes:c,is_deleted:!1}).select().single();if(h)throw new Error(h.message);return u}async deleteCounterparty(e,r){const s=se.getClient(),{error:n}=await s.from("counterparties").update({is_deleted:!0}).eq("counterparty_id",e).eq("company_id",r);if(n)throw new Error(n.message);return!0}};class V3{constructor(e,r,s,n,a,i,l,c,d,u,h){this.counterpartyId=e,this.companyId=r,this.name=s,this.type=n,this.isInternal=a,this.linkedCompanyId=i,this.email=l,this.phone=c,this.notes=d,this.isDeleted=u,this.createdAt=h}get initials(){return this.name.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2)}}let J_=class{static fromDatabase(e){return{counterpartyId:e.counterparty_id,companyId:e.company_id,name:e.name,type:e.type,isInternal:e.is_internal,linkedCompanyId:e.linked_company_id,email:e.email,phone:e.phone,notes:e.notes,isDeleted:e.is_deleted,createdAt:re.toLocal(e.created_at)}}static toEntity(e){return new V3(e.counterpartyId,e.companyId,e.name,e.type,e.isInternal,e.linkedCompanyId,e.email,e.phone,e.notes,e.isDeleted,e.createdAt)}static fromDatabaseToEntity(e){const r=this.fromDatabase(e);return this.toEntity(r)}static toDatabase(e){return{counterparty_id:e.counterpartyId,company_id:e.companyId,name:e.name,type:e.type,is_internal:e.isInternal,linked_company_id:e.linkedCompanyId,email:e.email,phone:e.phone,notes:e.notes,is_deleted:e.isDeleted,created_at:re.toUtc(e.createdAt)}}},H3=class{constructor(){W(this,"dataSource",new B3)}async getCounterparties(e){try{return{success:!0,data:(await this.dataSource.getCounterparties(e)).map(n=>J_.fromDatabaseToEntity(n))}}catch(r){return{success:!1,error:r instanceof Error?r.message:"Failed to fetch"}}}async createCounterparty(e,r,s,n,a,i,l,c){try{const d=await this.dataSource.createCounterparty(e,r,s,n,a,i,l,c);return{success:!0,data:J_.fromDatabaseToEntity(d)}}catch(d){return{success:!1,error:d instanceof Error?d.message:"Failed to create"}}}async deleteCounterparty(e,r){try{return await this.dataSource.deleteCounterparty(e,r),{success:!0}}catch(s){return{success:!1,error:s instanceof Error?s.message:"Failed to delete"}}}};class qa{static validateName(e){return!e||!e.trim()?{field:"name",message:"Name is required"}:e.trim().length<2?{field:"name",message:"Name must be at least 2 characters"}:e.length>this.MAX_NAME_LENGTH?{field:"name",message:`Name must be less than ${this.MAX_NAME_LENGTH} characters`}:null}static validateType(e){return!e||!e.trim()?{field:"type",message:"Type is required"}:this.VALID_TYPES.includes(e)?null:{field:"type",message:"Invalid counterparty type"}}static validateEmail(e){return!e||!e.trim()?null:e.length>this.MAX_EMAIL_LENGTH?{field:"email",message:`Email must be less than ${this.MAX_EMAIL_LENGTH} characters`}:/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)?null:{field:"email",message:"Invalid email format"}}static validatePhone(e){return!e||!e.trim()?null:e.length>this.MAX_PHONE_LENGTH?{field:"phone",message:`Phone must be less than ${this.MAX_PHONE_LENGTH} characters`}:/^[\d\s\-()+ ]+$/.test(e)?null:{field:"phone",message:"Invalid phone format"}}static validateNotes(e){return!e||!e.trim()?null:e.length>this.MAX_NOTES_LENGTH?{field:"notes",message:`Notes must be less than ${this.MAX_NOTES_LENGTH} characters`}:null}static validateLinkedCompany(e,r){return e&&!r?{field:"linkedCompanyId",message:"Linked company is required for internal organizations"}:!e&&r?{field:"linkedCompanyId",message:"Linked company should only be set for internal organizations"}:null}static validateCreate(e){const r=[],s=this.validateName(e.name);s&&r.push(s);const n=this.validateType(e.type);n&&r.push(n);const a=this.validateLinkedCompany(e.isInternal,e.linkedCompanyId);a&&r.push(a);const i=this.validateEmail(e.email||null);i&&r.push(i);const l=this.validatePhone(e.phone||null);l&&r.push(l);const c=this.validateNotes(e.notes||null);return c&&r.push(c),r}static isValidCreate(e){return this.validateCreate(e).length===0}}W(qa,"VALID_TYPES",["My Company","Team Member","Suppliers","Employees","Customers","Others"]),W(qa,"MAX_NAME_LENGTH",255),W(qa,"MAX_EMAIL_LENGTH",255),W(qa,"MAX_PHONE_LENGTH",50),W(qa,"MAX_NOTES_LENGTH",1e3);const K_={name:"",isInternal:!1,linkedCompanyId:null,type:"",email:"",phone:"",notes:""},Pu=new H3,Ct=er((t,e)=>({counterparties:[],loading:!1,error:null,showModal:!1,showDeleteModal:!1,deleteId:null,formData:{...K_},get isFormValid(){const{formData:r}=e();return r.name.trim()!==""&&r.type!==""&&(!r.isInternal||r.linkedCompanyId!==null)},setCounterparties:r=>t({counterparties:r}),setLoading:r=>t({loading:r}),setError:r=>t({error:r}),setShowModal:r=>t({showModal:r}),setShowDeleteModal:r=>t({showDeleteModal:r}),setDeleteId:r=>t({deleteId:r}),openCreateModal:()=>{t({showModal:!0})},closeCreateModal:()=>{t({showModal:!1}),e().resetForm()},openDeleteModal:r=>{t({deleteId:r,showDeleteModal:!0})},closeDeleteModal:()=>{t({showDeleteModal:!1,deleteId:null})},setFormData:r=>t(s=>({formData:{...s.formData,...r}})),updateFormField:(r,s)=>t(n=>({formData:{...n.formData,[r]:s}})),resetForm:()=>t({formData:{...K_}}),loadCounterparties:async r=>{if(!r){t({counterparties:[],loading:!1});return}t({loading:!0,error:null});try{const s=await Pu.getCounterparties(r);if(!s.success){t({error:s.error||"Failed to load counterparties",counterparties:[],loading:!1});return}t({counterparties:s.data||[],loading:!1,error:null})}catch(s){t({error:s instanceof Error?s.message:"Error occurred",counterparties:[],loading:!1})}},submitCounterparty:async r=>{const s=e();if(!r)return{success:!1,error:"Company ID required"};const n=qa.validateCreate({name:s.formData.name,type:s.formData.type,isInternal:s.formData.isInternal,linkedCompanyId:s.formData.linkedCompanyId,email:s.formData.email||null,phone:s.formData.phone||null,notes:s.formData.notes||null});if(n.length>0)return{success:!1,error:n[0].message};t({loading:!0,error:null});try{const a=await Pu.createCounterparty(r,s.formData.name.trim(),s.formData.type,s.formData.isInternal,s.formData.linkedCompanyId,s.formData.email||null,s.formData.phone||null,s.formData.notes||null);return a.success?(await e().loadCounterparties(r),e().resetForm(),e().closeCreateModal(),{success:!0}):(t({loading:!1}),{success:!1,error:a.error||"Failed to create"})}catch(a){const i=a instanceof Error?a.message:"Error occurred";return t({loading:!1,error:i}),{success:!1,error:i}}},confirmDelete:async r=>{const s=e();if(!s.deleteId||!r)return{success:!1,error:"Invalid delete request"};t({loading:!0,error:null});try{const n=await Pu.deleteCounterparty(s.deleteId,r);return n.success?(await e().loadCounterparties(r),e().closeDeleteModal(),{success:!0}):(t({loading:!1}),{success:!1,error:n.error||"Failed to delete"})}catch(n){const a=n instanceof Error?n.message:"Error occurred";return t({loading:!1,error:a}),{success:!1,error:a}}}})),kx=()=>{const t=Ct(E=>E.counterparties),e=Ct(E=>E.loading),r=Ct(E=>E.error),s=Ct(E=>E.showModal),n=Ct(E=>E.showDeleteModal),a=Ct(E=>E.deleteId),i=Ct(E=>E.formData),l=Ct(E=>E.isFormValid),c=S.useMemo(()=>t.filter(E=>E.isInternal),[t]),d=S.useMemo(()=>t.filter(E=>!E.isInternal),[t]),u=Ct(E=>E.setCounterparties),h=Ct(E=>E.setLoading),f=Ct(E=>E.setError),p=Ct(E=>E.setShowModal),_=Ct(E=>E.setShowDeleteModal),v=Ct(E=>E.setDeleteId),x=Ct(E=>E.openCreateModal),m=Ct(E=>E.closeCreateModal),g=Ct(E=>E.openDeleteModal),y=Ct(E=>E.closeDeleteModal),w=Ct(E=>E.setFormData),b=Ct(E=>E.updateFormField),C=Ct(E=>E.resetForm),j=Ct(E=>E.loadCounterparties),I=Ct(E=>E.submitCounterparty),k=Ct(E=>E.confirmDelete);return{counterparties:t,loading:e,error:r,showModal:s,showDeleteModal:n,deleteId:a,formData:i,isFormValid:l,internalCounterparties:c,externalCounterparties:d,setCounterparties:u,setLoading:h,setError:f,setShowModal:p,setShowDeleteModal:_,setDeleteId:v,openCreateModal:x,closeCreateModal:m,openDeleteModal:g,closeDeleteModal:y,setFormData:w,updateFormField:b,resetForm:C,loadCounterparties:j,submitCounterparty:I,confirmDelete:k}},z3="_modal_12qpj_2",q3="_modalContent_12qpj_17",U3="_modalHeader_12qpj_28",W3="_modalTitle_12qpj_36",G3="_modalClose_12qpj_43",J3="_modalBody_12qpj_62",K3="_formGroup_12qpj_67",Y3="_formLabel_12qpj_75",Q3="_formInput_12qpj_83",Z3="_formTextarea_12qpj_103",X3="_selectionGroup_12qpj_126",eM="_selectionBox_12qpj_132",tM="_active_12qpj_149",rM="_modalActions_12qpj_156",sM="_btnSecondary_12qpj_163",nM="_btnPrimary_12qpj_164",st={modal:z3,modalContent:q3,modalHeader:U3,modalTitle:W3,modalClose:G3,modalBody:J3,formGroup:K3,formLabel:Y3,formInput:Q3,formTextarea:Z3,selectionGroup:X3,selectionBox:eM,active:tM,modalActions:rM,btnSecondary:sM,btnPrimary:nM},aM=[{value:"My Company",label:"My Company"},{value:"Team Member",label:"Team Member"},{value:"Suppliers",label:"Suppliers"},{value:"Employees",label:"Employees"},{value:"Customers",label:"Customers"},{value:"Others",label:"Others"}],oM=({isOpen:t,onClose:e,onSubmit:r,companyOptions:s})=>{const{formData:n,isFormValid:a,updateFormField:i,setFormData:l}=kx();if(!t)return null;const c=async()=>{await r()};return o.jsx("div",{className:st.modal,onClick:e,children:o.jsxs("div",{className:st.modalContent,onClick:d=>d.stopPropagation(),children:[o.jsxs("div",{className:st.modalHeader,children:[o.jsx("h2",{className:st.modalTitle,children:"Create Counterparty"}),o.jsx("button",{onClick:e,className:st.modalClose,children:o.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"})})})]}),o.jsxs("div",{className:st.modalBody,children:[o.jsxs("div",{className:st.formGroup,children:[o.jsx("label",{className:st.formLabel,children:"Counterparty Name *"}),o.jsx("input",{className:st.formInput,placeholder:"Enter counterparty name",value:n.name,onChange:d=>i("name",d.target.value)})]}),o.jsxs("div",{className:st.formGroup,children:[o.jsx("label",{className:st.formLabel,children:"Organization Type"}),o.jsxs("div",{className:st.selectionGroup,children:[o.jsx("div",{className:`${st.selectionBox} ${n.isInternal?"":st.active}`,onClick:()=>{l({isInternal:!1,linkedCompanyId:null})},children:"External Partner"}),o.jsx("div",{className:`${st.selectionBox} ${n.isInternal?st.active:""}`,onClick:()=>i("isInternal",!0),children:"Internal Organization"})]})]}),n.isInternal&&o.jsx("div",{className:st.formGroup,children:o.jsx(Ze,{label:"Choose Counter Party Company",placeholder:"Select company...",value:n.linkedCompanyId||"",options:s,onChange:d=>i("linkedCompanyId",d),searchable:!0,showBadges:!0,required:!0,fullWidth:!0})}),o.jsx("div",{className:st.formGroup,children:o.jsx(Ze,{label:"Type *",placeholder:"Select type...",value:n.type,options:aM,onChange:d=>i("type",d),searchable:!0,required:!0,fullWidth:!0})}),o.jsxs("div",{className:st.formGroup,children:[o.jsx("label",{className:st.formLabel,children:"Email"}),o.jsx("input",{type:"email",className:st.formInput,placeholder:"example@email.com",value:n.email,onChange:d=>i("email",d.target.value)})]}),o.jsxs("div",{className:st.formGroup,children:[o.jsx("label",{className:st.formLabel,children:"Phone Number"}),o.jsx("input",{type:"tel",className:st.formInput,placeholder:"Enter phone number",value:n.phone,onChange:d=>i("phone",d.target.value)})]}),o.jsxs("div",{className:st.formGroup,children:[o.jsx("label",{className:st.formLabel,children:"Note"}),o.jsx("textarea",{className:st.formTextarea,placeholder:"Add a note...",value:n.notes,onChange:d=>i("notes",d.target.value)})]})]}),o.jsxs("div",{className:st.modalActions,children:[o.jsx("button",{onClick:e,className:st.btnSecondary,children:"Cancel"}),o.jsx("button",{onClick:c,className:st.btnPrimary,disabled:!a,children:"Create Counterparty"})]})]})})},iM="_modal_1xo55_2",lM="_modalContent_1xo55_17",cM="_modalHeader_1xo55_26",dM="_modalTitle_1xo55_31",uM="_confirmIcon_1xo55_39",hM="_confirmMessage_1xo55_48",fM="_confirmText_1xo55_53",mM="_confirmSubtext_1xo55_60",pM="_modalActions_1xo55_67",gM="_btnSecondary_1xo55_74",_M="_btnDanger_1xo55_75",Ss={modal:iM,modalContent:lM,modalHeader:cM,modalTitle:dM,confirmIcon:uM,confirmMessage:hM,confirmText:fM,confirmSubtext:mM,modalActions:pM,btnSecondary:gM,btnDanger:_M},yM=({isOpen:t,onClose:e,onConfirm:r})=>{if(!t)return null;const s=async()=>{await r()};return o.jsx("div",{className:Ss.modal,onClick:e,children:o.jsxs("div",{className:Ss.modalContent,onClick:n=>n.stopPropagation(),children:[o.jsx("div",{className:Ss.modalHeader,children:o.jsx("h2",{className:Ss.modalTitle,children:"Delete Counterparty"})}),o.jsx("div",{className:Ss.confirmIcon,children:o.jsx("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M12,2C17.53,2 22,6.47 22,12C22,17.53 17.53,22 12,22C6.47,22 2,17.53 2,12C2,6.47 6.47,2 12,2M15.59,7L12,10.59L8.41,7L7,8.41L10.59,12L7,15.59L8.41,17L12,13.41L15.59,17L17,15.59L13.41,12L17,8.41L15.59,7Z"})})}),o.jsxs("div",{className:Ss.confirmMessage,children:[o.jsx("p",{className:Ss.confirmText,children:"Are you sure you want to delete this counterparty?"}),o.jsx("p",{className:Ss.confirmSubtext,children:"This action cannot be undone."})]}),o.jsxs("div",{className:Ss.modalActions,children:[o.jsx("button",{onClick:e,className:Ss.btnSecondary,children:"Cancel"}),o.jsx("button",{onClick:s,className:Ss.btnDanger,children:"Delete"})]})]})})},vM="_pageLayout_17oul_7",xM="_container_17oul_39",bM="_header_17oul_46",wM="_title_17oul_55",SM="_subtitle_17oul_62",jM="_addBtn_17oul_69",CM="_section_17oul_95",NM="_internalSection_17oul_104",IM="_sectionHeader_17oul_109",kM="_sectionTitle_17oul_119",EM="_sectionIcon_17oul_134",TM="_sectionCount_17oul_140",LM="_sectionSubtitle_17oul_151",AM="_grid_17oul_159",DM="_card_17oul_166",MM="_internalCard_17oul_180",RM="_cardHeader_17oul_190",PM="_cardInfo_17oul_197",OM="_cardName_17oul_201",$M="_cardMeta_17oul_208",FM="_cardType_17oul_215",BM="_internalBadge_17oul_222",VM="_linkedCompany_17oul_235",HM="_cardActions_17oul_243",zM="_typeBadge_17oul_249",qM="_deleteBtn_17oul_260",UM="_cardDetails_17oul_285",WM="_detailRow_17oul_291",GM="_detailIcon_17oul_300",JM="_empty_17oul_308",KM="_emptyIcon_17oul_317",YM="_emptyTitle_17oul_324",QM="_emptyText_17oul_331",ge={pageLayout:vM,container:xM,header:bM,title:wM,subtitle:SM,addBtn:jM,section:CM,internalSection:NM,sectionHeader:IM,sectionTitle:kM,sectionIcon:EM,sectionCount:TM,sectionSubtitle:LM,grid:AM,card:DM,internalCard:MM,cardHeader:RM,cardInfo:PM,cardName:OM,cardMeta:$M,cardType:FM,internalBadge:BM,linkedCompany:VM,cardActions:HM,typeBadge:zM,deleteBtn:qM,cardDetails:UM,detailRow:WM,detailIcon:GM,empty:JM,emptyIcon:KM,emptyTitle:YM,emptyText:QM},ZM=()=>{const{currentCompany:t,companies:e}=ht(),{loading:r,error:s,showModal:n,showDeleteModal:a,internalCounterparties:i,externalCounterparties:l,loadCounterparties:c,openCreateModal:d,closeCreateModal:u,closeDeleteModal:h,openDeleteModal:f,submitCounterparty:p,confirmDelete:_}=kx(),{messageState:v,closeMessage:x,showError:m,showSuccess:g}=Ps(),y=S.useMemo(()=>(e||[]).map(j=>({value:j.company_id,label:j.company_name,badge:j.company_name.substring(0,2).toUpperCase()})),[e]);S.useEffect(()=>{t!=null&&t.company_id&&c(t.company_id)},[t==null?void 0:t.company_id]),S.useEffect(()=>{s&&m({title:"Failed to Load",message:s})},[s,m]);const w=async()=>{if(!(t!=null&&t.company_id))return;const j=await p(t.company_id);j.success?g({message:"Counterparty created successfully",autoCloseDuration:2e3}):m({title:"Failed to Create",message:j.error||"Unable to create counterparty. Please try again."})},b=async()=>{if(!(t!=null&&t.company_id))return;const j=await _(t.company_id);j.success?g({message:"Counterparty deleted successfully",autoCloseDuration:2e3}):m({title:"Failed to Delete",message:j.error||"Unable to delete counterparty. Please try again."})};if(r&&i.length===0&&l.length===0)return o.jsxs(o.Fragment,{children:[o.jsx(Se,{activeItem:"setting"}),o.jsx("div",{className:ge.pageLayout,children:o.jsx("div",{className:ge.container,children:o.jsx(Me,{size:"large",fullscreen:!0})})})]});if(!t)return o.jsxs(o.Fragment,{children:[o.jsx(Se,{activeItem:"setting"}),o.jsx("div",{className:ge.pageLayout,children:o.jsx("div",{className:ge.container,children:o.jsx("p",{children:"Select company"})})})]});const C=i.length+l.length;return o.jsxs(o.Fragment,{children:[o.jsx(Se,{activeItem:"setting"}),o.jsx("div",{className:ge.pageLayout,children:o.jsxs("div",{className:ge.container,children:[o.jsxs("div",{className:ge.header,children:[o.jsxs("div",{children:[o.jsx("h1",{className:ge.title,children:"Counterparty"}),o.jsx("p",{className:ge.subtitle,children:"Manage business partners and relationships"})]}),o.jsxs("button",{onClick:d,className:ge.addBtn,children:[o.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"})}),"Add Counterparty"]})]}),i.length>0&&o.jsxs("div",{className:`${ge.section} ${ge.internalSection}`,children:[o.jsxs("div",{className:ge.sectionHeader,children:[o.jsxs("div",{className:ge.sectionTitle,children:[o.jsx("svg",{className:ge.sectionIcon,viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M10,20V14H14V20H19V12H22L12,3L2,12H5V20H10Z"})}),o.jsx("h2",{children:"Internal Organizations"}),o.jsx("span",{className:ge.sectionCount,children:i.length})]}),o.jsx("p",{className:ge.sectionSubtitle,children:"Your internal company structures and departments"})]}),o.jsx("div",{className:ge.grid,children:i.map(j=>{const I=j.linkedCompanyId?e==null?void 0:e.find(k=>k.company_id===j.linkedCompanyId):null;return o.jsxs("div",{className:`${ge.card} ${ge.internalCard}`,children:[o.jsxs("div",{className:ge.cardHeader,children:[o.jsxs("div",{className:ge.cardInfo,children:[o.jsx("h3",{className:ge.cardName,children:j.name}),o.jsxs("div",{className:ge.cardMeta,children:[o.jsxs("span",{className:ge.internalBadge,children:[o.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M10,20V14H14V20H19V12H22L12,3L2,12H5V20H10Z"})}),"Internal"]}),I&&o.jsx("span",{className:ge.linkedCompany,children:I.company_name})]})]}),o.jsxs("div",{className:ge.cardActions,children:[o.jsx("span",{className:ge.typeBadge,children:j.type}),o.jsx("button",{onClick:()=>f(j.counterpartyId),className:ge.deleteBtn,children:o.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M9,3V4H4V6H5V19A2,2 0 0,0 7,21H17A2,2 0 0,0 19,19V6H20V4H15V3H9M7,6H17V19H7V6M9,8V17H11V8H9M13,8V17H15V8H13Z"})})})]})]}),(j.email||j.phone)&&o.jsxs("div",{className:ge.cardDetails,children:[j.email&&o.jsxs("div",{className:ge.detailRow,children:[o.jsx("svg",{className:ge.detailIcon,viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M20,8L12,13L4,8V6L12,11L20,6M20,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V6C22,4.89 21.1,4 20,4Z"})}),o.jsx("span",{children:j.email})]}),j.phone&&o.jsxs("div",{className:ge.detailRow,children:[o.jsx("svg",{className:ge.detailIcon,viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M6.62,10.79C8.06,13.62 10.38,15.94 13.21,17.38L15.41,15.18C15.69,14.9 16.08,14.82 16.43,14.93C17.55,15.3 18.75,15.5 20,15.5A1,1 0 0,1 21,16.5V20A1,1 0 0,1 20,21A17,17 0 0,1 3,4A1,1 0 0,1 4,3H7.5A1,1 0 0,1 8.5,4C8.5,5.25 8.7,6.45 9.07,7.57C9.18,7.92 9.1,8.31 8.82,8.59L6.62,10.79Z"})}),o.jsx("span",{children:j.phone})]})]})]},j.counterpartyId)})})]}),l.length>0&&o.jsxs("div",{className:ge.section,children:[o.jsxs("div",{className:ge.sectionHeader,children:[o.jsxs("div",{className:ge.sectionTitle,children:[o.jsx("svg",{className:ge.sectionIcon,viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M12,5.5A3.5,3.5 0 0,1 15.5,9A3.5,3.5 0 0,1 12,12.5A3.5,3.5 0 0,1 8.5,9A3.5,3.5 0 0,1 12,5.5M5,8C5.56,8 6.08,8.15 6.53,8.42C6.38,9.85 6.8,11.27 7.66,12.38C7.16,13.34 6.16,14 5,14A3,3 0 0,1 2,11A3,3 0 0,1 5,8M19,8A3,3 0 0,1 22,11A3,3 0 0,1 19,14C17.84,14 16.84,13.34 16.34,12.38C17.2,11.27 17.62,9.85 17.47,8.42C17.92,8.15 18.44,8 19,8M5.5,18.25C5.5,16.18 8.41,14.5 12,14.5C15.59,14.5 18.5,16.18 18.5,18.25V20H5.5V18.25M0,20V18.5C0,17.11 1.89,15.94 4.45,15.6C3.86,16.28 3.5,17.22 3.5,18.25V20H0M24,20H20.5V18.25C20.5,17.22 20.14,16.28 19.55,15.6C22.11,15.94 24,17.11 24,18.5V20Z"})}),o.jsx("h2",{children:"External Partners"}),o.jsx("span",{className:ge.sectionCount,children:l.length})]}),o.jsx("p",{className:ge.sectionSubtitle,children:"Customers, suppliers, and business partners"})]}),o.jsx("div",{className:ge.grid,children:l.map(j=>o.jsxs("div",{className:ge.card,children:[o.jsxs("div",{className:ge.cardHeader,children:[o.jsxs("div",{className:ge.cardInfo,children:[o.jsx("h3",{className:ge.cardName,children:j.name}),o.jsxs("p",{className:ge.cardType,children:["Type: ",j.type]})]}),o.jsxs("div",{className:ge.cardActions,children:[o.jsx("span",{className:ge.typeBadge,children:j.type}),o.jsx("button",{onClick:()=>f(j.counterpartyId),className:ge.deleteBtn,children:o.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M9,3V4H4V6H5V19A2,2 0 0,0 7,21H17A2,2 0 0,0 19,19V6H20V4H15V3H9M7,6H17V19H7V6M9,8V17H11V8H9M13,8V17H15V8H13Z"})})})]})]}),(j.email||j.phone)&&o.jsxs("div",{className:ge.cardDetails,children:[j.email&&o.jsxs("div",{className:ge.detailRow,children:[o.jsx("svg",{className:ge.detailIcon,viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M20,8L12,13L4,8V6L12,11L20,6M20,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V6C22,4.89 21.1,4 20,4Z"})}),o.jsx("span",{children:j.email})]}),j.phone&&o.jsxs("div",{className:ge.detailRow,children:[o.jsx("svg",{className:ge.detailIcon,viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M6.62,10.79C8.06,13.62 10.38,15.94 13.21,17.38L15.41,15.18C15.69,14.9 16.08,14.82 16.43,14.93C17.55,15.3 18.75,15.5 20,15.5A1,1 0 0,1 21,16.5V20A1,1 0 0,1 20,21A17,17 0 0,1 3,4A1,1 0 0,1 4,3H7.5A1,1 0 0,1 8.5,4C8.5,5.25 8.7,6.45 9.07,7.57C9.18,7.92 9.1,8.31 8.82,8.59L6.62,10.79Z"})}),o.jsx("span",{children:j.phone})]})]})]},j.counterpartyId))})]}),C===0&&o.jsxs("div",{className:ge.empty,children:[o.jsxs("svg",{className:ge.emptyIcon,width:"120",height:"120",viewBox:"0 0 120 120",fill:"none",children:[o.jsx("circle",{cx:"60",cy:"60",r:"50",fill:"#F0F6FF"}),o.jsx("rect",{x:"30",y:"45",width:"60",height:"40",rx:"4",fill:"white",stroke:"#0064FF",strokeWidth:"2"}),o.jsx("rect",{x:"35",y:"40",width:"60",height:"40",rx:"4",fill:"white",stroke:"#0064FF",strokeWidth:"2"}),o.jsx("line",{x1:"43",y1:"48",x2:"58",y2:"48",stroke:"#E9ECEF",strokeWidth:"2",strokeLinecap:"round"}),o.jsx("line",{x1:"43",y1:"54",x2:"75",y2:"54",stroke:"#E9ECEF",strokeWidth:"2",strokeLinecap:"round"}),o.jsx("line",{x1:"43",y1:"60",x2:"70",y2:"60",stroke:"#E9ECEF",strokeWidth:"2",strokeLinecap:"round"}),o.jsx("circle",{cx:"83",cy:"55",r:"8",fill:"#0064FF"}),o.jsx("circle",{cx:"83",cy:"53",r:"3",fill:"white"}),o.jsx("path",{d:"M78 59 Q78 56 83 56 Q88 56 88 59",stroke:"white",strokeWidth:"1.5",fill:"none",strokeLinecap:"round"}),o.jsx("circle",{cx:"60",cy:"85",r:"15",fill:"#0064FF"}),o.jsx("line",{x1:"60",y1:"77",x2:"60",y2:"93",stroke:"white",strokeWidth:"3",strokeLinecap:"round"}),o.jsx("line",{x1:"52",y1:"85",x2:"68",y2:"85",stroke:"white",strokeWidth:"3",strokeLinecap:"round"})]}),o.jsx("h2",{className:ge.emptyTitle,children:"No Counterparties Found"}),o.jsx("p",{className:ge.emptyText,children:"Start by adding your first counterparty to manage business relationships."}),o.jsxs("button",{onClick:d,className:ge.addBtn,children:[o.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"})}),"Add Your First Counterparty"]})]}),o.jsx(oM,{isOpen:n,onClose:u,onSubmit:w,companyOptions:y}),o.jsx(yM,{isOpen:a,onClose:h,onConfirm:b}),o.jsx($e,{isOpen:v.isOpen,variant:v.variant,title:v.title,message:v.message,onClose:x,autoCloseDuration:v.autoCloseDuration,closeOnBackdropClick:v.closeOnBackdropClick})]})})]})};class XM{constructor(e,r,s,n,a,i,l){this.currencyId=e,this.companyId=r,this.code=s,this.symbol=n,this.name=a,this.isDefault=i,this.exchangeRate=l}get displayName(){return`${this.code} (${this.symbol}) - ${this.name}`}}class Ex{static fromDatabase(e){return{currencyId:e.currency_id,companyId:e.company_id,code:e.code||e.currency_code,symbol:e.symbol||"",name:e.name||e.currency_name||"",isDefault:e.is_default||!1,exchangeRate:e.exchange_rate||1}}static toEntity(e){return new XM(e.currencyId,e.companyId,e.code,e.symbol,e.name,e.isDefault,e.exchangeRate)}static fromDatabaseToEntity(e){const r=this.fromDatabase(e);return this.toEntity(r)}static toDatabase(e){return{currency_id:e.currencyId,company_id:e.companyId,code:e.code,symbol:e.symbol,name:e.name,is_default:e.isDefault,exchange_rate:e.exchangeRate}}}class e6{static fromDatabase(e){return{currencyId:e.currency_id,code:e.currency_code||e.code,symbol:e.symbol||"",name:e.currency_name||e.name||""}}static toDatabase(e){return{currency_id:e.currencyId,currency_code:e.code,symbol:e.symbol,currency_name:e.name}}}class t6{async getCurrencies(e){const r=se.getClient(),{data:s,error:n}=await r.from("companies").select("base_currency_id").eq("company_id",e).single();if(n)throw new Error(n.message);const a=(s==null?void 0:s.base_currency_id)||null,{data:i,error:l}=await r.from("company_currency").select("*").eq("company_id",e).eq("is_deleted",!1).order("created_at",{ascending:!0});if(l)throw new Error(l.message);if(!i||i.length===0)return[];const c=[...new Set(i.map(f=>f.currency_id))],{data:d,error:u}=await r.from("currency_types").select("*").in("currency_id",c);if(u)throw new Error(u.message);const h=new Map;for(const f of c){const{data:p,error:_}=await r.from("book_exchange_rates").select("rate").eq("company_id",e).eq("from_currency_id",f).order("rate_date",{ascending:!1}).limit(1).maybeSingle();!_&&p&&h.set(f,p.rate)}return(d||[]).map(f=>{const p={currency_id:f.currency_id,company_id:e,code:f.currency_code,symbol:f.symbol||"",name:f.currency_name||"",is_default:f.currency_id===a,exchange_rate:h.get(f.currency_id)||1};return Ex.fromDatabase(p)})}async setDefaultCurrency(e,r){const s=se.getClient(),{error:n}=await s.from("companies").update({base_currency_id:e}).eq("company_id",r);if(n)throw new Error(n.message)}async updateExchangeRate(e,r,s,n){const a=se.getClient(),{data:i,error:l}=await a.from("companies").select("base_currency_id").eq("company_id",r).single();if(l)throw new Error(l.message);const c=i==null?void 0:i.base_currency_id;if(!c)throw new Error("Base currency not found for the company");const d=re.toDateOnly(new Date),{data:u,error:h}=await a.from("book_exchange_rates").select("*").eq("company_id",r).eq("from_currency_id",e);if(h&&h.code!=="PGRST116"&&console.error("Error checking existing rates:",h),u&&u.length>0){const{error:f}=await a.from("book_exchange_rates").update({rate:s,rate_date:d,updated_at:re.nowUtc()}).eq("company_id",r).eq("from_currency_id",e);if(f)throw new Error(f.message)}else{const{error:f}=await a.from("book_exchange_rates").insert({company_id:r,from_currency_id:e,to_currency_id:c,rate:s,rate_date:d,created_by:n});if(f)throw new Error(f.message)}}async getAllCurrencyTypes(){const e=se.getClient(),{data:r,error:s}=await e.from("currency_types").select("*").order("currency_code",{ascending:!0});if(s)throw new Error(s.message);return(r||[]).map(n=>e6.fromDatabase(n))}async addCurrency(e,r,s,n){const a=se.getClient(),{data:i,error:l}=await a.from("companies").select("base_currency_id").eq("company_id",r).single();if(l)throw new Error(l.message);const c=i==null?void 0:i.base_currency_id,d=re.toDateOnly(new Date),{error:u}=await a.from("company_currency").insert({company_id:r,currency_id:e,is_deleted:!1}).select();if(u)throw new Error(u.message);if(c){const{error:h}=await a.from("book_exchange_rates").insert({company_id:r,from_currency_id:e,to_currency_id:c,rate:s,rate_date:d,created_by:n})}}async removeCurrency(e,r){const s=se.getClient(),{error:n}=await s.from("company_currency").update({is_deleted:!0,updated_at:re.nowUtc()}).eq("company_id",r).eq("currency_id",e);if(n)throw new Error(n.message)}}class r6{constructor(){W(this,"dataSource",new t6)}async getCurrencies(e){try{return{success:!0,data:(await this.dataSource.getCurrencies(e)).map(n=>Ex.toEntity(n))}}catch(r){return{success:!1,error:r instanceof Error?r.message:"Failed"}}}async getAllCurrencyTypes(){try{return{success:!0,data:await this.dataSource.getAllCurrencyTypes()}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Failed"}}}async setDefaultCurrency(e,r){try{return await this.dataSource.setDefaultCurrency(e,r),{success:!0}}catch(s){return{success:!1,error:s instanceof Error?s.message:"Failed"}}}async updateExchangeRate(e,r,s,n){try{return await this.dataSource.updateExchangeRate(e,r,s,n),{success:!0}}catch(a){return{success:!1,error:a instanceof Error?a.message:"Failed"}}}async addCurrency(e,r,s,n){try{return await this.dataSource.addCurrency(e,r,s,n),{success:!0}}catch(a){return{success:!1,error:a instanceof Error?a.message:"Failed"}}}async removeCurrency(e,r){try{return await this.dataSource.removeCurrency(e,r),{success:!0}}catch(s){return{success:!1,error:s instanceof Error?s.message:"Failed"}}}}class el{static validateExchangeRate(e){const r=typeof e=="string"?parseFloat(e):e;return isNaN(r)?{isValid:!1,error:"Please enter a valid exchange rate"}:r<=0?{isValid:!1,error:"Exchange rate must be greater than 0"}:r<1e-4||r>1e6?{isValid:!1,error:"Exchange rate must be between 0.0001 and 1,000,000"}:{isValid:!0}}static validateCurrencyId(e){return!e||e.trim()===""?{isValid:!1,error:"Please select a currency"}:{isValid:!0}}static validateAddCurrency(e,r){const s=el.validateCurrencyId(e);return s.isValid?el.validateExchangeRate(r):s}}const Ba=new r6,Tt=er((t,e)=>({currencies:[],loading:!1,error:null,companyId:"",userId:"",editingCurrency:null,showAddModal:!1,currencyToRemove:null,isRemoving:!1,notification:null,setContext:(r,s)=>{t({companyId:r,userId:s})},setCurrencies:r=>t({currencies:r}),setLoading:r=>t({loading:r}),setError:r=>t({error:r}),setEditingCurrency:r=>t({editingCurrency:r}),setShowAddModal:r=>t({showAddModal:r}),setCurrencyToRemove:r=>t({currencyToRemove:r}),setNotification:r=>t({notification:r}),clearNotification:()=>t({notification:null}),loadCurrencies:async()=>{const{companyId:r}=e();if(!r){t({error:"No company selected"});return}t({loading:!0,error:null});try{const s=await Ba.getCurrencies(r);s.success?t({currencies:s.data||[],loading:!1,error:null}):t({loading:!1,error:s.error||"Failed to load currencies"})}catch(s){t({loading:!1,error:s instanceof Error?s.message:"Unknown error"})}},getAllCurrencyTypes:async()=>{try{const r=await Ba.getAllCurrencyTypes();return r.success?r.data||[]:[]}catch(r){return console.error("Failed to get currency types:",r),[]}},updateExchangeRate:async(r,s)=>{const{companyId:n,userId:a}=e();if(!n)return{success:!1,error:"No company selected"};if(!a)return{success:!1,error:"No user ID"};const i=el.validateExchangeRate(s);if(!i.isValid)return{success:!1,error:i.error};try{const l=typeof s=="string"?parseFloat(s):s,c=await Ba.updateExchangeRate(r,n,l,a);return c.success?(await e().loadCurrencies(),t({notification:{variant:"success",message:"Exchange rate updated successfully!"},editingCurrency:null}),setTimeout(()=>{e().clearNotification()},2e3),{success:!0}):c}catch(l){return{success:!1,error:l instanceof Error?l.message:"Failed to update exchange rate"}}},addCurrency:async(r,s)=>{const{companyId:n,userId:a}=e();if(!n)return{success:!1,error:"No company selected"};if(!a)return{success:!1,error:"No user ID"};const i=el.validateAddCurrency(r,s);if(!i.isValid)return{success:!1,error:i.error};try{const l=typeof s=="string"?parseFloat(s):s,c=await Ba.addCurrency(r,n,l,a);if(c.success){await e().loadCurrencies();const u=(await e().getAllCurrencyTypes()).find(h=>h.currencyId===r);return t({notification:{variant:"success",message:`${(u==null?void 0:u.code)||"Currency"} added successfully!`},showAddModal:!1}),setTimeout(()=>{e().clearNotification()},2e3),{success:!0}}return c}catch(l){return{success:!1,error:l instanceof Error?l.message:"Failed to add currency"}}},removeCurrency:async r=>{const{companyId:s}=e();if(!s)return{success:!1,error:"No company selected"};t({isRemoving:!0});try{const n=await Ba.removeCurrency(r,s);if(n.success){await e().loadCurrencies();const a=e().currencyToRemove;return t({notification:{variant:"success",message:`${(a==null?void 0:a.code)||"Currency"} removed successfully!`},currencyToRemove:null,isRemoving:!1}),setTimeout(()=>{e().clearNotification()},2e3),{success:!0}}return t({isRemoving:!1}),n}catch(n){const a=n instanceof Error?n.message:"Failed to remove currency";return t({isRemoving:!1}),{success:!1,error:a}}},setDefaultCurrency:async r=>{const{companyId:s}=e();if(!s)return{success:!1,error:"No company selected"};try{const n=await Ba.setDefaultCurrency(r,s);return n.success?(await e().loadCurrencies(),t({notification:{variant:"success",message:"Default currency updated successfully!"}}),setTimeout(()=>{e().clearNotification()},2e3),{success:!0}):n}catch(n){return{success:!1,error:n instanceof Error?n.message:"Failed to set default currency"}}},handleEditCurrency:r=>{t({editingCurrency:r})},handleRemoveCurrency:r=>{if(r.isDefault){t({notification:{variant:"error",message:"Cannot remove the base currency. Please change the base currency in company settings first."}}),setTimeout(()=>{e().clearNotification()},3e3);return}t({currencyToRemove:r})},confirmRemoveCurrency:async()=>{const{currencyToRemove:r}=e();if(!r)return;const s=await e().removeCurrency(r.currencyId);s.success||(t({notification:{variant:"error",message:s.error||"Failed to remove currency"},isRemoving:!1}),setTimeout(()=>{e().clearNotification()},3e3))},reset:()=>{t({currencies:[],loading:!1,error:null,companyId:"",userId:"",editingCurrency:null,showAddModal:!1,currencyToRemove:null,isRemoving:!1,notification:null})}})),s6=(t,e)=>{const r=Tt(k=>k.currencies),s=Tt(k=>k.loading),n=Tt(k=>k.error),a=Tt(k=>k.editingCurrency),i=Tt(k=>k.showAddModal),l=Tt(k=>k.currencyToRemove),c=Tt(k=>k.isRemoving),d=Tt(k=>k.notification),u=Tt(k=>k.setContext),h=Tt(k=>k.setEditingCurrency),f=Tt(k=>k.setShowAddModal),p=Tt(k=>k.setCurrencyToRemove),_=Tt(k=>k.setNotification),v=Tt(k=>k.clearNotification),x=Tt(k=>k.loadCurrencies),m=Tt(k=>k.getAllCurrencyTypes),g=Tt(k=>k.updateExchangeRate),y=Tt(k=>k.addCurrency),w=Tt(k=>k.removeCurrency),b=Tt(k=>k.setDefaultCurrency),C=Tt(k=>k.handleEditCurrency),j=Tt(k=>k.handleRemoveCurrency),I=Tt(k=>k.confirmRemoveCurrency);return S.useEffect(()=>{t&&e&&(u(t,e),x())},[t,e,u,x]),{currencies:r,loading:s,error:n,editingCurrency:a,showAddModal:i,currencyToRemove:l,isRemoving:c,notification:d,setEditingCurrency:h,setShowAddModal:f,setCurrencyToRemove:p,setNotification:_,clearNotification:v,loadCurrencies:x,getAllCurrencyTypes:m,updateExchangeRate:g,addCurrency:y,removeCurrency:w,setDefaultCurrency:b,handleEditCurrency:C,handleRemoveCurrency:j,confirmRemoveCurrency:I}},n6="_modalOverlay_pfp42_2",a6="_show_pfp42_17",o6="_modalContent_pfp42_23",i6="_modalHeader_pfp42_40",l6="_modalTitle_pfp42_48",c6="_modalCloseBtn_pfp42_55",d6="_modalBody_pfp42_74",u6="_modalInfoGroup_pfp42_79",h6="_modalInfoItem_pfp42_89",f6="_modalInfoLabel_pfp42_95",m6="_modalInfoValue_pfp42_103",p6="_modalFormGroup_pfp42_110",g6="_modalLabel_pfp42_116",_6="_modalInput_pfp42_124",y6="_exchangeRateInfo_pfp42_140",v6="_liveRateDisplay_pfp42_147",x6="_rateError_pfp42_157",b6="_liveRateText_pfp42_161",w6="_rateValue_pfp42_169",S6="_baseCurrency_pfp42_175",j6="_useLiveRateBtn_pfp42_179",C6="_modalFooter_pfp42_198",nt={modalOverlay:n6,show:a6,modalContent:o6,modalHeader:i6,modalTitle:l6,modalCloseBtn:c6,modalBody:d6,modalInfoGroup:u6,modalInfoItem:h6,modalInfoLabel:f6,modalInfoValue:m6,modalFormGroup:p6,modalLabel:g6,modalInput:_6,exchangeRateInfo:y6,liveRateDisplay:v6,rateError:x6,liveRateText:b6,rateValue:w6,baseCurrency:S6,useLiveRateBtn:j6,modalFooter:C6},N6=({currency:t,baseCurrencyCode:e,onClose:r,onSave:s})=>{const[n,a]=S.useState("1.0000"),[i,l]=S.useState(null),[c,d]=S.useState(!1),[u,h]=S.useState(null),[f,p]=S.useState(!1),[_,v]=S.useState(null);S.useEffect(()=>{var b;t&&(a(((b=t.exchangeRate)==null?void 0:b.toString())||"1.0000"),t.code!==e&&x(t.code,e))},[t,e]);const x=async(b,C)=>{d(!0),h(null),l(null);try{const j=await fetch(`https://api.exchangerate-api.com/v4/latest/${b}`);if(!j.ok)throw new Error("Failed to fetch exchange rate");const k=(await j.json()).rates[C];if(k)l(k);else throw new Error("Exchange rate not available")}catch(j){console.error("Error fetching live rate:",j);try{const k=await(await fetch(`https://api.exchangerate-api.com/v4/latest/${C}`)).json();if(k.rates[b]){const E=1/k.rates[b];l(E)}else h("Exchange rate currently unavailable")}catch{h("Unable to fetch live rate")}}finally{d(!1)}},m=()=>{i&&(a(i.toFixed(4)),l(null))},g=async()=>{if(t){p(!0),v(null);try{const b=await s(t.currencyId,n);b.success?r():v({title:"Failed to Update Exchange Rate",message:b.error||"An error occurred while updating the exchange rate. Please try again."})}catch(b){v({title:"Unexpected Error",message:b instanceof Error?b.message:"An unexpected error occurred. Please try again."})}finally{p(!1)}}},y=b=>{b.target===b.currentTarget&&r()};if(!t)return null;const w=i!==null&&Math.abs(parseFloat(n)-i)>1e-4;return o.jsxs("div",{className:`${nt.modalOverlay} ${t?nt.show:""}`,onClick:y,children:[o.jsxs("div",{className:nt.modalContent,onClick:b=>b.stopPropagation(),children:[o.jsxs("div",{className:nt.modalHeader,children:[o.jsx("h2",{className:nt.modalTitle,children:"Edit Currency Details"}),o.jsx("button",{className:nt.modalCloseBtn,onClick:r,children:o.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})})})]}),o.jsxs("div",{className:nt.modalBody,children:[o.jsxs("div",{className:nt.modalInfoGroup,children:[o.jsxs("div",{className:nt.modalInfoItem,children:[o.jsx("span",{className:nt.modalInfoLabel,children:"Currency Code"}),o.jsx("span",{className:nt.modalInfoValue,children:t.code})]}),o.jsxs("div",{className:nt.modalInfoItem,children:[o.jsx("span",{className:nt.modalInfoLabel,children:"Currency Name"}),o.jsx("span",{className:nt.modalInfoValue,children:t.name})]}),o.jsxs("div",{className:nt.modalInfoItem,children:[o.jsx("span",{className:nt.modalInfoLabel,children:"Symbol"}),o.jsx("span",{className:nt.modalInfoValue,children:t.symbol})]})]}),o.jsxs("div",{className:nt.modalFormGroup,children:[o.jsx("label",{className:nt.modalLabel,children:"Exchange Rate"}),o.jsx("input",{type:"number",className:nt.modalInput,step:"0.0001",min:"0",placeholder:"1.0000",value:n,onChange:b=>a(b.target.value)}),o.jsxs("div",{className:nt.exchangeRateInfo,children:[o.jsxs("div",{className:nt.liveRateDisplay,children:[c&&o.jsx("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:o.jsx(Me,{size:"small"})}),!c&&u&&o.jsx("span",{className:nt.rateError,children:u}),!c&&i&&!u&&o.jsxs("span",{className:nt.liveRateText,children:[o.jsx("strong",{children:"Live Rate:"})," 1 ",t.code," = ",o.jsx("span",{className:nt.rateValue,children:i.toFixed(4)})," ",o.jsx("span",{className:nt.baseCurrency,children:e})]}),!c&&t.code===e&&o.jsxs("span",{className:nt.liveRateText,children:["Exchange rate to base currency: ",o.jsx("span",{className:nt.rateValue,children:"1.0000"})]})]}),w&&o.jsx("button",{type:"button",className:nt.useLiveRateBtn,onClick:m,children:"Use Live Rate"})]})]})]}),o.jsxs("div",{className:nt.modalFooter,children:[o.jsx(Ne,{variant:"outline",size:"md",onClick:r,disabled:f,children:"Cancel"}),o.jsx(Ne,{variant:"primary",size:"md",onClick:g,disabled:f,children:f?o.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:o.jsx(Me,{size:"small"})}):"Save Changes"})]})]}),o.jsx($e,{variant:"error",title:_==null?void 0:_.title,message:(_==null?void 0:_.message)||"",isOpen:!!_,onClose:()=>v(null),zIndex:10001})]})},I6="_modalOverlay_k04mn_2",k6="_show_k04mn_17",E6="_modalContent_k04mn_23",T6="_modalHeader_k04mn_43",L6="_modalTitle_k04mn_51",A6="_modalCloseBtn_k04mn_58",D6="_modalBody_k04mn_77",M6="_formGroup_k04mn_84",R6="_formLabel_k04mn_88",P6="_formInput_k04mn_96",O6="_currencyInfo_k04mn_123",$6="_currencyInfoItem_k04mn_130",F6="_currencyInfoLabel_k04mn_140",B6="_currencyInfoValue_k04mn_145",V6="_exchangeRateWrapper_k04mn_152",H6="_liveRateInfo_k04mn_163",z6="_liveRateLabel_k04mn_173",q6="_liveRateValue_k04mn_178",U6="_modalFooter_k04mn_186",vt={modalOverlay:I6,show:k6,modalContent:E6,modalHeader:T6,modalTitle:L6,modalCloseBtn:A6,modalBody:D6,formGroup:M6,formLabel:R6,formInput:P6,currencyInfo:O6,currencyInfoItem:$6,currencyInfoLabel:F6,currencyInfoValue:B6,exchangeRateWrapper:V6,liveRateInfo:H6,liveRateLabel:z6,liveRateValue:q6,modalFooter:U6},W6=({isOpen:t,onClose:e,existingCurrencies:r,baseCurrencyCode:s,onGetAllCurrencyTypes:n,onAddCurrency:a})=>{const[i,l]=S.useState([]),[c,d]=S.useState(""),[u,h]=S.useState(""),[f,p]=S.useState(null),[_,v]=S.useState(!1),[x,m]=S.useState(!1),[g,y]=S.useState(null);S.useEffect(()=>{t&&(w(),d(""),h(""),p(null),y(null))},[t]);const w=async()=>{const N=await n();l(N)},C=i.filter(N=>!r.some($=>$.currencyId===N.currencyId)).map(N=>({value:N.currencyId,label:`${N.code}`,description:N.name,badge:N.symbol})),j=i.find(N=>N.currencyId===c),I=N=>{d(N),p(null)},k=async()=>{if(!(!j||!s)){v(!0);try{const $=(await(await fetch(`https://api.exchangerate-api.com/v4/latest/${j.code}`)).json()).rates[s];if($)p($),h($.toFixed(4));else{const H=await(await fetch(`https://api.exchangerate-api.com/v4/latest/${s}`)).json();if(H.rates[j.code]){const L=1/H.rates[j.code];p(L),h(L.toFixed(4))}}}catch(N){console.error("Failed to fetch live exchange rate:",N)}finally{v(!1)}}},E=()=>{f&&h(f.toFixed(4))},T=async()=>{if(!(!c||!u)){m(!0),y(null);try{const N=await a(c,u);m(!1),N.success?e():y({title:"Failed to Add Currency",message:N.error||"An error occurred while adding the currency. Please try again."})}catch(N){m(!1),y({title:"Unexpected Error",message:N instanceof Error?N.message:"An unexpected error occurred. Please try again."})}}},D=N=>{N.target===N.currentTarget&&e()};return t?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:`${vt.modalOverlay} ${t?vt.show:""}`,onClick:D,children:o.jsxs("div",{className:vt.modalContent,onClick:N=>N.stopPropagation(),children:[o.jsxs("div",{className:vt.modalHeader,children:[o.jsx("h2",{className:vt.modalTitle,children:"Add New Currency"}),o.jsx("button",{className:vt.modalCloseBtn,onClick:e,children:o.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})})})]}),o.jsxs("div",{className:vt.modalBody,children:[o.jsx(Ze,{label:"Select Currency",placeholder:"Select currency",value:c,options:C,onChange:I,searchable:!0,showDescriptions:!0,showBadges:!0,fullWidth:!0,emptyMessage:"No currencies available",maxHeight:"300px"}),j&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:vt.currencyInfo,children:[o.jsxs("div",{className:vt.currencyInfoItem,children:[o.jsx("span",{className:vt.currencyInfoLabel,children:"Code:"}),o.jsx("span",{className:vt.currencyInfoValue,children:j.code})]}),o.jsxs("div",{className:vt.currencyInfoItem,children:[o.jsx("span",{className:vt.currencyInfoLabel,children:"Name:"}),o.jsx("span",{className:vt.currencyInfoValue,children:j.name})]}),o.jsxs("div",{className:vt.currencyInfoItem,children:[o.jsx("span",{className:vt.currencyInfoLabel,children:"Symbol:"}),o.jsx("span",{className:vt.currencyInfoValue,children:j.symbol})]})]}),o.jsxs("div",{className:vt.formGroup,children:[o.jsxs("label",{className:vt.formLabel,children:["Exchange Rate (1 ",j.code," = ? ",s,")"]}),o.jsxs("div",{className:vt.exchangeRateWrapper,children:[o.jsx("input",{type:"number",step:"0.0001",className:vt.formInput,value:u,onChange:N=>h(N.target.value),placeholder:"Enter exchange rate"}),o.jsx(Ne,{variant:"outline",size:"sm",onClick:k,disabled:_,children:_?o.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:o.jsx(Me,{size:"small"})}):"Get Live Rate"})]})]}),f&&o.jsxs("div",{className:vt.liveRateInfo,children:[o.jsx("span",{className:vt.liveRateLabel,children:"Live Rate:"}),o.jsx("span",{className:vt.liveRateValue,children:f.toFixed(4)}),o.jsx(Ne,{variant:"text",size:"sm",onClick:E,children:"Use This Rate"})]})]})]}),o.jsxs("div",{className:vt.modalFooter,children:[o.jsx(Ne,{variant:"outline",size:"md",onClick:e,children:"Cancel"}),o.jsx(Ne,{variant:"primary",size:"md",onClick:T,disabled:!c||!u||x,children:x?o.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:o.jsx(Me,{size:"small"})}):"Add Currency"})]})]})}),o.jsx($e,{variant:"error",title:g==null?void 0:g.title,message:(g==null?void 0:g.message)||"",isOpen:!!g,onClose:()=>y(null),zIndex:10001})]}):null},G6="_pageLayout_1lgbz_2",J6="_container_1lgbz_10",K6="_pageHeader_1lgbz_17",Y6="_pageHeaderContent_1lgbz_26",Q6="_pageTitle_1lgbz_30",Z6="_pageSubtitle_1lgbz_37",X6="_statsCard_1lgbz_46",eR="_statsGrid_1lgbz_54",tR="_statItem_1lgbz_60",rR="_statValue_1lgbz_64",sR="_statLabel_1lgbz_72",nR="_currencySection_1lgbz_82",aR="_sectionHeader_1lgbz_86",oR="_sectionTitle_1lgbz_93",iR="_currencyGrid_1lgbz_101",lR="_currencyCard_1lgbz_108",cR="_currencyCardHeader_1lgbz_122",dR="_currencyIconWrapper_1lgbz_130",uR="_currencySymbol_1lgbz_141",hR="_currencyHeaderInfo_1lgbz_147",fR="_currencyCode_1lgbz_151",mR="_currencyName_1lgbz_158",pR="_currencyBadgePrimary_1lgbz_164",gR="_currencyCardBody_1lgbz_173",_R="_currencyDetails_1lgbz_177",yR="_currencyDetailItem_1lgbz_183",vR="_currencyDetailLabel_1lgbz_189",xR="_currencyDetailValue_1lgbz_197",bR="_currencyCardFooter_1lgbz_204",wR="_currencyActions_1lgbz_213",SR="_emptyContainer_1lgbz_223",jR="_emptyTitle_1lgbz_231",CR="_emptyText_1lgbz_238",Re={pageLayout:G6,container:J6,pageHeader:K6,pageHeaderContent:Y6,pageTitle:Q6,pageSubtitle:Z6,statsCard:X6,statsGrid:eR,statItem:tR,statValue:rR,statLabel:sR,currencySection:nR,sectionHeader:aR,sectionTitle:oR,currencyGrid:iR,currencyCard:lR,currencyCardHeader:cR,currencyIconWrapper:dR,currencySymbol:uR,currencyHeaderInfo:hR,currencyCode:fR,currencyName:mR,currencyBadgePrimary:pR,currencyCardBody:gR,currencyDetails:_R,currencyDetailItem:yR,currencyDetailLabel:vR,currencyDetailValue:xR,currencyCardFooter:bR,currencyActions:wR,emptyContainer:SR,emptyTitle:jR,emptyText:CR},NR=()=>{const{currentCompany:t,currentUser:e}=ht();let r=(e==null?void 0:e.user_id)||"";if(!r)try{const j=sessionStorage.getItem("userData")||localStorage.getItem("userData")||localStorage.getItem("user");j&&(r=JSON.parse(j).user_id||"")}catch(j){console.error("Failed to parse stored user data:",j)}const{currencies:s,loading:n,editingCurrency:a,showAddModal:i,currencyToRemove:l,isRemoving:c,notification:d,setEditingCurrency:u,setShowAddModal:h,setCurrencyToRemove:f,clearNotification:p,getAllCurrencyTypes:_,updateExchangeRate:v,addCurrency:x,handleEditCurrency:m,handleRemoveCurrency:g,confirmRemoveCurrency:y}=s6((t==null?void 0:t.company_id)||"",r);if(n)return o.jsxs(o.Fragment,{children:[o.jsx(Se,{activeItem:"setting"}),o.jsx("div",{className:Re.pageLayout,children:o.jsx("div",{className:Re.container,children:o.jsx(Me,{size:"large",fullscreen:!0})})})]});if(!t)return o.jsxs(o.Fragment,{children:[o.jsx(Se,{activeItem:"setting"}),o.jsx("div",{className:Re.pageLayout,children:o.jsx("div",{className:Re.container,children:o.jsxs("div",{className:Re.emptyContainer,children:[o.jsx("h2",{className:Re.emptyTitle,children:"No Company Selected"}),o.jsx("p",{className:Re.emptyText,children:"Please select a company to manage currencies"})]})})})]});const w=s.length,b=s.length,C=s.find(j=>j.isDefault);return o.jsxs(o.Fragment,{children:[o.jsx(Se,{activeItem:"setting"}),o.jsx("div",{className:Re.pageLayout,children:o.jsxs("div",{className:Re.container,children:[o.jsxs("div",{className:Re.pageHeader,children:[o.jsxs("div",{className:Re.pageHeaderContent,children:[o.jsx("h1",{className:Re.pageTitle,children:"Currency Settings"}),o.jsx("p",{className:Re.pageSubtitle,children:"Manage your company's currencies and exchange rates"})]}),o.jsxs(Ne,{variant:"primary",size:"md",onClick:()=>h(!0),children:[o.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor",style:{marginRight:"8px"},children:o.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"})}),"Add Currency"]})]}),s.length>0&&o.jsx("div",{className:Re.statsCard,children:o.jsxs("div",{className:Re.statsGrid,children:[o.jsxs("div",{className:Re.statItem,children:[o.jsx("p",{className:Re.statValue,children:w}),o.jsx("p",{className:Re.statLabel,children:"Total Currencies"})]}),o.jsxs("div",{className:Re.statItem,children:[o.jsx("p",{className:Re.statValue,children:b}),o.jsx("p",{className:Re.statLabel,children:"Active Currencies"})]}),o.jsxs("div",{className:Re.statItem,children:[o.jsx("p",{className:Re.statValue,children:(C==null?void 0:C.code)||"-"}),o.jsx("p",{className:Re.statLabel,children:"Primary Currency"})]})]})}),o.jsxs("div",{className:Re.currencySection,children:[o.jsx("div",{className:Re.sectionHeader,children:o.jsx("h2",{className:Re.sectionTitle,children:"Configured Currencies"})}),o.jsx("div",{className:Re.currencyGrid,children:s.map(j=>o.jsxs("div",{className:Re.currencyCard,children:[o.jsxs("div",{className:Re.currencyCardHeader,children:[o.jsx("div",{className:Re.currencyIconWrapper,children:o.jsx("span",{className:Re.currencySymbol,children:j.symbol})}),o.jsxs("div",{className:Re.currencyHeaderInfo,children:[o.jsx("h3",{className:Re.currencyCode,children:j.code}),o.jsx("p",{className:Re.currencyName,children:j.name})]}),j.isDefault&&o.jsx("span",{className:Re.currencyBadgePrimary,children:"DEFAULT"})]}),o.jsx("div",{className:Re.currencyCardBody,children:o.jsx("div",{className:Re.currencyDetails,children:o.jsxs("div",{className:Re.currencyDetailItem,children:[o.jsx("span",{className:Re.currencyDetailLabel,children:"Exchange Rate"}),o.jsx("span",{className:Re.currencyDetailValue,children:(j.exchangeRate||1).toFixed(4)})]})})}),o.jsx("div",{className:Re.currencyCardFooter,children:o.jsxs("div",{className:Re.currencyActions,children:[o.jsx(Ne,{variant:"outline",size:"sm",onClick:()=>m(j),children:"Edit"}),!j.isDefault&&o.jsx(Ne,{variant:"outline",size:"sm",onClick:()=>g(j),children:"Remove"})]})})]},j.currencyId))})]}),o.jsx(W6,{isOpen:i,onClose:()=>h(!1),existingCurrencies:s,baseCurrencyCode:(C==null?void 0:C.code)||"",onGetAllCurrencyTypes:_,onAddCurrency:x}),o.jsx(N6,{currency:a,baseCurrencyCode:(C==null?void 0:C.code)||"",onClose:()=>u(null),onSave:v}),o.jsx($e,{variant:(d==null?void 0:d.variant)||"error",message:(d==null?void 0:d.message)||"",isOpen:!!d,onClose:p,autoCloseDuration:2e3,zIndex:1e4}),o.jsx(Nm,{isOpen:!!l,onClose:()=>f(null),onConfirm:y,variant:"error",title:"Remove Currency",message:`Are you sure you want to remove ${l==null?void 0:l.code}? This action cannot be undone.`,confirmText:"Remove",cancelText:"Cancel",confirmButtonVariant:"error",isLoading:c,closeOnBackdropClick:!0,closeOnEscape:!c,children:l&&o.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px",marginTop:"16px"},children:[o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsx("span",{style:{fontSize:"14px",fontWeight:600,color:"#6C757D"},children:"Currency Code:"}),o.jsx("span",{style:{fontSize:"14px",fontWeight:600,color:"#212529"},children:l.code})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsx("span",{style:{fontSize:"14px",fontWeight:600,color:"#6C757D"},children:"Currency Name:"}),o.jsx("span",{style:{fontSize:"14px",fontWeight:500,color:"#212529"},children:l.name})]}),o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsx("span",{style:{fontSize:"14px",fontWeight:600,color:"#6C757D"},children:"Exchange Rate:"}),o.jsx("span",{style:{fontFamily:"Pretendard, -apple-system, BlinkMacSystemFont, system-ui, sans-serif",fontSize:"14px",fontWeight:600,color:"#212529"},children:(l.exchangeRate||1).toFixed(4)})]})]})})]})})]})};class IR{async getSalaryData(e,r){try{const s=se.getClient(),{data:n,error:a}=await s.rpc("get_employee_salary",{p_company_id:e,p_month:r});return a?(console.error("Salary RPC error:",a),{success:!1,error:a.message||"Failed to fetch salary data"}):n?{success:!0,data:n}:{success:!1,error:"No data returned from salary query"}}catch(s){return console.error("Salary datasource error:",s),{success:!1,error:s instanceof Error?s.message:"Unknown error occurred"}}}async exportToExcel(e,r){try{const s=se.getClient(),{data:n,error:a}=await s.rpc("get_employee_salary_excel",{p_company_id:e,p_month:r});return a?(console.error("Salary Excel RPC error:",a),{success:!1,error:a.message||"Failed to export salary data"}):{success:!0,data:n}}catch(s){return console.error("Salary Excel export error:",s),{success:!1,error:s instanceof Error?s.message:"Unknown error occurred"}}}}class Im{constructor(e,r,s,n,a,i,l,c,d,u,h,f=null,p="pending"){this.userId=e,this.fullName=r,this.email=s,this.roleName=n,this.storeName=a,this.baseSalary=i,this.bonuses=l,this.deductions=c,this.totalSalary=d,this.currencySymbol=u,this.currencyCode=h,this.paymentDate=f,this.status=p}get netSalary(){return this.totalSalary}formatAmount(e){return`${this.currencySymbol}${e.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})}`}get formattedBaseSalary(){return this.formatAmount(this.baseSalary)}get formattedBonuses(){return this.formatAmount(this.bonuses)}get formattedDeductions(){return this.formatAmount(this.deductions)}get formattedTotalSalary(){return this.formatAmount(this.totalSalary)}get isOverdue(){return!this.paymentDate||this.status==="paid"?!1:this.paymentDate<new Date}static create(e){return new Im(e.user_id,e.full_name,e.email,e.role_name,e.store_name,e.base_salary||0,e.bonuses||0,e.deductions||0,e.total_salary||0,e.currency_symbol,e.currency_code,e.payment_date||null,e.status||"pending")}}class dd{constructor(e,r,s,n,a,i,l){this.period=e,this.totalEmployees=r,this.totalSalary=s,this.averageSalary=n,this.totalBonuses=a,this.totalDeductions=i,this.currencySymbol=l}formatAmount(e){return`${this.currencySymbol}${e.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})}`}get formattedTotalSalary(){return this.formatAmount(this.totalSalary)}get formattedAverageSalary(){return this.formatAmount(this.averageSalary)}get formattedTotalBonuses(){return this.formatAmount(this.totalBonuses)}get formattedTotalDeductions(){return this.formatAmount(this.totalDeductions)}static create(e){return new dd(e.period,e.total_employees||0,e.total_salary||0,e.average_salary||0,e.total_bonuses||0,e.total_deductions||0,e.currency_symbol)}static empty(e,r="$"){return new dd(e,0,0,0,0,0,r)}}class kR{static employeeFromSupabase(e){var d;const r=e.currency_info||{currency_symbol:"$",currency_code:"USD"},s=e.salary_info,n=(s==null?void 0:s.base_info)||{},a=(s==null?void 0:s.deductions)||{},i=(s==null?void 0:s.bonuses)||{},l=((d=e.stores)==null?void 0:d.map(u=>u.store_name).join(", "))||"N/A";let c=0;return e.salary_type==="hourly"?c=(n.worked_hours||0)*(n.hourly_rate||0):c=n.monthly_salary||n.base_payment||0,Im.create({user_id:e.user_id,full_name:e.user_name,email:e.email,role_name:e.role_name||"N/A",store_name:l,base_salary:c,bonuses:i.bonus_amount||0,deductions:a.late_deduction_amount||0,total_salary:(s==null?void 0:s.total_payment)||0,currency_symbol:r.currency_symbol,currency_code:r.currency_code,payment_date:e.payment_date?re.toLocal(e.payment_date):null,status:e.status||"pending"})}static summaryFromSupabase(e,r){const s=r.base_currency||{currency_symbol:"$"},n=r.total_payment||r.total_salary||0;return dd.create({period:e,total_employees:r.total_employees||0,total_salary:n,average_salary:r.average_salary||0,total_bonuses:r.total_bonuses||0,total_deductions:r.total_deductions||0,currency_symbol:s.currency_symbol})}static fromSupabase(e){const r=(e.employees||[]).map(n=>this.employeeFromSupabase(n)),s=this.summaryFromSupabase(e.period,e.summary);return{records:r,summary:s}}}class ER{constructor(){W(this,"dataSource");this.dataSource=new IR}async getSalaryData(e,r){try{const s=await this.dataSource.getSalaryData(e,r);if(!s.success||!s.data)return{success:!1,error:s.error||"Failed to fetch salary data"};const{records:n,summary:a}=kR.fromSupabase(s.data);return{success:!0,records:n,summary:a}}catch(s){return{success:!1,error:s instanceof Error?s.message:"An unexpected error occurred"}}}async exportToExcel(e,r,s=null,n="Company",a="AllStores"){try{const i=await dm(()=>import("./exceljs.min-DNEr28WI.js").then(m=>m.e),[]),l=await this.dataSource.exportToExcel(e,r);if(!l.success||!l.data)return{success:!1,error:l.error||"Failed to export salary data"};const c=l.data;if(!c||c.length===0)return{success:!1,error:"No data available for export in the selected period"};console.log(`Excel export data received: ${c.length} shift records`);const d=c.map(m=>({shift_request_id:m.shift_request_id||"",user_id:m.user_id||"",first_name:m.first_name||"",last_name:m.last_name||"",user_name:m.user_name||"",user_email:m.user_email||"",store_name:m.store_name||"",store_code:m.store_code||"",request_date:m.request_date?re.formatDateOnly(re.toLocal(m.request_date)):"",shift_name:m.shift_name||"",start_time:m.start_time?re.format(re.toLocal(m.start_time)):"",end_time:m.end_time?re.format(re.toLocal(m.end_time)):"",actual_start_time:m.actual_start_time?re.format(re.toLocal(m.actual_start_time)):"",actual_end_time:m.actual_end_time?re.format(re.toLocal(m.actual_end_time)):"",confirm_start_time:m.confirm_start_time?re.format(re.toLocal(m.confirm_start_time)):"",confirm_end_time:m.confirm_end_time?re.format(re.toLocal(m.confirm_end_time)):"",scheduled_hours:m.scheduled_hours||0,actual_worked_hours:m.actual_worked_hours||0,paid_hours:m.paid_hours||0,is_late:m.is_late?"Yes":"No",late_minutes:m.late_minutes||0,late_deduction_krw:m.late_deduction_krw||0,is_extratime:m.is_extratime?"Yes":"No",overtime_minutes:m.overtime_minutes||0,overtime_amount:m.overtime_amount||0,salary_type:m.salary_type||"",salary_amount:m.salary_amount||0,bonus_amount:m.bonus_amount||0,total_salary_pay:m.total_salary_pay||0,total_pay_with_bonus:m.total_pay_with_bonus||0,is_approved:m.is_approved?"Yes":"No",is_problem:m.is_problem?"Yes":"No",problem_type:m.problem_type||"",report_reason:m.report_reason||""})),u=new i.Workbook,h=u.addWorksheet("Shift Records");h.columns=[{header:"shift_request_id",key:"shift_request_id",width:36},{header:"user_id",key:"user_id",width:36},{header:"first_name",key:"first_name",width:15},{header:"last_name",key:"last_name",width:15},{header:"user_name",key:"user_name",width:20},{header:"user_email",key:"user_email",width:25},{header:"store_name",key:"store_name",width:20},{header:"store_code",key:"store_code",width:12},{header:"request_date",key:"request_date",width:12},{header:"shift_name",key:"shift_name",width:15},{header:"start_time",key:"start_time",width:18},{header:"end_time",key:"end_time",width:18},{header:"actual_start_time",key:"actual_start_time",width:18},{header:"actual_end_time",key:"actual_end_time",width:18},{header:"confirm_start_time",key:"confirm_start_time",width:18},{header:"confirm_end_time",key:"confirm_end_time",width:18},{header:"scheduled_hours",key:"scheduled_hours",width:14},{header:"actual_worked_hours",key:"actual_worked_hours",width:16},{header:"paid_hours",key:"paid_hours",width:12},{header:"is_late",key:"is_late",width:8},{header:"late_minutes",key:"late_minutes",width:12},{header:"late_deduction_krw",key:"late_deduction_krw",width:16},{header:"is_extratime",key:"is_extratime",width:10},{header:"overtime_minutes",key:"overtime_minutes",width:15},{header:"overtime_amount",key:"overtime_amount",width:15},{header:"salary_type",key:"salary_type",width:12},{header:"salary_amount",key:"salary_amount",width:15},{header:"bonus_amount",key:"bonus_amount",width:15},{header:"total_salary_pay",key:"total_salary_pay",width:16},{header:"total_pay_with_bonus",key:"total_pay_with_bonus",width:18},{header:"is_approved",key:"is_approved",width:12},{header:"is_problem",key:"is_problem",width:12},{header:"problem_type",key:"problem_type",width:15},{header:"report_reason",key:"report_reason",width:20}],d.forEach(m=>{h.addRow(m)});const f=h.getRow(1);f.font={name:"Arial",size:18,bold:!0},f.alignment={vertical:"middle",horizontal:"center",wrapText:!1},f.height=30,f.eachCell({includeEmpty:!1},m=>{m.border={bottom:{style:"thick",color:{argb:"FF000000"}}},m.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFF2F2F2"}}});const p=m=>m.replace(/[^a-zA-Z0-9-\s-]/g,"").replace(/\s+/g,"_"),_=`ShiftRecords_${p(n)}_${p(a)}_${r}.xlsx`,v=await u.xlsx.writeBuffer();return{success:!0,blob:new Blob([v],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),filename:_,recordCount:c.length}}catch(i){return console.error("Export to Excel error:",i),{success:!1,error:i instanceof Error?i.message:"An unexpected error occurred"}}}}class Ou{static validateCompanyId(e){const r=[];return!e||e.trim()===""?(r.push({field:"companyId",message:"Company ID is required"}),r):(/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e)||r.push({field:"companyId",message:"Invalid company ID format"}),r)}static validateMonthFormat(e){const r=[];if(!e||e.trim()==="")return r.push({field:"month",message:"Month is required"}),r;if(!/^\d{4}-(0[1-9]|1[0-2])$/.test(e))return r.push({field:"month",message:"Invalid month format. Expected YYYY-MM (e.g., 2025-11)"}),r;const[n,a]=e.split("-").map(Number),i=new Date(n,a-1,1),l=new Date,c=new Date(l.getFullYear(),l.getMonth(),1);i>c&&r.push({field:"month",message:"Cannot query future months"});const d=new Date(l.getFullYear()-5,l.getMonth(),1);return i<d&&r.push({field:"month",message:"Cannot query data older than 5 years"}),r}static validateSalaryQuery(e,r){const s=[],n=this.validateCompanyId(e);s.push(...n);const a=this.validateMonthFormat(r);return s.push(...a),s}static validateExcelExport(e,r,s,n){const a=[],i=this.validateSalaryQuery(e,r);return a.push(...i),!s||s.trim()===""?a.push({field:"companyName",message:"Company name is required for export"}):s.length>100&&a.push({field:"companyName",message:"Company name is too long (max 100 characters)"}),!n||n.trim()===""?a.push({field:"storeName",message:"Store name is required for export"}):n.length>100&&a.push({field:"storeName",message:"Store name is too long (max 100 characters)"}),a}static validateStoreId(e){const r=[];return e===null||e===""||/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e)||r.push({field:"storeId",message:"Invalid store ID format"}),r}}const Y_=new ER,$u=()=>{const t=new Date;return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}`},Sr=er((t,e)=>({records:[],summary:null,currentMonth:$u(),companyId:"",loading:!1,exporting:!1,error:null,notification:null,setRecords:r=>t({records:r}),setSummary:r=>t({summary:r}),setCurrentMonth:r=>t({currentMonth:r}),setCompanyId:r=>t({companyId:r}),setLoading:r=>t({loading:r}),setExporting:r=>t({exporting:r}),setError:r=>t({error:r}),setNotification:r=>t({notification:r}),clearErrors:()=>t({error:null,notification:null}),loadSalaryData:async(r,s)=>{t({loading:!0,error:null});try{const n=Ou.validateSalaryQuery(r,s);if(n.length>0){const i=n.map(l=>l.message).join(", ");return t({error:i,records:[],summary:null,loading:!1}),{success:!1,error:i}}const a=await Y_.getSalaryData(r,s);if(console.log("Salary Data Result:",a),!a.success){const i=a.error||"Failed to load salary data";return t({error:i,records:[],summary:null}),{success:!1,error:i}}return console.log("Salary Records:",a.records),a.records&&a.records.length>0&&(console.log("First Record:",a.records[0]),console.log("Record fullName:",a.records[0].fullName),console.log("Record totalSalary:",a.records[0].totalSalary)),console.log("Salary Summary:",a.summary),t({records:a.records||[],summary:a.summary||null,error:null}),{success:!0}}catch(n){console.error("Salary data error:",n);const a=n instanceof Error?n.message:"An unexpected error occurred";return t({error:a,records:[],summary:null}),{success:!1,error:a}}finally{t({loading:!1})}},refresh:async()=>{const{companyId:r,currentMonth:s,loadSalaryData:n}=e();return r?n(r,s):{success:!1,error:"Company ID is required"}},goToPreviousMonth:()=>{const r=e().currentMonth,[s,n]=r.split("-").map(Number),a=new Date(s,n-1,1);a.setMonth(a.getMonth()-1);const i=`${a.getFullYear()}-${String(a.getMonth()+1).padStart(2,"0")}`;t({currentMonth:i})},goToNextMonth:()=>{const r=e().currentMonth,[s,n]=r.split("-").map(Number),a=new Date(s,n-1,1);a.setMonth(a.getMonth()+1);const i=`${a.getFullYear()}-${String(a.getMonth()+1).padStart(2,"0")}`;t({currentMonth:i})},goToCurrentMonth:()=>{t({currentMonth:$u()})},exportToExcel:async(r,s,n)=>{const{companyId:a,currentMonth:i}=e(),l=Ou.validateExcelExport(a,i,s,n);if(l.length>0){const d=l.map(u=>u.message).join(", ");return t({notification:{variant:"error",title:"Validation Error",message:d}}),{success:!1,error:d}}if(r!==null){const d=Ou.validateStoreId(r);if(d.length>0){const u=d.map(h=>h.message).join(", ");return t({notification:{variant:"error",title:"Validation Error",message:u}}),{success:!1,error:u}}}let c=null;if("showSaveFilePicker"in window)try{const d=h=>h.replace(/[^a-zA-Z0-9-\s-]/g,"").replace(/\s+/g,"_"),u=`ShiftRecords_${d(s)}_${d(n)}_${i}.xlsx`;c=await window.showSaveFilePicker({suggestedName:u,types:[{description:"Excel Files",accept:{"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[".xlsx"]}}],excludeAcceptAllOption:!0}),console.log("File handle obtained successfully")}catch(d){if(d&&d.name==="AbortError")return console.log("User cancelled file selection"),{success:!1,error:"User cancelled"};console.log("Could not get file handle:",(d==null?void 0:d.name)||"Unknown error")}t({exporting:!0});try{const d=await Y_.exportToExcel(a,i,r,s,n);if(!d.success||!d.blob)throw new Error(d.error||"Failed to export data");const u=d.blob,h=d.filename||`salary_${i}.xlsx`;if(c)try{console.log("Writing to pre-obtained file handle...");const f=await c.createWritable();await f.write(u),await f.close(),console.log(`Excel file saved successfully: ${h}`),t({notification:{variant:"success",message:`${d.recordCount||0} shift records exported successfully to: ${h}`}})}catch(f){console.error("Failed to write to file handle:",f),Q_(u,h,t)}else Q_(u,h,t);return{success:!0}}catch(d){console.error("Export error:",d);const u=d instanceof Error?d.message:"Failed to export data";return t({notification:{variant:"error",title:"Export Failed",message:u}}),{success:!1,error:u}}finally{t({exporting:!1})}},reset:()=>t({records:[],summary:null,currentMonth:$u(),companyId:"",loading:!1,exporting:!1,error:null,notification:null})})),Q_=(t,e,r)=>{try{const s=URL.createObjectURL(t),n=document.createElement("a");n.href=s,n.download=e,n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(s),setTimeout(()=>{const a=` File "${e}" is being saved to your browser's default download folder. To change download location, check your browser settings.`;console.log(a),r({notification:{variant:"success",message:`File "${e}" has been downloaded successfully.`}})},1e3)}catch(s){console.error("Fallback download failed:",s),r({notification:{variant:"error",title:"Download Failed",message:"Failed to download the Excel file. Please try again."}})}},TR=(t,e)=>{const r=Sr(g=>g.records),s=Sr(g=>g.summary),n=Sr(g=>g.loading),a=Sr(g=>g.error),i=Sr(g=>g.currentMonth),l=Sr(g=>g.exporting),c=Sr(g=>g.notification),d=Sr(g=>g.setNotification),u=Sr(g=>g.setCompanyId),h=Sr(g=>g.setCurrentMonth),f=Sr(g=>g.loadSalaryData),p=Sr(g=>g.refresh),_=Sr(g=>g.goToPreviousMonth),v=Sr(g=>g.goToNextMonth),x=Sr(g=>g.goToCurrentMonth),m=Sr(g=>g.exportToExcel);return S.useEffect(()=>{t&&u(t)},[t,u]),S.useEffect(()=>{e&&h(e)},[e,h]),S.useEffect(()=>{t&&i&&f(t,i)},[t,i,f]),{records:r,summary:s,loading:n,error:a,currentMonth:i,exporting:l,notification:c,setNotification:d,refresh:p,goToPreviousMonth:_,goToNextMonth:v,goToCurrentMonth:x,exportToExcel:m}},LR="_pageLayout_1mj08_5",AR="_container_1mj08_37",DR="_salaryHeader_1mj08_44",MR="_salaryTitleSection_1mj08_53",RR="_salaryTitle_1mj08_53",PR="_salarySubtitle_1mj08_66",OR="_periodControlsWrapper_1mj08_73",$R="_exportExcelBtn_1mj08_80",FR="_spinAnimation_1mj08_118",BR="_periodControls_1mj08_73",VR="_periodNavBtn_1mj08_143",HR="_periodDisplay_1mj08_163",zR="_active_1mj08_269",qR="_summarySection_1mj08_343",UR="_summaryCard_1mj08_350",WR="_summaryLabel_1mj08_363",GR="_summaryValue_1mj08_372",JR="_total_1mj08_380",KR="_problems_1mj08_384",YR="_summaryDetail_1mj08_388",QR="_summaryIcon_1mj08_394",ZR="_filterBar_1mj08_401",XR="_searchBox_1mj08_413",e8="_searchInput_1mj08_419",t8="_searchIcon_1mj08_434",r8="_filterChip_1mj08_444",s8="_employeeList_1mj08_467",n8="_employeeCard_1mj08_473",a8="_employeeHeader_1mj08_486",o8="_employeeMainInfo_1mj08_496",i8="_employeeIdentity_1mj08_503",l8="_employeeAvatar_1mj08_509",c8="_employeeInfo_1mj08_522",d8="_employeeName_1mj08_528",u8="_employeeType_1mj08_534",h8="_monthly_1mj08_544",f8="_employeeSalarySummary_1mj08_555",m8="_totalPayment_1mj08_562",p8="_paymentBreakdown_1mj08_569",g8="_employeeStores_1mj08_575",_8="_storeBadge_1mj08_581",y8="_employeeQuickStats_1mj08_591",v8="_quickStat_1mj08_599",x8="_quickStatLabel_1mj08_606",b8="_quickStatValue_1mj08_610",w8="_positive_1mj08_615",S8="_negative_1mj08_619",j8="_expandIcon_1mj08_628",C8="_expanded_1mj08_636",N8="_employeeDetails_1mj08_641",I8="_detailsContent_1mj08_653",k8="_detailSection_1mj08_658",E8="_detailSectionTitle_1mj08_666",T8="_salaryBreakdownTable_1mj08_676",L8="_breakdownRow_1mj08_682",A8="_breakdownLabel_1mj08_695",D8="_breakdownValue_1mj08_700",M8="_notRegistered_1mj08_715",R8="_emptyState_1mj08_745",P8="_emptyIcon_1mj08_753",O8="_emptyTitle_1mj08_760",$8="_emptyText_1mj08_767",V={pageLayout:LR,container:AR,salaryHeader:DR,salaryTitleSection:MR,salaryTitle:RR,salarySubtitle:PR,periodControlsWrapper:OR,exportExcelBtn:$R,spinAnimation:FR,periodControls:BR,periodNavBtn:VR,periodDisplay:HR,active:zR,summarySection:qR,summaryCard:UR,summaryLabel:WR,summaryValue:GR,total:JR,problems:KR,summaryDetail:YR,summaryIcon:QR,filterBar:ZR,searchBox:XR,searchInput:e8,searchIcon:t8,filterChip:r8,employeeList:s8,employeeCard:n8,employeeHeader:a8,employeeMainInfo:o8,employeeIdentity:i8,employeeAvatar:l8,employeeInfo:c8,employeeName:d8,employeeType:u8,monthly:h8,employeeSalarySummary:f8,totalPayment:m8,paymentBreakdown:p8,employeeStores:g8,storeBadge:_8,employeeQuickStats:y8,quickStat:v8,quickStatLabel:x8,quickStatValue:b8,positive:w8,negative:S8,expandIcon:j8,expanded:C8,employeeDetails:N8,detailsContent:I8,detailSection:k8,detailSectionTitle:E8,salaryBreakdownTable:T8,breakdownRow:L8,breakdownLabel:A8,breakdownValue:D8,notRegistered:M8,emptyState:R8,emptyIcon:P8,emptyTitle:O8,emptyText:$8},F8=({initialMonth:t})=>{const{currentCompany:e}=ht(),r=(e==null?void 0:e.company_id)||"",[s,n]=S.useState(null),[a,i]=S.useState(""),[l,c]=S.useState("all"),[d,u]=S.useState(new Set),{records:h,summary:f,loading:p,error:_,currentMonth:v,exporting:x,notification:m,setNotification:g,refresh:y,goToPreviousMonth:w,goToNextMonth:b,exportToExcel:C}=TR(r,t),j=D=>D,I=D=>{const N=new Set(d);N.has(D)?N.delete(D):N.add(D),u(N)},k=h.filter(D=>!(a&&!D.fullName.toLowerCase().includes(a.toLowerCase())||s&&D.storeName!==s||l==="monthly"&&!D.roleName.toLowerCase().includes("monthly")||l==="hourly"&&!D.roleName.toLowerCase().includes("hourly")||l==="problems"&&D.status!=="pending")),E=D=>D&&D.split(" ").map(N=>N[0]).join("").toUpperCase().slice(0,2)||"??";if(!e)return o.jsxs(o.Fragment,{children:[o.jsx(Se,{activeItem:"employee"}),o.jsx("div",{className:V.pageLayout,children:o.jsx("div",{className:V.container,children:o.jsx(Me,{size:"large",fullscreen:!0})})})]});if(p)return o.jsxs(o.Fragment,{children:[o.jsx(Se,{activeItem:"employee"}),o.jsx("div",{className:V.pageLayout,children:o.jsx("div",{className:V.container,children:o.jsx(Me,{size:"large",fullscreen:!0})})})]});const T=(e==null?void 0:e.stores)||[];return o.jsxs(o.Fragment,{children:[o.jsx(Se,{activeItem:"employee"}),o.jsx("div",{className:V.pageLayout,children:o.jsxs("div",{className:V.container,children:[o.jsxs("div",{className:V.salaryHeader,children:[o.jsxs("div",{className:V.salaryTitleSection,children:[o.jsx("h1",{className:V.salaryTitle,children:"Salary Management"}),o.jsx("p",{className:V.salarySubtitle,children:"Manage employee compensation and payroll"})]}),o.jsxs("div",{className:V.periodControlsWrapper,children:[o.jsx("button",{className:V.exportExcelBtn,onClick:()=>{const D=(e==null?void 0:e.company_name)||"Company";let N="AllStores";if(s){const A=T.find($=>$.store_id===s);N=(A==null?void 0:A.store_name)||"Store"}C(s,D,N)},disabled:x||h.length===0,children:x?o.jsxs(o.Fragment,{children:[o.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",className:V.spinAnimation,children:o.jsx("path",{d:"M12,4V2A10,10 0 0,0 2,12H4A8,8 0 0,1 12,4Z"})}),o.jsx("span",{children:"Exporting..."})]}):o.jsxs(o.Fragment,{children:[o.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"})}),o.jsx("span",{children:"Export Excel"})]})}),o.jsxs("div",{className:V.periodControls,children:[o.jsx("button",{className:V.periodNavBtn,onClick:w,children:""}),o.jsx("div",{className:V.periodDisplay,children:j(v)}),o.jsx("button",{className:V.periodNavBtn,onClick:b,children:""})]})]})]}),o.jsx(ds,{stores:T,selectedStoreId:s,onStoreSelect:n,companyId:r}),f&&o.jsxs("div",{className:V.summarySection,children:[o.jsxs("div",{className:V.summaryCard,children:[o.jsxs("div",{className:V.summaryLabel,children:[o.jsx("svg",{className:V.summaryIcon,viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M16,13C15.71,13 15.38,13 15.03,13.05C16.19,13.89 17,15 17,16.5V19H23V16.5C23,14.17 18.33,13 16,13M8,13C5.67,13 1,14.17 1,16.5V19H15V16.5C15,14.17 10.33,13 8,13M8,11A3,3 0 0,0 11,8A3,3 0 0,0 8,5A3,3 0 0,0 5,8A3,3 0 0,0 8,11M16,11A3,3 0 0,0 19,8A3,3 0 0,0 16,5A3,3 0 0,0 13,8A3,3 0 0,0 16,11Z"})}),"Total Employees"]}),o.jsx("div",{className:V.summaryValue,children:f.totalEmployees}),o.jsxs("div",{className:V.summaryDetail,children:["Monthly: ",k.length," | Hourly: 0"]})]}),o.jsxs("div",{className:V.summaryCard,children:[o.jsxs("div",{className:V.summaryLabel,children:[o.jsx("svg",{className:V.summaryIcon,viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4M11,17V16H9V14H13V13H10A1,1 0 0,1 9,12V9A1,1 0 0,1 10,8H11V7H13V8H15V10H11V11H14A1,1 0 0,1 15,12V15A1,1 0 0,1 14,16H13V17H11Z"})}),"Total Payment"]}),o.jsx("div",{className:`${V.summaryValue} ${V.total}`,children:f.formattedTotalSalary}),o.jsxs("div",{className:V.summaryDetail,children:["Base: ",f.formattedTotalSalary]})]}),o.jsxs("div",{className:V.summaryCard,children:[o.jsxs("div",{className:V.summaryLabel,children:[o.jsx("svg",{className:V.summaryIcon,viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M12,2A2,2 0 0,1 14,4C14,4.74 13.6,5.39 13,5.73V7H14A7,7 0 0,1 21,14H22A1,1 0 0,1 23,15V18A1,1 0 0,1 22,19H21V20A2,2 0 0,1 19,22H5A2,2 0 0,1 3,20V19H2A1,1 0 0,1 1,18V15A1,1 0 0,1 2,14H3A7,7 0 0,1 10,7H11V5.73C10.4,5.39 10,4.74 10,4A2,2 0 0,1 12,2M7.5,13A2.5,2.5 0 0,0 5,15.5A2.5,2.5 0 0,0 7.5,18A2.5,2.5 0 0,0 10,15.5A2.5,2.5 0 0,0 7.5,13M16.5,13A2.5,2.5 0 0,0 14,15.5A2.5,2.5 0 0,0 16.5,18A2.5,2.5 0 0,0 19,15.5A2.5,2.5 0 0,0 16.5,13Z"})}),"Problems"]}),o.jsx("div",{className:`${V.summaryValue} ${V.problems}`,children:"0"}),o.jsx("div",{className:V.summaryDetail,children:"Total: 0 | Solved: 0"})]})]}),o.jsxs("div",{className:V.filterBar,children:[o.jsxs("div",{className:V.searchBox,children:[o.jsx("svg",{className:V.searchIcon,viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"})}),o.jsx("input",{type:"text",className:V.searchInput,placeholder:"Search by employee name...",value:a,onChange:D=>i(D.target.value)})]}),o.jsx("button",{className:`${V.filterChip} ${l==="all"?V.active:""}`,onClick:()=>c("all"),children:"All Employees"}),o.jsx("button",{className:`${V.filterChip} ${l==="monthly"?V.active:""}`,onClick:()=>c("monthly"),children:"Monthly"}),o.jsx("button",{className:`${V.filterChip} ${l==="hourly"?V.active:""}`,onClick:()=>c("hourly"),children:"Hourly"}),o.jsx("button",{className:`${V.filterChip} ${l==="problems"?V.active:""}`,onClick:()=>c("problems"),children:"Has Problems"}),o.jsx("button",{className:`${V.filterChip} ${l==="overtime"?V.active:""}`,onClick:()=>c("overtime"),children:"Overtime"})]}),k.length===0?o.jsxs("div",{className:V.emptyState,children:[o.jsxs("svg",{className:V.emptyIcon,width:"120",height:"120",viewBox:"0 0 120 120",fill:"none",children:[o.jsx("circle",{cx:"60",cy:"60",r:"50",fill:"#F0F6FF"}),o.jsx("rect",{x:"30",y:"45",width:"60",height:"40",rx:"6",fill:"white",stroke:"#0064FF",strokeWidth:"2"}),o.jsx("rect",{x:"30",y:"55",width:"60",height:"8",fill:"#0064FF"}),o.jsx("rect",{x:"38",y:"68",width:"12",height:"10",rx:"2",fill:"#E9ECEF"}),o.jsx("line",{x1:"41",y1:"68",x2:"41",y2:"78",stroke:"#ADB5BD",strokeWidth:"1"}),o.jsx("line",{x1:"47",y1:"68",x2:"47",y2:"78",stroke:"#ADB5BD",strokeWidth:"1"}),o.jsx("circle",{cx:"75",cy:"73",r:"10",fill:"#0064FF"}),o.jsx("text",{x:"75",y:"78",textAnchor:"middle",fill:"white",fontSize:"14",fontWeight:"600",children:"$"})]}),o.jsx("h3",{className:V.emptyTitle,children:"No Salary Records"}),o.jsx("p",{className:V.emptyText,children:"No employees found matching your criteria"})]}):o.jsx("div",{className:V.employeeList,children:k.map(D=>o.jsxs("div",{className:`${V.employeeCard} ${d.has(D.userId)?V.expanded:""}`,children:[o.jsxs("div",{className:V.employeeHeader,onClick:()=>I(D.userId),children:[o.jsxs("div",{className:V.employeeMainInfo,children:[o.jsxs("div",{className:V.employeeIdentity,children:[o.jsx("div",{className:V.employeeAvatar,children:E(D.fullName)}),o.jsxs("div",{className:V.employeeInfo,children:[o.jsx("div",{className:V.employeeName,children:D.fullName}),o.jsx("span",{className:`${V.employeeType} ${V.monthly}`,children:"Monthly"})]})]}),o.jsxs("div",{className:V.employeeSalarySummary,children:[o.jsx("div",{className:V.totalPayment,children:D.formattedTotalSalary}),o.jsxs("div",{className:V.paymentBreakdown,children:["Base: ",D.formattedBaseSalary]})]})]}),o.jsx("div",{className:V.employeeStores,children:o.jsx("span",{className:V.storeBadge,children:D.storeName})}),o.jsxs("div",{className:V.employeeQuickStats,children:[o.jsxs("div",{className:V.quickStat,children:[o.jsx("span",{className:V.quickStatLabel,children:"Late:"}),o.jsx("span",{className:V.quickStatValue,children:"0 times"})]}),o.jsxs("div",{className:V.quickStat,children:[o.jsx("span",{className:V.quickStatLabel,children:"Overtime:"}),o.jsx("span",{className:V.quickStatValue,children:"0 hours"})]}),o.jsxs("div",{className:V.quickStat,children:[o.jsx("span",{className:V.quickStatLabel,children:"Bonus:"}),o.jsx("span",{className:`${V.quickStatValue} ${V.positive}`,children:D.formattedBonuses})]})]}),o.jsx("svg",{className:V.expandIcon,viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M7,10L12,15L17,10H7Z"})})]}),d.has(D.userId)&&o.jsx("div",{className:V.employeeDetails,children:o.jsxs("div",{className:V.detailsContent,children:[o.jsxs("div",{className:V.detailSection,children:[o.jsx("h3",{className:V.detailSectionTitle,children:"Salary Breakdown"}),o.jsxs("div",{className:V.salaryBreakdownTable,children:[o.jsxs("div",{className:V.breakdownRow,children:[o.jsx("span",{className:V.breakdownLabel,children:"Base Salary"}),o.jsx("span",{className:V.breakdownValue,children:D.formattedBaseSalary})]}),o.jsxs("div",{className:V.breakdownRow,children:[o.jsx("span",{className:V.breakdownLabel,children:"Late Deduction"}),o.jsxs("span",{className:`${V.breakdownValue} ${V.negative}`,children:["-",D.formattedDeductions]})]}),o.jsxs("div",{className:V.breakdownRow,children:[o.jsx("span",{className:V.breakdownLabel,children:"Overtime Payment"}),o.jsxs("span",{className:`${V.breakdownValue} ${V.positive}`,children:["+",D.currencySymbol,"0"]})]}),o.jsxs("div",{className:V.breakdownRow,children:[o.jsx("span",{className:V.breakdownLabel,children:"Bonus"}),o.jsxs("span",{className:`${V.breakdownValue} ${V.positive}`,children:["+",D.formattedBonuses]})]}),o.jsxs("div",{className:V.breakdownRow,children:[o.jsx("span",{className:V.breakdownLabel,children:"Total Payment"}),o.jsx("span",{className:V.breakdownValue,children:D.formattedTotalSalary})]})]})]}),o.jsxs("div",{className:V.detailSection,children:[o.jsx("h3",{className:V.detailSectionTitle,children:"Bank Information"}),o.jsxs("div",{className:V.salaryBreakdownTable,children:[o.jsxs("div",{className:V.breakdownRow,children:[o.jsx("span",{className:V.breakdownLabel,children:"Bank Name"}),o.jsx("span",{className:`${V.breakdownValue} ${V.notRegistered}`,children:"Not registered"})]}),o.jsxs("div",{className:V.breakdownRow,children:[o.jsx("span",{className:V.breakdownLabel,children:"Account Number"}),o.jsx("span",{className:`${V.breakdownValue} ${V.notRegistered}`,children:"Not registered"})]})]})]}),o.jsxs("div",{className:V.detailSection,children:[o.jsx("h3",{className:V.detailSectionTitle,children:"Store Assignments"}),o.jsx("div",{className:V.employeeStores,children:D.storeName.split(", ").map((N,A)=>o.jsx("span",{className:V.storeBadge,children:N},A))})]})]})})]},D.userId))}),m&&o.jsx($e,{variant:m.variant,title:m.title,message:m.message,isOpen:!0,onClose:()=>g(null),autoCloseDuration:m.variant==="success"?2e3:0}),_&&o.jsx($e,{variant:"error",title:"Failed to Load Salary Data",message:_,isOpen:!0,onClose:()=>{},confirmText:"Try Again",onConfirm:y})]})})]})};class B8{constructor(e,r,s,n,a,i,l,c,d,u,h,f,p,_,v){this.userId=e,this.fullName=r,this.email=s,this.roleIds=n,this.roleNames=a,this.stores=i,this.companyId=l,this.companyName=c,this.salaryId=d,this.salaryAmount=u,this.salaryType=h,this.bonusAmount=f,this.currencyId=p,this.currencyCode=_,this.accountId=v}get initials(){const e=this.fullName.trim().split(" ");return e.length>=2?(e[0].charAt(0)+e[e.length-1].charAt(0)).toUpperCase():this.fullName.charAt(0).toUpperCase()}get primaryRole(){return this.roleNames[0]||"No Role"}get displayRole(){return this.roleNames.length>1?`${this.primaryRole} +${this.roleNames.length-1}`:this.primaryRole}isAssignedToStore(e){return this.stores.some(r=>r.store_id===e)}get storeNamesString(){return this.stores.map(e=>e.store_name).join(", ")}}class V8{async getEmployees(e,r){try{const s=se.getClient(),{data:n,error:a}=await s.rpc("get_employee_info",{p_company_id:e,p_store_id:r});return a?(console.error("Employee RPC error:",a),{success:!1,error:a.message||"Failed to fetch employees"}):n?{success:!0,data:n}:{success:!1,error:"No data returned from employee query"}}catch(s){return console.error("Employee datasource error:",s),{success:!1,error:s instanceof Error?s.message:"Unknown error occurred"}}}async getScheduleData(e,r,s,n){try{const a=se.getClient(),i=re.toRpcFormat(new Date(s)),l=re.toRpcFormat(new Date(n)),{data:c,error:d}=await a.rpc("get_shift_schedule_info",{p_company_id:e,p_store_id:r,p_start_date:i,p_end_date:l});return d?(console.error("Schedule RPC error:",d),{success:!1,error:d.message||"Failed to fetch schedule data"}):c?{success:!0,data:c}:{success:!1,error:"No data returned from schedule query"}}catch(a){return console.error("Schedule datasource error:",a),{success:!1,error:a instanceof Error?a.message:"Unknown error occurred"}}}async createAssignment(e,r,s,n,a){try{const i=se.getClient(),l=re.toRpcFormat(new Date(n)),{data:c,error:d}=await i.rpc("manager_shift_insert_schedule",{p_user_id:e,p_shift_id:r,p_store_id:s,p_request_date:l,p_approved_by:a});return d?(console.error("Create assignment RPC error:",d),{success:!1,error:d.message||"Failed to create assignment"}):{success:!0,data:c}}catch(i){return console.error("Create assignment datasource error:",i),{success:!1,error:i instanceof Error?i.message:"Unknown error occurred"}}}async updateAssignment(e,r){return{success:!1,error:"Not implemented yet"}}async deleteAssignment(e){return{success:!1,error:"Not implemented yet"}}}class ud{constructor(e,r,s,n,a){this.shiftId=e,this.shiftName=r,this.startTime=s,this.endTime=n,this.color=a}get timeRange(){return`${this.startTime} - ${this.endTime}`}static create(e){return new ud(e.shift_id,e.shift_name,e.start_time,e.end_time,e.color||"#3B82F6")}}class km{constructor(e,r,s,n,a,i="scheduled"){this.assignmentId=e,this.userId=r,this.fullName=s,this.date=n,this.shift=a,this.status=i}get formattedDate(){return new Date(this.date).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})}get isToday(){const e=re.toDateOnly(new Date);return this.date===e}static create(e){return new km(e.assignment_id,e.user_id,e.full_name,e.date,e.shift,e.status||"scheduled")}}class H8{static shiftFromSupabase(e){return ud.create({shift_id:e.shift_id,shift_name:e.shift_name,start_time:e.start_time,end_time:e.end_time,color:e.color})}static fromSupabase(e){const r=(e.shifts||[]).map(a=>this.shiftFromSupabase(a)),s=new Map((e.shifts||[]).map(a=>[a.shift_id,{shift_name:a.shift_name,start_time:a.start_time,end_time:a.end_time}])),n=[];return(e.schedule||[]).forEach(a=>{a.shifts.forEach(i=>{const l=s.get(i.shift_id);if(!l){console.warn(`Shift ${i.shift_id} not found in shifts list`);return}i.employees.forEach(c=>{const d=ud.create({shift_id:i.shift_id,shift_name:i.shift_name,start_time:l.start_time,end_time:l.end_time,color:void 0}),u=re.toLocalSafe(a.date),h=u?re.toDateOnly(u):a.date,f=km.create({assignment_id:`${h}-${i.shift_id}-${c.user_id}`,user_id:c.user_id,full_name:c.user_name,date:h,shift:d,status:c.status||"scheduled"});n.push(f)})})}),{shifts:r,assignments:n}}}class z8{constructor(){W(this,"dataSource");this.dataSource=new V8}async getScheduleData(e,r,s,n){try{const a=await this.dataSource.getScheduleData(e,r,s,n);if(!a.success||!a.data)return{success:!1,error:a.error||"Failed to fetch schedule data"};const{shifts:i,assignments:l}=H8.fromSupabase(a.data);return{success:!0,shifts:i,assignments:l}}catch(a){return{success:!1,error:a instanceof Error?a.message:"An unexpected error occurred"}}}async getEmployees(e,r){try{const s=await this.dataSource.getEmployees(e,r);return!s.success||!s.data?{success:!1,error:s.error||"Failed to fetch employees"}:{success:!0,employees:s.data.map(a=>new B8(a.user_id,a.full_name,a.email,a.role_ids||[],a.role_names||[],a.stores||[],a.company_id,a.company_name,a.salary_id,a.salary_amount,a.salary_type,a.bonus_amount,a.currency_id,a.currency_code,a.account_id))}}catch(s){return{success:!1,error:s instanceof Error?s.message:"An unexpected error occurred"}}}async createAssignment(e,r,s,n,a){try{return await this.dataSource.createAssignment(e,r,s,n,a)}catch(i){return{success:!1,error:i instanceof Error?i.message:"An unexpected error occurred"}}}async updateAssignment(e,r){return await this.dataSource.updateAssignment(e,r)}async deleteAssignment(e){return await this.dataSource.deleteAssignment(e)}}class q8{static validateAssignment(e){const r=[];if((!e.shiftId||!e.shiftId.trim())&&r.push({field:"shiftId",message:"Please select a shift"}),(!e.employeeId||!e.employeeId.trim())&&r.push({field:"employeeId",message:"Please select an employee"}),!e.date||!e.date.trim())r.push({field:"date",message:"Date is required"});else if(!/^\d{4}-\d{2}-\d{2}$/.test(e.date))r.push({field:"date",message:"Invalid date format (expected YYYY-MM-DD)"});else{const n=new Date(e.date),a=new Date;a.setHours(0,0,0,0),n<a&&r.push({field:"date",message:"Cannot create assignment for past dates"})}return r}static validateDateRange(e,r){const s=[];if((!e||!e.trim())&&s.push({field:"startDate",message:"Start date is required"}),(!r||!r.trim())&&s.push({field:"endDate",message:"End date is required"}),e&&r){const n=new Date(e),a=new Date(r);n>a&&s.push({field:"dateRange",message:"Start date must be before or equal to end date"}),Math.floor((a.getTime()-n.getTime())/(1e3*60*60*24))>90&&s.push({field:"dateRange",message:"Date range cannot exceed 90 days"})}return s}static validateContext(e,r){const s=[];return(!e||!e.trim())&&s.push({field:"companyId",message:"Company ID is required"}),(!r||!r.trim())&&s.push({field:"storeId",message:"Store ID is required"}),s}}const Fu=new z8,ft=er((t,e)=>({shifts:[],assignments:[],employees:[],loading:!1,loadingEmployees:!1,error:null,currentWeek:new Date,selectedStoreId:null,isAddEmployeeModalOpen:!1,selectedDate:"",addingEmployee:!1,notification:null,getWeekRange:(r=new Date)=>{const s=new Date(r);s.setDate(s.getDate()-s.getDay()),s.setHours(0,0,0,0);const n=new Date(s);return n.setDate(n.getDate()+6),n.setHours(23,59,59,999),{startDate:re.toDateOnly(s),endDate:re.toDateOnly(n)}},getWeekDays:()=>{const{startDate:r}=e().getWeekRange(e().currentWeek),s=[],n=new Date(r);for(let a=0;a<7;a++){const i=new Date(n);i.setDate(i.getDate()+a),s.push(i.toISOString().split("T")[0])}return s},loadScheduleData:async(r,s)=>{t({loading:!0,error:null});try{const{startDate:n,endDate:a}=e().getWeekRange(e().currentWeek),i=await Fu.getScheduleData(r,s,n,a);if(!i.success){t({error:i.error||"Failed to load schedule data",shifts:[],assignments:[],loading:!1});return}t({shifts:i.shifts||[],assignments:i.assignments||[],loading:!1,error:null})}catch(n){t({error:n instanceof Error?n.message:"An unexpected error occurred",shifts:[],assignments:[],loading:!1})}},loadEmployees:async(r,s)=>{t({loadingEmployees:!0});try{const n=await Fu.getEmployees(r,s);if(!n.success||!n.employees){console.error("Failed to load employees:",n.error),t({employees:[],loadingEmployees:!1});return}t({employees:n.employees,loadingEmployees:!1})}catch(n){console.error("Error loading employees:",n),t({employees:[],loadingEmployees:!1})}},refresh:()=>{},goToPreviousWeek:()=>{const r=e().currentWeek,s=new Date(r);s.setDate(s.getDate()-7),t({currentWeek:s})},goToNextWeek:()=>{const r=e().currentWeek,s=new Date(r);s.setDate(s.getDate()+7),t({currentWeek:s})},goToCurrentWeek:()=>{t({currentWeek:new Date})},getAssignmentsForDate:r=>e().assignments.filter(s=>s.date===r),createAssignment:async(r,s,n,a)=>{try{const i=q8.validateAssignment({shiftId:r,employeeId:s,date:n});if(i.length>0){const c={};return i.forEach(d=>{c[d.field]=d.message}),{success:!1,error:i[0].message,fieldErrors:c}}const l=await Fu.createAssignment(s,r,e().selectedStoreId||"",n,a);return l.success?{success:!0}:{success:!1,error:l.error||"Failed to create assignment"}}catch(i){return{success:!1,error:i instanceof Error?i.message:"An unexpected error occurred"}}},setSelectedStore:r=>{t({selectedStoreId:r})},openAddEmployeeModal:r=>{t({isAddEmployeeModalOpen:!0,selectedDate:r})},closeAddEmployeeModal:()=>{t({isAddEmployeeModalOpen:!1,selectedDate:""})},setAddingEmployee:r=>{t({addingEmployee:r})},showNotification:r=>{t({notification:r})},clearNotification:()=>{t({notification:null})},reset:()=>{t({shifts:[],assignments:[],employees:[],loading:!1,loadingEmployees:!1,error:null,currentWeek:new Date,selectedStoreId:null,isAddEmployeeModalOpen:!1,selectedDate:"",addingEmployee:!1,notification:null})}})),Tx=(t,e)=>{const r=ft(A=>A.shifts),s=ft(A=>A.assignments),n=ft(A=>A.employees),a=ft(A=>A.loading),i=ft(A=>A.loadingEmployees),l=ft(A=>A.error),c=ft(A=>A.currentWeek),d=ft(A=>A.selectedStoreId),u=ft(A=>A.isAddEmployeeModalOpen),h=ft(A=>A.selectedDate),f=ft(A=>A.addingEmployee),p=ft(A=>A.notification),_=ft(A=>A.loadScheduleData),v=ft(A=>A.loadEmployees),x=ft(A=>A.goToPreviousWeek),m=ft(A=>A.goToNextWeek),g=ft(A=>A.goToCurrentWeek),y=ft(A=>A.getWeekRange),w=ft(A=>A.getWeekDays),b=ft(A=>A.getAssignmentsForDate),C=ft(A=>A.createAssignment),j=ft(A=>A.setSelectedStore),I=ft(A=>A.openAddEmployeeModal),k=ft(A=>A.closeAddEmployeeModal),E=ft(A=>A.setAddingEmployee),T=ft(A=>A.showNotification),D=ft(A=>A.clearNotification);return S.useEffect(()=>{t&&e&&(_(t,e),v(t,e))},[t,e,c,_,v]),{shifts:r,assignments:s,employees:n,loading:a,loadingEmployees:i,error:l,currentWeek:c,selectedStoreId:d,isAddEmployeeModalOpen:u,selectedDate:h,addingEmployee:f,notification:p,refresh:()=>{t&&e&&_(t,e)},goToPreviousWeek:x,goToNextWeek:m,goToCurrentWeek:g,getWeekRange:y,getWeekDays:w,getAssignmentsForDate:b,createAssignment:C,setSelectedStore:j,openAddEmployeeModal:I,closeAddEmployeeModal:k,setAddingEmployee:E,showNotification:T,clearNotification:D}},U8="_pageLayout_1jdeq_6",W8="_container_1jdeq_14",G8="_header_1jdeq_22",J8="_title_1jdeq_26",K8="_subtitle_1jdeq_34",Y8="_overviewGrid_1jdeq_65",Q8="_overviewCard_1jdeq_72",Z8="_overviewIcon_1jdeq_89",X8="_overviewContent_1jdeq_100",eP="_overviewNumber_1jdeq_106",tP="_overviewLabel_1jdeq_114",rP="_storesGrid_1jdeq_123",sP="_storeCard_1jdeq_129",nP="_storeHeader_1jdeq_145",aP="_storeIcon_1jdeq_154",oP="_storeName_1jdeq_165",iP="_storeStats_1jdeq_172",lP="_employeeCount_1jdeq_178",cP="_statNumber_1jdeq_185",dP="_statLabel_1jdeq_193",uP="_storeScheduleSection_1jdeq_201",hP="_scheduleSectionTitle_1jdeq_206",fP="_scheduleInfo_1jdeq_215",mP="_shiftItem_1jdeq_221",pP="_shiftName_1jdeq_230",gP="_shiftTime_1jdeq_236",_P="_noShifts_1jdeq_241",Le={pageLayout:U8,container:W8,header:G8,title:J8,subtitle:K8,overviewGrid:Y8,overviewCard:Q8,overviewIcon:Z8,overviewContent:X8,overviewNumber:eP,overviewLabel:tP,storesGrid:rP,storeCard:sP,storeHeader:nP,storeIcon:aP,storeName:oP,storeStats:iP,employeeCount:lP,statNumber:cP,statLabel:dP,storeScheduleSection:uP,scheduleSectionTitle:hP,scheduleInfo:fP,shiftItem:mP,shiftName:pP,shiftTime:gP,noShifts:_P},yP=()=>{const t=Io(),{currentCompany:e,currentStore:r}=ht(),s=(e==null?void 0:e.company_id)||"",n=(r==null?void 0:r.store_id)||"",{shifts:a}=Tx(s,n),i=(e==null?void 0:e.stores)||[],l=i.length*8,c=d=>{t(`/employee/schedule/${d}`)};return e?o.jsxs(o.Fragment,{children:[o.jsx(Se,{activeItem:"employee"}),o.jsx("div",{className:Le.pageLayout,children:o.jsxs("div",{className:Le.container,children:[o.jsxs("div",{className:Le.header,children:[o.jsx("h1",{className:Le.title,children:"Dashboard"}),o.jsx("p",{className:Le.subtitle,children:"Overview of all stores and scheduling status"})]}),o.jsxs("div",{className:Le.overviewGrid,children:[o.jsxs("div",{className:Le.overviewCard,children:[o.jsx("div",{className:Le.overviewIcon,children:o.jsx("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M20 4H4v2h16V4zm1 10v-2l-1-5H4l-1 5v2h1v6h10v-6h4v6h2v-6h1zm-9 4H6v-4h6v4z"})})}),o.jsxs("div",{className:Le.overviewContent,children:[o.jsx("div",{className:Le.overviewNumber,children:i.length}),o.jsx("div",{className:Le.overviewLabel,children:"Total Stores"})]})]}),o.jsxs("div",{className:Le.overviewCard,children:[o.jsx("div",{className:Le.overviewIcon,children:o.jsx("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z"})})}),o.jsxs("div",{className:Le.overviewContent,children:[o.jsx("div",{className:Le.overviewNumber,children:l}),o.jsx("div",{className:Le.overviewLabel,children:"Total Employees"})]})]}),o.jsxs("div",{className:Le.overviewCard,children:[o.jsx("div",{className:Le.overviewIcon,children:o.jsx("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M19 3h-4.18C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm2 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"})})}),o.jsxs("div",{className:Le.overviewContent,children:[o.jsx("div",{className:Le.overviewNumber,children:"0"}),o.jsx("div",{className:Le.overviewLabel,children:"Total Requests"})]})]}),o.jsxs("div",{className:Le.overviewCard,children:[o.jsx("div",{className:Le.overviewIcon,children:o.jsx("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"})})}),o.jsxs("div",{className:Le.overviewContent,children:[o.jsx("div",{className:Le.overviewNumber,children:"0"}),o.jsx("div",{className:Le.overviewLabel,children:"Problems"})]})]})]}),o.jsx("div",{className:Le.storesGrid,children:i.map(d=>o.jsxs("div",{className:Le.storeCard,onClick:()=>c(d.store_id),children:[o.jsxs("div",{className:Le.storeHeader,children:[o.jsx("div",{className:Le.storeIcon,children:o.jsx("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M20 4H4v2h16V4zm1 10v-2l-1-5H4l-1 5v2h1v6h10v-6h4v6h2v-6h1zm-9 4H6v-4h6v4z"})})}),o.jsx("h3",{className:Le.storeName,children:d.store_name})]}),o.jsx("div",{className:Le.storeStats,children:o.jsxs("div",{className:Le.employeeCount,children:[o.jsx("span",{className:Le.statNumber,children:"8"}),o.jsx("span",{className:Le.statLabel,children:"EMPLOYEES"})]})}),o.jsxs("div",{className:Le.storeScheduleSection,children:[o.jsx("h4",{className:Le.scheduleSectionTitle,children:"SHIFT SCHEDULE"}),o.jsx("div",{className:Le.scheduleInfo,children:a.length>0?a.slice(0,3).map(u=>o.jsxs("div",{className:Le.shiftItem,children:[o.jsx("span",{className:Le.shiftName,children:u.shiftName}),o.jsx("span",{className:Le.shiftTime,children:u.timeRange})]},u.shiftId)):o.jsx("div",{className:Le.noShifts,children:"No shifts scheduled"})})]})]},d.store_id))})]})})]}):o.jsxs(o.Fragment,{children:[o.jsx(Se,{activeItem:"employee"}),o.jsx("div",{className:Le.pageLayout,children:o.jsxs("div",{className:Le.container,children:[o.jsx("div",{className:Le.header,children:o.jsx("h1",{className:Le.title,children:"Dashboard"})}),o.jsx(Me,{fullscreen:!0})]})})]})},vP="_modalOverlay_ejot4_6",xP="_modalContent_ejot4_30",bP="_modalHeader_ejot4_56",wP="_modalTitle_ejot4_64",SP="_closeButton_ejot4_71",jP="_closeIcon_ejot4_94",CP="_modalBody_ejot4_100",NP="_dateDisplay_ejot4_107",IP="_calendarIcon_ejot4_118",kP="_dateText_ejot4_125",EP="_dateValue_ejot4_131",TP="_modalFooter_ejot4_142",LP="_cancelButton_ejot4_150",AP="_addButton_ejot4_151",DP="_buttonIcon_ejot4_208",Ar={modalOverlay:vP,modalContent:xP,modalHeader:bP,modalTitle:wP,closeButton:SP,closeIcon:jP,modalBody:CP,dateDisplay:NP,calendarIcon:IP,dateText:kP,dateValue:EP,modalFooter:TP,cancelButton:LP,addButton:AP,buttonIcon:DP},MP=({isOpen:t,onClose:e,selectedDate:r,shifts:s,employees:n,onAddEmployee:a,loading:i=!1})=>{const[l,c]=S.useState(""),[d,u]=S.useState("");S.useEffect(()=>{t&&(c(""),u(""))},[t]);const h=s.map(y=>({value:y.shiftId,label:y.shiftName,description:y.timeRange})),f=n.map(y=>({value:y.userId,label:y.fullName,description:y.displayRole})),p=y=>new Date(y).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),_=async()=>{await a(l,d,r)},v=y=>{y.target===y.currentTarget&&!i&&e()},x=()=>o.jsx("svg",{className:Ar.closeIcon,viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"})}),m=()=>o.jsx("svg",{className:Ar.calendarIcon,viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M19,19H5V8H19M16,1V3H8V1H6V3H5C3.89,3 3,3.89 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3H18V1M17,12H12V17H17V12Z"})}),g=()=>o.jsx("svg",{className:Ar.buttonIcon,viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"})});return t?o.jsx("div",{className:Ar.modalOverlay,onClick:v,children:o.jsxs("div",{className:Ar.modalContent,children:[o.jsxs("div",{className:Ar.modalHeader,children:[o.jsx("h3",{className:Ar.modalTitle,children:"Add Employee to Shift"}),o.jsx("button",{className:Ar.closeButton,onClick:e,disabled:i,"aria-label":"Close modal",children:o.jsx(x,{})})]}),o.jsxs("div",{className:Ar.modalBody,children:[o.jsxs("div",{className:Ar.dateDisplay,children:[o.jsx(m,{}),o.jsxs("span",{className:Ar.dateText,children:["Selected Date: ",o.jsx("span",{className:Ar.dateValue,children:p(r)})]})]}),o.jsx(Ze,{id:"shift-select",label:"Select Shift",placeholder:"Choose a shift...",value:l,options:h,onChange:y=>c(y),disabled:i,fullWidth:!0,showDescriptions:!0,required:!0}),o.jsx(Ze,{id:"employee-select",label:"Select Employee",placeholder:"Choose an employee...",value:d,options:f,onChange:y=>u(y),disabled:i,fullWidth:!0,showDescriptions:!0,searchable:!0,required:!0})]}),o.jsxs("div",{className:Ar.modalFooter,children:[o.jsx("button",{className:Ar.cancelButton,onClick:e,disabled:i,children:"Cancel"}),o.jsxs("button",{className:Ar.addButton,onClick:_,disabled:i||!l||!d,children:[o.jsx(g,{}),i?"Adding...":"Add Employee"]})]})]})}):null},RP="_pageLayout_ont1h_6",PP="_container_ont1h_14",OP="_header_ont1h_22",$P="_breadcrumb_ont1h_26",FP="_title_ont1h_30",BP="_subtitle_ont1h_38",VP="_weekNavigator_ont1h_45",HP="_weekDisplay_ont1h_58",zP="_employeeSection_ont1h_67",qP="_sectionTitle_ont1h_76",UP="_employeeLoading_ont1h_83",WP="_noEmployees_ont1h_90",GP="_employeeGrid_ont1h_97",JP="_employeeCard_ont1h_103",KP="_employeeAvatar_ont1h_119",YP="_employeeInfo_ont1h_133",QP="_employeeName_ont1h_138",ZP="_employeeRole_ont1h_147",XP="_shiftLegend_ont1h_156",eO="_legendTitle_ont1h_165",tO="_legendItems_ont1h_172",rO="_legendItem_ont1h_172",sO="_legendColor_ont1h_184",nO="_legendInfo_ont1h_191",aO="_legendName_ont1h_197",oO="_legendTime_ont1h_203",iO="_scheduleSection_ont1h_209",lO="_scheduleGrid_ont1h_218",cO="_dayColumn_ont1h_224",dO="_today_ont1h_234",uO="_dayHeader_ont1h_239",hO="_dayName_ont1h_250",fO="_todayBadge_ont1h_257",mO="_assignmentList_ont1h_267",pO="_noAssignments_ont1h_275",gO="_assignmentCard_ont1h_283",_O="_assignmentName_ont1h_301",yO="_assignmentShift_ont1h_307",vO="_assignmentTime_ont1h_313",xO="_statusBadge_ont1h_319",bO="_scheduled_ont1h_330",wO="_confirmed_ont1h_335",SO="_absent_ont1h_340",jO="_addEmployeeButton_ont1h_346",CO="_addIcon_ont1h_374",NO="_emptyState_ont1h_381",IO="_emptyIcon_ont1h_390",kO="_emptyTitle_ont1h_397",EO="_emptyText_ont1h_404",TO="_loadingState_ont1h_411",LO="_spinner_ont1h_418",AO="_pulse_ont1h_1",DO="_errorContainer_ont1h_435",MO="_errorIcon_ont1h_445",RO="_errorTitle_ont1h_452",PO="_errorMessage_ont1h_459",fe={pageLayout:RP,container:PP,header:OP,breadcrumb:$P,title:FP,subtitle:BP,weekNavigator:VP,weekDisplay:HP,employeeSection:zP,sectionTitle:qP,employeeLoading:UP,noEmployees:WP,employeeGrid:GP,employeeCard:JP,employeeAvatar:KP,employeeInfo:YP,employeeName:QP,employeeRole:ZP,shiftLegend:XP,legendTitle:eO,legendItems:tO,legendItem:rO,legendColor:sO,legendInfo:nO,legendName:aO,legendTime:oO,scheduleSection:iO,scheduleGrid:lO,dayColumn:cO,today:dO,dayHeader:uO,dayName:hO,todayBadge:fO,assignmentList:mO,noAssignments:pO,assignmentCard:gO,assignmentName:_O,assignmentShift:yO,assignmentTime:vO,statusBadge:xO,scheduled:bO,confirmed:wO,absent:SO,addEmployeeButton:jO,addIcon:CO,emptyState:NO,emptyIcon:IO,emptyTitle:kO,emptyText:EO,loadingState:TO,spinner:LO,pulse:AO,errorContainer:DO,errorIcon:MO,errorTitle:RO,errorMessage:PO},OO=()=>{const{storeId:t}=Z2(),e=Io(),{currentCompany:r,currentUser:s}=ht(),n=(r==null?void 0:r.company_id)||"",a=t||"",i=(s==null?void 0:s.user_id)||"",{shifts:l,employees:c,loading:d,loadingEmployees:u,error:h,refresh:f,goToPreviousWeek:p,goToNextWeek:_,goToCurrentWeek:v,getAssignmentsForDate:x,getWeekDays:m,createAssignment:g,isAddEmployeeModalOpen:y,selectedDate:w,addingEmployee:b,notification:C,openAddEmployeeModal:j,closeAddEmployeeModal:I,setAddingEmployee:k,showNotification:E,clearNotification:T}=Tx(n,a),N=((r==null?void 0:r.stores)||[]).find(M=>M.store_id===a),A=(N==null?void 0:N.store_name)||"Store",$=()=>{e("/employee/schedule")},z=async(M,R,ie)=>{k(!0);try{if(!i){E({variant:"error",title:"Authentication Error",message:"You must be logged in to add employees to shifts"});return}const Z=await g(M,R,ie,i);if(!Z.success){E({variant:"error",title:"Failed to Add Employee",message:Z.error||"Failed to add employee to shift"});return}E({variant:"success",title:"Success",message:"Employee successfully added to shift"}),I(),f()}catch(Z){E({variant:"error",title:"Unexpected Error",message:Z instanceof Error?Z.message:"An unexpected error occurred"})}finally{k(!1)}},H=()=>{const M=m();if(M.length===0)return"";const R=new Date(M[0]),ie=new Date(M[M.length-1]);return`${R.toLocaleDateString("en-US",{month:"short",day:"numeric"})} - ${ie.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}`},L=M=>new Date(M).toLocaleDateString("en-US",{weekday:"short",month:"numeric",day:"numeric"}),B=M=>{const R=new Date().toISOString().split("T")[0];return M===R};if(!r||!t)return o.jsxs(o.Fragment,{children:[o.jsx(Se,{activeItem:"employee"}),o.jsx("div",{className:fe.pageLayout,children:o.jsxs("div",{className:fe.container,children:[o.jsx("div",{className:fe.header,children:o.jsx("h1",{className:fe.title,children:"Employee Schedule"})}),o.jsx(Me,{fullscreen:!0})]})})]});if(d)return o.jsxs(o.Fragment,{children:[o.jsx(Se,{activeItem:"employee"}),o.jsx("div",{className:fe.pageLayout,children:o.jsxs("div",{className:fe.container,children:[o.jsxs("div",{className:fe.header,children:[o.jsx("div",{className:fe.breadcrumb,children:o.jsx(Ne,{variant:"ghost",size:"sm",onClick:$,children:" Back to Dashboard"})}),o.jsxs("h1",{className:fe.title,children:[A," - Schedule"]})]}),o.jsx(Me,{fullscreen:!0})]})})]});if(h)return o.jsxs(o.Fragment,{children:[o.jsx(Se,{activeItem:"employee"}),o.jsx("div",{className:fe.pageLayout,children:o.jsxs("div",{className:fe.container,children:[o.jsxs("div",{className:fe.header,children:[o.jsx("div",{className:fe.breadcrumb,children:o.jsx(Ne,{variant:"ghost",size:"sm",onClick:$,children:" Back to Dashboard"})}),o.jsxs("h1",{className:fe.title,children:[A," - Schedule"]})]}),o.jsx(Me,{fullscreen:!0})]})}),o.jsx($e,{variant:"error",title:"Failed to Load Schedule",message:h,isOpen:!0,onClose:$,confirmText:"Try Again",onConfirm:f})]});const O=m();return o.jsxs(o.Fragment,{children:[o.jsx(Se,{activeItem:"employee"}),o.jsx("div",{className:fe.pageLayout,children:o.jsxs("div",{className:fe.container,children:[o.jsx("div",{className:fe.header,children:o.jsxs("div",{children:[o.jsx("div",{className:fe.breadcrumb,children:o.jsx(Ne,{variant:"ghost",size:"sm",onClick:$,children:" Back to Dashboard"})}),o.jsxs("h1",{className:fe.title,children:[A," - Schedule"]}),o.jsx("p",{className:fe.subtitle,children:"Manage work shifts and assignments"})]})}),o.jsxs("div",{className:fe.weekNavigator,children:[o.jsx(Ne,{variant:"outline",size:"sm",onClick:p,children:" Previous Week"}),o.jsx("div",{className:fe.weekDisplay,children:H()}),o.jsx(Ne,{variant:"outline",size:"sm",onClick:_,children:"Next Week "}),o.jsx(Ne,{variant:"outline",size:"sm",onClick:v,children:"This Week"})]}),l.length>0&&o.jsxs("div",{className:fe.shiftLegend,children:[o.jsx("h3",{className:fe.legendTitle,children:"Shifts"}),o.jsx("div",{className:fe.legendItems,children:l.map(M=>o.jsxs("div",{className:fe.legendItem,children:[o.jsx("div",{className:fe.legendColor,style:{backgroundColor:M.color}}),o.jsxs("div",{className:fe.legendInfo,children:[o.jsx("span",{className:fe.legendName,children:M.shiftName}),o.jsx("span",{className:fe.legendTime,children:M.timeRange})]})]},M.shiftId))})]}),o.jsx("div",{className:fe.scheduleSection,children:O.length===0?o.jsxs("div",{className:fe.emptyState,children:[o.jsxs("svg",{className:fe.emptyIcon,width:"120",height:"120",viewBox:"0 0 120 120",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[o.jsx("circle",{cx:"60",cy:"60",r:"50",fill:"#F0F6FF"}),o.jsx("rect",{x:"30",y:"35",width:"60",height:"55",rx:"6",fill:"white",stroke:"#0064FF",strokeWidth:"2"}),o.jsx("rect",{x:"30",y:"35",width:"60",height:"15",rx:"6",fill:"#0064FF"}),o.jsx("rect",{x:"30",y:"43",width:"60",height:"7",fill:"#0064FF"}),o.jsx("circle",{cx:"42",cy:"35",r:"3",fill:"white"}),o.jsx("circle",{cx:"60",cy:"35",r:"3",fill:"white"}),o.jsx("circle",{cx:"78",cy:"35",r:"3",fill:"white"}),o.jsx("line",{x1:"37",y1:"58",x2:"47",y2:"58",stroke:"#E9ECEF",strokeWidth:"2",strokeLinecap:"round"}),o.jsx("line",{x1:"52",y1:"58",x2:"62",y2:"58",stroke:"#E9ECEF",strokeWidth:"2",strokeLinecap:"round"}),o.jsx("line",{x1:"67",y1:"58",x2:"77",y2:"58",stroke:"#E9ECEF",strokeWidth:"2",strokeLinecap:"round"}),o.jsx("line",{x1:"37",y1:"68",x2:"47",y2:"68",stroke:"#E9ECEF",strokeWidth:"2",strokeLinecap:"round"}),o.jsx("line",{x1:"52",y1:"68",x2:"62",y2:"68",stroke:"#E9ECEF",strokeWidth:"2",strokeLinecap:"round"}),o.jsx("line",{x1:"67",y1:"68",x2:"77",y2:"68",stroke:"#E9ECEF",strokeWidth:"2",strokeLinecap:"round"}),o.jsx("line",{x1:"37",y1:"78",x2:"47",y2:"78",stroke:"#E9ECEF",strokeWidth:"2",strokeLinecap:"round"}),o.jsx("line",{x1:"52",y1:"78",x2:"62",y2:"78",stroke:"#0064FF",strokeWidth:"3",strokeLinecap:"round"}),o.jsx("line",{x1:"67",y1:"78",x2:"77",y2:"78",stroke:"#E9ECEF",strokeWidth:"2",strokeLinecap:"round"}),o.jsx("circle",{cx:"60",cy:"95",r:"14",fill:"#0064FF"}),o.jsx("path",{d:"M60 88 Q60 85 63 85 Q66 85 66 88 Q66 91 63 93 L60 95",stroke:"white",strokeWidth:"2.5",fill:"none",strokeLinecap:"round"}),o.jsx("circle",{cx:"60",cy:"99",r:"1.5",fill:"white"})]}),o.jsx("h3",{className:fe.emptyTitle,children:"No Schedule Available"}),o.jsx("p",{className:fe.emptyText,children:"No schedule data for the selected week"})]}):o.jsx("div",{className:fe.scheduleGrid,children:O.map(M=>{const R=x(M),ie=B(M);return o.jsxs("div",{className:`${fe.dayColumn} ${ie?fe.today:""}`,children:[o.jsxs("div",{className:fe.dayHeader,children:[o.jsx("div",{className:fe.dayName,children:L(M)}),ie&&o.jsx("span",{className:fe.todayBadge,children:"Today"})]}),o.jsxs("div",{className:fe.assignmentList,children:[R.length===0?o.jsx("div",{className:fe.noAssignments,children:"No shifts"}):o.jsx(o.Fragment,{children:R.map(Z=>o.jsxs("div",{className:fe.assignmentCard,style:{borderLeftColor:Z.shift.color},children:[o.jsx("div",{className:fe.assignmentName,children:Z.fullName||"Unknown Employee"}),o.jsx("div",{className:fe.assignmentShift,children:Z.shift.shiftName}),o.jsx("div",{className:fe.assignmentTime,children:Z.shift.timeRange}),o.jsx("span",{className:`${fe.statusBadge} ${fe[Z.status]}`,children:Z.status})]},Z.assignmentId))}),o.jsxs("button",{className:fe.addEmployeeButton,onClick:()=>j(M),children:[o.jsxs("svg",{className:fe.addIcon,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),o.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),o.jsx("span",{children:"Add Employee"})]})]})]},M)})})}),o.jsxs("div",{className:fe.employeeSection,children:[o.jsxs("h3",{className:fe.sectionTitle,children:["Employees (",c.length,")"]}),u?o.jsx(Me,{}):c.length===0?o.jsx("div",{className:fe.noEmployees,children:"No employees found for this store"}):o.jsx("div",{className:fe.employeeGrid,children:c.map(M=>o.jsxs("div",{className:fe.employeeCard,children:[o.jsx("div",{className:fe.employeeAvatar,children:M.initials}),o.jsxs("div",{className:fe.employeeInfo,children:[o.jsx("div",{className:fe.employeeName,children:M.fullName}),o.jsx("div",{className:fe.employeeRole,children:M.displayRole})]})]},M.userId))})]}),o.jsx(MP,{isOpen:y,onClose:I,selectedDate:w,shifts:l,employees:c,onAddEmployee:z,loading:b}),C&&o.jsx($e,{variant:C.variant,title:C.title,message:C.message,isOpen:!0,onClose:T})]})})]})};class $O{async getEmployees(e,r){try{const s=se.getClient(),n={p_company_id:e};r&&(n.p_store_id=r);const{data:a,error:i}=await s.rpc("get_employee_info",n);return i?(console.error("Employee RPC error:",i),{success:!1,error:i.message||"Failed to fetch employees"}):a?{success:!0,data:a}:{success:!1,error:"No data returned from employees"}}catch(s){return console.error("Employee datasource error:",s),{success:!1,error:s instanceof Error?s.message:"Unknown error occurred"}}}async createEmployee(e){return{success:!1,error:"Not implemented yet"}}async updateEmployee(e,r){return{success:!1,error:"Not implemented yet"}}async deleteEmployee(e){return{success:!1,error:"Not implemented yet"}}async updateEmployeeSalary(e,r,s,n){try{const a=se.getClient(),{error:i}=await a.rpc("update_user_salary",{p_salary_id:e,p_salary_amount:r,p_salary_type:s,p_currency_id:n});return i?(console.error("Update salary RPC error:",i),{success:!1,error:i.message||"Failed to update salary"}):{success:!0}}catch(a){return console.error("Update salary datasource error:",a),{success:!1,error:a instanceof Error?a.message:"Unknown error occurred"}}}async getCurrencies(e){try{const r=se.getClient(),{data:s,error:n}=await r.from("company_currency").select(`
          currency_id,
          currency_types (
            currency_id,
            currency_code,
            currency_name,
            symbol
          )
        `).eq("company_id",e).order("currency_types(currency_code)");return n?(console.error("Get currencies error:",n),{success:!1,error:n.message||"Failed to fetch currencies"}):s?{success:!0,data:(s||[]).map(i=>{const l=i.currency_types;return l?{currency_id:l.currency_id,currency_code:l.currency_code,currency_name:l.currency_name,currency_symbol:l.symbol}:null}).filter(i=>i!==null)}:{success:!1,error:"No data returned from currencies"}}catch(r){return console.error("Get currencies datasource error:",r),{success:!1,error:r instanceof Error?r.message:"Unknown error occurred"}}}}class Em{constructor(e,r,s,n,a,i,l,c,d,u,h,f,p,_,v,x,m,g,y,w=null,b=null){this.userId=e,this.fullName=r,this.email=s,this.roleId=n,this.roleIds=a,this.roleName=i,this.roleNames=l,this.storeId=c,this.storeIds=d,this.storeName=u,this.storeNames=h,this.salaryAmount=f,this.salaryType=p,this.currencyId=_,this.currencyCode=v,this.currencySymbol=x,this.salaryId=m,this.companyId=g,this.accountId=y,this.profileImage=w,this.userRoleId=b}get initials(){return this.fullName.charAt(0).toUpperCase()}get formattedSalary(){return`${this.currencyCode}${this.salaryAmount.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})}`}get salaryTypeLabel(){return this.salaryType==="hourly"?"per hour":"per month"}get isActive(){return!0}get hasMultipleRoles(){return this.roleIds.length>1}get hasMultipleStores(){return this.storeIds.length>1}get displayRole(){return this.hasMultipleRoles?`${this.roleName} +${this.roleIds.length-1}`:this.roleName}get displayStore(){return this.hasMultipleStores?`${this.storeName} +${this.storeIds.length-1}`:this.storeName}static create(e){return new Em(e.user_id,e.full_name,e.email,e.role_id,e.role_ids||[],e.role_name||"No role assigned",e.role_names||[],e.store_id,e.store_ids||[],e.store_name||"No store assigned",e.store_names||[],e.salary_amount||0,e.salary_type||"monthly",e.currency_id,e.currency_code,e.currency_symbol,e.salary_id,e.company_id,e.account_id,e.profile_image||null,e.user_role_id||null)}}class Ln{constructor(e,r,s){this.totalEmployees=e,this.totalRoles=r,this.totalStores=s}static create(e){return new Ln(e.total_employees||0,e.total_roles||0,e.total_stores||0)}static empty(){return new Ln(0,0,0)}}class Z_{static fromSupabase(e){const r=e.role_ids||[],s=e.role_names||[],n=e.stores||[],a=n.map(p=>p.store_id),i=n.map(p=>p.store_name),l=r.length>0?r[0]:null,c=s.length>0?s[0]:"No role assigned",d=a.length>0?a[0]:null,u=i.length>0?i[0]:"No store assigned",h={KRW:"",USD:"$",EUR:"",JPY:"",CNY:""},f=e.currency_code?h[e.currency_code]||e.currency_code:"";return Em.create({user_id:e.user_id,full_name:e.full_name,email:e.email,role_id:l,role_ids:r,role_name:c,role_names:s,store_id:d,store_ids:a,store_name:u,store_names:i,salary_amount:e.salary_amount||0,currency_id:e.currency_id,currency_code:e.currency_code,currency_symbol:f,user_role_id:null,salary_type:e.salary_type||"monthly",salary_id:e.salary_id||"",company_id:e.company_id,account_id:e.account_id||""})}static calculateStats(e){const r=new Set,s=new Set;return e.forEach(n=>{n.roleIds.forEach(a=>{a&&r.add(a)}),n.storeIds.forEach(a=>{a&&s.add(a)})}),Ln.create({total_employees:e.length,total_roles:r.size,total_stores:s.size})}}class Lx{constructor(){W(this,"dataSource");this.dataSource=new $O}async getEmployees(e){try{const r=await this.dataSource.getEmployees(e.companyId,e.storeId);if(!r.success||!r.data)return{success:!1,error:r.error||"Failed to fetch employees"};let s=r.data.map(a=>Z_.fromSupabase(a));if(e.searchQuery&&e.searchQuery.trim()!==""){const a=e.searchQuery.toLowerCase();s=s.filter(i=>i.fullName.toLowerCase().includes(a)||i.email.toLowerCase().includes(a)||i.roleName.toLowerCase().includes(a))}const n=Z_.calculateStats(s);return{success:!0,employees:s,stats:n}}catch(r){return{success:!1,error:r instanceof Error?r.message:"An unexpected error occurred"}}}async getEmployeeById(e){return null}async createEmployee(e){return await this.dataSource.createEmployee(e)}async updateEmployee(e,r){return await this.dataSource.updateEmployee(e,r)}async deleteEmployee(e){return await this.dataSource.deleteEmployee(e)}async updateEmployeeSalary(e,r,s,n){return await this.dataSource.updateEmployeeSalary(e,r,s,n)}async getCurrencies(e){const r=await this.dataSource.getCurrencies(e);return!r.success||!r.data?[]:r.data}}const FO=new Lx,Lt=er((t,e)=>({employees:[],stats:Ln.empty(),loading:!1,error:null,isEditModalOpen:!1,selectedEmployee:null,deleteConfirm:null,searchQuery:"",storeFilter:null,get filteredEmployees(){const{employees:r,searchQuery:s,storeFilter:n}=e();let a=[...r];if(n&&(a=a.filter(i=>i.storeId===n)),s.trim()){const i=s.toLowerCase();a=a.filter(l=>l.fullName.toLowerCase().includes(i)||l.email.toLowerCase().includes(i)||l.displayRole.toLowerCase().includes(i))}return a},setEmployees:r=>t({employees:r}),setStats:r=>t({stats:r}),setLoading:r=>t({loading:r}),setError:r=>t({error:r}),openEditModal:r=>{const s=e().employees.find(n=>n.userId===r);s&&t({selectedEmployee:{userId:s.userId,fullName:s.fullName,email:s.email,roleName:s.displayRole,storeName:s.displayStore,salaryType:s.salaryType,salaryAmount:s.salaryAmount,currencyId:s.currencyId,currencyCode:s.currencyCode,salaryId:s.salaryId,companyId:s.companyId,accountId:s.accountId,initials:s.initials},isEditModalOpen:!0})},closeEditModal:()=>{t({isEditModalOpen:!1,selectedEmployee:null})},openDeleteConfirm:r=>{const s=e().employees.find(n=>n.userId===r);s&&t({deleteConfirm:{userId:s.userId,name:s.fullName}})},closeDeleteConfirm:()=>{t({deleteConfirm:null})},setSearchQuery:r=>{t({searchQuery:r})},setStoreFilter:r=>{t({storeFilter:r})},loadEmployees:async r=>{t({loading:!0,error:null});try{const{storeFilter:s,searchQuery:n}=e(),a=await FO.getEmployees({companyId:r,storeId:s,searchQuery:n});if(!a.success){t({error:a.error||"Failed to load employees",employees:[],stats:Ln.empty()});return}t({employees:a.employees||[],stats:a.stats||Ln.empty(),error:null})}catch(s){t({error:s instanceof Error?s.message:"An unexpected error occurred",employees:[],stats:Ln.empty()})}finally{t({loading:!1})}},refreshEmployees:async()=>{var s;const r=e();if(r.employees.length>0){const n=(s=r.employees[0])==null?void 0:s.companyId;n&&await e().loadEmployees(n)}},deleteEmployee:async r=>{const{deleteConfirm:s}=e();if(!s)return{success:!1,error:"No employee selected for deletion"};t({loading:!0,error:null});try{return console.log("Delete employee:",s.userId),e().closeDeleteConfirm(),await e().refreshEmployees(),{success:!0}}catch(n){const a=n instanceof Error?n.message:"Failed to delete employee";return t({error:a}),{success:!1,error:a}}finally{t({loading:!1})}}})),BO=()=>{const t=Lt(j=>j.employees),e=Lt(j=>j.stats),r=Lt(j=>j.loading),s=Lt(j=>j.error),n=Lt(j=>j.isEditModalOpen),a=Lt(j=>j.selectedEmployee),i=Lt(j=>j.deleteConfirm),l=Lt(j=>j.searchQuery),c=Lt(j=>j.storeFilter),d=Lt(j=>j.filteredEmployees),u=Lt(j=>j.setEmployees),h=Lt(j=>j.setStats),f=Lt(j=>j.setLoading),p=Lt(j=>j.setError),_=Lt(j=>j.openEditModal),v=Lt(j=>j.closeEditModal),x=Lt(j=>j.openDeleteConfirm),m=Lt(j=>j.closeDeleteConfirm),g=Lt(j=>j.setSearchQuery),y=Lt(j=>j.setStoreFilter),w=Lt(j=>j.loadEmployees),b=Lt(j=>j.refreshEmployees),C=Lt(j=>j.deleteEmployee);return{employees:t,stats:e,loading:r,error:s,isEditModalOpen:n,selectedEmployee:a,deleteConfirm:i,searchQuery:l,storeFilter:c,filteredEmployees:d,setEmployees:u,setStats:h,setLoading:f,setError:p,openEditModal:_,closeEditModal:v,openDeleteConfirm:x,closeDeleteConfirm:m,setSearchQuery:g,setStoreFilter:y,loadEmployees:w,refreshEmployees:b,deleteEmployee:C}},VO="_card_vy0i7_6",HO="_header_vy0i7_26",zO="_body_vy0i7_33",qO="_actions_vy0i7_38",UO="_actionButton_vy0i7_44",WO="_avatarContainer_vy0i7_76",GO="_avatar_vy0i7_76",JO="_info_vy0i7_95",KO="_name_vy0i7_100",YO="_role_vy0i7_110",QO="_store_vy0i7_117",ZO="_statusBadge_vy0i7_126",XO="_statusDot_vy0i7_140",e$="_details_vy0i7_148",t$="_salaryContainer_vy0i7_156",r$="_salaryLabel_vy0i7_162",s$="_salaryAmount_vy0i7_171",n$="_salaryType_vy0i7_179",tr={card:VO,header:HO,body:zO,actions:qO,actionButton:UO,avatarContainer:WO,avatar:GO,info:JO,name:KO,role:YO,store:QO,statusBadge:ZO,statusDot:XO,details:e$,salaryContainer:t$,salaryLabel:r$,salaryAmount:s$,salaryType:n$},a$=({userId:t,fullName:e,roleName:r,storeName:s,formattedSalary:n,salaryTypeLabel:a,initials:i,isActive:l,onEdit:c,onDelete:d})=>o.jsxs("div",{className:tr.card,children:[o.jsxs("div",{className:tr.header,children:[o.jsx("div",{className:tr.avatarContainer,children:o.jsx("div",{className:tr.avatar,children:i})}),o.jsx("div",{className:tr.body,children:o.jsxs("div",{className:tr.info,children:[o.jsx("h3",{className:tr.name,children:e}),o.jsx("p",{className:tr.role,children:r}),o.jsxs("p",{className:tr.store,children:[o.jsx("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"currentColor",style:{opacity:.6},children:o.jsx("circle",{cx:"7",cy:"7",r:"7"})}),s]}),l&&o.jsxs("div",{className:tr.statusBadge,children:[o.jsx("span",{className:tr.statusDot}),"Active"]})]})}),o.jsxs("div",{className:tr.actions,children:[c&&o.jsx("button",{className:tr.actionButton,onClick:()=>c(t),title:"Edit employee","aria-label":"Edit employee",children:o.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor",children:o.jsx("path",{d:"M11.013 1.427a1.75 1.75 0 0 1 2.474 0l1.086 1.086a1.75 1.75 0 0 1 0 2.474l-8.61 8.61c-.21.21-.47.364-.756.445l-3.251.93a.75.75 0 0 1-.927-.928l.929-3.25a1.75 1.75 0 0 1 .445-.758l8.61-8.61Zm.176 4.823L9.75 4.81l-6.286 6.287a.253.253 0 0 0-.064.108l-.558 1.953 1.953-.558a.253.253 0 0 0 .108-.064Z"})})}),d&&o.jsx("button",{className:tr.actionButton,onClick:()=>d(t),title:"Delete employee","aria-label":"Delete employee",children:o.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor",children:o.jsx("path",{d:"M11 1.75V3h2.25a.75.75 0 0 1 0 1.5H2.75a.75.75 0 0 1 0-1.5H5V1.75C5 .784 5.784 0 6.75 0h2.5C10.216 0 11 .784 11 1.75ZM4.496 6.675l.66 6.6a.25.25 0 0 0 .249.225h5.19a.25.25 0 0 0 .249-.225l.66-6.6a.75.75 0 0 1 1.492.149l-.66 6.6A1.748 1.748 0 0 1 10.595 15h-5.19a1.75 1.75 0 0 1-1.741-1.575l-.66-6.6a.75.75 0 1 1 1.492-.15ZM6.5 1.75V3h3V1.75a.25.25 0 0 0-.25-.25h-2.5a.25.25 0 0 0-.25.25Z"})})})]})]}),o.jsx("div",{className:tr.details,children:o.jsxs("div",{className:tr.salaryContainer,children:[o.jsx("div",{className:tr.salaryLabel,children:"Salary"}),o.jsx("div",{className:tr.salaryAmount,children:n}),o.jsx("div",{className:tr.salaryType,children:a})]})})]});class ho{static validateSalaryAmount(e){return isNaN(e)?{isValid:!1,error:"Please enter a valid salary amount"}:e<0?{isValid:!1,error:"Salary amount cannot be negative"}:e===0?{isValid:!1,error:"Salary amount must be greater than 0"}:e>1e9?{isValid:!1,error:"Salary amount exceeds maximum limit (1,000,000,000)"}:{isValid:!0}}static validateCurrencyId(e){return!e||e.trim()===""?{isValid:!1,error:"Please select a currency"}:/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e)?{isValid:!0}:{isValid:!1,error:"Invalid currency ID format"}}static validateSalaryType(e){return!e||e.trim()===""?{isValid:!1,error:"Please select a salary type"}:["monthly","hourly"].includes(e)?{isValid:!0}:{isValid:!1,error:'Invalid salary type. Must be "monthly" or "hourly"'}}static validateEmail(e){return!e||e.trim()===""?{isValid:!1,error:"Email is required"}:/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)?{isValid:!0}:{isValid:!1,error:"Invalid email format"}}static validateFullName(e){return!e||e.trim()===""?{isValid:!1,error:"Full name is required"}:e.trim().length<2?{isValid:!1,error:"Full name must be at least 2 characters"}:e.length>100?{isValid:!1,error:"Full name must not exceed 100 characters"}:{isValid:!0}}static validateSalaryUpdate(e,r,s){const n=ho.validateSalaryAmount(e);if(!n.isValid)return n;const a=ho.validateCurrencyId(r);if(!a.isValid)return a;const i=ho.validateSalaryType(s);return i.isValid?{isValid:!0}:i}static validateSalaryId(e){return!e||e.trim()===""?{isValid:!1,error:"Salary ID is required"}:/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e)?{isValid:!0}:{isValid:!1,error:"Invalid salary ID format"}}}const o$="_overlay_1fjb7_7",i$="_modal_1fjb7_21",l$="_header_1fjb7_31",c$="_title_1fjb7_38",d$="_closeButton_1fjb7_45",u$="_body_1fjb7_65",h$="_employeeInfo_1fjb7_70",f$="_avatarLarge_1fjb7_81",m$="_employeeHeader_1fjb7_96",p$="_employeeName_1fjb7_100",g$="_employeeEmail_1fjb7_107",_$="_infoGrid_1fjb7_114",y$="_infoItem_1fjb7_121",v$="_infoLabel_1fjb7_128",x$="_infoValue_1fjb7_138",b$="_editSection_1fjb7_145",w$="_sectionTitle_1fjb7_152",S$="_formGroup_1fjb7_160",j$="_formLabel_1fjb7_168",C$="_salaryTypeToggle_1fjb7_177",N$="_toggleOption_1fjb7_185",I$="_active_1fjb7_206",k$="_toggleIcon_1fjb7_212",E$="_inputWrapper_1fjb7_218",T$="_currencySymbol_1fjb7_238",L$="_formInput_1fjb7_245",A$="_salaryPeriod_1fjb7_259",D$="_footer_1fjb7_267",M$="_cancelButton_1fjb7_275",R$="_saveButton_1fjb7_276",Fe={overlay:o$,modal:i$,header:l$,title:c$,closeButton:d$,body:u$,employeeInfo:h$,avatarLarge:f$,employeeHeader:m$,employeeName:p$,employeeEmail:g$,infoGrid:_$,infoItem:y$,infoLabel:v$,infoValue:x$,editSection:b$,sectionTitle:w$,formGroup:S$,formLabel:j$,salaryTypeToggle:C$,toggleOption:N$,active:I$,toggleIcon:k$,inputWrapper:E$,currencySymbol:T$,formInput:L$,salaryPeriod:A$,footer:D$,cancelButton:M$,saveButton:R$},P$=({isOpen:t,onClose:e,employee:r,onSave:s})=>{const[n,a]=S.useState("monthly"),[i,l]=S.useState(""),[c,d]=S.useState(""),[u,h]=S.useState([]),[f,p]=S.useState(!1),[_,v]=S.useState(null),[x,m]=S.useState(null),g=new Lx;S.useEffect(()=>{t&&r&&(async()=>{try{if(!(r!=null&&r.companyId))return;const k=await g.getCurrencies(r.companyId);h(k)}catch(k){console.error("Error loading currencies:",k)}})()},[t,r,g]),S.useEffect(()=>{r&&t&&(a(r.salaryType||"monthly"),l(r.currencyId||""),d(y(r.salaryAmount||0)))},[r,t]);const y=I=>I.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),w=I=>{const k=I.target.value.replace(/,/g,"");/^\d*$/.test(k)&&d(y(parseInt(k)||0))},b=()=>{const I=u.find(k=>k.currency_id===i);return(I==null?void 0:I.currency_symbol)||"$"},C=()=>n==="monthly"?"per month":"per hour",j=async()=>{if(!r)return;const I=parseFloat(c.replace(/,/g,""))||0,k=ho.validateSalaryUpdate(I,i,n);if(!k.isValid){v({title:"Validation Error",message:k.error||"Invalid salary information"});return}const E=ho.validateSalaryId(r.salaryId);if(!E.isValid){v({title:"Validation Error",message:E.error||"Invalid salary ID"});return}p(!0);try{const T=await g.updateEmployeeSalary(r.salaryId,I,n,i);if(!T.success){v({title:"Update Failed",message:T.error||"Failed to update employee salary. Please try again."});return}m("Employee salary updated successfully!"),setTimeout(()=>{m(null),s(),e()},1500)}catch(T){console.error("Error updating salary:",T),v({title:"Unexpected Error",message:T instanceof Error?T.message:"An unexpected error occurred. Please try again."})}finally{p(!1)}};return!t||!r?null:o.jsxs(o.Fragment,{children:[o.jsx("div",{className:Fe.overlay,onClick:e,children:o.jsxs("div",{className:Fe.modal,onClick:I=>I.stopPropagation(),children:[o.jsxs("div",{className:Fe.header,children:[o.jsx("h2",{className:Fe.title,children:"Edit Employee"}),o.jsx("button",{className:Fe.closeButton,onClick:e,children:o.jsx("svg",{width:"24",height:"24",fill:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{d:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"})})})]}),o.jsxs("div",{className:Fe.body,children:[o.jsxs("div",{className:Fe.employeeInfo,children:[o.jsx("div",{className:Fe.avatarLarge,children:r.initials}),o.jsxs("div",{className:Fe.employeeHeader,children:[o.jsx("h3",{className:Fe.employeeName,children:r.fullName}),o.jsx("p",{className:Fe.employeeEmail,children:r.email})]})]}),o.jsxs("div",{className:Fe.infoGrid,children:[o.jsxs("div",{className:Fe.infoItem,children:[o.jsx("label",{className:Fe.infoLabel,children:"ROLE"}),o.jsx("div",{className:Fe.infoValue,children:r.roleName})]}),o.jsxs("div",{className:Fe.infoItem,children:[o.jsx("label",{className:Fe.infoLabel,children:"STORE"}),o.jsx("div",{className:Fe.infoValue,children:r.storeName})]})]}),o.jsxs("div",{className:Fe.editSection,children:[o.jsx("h4",{className:Fe.sectionTitle,children:"Salary Configuration"}),o.jsxs("div",{className:Fe.formGroup,children:[o.jsx("label",{className:Fe.formLabel,children:"Salary Type"}),o.jsxs("div",{className:Fe.salaryTypeToggle,children:[o.jsxs("button",{className:`${Fe.toggleOption} ${n==="monthly"?Fe.active:""}`,onClick:()=>a("monthly"),children:[o.jsx("svg",{className:Fe.toggleIcon,width:"16",height:"16",fill:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{d:"M19,3H18V1H16V3H8V1H6V3H5C3.89,3 3,3.89 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3M19,19H5V8H19V19Z"})}),"Monthly"]}),o.jsxs("button",{className:`${Fe.toggleOption} ${n==="hourly"?Fe.active:""}`,onClick:()=>a("hourly"),children:[o.jsx("svg",{className:Fe.toggleIcon,width:"16",height:"16",fill:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{d:"M12,20A8,8 0 0,0 20,12A8,8 0 0,0 12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22C6.47,22 2,17.5 2,12A10,10 0 0,1 12,2M12.5,7V12.25L17,14.92L16.25,16.15L11,13V7H12.5Z"})}),"Hourly"]})]})]}),o.jsx(Ze,{id:"currency",label:"Currency",placeholder:"Select currency",value:i,options:u.map(I=>({value:I.currency_id,label:`${I.currency_code} - ${I.currency_name} (${I.currency_symbol})`})),onChange:I=>l(I),fullWidth:!0,searchable:!0}),o.jsxs("div",{className:Fe.formGroup,children:[o.jsx("label",{className:Fe.formLabel,htmlFor:"salaryAmount",children:"Salary Amount"}),o.jsxs("div",{className:Fe.inputWrapper,children:[o.jsx("span",{className:Fe.currencySymbol,children:b()}),o.jsx("input",{id:"salaryAmount",type:"text",className:Fe.formInput,value:c,onChange:w,placeholder:"0"}),o.jsx("span",{className:Fe.salaryPeriod,children:C()})]})]})]})]}),o.jsxs("div",{className:Fe.footer,children:[o.jsx("button",{className:Fe.cancelButton,onClick:e,disabled:f,children:"Cancel"}),o.jsx("button",{className:Fe.saveButton,onClick:j,disabled:f,children:f?o.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:o.jsx(Me,{size:"small"})}):o.jsxs(o.Fragment,{children:[o.jsx("svg",{width:"16",height:"16",fill:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{d:"M17,3H5C3.89,3 3,3.89 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V7.5L18.5,5M19,19H5V5H16.17L19,7.83V19M12,12C10.34,12 9,13.34 9,15C9,16.66 10.34,18 12,18C13.66,18 15,16.66 15,15C15,13.34 13.66,12 12,12M6,6H15V10H6V6Z"})}),"Save Changes"]})})]})]})}),o.jsx($e,{variant:"error",title:_==null?void 0:_.title,message:(_==null?void 0:_.message)||"",isOpen:!!_,onClose:()=>v(null),zIndex:10001}),o.jsx($e,{variant:"success",title:"Success",message:x||"",isOpen:!!x,onClose:()=>m(null),autoCloseDuration:1500,zIndex:10001})]})},O$="_pageLayout_95q8u_7",$$="_container_95q8u_16",F$="_header_95q8u_23",B$="_title_95q8u_27",V$="_statsContainer_95q8u_35",H$="_statCard_95q8u_39",z$="_statIcon_95q8u_51",q$="_statContent_95q8u_64",U$="_statLabel_95q8u_70",W$="_statValue_95q8u_78",G$="_filterSection_95q8u_87",J$="_employeeSection_95q8u_93",K$="_sectionHeader_95q8u_98",Y$="_sectionTitleContainer_95q8u_107",Q$="_sectionIcon_95q8u_113",Z$="_sectionTitle_95q8u_107",X$="_memberCount_95q8u_124",e9="_employeeGrid_95q8u_134",t9="_emptyState_95q8u_142",r9="_emptyIcon_95q8u_154",s9="_emptyTitle_95q8u_161",n9="_emptyText_95q8u_168",a9="_errorContainer_95q8u_200",o9="_errorIcon_95q8u_213",i9="_errorTitle_95q8u_220",l9="_errorMessage_95q8u_227",c9="_retryButton_95q8u_234",Pe={pageLayout:O$,container:$$,header:F$,title:B$,statsContainer:V$,statCard:H$,statIcon:z$,statContent:q$,statLabel:U$,statValue:W$,filterSection:G$,employeeSection:J$,sectionHeader:K$,sectionTitleContainer:Y$,sectionIcon:Q$,sectionTitle:Z$,memberCount:X$,employeeGrid:e9,emptyState:t9,emptyIcon:r9,emptyTitle:s9,emptyText:n9,errorContainer:a9,errorIcon:o9,errorTitle:i9,errorMessage:l9,retryButton:c9},d9=()=>{const{currentCompany:t}=ht(),e=(t==null?void 0:t.company_id)||"",{employees:r,stats:s,loading:n,error:a,isEditModalOpen:i,selectedEmployee:l,deleteConfirm:c,storeFilter:d,openEditModal:u,closeEditModal:h,openDeleteConfirm:f,closeDeleteConfirm:p,setStoreFilter:_,loadEmployees:v,refreshEmployees:x,deleteEmployee:m}=BO();if(S.useEffect(()=>{e&&v(e)},[e,v]),!e)return o.jsxs(o.Fragment,{children:[o.jsx(Se,{activeItem:"employee"}),o.jsx("div",{className:Pe.pageLayout,children:o.jsxs("div",{className:Pe.container,children:[o.jsx("div",{className:Pe.header,children:o.jsx("h1",{className:Pe.title,children:"Team Management"})}),o.jsxs("div",{className:Pe.errorContainer,children:[o.jsxs("svg",{className:Pe.errorIcon,width:"120",height:"120",viewBox:"0 0 120 120",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[o.jsx("circle",{cx:"60",cy:"60",r:"50",fill:"#FFEFED"}),o.jsx("circle",{cx:"60",cy:"60",r:"30",fill:"#FF5847"}),o.jsx("path",{d:"M60 45 L60 65",stroke:"white",strokeWidth:"4",strokeLinecap:"round"}),o.jsx("circle",{cx:"60",cy:"73",r:"2.5",fill:"white"}),o.jsx("rect",{x:"40",y:"25",width:"40",height:"50",rx:"4",fill:"white",stroke:"#FF5847",strokeWidth:"2"})]}),o.jsx("h2",{className:Pe.errorTitle,children:"No Company Selected"}),o.jsx("p",{className:Pe.errorMessage,children:"Please select a company to view employees"})]})]})})]});const g=I=>{u(I)},y=()=>{h()},w=()=>{x()},b=I=>{f(I)},C=async()=>{c&&await m(e)},j=(t==null?void 0:t.stores)||[];return n?o.jsxs(o.Fragment,{children:[o.jsx(Se,{activeItem:"employee"}),o.jsx("div",{className:Pe.pageLayout,children:o.jsxs("div",{className:Pe.container,children:[o.jsx("div",{className:Pe.header,children:o.jsx("h1",{className:Pe.title,children:"Team Management"})}),o.jsx(Me,{fullscreen:!0,size:"large"})]})})]}):a?o.jsxs(o.Fragment,{children:[o.jsx(Se,{activeItem:"employee"}),o.jsx("div",{className:Pe.pageLayout,children:o.jsxs("div",{className:Pe.container,children:[o.jsx("div",{className:Pe.header,children:o.jsx("h1",{className:Pe.title,children:"Team Management"})}),o.jsxs("div",{className:Pe.errorContainer,children:[o.jsxs("svg",{className:Pe.errorIcon,width:"120",height:"120",viewBox:"0 0 120 120",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[o.jsx("circle",{cx:"60",cy:"60",r:"50",fill:"#FFEFED"}),o.jsx("circle",{cx:"60",cy:"60",r:"30",fill:"#FF5847"}),o.jsx("path",{d:"M60 45 L60 65",stroke:"white",strokeWidth:"4",strokeLinecap:"round"}),o.jsx("circle",{cx:"60",cy:"73",r:"2.5",fill:"white"}),o.jsx("rect",{x:"40",y:"25",width:"40",height:"50",rx:"4",fill:"white",stroke:"#FF5847",strokeWidth:"2"})]}),o.jsx("h2",{className:Pe.errorTitle,children:"Failed to Load Employees"}),o.jsx("p",{className:Pe.errorMessage,children:a}),o.jsx("button",{onClick:x,className:Pe.retryButton,children:"Try Again"})]})]})})]}):o.jsxs(o.Fragment,{children:[o.jsx(Se,{activeItem:"employee"}),o.jsx("div",{className:Pe.pageLayout,children:o.jsxs("div",{className:Pe.container,children:[o.jsx("div",{className:Pe.header,children:o.jsx("h1",{className:Pe.title,children:"Team Management"})}),o.jsx("div",{className:Pe.statsContainer,children:o.jsxs("div",{className:Pe.statCard,children:[o.jsx("div",{className:Pe.statIcon,children:o.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z"})})}),o.jsxs("div",{className:Pe.statContent,children:[o.jsx("div",{className:Pe.statLabel,children:"TOTAL EMPLOYEES"}),o.jsx("div",{className:Pe.statValue,children:s.totalEmployees})]})]})}),o.jsx("div",{className:Pe.filterSection,children:o.jsx(ds,{stores:j,selectedStoreId:d,onStoreSelect:_,companyId:e,width:"100%"})}),o.jsxs("div",{className:Pe.employeeSection,children:[o.jsxs("div",{className:Pe.sectionHeader,children:[o.jsxs("div",{className:Pe.sectionTitleContainer,children:[o.jsx("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"currentColor",className:Pe.sectionIcon,children:o.jsx("path",{d:"M13 6a3 3 0 11-6 0 3 3 0 016 0zM18 8a2 2 0 11-4 0 2 2 0 014 0zM14 15a4 4 0 00-8 0v3h8v-3zM6 8a2 2 0 11-4 0 2 2 0 014 0zM16 18v-3a5.972 5.972 0 00-.75-2.906A3.005 3.005 0 0119 15v3h-3zM4.75 12.094A5.973 5.973 0 004 15v3H1v-3a3 3 0 013.75-2.906z"})}),o.jsx("h2",{className:Pe.sectionTitle,children:"Team Members"})]}),o.jsxs("div",{className:Pe.memberCount,children:[r.length," members"]})]}),r.length===0?o.jsxs("div",{className:Pe.emptyState,children:[o.jsxs("svg",{className:Pe.emptyIcon,width:"120",height:"120",viewBox:"0 0 120 120",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[o.jsx("circle",{cx:"60",cy:"60",r:"50",fill:"#F0F6FF"}),o.jsx("circle",{cx:"60",cy:"45",r:"15",fill:"white",stroke:"#0064FF",strokeWidth:"2"}),o.jsx("path",{d:"M35 85 Q35 65 60 65 Q85 65 85 85 L85 95 Q85 100 80 100 L40 100 Q35 100 35 95 Z",fill:"white",stroke:"#0064FF",strokeWidth:"2"}),o.jsx("circle",{cx:"80",cy:"80",r:"18",fill:"#0064FF"}),o.jsx("circle",{cx:"80",cy:"80",r:"8",fill:"none",stroke:"white",strokeWidth:"2.5"}),o.jsx("line",{x1:"85",y1:"85",x2:"91",y2:"91",stroke:"white",strokeWidth:"2.5",strokeLinecap:"round"})]}),o.jsx("h3",{className:Pe.emptyTitle,children:"No Employees Found"}),o.jsx("p",{className:Pe.emptyText,children:d?"No employees found for the selected store":"No employees found in this company"})]}):o.jsx("div",{className:Pe.employeeGrid,children:r.map(I=>o.jsx(a$,{userId:I.userId,fullName:I.fullName,email:I.email,roleName:I.displayRole,storeName:I.displayStore,formattedSalary:I.formattedSalary,salaryTypeLabel:I.salaryTypeLabel,initials:I.initials,isActive:I.isActive,onEdit:g,onDelete:b},I.userId))})]}),o.jsx(P$,{isOpen:i,onClose:y,employee:l,onSave:w}),o.jsx($e,{variant:"warning",title:"Confirm Delete",message:`Are you sure you want to delete ${c==null?void 0:c.name}? This action cannot be undone.`,isOpen:!!c,onClose:p,showCancelButton:!0,confirmText:"Delete",cancelText:"Cancel",onConfirm:C})]})})]})};class Ni{static validateCompanyId(e){const r=[];return!e||e.trim()===""?(r.push({field:"companyId",message:"Company ID is required"}),{isValid:!1,errors:r}):(/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e)||r.push({field:"companyId",message:"Invalid company ID format"}),{isValid:r.length===0,errors:r})}static validateStoreId(e){const r=[];return e===null||e===""?{isValid:!0,errors:r}:(/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e)||r.push({field:"storeId",message:"Invalid store ID format"}),{isValid:r.length===0,errors:r})}static validateDateFormat(e,r){const s=[];if(!e||e.trim()==="")return s.push({field:r,message:`${r} is required`}),{isValid:!1,errors:s};if(!/^\d{4}-(0[1-9]|1[0-2])-(0[1-9]|[12]\d|3[01])$/.test(e))return s.push({field:r,message:`Invalid ${r} format. Expected YYYY-MM-DD`}),{isValid:!1,errors:s};const a=new Date(e);return isNaN(a.getTime())&&s.push({field:r,message:`Invalid ${r}`}),{isValid:s.length===0,errors:s}}static validateDateRange(e,r){const s=[],n=this.validateDateFormat(e,"fromDate"),a=this.validateDateFormat(r,"toDate");if(n.isValid||s.push(...n.errors),a.isValid||s.push(...a.errors),s.length>0)return{isValid:!1,errors:s};const i=new Date(e),l=new Date(r);return i>l&&s.push({field:"dateRange",message:"From date must be before or equal to date"}),Math.abs((l.getTime()-i.getTime())/(1e3*60*60*24))>366&&s.push({field:"dateRange",message:"Date range cannot exceed 12 months"}),{isValid:s.length===0,errors:s}}static validateStatementType(e){const r=[];return!e||e.trim()===""?(r.push({field:"type",message:"Income statement type is required"}),{isValid:!1,errors:r}):(["monthly","12month"].includes(e)||r.push({field:"type",message:'Invalid income statement type. Must be "monthly" or "12month"'}),{isValid:r.length===0,errors:r})}static validateQuery(e,r,s,n,a){const i=[],l=this.validateCompanyId(e);l.isValid||i.push(...l.errors);const c=this.validateStoreId(r);c.isValid||i.push(...c.errors);const d=this.validateDateRange(s,n);d.isValid||i.push(...d.errors);const u=this.validateStatementType(a);if(u.isValid||i.push(...u.errors),a==="12month"&&d.isValid){const h=new Date(s),f=new Date(n),p=(f.getFullYear()-h.getFullYear())*12+(f.getMonth()-h.getMonth());(p<11||p>12)&&i.push({field:"dateRange",message:"12-month view requires a date range of approximately 12 months"})}return{isValid:i.length===0,errors:i}}}const u9="_filterContainer_wsz6m_3",h9="_filterHeader_wsz6m_13",f9="_filterTitle_wsz6m_21",m9="_filterContent_wsz6m_34",p9="_filterRow_wsz6m_38",g9="_filterField_wsz6m_46",_9="_filterLabel_wsz6m_54",y9="_dateInput_wsz6m_62",v9="_filterActions_wsz6m_93",jr={filterContainer:u9,filterHeader:h9,filterTitle:f9,filterContent:m9,filterRow:p9,filterField:g9,filterLabel:_9,dateInput:y9,filterActions:v9},X_=()=>{const t=new Date,e=new Date(t.getFullYear(),t.getMonth(),1);return re.toDateOnly(e)},ey=()=>{const t=new Date,e=new Date(t.getFullYear(),t.getMonth()+1,0);return re.toDateOnly(e)},x9=({onSearch:t,onClear:e,className:r=""})=>{const{currentCompany:s}=ht(),n=(s==null?void 0:s.stores)||[],{messageState:a,closeMessage:i,showWarning:l}=Ps(),[c,d]=S.useState(null),[u,h]=S.useState("monthly"),[f,p]=S.useState(X_()),[_,v]=S.useState(ey()),x=[{value:"monthly",label:"Monthly"},{value:"12month",label:"12-Month View"}],m=()=>{var b,C,j;const y=Ni.validateDateRange(f,_);if(!y.isValid){l({title:"Invalid Date Range",message:((b=y.errors[0])==null?void 0:b.message)||"Invalid date range",confirmText:"OK"});return}if(c){const I=Ni.validateStoreId(c);if(!I.isValid){l({title:"Invalid Store",message:((C=I.errors[0])==null?void 0:C.message)||"Invalid store ID",confirmText:"OK"});return}}const w=Ni.validateStatementType(u);if(!w.isValid){l({title:"Invalid Type",message:((j=w.errors[0])==null?void 0:j.message)||"Invalid statement type",confirmText:"OK"});return}t({store:c,type:u,fromDate:f,toDate:_})},g=()=>{d(null),h("monthly"),p(X_()),v(ey()),e==null||e()};return S.useEffect(()=>{g()},[s==null?void 0:s.company_id]),o.jsxs("div",{className:`${jr.filterContainer} ${r}`,children:[o.jsx("div",{className:jr.filterHeader,children:o.jsxs("div",{className:jr.filterTitle,children:[o.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"})}),o.jsx("span",{children:"Search Income Statement"})]})}),o.jsxs("div",{className:jr.filterContent,children:[o.jsxs("div",{className:jr.filterRow,children:[o.jsxs("div",{className:jr.filterField,children:[o.jsx("label",{className:jr.filterLabel,children:"STORE"}),o.jsx(ds,{stores:n,selectedStoreId:c,onStoreSelect:d,showAllStoresOption:!0,width:"100%"})]}),o.jsxs("div",{className:jr.filterField,children:[o.jsx("label",{className:jr.filterLabel,children:"TYPE"}),o.jsx(Ze,{id:"income-type-filter",name:"type",placeholder:"Select type",value:u,options:x,onChange:y=>h(y),fullWidth:!0})]}),o.jsxs("div",{className:jr.filterField,children:[o.jsx("label",{className:jr.filterLabel,children:"FROM DATE"}),o.jsx("input",{type:"date",className:jr.dateInput,value:f,onChange:y=>p(y.target.value),disabled:u==="12month"})]}),o.jsxs("div",{className:jr.filterField,children:[o.jsx("label",{className:jr.filterLabel,children:"TO DATE"}),o.jsx("input",{type:"date",className:jr.dateInput,value:_,onChange:y=>v(y.target.value),disabled:u==="12month"})]})]}),o.jsxs("div",{className:jr.filterActions,children:[o.jsx(Ne,{onClick:g,variant:"secondary",children:"Clear All"}),o.jsxs(Ne,{onClick:m,variant:"primary",children:[o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("circle",{cx:"11",cy:"11",r:"8"}),o.jsx("path",{d:"m21 21-4.35-4.35"})]}),"Search"]})]})]}),o.jsx($e,{variant:a.variant,title:a.title,message:a.message,isOpen:a.isOpen,onClose:i,confirmText:a.confirmText||"OK"})]})};class b9{async getMonthlyIncomeStatement(e,r,s,n){const a=se.getClient(),i={p_company_id:e,p_store_id:r||null,p_start_date:s,p_end_date:n};console.log(" [DataSource] Calling get_income_statement_v2 RPC with params:",i);const{data:l,error:c}=await a.rpc("get_income_statement_v2",i);if(c)throw console.error(" [DataSource] Error fetching monthly income statement:",c),new Error(c.message);return console.log(" [DataSource] Monthly income statement data received:",l),l}async get12MonthIncomeStatement(e,r,s,n){const a=se.getClient(),i={p_company_id:e,p_store_id:r||null,p_start_date:s,p_end_date:n};console.log(" [DataSource] Calling get_income_statement_monthly RPC with params:",i);const{data:l,error:c}=await a.rpc("get_income_statement_monthly",i);if(c)throw console.error(" [DataSource] Error fetching 12-month income statement:",c),new Error(c.message);return console.log(" [DataSource] 12-month income statement data received:",l),l}async getCompanyCurrency(e){const r=se.getClient();try{const{data:s,error:n}=await r.from("companies").select("base_currency_id").eq("company_id",e).single();if(n||!(s!=null&&s.base_currency_id))return console.log("No base currency found, using default"),"$";const{data:a,error:i}=await r.from("currency_types").select("currency_code, currency_name, symbol").eq("currency_id",s.base_currency_id).single();return i||!(a!=null&&a.symbol)?(console.log("No currency symbol found, using default"),"$"):(console.log("Using company currency:",a),a.symbol)}catch(s){return console.error("Error in getCompanyCurrency:",s),"$"}}}class ty{static fromMonthlyRpcResponse(e){if(!Array.isArray(e))throw console.error(" [Model] Invalid RPC response format: expected array, got",typeof e),new Error("Invalid monthly income statement data format");if(e.length===0)return console.warn(" [Model] Empty RPC response received"),[];try{const r=e.map((s,n)=>!s||typeof s!="object"?(console.warn(` [Model] Invalid section at index ${n}:`,s),{section:"Unknown Section",section_total:0,subcategories:[]}):{section:s.section||`Unknown Section ${n+1}`,section_total:this.parseNumber(s.section_total,0),subcategories:this.mapSubcategories(s.subcategories||[])});return console.log(" [Model] Successfully mapped monthly income statement data"),r}catch(r){throw console.error(" [Model] Error mapping monthly RPC response:",r),new Error("Failed to map monthly income statement data")}}static from12MonthRpcResponse(e){var r,s,n,a,i,l;if(!e||typeof e!="object")throw console.error(" [Model] Invalid 12-month RPC response format:",typeof e),new Error("Invalid 12-month income statement data format");if(!e.sections||!Array.isArray(e.sections))throw console.error(" [Model] Missing or invalid sections in 12-month data"),new Error("Invalid 12-month income statement data: missing sections");if(!e.months||!Array.isArray(e.months))throw console.error(" [Model] Missing or invalid months in 12-month data"),new Error("Invalid 12-month income statement data: missing months");try{const c={summary:{period_info:{start_date:((s=(r=e.summary)==null?void 0:r.period_info)==null?void 0:s.start_date)||"",end_date:((a=(n=e.summary)==null?void 0:n.period_info)==null?void 0:a.end_date)||"",store_scope:((l=(i=e.summary)==null?void 0:i.period_info)==null?void 0:l.store_scope)||"all_stores"}},months:e.months,sections:e.sections.map((d,u)=>!d||typeof d!="object"?(console.warn(` [Model] Invalid section at index ${u}:`,d),{section:"Unknown Section",section_total:0,section_monthly_totals:{},subcategories:[]}):{section:d.section||`Unknown Section ${u+1}`,section_total:this.parseNumber(d.section_total,0),section_monthly_totals:d.section_monthly_totals||{},subcategories:this.mapSubcategories(d.subcategories||[])})};return console.log(" [Model] Successfully mapped 12-month income statement data"),c}catch(c){throw console.error(" [Model] Error mapping 12-month RPC response:",c),new Error("Failed to map 12-month income statement data")}}static mapSubcategories(e){return Array.isArray(e)?e.map((r,s)=>!r||typeof r!="object"?(console.warn(` [Model] Invalid subcategory at index ${s}:`,r),{subcategory:"",subcategory_total:0,accounts:[]}):{subcategory:r.subcategory||"",subcategory_total:this.parseNumber(r.subcategory_total,0),subcategory_monthly_totals:r.subcategory_monthly_totals||{},accounts:this.mapAccounts(r.accounts||[])}):(console.warn(" [Model] Invalid subcategories format, expected array"),[])}static mapAccounts(e){return Array.isArray(e)?e.map((r,s)=>!r||typeof r!="object"?(console.warn(` [Model] Invalid account at index ${s}:`,r),{account_name:"Unknown Account",net_amount:0}):{account_name:r.account_name||`Unknown Account ${s+1}`,net_amount:this.parseNumber(r.net_amount,0),monthly_amounts:r.monthly_amounts||{},total:this.parseNumber(r.total,this.parseNumber(r.net_amount,0))}):(console.warn(" [Model] Invalid accounts format, expected array"),[])}static parseNumber(e,r=0){if(e==null)return r;if(typeof e=="number")return isNaN(e)?r:e;if(typeof e=="string"){const s=parseFloat(e);return isNaN(s)?r:s}return r}static validateMappedData(e,r){if(!e)return console.error(" [Model] Validation failed: data is null or undefined"),!1;if(r==="monthly"){const s=e;return Array.isArray(s)?(console.log(" [Model] Monthly data validation passed"),!0):(console.error(" [Model] Validation failed: monthly data is not an array"),!1)}else{const s=e;return!s.sections||!Array.isArray(s.sections)?(console.error(" [Model] Validation failed: 12-month data missing sections array"),!1):!s.months||!Array.isArray(s.months)?(console.error(" [Model] Validation failed: 12-month data missing months array"),!1):(console.log(" [Model] 12-month data validation passed"),!0)}}}class w9{constructor(){W(this,"dataSource");this.dataSource=new b9}async getMonthlyIncomeStatement(e,r,s,n){try{console.log(" [Repository] Getting monthly income statement");const a=await this.dataSource.getMonthlyIncomeStatement(e,r,s,n);if(!a||!Array.isArray(a)||a.length===0)return{success:!1,error:"No monthly income statement data available"};const i=ty.fromMonthlyRpcResponse(a),l=await this.dataSource.getCompanyCurrency(e);return console.log(" [Repository] Monthly income statement data processed successfully"),{success:!0,data:i,currency:l}}catch(a){return console.error(" [Repository] Error fetching monthly income statement:",a),{success:!1,error:a instanceof Error?a.message:"Failed to fetch monthly income statement"}}}async get12MonthIncomeStatement(e,r,s,n){try{console.log(" [Repository] Getting 12-month income statement");const a=await this.dataSource.get12MonthIncomeStatement(e,r,s,n);if(!a||!a.sections||!a.months)return{success:!1,error:"No 12-month income statement data available"};const i=ty.from12MonthRpcResponse(a),l=await this.dataSource.getCompanyCurrency(e);return console.log(" [Repository] 12-month income statement data processed successfully"),{success:!0,data:i,currency:l}}catch(a){return console.error(" [Repository] Error fetching 12-month income statement:",a),{success:!1,error:a instanceof Error?a.message:"Failed to fetch 12-month income statement"}}}}const ry=new w9,pr=er((t,e)=>({companyId:"",storeId:null,monthlyData:null,twelveMonthData:null,currentFilters:null,currency:"$",loading:!1,error:null,messageState:{isOpen:!1,variant:"info",title:"",message:""},setCompanyId:r=>{t({companyId:r})},setStoreId:r=>{t({storeId:r})},setCurrentFilters:r=>{t({currentFilters:r})},closeMessage:()=>{t({messageState:{isOpen:!1,variant:"info",title:"",message:""}})},loadMonthlyData:async(r,s,n,a)=>{var i,l;console.log(" [Provider] Loading monthly income statement:",{companyId:r,storeId:s,startDate:n,endDate:a}),t({loading:!0,twelveMonthData:null,error:null});try{const c=Ni.validateQuery(r,s,n,a,"monthly");if(!c.isValid){const u=c.errors.map(h=>h.message).join(", ");console.error(" [Provider] Validation failed:",c.errors),t({monthlyData:null,loading:!1,error:u,messageState:{isOpen:!0,variant:"warning",title:"Validation Error",message:u}});return}const d=await ry.getMonthlyIncomeStatement(r,s,n,a);if(!d.success){console.error(" [Provider] Repository error:",d.error);const u=((i=d.error)==null?void 0:i.includes("No"))||((l=d.error)==null?void 0:l.includes("available")),h=u?"info":"error",f=u?"No Data Available":"Error Loading Data",p=d.error||(u?"No income statement data found for the selected period.":"Failed to load income statement. Please try again.");t({monthlyData:null,loading:!1,error:d.error||"Failed to load data",messageState:{isOpen:!0,variant:h,title:f,message:p}});return}t({monthlyData:d.data||null,currency:d.currency||"$",loading:!1,error:null}),console.log(" [Provider] Monthly income statement loaded successfully")}catch(c){const d=c instanceof Error?c.message:"An unexpected error occurred";console.error(" [Provider] Error loading monthly data:",c),t({monthlyData:null,loading:!1,error:d,messageState:{isOpen:!0,variant:"error",title:"Unexpected Error",message:d}})}},load12MonthData:async(r,s,n,a)=>{var i,l;console.log(" [Provider] Loading 12-month income statement:",{companyId:r,storeId:s,startDate:n,endDate:a}),t({loading:!0,monthlyData:null,error:null});try{const c=Ni.validateQuery(r,s,n,a,"12month");if(!c.isValid){const u=c.errors.map(h=>h.message).join(", ");console.error(" [Provider] Validation failed:",c.errors),t({twelveMonthData:null,loading:!1,error:u,messageState:{isOpen:!0,variant:"warning",title:"Validation Error",message:u}});return}const d=await ry.get12MonthIncomeStatement(r,s,n,a);if(!d.success){console.error(" [Provider] Repository error:",d.error);const u=((i=d.error)==null?void 0:i.includes("No"))||((l=d.error)==null?void 0:l.includes("available")),h=u?"info":"error",f=u?"No Data Available":"Error Loading Data",p=d.error||(u?"No income statement data found for the selected period.":"Failed to load income statement. Please try again.");t({twelveMonthData:null,loading:!1,error:d.error||"Failed to load data",messageState:{isOpen:!0,variant:h,title:f,message:p}});return}t({twelveMonthData:d.data||null,currency:d.currency||"$",loading:!1,error:null}),console.log(" [Provider] 12-month income statement loaded successfully")}catch(c){const d=c instanceof Error?c.message:"An unexpected error occurred";console.error(" [Provider] Error loading 12-month data:",c),t({twelveMonthData:null,loading:!1,error:d,messageState:{isOpen:!0,variant:"error",title:"Unexpected Error",message:d}})}},clearData:()=>{console.log(" [Provider] Clearing income statement data"),t({monthlyData:null,twelveMonthData:null,currentFilters:null,currency:"$",error:null})},reset:()=>{console.log(" [Provider] Resetting income statement state"),t({companyId:"",storeId:null,monthlyData:null,twelveMonthData:null,currentFilters:null,currency:"$",loading:!1,error:null,messageState:{isOpen:!1,variant:"info",title:"",message:""}})}})),S9=()=>{const t=pr(m=>m.companyId),e=pr(m=>m.storeId),r=pr(m=>m.monthlyData),s=pr(m=>m.twelveMonthData),n=pr(m=>m.currentFilters),a=pr(m=>m.currency),i=pr(m=>m.loading),l=pr(m=>m.error),c=pr(m=>m.messageState),d=pr(m=>m.setCompanyId),u=pr(m=>m.setStoreId),h=pr(m=>m.setCurrentFilters),f=pr(m=>m.closeMessage),p=pr(m=>m.loadMonthlyData),_=pr(m=>m.load12MonthData),v=pr(m=>m.clearData),x=pr(m=>m.reset);return{companyId:t,storeId:e,monthlyData:r,twelveMonthData:s,currentFilters:n,currency:a,loading:i,error:l,messageState:c,setCompanyId:d,setStoreId:u,setCurrentFilters:h,closeMessage:f,loadMonthlyData:p,load12MonthData:_,clearData:v,reset:x}},j9="_pageLayout_18s5b_6",C9="_container_18s5b_14",N9="_pageHeader_18s5b_20",I9="_pageTitle_18s5b_24",k9="_pageSubtitle_18s5b_31",E9="_filterSection_18s5b_38",T9="_contentSection_18s5b_42",L9="_contentWrapper_18s5b_46",A9="_summaryCards_18s5b_56",D9="_summaryCard_18s5b_56",M9="_revenue_18s5b_78",R9="_profit_18s5b_82",P9="_operating_18s5b_86",O9="_net_18s5b_90",$9="_cardLabel_18s5b_94",F9="_cardValue_18s5b_103",B9="_cardPercent_18s5b_112",V9="_tableContainer_18s5b_119",H9="_tableHeader_18s5b_123",z9="_tableTitle_18s5b_127",q9="_periodInfo_18s5b_134",U9="_incomeTable_18s5b_140",W9="_descriptionColumn_18s5b_158",G9="_amountColumn_18s5b_162",J9="_currencyNote_18s5b_167",K9="_sectionRow_18s5b_175",Y9="_sectionHeader_18s5b_181",Q9="_cogs_18s5b_205",Z9="_expenses_18s5b_217",X9="_ebitda_18s5b_237",eF="_sectionName_18s5b_243",tF="_sectionTotal_18s5b_250",rF="_subcategoryRow_18s5b_260",sF="_subsectionHeader_18s5b_264",nF="_subcategoryName_18s5b_280",aF="_subcategoryTotal_18s5b_287",oF="_accountRow_18s5b_309",iF="_accountName_18s5b_317",lF="_accountAmount_18s5b_337",cF="_horizontalScroll_18s5b_349",dF="_monthlyTable_18s5b_354",uF="_monthColumn_18s5b_385",hF="_totalColumn_18s5b_389",fF="_table12Month_18s5b_396",mF="_totalRow_18s5b_514",pF="_totalLabel_18s5b_528",gF="_totalAmount_18s5b_533",_F="_sectionTotalLabel_18s5b_556",yF="_sectionTotalAmount_18s5b_562",vF="_sectionAmount_18s5b_656",xF="_subcategoryAmount_18s5b_695",bF="_ratiosSection_18s5b_772",wF="_ratiosTitle_18s5b_777",SF="_ratiosGrid_18s5b_784",jF="_ratioItem_18s5b_790",CF="_ratioCard_18s5b_799",NF="_ratioLabel_18s5b_808",IF="_ratioValue_18s5b_817",kF="_loadingState_18s5b_838",EF="_spinner_18s5b_847",TF="_spin_18s5b_847",LF="_errorState_18s5b_868",AF="_errorMessage_18s5b_878",DF="_emptyState_18s5b_888",MF="_emptyIcon_18s5b_900",RF="_emptyTitle_18s5b_912",PF="_emptyText_18s5b_919",K={pageLayout:j9,container:C9,pageHeader:N9,pageTitle:I9,pageSubtitle:k9,filterSection:E9,contentSection:T9,contentWrapper:L9,summaryCards:A9,summaryCard:D9,revenue:M9,profit:R9,operating:P9,net:O9,cardLabel:$9,cardValue:F9,cardPercent:B9,tableContainer:V9,tableHeader:H9,tableTitle:z9,periodInfo:q9,incomeTable:U9,descriptionColumn:W9,amountColumn:G9,currencyNote:J9,sectionRow:K9,sectionHeader:Y9,"cost-of-goods-sold":"_cost-of-goods-sold_18s5b_204",cogs:Q9,"gross-profit":"_gross-profit_18s5b_211",expenses:Z9,"operating-expenses":"_operating-expenses_18s5b_218","operating-income":"_operating-income_18s5b_224","net-income":"_net-income_18s5b_230",ebitda:X9,sectionName:eF,sectionTotal:tF,subcategoryRow:rF,subsectionHeader:sF,subcategoryName:nF,subcategoryTotal:aF,accountRow:oF,accountName:iF,accountAmount:lF,horizontalScroll:cF,monthlyTable:dF,monthColumn:uF,totalColumn:hF,table12Month:fF,totalRow:mF,totalLabel:pF,totalAmount:gF,sectionTotalLabel:_F,sectionTotalAmount:yF,sectionAmount:vF,subcategoryAmount:xF,ratiosSection:bF,ratiosTitle:wF,ratiosGrid:SF,ratioItem:jF,ratioCard:CF,ratioLabel:NF,ratioValue:IF,loadingState:kF,spinner:EF,spin:TF,errorState:LF,errorMessage:AF,emptyState:DF,emptyIcon:MF,emptyTitle:RF,emptyText:PF},OF=()=>{const{currentCompany:t}=ht(),{monthlyData:e,twelveMonthData:r,currentFilters:s,currency:n,loading:a,messageState:i,closeMessage:l,loadMonthlyData:c,load12MonthData:d,clearData:u,setCurrentFilters:h}=S9();S.useEffect(()=>{u()},[t==null?void 0:t.company_id,u]);const f=async w=>{if(!(t!=null&&t.company_id)){console.error("No company selected");return}h(w);const b=w.store||null;w.type==="monthly"?await c(t.company_id,b,w.fromDate,w.toDate):await d(t.company_id,b,w.fromDate,w.toDate)},p=()=>{u()},_=w=>w==null?`${n}0`:typeof w=="string"?w:`${n}${w.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})}`,v=w=>{let b=0,C=0,j=0,I=0,k=0,E=0,T=0,D=0;return w.forEach(N=>{const A=N.section.toLowerCase();A==="revenue"?b=typeof N.section_total=="number"?N.section_total:0:A==="gross profit"?C=typeof N.section_total=="number"?N.section_total:0:A==="operating income"?j=typeof N.section_total=="number"?N.section_total:0:A==="net income"?I=typeof N.section_total=="number"?N.section_total:0:A==="gross margin"?k=typeof N.section_total=="number"?N.section_total:0:A==="operating margin"?E=typeof N.section_total=="number"?N.section_total:0:A==="net margin"?T=typeof N.section_total=="number"?N.section_total:0:A==="ebitda"&&(D=typeof N.section_total=="number"?N.section_total:0)}),{revenue:b,grossProfit:C,operatingIncome:j,netIncome:I,grossMargin:k,operatingMargin:E,netMargin:T,ebitda:D}},x=w=>{if(!w)return"";const[b,C,j]=w.fromDate.split("-").map(Number),[I,k,E]=w.toDate.split("-").map(Number),T=new Date(b,C-1,j),D=new Date(I,k-1,E),N={year:"numeric",month:"short",day:"numeric"};return`${T.toLocaleDateString("en-US",N)} - ${D.toLocaleDateString("en-US",N)}`},m=w=>{const b=v(w);return o.jsxs("div",{className:K.contentWrapper,children:[o.jsxs("div",{className:K.summaryCards,children:[o.jsxs("div",{className:`${K.summaryCard} ${K.revenue}`,children:[o.jsx("div",{className:K.cardLabel,children:"TOTAL REVENUE"}),o.jsx("div",{className:K.cardValue,children:_(b.revenue)}),o.jsxs("div",{className:K.cardPercent,children:[b.grossMargin.toFixed(2),"% Gross Margin"]})]}),o.jsxs("div",{className:`${K.summaryCard} ${K.profit}`,children:[o.jsx("div",{className:K.cardLabel,children:"GROSS PROFIT"}),o.jsx("div",{className:K.cardValue,children:_(b.grossProfit)}),o.jsxs("div",{className:K.cardPercent,children:[b.operatingMargin.toFixed(2),"% Operating Margin"]})]}),o.jsxs("div",{className:`${K.summaryCard} ${K.operating}`,children:[o.jsx("div",{className:K.cardLabel,children:"OPERATING INCOME"}),o.jsx("div",{className:K.cardValue,children:_(b.operatingIncome)}),o.jsxs("div",{className:K.cardPercent,children:["EBITDA: ",_(b.ebitda)]})]}),o.jsxs("div",{className:`${K.summaryCard} ${K.net}`,children:[o.jsx("div",{className:K.cardLabel,children:"NET INCOME"}),o.jsx("div",{className:K.cardValue,children:_(b.netIncome)}),o.jsxs("div",{className:K.cardPercent,children:[b.netMargin.toFixed(2),"% Net Margin"]})]})]}),o.jsxs("div",{className:K.tableContainer,children:[o.jsxs("div",{className:K.tableHeader,children:[o.jsx("h3",{className:K.tableTitle,children:"Income Statement"}),o.jsxs("div",{className:K.periodInfo,children:["For the Period Ended ",x(s)]})]}),o.jsxs("table",{className:K.incomeTable,children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{className:K.descriptionColumn,children:"Description"}),o.jsxs("th",{className:K.amountColumn,children:["Amount",o.jsx("br",{}),o.jsxs("small",{className:K.currencyNote,children:["(in ",n,")"]})]})]})}),o.jsx("tbody",{children:w.map((C,j)=>{if(C.section.toLowerCase().includes("margin"))return null;const I=C.section.toLowerCase().replace(/ /g,"-");return o.jsxs(Kr.Fragment,{children:[o.jsx("tr",{className:`${K.sectionHeader} ${K[I]||""}`,children:o.jsx("td",{colSpan:2,children:C.section.toUpperCase()})}),C.subcategories&&C.subcategories.map((k,E)=>o.jsxs(Kr.Fragment,{children:[k.subcategory&&o.jsx("tr",{className:K.subsectionHeader,children:o.jsx("td",{colSpan:2,children:k.subcategory})}),k.accounts&&k.accounts.map((T,D)=>o.jsxs("tr",{className:K.accountRow,children:[o.jsx("td",{className:K.accountName,children:T.account_name}),o.jsx("td",{className:K.accountAmount,children:T.net_amount.toLocaleString("en-US")})]},`${j}-${E}-${D}`))]},`${j}-${E}`))]},j)})})]})]}),o.jsxs("div",{className:K.ratiosSection,children:[o.jsx("h3",{className:K.ratiosTitle,children:"Key Financial Ratios"}),o.jsxs("div",{className:K.ratiosGrid,children:[o.jsxs("div",{className:K.ratioCard,children:[o.jsx("div",{className:K.ratioLabel,children:"GROSS MARGIN"}),o.jsxs("div",{className:K.ratioValue,children:[b.grossMargin.toFixed(2),"%"]})]}),o.jsxs("div",{className:K.ratioCard,children:[o.jsx("div",{className:K.ratioLabel,children:"OPERATING MARGIN"}),o.jsxs("div",{className:K.ratioValue,children:[b.operatingMargin.toFixed(2),"%"]})]}),o.jsxs("div",{className:K.ratioCard,children:[o.jsx("div",{className:K.ratioLabel,children:"NET MARGIN"}),o.jsxs("div",{className:K.ratioValue,children:[b.netMargin.toFixed(2),"%"]})]}),o.jsxs("div",{className:K.ratioCard,children:[o.jsx("div",{className:K.ratioLabel,children:"EBITDA MARGIN"}),o.jsxs("div",{className:K.ratioValue,children:[b.revenue!==0?(b.ebitda/b.revenue*100).toFixed(2):"0.00","%"]})]})]})]})]})},g=w=>{const[b,C]=w.split("-"),j=["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"],I=parseInt(C,10)-1;return`${b} ${j[I]}`},y=w=>{var I,k,E,T;const{months:b,sections:C,summary:j}=w;return o.jsxs("div",{className:K.contentWrapper,children:[o.jsxs("div",{className:K.tableHeader,children:[o.jsx("h3",{className:K.tableTitle,children:"Income Statement - 12 Month View"}),o.jsxs("div",{className:K.periodInfo,children:["Period: ",((I=j==null?void 0:j.period_info)==null?void 0:I.start_date)||"N/A"," to ",((k=j==null?void 0:j.period_info)==null?void 0:k.end_date)||"N/A",((E=j==null?void 0:j.period_info)==null?void 0:E.store_name)&&` (${j.period_info.store_name})`,!((T=j==null?void 0:j.period_info)!=null&&T.store_name)&&" (ALL STORES)"]})]}),o.jsx("div",{className:K.tableContainer,children:o.jsx("div",{className:K.horizontalScroll,children:o.jsxs("table",{className:`${K.monthlyTable} ${K.table12Month}`,children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsxs("th",{className:K.accountColumn,children:["ACCOUNT",o.jsx("br",{}),o.jsxs("small",{className:K.currencyNote,children:["(in ",n,")"]})]}),b.map((D,N)=>o.jsx("th",{className:K.monthColumn,children:g(D)},N)),o.jsx("th",{className:K.totalColumn,children:"TOTAL"})]})}),o.jsx("tbody",{children:C.map((D,N)=>{if(D.section.toLowerCase().includes("margin"))return null;const A=D.section.toLowerCase().replace(/ /g,"-");return o.jsxs(Kr.Fragment,{children:[o.jsx("tr",{className:`${K.sectionHeader} ${K[A]||""}`,children:o.jsx("td",{colSpan:b.length+2,children:D.section.toUpperCase()})}),D.subcategories&&D.subcategories.map(($,z)=>o.jsxs(Kr.Fragment,{children:[$.subcategory&&o.jsx("tr",{className:K.subsectionHeader,children:o.jsx("td",{colSpan:b.length+2,children:$.subcategory})}),$.accounts&&$.accounts.map((H,L)=>o.jsxs("tr",{className:K.accountRow,children:[o.jsx("td",{className:K.accountName,children:H.account_name}),b.map((B,O)=>{var M;return o.jsx("td",{className:K.accountAmount,children:_(((M=H.monthly_amounts)==null?void 0:M[B])||0)},O)}),o.jsx("td",{className:K.accountAmount,children:_(H.total||H.net_amount)})]},`${N}-${z}-${L}`)),$.subcategory&&o.jsxs("tr",{className:K.totalRow,children:[o.jsxs("td",{className:K.totalLabel,children:["Total ",$.subcategory]}),b.map((H,L)=>{var B;return o.jsx("td",{className:K.totalAmount,children:_(((B=$.subcategory_monthly_totals)==null?void 0:B[H])||0)},L)}),o.jsx("td",{className:K.totalAmount,children:_($.subcategory_total)})]})]},`${N}-${z}`)),o.jsxs("tr",{className:`${K.sectionTotal} ${K[A]||""}`,children:[o.jsx("td",{className:K.sectionTotalLabel,children:o.jsx("strong",{children:D.section})}),b.map(($,z)=>{var H;return o.jsx("td",{className:K.sectionTotalAmount,children:_(((H=D.section_monthly_totals)==null?void 0:H[$])||0)},z)}),o.jsx("td",{className:K.sectionTotalAmount,children:_(D.section_total)})]})]},N)})})]})})})]})};return o.jsxs(o.Fragment,{children:[o.jsx(Se,{activeItem:"finance"}),o.jsx("div",{className:K.pageLayout,children:o.jsxs("div",{className:K.container,children:[o.jsxs("div",{className:K.pageHeader,children:[o.jsx("h1",{className:K.pageTitle,children:"Income Statement"}),o.jsx("p",{className:K.pageSubtitle,children:"View revenue and expenses"})]}),o.jsx(x9,{onSearch:f,onClear:p,className:K.filterSection}),o.jsxs("div",{className:K.contentSection,children:[a&&o.jsx(Me,{fullscreen:!0,size:"large"}),!a&&!e&&!r&&o.jsxs("div",{className:K.emptyState,children:[o.jsx("div",{className:K.emptyIcon,children:o.jsxs("svg",{width:"120",height:"120",viewBox:"0 0 120 120",fill:"none",children:[o.jsx("circle",{cx:"60",cy:"60",r:"50",fill:"#F0F6FF"}),o.jsx("rect",{x:"35",y:"40",width:"50",height:"60",rx:"4",fill:"white",stroke:"#0064FF",strokeWidth:"2"}),o.jsx("rect",{x:"40",y:"35",width:"50",height:"60",rx:"4",fill:"white",stroke:"#0064FF",strokeWidth:"2"}),o.jsx("line",{x1:"48",y1:"45",x2:"75",y2:"45",stroke:"#E9ECEF",strokeWidth:"2",strokeLinecap:"round"}),o.jsx("line",{x1:"48",y1:"52",x2:"70",y2:"52",stroke:"#E9ECEF",strokeWidth:"2",strokeLinecap:"round"}),o.jsx("line",{x1:"48",y1:"59",x2:"72",y2:"59",stroke:"#E9ECEF",strokeWidth:"2",strokeLinecap:"round"}),o.jsx("circle",{cx:"60",cy:"75",r:"12",fill:"#0064FF"}),o.jsx("path",{d:"M56 75 L58 77 L64 71",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})}),o.jsx("h2",{className:K.emptyTitle,children:"Select Filters to Load Income Statement"}),o.jsx("p",{className:K.emptyText,children:"Choose Monthly type and date range, then click Search to view the income statement."})]}),!a&&e&&(s==null?void 0:s.type)==="monthly"&&m(e),!a&&r&&(s==null?void 0:s.type)==="12month"&&y(r)]}),o.jsx($e,{variant:i.variant,title:i.title,message:i.message,isOpen:i.isOpen,onClose:l})]})})]})};class $F{async getInventory(e,r,s=1,n=20,a){var u,h,f;const i=se.getClient();if(!e)return{products:[]};const l={p_company_id:e,p_store_id:r,p_page:s,p_limit:n};a&&a.trim()!==""&&(l.p_search=a.trim());const{data:c,error:d}=await i.rpc("get_inventory_page",l);if(d)throw new Error(d.message);if(c&&typeof c=="object"&&"success"in c&&c.success===!0)return{products:((u=c.data)==null?void 0:u.products)||[],currency:(h=c.data)==null?void 0:h.currency,pagination:(f=c.data)==null?void 0:f.pagination};throw new Error("Invalid response format from get_inventory_page")}async updateProduct(e,r,s,n,a){var u;const i=se.getClient(),l={p_product_id:e,p_company_id:r,p_store_id:s};(!a||n.productName!==a.productName)&&(l.p_product_name=n.productName),(!a||n.sku!==a.sku)&&(l.p_sku=n.sku),(!a||n.category!==a.categoryId)&&(l.p_category_id=n.category||null),(!a||n.brand!==a.brandId)&&(l.p_brand_id=n.brand||null),(!a||n.unit!==a.unit)&&(l.p_unit=n.unit||"piece"),(!a||n.productType!==a.productType)&&(l.p_product_type=n.productType||"commodity"),(!a||n.costPrice!==a.costPrice)&&(l.p_cost_price=n.costPrice),(!a||n.sellingPrice!==a.unitPrice)&&(l.p_selling_price=n.sellingPrice),(!a||n.currentStock!==a.currentStock)&&(l.p_new_quantity=n.currentStock),n.imageUrls!==void 0&&(l.p_image_urls=n.imageUrls||null);const{data:c,error:d}=await i.rpc("inventory_edit_product",l);return d?{success:!1,error:d.message}:c&&typeof c=="object"&&"success"in c?c.success===!0?{success:!0}:{success:!1,error:((u=c.error)==null?void 0:u.message)||"Failed to update product"}:{success:!0}}async getMetadata(e,r){const s=se.getClient(),{data:n,error:a}=await s.rpc("get_inventory_metadata",{p_company_id:e,p_store_id:r||null});if(a)throw new Error(a.message);return n}async importExcel(e,r,s,n){const a=se.getClient(),{data:i,error:l}=await a.rpc("inventory_import_excel",{p_company_id:e,p_store_id:r,p_user_id:s,p_products:n});return l?{success:!1,error:l.message}:i&&typeof i=="object"&&"success"in i?{success:i.success,summary:i.summary,errors:i.errors}:{success:!1,error:"Invalid response format from inventory_import_excel"}}async validateProductEdit(e,r,s,n,a,i){const l=se.getClient(),c={p_product_id:e,p_company_id:r};n&&n.trim()!==s&&(c.p_product_name=n.trim()),i&&i.trim()!==a&&(c.p_sku=i.trim());const{data:d,error:u}=await l.rpc("inventory_check_edit",c);return u?{success:!1,error:{code:"RPC_ERROR",message:u.message}}:d&&typeof d=="object"&&"success"in d?d:{success:!1,error:{code:"INVALID_RESPONSE",message:"Invalid response format from inventory_check_edit"}}}async moveProduct(e,r,s,n,a,i,l,c){const d=se.getClient(),{data:u,error:h}=await d.rpc("inventory_move_product",{p_company_id:e,p_from_store_id:r,p_to_store_id:s,p_items:[{product_id:n,quantity:a}],p_notes:i||null,p_time:l,p_updated_by:c});return h?{success:!1,error:h.message}:u&&typeof u=="object"&&"success"in u?u:{success:!1,error:"Invalid response format from inventory_move_product"}}async getBaseCurrency(e){const r=se.getClient(),{data:s,error:n}=await r.rpc("get_base_currency",{p_company_id:e});if(n)throw new Error(n.message);return s&&s.base_currency?{symbol:s.base_currency.symbol||"",code:s.base_currency.currency_code||"VND"}:{symbol:"",code:"VND"}}}class FF{constructor(e,r,s,n,a,i,l,c,d,u,h,f,p=null,_=null,v="",x="",m="commodity",g=0,y,w=[]){this.productId=e,this.productCode=r,this.productName=s,this.categoryName=n,this.brandName=a,this.currentStock=i,this.minStock=l,this.maxStock=c,this.unitPrice=d,this.totalValue=u,this.unit=h,this.currencySymbol=f,this.categoryId=p,this.brandId=_,this.sku=v,this.barcode=x,this.productType=m,this.costPrice=g,this.createdAt=y,this.imageUrls=w}get isLowStock(){return this.currentStock<=this.minStock}get isOverStock(){return this.currentStock>=this.maxStock}get stockStatus(){return this.isLowStock?"low":this.isOverStock?"over":"normal"}formatCurrency(e){return`${this.currencySymbol}${e.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})}`}get stockPercentage(){return this.maxStock===0?0:this.currentStock/this.maxStock*100}}class Tm{static fromJson(e,r=""){var c,d,u;const s=((c=e.stock)==null?void 0:c.quantity_on_hand)??0,n=((d=e.price)==null?void 0:d.selling)??0,a=((u=e.price)==null?void 0:u.cost)??0,i=s*n,l=e.created_at?re.toLocalSafe(e.created_at):void 0;return new FF(e.product_id,e.sku||"N/A",e.product_name||"Unknown Product",e.category_name||"Uncategorized",e.brand_name||"No Brand",s,0,0,n,i,e.unit||"piece",r,e.category_id||null,e.brand_id||null,e.sku||"",e.barcode||"",e.product_type||"commodity",a,l??void 0,e.image_urls||[])}static toJson(e){return{product_id:e.productId,sku:e.sku,barcode:e.barcode,product_name:e.productName,category_id:e.categoryId,category_name:e.categoryName,brand_id:e.brandId,brand_name:e.brandName,unit:e.unit,product_type:e.productType,stock:{quantity_on_hand:e.currentStock},price:{cost:e.costPrice,selling:e.unitPrice}}}static fromJsonArray(e,r=""){return e.map(s=>Tm.fromJson(s,r))}static toUpdateParams(e,r,s,n){return{p_product_id:e,p_company_id:r,p_store_id:s,p_sku:n.sku,p_product_name:n.productName,p_category_id:n.category||null,p_brand_id:n.brand||null,p_unit:n.unit||"piece",p_product_type:n.productType||"commodity",p_cost_price:n.costPrice,p_selling_price:n.sellingPrice,p_new_quantity:n.currentStock}}}class Ax{constructor(){W(this,"dataSource");this.dataSource=new $F}async getInventory(e,r,s=1,n=20,a){var i;try{const l=await this.dataSource.getInventory(e,r,s,n,a),c=l.products,d=((i=l.currency)==null?void 0:i.symbol)||"";return{success:!0,data:Tm.fromJsonArray(c,d),currency:l.currency,pagination:l.pagination}}catch(l){return{success:!1,error:l instanceof Error?l.message:"Failed to fetch inventory"}}}async updateProduct(e,r,s,n,a){try{return await this.dataSource.updateProduct(e,r,s,n,a)}catch(i){return{success:!1,error:i instanceof Error?i.message:"Failed to update product"}}}async getMetadata(e,r){try{const s=await this.dataSource.getMetadata(e,r);return s&&s.success&&s.data?{success:!0,data:{...s.data,last_updated:s.data.last_updated?re.toLocal(s.data.last_updated).toISOString():s.data.last_updated}}:{success:!1,error:"Invalid metadata response format"}}catch(s){return{success:!1,error:s instanceof Error?s.message:"Failed to fetch metadata"}}}async importExcel(e,r,s,n){try{return await this.dataSource.importExcel(e,r,s,n)}catch(a){return{success:!1,error:a instanceof Error?a.message:"Failed to import Excel data"}}}async validateProductEdit(e,r,s,n,a,i){try{return await this.dataSource.validateProductEdit(e,r,s,n,a,i)}catch(l){return{success:!1,error:{code:"VALIDATION_ERROR",message:l instanceof Error?l.message:"Failed to validate product edit"}}}}async moveProduct(e,r,s,n,a,i,l,c){try{return await this.dataSource.moveProduct(e,r,s,n,a,i,l,c)}catch(d){return{success:!1,error:d instanceof Error?d.message:"Failed to move product"}}}async getBaseCurrency(e){try{return await this.dataSource.getBaseCurrency(e)}catch(r){return console.error("Failed to fetch base currency:",r),{symbol:"",code:"VND"}}}}class BF{static validateProduct(e){const r=[];return!e.productName||e.productName.trim()===""?r.push({field:"productName",message:"Product name is required"}):e.productName.length>255&&r.push({field:"productName",message:"Product name must be less than 255 characters"}),e.sku&&e.sku.length>100&&r.push({field:"sku",message:"SKU must be less than 100 characters"}),e.costPrice!==void 0&&e.costPrice<0&&r.push({field:"costPrice",message:"Cost price cannot be negative"}),e.sellingPrice!==void 0&&e.sellingPrice<0&&r.push({field:"sellingPrice",message:"Selling price cannot be negative"}),e.costPrice!==void 0&&e.sellingPrice!==void 0&&e.sellingPrice<e.costPrice&&r.push({field:"sellingPrice",message:"Selling price should be higher than or equal to cost price"}),e.currentStock!==void 0&&e.currentStock<0&&r.push({field:"currentStock",message:"Current stock cannot be negative"}),e.minStock!==void 0&&e.minStock<0&&r.push({field:"minStock",message:"Minimum stock cannot be negative"}),e.maxStock!==void 0&&e.maxStock<0&&r.push({field:"maxStock",message:"Maximum stock cannot be negative"}),e.minStock!==void 0&&e.maxStock!==void 0&&e.maxStock<e.minStock&&r.push({field:"maxStock",message:"Maximum stock should be greater than or equal to minimum stock"}),e.reorderPoint!==void 0&&e.reorderPoint<0&&r.push({field:"reorderPoint",message:"Reorder point cannot be negative"}),r}static validateSearchQuery(e){const r=[];return e.length>255&&r.push({field:"search",message:"Search query must be less than 255 characters"}),r}static isValid(e){return this.validateProduct(e).length===0}}const Va=new Ax,Ae=er((t,e)=>({inventory:[],currency:{symbol:"",code:"VND"},currentPage:1,itemsPerPage:20,totalItems:0,selectedStoreId:null,searchQuery:"",selectedProducts:new Set,filterType:"newest",selectedBrandFilter:new Set,selectedCategoryFilter:new Set,isModalOpen:!1,selectedProductData:null,isAddProductModalOpen:!1,loading:!0,error:null,notification:{isOpen:!1,variant:"success",message:""},setSelectedStoreId:r=>t({selectedStoreId:r,currentPage:1}),setSearchQuery:r=>t({searchQuery:r,currentPage:1}),setCurrentPage:r=>t({currentPage:r}),toggleProductSelection:r=>t(s=>{const n=new Set(s.selectedProducts);return n.has(r)?n.delete(r):n.add(r),{selectedProducts:n}}),selectAllProducts:()=>t(r=>({selectedProducts:new Set(r.inventory.map(s=>s.productId))})),clearSelection:()=>t({selectedProducts:new Set}),setFilterType:r=>t({filterType:r,currentPage:1}),toggleBrandFilter:r=>t(s=>{const n=new Set(s.selectedBrandFilter);return n.has(r)?n.delete(r):n.add(r),{selectedBrandFilter:n,currentPage:1}}),toggleCategoryFilter:r=>t(s=>{const n=new Set(s.selectedCategoryFilter);return n.has(r)?n.delete(r):n.add(r),{selectedCategoryFilter:n,currentPage:1}}),clearBrandFilter:()=>t({selectedBrandFilter:new Set,currentPage:1}),clearCategoryFilter:()=>t({selectedCategoryFilter:new Set,currentPage:1}),clearFilter:()=>t({filterType:"newest",selectedBrandFilter:new Set,selectedCategoryFilter:new Set,currentPage:1}),openModal:r=>t({isModalOpen:!0,selectedProductData:r}),closeModal:()=>t({isModalOpen:!1,selectedProductData:null}),openAddProductModal:()=>t({isAddProductModalOpen:!0}),closeAddProductModal:()=>t({isAddProductModalOpen:!1}),showNotification:(r,s)=>t({notification:{isOpen:!0,variant:r,message:s}}),hideNotification:()=>t(r=>({notification:{...r.notification,isOpen:!1}})),setLoading:r=>t({loading:r}),setError:r=>t({error:r}),clearError:()=>t({error:null}),loadBaseCurrency:async r=>{try{const s=await Va.getBaseCurrency(r);t({currency:s})}catch(s){console.error("Failed to load base currency:",s)}},loadInventory:async(r,s,n)=>{var a,i,l,c,d,u;t({loading:!0,error:null});try{const h=e(),f=h.currentPage,p=h.itemsPerPage,_=await Va.getInventory(r,s,f,p,n||void 0);if(!_.success){t({error:_.error||"Failed to load inventory",inventory:[],loading:!1});return}((a=_.currency)!=null&&a.symbol||(i=_.currency)!=null&&i.code)&&t({currency:{symbol:((l=_.currency)==null?void 0:l.symbol)||e().currency.symbol,code:((c=_.currency)==null?void 0:c.code)||e().currency.code}});const v=((d=_.pagination)==null?void 0:d.total_count)||((u=_.pagination)==null?void 0:u.total)||0;t({inventory:_.data||[],totalItems:v,loading:!1})}catch(h){t({error:h instanceof Error?h.message:"An unexpected error occurred",inventory:[],loading:!1})}},validateProductEdit:async(r,s,n,a,i,l)=>{try{return await Va.validateProductEdit(r,s,n,a,i,l)}catch(c){return{success:!1,error:{code:"VALIDATION_ERROR",message:c instanceof Error?c.message:"Validation failed"}}}},updateProduct:async(r,s,n,a,i)=>{const l=e();if(!s||!n)return{success:!1,error:"Company ID and Store ID are required"};const c=BF.validateProduct({productName:a.productName,sku:a.sku,costPrice:a.costPrice,sellingPrice:a.sellingPrice,currentStock:a.currentStock});if(c.length>0)return{success:!1,error:c[0].message};try{const d=await Va.updateProduct(r,s,n,a,i);return d.success&&await e().loadInventory(s,n,l.searchQuery),d}catch(d){return{success:!1,error:d instanceof Error?d.message:"An unexpected error occurred"}}},importExcel:async(r,s,n,a)=>{try{return await Va.importExcel(r,s,n,a)}catch(i){return{success:!1,error:i instanceof Error?i.message:"An unexpected error occurred"}}},moveProduct:async(r,s,n,a,i,l,c,d)=>{try{const u=await Va.moveProduct(r,s,n,a,i,l,c,d);return u.success&&await e().loadInventory(r,s,e().searchQuery),u}catch(u){return{success:!1,error:u instanceof Error?u.message:"An unexpected error occurred"}}},refresh:async()=>{const r=e();await e().loadInventory("",r.selectedStoreId,r.searchQuery)}})),Dx=()=>{const t=Ae(P=>P.inventory),e=Ae(P=>P.currency),r=Ae(P=>P.currentPage),s=Ae(P=>P.itemsPerPage),n=Ae(P=>P.totalItems),a=Ae(P=>P.selectedStoreId),i=Ae(P=>P.searchQuery),l=Ae(P=>P.selectedProducts),c=Ae(P=>P.filterType),d=Ae(P=>P.selectedBrandFilter),u=Ae(P=>P.selectedCategoryFilter),h=Ae(P=>P.isModalOpen),f=Ae(P=>P.selectedProductData),p=Ae(P=>P.isAddProductModalOpen),_=Ae(P=>P.loading),v=Ae(P=>P.error),x=Ae(P=>P.notification),m=Ae(P=>P.setSelectedStoreId),g=Ae(P=>P.setSearchQuery),y=Ae(P=>P.setCurrentPage),w=Ae(P=>P.toggleProductSelection),b=Ae(P=>P.selectAllProducts),C=Ae(P=>P.clearSelection),j=Ae(P=>P.setFilterType),I=Ae(P=>P.toggleBrandFilter),k=Ae(P=>P.toggleCategoryFilter),E=Ae(P=>P.clearBrandFilter),T=Ae(P=>P.clearCategoryFilter),D=Ae(P=>P.clearFilter),N=Ae(P=>P.openModal),A=Ae(P=>P.closeModal),$=Ae(P=>P.openAddProductModal),z=Ae(P=>P.closeAddProductModal),H=Ae(P=>P.showNotification),L=Ae(P=>P.hideNotification),B=Ae(P=>P.setLoading),O=Ae(P=>P.setError),M=Ae(P=>P.clearError),R=Ae(P=>P.loadBaseCurrency),ie=Ae(P=>P.loadInventory),Z=Ae(P=>P.validateProductEdit),Ie=Ae(P=>P.updateProduct),Te=Ae(P=>P.importExcel),Ke=Ae(P=>P.moveProduct),ye=Ae(P=>P.refresh);return{inventory:t,currencySymbol:e.symbol,currencyCode:e.code,currentPage:r,itemsPerPage:s,totalItems:n,selectedStoreId:a,searchQuery:i,selectedProducts:l,filterType:c,selectedBrandFilter:d,selectedCategoryFilter:u,isModalOpen:h,selectedProductData:f,isAddProductModalOpen:p,loading:_,error:v,notification:x,setSelectedStoreId:m,setSearchQuery:g,setCurrentPage:y,toggleProductSelection:w,selectAllProducts:b,clearSelection:C,setFilterType:j,toggleBrandFilter:I,toggleCategoryFilter:k,clearBrandFilter:E,clearCategoryFilter:T,clearFilter:D,openModal:N,closeModal:A,openAddProductModal:$,closeAddProductModal:z,showNotification:H,hideNotification:L,setLoading:B,setError:O,clearError:M,loadBaseCurrency:R,loadInventory:ie,validateProductEdit:Z,updateProduct:Ie,importExcel:Te,moveProduct:Ke,refresh:ye}},VF=(t,e)=>{const[r,s]=S.useState(null),[n,a]=S.useState(!0),[i,l]=S.useState(null),c=new Ax,d=async()=>{try{a(!0),l(null);const u=await c.getMetadata(t,e);u.success&&u.data?s(u.data):l(u.error||"Failed to load metadata")}catch(u){l(u instanceof Error?u.message:"Unknown error")}finally{a(!1)}};return S.useEffect(()=>{t&&d()},[t,e]),{metadata:r,loading:n,error:i,refresh:d}};class HF{constructor(){W(this,"excelJSLoaded",!1);W(this,"excelJSLoading",null)}async loadExcelJS(){return this.excelJSLoaded?!0:this.excelJSLoading?this.excelJSLoading:(this.excelJSLoading=new Promise((e,r)=>{const s=document.createElement("script");s.src="https://cdn.jsdelivr.net/npm/exceljs@4.4.0/dist/exceljs.min.js",s.async=!0,s.onload=()=>{this.excelJSLoaded=!0,this.excelJSLoading=null,console.log(" ExcelJS loaded successfully"),e(!0)},s.onerror=()=>{this.excelJSLoading=null,console.error(" Failed to load ExcelJS"),r(new Error("Failed to load ExcelJS library"))},document.head.appendChild(s)}),this.excelJSLoading)}async exportInventoryToExcel(e,r="AllStores",s="VND"){await this.loadExcelJS();const n=window.ExcelJS;if(!n)throw new Error("ExcelJS library not loaded");const a=new n.Workbook,i=a.addWorksheet("Inventory");i.columns=[{header:"Product Code (SKU)",key:"sku",width:18},{header:"Barcode",key:"barcode",width:15},{header:"Product Name",key:"product_name",width:30},{header:"Category",key:"category",width:20},{header:"Brand",key:"brand",width:20},{header:"Unit",key:"unit",width:10},{header:`Cost Price (${s})`,key:"cost_price",width:15},{header:`Selling Price (${s})`,key:"selling_price",width:15},{header:"Current Stock",key:"current_stock",width:15},{header:"Status",key:"status",width:12},{header:"image1",key:"image1",width:50},{header:"image2",key:"image2",width:50},{header:"image3",key:"image3",width:50}],e.forEach(p=>{const _=p.imageUrls||[];i.addRow({sku:p.productCode||p.sku||"",barcode:p.barcode||"",product_name:p.productName||"",category:p.categoryName||"",brand:p.brandName||"",unit:p.unit||"piece",cost_price:p.costPrice||0,selling_price:p.unitPrice||0,current_stock:p.currentStock||0,status:p.currentStock===0?"OUT OF STOCK":p.currentStock<=5?"LOW STOCK":"IN STOCK",image1:_[0]||"",image2:_[1]||"",image3:_[2]||""})});const l=i.getRow(1);l.font={name:"Arial",size:11,bold:!0,color:{argb:"FFFFFFFF"}},l.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FF4472C4"}},l.alignment={vertical:"middle",horizontal:"center",wrapText:!1},l.height=25,l.eachCell({includeEmpty:!0},p=>{p.border={top:{style:"thin",color:{argb:"FF000000"}},left:{style:"thin",color:{argb:"FF000000"}},bottom:{style:"thin",color:{argb:"FF000000"}},right:{style:"thin",color:{argb:"FF000000"}}}}),i.eachRow((p,_)=>{_>1&&p.eachCell({includeEmpty:!0},v=>{v.border={top:{style:"thin",color:{argb:"FFD3D3D3"}},left:{style:"thin",color:{argb:"FFD3D3D3"}},bottom:{style:"thin",color:{argb:"FFD3D3D3"}},right:{style:"thin",color:{argb:"FFD3D3D3"}}};const x=i.getColumn(v.col).key;["cost_price","selling_price","current_stock"].includes(x)&&(v.alignment={horizontal:"center",vertical:"middle"})})}),i.views=[{state:"frozen",ySplit:1}];const c=new Date,d=c.getFullYear()+String(c.getMonth()+1).padStart(2,"0")+String(c.getDate()).padStart(2,"0"),u=`Inventory_${r}_${d}.xlsx`,h=await a.xlsx.writeBuffer(),f=new Blob([h],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});await this.downloadExcelFile(f,u,e.length)}async downloadExcelFile(e,r,s){let n=!1;if("showSaveFilePicker"in window&&window.isSecureContext&&!window.location.protocol.includes("file:"))try{const l=await(await window.showSaveFilePicker({suggestedName:r,types:[{description:"Excel Files",accept:{"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[".xlsx"]}}],excludeAcceptAllOption:!0})).createWritable();await l.write(e),await l.close(),n=!0,console.log(` Export successful: ${s} products exported to ${r}`)}catch(i){if(i.name==="AbortError")throw console.log(" Export cancelled by user"),new Error("Export cancelled by user");i.name==="SecurityError"||i.name,n=!1}n||this.fallbackExcelDownload(e,r)}fallbackExcelDownload(e,r){try{const s=window.URL.createObjectURL(e),n=document.createElement("a");n.href=s,n.download=r,n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(s),console.log(" Export successful (fallback): File saved to default downloads folder")}catch(s){throw console.error(" Fallback download error:",s),s}}async parseInventoryExcel(e){await this.loadExcelJS();const r=window.ExcelJS;if(!r)throw new Error("ExcelJS library not loaded");const s=new r.Workbook;await s.xlsx.load(await e.arrayBuffer());const n=s.getWorksheet(1),a=[];return n.eachRow((i,l)=>{if(l===1)return;const c={product_id:null,sku:i.getCell(1).value||null,barcode:i.getCell(2).value||null,product_name:i.getCell(3).value||"",category:i.getCell(4).value||null,brand:i.getCell(5).value||null,unit:i.getCell(6).value||"piece",cost_price:parseFloat(i.getCell(7).value)||0,selling_price:parseFloat(i.getCell(8).value)||0,current_stock:parseFloat(i.getCell(9).value)||0,status:i.getCell(10).value||"Active",image_urls:null};if(c.product_name){c.sku!==null&&(c.sku=String(c.sku).trim()),c.barcode!==null&&(c.barcode=String(c.barcode).trim()),c.product_name&&(c.product_name=String(c.product_name).trim()),c.category!==null&&(c.category=String(c.category).trim()),c.brand!==null&&(c.brand=String(c.brand).trim()),c.unit&&(c.unit=String(c.unit).toLowerCase().trim()),c.status&&(c.status=String(c.status).trim()),c.sku===""&&(c.sku=null),c.barcode===""&&(c.barcode=null),c.category===""&&(c.category=null),c.brand===""&&(c.brand=null),c.cost_price=isNaN(c.cost_price)?0:c.cost_price,c.selling_price=isNaN(c.selling_price)?0:c.selling_price,c.current_stock=isNaN(c.current_stock)?0:c.current_stock;const d=[],u=i.getCell(11).value,h=i.getCell(12).value,f=i.getCell(13).value;u&&String(u).trim()!==""&&d.push(String(u).trim()),h&&String(h).trim()!==""&&d.push(String(h).trim()),f&&String(f).trim()!==""&&d.push(String(f).trim()),c.image_urls=d.length>0?d:null,a.push(c)}}),a}}const sy=new HF,zF=({inventory:t,companyId:e,selectedStoreId:r,storeName:s,currencyCode:n,loadInventory:a,importExcel:i,showNotification:l})=>{const[c,d]=S.useState(!1),[u,h]=S.useState(!1),f=S.useRef(null);return{isExporting:c,isImporting:u,fileInputRef:f,handleExportExcel:async()=>{if(!c){d(!0);try{await sy.exportInventoryToExcel(t,s,n),l("success",`Successfully exported ${t.length} products to Excel!`)}catch(x){(x instanceof Error?x.message:"").includes("cancelled")||l("error","Failed to export inventory data. Please try again.")}finally{d(!1)}}},handleImportExcel:async x=>{var g;const m=(g=x.target.files)==null?void 0:g[0];if(m){if(x.target.value="",!m.name.endsWith(".xlsx")&&!m.name.endsWith(".xls")){l("error","Please select a valid Excel file (.xlsx or .xls)");return}try{const y=await sy.parseInventoryExcel(m);if(!y||y.length===0){l("error","No valid products found in the Excel file");return}const{data:{user:w},error:b}=await se.auth.getUser();if(b||!w){l("error","Failed to get user information. Please log in again.");return}const C=200,j=y.length;h(!0);let I=0,k=0,E=0,T=0;for(let A=0;A<Math.ceil(j/C);A++){const $=A*C,z=Math.min($+C,j),H=y.slice($,z);try{const L=await i(e,r,w.id,H);L.success&&L.summary?(I+=L.summary.created||0,k+=L.summary.updated||0,E+=L.summary.skipped||0,T+=L.summary.errors||0):T+=H.length}catch{T+=H.length}}let N=`Import completed: ${I+k+E+T} products processed.
`;N+=` Created: ${I}, Updated: ${k}, Skipped: ${E}`,T>0&&(N+=`,  Errors: ${T}`),l("success",N),await a(e,r,"")}catch{l("error","Failed to import Excel file. Please check the file format and try again.")}finally{h(!1)}}},handleImportClick:()=>{var x;(x=f.current)==null||x.click()}}},qF=({inventory:t,searchQuery:e,filterType:r,selectedBrandFilter:s,selectedCategoryFilter:n})=>{const a=S.useMemo(()=>!t||t.length===0?[]:Array.from(new Set(t.map(d=>d.brandName).filter(Boolean))).sort(),[t]),i=S.useMemo(()=>!t||t.length===0?[]:Array.from(new Set(t.map(d=>d.categoryName).filter(Boolean))).sort(),[t]),l=S.useMemo(()=>{let c=[...t];if(e.trim()){const d=e.toLowerCase().trim();c=c.filter(u=>u.productName.toLowerCase().includes(d)||u.sku.toLowerCase().includes(d))}switch(s.size>0&&(c=c.filter(d=>s.has(d.brandName||""))),n.size>0&&(c=c.filter(d=>n.has(d.categoryName))),r){case"newest":c=c.sort((d,u)=>{if(!d.createdAt&&!u.createdAt)return 0;if(!d.createdAt)return 1;if(!u.createdAt)return-1;const h=u.createdAt.getTime()-d.createdAt.getTime();return h===0?d.sku.localeCompare(u.sku):h});break;case"oldest":c=c.sort((d,u)=>!d.createdAt&&!u.createdAt?0:d.createdAt?u.createdAt?d.createdAt.getTime()-u.createdAt.getTime():-1:1);break;case"price_high":c=c.sort((d,u)=>u.unitPrice-d.unitPrice);break;case"price_low":c=c.sort((d,u)=>d.unitPrice-u.unitPrice);break;case"cost_high":c=c.sort((d,u)=>u.costPrice-d.costPrice);break;case"cost_low":c=c.sort((d,u)=>d.costPrice-u.costPrice);break}return c},[t,e,r,s,n]);return{uniqueBrands:a,uniqueCategories:i,filteredAndSortedInventory:l}},UF=({inventory:t,filteredAndSortedInventory:e,currencySymbol:r,toggleProductSelection:s,clearSelection:n,openModal:a,openAddProductModal:i,showNotification:l,statusStyles:c})=>{const d=S.useCallback(m=>{const g=m.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0});return`${r}${g}`},[r]),u=S.useCallback(m=>{m.target.checked?(n(),e.forEach(g=>{s(g.productId)})):n()},[e,s,n]),h=S.useCallback(m=>{s(m)},[s]),f=S.useCallback(m=>{const g=t.find(y=>y.productId===m);g&&a(g)},[t,a]),p=S.useCallback(()=>{l("info","Delete functionality will be implemented soon")},[l]),_=S.useCallback(()=>{i()},[i]),v=S.useCallback(m=>{const g=m.currentStock;return g===0?{class:c.statusOutOfStock,text:"OUT OF STOCK"}:g<=5?{class:c.statusLowStock,text:"LOW STOCK"}:{class:c.statusInStock,text:"IN STOCK"}},[c]),x=S.useCallback(m=>m===0?c.quantityOut:m<=5?c.quantityLow:"",[c]);return{formatCurrency:d,handleSelectAll:u,handleCheckboxChange:h,handleEditProduct:f,handleDeleteProducts:p,handleAddProduct:_,getStatusInfo:v,getQuantityClass:x}},WF="_modalOverlay_13av9_6",GF="_show_13av9_22",JF="_modalContainer_13av9_27",KF="_modalHeader_13av9_45",YF="_modalTitleSection_13av9_54",QF="_modalTitle_13av9_54",ZF="_modalSubtitle_13av9_66",XF="_closeButton_13av9_73",e7="_modalBody_13av9_95",t7="_formGroup_13av9_101",r7="_label_13av9_109",s7="_required_13av9_118",n7="_input_13av9_124",a7="_error_13av9_150",o7="_helperText_13av9_158",i7="_errorMessage_13av9_166",l7="_modalFooter_13av9_175",Gt={modalOverlay:WF,show:GF,modalContainer:JF,modalHeader:KF,modalTitleSection:YF,modalTitle:QF,modalSubtitle:ZF,closeButton:XF,modalBody:e7,formGroup:t7,label:r7,required:s7,input:n7,error:a7,helperText:o7,errorMessage:i7,modalFooter:l7},Mx=({isOpen:t,onClose:e,companyId:r,onBrandAdded:s})=>{const[n,a]=S.useState({brandName:"",brandCode:""}),[i,l]=S.useState({}),[c,d]=S.useState(!1),[u,h]=S.useState({isOpen:!1,variant:"success",message:""});S.useEffect(()=>{t&&(a({brandName:"",brandCode:""}),l({}),d(!1),h({isOpen:!1,variant:"success",message:""}))},[t]);const f=(x,m)=>{a(g=>({...g,[x]:m})),i[x]&&l(g=>({...g,[x]:""}))},p=()=>{const x={};return n.brandName.trim()||(x.brandName="Brand name is required"),l(x),Object.keys(x).length===0},_=async()=>{if(p()){d(!0);try{const{data:x,error:m}=await se.getClient().rpc("inventory_create_brand",{p_company_id:r,p_brand_name:n.brandName.trim(),p_brand_code:n.brandCode.trim()||null});if(m){console.error("Error creating brand:",m),m.message&&m.message.includes("DUPLICATE_BRAND")?h({isOpen:!0,variant:"error",message:"A brand with this name already exists"}):h({isOpen:!0,variant:"error",message:m.message||"Failed to create brand. Please try again."}),d(!1);return}h({isOpen:!0,variant:"success",message:`Brand "${n.brandName}" has been created successfully!`}),setTimeout(()=>{s&&x&&s(x),e()},1500)}catch(x){console.error("Error creating brand:",x),h({isOpen:!0,variant:"error",message:x instanceof Error?x.message:"An error occurred. Please try again."}),d(!1)}}},v=x=>{x.target===x.currentTarget&&e()};return t?o.jsxs("div",{className:`${Gt.modalOverlay} ${t?Gt.show:""}`,onClick:v,children:[o.jsxs("div",{className:Gt.modalContainer,children:[o.jsxs("div",{className:Gt.modalHeader,children:[o.jsxs("div",{className:Gt.modalTitleSection,children:[o.jsx("h2",{className:Gt.modalTitle,children:"Add New Brand"}),o.jsx("p",{className:Gt.modalSubtitle,children:"Create a new brand for your inventory"})]}),o.jsx("button",{className:Gt.closeButton,onClick:e,children:o.jsx("svg",{width:"20",height:"20",fill:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})})})]}),o.jsxs("div",{className:Gt.modalBody,children:[o.jsxs("div",{className:Gt.formGroup,children:[o.jsx("label",{className:`${Gt.label} ${Gt.required}`,children:"Brand Name"}),o.jsx("input",{type:"text",className:`${Gt.input} ${i.brandName?Gt.error:""}`,placeholder:"Enter brand name",value:n.brandName,onChange:x=>f("brandName",x.target.value),maxLength:100,autoFocus:!0}),i.brandName&&o.jsx("span",{className:Gt.errorMessage,children:i.brandName})]}),o.jsxs("div",{className:Gt.formGroup,children:[o.jsx("label",{className:Gt.label,children:"Brand Code"}),o.jsx("input",{type:"text",className:Gt.input,placeholder:"Optional - auto-generated if empty",value:n.brandCode,onChange:x=>f("brandCode",x.target.value),maxLength:50}),o.jsx("span",{className:Gt.helperText,children:"Leave empty to auto-generate from brand name"})]})]}),o.jsxs("div",{className:Gt.modalFooter,children:[o.jsx(Ne,{variant:"secondary",size:"md",onClick:e,disabled:c,children:"Cancel"}),o.jsx(Ne,{variant:"primary",size:"md",onClick:_,disabled:c,children:c?"Adding...":"Add Brand"})]})]}),o.jsx($e,{variant:u.variant,message:u.message,isOpen:u.isOpen,onClose:()=>h({...u,isOpen:!1}),autoCloseDuration:u.variant==="success"?1500:0,zIndex:1e4})]}):null},c7="_modalOverlay_ys0db_6",d7="_show_ys0db_22",u7="_modalContainer_ys0db_27",h7="_modalHeader_ys0db_45",f7="_modalTitleSection_ys0db_54",m7="_modalTitle_ys0db_54",p7="_modalSubtitle_ys0db_66",g7="_closeButton_ys0db_73",_7="_modalBody_ys0db_95",y7="_formGroup_ys0db_101",v7="_label_ys0db_109",x7="_required_ys0db_118",b7="_input_ys0db_124",w7="_error_ys0db_150",S7="_helperText_ys0db_158",j7="_errorMessage_ys0db_166",C7="_modalFooter_ys0db_175",dr={modalOverlay:c7,show:d7,modalContainer:u7,modalHeader:h7,modalTitleSection:f7,modalTitle:m7,modalSubtitle:p7,closeButton:g7,modalBody:_7,formGroup:y7,label:v7,required:x7,input:b7,error:w7,helperText:S7,errorMessage:j7,modalFooter:C7},Rx=({isOpen:t,onClose:e,companyId:r,categories:s,onCategoryAdded:n})=>{const[a,i]=S.useState({categoryName:"",parentCategoryId:""}),[l,c]=S.useState({}),[d,u]=S.useState(!1),[h,f]=S.useState({isOpen:!1,variant:"success",message:""});S.useEffect(()=>{t&&(i({categoryName:"",parentCategoryId:""}),c({}),u(!1),f({isOpen:!1,variant:"success",message:""}))},[t]);const p=(m,g)=>{i(y=>({...y,[m]:g})),l[m]&&c(y=>({...y,[m]:""}))},_=()=>{const m={};return a.categoryName.trim()||(m.categoryName="Category name is required"),c(m),Object.keys(m).length===0},v=async()=>{if(_()){u(!0);try{const{data:m,error:g}=await se.getClient().rpc("inventory_create_category",{p_company_id:r,p_category_name:a.categoryName.trim(),p_parent_category_id:a.parentCategoryId||null});if(g){console.error("Error creating category:",g),g.message&&g.message.includes("DUPLICATE_CATEGORY")?f({isOpen:!0,variant:"error",message:"A category with this name already exists at this level"}):f({isOpen:!0,variant:"error",message:g.message||"Failed to create category. Please try again."}),u(!1);return}f({isOpen:!0,variant:"success",message:`Category "${a.categoryName}" has been created successfully!`}),setTimeout(()=>{n&&m&&n(m),e()},1500)}catch(m){console.error("Error creating category:",m),f({isOpen:!0,variant:"error",message:m instanceof Error?m.message:"An error occurred. Please try again."}),u(!1)}}},x=m=>{m.target===m.currentTarget&&e()};return t?o.jsxs("div",{className:`${dr.modalOverlay} ${t?dr.show:""}`,onClick:x,children:[o.jsxs("div",{className:dr.modalContainer,children:[o.jsxs("div",{className:dr.modalHeader,children:[o.jsxs("div",{className:dr.modalTitleSection,children:[o.jsx("h2",{className:dr.modalTitle,children:"Add New Category"}),o.jsx("p",{className:dr.modalSubtitle,children:"Create a new category for your inventory"})]}),o.jsx("button",{className:dr.closeButton,onClick:e,children:o.jsx("svg",{width:"20",height:"20",fill:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})})})]}),o.jsxs("div",{className:dr.modalBody,children:[o.jsxs("div",{className:dr.formGroup,children:[o.jsx("label",{className:`${dr.label} ${dr.required}`,children:"Category Name"}),o.jsx("input",{type:"text",className:`${dr.input} ${l.categoryName?dr.error:""}`,placeholder:"Enter category name",value:a.categoryName,onChange:m=>p("categoryName",m.target.value),maxLength:100,autoFocus:!0}),l.categoryName&&o.jsx("span",{className:dr.errorMessage,children:l.categoryName})]}),o.jsxs("div",{className:dr.formGroup,children:[o.jsx(Ze,{label:"Parent Category",placeholder:"Select parent category",value:a.parentCategoryId,options:s.map(m=>({value:m.category_id,label:m.category_name,description:m.description})),onChange:m=>p("parentCategoryId",m),fullWidth:!0}),o.jsx("span",{className:dr.helperText,children:"Leave empty for top-level category"})]})]}),o.jsxs("div",{className:dr.modalFooter,children:[o.jsx(Ne,{variant:"secondary",size:"md",onClick:e,disabled:d,children:"Cancel"}),o.jsx(Ne,{variant:"primary",size:"md",onClick:v,disabled:d,children:d?"Adding...":"Add Category"})]})]}),o.jsx($e,{variant:h.variant,message:h.message,isOpen:h.isOpen,onClose:()=>f({...h,isOpen:!1}),autoCloseDuration:h.variant==="success"?1500:0,zIndex:1e4})]}):null};async function Px(t,e={}){const{quality:r=80,maxWidth:s=2e3,maxHeight:n=2e3,format:a}=e;return new Promise((i,l)=>{if(!t.type.startsWith("image/")){l(new Error("File must be an image"));return}const c=t.size,d=new FileReader;d.onload=u=>{var f;const h=new Image;h.onload=()=>{try{let{width:p,height:_}=h;if(p>s||_>n){const b=p/_;p>_?(p=s,_=p/b):(_=n,p=_*b)}const v=document.createElement("canvas");v.width=p,v.height=_;const x=v.getContext("2d");if(!x){l(new Error("Failed to get canvas context"));return}x.drawImage(h,0,0,p,_);const m=a||t.type||"image/jpeg",g=v.toDataURL(m,r/100),y=Math.round(g.length*3/4),w=y/c;i({dataUrl:g,originalSize:c,compressedSize:y,compressionRatio:w,width:Math.round(p),height:Math.round(_),format:m})}catch(p){l(new Error("Failed to compress image: "+p.message))}},h.onerror=()=>{l(new Error("Failed to load image"))},h.src=(f=u.target)==null?void 0:f.result},d.onerror=()=>{l(new Error("Failed to read file"))},d.readAsDataURL(t)})}function Ox(t,e={}){const{maxSize:r=10*1024*1024,allowedTypes:s=["image/jpeg","image/png","image/webp","image/gif"]}=e;return s.includes(t.type)?t.size>r?{valid:!1,error:`File size exceeds ${Math.round(r/1024/1024)}MB limit`}:{valid:!0}:{valid:!1,error:`Invalid file type. Allowed types: ${s.join(", ")}`}}function hd(t){if(t===0)return"0 Bytes";const e=1024,r=["Bytes","KB","MB","GB"],s=Math.floor(Math.log(t)/Math.log(e));return Math.round(t/Math.pow(e,s)*100)/100+" "+r[s]}const N7="_modalOverlay_1b9qs_5",I7="_modalContainer_1b9qs_19",k7="_modalHeader_1b9qs_32",E7="_modalTitleSection_1b9qs_40",T7="_modalTitle_1b9qs_40",L7="_modalSubtitle_1b9qs_51",A7="_closeButton_1b9qs_57",D7="_modalBody_1b9qs_79",M7="_section_1b9qs_85",R7="_sectionTitle_1b9qs_93",P7="_formGrid_1b9qs_102",O7="_formGroup_1b9qs_108",$7="_formGroupFull_1b9qs_113",F7="_label_1b9qs_117",B7="_input_1b9qs_126",V7="_imageUploadContainer_1b9qs_187",H7="_imagePreviewWrapper_1b9qs_194",z7="_imagePreview_1b9qs_194",q7="_uploadPlaceholder_1b9qs_221",U7="_uploadIcon_1b9qs_231",W7="_uploadText_1b9qs_237",G7="_uploadHint_1b9qs_243",J7="_removeImageButton_1b9qs_248",K7="_hiddenFileInput_1b9qs_271",Y7="_modalFooter_1b9qs_276",we={modalOverlay:N7,modalContainer:I7,modalHeader:k7,modalTitleSection:E7,modalTitle:T7,modalSubtitle:L7,closeButton:A7,modalBody:D7,section:M7,sectionTitle:R7,formGrid:P7,formGroup:O7,formGroupFull:$7,label:F7,input:B7,imageUploadContainer:V7,imagePreviewWrapper:H7,imagePreview:z7,uploadPlaceholder:q7,uploadIcon:U7,uploadText:W7,uploadHint:G7,removeImageButton:J7,hiddenFileInput:K7,modalFooter:Y7},Q7=({imagePreviews:t,compressionInfos:e,isCompressing:r,maxImages:s=3,onImageSelect:n,onRemoveImage:a,onImageClick:i,fileInputRef:l})=>o.jsxs("div",{className:we.section,children:[o.jsx("h3",{className:we.sectionTitle,children:"Product Images"}),o.jsxs("div",{className:we.imageUploadContainer,children:[t.map((c,d)=>o.jsxs("div",{className:we.imagePreviewWrapper,children:[o.jsx("img",{src:c,alt:`Product preview ${d+1}`,className:we.imagePreview}),o.jsx("button",{className:we.removeImageButton,onClick:u=>{u.stopPropagation(),a(d)},type:"button",children:o.jsx("svg",{width:"16",height:"16",fill:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})})})]},d)),t.length<s&&o.jsx("div",{className:we.imagePreviewWrapper,onClick:i,style:{cursor:r?"wait":"pointer"},children:o.jsx("div",{className:we.uploadPlaceholder,children:r?o.jsxs(o.Fragment,{children:[o.jsx("svg",{className:we.uploadIcon,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})}),o.jsx("span",{className:we.uploadText,children:"Compressing..."})]}):o.jsxs(o.Fragment,{children:[o.jsx("svg",{className:we.uploadIcon,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),o.jsx("span",{className:we.uploadText,children:"Add Image"}),o.jsxs("span",{className:we.uploadHint,children:[t.length,"/",s]})]})})})]}),o.jsx("input",{ref:l,type:"file",accept:"image/jpeg,image/png,image/webp",onChange:n,className:we.hiddenFileInput})]}),Z7=({formData:t,metadata:e,onInputChange:r,onAddBrand:s,onAddCategory:n})=>o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:we.section,children:[o.jsx("h3",{className:we.sectionTitle,children:"Product Information"}),o.jsxs("div",{className:we.formGrid,children:[o.jsxs("div",{className:`${we.formGroup} ${we.formGroupFull}`,children:[o.jsx("label",{className:we.label,children:"Product Name"}),o.jsx("input",{type:"text",className:we.input,value:t.productName,onChange:a=>r("productName",a.target.value),placeholder:"Enter product name"})]}),o.jsx("div",{className:we.formGroup,children:o.jsx(Ze,{label:"Category",placeholder:"Select category",value:t.category,options:(e==null?void 0:e.categories.map(a=>({value:a.category_id,label:a.category_name,description:a.description})))||[],onChange:a=>r("category",a),showAddButton:!0,addButtonText:"Add category",onAddClick:n,showDescriptions:!0,fullWidth:!0})}),o.jsx("div",{className:we.formGroup,children:o.jsx(Ze,{label:"Brand",placeholder:"Select brand",value:t.brand,options:(e==null?void 0:e.brands.map(a=>({value:a.brand_id,label:a.brand_name,description:a.description})))||[],onChange:a=>r("brand",a),showAddButton:!0,addButtonText:"Add brand",onAddClick:s,showDescriptions:!0,fullWidth:!0})}),o.jsx("div",{className:we.formGroup,children:o.jsx(Ze,{label:"Product Type",placeholder:"Select product type",value:t.productType,options:(e==null?void 0:e.product_types.map(a=>{let i=a.label;return a.value==="commodity"&&(i="Commodity"),a.value==="bundle"&&(i="Bundle/Set"),a.value==="service"&&(i="Service"),{value:a.value,label:i,description:a.description}}))||[],onChange:a=>r("productType",a),showDescriptions:!0,fullWidth:!0})}),o.jsxs("div",{className:we.formGroup,children:[o.jsx("label",{className:we.label,children:"Barcode"}),o.jsx("input",{type:"text",className:we.input,value:t.barcode,onChange:a=>r("barcode",a.target.value),placeholder:"Enter barcode"})]}),o.jsxs("div",{className:we.formGroup,children:[o.jsx("label",{className:we.label,children:"SKU"}),o.jsx("input",{type:"text",className:we.input,value:t.sku,onChange:a=>r("sku",a.target.value),placeholder:"Enter SKU"})]})]})]}),o.jsxs("div",{className:we.section,children:[o.jsx("h3",{className:we.sectionTitle,children:"Stock Information"}),o.jsxs("div",{className:we.formGrid,children:[o.jsxs("div",{className:we.formGroup,children:[o.jsx("label",{className:we.label,children:"Current Quantity"}),o.jsx("input",{type:"number",className:we.input,value:t.currentStock,onChange:a=>r("currentStock",a.target.value),placeholder:"0"})]}),o.jsx("div",{className:we.formGroup,children:o.jsx(Ze,{label:"Unit",placeholder:"Select unit",value:t.unit,options:(e==null?void 0:e.units.map(a=>({value:a.value,label:`${a.value} (${a.symbol})`,description:`${a.value} - ${a.symbol}`})))||[],onChange:a=>r("unit",a),fullWidth:!0})})]})]}),o.jsxs("div",{className:we.section,children:[o.jsx("h3",{className:we.sectionTitle,children:"Price Information"}),o.jsxs("div",{className:we.formGrid,children:[o.jsxs("div",{className:we.formGroup,children:[o.jsx("label",{className:we.label,children:"Cost Price"}),o.jsx("input",{type:"number",className:we.input,value:t.costPrice,onChange:a=>r("costPrice",a.target.value),placeholder:"0"})]}),o.jsxs("div",{className:we.formGroup,children:[o.jsx("label",{className:we.label,children:"Selling Price"}),o.jsx("input",{type:"number",className:we.input,value:t.sellingPrice,onChange:a=>r("sellingPrice",a.target.value),placeholder:"0"})]})]})]})]}),X7=({isOpen:t,onClose:e,productId:r,companyId:s,productData:n,metadata:a,onSave:i,onMetadataRefresh:l})=>{const{validateProductEdit:c}=Dx(),[d,u]=S.useState({productName:"",category:"",brand:"",productType:"Physical Product",barcode:"",sku:"",currentStock:"",unit:"",costPrice:"",sellingPrice:""}),[h,f]=S.useState(!1),[p,_]=S.useState(!1),[v,x]=S.useState(!1),[m,g]=S.useState([]),[y,w]=S.useState([]),[b,C]=S.useState(!1),[j,I]=S.useState({isOpen:!1,variant:"success",message:""}),k=S.useRef(null),E=3;S.useEffect(()=>{var H,L,B;n&&(u({productName:n.productName||"",category:n.categoryId||"",brand:n.brandId||"",productType:n.productType||"commodity",barcode:n.barcode||"",sku:n.sku||n.productCode||"",currentStock:((H=n.currentStock)==null?void 0:H.toString())||"",unit:n.unit||"",costPrice:((L=n.costPrice)==null?void 0:L.toString())||"",sellingPrice:((B=n.unitPrice)==null?void 0:B.toString())||""}),n.imageUrls&&Array.isArray(n.imageUrls)?g(n.imageUrls):g([]),w([]))},[n]);const T=(H,L)=>{u(B=>({...B,[H]:L}))},D=async H=>{var O;const L=(O=H.target.files)==null?void 0:O[0];if(!L)return;const B=Ox(L);if(!B.isValid){I({isOpen:!0,variant:"error",message:B.error||"Invalid image file"});return}C(!0);try{const M=await Px(L,{maxSizeMB:1,maxWidthOrHeight:1920,useWebWorker:!0});g(R=>[...R,M.previewUrl]),w(R=>[...R,M]),I({isOpen:!0,variant:"success",message:`Image compressed: ${hd(M.originalSize)}  ${hd(M.compressedSize)}`})}catch(M){I({isOpen:!0,variant:"error",message:M instanceof Error?M.message:"Image compression failed"})}finally{C(!1),k.current&&(k.current.value="")}},N=H=>{g(L=>L.filter((B,O)=>O!==H)),w(L=>L.filter((B,O)=>O!==H))},A=()=>{!b&&k.current&&k.current.click()},$=async()=>{if(n){x(!0);try{const H=await c(r,s);if(!H.can_edit){I({isOpen:!0,variant:"error",message:H.message||"Cannot edit this product"}),x(!1);return}const L={product_name:d.productName,category_id:d.category,brand_id:d.brand,product_type:d.productType,barcode:d.barcode,sku:d.sku,unit:d.unit,cost_price:parseFloat(d.costPrice.toString())||0,unit_price:parseFloat(d.sellingPrice.toString())||0},B=[];for(let M=0;M<m.length;M++){const R=m[M],ie=y[M];if(ie&&ie.compressedFile){const Z=`product_${r}_${Date.now()}_${M}.${ie.compressedFile.type.split("/")[1]}`,Ie=await cm.uploadFile("product-images",Z,ie.compressedFile);Ie.success&&Ie.publicUrl&&B.push(Ie.publicUrl)}else R.startsWith("http")&&B.push(R)}B.length>0&&(L.image_urls=B);const O={product_name:n.productName,category_id:n.categoryId,brand_id:n.brandId,product_type:n.productType,barcode:n.barcode,sku:n.sku||n.productCode,unit:n.unit,cost_price:n.costPrice,unit_price:n.unitPrice,image_urls:n.imageUrls||[]};await i(L,O),e()}catch(H){I({isOpen:!0,variant:"error",message:H instanceof Error?H.message:"Failed to save product"})}finally{x(!1)}}},z=H=>{H.target===H.currentTarget&&e()};return t?o.jsxs("div",{className:we.modalOverlay,onClick:z,children:[o.jsxs("div",{className:we.modalContainer,children:[o.jsxs("div",{className:we.modalHeader,children:[o.jsxs("div",{className:we.modalTitleSection,children:[o.jsx("h2",{className:we.modalTitle,children:"Product Details"}),o.jsx("p",{className:we.modalSubtitle,children:"View and edit product information"})]}),o.jsx("button",{className:we.closeButton,onClick:e,children:o.jsx("svg",{width:"20",height:"20",fill:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})})})]}),o.jsxs("div",{className:we.modalBody,children:[o.jsx(Q7,{imagePreviews:m,compressionInfos:y,isCompressing:b,maxImages:E,onImageSelect:D,onRemoveImage:N,onImageClick:A,fileInputRef:k}),o.jsx(Z7,{formData:d,metadata:a,onInputChange:T,onAddBrand:()=>f(!0),onAddCategory:()=>_(!0)})]}),o.jsxs("div",{className:we.modalFooter,children:[o.jsx(Ne,{variant:"outline",size:"md",onClick:e,disabled:v,children:"Cancel"}),o.jsx(Ne,{variant:"primary",size:"md",onClick:$,loading:v,disabled:v,children:v?"Saving...":"Save Changes"})]})]}),o.jsx(Mx,{isOpen:h,onClose:()=>f(!1),companyId:s,onBrandAdded:l}),o.jsx(Rx,{isOpen:p,onClose:()=>_(!1),companyId:s,onCategoryAdded:l}),o.jsx($e,{isOpen:j.isOpen,variant:j.variant,message:j.message,onClose:()=>I(H=>({...H,isOpen:!1})),autoCloseDuration:3e3,zIndex:10001})]}):null},eB="_modalOverlay_zoms2_5",tB="_modalContent_zoms2_28",rB="_modalHeader_zoms2_52",sB="_modalTitle_zoms2_60",nB="_closeButton_zoms2_67",aB="_modalBody_zoms2_86",oB="_productInfo_zoms2_92",iB="_infoRow_zoms2_99",lB="_infoLabel_zoms2_110",cB="_infoValue_zoms2_116",dB="_formGroup_zoms2_122",uB="_formLabel_zoms2_126",hB="_quantityInput_zoms2_134",fB="_afterStockText_zoms2_166",mB="_negativeStock_zoms2_174",pB="_notesInput_zoms2_178",gB="_modalFooter_zoms2_206",Nt={modalOverlay:eB,modalContent:tB,modalHeader:rB,modalTitle:sB,closeButton:nB,modalBody:aB,productInfo:oB,infoRow:iB,infoLabel:lB,infoValue:cB,formGroup:dB,formLabel:uB,quantityInput:hB,afterStockText:fB,negativeStock:mB,notesInput:pB,modalFooter:gB},_B=({isOpen:t,onClose:e,productId:r,productName:s,currentStock:n,sourceStoreId:a,companyId:i,onMove:l})=>{var b;const{currentCompany:c}=ht(),[d,u]=S.useState(null),[h,f]=S.useState(""),[p,_]=S.useState("");if(S.useEffect(()=>{t&&(u(null),f(""),_(""))},[t]),!t)return null;const v=((b=c==null?void 0:c.stores)==null?void 0:b.filter(C=>C.store_id!==a))||[],x=C=>{const j=C.target.value;(j===""||/^\d+$/.test(j))&&f(j)},m=async()=>{if(!d||!h||!l)return;const C=parseInt(h,10);isNaN(C)||C<=0||(await l(d,C,p),e())},g=h!==""&&parseInt(h,10)>0,y=h!==""?n-parseInt(h,10):n,w=y<0;return o.jsx("div",{className:Nt.modalOverlay,onClick:e,children:o.jsxs("div",{className:Nt.modalContent,onClick:C=>C.stopPropagation(),children:[o.jsxs("div",{className:Nt.modalHeader,children:[o.jsx("h2",{className:Nt.modalTitle,children:"Move Product"}),o.jsx("button",{className:Nt.closeButton,onClick:e,children:o.jsx("svg",{width:"24",height:"24",fill:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{d:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"})})})]}),o.jsxs("div",{className:Nt.modalBody,children:[o.jsxs("div",{className:Nt.productInfo,children:[o.jsxs("div",{className:Nt.infoRow,children:[o.jsx("span",{className:Nt.infoLabel,children:"Product:"}),o.jsx("span",{className:Nt.infoValue,children:s})]}),o.jsxs("div",{className:Nt.infoRow,children:[o.jsx("span",{className:Nt.infoLabel,children:"Current Stock:"}),o.jsx("span",{className:Nt.infoValue,children:n})]})]}),o.jsxs("div",{className:Nt.formGroup,children:[o.jsx("label",{className:Nt.formLabel,children:"To Store"}),o.jsx(ds,{stores:v,selectedStoreId:d,onStoreSelect:u,companyId:i,showAllStoresOption:!1,allStoresLabel:"Select",width:"100%"})]}),o.jsxs("div",{className:Nt.formGroup,children:[o.jsx("label",{className:Nt.formLabel,children:"Move Quantity"}),o.jsx("input",{type:"text",inputMode:"numeric",className:Nt.quantityInput,value:h,onChange:x,placeholder:"Enter quantity"}),h!==""&&o.jsxs("div",{className:`${Nt.afterStockText} ${w?Nt.negativeStock:""}`,children:["After Stock: ",y]})]}),o.jsxs("div",{className:Nt.formGroup,children:[o.jsx("label",{className:Nt.formLabel,children:"Notes"}),o.jsx("textarea",{className:Nt.notesInput,value:p,onChange:C=>_(C.target.value),placeholder:"Add notes (optional)",rows:3})]})]}),o.jsxs("div",{className:Nt.modalFooter,children:[o.jsx(Ne,{variant:"outline",size:"md",onClick:e,children:"Cancel"}),o.jsx(Ne,{variant:"primary",size:"md",onClick:m,disabled:!d||!g,children:"Move"})]})]})})},yB="_modalOverlay_t3kdx_5",vB="_modalContent_t3kdx_19",xB="_modalHeader_t3kdx_30",bB="_modalTitle_t3kdx_38",wB="_closeButton_t3kdx_45",SB="_modalBody_t3kdx_63",jB="_formGroup_t3kdx_69",CB="_formLabel_t3kdx_73",NB="_productsList_t3kdx_81",IB="_productItem_t3kdx_90",kB="_productInfo_t3kdx_100",EB="_productName_t3kdx_107",TB="_productCode_t3kdx_114",LB="_quantityInput_t3kdx_120",AB="_notesInput_t3kdx_137",DB="_modalFooter_t3kdx_160",Jt={modalOverlay:yB,modalContent:vB,modalHeader:xB,modalTitle:bB,closeButton:wB,modalBody:SB,formGroup:jB,formLabel:CB,productsList:NB,productItem:IB,productInfo:kB,productName:EB,productCode:TB,quantityInput:LB,notesInput:AB,modalFooter:DB},MB=({isOpen:t,onClose:e,products:r,sourceStoreId:s,companyId:n,onMove:a})=>{var m;const{currentCompany:i}=ht(),[l,c]=S.useState(null),[d,u]=S.useState({}),[h,f]=S.useState("");if(S.useEffect(()=>{if(t){c(null),f("");const g={};r.forEach(y=>{g[y.productId]="1"}),u(g)}},[t,r]),!t)return null;const p=((m=i==null?void 0:i.stores)==null?void 0:m.filter(g=>g.store_id!==s))||[],_=(g,y)=>{(y===""||/^\d+$/.test(y))&&u(w=>({...w,[g]:y}))},v=async()=>{if(!l||!a)return;const g=r.map(y=>{const w=parseInt(d[y.productId]||"1",10);return isNaN(w)||w<=0?null:{productId:y.productId,quantity:w}}).filter(y=>y!==null);g.length!==0&&(await a(l,g,h),e())},x=l&&r.every(g=>{const y=d[g.productId];return y&&parseInt(y,10)>0});return o.jsx("div",{className:Jt.modalOverlay,onClick:e,children:o.jsxs("div",{className:Jt.modalContent,onClick:g=>g.stopPropagation(),children:[o.jsxs("div",{className:Jt.modalHeader,children:[o.jsx("h2",{className:Jt.modalTitle,children:"Move Products"}),o.jsx("button",{className:Jt.closeButton,onClick:e,children:o.jsx("svg",{width:"24",height:"24",fill:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{d:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"})})})]}),o.jsxs("div",{className:Jt.modalBody,children:[o.jsxs("div",{className:Jt.formGroup,children:[o.jsx("label",{className:Jt.formLabel,children:"To Store"}),o.jsx(ds,{stores:p,selectedStoreId:l,onStoreSelect:c,companyId:n,showAllStoresOption:!1,allStoresLabel:"Select",width:"100%"})]}),o.jsxs("div",{className:Jt.formGroup,children:[o.jsxs("label",{className:Jt.formLabel,children:["Products (",r.length,")"]}),o.jsx("div",{className:Jt.productsList,children:r.map(g=>o.jsxs("div",{className:Jt.productItem,children:[o.jsxs("div",{className:Jt.productInfo,children:[o.jsx("span",{className:Jt.productName,children:g.productName}),o.jsx("span",{className:Jt.productCode,children:g.productCode})]}),o.jsx("input",{type:"text",inputMode:"numeric",className:Jt.quantityInput,value:d[g.productId]||"1",onChange:y=>_(g.productId,y.target.value),placeholder:"Qty"})]},g.productId))})]}),o.jsxs("div",{className:Jt.formGroup,children:[o.jsx("label",{className:Jt.formLabel,children:"Notes"}),o.jsx("textarea",{className:Jt.notesInput,value:h,onChange:g=>f(g.target.value),placeholder:"Add notes (optional)",rows:3})]})]}),o.jsxs("div",{className:Jt.modalFooter,children:[o.jsx(Ne,{variant:"outline",size:"md",onClick:e,children:"Cancel"}),o.jsx(Ne,{variant:"primary",size:"md",onClick:v,disabled:!x,children:"Move"})]})]})})},RB="_modalOverlay_qx286_6",PB="_show_qx286_22",OB="_modalContainer_qx286_27",$B="_modalLg_qx286_40",FB="_modalHeader_qx286_49",BB="_modalTitleSection_qx286_58",VB="_modalTitle_qx286_58",HB="_modalSubtitle_qx286_70",zB="_closeButton_qx286_77",qB="_modalBody_qx286_99",UB="_formGrid_qx286_105",WB="_formGroup_qx286_111",GB="_formGroupFull_qx286_116",JB="_label_qx286_120",KB="_required_qx286_129",YB="_input_qx286_135",QB="_error_qx286_161",ZB="_inputWrapper_qx286_170",XB="_inputPrefix_qx286_176",eV="_withPrefix_qx286_185",tV="_helperText_qx286_189",rV="_errorMessage_qx286_197",sV="_imageUploadSection_qx286_206",nV="_imageUploadContainer_qx286_211",aV="_imagePreviewWrapper_qx286_218",oV="_imagePreview_qx286_218",iV="_uploadPlaceholder_qx286_245",lV="_uploadIcon_qx286_255",cV="_uploadText_qx286_261",dV="_uploadHint_qx286_267",uV="_removeImageButton_qx286_272",hV="_hiddenFileInput_qx286_295",fV="_modalFooter_qx286_300",_e={modalOverlay:RB,show:PB,modalContainer:OB,modalLg:$B,modalHeader:FB,modalTitleSection:BB,modalTitle:VB,modalSubtitle:HB,closeButton:zB,modalBody:qB,formGrid:UB,formGroup:WB,formGroupFull:GB,label:JB,required:KB,input:YB,error:QB,inputWrapper:ZB,inputPrefix:XB,withPrefix:eV,helperText:tV,errorMessage:rV,imageUploadSection:sV,imageUploadContainer:nV,imagePreviewWrapper:aV,imagePreview:oV,uploadPlaceholder:iV,uploadIcon:lV,uploadText:cV,uploadHint:dV,removeImageButton:uV,hiddenFileInput:hV,modalFooter:fV},mV=({isOpen:t,onClose:e,companyId:r,storeId:s,metadata:n,onProductAdded:a,onMetadataRefresh:i})=>{var O;const[l,c]=S.useState({productName:"",sku:"",barcode:"",categoryId:"",brandId:"",unit:"",costPrice:"",sellingPrice:"",initialQuantity:"0",imageUrl:"",thumbnailUrl:""}),[d,u]=S.useState({}),[h,f]=S.useState(!1),[p,_]=S.useState({isOpen:!1,variant:"success",message:""}),[v,x]=S.useState(!1),[m,g]=S.useState(!1),[y,w]=S.useState([]),[b,C]=S.useState([]),[j,I]=S.useState(!1),k=S.useRef(null),E=3;S.useEffect(()=>{var M,R,ie;t&&(console.log(" AddProductModal opened"),console.log("  - Categories:",((M=n==null?void 0:n.categories)==null?void 0:M.length)||0),console.log("  - Brands:",((R=n==null?void 0:n.brands)==null?void 0:R.length)||0),console.log("  - Units:",((ie=n==null?void 0:n.units)==null?void 0:ie.length)||0),console.log("  - Units data:",JSON.stringify(n==null?void 0:n.units,null,2)),c({productName:"",sku:"",barcode:"",categoryId:"",brandId:"",unit:"",costPrice:"",sellingPrice:"",initialQuantity:"0",imageUrl:"",thumbnailUrl:""}),u({}),f(!1),_({isOpen:!1,variant:"success",message:""}),w([]),C([]),I(!1))},[t,n]);const T=(M,R)=>{c(ie=>({...ie,[M]:R})),d[M]&&u(ie=>({...ie,[M]:""}))},D=()=>{const M={};return l.productName.trim()||(M.productName="Product name is required"),u(M),Object.keys(M).length===0},N=l.productName.trim().length>0,A=async M=>{var Z;const R=(Z=M.target.files)==null?void 0:Z[0];if(!R)return;if(M.target.value="",y.length>=E){_({isOpen:!0,variant:"error",message:`Maximum ${E} images allowed`});return}const ie=Ox(R,{maxSize:5*1024*1024,allowedTypes:["image/jpeg","image/png","image/webp"]});if(!ie.valid){_({isOpen:!0,variant:"error",message:ie.error||"Invalid image file"});return}try{I(!0);const Ie=await Px(R,{quality:80,maxWidth:2e3,maxHeight:2e3});w(Te=>[...Te,Ie.dataUrl]),C(Te=>[...Te,Ie]),console.log(" Image compressed:",{original:hd(Ie.originalSize),compressed:hd(Ie.compressedSize),ratio:`${Math.round(Ie.compressionRatio*100)}%`})}catch(Ie){console.error(" Image compression error:",Ie),_({isOpen:!0,variant:"error",message:Ie instanceof Error?Ie.message:"Failed to process image"})}finally{I(!1)}},$=M=>{w(R=>R.filter((ie,Z)=>Z!==M)),C(R=>R.filter((ie,Z)=>Z!==M))},z=()=>{var M;(M=k.current)==null||M.click()},H=async()=>{var M,R,ie,Z,Ie,Te;if(D()){f(!0);try{const Ke={p_company_id:r,p_product_name:l.productName.trim(),p_store_id:s||null,p_sku:l.sku.trim()||null,p_barcode:l.barcode.trim()||null,p_category_id:l.categoryId||null,p_brand_id:l.brandId||null};console.log(" Step 1: Validating product data..."),console.log("Validation params:",Ke);const{data:ye,error:P}=await se.getClient().rpc("inventory_check_create",Ke).single();if(console.log(" Validation result:",{validationData:ye,validationError:P}),P){console.error(" Validation RPC error:",P),_({isOpen:!0,variant:"error",message:`Validation failed: ${P.message}`}),f(!1);return}const xe=ye;if(!xe.success){console.error(" Validation failed:",xe);const F={STORE_ID_REQUIRED:"Store ID is required",INVALID_COMPANY_ID:"Invalid company ID",INVALID_STORE_ID:"Invalid store ID or store does not belong to company",INVALID_CATEGORY_ID:"Invalid category ID or category does not belong to company",INVALID_BRAND_ID:"Invalid brand ID or brand does not belong to company",PRODUCT_NAME_REQUIRED:"Product name is required",DUPLICATE_SKU:"This SKU already exists. Please use a different SKU or leave it empty to auto-generate.",DUPLICATE_BARCODE:"This barcode already exists. Please use a different barcode or leave it empty to auto-generate.",VALIDATION_ERROR:`Validation error: ${xe.details||xe.error}`}[xe.code]||xe.error||"Validation failed";_({isOpen:!0,variant:"error",message:F}),f(!1);return}console.log(" Validation passed:",xe);const je=[];if(y.length>0){console.log(` Step 2: Uploading ${y.length} image(s) to Storage...`);for(let ee=0;ee<y.length;ee++){const F=y[ee],Y=b[ee],le=Date.now(),ve=Math.random().toString(36).substring(2,9),ot=Y.format.split("/")[1],He=`product_${le}_${ve}_${ee}.${ot}`,Pt=`${r}/${He}`,Br=await cm.uploadImage("inventory_image",Pt,F,{upsert:!1});if(!Br.success){console.error(` Image ${ee+1} upload failed:`,Br.error),_({isOpen:!0,variant:"error",message:`Failed to upload image ${ee+1}: ${Br.error}`}),f(!1);return}je.push(Br.data),console.log(` Image ${ee+1} uploaded:`,Br.data)}}console.log(" Step 3: Creating product...");const ne={p_company_id:r,p_product_name:l.productName.trim(),p_store_id:s||null,p_sku:l.sku.trim()||null,p_barcode:l.barcode.trim()||null,p_category_id:l.categoryId||null,p_brand_id:l.brandId||null,p_unit:l.unit||null,p_cost_price:l.costPrice&&parseFloat(l.costPrice)>0?parseFloat(l.costPrice):null,p_selling_price:l.sellingPrice&&parseFloat(l.sellingPrice)>0?parseFloat(l.sellingPrice):null,p_initial_quantity:l.initialQuantity&&parseFloat(l.initialQuantity)>0?parseFloat(l.initialQuantity):null,p_image_urls:je};console.log("Creating product with parameters:",ne),console.log("  - p_sku type:",typeof ne.p_sku,"| value:",ne.p_sku,"| is null:",ne.p_sku===null),console.log("  - p_barcode type:",typeof ne.p_barcode,"| value:",ne.p_barcode,"| is null:",ne.p_barcode===null),console.log("  - categoryId type:",typeof ne.p_category_id,"| value:",ne.p_category_id),console.log("  - brandId type:",typeof ne.p_brand_id,"| value:",ne.p_brand_id);const{data:Ce,error:Ue}=await se.getClient().rpc("inventory_create_product",ne).single();if(console.log(" RPC Response:",{data:Ce,error:Ue}),console.log(" Full data:",JSON.stringify(Ce,null,2)),Ue){console.error(" Error creating product:",Ue),console.error("   Error details:",JSON.stringify(Ue,null,2));let ee="Failed to create product";Ue.code==="DUPLICATE_SKU"||(M=Ue.message)!=null&&M.includes("DUPLICATE_SKU")?ee="This SKU already exists. Please use a different SKU.":Ue.code==="DUPLICATE_BARCODE"||(R=Ue.message)!=null&&R.includes("DUPLICATE_BARCODE")?ee="This barcode already exists. Please use a different barcode.":Ue.code==="FOREIGN_KEY_ERROR"||(ie=Ue.message)!=null&&ie.includes("FOREIGN_KEY")?ee="Invalid category or brand selected.":Ue.message&&(ee=Ue.message),_({isOpen:!0,variant:"error",message:ee}),f(!1);return}if(!Ce){console.error(" RPC returned no data"),_({isOpen:!0,variant:"error",message:"Failed to create product: No data returned from server"}),f(!1);return}if(Ce.success===!1){console.error(" RPC returned success: false",Ce);let ee="Failed to create product";Ce.code==="DUPLICATE_SKU"||(Z=Ce.details)!=null&&Z.includes("inventory_products_company_id_sku_key")?ee="This SKU already exists. Please use a different SKU or leave it empty to auto-generate.":Ce.code==="DUPLICATE_BARCODE"||(Ie=Ce.details)!=null&&Ie.includes("barcode")?ee="This barcode already exists. Please use a different barcode.":Ce.code==="FOREIGN_KEY_ERROR"||(Te=Ce.details)!=null&&Te.includes("foreign key")?ee="Invalid category or brand selected.":(ee=Ce.error||Ce.message||"Failed to create product",Ce.details&&(ee+=` (${Ce.details})`)),_({isOpen:!0,variant:"error",message:ee}),f(!1);return}const J=(Ce==null?void 0:Ce.data)||Ce;console.log(" Product created successfully:",J),console.log(" Product data type:",typeof J),console.log(" Product data keys:",J?Object.keys(J):"null");let U=`Product "${l.productName}" has been created successfully!`;const ue=[];!l.sku.trim()&&(J!=null&&J.sku)&&ue.push(`SKU: ${J.sku}`),!l.barcode.trim()&&(J!=null&&J.barcode)&&ue.push(`Barcode: ${J.barcode}`),ue.length>0&&(U+=` (Auto-generated: ${ue.join(", ")})`),_({isOpen:!0,variant:"success",message:U}),setTimeout(()=>{a&&J&&a(J),e()},1500)}catch(Ke){console.error("Error creating product:",Ke),_({isOpen:!0,variant:"error",message:Ke instanceof Error?Ke.message:"An error occurred. Please try again."}),f(!1)}}},L=M=>{M.target===M.currentTarget&&e()};if(!t)return null;const B=((O=n==null?void 0:n.currency)==null?void 0:O.symbol)||"$";return o.jsxs("div",{className:`${_e.modalOverlay} ${t?_e.show:""}`,onClick:L,children:[o.jsxs("div",{className:`${_e.modalContainer} ${_e.modalLg}`,children:[o.jsxs("div",{className:_e.modalHeader,children:[o.jsxs("div",{className:_e.modalTitleSection,children:[o.jsx("h2",{className:_e.modalTitle,children:"Add New Product"}),o.jsx("p",{className:_e.modalSubtitle,children:"Enter product details to add to your inventory"})]}),o.jsx("button",{className:_e.closeButton,onClick:e,children:o.jsx("svg",{width:"20",height:"20",fill:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})})})]}),o.jsx("div",{className:_e.modalBody,children:o.jsxs("div",{className:_e.formGrid,children:[o.jsxs("div",{className:_e.imageUploadSection,children:[o.jsxs("label",{className:_e.label,children:["Product Images (Max ",E,")"]}),o.jsxs("div",{className:_e.imageUploadContainer,children:[y.map((M,R)=>o.jsxs("div",{className:_e.imagePreviewWrapper,children:[o.jsx("img",{src:M,alt:`Product preview ${R+1}`,className:_e.imagePreview}),o.jsx("button",{className:_e.removeImageButton,onClick:ie=>{ie.stopPropagation(),$(R)},type:"button",children:o.jsx("svg",{width:"16",height:"16",fill:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})})})]},R)),y.length<E&&o.jsx("div",{className:_e.imagePreviewWrapper,onClick:z,style:{cursor:j?"wait":"pointer"},children:o.jsx("div",{className:_e.uploadPlaceholder,children:j?o.jsxs(o.Fragment,{children:[o.jsx("svg",{className:_e.uploadIcon,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})}),o.jsx("span",{className:_e.uploadText,children:"Compressing..."})]}):o.jsxs(o.Fragment,{children:[o.jsx("svg",{className:_e.uploadIcon,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),o.jsx("span",{className:_e.uploadText,children:"Add Image"}),o.jsxs("span",{className:_e.uploadHint,children:[y.length,"/",E]})]})})})]}),o.jsx("input",{ref:k,type:"file",accept:"image/jpeg,image/png,image/webp",onChange:A,className:_e.hiddenFileInput})]}),o.jsxs("div",{className:`${_e.formGroup} ${_e.formGroupFull}`,children:[o.jsx("label",{className:`${_e.label} ${_e.required}`,children:"Product Name"}),o.jsx("input",{type:"text",className:`${_e.input} ${d.productName?_e.error:""}`,placeholder:"Enter product name",value:l.productName,onChange:M=>T("productName",M.target.value),maxLength:200,autoFocus:!0}),d.productName&&o.jsx("span",{className:_e.errorMessage,children:d.productName})]}),o.jsxs("div",{className:_e.formGroup,children:[o.jsx("label",{className:_e.label,children:"SKU"}),o.jsx("input",{type:"text",className:_e.input,placeholder:"Leave empty to auto-generate",value:l.sku,onChange:M=>T("sku",M.target.value),maxLength:50}),o.jsx("span",{className:_e.helperText,children:"Will be auto-generated if left empty"})]}),o.jsxs("div",{className:_e.formGroup,children:[o.jsx("label",{className:_e.label,children:"Barcode"}),o.jsx("input",{type:"text",className:_e.input,placeholder:"Leave empty to auto-generate",value:l.barcode,onChange:M=>T("barcode",M.target.value),maxLength:50}),o.jsx("span",{className:_e.helperText,children:"Will be auto-generated if left empty"})]}),o.jsx("div",{className:_e.formGroup,children:o.jsx(Ze,{label:"Category",placeholder:"Select category",value:l.categoryId,options:(n==null?void 0:n.categories.map(M=>({value:M.category_id,label:M.category_name,description:M.description})))||[],onChange:M=>T("categoryId",M),showAddButton:!0,addButtonText:"Add category",onAddClick:()=>g(!0),showDescriptions:!0,fullWidth:!0})}),o.jsx("div",{className:_e.formGroup,children:o.jsx(Ze,{label:"Brand",placeholder:"Select brand",value:l.brandId,options:(n==null?void 0:n.brands.map(M=>({value:M.brand_id,label:M.brand_name,description:M.description})))||[],onChange:M=>T("brandId",M),showAddButton:!0,addButtonText:"Add brand",onAddClick:()=>x(!0),showDescriptions:!0,fullWidth:!0})}),o.jsxs("div",{className:_e.formGroup,children:[o.jsx("label",{className:_e.label,children:"Cost Price"}),o.jsxs("div",{className:_e.inputWrapper,children:[o.jsx("span",{className:_e.inputPrefix,children:B}),o.jsx("input",{type:"number",className:`${_e.input} ${_e.withPrefix}`,placeholder:"0",value:l.costPrice,onChange:M=>T("costPrice",M.target.value),min:"0",step:"0.01",max:"999999999"})]})]}),o.jsxs("div",{className:_e.formGroup,children:[o.jsx("label",{className:_e.label,children:"Selling Price"}),o.jsxs("div",{className:_e.inputWrapper,children:[o.jsx("span",{className:_e.inputPrefix,children:B}),o.jsx("input",{type:"number",className:`${_e.input} ${_e.withPrefix}`,placeholder:"0",value:l.sellingPrice,onChange:M=>T("sellingPrice",M.target.value),min:"0",step:"0.01",max:"999999999"})]})]}),o.jsx("div",{className:_e.formGroup,children:o.jsx(Ze,{label:"Unit",placeholder:"Select unit",value:l.unit,options:[{value:"piece",label:"Piece"},{value:"kg",label:"Kilogram (kg)"},{value:"g",label:"Gram (g)"},{value:"l",label:"Liter (l)"},{value:"ml",label:"Milliliter (ml)"},{value:"box",label:"Box"}],onChange:M=>T("unit",M),fullWidth:!0})}),o.jsxs("div",{className:_e.formGroup,children:[o.jsx("label",{className:_e.label,children:"Initial Quantity"}),o.jsx("input",{type:"number",className:_e.input,placeholder:"0",value:l.initialQuantity,onChange:M=>T("initialQuantity",M.target.value),min:"0",max:"999999999"})]})]})}),o.jsxs("div",{className:_e.modalFooter,children:[o.jsx(Ne,{variant:"secondary",size:"md",onClick:e,disabled:h,children:"Cancel"}),o.jsx(Ne,{variant:"primary",size:"md",onClick:H,disabled:h||!N,children:h?"Creating...":"Create Product"})]})]}),o.jsx(Mx,{isOpen:v,onClose:()=>x(!1),companyId:r,onBrandAdded:M=>{T("brandId",M.brand_id),i&&i()}}),o.jsx(Rx,{isOpen:m,onClose:()=>g(!1),companyId:r,categories:(n==null?void 0:n.categories)||[],onCategoryAdded:M=>{T("categoryId",M.category_id),i&&i()}}),o.jsx($e,{variant:p.variant,message:p.message,isOpen:p.isOpen,onClose:()=>_({...p,isOpen:!1}),autoCloseDuration:p.variant==="success"?1500:0,zIndex:1e4})]})},pV="_leftFilter_gqkij_6",gV="_filterSection_gqkij_15",_V="_filterSectionHeader_gqkij_27",yV="_filterSectionTitle_gqkij_44",vV="_filterCount_gqkij_51",xV="_expandIcon_gqkij_57",bV="_expanded_gqkij_65",wV="_filterOptions_gqkij_70",SV="_radioOption_gqkij_77",jV="_radioInput_gqkij_91",CV="_radioLabel_gqkij_104",NV="_filterButton_gqkij_120",IV="_active_gqkij_141",kV="_optionIcon_gqkij_160",EV="_checkIcon_gqkij_166",TV="_clearButton_gqkij_174",LV="_clearIcon_gqkij_185",AV="_filterInput_gqkij_193",DV="_toggleButtons_gqkij_225",MV="_toggleButton_gqkij_225",RV="_emptyState_gqkij_264",Ge={leftFilter:pV,filterSection:gV,filterSectionHeader:_V,filterSectionTitle:yV,filterCount:vV,expandIcon:xV,expanded:bV,filterOptions:wV,radioOption:SV,radioInput:jV,radioLabel:CV,filterButton:NV,active:IV,optionIcon:kV,checkIcon:EV,clearButton:TV,clearIcon:LV,filterInput:AV,toggleButtons:DV,toggleButton:MV,emptyState:RV},rf=({sections:t,width:e=240,topOffset:r=64,className:s="",onSectionExpandToggle:n})=>{const[a,i]=S.useState(new Set(t.filter(m=>m.defaultExpanded).map(m=>m.id))),l=m=>{const g=new Set(a),y=!g.has(m);y?g.add(m):g.delete(m),i(g),n==null||n(m,y)},c=m=>a.has(m),d=m=>{var y;const g=typeof m.selectedValues=="string"?m.selectedValues:"";return o.jsx("div",{className:Ge.filterOptions,children:(y=m.options)==null?void 0:y.map(w=>o.jsxs("button",{className:`${Ge.filterButton} ${g===w.value?Ge.active:""}`,onClick:()=>{var b;return(b=m.onSelect)==null?void 0:b.call(m,w.value)},disabled:w.disabled,children:[o.jsxs("span",{children:[w.icon&&o.jsx("span",{className:Ge.optionIcon,children:w.icon}),w.label]}),g===w.value&&o.jsx("svg",{className:Ge.checkIcon,width:"16",height:"16",fill:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{d:"M9,16.17L4.83,12l-1.42,1.41L9,19L21,7l-1.41-1.41L9,16.17z"})})]},w.value))})},u=m=>{const g=m.selectedValues instanceof Set?m.selectedValues:new Set;return o.jsxs("div",{className:Ge.filterOptions,children:[g.size>0&&m.onClear&&o.jsxs("button",{className:`${Ge.filterButton} ${Ge.clearButton}`,onClick:m.onClear,children:[o.jsx("span",{children:"Clear All"}),o.jsx("svg",{className:Ge.clearIcon,width:"16",height:"16",fill:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{d:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"})})]}),!m.options||m.options.length===0?o.jsx("div",{className:Ge.emptyState,children:m.emptyMessage||"No options available"}):m.options.map(y=>o.jsxs("button",{className:`${Ge.filterButton} ${g.has(y.value)?Ge.active:""}`,onClick:()=>{var w;return(w=m.onToggle)==null?void 0:w.call(m,y.value)},disabled:y.disabled,children:[o.jsxs("span",{children:[y.icon&&o.jsx("span",{className:Ge.optionIcon,children:y.icon}),y.label]}),g.has(y.value)&&o.jsx("svg",{className:Ge.checkIcon,width:"16",height:"16",fill:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{d:"M9,16.17L4.83,12l-1.42,1.41L9,19L21,7l-1.41-1.41L9,16.17z"})})]},y.value))]})},h=m=>{var y;const g=typeof m.selectedValues=="string"?m.selectedValues:"";return o.jsx("div",{className:Ge.filterOptions,children:(y=m.options)==null?void 0:y.map(w=>o.jsxs("label",{className:Ge.radioOption,children:[o.jsx("input",{type:"radio",name:m.id,value:w.value,checked:g===w.value,onChange:()=>{var b;return(b=m.onSelect)==null?void 0:b.call(m,w.value)},disabled:w.disabled,className:Ge.radioInput}),o.jsxs("span",{className:Ge.radioLabel,children:[w.icon&&o.jsx("span",{className:Ge.optionIcon,children:w.icon}),w.label]})]},w.value))})},f=m=>{var y;const g=typeof m.selectedValues=="string"?m.selectedValues:"";return o.jsx("div",{className:Ge.toggleButtons,children:(y=m.options)==null?void 0:y.map(w=>o.jsxs("button",{className:`${Ge.toggleButton} ${g===w.value?Ge.active:""}`,onClick:()=>{var b;return(b=m.onSelect)==null?void 0:b.call(m,w.value)},disabled:w.disabled,children:[w.icon&&o.jsx("span",{className:Ge.optionIcon,children:w.icon}),w.label]},w.value))})},p=m=>{const g=typeof m.selectedValues=="string"?m.selectedValues:"";return o.jsx("div",{className:Ge.filterOptions,children:o.jsx("input",{type:"text",className:Ge.filterInput,value:g,onChange:y=>{var w;return(w=m.onInputChange)==null?void 0:w.call(m,y.target.value)},placeholder:m.placeholder||"Enter value..."})})},_=m=>o.jsx("div",{className:Ge.filterOptions,children:m.customContent}),v=m=>{switch(m.type){case"sort":return d(m);case"multiselect":return u(m);case"radio":return h(m);case"toggle":return f(m);case"input":return p(m);case"custom":return _(m);default:return null}},x=m=>m.selectedValues instanceof Set?m.selectedValues.size:0;return o.jsx("aside",{className:`${Ge.leftFilter} ${s}`,style:{width:`${e}px`,height:`calc(100vh - ${r}px)`,top:`${r}px`},children:t.map(m=>{const g=m.type!=="sort",y=c(m.id),w=x(m);return o.jsxs("div",{className:Ge.filterSection,children:[g?o.jsxs("button",{className:Ge.filterSectionHeader,onClick:()=>l(m.id),children:[o.jsxs("span",{className:Ge.filterSectionTitle,children:[m.title,m.showCount&&w>0&&o.jsxs("span",{className:Ge.filterCount,children:[" (",w,")"]})]}),o.jsx("svg",{className:`${Ge.expandIcon} ${y?Ge.expanded:""}`,width:"20",height:"20",fill:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{d:"M7.41,8.58L12,13.17L16.59,8.58L18,10L12,16L6,10L7.41,8.58Z"})})]}):o.jsx("div",{className:Ge.filterSectionHeader,children:o.jsx("span",{className:Ge.filterSectionTitle,children:m.title})}),(!g||y)&&v(m)]},m.id)})})},PV="_filterContainer_gloe1_6",OV="_filterButton_gloe1_11",$V="_filterIcon_gloe1_32",FV="_dropdownArrow_gloe1_38",BV="_dropdownArrowOpen_gloe1_45",VV="_dropdownMenu_gloe1_49",HV="_dropdownItem_gloe1_76",zV="_active_gloe1_96",qV="_checkIcon_gloe1_106",UV="_chevronRight_gloe1_113",WV="_divider_gloe1_120",GV="_brandMenuItem_gloe1_126",JV="_brandSubmenu_gloe1_130",KV="_emptyBrands_gloe1_160",De={filterContainer:PV,filterButton:OV,filterIcon:$V,dropdownArrow:FV,dropdownArrowOpen:BV,dropdownMenu:VV,dropdownItem:HV,active:zV,checkIcon:qV,chevronRight:UV,divider:WV,brandMenuItem:GV,brandSubmenu:JV,emptyBrands:KV},YV=({filterType:t,selectedBrandFilter:e,selectedCategoryFilter:r,brands:s,categories:n,onFilterChange:a,onBrandFilterChange:i,onCategoryFilterChange:l})=>{const[c,d]=S.useState(!1),[u,h]=S.useState(!1),[f,p]=S.useState(!1),_=S.useRef(null);S.useEffect(()=>{const w=b=>{_.current&&!_.current.contains(b.target)&&(d(!1),h(!1),p(!1))};return document.addEventListener("mousedown",w),()=>document.removeEventListener("mousedown",w)},[]);const v=()=>{d(!c),c&&(h(!1),p(!1))},x=w=>{w==="brand"?(h(!0),p(!1)):w==="category"?(p(!0),h(!1)):(a(w),i(null),l(null),d(!1),h(!1),p(!1))},m=w=>{a("brand"),i(w),l(null),d(!1),h(!1),p(!1)},g=w=>{a("category"),l(w),i(null),d(!1),h(!1),p(!1)},y=()=>t==="brand"&&e?`Brand: ${e}`:t==="category"&&r?`Category: ${r}`:{newest:"Newest",oldest:"Oldest",price_high:"Price: High to Low",price_low:"Price: Low to High",cost_high:"Cost: High to Low",cost_low:"Cost: Low to High",brand:"Brand",category:"Category"}[t];return o.jsxs("div",{className:De.filterContainer,ref:_,children:[o.jsxs("button",{className:De.filterButton,onClick:v,"aria-label":"Filter products",children:[o.jsx("svg",{className:De.filterIcon,width:"16",height:"16",fill:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{d:"M10,18h4v-2h-4V18z M3,6v2h18V6H3z M6,13h12v-2H6V13z"})}),o.jsx("span",{children:y()}),o.jsx("svg",{className:`${De.dropdownArrow} ${c?De.dropdownArrowOpen:""}`,width:"12",height:"12",fill:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{d:"M7.41,8.58L12,13.17L16.59,8.58L18,10L12,16L6,10L7.41,8.58Z"})})]}),c&&o.jsxs("div",{className:De.dropdownMenu,children:[o.jsxs("button",{className:`${De.dropdownItem} ${t==="newest"?De.active:""}`,onClick:()=>x("newest"),children:[o.jsx("span",{children:"Newest"}),t==="newest"&&o.jsx("svg",{className:De.checkIcon,width:"16",height:"16",fill:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{d:"M9,16.17L4.83,12l-1.42,1.41L9,19L21,7l-1.41-1.41L9,16.17z"})})]}),o.jsxs("button",{className:`${De.dropdownItem} ${t==="oldest"?De.active:""}`,onClick:()=>x("oldest"),children:[o.jsx("span",{children:"Oldest"}),t==="oldest"&&o.jsx("svg",{className:De.checkIcon,width:"16",height:"16",fill:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{d:"M9,16.17L4.83,12l-1.42,1.41L9,19L21,7l-1.41-1.41L9,16.17z"})})]}),o.jsx("div",{className:De.divider}),o.jsxs("button",{className:`${De.dropdownItem} ${t==="price_high"?De.active:""}`,onClick:()=>x("price_high"),children:[o.jsx("span",{children:"Price: High to Low"}),t==="price_high"&&o.jsx("svg",{className:De.checkIcon,width:"16",height:"16",fill:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{d:"M9,16.17L4.83,12l-1.42,1.41L9,19L21,7l-1.41-1.41L9,16.17z"})})]}),o.jsxs("button",{className:`${De.dropdownItem} ${t==="price_low"?De.active:""}`,onClick:()=>x("price_low"),children:[o.jsx("span",{children:"Price: Low to High"}),t==="price_low"&&o.jsx("svg",{className:De.checkIcon,width:"16",height:"16",fill:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{d:"M9,16.17L4.83,12l-1.42,1.41L9,19L21,7l-1.41-1.41L9,16.17z"})})]}),o.jsx("div",{className:De.divider}),o.jsxs("button",{className:`${De.dropdownItem} ${t==="cost_high"?De.active:""}`,onClick:()=>x("cost_high"),children:[o.jsx("span",{children:"Cost: High to Low"}),t==="cost_high"&&o.jsx("svg",{className:De.checkIcon,width:"16",height:"16",fill:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{d:"M9,16.17L4.83,12l-1.42,1.41L9,19L21,7l-1.41-1.41L9,16.17z"})})]}),o.jsxs("button",{className:`${De.dropdownItem} ${t==="cost_low"?De.active:""}`,onClick:()=>x("cost_low"),children:[o.jsx("span",{children:"Cost: Low to High"}),t==="cost_low"&&o.jsx("svg",{className:De.checkIcon,width:"16",height:"16",fill:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{d:"M9,16.17L4.83,12l-1.42,1.41L9,19L21,7l-1.41-1.41L9,16.17z"})})]}),o.jsx("div",{className:De.divider}),o.jsxs("div",{className:De.brandMenuItem,children:[o.jsxs("button",{className:`${De.dropdownItem} ${t==="category"?De.active:""}`,onClick:()=>x("category"),children:[o.jsx("span",{children:"Category"}),o.jsx("svg",{className:De.chevronRight,width:"16",height:"16",fill:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{d:"M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z"})})]}),f&&o.jsx("div",{className:De.brandSubmenu,children:!n||n.length===0?o.jsx("div",{className:De.emptyBrands,children:"No categories available"}):n.map(w=>o.jsxs("button",{className:`${De.dropdownItem} ${t==="category"&&r===w?De.active:""}`,onClick:()=>g(w),children:[o.jsx("span",{children:w}),t==="category"&&r===w&&o.jsx("svg",{className:De.checkIcon,width:"16",height:"16",fill:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{d:"M9,16.17L4.83,12l-1.42,1.41L9,19L21,7l-1.41-1.41L9,16.17z"})})]},w))})]}),o.jsxs("div",{className:De.brandMenuItem,children:[o.jsxs("button",{className:`${De.dropdownItem} ${t==="brand"?De.active:""}`,onClick:()=>x("brand"),children:[o.jsx("span",{children:"Brand"}),o.jsx("svg",{className:De.chevronRight,width:"16",height:"16",fill:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{d:"M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z"})})]}),u&&o.jsx("div",{className:De.brandSubmenu,children:!s||s.length===0?o.jsx("div",{className:De.emptyBrands,children:"No brands available"}):s.map(w=>o.jsxs("button",{className:`${De.dropdownItem} ${t==="brand"&&e===w?De.active:""}`,onClick:()=>m(w),children:[o.jsx("span",{children:w}),t==="brand"&&e===w&&o.jsx("svg",{className:De.checkIcon,width:"16",height:"16",fill:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{d:"M9,16.17L4.83,12l-1.42,1.41L9,19L21,7l-1.41-1.41L9,16.17z"})})]},w))})]})]})]})},QV="_inventoryHeader_9xvll_7",ZV="_inventoryTitleSection_9xvll_16",XV="_mobileFilterWrapper_9xvll_24",eH="_inventoryTitle_9xvll_16",tH="_inventoryActions_9xvll_35",rH="_actionButtons_9xvll_41",sH="_inventorySearchWrapper_9xvll_48",nH="_inventorySearch_9xvll_48",aH="_searchIcon_9xvll_75",oH="_searchClear_9xvll_86",Bs={inventoryHeader:QV,inventoryTitleSection:ZV,mobileFilterWrapper:XV,inventoryTitle:eH,inventoryActions:tH,actionButtons:rH,inventorySearchWrapper:sH,inventorySearch:nH,searchIcon:aH,searchClear:oH},iH=({searchQuery:t,onSearchChange:e,selectedCount:r,isExporting:s,isImporting:n,totalItems:a,filterType:i,selectedBrandFilter:l,selectedCategoryFilter:c,brands:d,categories:u,onDelete:h,onMoveSelected:f,onExport:p,onImport:_,onAddProduct:v,onFilterChange:x,onBrandFilterChange:m,onCategoryFilterChange:g,fileInputRef:y,onFileChange:w})=>{const b=()=>{e("")};return o.jsxs("div",{className:Bs.inventoryHeader,children:[o.jsxs("div",{className:Bs.inventoryTitleSection,children:[o.jsx("h2",{className:Bs.inventoryTitle,children:"Products"}),o.jsxs("div",{className:Bs.inventorySearchWrapper,children:[o.jsx("svg",{className:Bs.searchIcon,fill:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"})}),o.jsx("input",{type:"text",className:Bs.inventorySearch,placeholder:"Search products...",value:t,onChange:C=>e(C.target.value)}),t&&o.jsx("button",{className:Bs.searchClear,onClick:b,children:o.jsx("svg",{fill:"currentColor",viewBox:"0 0 24 24",width:"16",height:"16",children:o.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})})})]}),o.jsx("div",{className:Bs.mobileFilterWrapper,children:o.jsx(YV,{filterType:i,selectedBrandFilter:l,selectedCategoryFilter:c,brands:d,categories:u,onFilterChange:x,onBrandFilterChange:m,onCategoryFilterChange:g})})]}),o.jsx("div",{className:Bs.inventoryActions,children:o.jsxs("div",{className:Bs.actionButtons,children:[o.jsx(Ne,{variant:"secondary",size:"md",onClick:f,disabled:r===0,icon:o.jsx("svg",{width:"16",height:"16",fill:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{d:"M6,13H14L10.5,16.5L11.92,17.92L17.84,12L11.92,6.08L10.5,7.5L14,11H6V13M20,6V18H11V20H20A2,2 0 0,0 22,18V6A2,2 0 0,0 20,4H11V6H20Z"})}),iconPosition:"left",children:r>0?`Move ${r} Product${r>1?"s":""}`:"Move Product"}),o.jsx(Ne,{variant:"error",size:"md",onClick:h,disabled:r===0,icon:o.jsx("svg",{width:"16",height:"16",fill:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{d:"M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z"})}),iconPosition:"left",children:r>0?`Delete ${r} Product${r>1?"s":""}`:"Delete Product"}),o.jsx(Ne,{variant:"secondary",size:"md",onClick:p,disabled:s||a===0,icon:s?o.jsx(Me,{size:"small"}):o.jsx("svg",{width:"16",height:"16",fill:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{d:"M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"})}),iconPosition:"left",children:s?"Exporting...":"Export Excel"}),o.jsx(Ne,{variant:"secondary",size:"md",onClick:_,disabled:n,icon:n?o.jsx(Me,{size:"small"}):o.jsx("svg",{width:"16",height:"16",fill:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{d:"M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M13,13H11V16H9L12,19L15,16H13V13M13,9V3.5L18.5,9H13Z"})}),iconPosition:"left",children:n?"Importing...":"Import Excel"}),o.jsx("input",{ref:y,type:"file",accept:".xlsx,.xls",onChange:w,style:{display:"none"}}),o.jsx(Ne,{variant:"primary",size:"md",onClick:v,icon:o.jsx("svg",{width:"16",height:"16",fill:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{d:"M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"})}),iconPosition:"left",children:"Add Product"})]})})]})},lH="_inventoryTableWrapper_hl7s1_8",cH="_inventoryTable_hl7s1_8",dH="_quantityCell_hl7s1_36",uH="_priceCell_hl7s1_37",hH="_costCell_hl7s1_38",fH="_checkboxCell_hl7s1_57",mH="_imageCell_hl7s1_63",pH="_productThumbnail_hl7s1_69",gH="_noImagePlaceholder_hl7s1_79",_H="_productRow_hl7s1_170",yH="_productNameCell_hl7s1_175",vH="_productName_hl7s1_175",xH="_productCodeCell_hl7s1_192",bH="_productCode_hl7s1_192",wH="_barcodeCell_hl7s1_210",SH="_barcode_hl7s1_210",jH="_quantityValue_hl7s1_229",CH="_priceValue_hl7s1_248",NH="_costValue_hl7s1_254",IH="_moveCell_hl7s1_294",kH="_emptyState_hl7s1_330",EH="_emptyIcon_hl7s1_336",TH="_emptyTitle_hl7s1_343",LH="_emptyText_hl7s1_350",AH="_loadingOverlay_hl7s1_357",DH="_pagination_hl7s1_397",MH="_paginationInfo_hl7s1_405",RH="_paginationControls_hl7s1_410",PH="_paginationButton_hl7s1_416",OH="_active_hl7s1_442",$H="_expandedRow_hl7s1_475",FH="_detailRow_hl7s1_480",BH="_detailContent_hl7s1_490",VH="_detailGrid_hl7s1_506",HH="_detailSection_hl7s1_513",zH="_detailSectionTitle_hl7s1_520",qH="_detailImages_hl7s1_529",UH="_detailImage_hl7s1_529",WH="_detailInfo_hl7s1_543",GH="_detailItem_hl7s1_549",JH="_detailLabel_hl7s1_561",KH="_detailValue_hl7s1_567",YH="_detailActions_hl7s1_574",Q={inventoryTableWrapper:lH,inventoryTable:cH,quantityCell:dH,priceCell:uH,costCell:hH,checkboxCell:fH,imageCell:mH,productThumbnail:pH,noImagePlaceholder:gH,productRow:_H,productNameCell:yH,productName:vH,productCodeCell:xH,productCode:bH,barcodeCell:wH,barcode:SH,quantityValue:jH,priceValue:CH,costValue:NH,moveCell:IH,emptyState:kH,emptyIcon:EH,emptyTitle:TH,emptyText:LH,loadingOverlay:AH,pagination:DH,paginationInfo:MH,paginationControls:RH,paginationButton:PH,active:OH,expandedRow:$H,detailRow:FH,detailContent:BH,detailGrid:VH,detailSection:HH,detailSectionTitle:zH,detailImages:qH,detailImage:UH,detailInfo:WH,detailItem:GH,detailLabel:JH,detailValue:KH,detailActions:YH},QH=({items:t,totalFilteredItems:e,searchQuery:r,selectedProducts:s,currencyCode:n,currencySymbol:a,currentPage:i,itemsPerPage:l,totalPages:c,expandedProductId:d,isAllSelected:u,loading:h=!1,onSelectAll:f,onCheckboxChange:p,onRowClick:_,onEditProduct:v,onMoveProduct:x,onPageChange:m,formatCurrency:g,getStatusInfo:y,getQuantityClass:w})=>o.jsx(o.Fragment,{children:h?o.jsx("div",{className:Q.loadingOverlay,children:o.jsx(Me,{size:"large"})}):t.length===0?o.jsxs("div",{className:Q.emptyState,children:[o.jsxs("svg",{className:Q.emptyIcon,width:"120",height:"120",viewBox:"0 0 120 120",fill:"none",children:[o.jsx("circle",{cx:"60",cy:"60",r:"50",fill:"#F0F6FF"}),o.jsx("rect",{x:"35",y:"35",width:"50",height:"50",rx:"4",fill:"white",stroke:"#0064FF",strokeWidth:"2"}),o.jsx("rect",{x:"40",y:"40",width:"40",height:"40",rx:"2",fill:"#F0F6FF",stroke:"#0064FF",strokeWidth:"1.5"}),o.jsx("line",{x1:"42",y1:"50",x2:"78",y2:"50",stroke:"#0064FF",strokeWidth:"2",strokeLinecap:"round"}),o.jsx("line",{x1:"42",y1:"60",x2:"78",y2:"60",stroke:"#0064FF",strokeWidth:"2",strokeLinecap:"round"}),o.jsx("line",{x1:"42",y1:"70",x2:"78",y2:"70",stroke:"#0064FF",strokeWidth:"2",strokeLinecap:"round"}),o.jsx("circle",{cx:"70",cy:"80",r:"12",fill:"#0064FF"}),o.jsx("circle",{cx:"70",cy:"80",r:"5",stroke:"white",strokeWidth:"2",fill:"none"}),o.jsx("line",{x1:"74",y1:"84",x2:"78",y2:"88",stroke:"white",strokeWidth:"2",strokeLinecap:"round"})]}),o.jsx("h3",{className:Q.emptyTitle,children:"No products found"}),o.jsx("p",{className:Q.emptyText,children:r?"No items match your search criteria":"Add products to start managing inventory"})]}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:Q.inventoryTableWrapper,children:o.jsxs("table",{className:Q.inventoryTable,children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{className:Q.checkboxCell,children:o.jsx("input",{type:"checkbox",className:Q.checkbox,checked:u,onChange:f})}),o.jsx("th",{className:Q.imageCell,children:"Image"}),o.jsx("th",{children:"Product Name"}),o.jsx("th",{children:"Product Code"}),o.jsx("th",{children:"Brand"}),o.jsx("th",{className:Q.quantityCell,children:"Quantity"}),o.jsxs("th",{className:Q.priceCell,children:["Price (",n,")"]}),o.jsxs("th",{className:Q.costCell,children:["Cost (",n,")"]}),o.jsx("th",{children:"Move"})]})}),o.jsx("tbody",{children:t.map(b=>{y(b);const C=w(b.currentStock),j=d===b.productId;return o.jsxs(Kr.Fragment,{children:[o.jsxs("tr",{className:`${Q.productRow} ${j?Q.expandedRow:""}`,onClick:()=>_(b.productId),style:{cursor:"pointer"},children:[o.jsx("td",{className:Q.checkboxCell,onClick:I=>I.stopPropagation(),children:o.jsx("input",{type:"checkbox",className:Q.checkbox,checked:s.has(b.productId),onChange:()=>p(b.productId)})}),o.jsx("td",{className:Q.imageCell,children:b.imageUrls&&b.imageUrls.length>0?o.jsx("img",{src:b.imageUrls[0],alt:b.productName,className:Q.productThumbnail}):o.jsx("div",{className:Q.noImagePlaceholder,children:o.jsx("svg",{width:"24",height:"24",fill:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{d:"M21,17H7V3H21M21,1H7A2,2 0 0,0 5,3V17A2,2 0 0,0 7,19H21A2,2 0 0,0 23,17V3A2,2 0 0,0 21,1M3,5H1V21A2,2 0 0,0 3,23H19V21H3M15.96,10.29L13.21,13.83L11.25,11.47L8.5,15H19.5L15.96,10.29Z"})})})}),o.jsx("td",{className:Q.productNameCell,children:o.jsx("span",{className:Q.productName,children:b.productName})}),o.jsx("td",{className:Q.productCodeCell,children:o.jsx("span",{className:Q.productCode,children:b.productCode})}),o.jsx("td",{className:Q.barcodeCell,children:o.jsx("span",{className:Q.barcode,children:b.brandName||"N/A"})}),o.jsx("td",{className:Q.quantityCell,children:o.jsx("span",{className:`${Q.quantityValue} ${C}`,children:b.currentStock})}),o.jsx("td",{className:Q.priceCell,children:o.jsx("div",{className:Q.priceValue,children:g(b.unitPrice)})}),o.jsx("td",{className:Q.costCell,children:o.jsx("div",{className:Q.costValue,children:g(b.costPrice)})}),o.jsx("td",{className:Q.moveCell,onClick:I=>I.stopPropagation(),children:o.jsx(Ne,{variant:"outline",size:"sm",onClick:()=>x(b.productId),icon:o.jsx("svg",{width:"14",height:"14",fill:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{d:"M6,13H14L10.5,16.5L11.92,17.92L17.84,12L11.92,6.08L10.5,7.5L14,11H6V13M20,6V18H11V20H20A2,2 0 0,0 22,18V6A2,2 0 0,0 20,4H11V6H20Z"})}),iconPosition:"left",customStyles:{backgroundColor:"white",color:"#0064FF",borderColor:"#0064FF",borderWidth:"1.5px",borderRadius:"8px",padding:"6px 12px",fontSize:"13px",cursor:"pointer"},children:"Move"})})]}),j&&o.jsx("tr",{className:Q.detailRow,children:o.jsx("td",{colSpan:9,children:o.jsxs("div",{className:Q.detailContent,children:[o.jsxs("div",{className:Q.detailGrid,children:[b.imageUrls&&b.imageUrls.length>0&&o.jsxs("div",{className:Q.detailSection,children:[o.jsx("h4",{className:Q.detailSectionTitle,children:"Product Images"}),o.jsx("div",{className:Q.detailImages,children:b.imageUrls.map((I,k)=>o.jsx("img",{src:I,alt:`${b.productName} ${k+1}`,className:Q.detailImage},k))})]}),o.jsxs("div",{className:Q.detailSection,children:[o.jsx("h4",{className:Q.detailSectionTitle,children:"Product Information"}),o.jsxs("div",{className:Q.detailInfo,children:[o.jsxs("div",{className:Q.detailItem,children:[o.jsx("span",{className:Q.detailLabel,children:"Category:"}),o.jsx("span",{className:Q.detailValue,children:b.categoryName})]}),o.jsxs("div",{className:Q.detailItem,children:[o.jsx("span",{className:Q.detailLabel,children:"Brand:"}),o.jsx("span",{className:Q.detailValue,children:b.brandName||"N/A"})]}),o.jsxs("div",{className:Q.detailItem,children:[o.jsx("span",{className:Q.detailLabel,children:"SKU:"}),o.jsx("span",{className:Q.detailValue,children:b.sku})]}),o.jsxs("div",{className:Q.detailItem,children:[o.jsx("span",{className:Q.detailLabel,children:"Barcode:"}),o.jsx("span",{className:Q.detailValue,children:b.barcode||"N/A"})]}),o.jsxs("div",{className:Q.detailItem,children:[o.jsx("span",{className:Q.detailLabel,children:"Unit:"}),o.jsx("span",{className:Q.detailValue,children:b.unit})]})]})]}),o.jsxs("div",{className:Q.detailSection,children:[o.jsx("h4",{className:Q.detailSectionTitle,children:"Stock & Price"}),o.jsxs("div",{className:Q.detailInfo,children:[o.jsxs("div",{className:Q.detailItem,children:[o.jsx("span",{className:Q.detailLabel,children:"Current Stock:"}),o.jsxs("span",{className:`${Q.detailValue} ${C}`,children:[b.currentStock," ",b.unit]})]}),o.jsxs("div",{className:Q.detailItem,children:[o.jsx("span",{className:Q.detailLabel,children:"Selling Price:"}),o.jsx("span",{className:Q.detailValue,children:g(b.unitPrice)})]}),o.jsxs("div",{className:Q.detailItem,children:[o.jsx("span",{className:Q.detailLabel,children:"Cost Price:"}),o.jsx("span",{className:Q.detailValue,children:g(b.costPrice)})]}),o.jsxs("div",{className:Q.detailItem,children:[o.jsx("span",{className:Q.detailLabel,children:"Total Value:"}),o.jsx("span",{className:Q.detailValue,children:g(b.totalValue)})]})]})]})]}),o.jsx("div",{className:Q.detailActions,children:o.jsx(Ne,{variant:"primary",size:"md",onClick:I=>{I.stopPropagation(),v(b.productId)},icon:o.jsx("svg",{width:"16",height:"16",fill:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"})}),iconPosition:"left",children:"Update Product"})})]})})})]},b.productId)})})]})}),e>0&&o.jsxs("div",{className:Q.pagination,children:[o.jsxs("div",{className:Q.paginationInfo,children:["Showing ",(i-1)*l+1,"-",Math.min(i*l,e)," of ",e," products"]}),o.jsxs("div",{className:Q.paginationControls,children:[o.jsx("button",{className:Q.paginationButton,onClick:()=>{const b=Math.floor((i-1)/5),C=Math.max(1,b*5);m(C)},disabled:i<=5,style:{opacity:i<=5?.4:1,cursor:i<=5?"not-allowed":"pointer"},children:o.jsx("svg",{width:"16",height:"16",fill:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{d:"M15.41,16.58L10.83,12L15.41,7.41L14,6L8,12L14,18L15.41,16.58Z"})})}),(()=>{const b=[],j=Math.floor((i-1)/5)*5+1,I=Math.min(j+4,c);for(let k=j;k<=I;k++)b.push(o.jsx("button",{className:`${Q.paginationButton} ${i===k?Q.active:""}`,onClick:()=>m(k),children:k},k));return b})(),o.jsx("button",{className:Q.paginationButton,onClick:()=>{const C=(Math.floor((i-1)/5)+1)*5+1,j=Math.min(C,c);m(j)},disabled:(Math.floor((i-1)/5)+1)*5+1>c,style:{opacity:(Math.floor((i-1)/5)+1)*5+1>c?.4:1,cursor:(Math.floor((i-1)/5)+1)*5+1>c?"not-allowed":"pointer"},children:o.jsx("svg",{width:"16",height:"16",fill:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{d:"M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z"})})})]})]})]})}),ZH="_pageLayout_6n8w6_7",XH="_sidebarWrapper_6n8w6_32",ez="_mainContent_6n8w6_38",tz="_container_6n8w6_45",rz="_header_6n8w6_51",sz="_title_6n8w6_55",nz="_subtitle_6n8w6_62",az="_controlsCard_6n8w6_70",oz="_controlSection_6n8w6_79",iz="_controlLabel_6n8w6_115",lz="_controlIcon_6n8w6_120",cz="_contentCard_6n8w6_239",lt={pageLayout:ZH,sidebarWrapper:XH,mainContent:ez,container:tz,header:rz,title:sz,subtitle:nz,controlsCard:az,controlSection:oz,controlLabel:iz,controlIcon:lz,contentCard:cz},dz=()=>{var Pm,Om;const{currentCompany:t,currentUser:e}=ht(),r=(t==null?void 0:t.company_id)||"",s=(e==null?void 0:e.user_id)||"",{inventory:n,currencySymbol:a,currencyCode:i,currentPage:l,itemsPerPage:c,totalItems:d,selectedStoreId:u,selectedProducts:h,filterType:f,selectedBrandFilter:p,selectedCategoryFilter:_,isModalOpen:v,selectedProductData:x,isAddProductModalOpen:m,loading:g,error:y,notification:w,setSelectedStoreId:b,setCurrentPage:C,toggleProductSelection:j,clearSelection:I,setFilterType:k,toggleBrandFilter:E,toggleCategoryFilter:T,clearBrandFilter:D,clearCategoryFilter:N,openModal:A,closeModal:$,openAddProductModal:z,closeAddProductModal:H,showNotification:L,hideNotification:B,loadBaseCurrency:O,loadInventory:M,updateProduct:R,importExcel:ie,moveProduct:Z}=Dx(),{metadata:Ie,error:Te,refresh:Ke}=VF(r,u||void 0),[ye,P]=S.useState(""),[xe,je]=S.useState(null),[ne,Ce]=S.useState(!1),[Ue,J]=S.useState(!1),[U,ue]=S.useState(null),{isExporting:ee,isImporting:F,fileInputRef:Y,handleExportExcel:le,handleImportExcel:ve,handleImportClick:ot}=zF({inventory:n,companyId:r,selectedStoreId:u,storeName:((Om=(Pm=t==null?void 0:t.stores)==null?void 0:Pm.find(it=>it.store_id===u))==null?void 0:Om.store_name)||"Store",currencyCode:i,loadInventory:M,importExcel:ie,showNotification:L});S.useEffect(()=>{const it=setTimeout(()=>{r&&u&&(C(1),M(r,u,ye))},300);return()=>clearTimeout(it)},[ye]),S.useEffect(()=>{t!=null&&t.stores&&t.stores.length>0&&!u&&b(t.stores[0].store_id)},[t,u,b]),S.useEffect(()=>{r&&O(r)},[r,O]),S.useEffect(()=>{r&&u&&(C(1),M(r,u,""))},[r,u,M]),S.useEffect(()=>{r&&u&&l>1&&M(r,u,ye)},[l]);const{uniqueBrands:He,uniqueCategories:Pt,filteredAndSortedInventory:Br}=qF({inventory:n,searchQuery:ye,filterType:f,selectedBrandFilter:p,selectedCategoryFilter:_}),Ao=n,Do=d,Mo=Math.ceil(d/c),{formatCurrency:Er,handleSelectAll:Ro,handleCheckboxChange:$d,handleEditProduct:te,handleDeleteProducts:Vt,handleAddProduct:bs,getStatusInfo:Js,getQuantityClass:cr}=UF({inventory:n,filteredAndSortedInventory:Br,currencySymbol:a,toggleProductSelection:j,clearSelection:I,openModal:A,openAddProductModal:z,showNotification:L,statusStyles:{statusOutOfStock:lt.statusOutOfStock,statusLowStock:lt.statusLowStock,statusInStock:lt.statusInStock,quantityOut:lt.quantityOut,quantityLow:lt.quantityLow}}),Rm=[{id:"sort",title:"Sort by",type:"sort",defaultExpanded:!0,selectedValues:f,options:[{value:"newest",label:"Newest"},{value:"oldest",label:"Oldest"},{value:"price_high",label:"Price: High to Low"},{value:"price_low",label:"Price: Low to High"},{value:"cost_high",label:"Cost: High to Low"},{value:"cost_low",label:"Cost: Low to High"}],onSelect:it=>k(it)},{id:"category",title:"Category",type:"multiselect",defaultExpanded:!1,showCount:!0,selectedValues:_,options:Pt.map(it=>({value:it,label:it})),emptyMessage:"No categories available",onToggle:T,onClear:N},{id:"brand",title:"Brand",type:"multiselect",defaultExpanded:!1,showCount:!0,selectedValues:p,options:He.map(it=>({value:it,label:it})),emptyMessage:"No brands available",onToggle:E,onClear:D}];if(!t)return o.jsxs(o.Fragment,{children:[o.jsx(Se,{activeItem:"product"}),o.jsxs("div",{className:lt.container,children:[o.jsx("div",{className:lt.header,children:o.jsx("h1",{className:lt.title,children:"Inventory"})}),o.jsx(Me,{fullscreen:!0,size:"large"})]})]});if(y)return o.jsxs(o.Fragment,{children:[o.jsx(Se,{activeItem:"product"}),o.jsxs("div",{className:lt.pageLayout,children:[o.jsx("div",{className:lt.sidebarWrapper,children:o.jsx(rf,{sections:Rm,width:240,topOffset:64})}),o.jsx("div",{className:lt.mainContent,children:o.jsxs("div",{className:lt.container,children:[o.jsxs("div",{className:lt.header,children:[o.jsx("h1",{className:lt.title,children:"Inventory"}),o.jsx("p",{className:lt.subtitle,children:"Manage product inventory across stores"})]}),o.jsx("div",{className:lt.controlsCard,children:o.jsxs("div",{className:lt.controlSection,children:[o.jsx("svg",{className:lt.controlIcon,fill:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{d:"M19,2H5A3,3 0 0,0 2,5V19A3,3 0 0,0 5,22H19A3,3 0 0,0 22,19V5A3,3 0 0,0 19,2M19,19H5V5H19V19Z"})}),o.jsx("span",{className:lt.controlLabel,children:"All Stores"})]})}),o.jsx("div",{className:lt.contentCard,children:o.jsx(Me,{fullscreen:!0,size:"large"})})]})})]}),o.jsx($e,{isOpen:!0,variant:"error",title:"Failed to Load Inventory",message:y,onClose:()=>{},confirmText:"Try Again",onConfirm:()=>M(r,u,""),closeOnBackdropClick:!1,closeOnEscape:!1,zIndex:9999})]});const Wx=Br.length>0&&Br.every(it=>h.has(it.productId));return o.jsxs(o.Fragment,{children:[o.jsx(Se,{activeItem:"product"}),o.jsxs("div",{className:lt.pageLayout,children:[o.jsx("div",{className:lt.sidebarWrapper,children:o.jsx(rf,{sections:Rm,width:240,topOffset:64})}),o.jsx("div",{className:lt.mainContent,children:o.jsxs("div",{className:lt.container,children:[o.jsxs("div",{className:lt.header,children:[o.jsx("h1",{className:lt.title,children:"Inventory"}),o.jsx("p",{className:lt.subtitle,children:"Manage product inventory across stores"})]}),o.jsx("div",{className:lt.controlsCard,children:o.jsx(ds,{stores:(t==null?void 0:t.stores)||[],selectedStoreId:u,onStoreSelect:b,companyId:t==null?void 0:t.company_id,showAllStoresOption:!1})}),o.jsxs("div",{className:lt.contentCard,children:[o.jsx(iH,{searchQuery:ye,onSearchChange:P,selectedCount:h.size,isExporting:ee,isImporting:F,totalItems:n.length,filterType:f,selectedBrandFilter:p,selectedCategoryFilter:_,brands:He,categories:Pt,onDelete:Vt,onMoveSelected:()=>{J(!0)},onExport:le,onImport:ot,onAddProduct:bs,onFilterChange:k,onBrandFilterToggle:E,onCategoryFilterToggle:T,onClearBrandFilter:D,onClearCategoryFilter:N,fileInputRef:Y,onFileChange:ve}),o.jsx(QH,{items:Ao,totalFilteredItems:Do,searchQuery:ye,selectedProducts:h,currencyCode:i,currencySymbol:a,currentPage:l,itemsPerPage:c,totalPages:Mo,expandedProductId:xe,isAllSelected:Wx,loading:g,onSelectAll:Ro,onCheckboxChange:$d,onRowClick:it=>je(xe===it?null:it),onEditProduct:te,onMoveProduct:it=>{const Ot=n.find(us=>us.productId===it);Ot&&(ue({productId:Ot.productId,productName:Ot.productName,currentStock:Ot.currentStock}),Ce(!0))},onPageChange:C,formatCurrency:Er,getStatusInfo:Js,getQuantityClass:cr})]})]})})]}),o.jsx(X7,{isOpen:v,onClose:$,productId:(x==null?void 0:x.productId)||"",companyId:r,productData:x,metadata:Ie,onSave:async(it,Ot)=>{const us=await R((x==null?void 0:x.productId)||"",r,u||"",it,Ot);us.success?L("success","Product updated successfully!"):L("error",us.error||"Failed to update product")},onMetadataRefresh:Ke}),o.jsx(mV,{isOpen:m,onClose:H,companyId:r,storeId:u,metadata:Ie,onProductAdded:()=>M(r,u),onMetadataRefresh:Ke}),o.jsx(_B,{isOpen:ne,onClose:()=>{Ce(!1),ue(null)},productId:(U==null?void 0:U.productId)||"",productName:(U==null?void 0:U.productName)||"",currentStock:(U==null?void 0:U.currentStock)||0,sourceStoreId:u||"",companyId:r,onMove:async(it,Ot,us)=>{if(console.log("Move Debug:",{selectedProductForMove:U,selectedStoreId:u,companyId:r,userId:s,targetStoreId:it,quantity:Ot,notes:us}),!(U!=null&&U.productId)||!u||!r||!s){console.error("Missing values:",{hasProductId:!!(U!=null&&U.productId),hasSelectedStoreId:!!u,hasCompanyId:!!r,hasUserId:!!s}),L("error","Missing required information");return}const Ks=await Z(r,u,it,U.productId,Ot,us,re.nowUtc(),s);Ks.success?(L("success","Product moved successfully!"),Ce(!1),ue(null)):L("error",Ks.error||"Failed to move product")}}),o.jsx(MB,{isOpen:Ue,onClose:()=>{J(!1)},products:Array.from(h).map(it=>{const Ot=n.find(us=>us.productId===it);return{productId:it,productName:(Ot==null?void 0:Ot.productName)||"",productCode:(Ot==null?void 0:Ot.productCode)||"",currentStock:(Ot==null?void 0:Ot.currentStock)||0}}),sourceStoreId:u||"",companyId:r,onMove:async(it,Ot,us)=>{if(console.log("Bulk Move Debug:",{selectedStoreId:u,companyId:r,userId:s,targetStoreId:it,items:Ot,notes:us}),!u||!r||!s){console.error("Missing values:",{hasSelectedStoreId:!!u,hasCompanyId:!!r,hasUserId:!!s}),L("error","Missing required information");return}let Ks=0,Fd=0;for(const $m of Ot)(await Z(r,u,it,$m.productId,$m.quantity,us,re.nowUtc(),s)).success?Ks++:Fd++;Fd===0?(L("success",`Successfully moved ${Ks} product${Ks>1?"s":""}!`),J(!1),I()):Ks>0?(L("warning",`Moved ${Ks} product${Ks>1?"s":""}, ${Fd} failed`),J(!1),I()):L("error","Failed to move products")}}),o.jsx($e,{isOpen:w.isOpen,variant:w.variant,message:w.message,onClose:B,autoCloseDuration:2e3,zIndex:9999}),Te&&o.jsx($e,{isOpen:!0,variant:"warning",title:"Failed to Load Metadata",message:Te,onClose:()=>{},confirmText:"Retry",onConfirm:Ke,showCancelButton:!0,cancelText:"Dismiss",zIndex:9998}),F&&o.jsx(Me,{size:"large",fullscreen:!0})]})};class $x{async getInvoices(e,r,s,n,a,i,l){const c=se.getClient(),d={p_company_id:e,p_store_id:r,p_page:s,p_limit:n,p_search:a,p_start_date:i,p_end_date:l},{data:u,error:h}=await c.rpc("get_invoice_page",d);if(h)throw console.error(" Error fetching invoices:",h),new Error(h.message);return u}async getInvoiceDetail(e){const r=se.getClient(),{data:s,error:n}=await r.rpc("get_invoice_detail",{p_invoice_id:e});if(n)throw console.error(" Error fetching invoice detail:",n),new Error(n.message);return s}async refundInvoice(e,r,s){const n=se.getClient(),{data:a,error:i}=await n.rpc("inventory_refund_invoice",{p_invoice_id:e,p_refund_date:re.nowUtc(),p_refund_reason:r||null,p_created_by:s||null});if(i)throw console.error(" Error refunding invoice:",i),new Error(i.message);return a}async refundInvoices(e,r,s){const n=se.getClient(),{data:a,error:i}=await n.rpc("inventory_refund_invoice",{p_invoice_ids:e,p_refund_date:re.nowUtc(),p_notes:r||null,p_created_by:s});if(i)throw console.error(" Error refunding invoices:",i),new Error(i.message);return a}async insertRefundJournalEntry(e){const r=se.getClient();try{const s=`${e.invoiceNumber} Refund`,n={account_id:Ci.CASH,debit:"0",credit:e.refundAmount.toString(),description:s};e.cashLocationId&&(n.cash={cash_location_id:e.cashLocationId});const a=[{account_id:Ci.SALES_REVENUE,debit:e.refundAmount.toString(),credit:"0",description:s},n],i={p_base_amount:e.refundAmount,p_company_id:e.companyId,p_created_by:e.createdBy,p_description:`${e.invoiceNumber} refund`,p_entry_date:re.toRpcFormat(new Date),p_lines:a,p_store_id:e.storeId,p_counterparty_id:null,p_if_cash_location_id:null};console.log(" Creating refund journal entry:",i);const{data:l,error:c}=await r.rpc("insert_journal_with_everything",i);return c?(console.error(" Error creating refund journal entry:",c),{success:!1,error:c.message}):(console.log(" Refund journal entry created:",l),{success:!0,journal_id:l})}catch(s){return console.error(" Exception creating refund journal entry:",s),{success:!1,error:s instanceof Error?s.message:"Failed to create journal entry"}}}}class uz{constructor(e,r,s,n,a,i,l,c,d,u,h,f,p="cash",_="pending"){this.invoiceId=e,this.invoiceNumber=r,this.invoiceDate=s,this.storeId=n,this.cashLocationId=a,this.customerName=i,this.customerPhone=l,this.itemCount=c,this.totalQuantity=d,this.totalAmount=u,this.status=h,this.currencySymbol=f,this.paymentMethod=p,this.paymentStatus=_}get statusDisplay(){switch(this.status){case"draft":return"Draft";case"issued":return"Issued";case"paid":return"Paid";case"cancelled":return"Cancelled";default:return this.status}}formatCurrency(e){const r=e??0;return`${this.currencySymbol}${r.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})}`}get formattedDate(){if(!this.invoiceDate)return"Invalid Date";try{return new Date(this.invoiceDate).toLocaleDateString("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit"})}catch(e){return console.error("Error formatting date:",this.invoiceDate,e),"Invalid Date"}}get isEditable(){return this.status==="draft"}get isCancellable(){return this.status==="draft"||this.status==="issued"}get paymentMethodDisplay(){return{cash:"Cash",card:"Card",bank:"Bank",transfer:"Bank",bank_transfer:"Bank"}[this.paymentMethod]||this.paymentMethod}get paymentBadgeClass(){const e=this.paymentMethod.toLowerCase();return e==="bank"||e==="transfer"?"payment-bank":e==="card"?"payment-card":e==="cash"?"payment-cash":"payment-default"}}class hz{static fromJson(e,r){var v,x,m,g,y,w,b,C,j,I,k;const s=((v=e.customer)==null?void 0:v.name)||"Walk-in",n=((x=e.customer)==null?void 0:x.phone)||null,a=((m=e.items_summary)==null?void 0:m.item_count)||0,i=((g=e.items_summary)==null?void 0:g.total_quantity)||0,l=((y=e.amounts)==null?void 0:y.total_amount)||0,c=r||((w=e.amounts)==null?void 0:w.currency_symbol)||((b=e.store)==null?void 0:b.currency_symbol)||"",d=((C=e.payment)==null?void 0:C.method)||"cash",u=((j=e.payment)==null?void 0:j.status)||"pending",h=e.invoice_date||e.sale_date,f=h?re.toLocal(h).toISOString():"",p=((I=e.store)==null?void 0:I.store_id)||e.store_id||"",_=((k=e.cash_location)==null?void 0:k.cash_location_id)||null;return new uz(e.invoice_id,e.invoice_number,f,p,_,s,n,a,i,l,e.status,c,d,u)}static fromJsonArray(e,r){return e.map(s=>this.fromJson(s,r))}static toJson(e){return{invoice_id:e.invoiceId,invoice_number:e.invoiceNumber,invoice_date:e.invoiceDate,store_id:e.storeId,cash_location_id:e.cashLocationId,customer_name:e.customerName,customer_phone:e.customerPhone,item_count:e.itemCount,total_quantity:e.totalQuantity,total_amount:e.totalAmount,status:e.status,currency_symbol:e.currencySymbol,payment_method:e.paymentMethod,payment_status:e.paymentStatus}}static toJsonArray(e){return e.map(r=>this.toJson(r))}static isValidApiResponse(e){return e&&typeof e=="object"&&typeof e.invoice_id=="string"&&typeof e.invoice_number=="string"&&typeof e.status=="string"}static extractCurrencySymbol(e){var r,s,n;return((r=e.amounts)==null?void 0:r.currency_symbol)||((s=e.store)==null?void 0:s.currency_symbol)||((n=e.currency)==null?void 0:n.symbol)||""}static extractPaginationInfo(e){return e.pagination?{current_page:e.pagination.current_page||1,total_pages:e.pagination.total_pages||1,total_count:e.pagination.total_count||0,has_next:e.pagination.has_next||!1,has_prev:e.pagination.has_prev||!1}:null}}class fz{constructor(){W(this,"dataSource");this.dataSource=new $x}async getInvoices(e,r,s,n,a,i,l){var c;try{const d=await this.dataSource.getInvoices(e,r,s,n,a,i,l);if(!d.success||!d.data)return{success:!1,error:d.error||"Failed to fetch invoices"};const u=(c=d.data.currency)==null?void 0:c.symbol;return{success:!0,data:hz.fromJsonArray(d.data.invoices,u),pagination:d.data.pagination}}catch(d){return console.error(" Repository error fetching invoices:",d),{success:!1,error:d instanceof Error?d.message:"Failed to fetch invoices"}}}async getInvoiceDetail(e){try{const r=await this.dataSource.getInvoiceDetail(e);return!r.success||!r.data?{success:!1,error:r.error||"Failed to fetch invoice detail"}:{success:!0,data:r.data,message:r.message}}catch(r){return console.error(" Repository error fetching invoice detail:",r),{success:!1,error:r instanceof Error?r.message:"Failed to fetch invoice detail"}}}async refundInvoice(e,r,s){try{const n=await this.dataSource.refundInvoice(e,r,s);return n.success?{success:!0,message:n.message||"Invoice refunded successfully"}:{success:!1,error:n.error||"Failed to refund invoice"}}catch(n){return console.error(" Repository error refunding invoice:",n),{success:!1,error:n instanceof Error?n.message:"Failed to refund invoice"}}}async refundInvoices(e,r,s){try{return{success:!0,data:await this.dataSource.refundInvoices(e,r,s)}}catch(n){return console.error(" Repository error refunding invoices:",n),{success:!1,error:n instanceof Error?n.message:"Failed to refund invoices"}}}}const ac=new fz,ny=()=>{const t=new Date;return{start:new Date(t.getFullYear()-10,0,1).toISOString().split("T")[0],end:t.toISOString().split("T")[0]}},gt=er((t,e)=>({invoices:[],selectedInvoice:null,invoiceDetail:null,loading:!0,detailLoading:!1,refunding:!1,error:null,selectedStoreId:null,currentPage:1,itemsPerPage:20,searchQuery:"",dateRange:ny(),activeFilter:"all",pagination:null,setInvoices:r=>t({invoices:r}),setSelectedInvoice:r=>t({selectedInvoice:r}),setInvoiceDetail:r=>t({invoiceDetail:r}),setSelectedStoreId:r=>{t({selectedStoreId:r,currentPage:1})},setActiveFilter:r=>t({activeFilter:r}),setLoading:r=>t({loading:r}),setDetailLoading:r=>t({detailLoading:r}),setRefunding:r=>t({refunding:r}),setError:r=>t({error:r}),setPagination:r=>t({pagination:r}),changeDateRange:(r,s)=>{t({dateRange:{start:r,end:s},currentPage:1})},changeSearch:r=>{t({searchQuery:r,currentPage:1})},changePage:r=>{t({currentPage:r})},loadInvoices:async r=>{var n;const s=e();console.log(" InvoiceProvider.loadInvoices - starting...",{companyId:r,storeId:s.selectedStoreId,currentPage:s.currentPage,searchQuery:s.searchQuery,dateRange:s.dateRange}),t({loading:!0,error:null});try{const a=await ac.getInvoices(r,s.selectedStoreId,s.currentPage,s.itemsPerPage,s.searchQuery||null,s.dateRange.start,s.dateRange.end);if(console.log(" InvoiceProvider.loadInvoices - result:",a),!a.success){console.log(" InvoiceProvider - Result not successful:",a.error),t({error:a.error||"Failed to load invoices",invoices:[],pagination:null});return}console.log(" InvoiceProvider - Setting invoices:",((n=a.data)==null?void 0:n.length)||0),t({invoices:a.data||[],pagination:a.pagination||null,error:null})}catch(a){console.error(" InvoiceProvider.loadInvoices - error:",a),t({error:a instanceof Error?a.message:"An unexpected error occurred",invoices:[],pagination:null})}finally{t({loading:!1})}},fetchInvoiceDetail:async r=>{console.log(" InvoiceProvider.fetchInvoiceDetail - starting...",{invoiceId:r}),t({detailLoading:!0});try{const s=await ac.getInvoiceDetail(r);if(!s.success){console.error(" InvoiceProvider.fetchInvoiceDetail - failed:",s.error),t({invoiceDetail:null});return}console.log(" InvoiceProvider.fetchInvoiceDetail - success"),t({invoiceDetail:s.data||null})}catch(s){console.error(" InvoiceProvider.fetchInvoiceDetail - error:",s),t({invoiceDetail:null})}finally{t({detailLoading:!1})}},refundInvoice:async(r,s,n)=>{console.log(" InvoiceProvider.refundInvoice - starting...",{invoiceId:r,refundReason:s}),t({refunding:!0});try{const a=await ac.refundInvoice(r,s,n);return a.success?(console.log(" InvoiceProvider.refundInvoice - success"),{success:!0,message:a.message||"Invoice refunded successfully"}):(console.error(" InvoiceProvider.refundInvoice - failed:",a.error),{success:!1,error:a.error||"Failed to refund invoice"})}catch(a){return console.error(" InvoiceProvider.refundInvoice - error:",a),{success:!1,error:a instanceof Error?a.message:"An unexpected error occurred"}}finally{t({refunding:!1})}},refundInvoices:async(r,s,n)=>{console.log(" InvoiceProvider.refundInvoices - starting...",{invoiceIds:r,notes:s}),t({refunding:!0});try{const a=await ac.refundInvoices(r,s,n);return!a.success||!a.data?(console.error(" InvoiceProvider.refundInvoices - failed:",a.error),{success:!1,error:a.error||"Failed to refund invoices"}):(console.log(" InvoiceProvider.refundInvoices - success",a.data),{success:!0,data:a.data})}catch(a){return console.error(" InvoiceProvider.refundInvoices - error:",a),{success:!1,error:a instanceof Error?a.message:"An unexpected error occurred"}}finally{t({refunding:!1})}},refresh:async r=>{console.log(" InvoiceProvider.refresh - reloading invoices..."),await e().loadInvoices(r)},clearDetail:()=>{t({invoiceDetail:null,selectedInvoice:null})},reset:()=>{t({invoices:[],selectedInvoice:null,invoiceDetail:null,loading:!0,detailLoading:!1,refunding:!1,error:null,currentPage:1,searchQuery:"",dateRange:ny(),activeFilter:"all",pagination:null})}})),Fx=t=>{const e=gt(A=>A.invoices),r=gt(A=>A.loading),s=gt(A=>A.error),n=gt(A=>A.pagination),a=gt(A=>A.currentPage),i=gt(A=>A.itemsPerPage),l=gt(A=>A.searchQuery),c=gt(A=>A.dateRange),d=gt(A=>A.selectedStoreId),u=gt(A=>A.activeFilter),h=gt(A=>A.selectedInvoice),f=gt(A=>A.invoiceDetail),p=gt(A=>A.detailLoading),_=gt(A=>A.refunding),v=gt(A=>A.setSelectedStoreId),x=gt(A=>A.setActiveFilter),m=gt(A=>A.setSelectedInvoice),g=gt(A=>A.changeDateRange),y=gt(A=>A.changeSearch),w=gt(A=>A.changePage),b=gt(A=>A.loadInvoices),C=gt(A=>A.fetchInvoiceDetail),j=gt(A=>A.refundInvoice),I=gt(A=>A.refundInvoices),k=gt(A=>A.refresh),E=gt(A=>A.clearDetail);return S.useEffect(()=>{t&&t!==""?(console.log(" useInvoice - useEffect triggered, loading invoices..."),b(t)):console.log(" useInvoice - No companyId, skipping load")},[t,d,a,c,b]),{invoices:e,loading:r,error:s,pagination:n,currentPage:a,itemsPerPage:i,searchQuery:l,dateRange:c,selectedStoreId:d,activeFilter:u,selectedInvoice:h,invoiceDetail:f,detailLoading:p,refunding:_,setSelectedStoreId:A=>{console.log(" useInvoice.handleStoreChange - storeId:",A),v(A)},setActiveFilter:x,setSelectedInvoice:m,changeDateRange:(A,$,z)=>{console.log(" useInvoice.handleDateFilterChange:",{filter:A,start:$,end:z}),x(A),g($,z)},changeSearch:y,changePage:w,fetchInvoiceDetail:C,refundInvoice:j,refundInvoices:I,refresh:()=>{console.log(" useInvoice.handleRefresh - reloading..."),k(t)},clearDetail:E}},mz=()=>{const{refundInvoices:t,refresh:e}=Fx();return{refundInvoicesWithJournal:async s=>{const{invoiceIds:n,notes:a,companyId:i,userId:l,invoices:c}=s,d=await t(n,a,l);if(!d.success||!d.data)return{success:!1,totalSucceeded:0,totalFailed:n.length,totalAmountRefunded:0,journalSuccessCount:0,journalFailCount:0,error:d.error||"Failed to refund invoices"};const{total_succeeded:u,total_failed:h,total_amount_refunded:f,results:p}=d.data;console.log(" Starting journal entry creation for results:",p);const _=new $x;let v=0,x=0;for(const m of p)if(console.log(" Processing refund result:",m),m.success){const g=c.find(y=>y.invoiceId===m.invoice_id);if(console.log(" Found invoice for journal entry:",g),g){const y=m.amount_refunded||g.totalAmount;console.log(" Calling insertRefundJournalEntry with params:",{companyId:i,storeId:g.storeId,createdBy:l,invoiceNumber:m.invoice_number,refundAmount:y,cashLocationId:g.cashLocationId});const w=await _.insertRefundJournalEntry({companyId:i,storeId:g.storeId,createdBy:l,invoiceNumber:m.invoice_number,refundAmount:y,cashLocationId:g.cashLocationId});w.success?(v++,console.log(` Journal entry created for invoice ${m.invoice_number}`)):(x++,console.error(` Failed to create journal entry for invoice ${m.invoice_number}:`,w.error))}else console.error(" Invoice not found for refund result:",m)}else console.log(" Skipping refund result (not successful):",m);return console.log(" Journal entry creation complete. Success:",v,"Failed:",x),e(),{success:h===0&&x===0,totalSucceeded:u,totalFailed:h,totalAmountRefunded:f,journalSuccessCount:v,journalFailCount:x}}}},pz="_searchActionsContainer_zxwcw_6",gz="_searchSection_zxwcw_18",_z="_sectionTitle_zxwcw_25",yz="_searchWrapper_zxwcw_32",vz="_searchInput_zxwcw_37",xz="_searchIcon_zxwcw_59",bz="_searchClear_zxwcw_70",wz="_actionsSection_zxwcw_94",pn={searchActionsContainer:pz,searchSection:gz,sectionTitle:_z,searchWrapper:yz,searchInput:vz,searchIcon:xz,searchClear:bz,actionsSection:wz},Sz=({localSearchQuery:t,onSearchChange:e,selectedInvoicesCount:r,hasSelectedCancelledInvoice:s,onRefund:n,onNewInvoice:a})=>o.jsxs("div",{className:pn.searchActionsContainer,children:[o.jsxs("div",{className:pn.searchSection,children:[o.jsx("h2",{className:pn.sectionTitle,children:"Invoices"}),o.jsxs("div",{className:pn.searchWrapper,children:[o.jsx("svg",{className:pn.searchIcon,fill:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"})}),o.jsx("input",{type:"text",className:pn.searchInput,placeholder:"Search invoices...",value:t,onChange:i=>e(i.target.value)}),t&&o.jsx("button",{className:pn.searchClear,onClick:()=>e(""),children:o.jsx("svg",{fill:"currentColor",viewBox:"0 0 24 24",width:"16",height:"16",children:o.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})})})]})]}),o.jsx("div",{className:pn.actionsSection,children:o.jsx(Ne,{variant:"secondary",size:"md",onClick:n,disabled:r===0||s,icon:o.jsx("svg",{width:"16",height:"16",fill:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{d:"M12.5,8C9.85,8 7.45,9 5.6,10.6L2,7V16H11L7.38,12.38C8.77,11.22 10.54,10.5 12.5,10.5C16.04,10.5 19.05,12.81 20.1,16L22.47,15.22C21.08,11.03 17.15,8 12.5,8Z"})}),iconPosition:"left",children:"Refund"})})]}),jz="_detailLoading_1qppm_5",Cz="_detailError_1qppm_12",Nz="_detailBottomGrid_1qppm_19",Iz="_detailSection_1qppm_25",kz="_detailSectionTitle_1qppm_32",Ez="_detailInfo_1qppm_41",Tz="_detailItem_1qppm_47",Lz="_detailLabel_1qppm_59",Az="_detailValue_1qppm_65",Dz="_detailItems_1qppm_73",Mz="_itemsTable_1qppm_79",Rz="_detailActions_1qppm_86",et={detailLoading:jz,detailError:Cz,detailBottomGrid:Nz,detailSection:Iz,detailSectionTitle:kz,detailInfo:Ez,detailItem:Tz,detailLabel:Lz,detailValue:Az,detailItems:Dz,itemsTable:Mz,detailActions:Rz},Pz=({invoice:t,invoiceDetail:e,detailLoading:r,refunding:s,onRefund:n})=>r?o.jsx("div",{className:et.detailLoading,children:o.jsx(Me,{size:"medium"})}):e?o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:et.detailSection,style:{marginBottom:"16px",paddingLeft:"24px"},children:[o.jsxs("h4",{className:et.detailSectionTitle,children:["Items (",e.items.length,")"]}),o.jsx("div",{className:et.detailItems,children:o.jsxs("table",{className:et.itemsTable,children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Product"}),o.jsx("th",{children:"SKU"}),o.jsx("th",{children:"Qty"}),o.jsx("th",{children:"Unit Price"}),o.jsx("th",{children:"Unit Cost"}),o.jsx("th",{children:"Discount"}),o.jsx("th",{children:"Total"})]})}),o.jsx("tbody",{children:e.items.map(a=>o.jsxs("tr",{children:[o.jsx("td",{children:a.product_name}),o.jsx("td",{children:a.sku}),o.jsx("td",{children:a.quantity_sold}),o.jsx("td",{children:t.formatCurrency(a.unit_price)}),o.jsx("td",{children:t.formatCurrency(a.unit_cost)}),o.jsx("td",{children:t.formatCurrency(a.discount_amount)}),o.jsx("td",{children:o.jsx("strong",{children:t.formatCurrency(a.total_amount)})})]},a.item_id))})]})})]}),o.jsxs("div",{className:et.detailBottomGrid,children:[o.jsxs("div",{className:et.detailSection,children:[o.jsx("h4",{className:et.detailSectionTitle,children:"Store & Date"}),o.jsxs("div",{className:et.detailInfo,children:[o.jsxs("div",{className:et.detailItem,children:[o.jsx("span",{className:et.detailLabel,children:"Store:"}),o.jsx("span",{className:et.detailValue,children:e.invoice.store_name})]}),o.jsxs("div",{className:et.detailItem,children:[o.jsx("span",{className:et.detailLabel,children:"Sale Date:"}),o.jsx("span",{className:et.detailValue,children:new Date(e.invoice.sale_date).toLocaleString("en-US")})]})]})]}),o.jsxs("div",{className:et.detailSection,children:[o.jsx("h4",{className:et.detailSectionTitle,children:"Amount Summary"}),o.jsxs("div",{className:et.detailInfo,children:[o.jsxs("div",{className:et.detailItem,children:[o.jsx("span",{className:et.detailLabel,children:"Subtotal:"}),o.jsx("span",{className:et.detailValue,children:t.formatCurrency(e.amounts.subtotal)})]}),o.jsxs("div",{className:et.detailItem,children:[o.jsx("span",{className:et.detailLabel,children:"Tax:"}),o.jsx("span",{className:et.detailValue,children:t.formatCurrency(e.amounts.tax_amount)})]}),o.jsxs("div",{className:et.detailItem,children:[o.jsx("span",{className:et.detailLabel,children:"Discount:"}),o.jsx("span",{className:et.detailValue,children:t.formatCurrency(e.amounts.discount_amount)})]}),o.jsxs("div",{className:et.detailItem,style:{borderTop:"2px solid #E9ECEF",paddingTop:"12px",marginTop:"8px"},children:[o.jsx("span",{className:et.detailLabel,style:{fontWeight:600,fontSize:"15px"},children:"Total:"}),o.jsx("span",{className:et.detailValue,style:{fontWeight:700,fontSize:"17px",color:"#0064FF"},children:t.formatCurrency(e.amounts.total_amount)})]})]})]})]}),e.invoice.status==="completed"&&o.jsx("div",{className:et.detailActions,children:o.jsx(Ne,{variant:"error",size:"md",onClick:()=>n(t.invoiceId),disabled:s,children:s?"Refunding...":"Refund Invoice"})})]}):o.jsx("div",{className:et.detailError,children:o.jsx("p",{children:"Failed to load invoice details"})}),Oz="_invoiceTableContainer_h808l_5",$z="_invoiceTable_h808l_5",Fz="_checkboxCell_h808l_38",Bz="_checkbox_h808l_38",Vz="_invoiceRow_h808l_64",Hz="_expandedRow_h808l_68",zz="_invoiceNumber_h808l_73",qz="_invoiceDate_h808l_79",Uz="_customerCell_h808l_84",Wz="_itemsCell_h808l_89",Gz="_itemCount_h808l_95",Jz="_itemQty_h808l_100",Kz="_paymentCell_h808l_105",Yz="_paymentBadge_h808l_109",Qz="_paymentPaid_h808l_140",Zz="_paymentPending_h808l_146",Xz="_totalCell_h808l_151",eq="_statusCell_h808l_157",tq="_statusBadge_h808l_161",rq="_completed_h808l_170",sq="_pending_h808l_175",nq="_cancelled_h808l_180",aq="_refunded_h808l_185",oq="_actionsCell_h808l_190",iq="_actionBtn_h808l_194",lq="_detailRow_h808l_213",cq="_detailContent_h808l_223",dq="_slideDown_h808l_1",uq="_emptyStateCell_h808l_240",hq="_emptyState_h808l_240",fq="_emptyIcon_h808l_255",mq="_emptyTitle_h808l_259",pq="_emptyText_h808l_266",at={invoiceTableContainer:Oz,invoiceTable:$z,checkboxCell:Fz,checkbox:Bz,invoiceRow:Vz,expandedRow:Hz,invoiceNumber:zz,invoiceDate:qz,customerCell:Uz,itemsCell:Wz,itemCount:Gz,itemQty:Jz,paymentCell:Kz,paymentBadge:Yz,"payment-cash":"_payment-cash_h808l_118","payment-bank":"_payment-bank_h808l_123","payment-card":"_payment-card_h808l_128","payment-default":"_payment-default_h808l_133","payment-paid":"_payment-paid_h808l_139",paymentPaid:Qz,"payment-pending":"_payment-pending_h808l_145",paymentPending:Zz,totalCell:Xz,statusCell:eq,statusBadge:tq,completed:rq,pending:sq,cancelled:nq,refunded:aq,actionsCell:oq,actionBtn:iq,detailRow:lq,detailContent:cq,slideDown:dq,emptyStateCell:uq,emptyState:hq,emptyIcon:fq,emptyTitle:mq,emptyText:pq},gq=({invoices:t,selectedInvoices:e,expandedInvoiceId:r,invoiceDetail:s,detailLoading:n,refunding:a,localSearchQuery:i,onToggleSelection:l,onSelectAll:c,onRowClick:d,onRefund:u})=>o.jsx("div",{className:at.invoiceTableContainer,children:o.jsxs("table",{className:at.invoiceTable,children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{className:at.checkboxCell,children:o.jsx("input",{type:"checkbox",checked:t.length>0&&e.size===t.length,onChange:c,className:at.checkbox,disabled:t.length===0})}),o.jsx("th",{children:"INVOICE #"}),o.jsx("th",{children:"DATE"}),o.jsx("th",{children:"CUSTOMER"}),o.jsx("th",{children:"ITEMS"}),o.jsx("th",{className:at.paymentCell,children:"PAYMENT"}),o.jsx("th",{children:"TOTAL"}),o.jsx("th",{className:at.statusCell,children:"STATUS"})]})}),o.jsx("tbody",{children:t.length===0?o.jsx("tr",{children:o.jsx("td",{colSpan:8,className:at.emptyStateCell,children:o.jsxs("div",{className:at.emptyState,children:[o.jsxs("svg",{className:at.emptyIcon,width:"120",height:"120",viewBox:"0 0 120 120",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[o.jsx("circle",{cx:"60",cy:"60",r:"50",fill:"#F0F6FF"}),o.jsx("rect",{x:"35",y:"40",width:"50",height:"60",rx:"4",fill:"white",stroke:"#0064FF",strokeWidth:"2"}),o.jsx("rect",{x:"40",y:"35",width:"50",height:"60",rx:"4",fill:"white",stroke:"#0064FF",strokeWidth:"2"}),o.jsx("line",{x1:"48",y1:"45",x2:"75",y2:"45",stroke:"#E9ECEF",strokeWidth:"2",strokeLinecap:"round"}),o.jsx("line",{x1:"48",y1:"52",x2:"70",y2:"52",stroke:"#E9ECEF",strokeWidth:"2",strokeLinecap:"round"}),o.jsx("line",{x1:"48",y1:"59",x2:"72",y2:"59",stroke:"#E9ECEF",strokeWidth:"2",strokeLinecap:"round"}),o.jsx("circle",{cx:"60",cy:"75",r:"12",fill:"#0064FF"}),o.jsx("path",{d:"M56 75 L58 77 L64 71",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),o.jsx("h3",{className:at.emptyTitle,children:"No Invoices"}),o.jsx("p",{className:at.emptyText,children:i?`No invoices found matching "${i}"`:"No invoice records found for the selected period"})]})})}):t.map(h=>{const f=r===h.invoiceId;return o.jsxs(Kr.Fragment,{children:[o.jsxs("tr",{className:`${at.invoiceRow} ${f?at.expandedRow:""}`,onClick:()=>d(h.invoiceId),style:{cursor:"pointer"},children:[o.jsx("td",{className:at.checkboxCell,onClick:p=>p.stopPropagation(),children:o.jsx("input",{type:"checkbox",checked:e.has(h.invoiceId),onChange:()=>l(h.invoiceId),className:at.checkbox})}),o.jsx("td",{className:at.invoiceNumber,children:h.invoiceNumber}),o.jsx("td",{className:at.invoiceDate,children:h.formattedDate}),o.jsx("td",{className:at.customerCell,children:h.customerName}),o.jsxs("td",{className:at.itemsCell,children:[o.jsxs("div",{className:at.itemCount,children:[h.itemCount," items"]}),o.jsxs("div",{className:at.itemQty,children:["Qty: ",h.totalQuantity]})]}),o.jsx("td",{className:at.paymentCell,children:o.jsx("span",{className:`${at.paymentBadge} ${at[h.paymentBadgeClass]}`,children:h.paymentMethodDisplay})}),o.jsx("td",{className:at.totalCell,children:h.formatCurrency(h.totalAmount)}),o.jsx("td",{className:at.statusCell,children:o.jsx("span",{className:`${at.statusBadge} ${at[h.status]}`,children:h.statusDisplay.toUpperCase()})})]}),f&&o.jsx("tr",{className:at.detailRow,children:o.jsx("td",{colSpan:8,children:o.jsx("div",{className:at.detailContent,children:o.jsx(Pz,{invoice:h,invoiceDetail:s,detailLoading:n,refunding:a,onRefund:u})})})})]},h.invoiceId)})})]})}),_q="_pagination_15p5t_5",yq="_paginationInfo_15p5t_15",vq="_paginationControls_15p5t_20",xq="_paginationArrow_15p5t_26",bq="_paginationNumber_15p5t_50",wq="_active_15p5t_66",ta={pagination:_q,paginationInfo:yq,paginationControls:vq,paginationArrow:xq,paginationNumber:bq,active:wq},Sq=({pagination:t,currentPage:e,itemsPerPage:r,onPageChange:s})=>{const n=t.total_count||t.total_pages*r,a=(e-1)*r+1,i=Math.min(e*r,n);return o.jsxs("div",{className:ta.pagination,children:[o.jsx("div",{className:ta.paginationInfo,children:`Showing ${a}-${i} of ${n} invoices`}),o.jsxs("div",{className:ta.paginationControls,children:[o.jsx("button",{className:ta.paginationArrow,onClick:()=>s(e-1),disabled:!t.has_prev,children:o.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M15.41,16.58L10.83,12L15.41,7.41L14,6L8,12L14,18L15.41,16.58Z"})})}),Array.from({length:Math.min(5,t.total_pages)},(l,c)=>{let d;return t.total_pages<=5||e<=3?d=c+1:e>=t.total_pages-2?d=t.total_pages-4+c:d=e-2+c,o.jsx("button",{className:`${ta.paginationNumber} ${e===d?ta.active:""}`,onClick:()=>s(d),children:d},d)}),o.jsx("button",{className:ta.paginationArrow,onClick:()=>s(e+1),disabled:!t.has_next,children:o.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z"})})})]})]})},jq="_overlay_1b342_5",Cq="_modal_1b342_28",Nq="_header_1b342_51",Iq="_title_1b342_59",kq="_closeButton_1b342_66",Eq="_body_1b342_90",Tq="_section_1b342_94",Lq="_sectionTitle_1b342_98",Aq="_invoiceList_1b342_105",Dq="_invoiceItem_1b342_113",Mq="_invoiceNumber_1b342_125",Rq="_invoiceAmount_1b342_131",Pq="_totalAmount_1b342_137",Oq="_notesLabel_1b342_153",$q="_notesTextarea_1b342_161",Fq="_footer_1b342_184",Bq="_cancelButton_1b342_194",Vq="_refundButton_1b342_212",rr={overlay:jq,modal:Cq,header:Nq,title:Iq,closeButton:kq,body:Eq,section:Tq,sectionTitle:Lq,invoiceList:Aq,invoiceItem:Dq,invoiceNumber:Mq,invoiceAmount:Rq,totalAmount:Pq,notesLabel:Oq,notesTextarea:$q,footer:Fq,cancelButton:Bq,refundButton:Vq},Hq=({isOpen:t,selectedInvoices:e,onClose:r,onConfirm:s,isRefunding:n=!1})=>{var f;const[a,i]=S.useState("");if(!t)return null;const l=e.reduce((p,_)=>p+_.amount,0),c=((f=e[0])==null?void 0:f.currencySymbol)||"",d=p=>`${c}${p.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})}`,u=()=>{s(a)},h=p=>{p.target===p.currentTarget&&r()};return o.jsx("div",{className:rr.overlay,onClick:h,children:o.jsxs("div",{className:rr.modal,children:[o.jsxs("div",{className:rr.header,children:[o.jsx("h2",{className:rr.title,children:"Refund Invoices"}),o.jsx("button",{className:rr.closeButton,onClick:r,disabled:n,children:o.jsx("svg",{fill:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})})})]}),o.jsxs("div",{className:rr.body,children:[o.jsxs("div",{className:rr.section,children:[o.jsxs("h3",{className:rr.sectionTitle,children:["Invoices (",e.length,")"]}),o.jsx("div",{className:rr.invoiceList,children:e.map(p=>o.jsxs("div",{className:rr.invoiceItem,children:[o.jsx("span",{className:rr.invoiceNumber,children:p.invoiceNumber}),o.jsx("span",{className:rr.invoiceAmount,children:d(p.amount)})]},p.invoiceNumber))})]}),o.jsxs("div",{className:rr.section,children:[o.jsx("label",{htmlFor:"refund-notes",className:rr.notesLabel,children:"Notes"}),o.jsx("textarea",{id:"refund-notes",className:rr.notesTextarea,placeholder:"Add notes (optional)",value:a,onChange:p=>i(p.target.value),disabled:n}),o.jsxs("div",{className:rr.totalAmount,children:["Total: ",o.jsx("strong",{children:d(l)})]})]})]}),o.jsxs("div",{className:rr.footer,children:[o.jsx("button",{className:rr.cancelButton,onClick:r,disabled:n,children:"Cancel"}),o.jsx("button",{className:rr.refundButton,onClick:u,disabled:n,children:n?"Refunding...":"Refund"})]})]})})},zq="_pageLayout_erkaa_7",qq="_sidebarWrapper_erkaa_17",Uq="_mainContent_erkaa_23",Wq="_container_erkaa_30",Gq="_header_erkaa_37",Jq="_headerLeft_erkaa_44",Kq="_title_erkaa_48",Yq="_subtitle_erkaa_55",Qq="_controlsContainer_erkaa_62",Zq="_errorContainer_erkaa_67",Xq="_errorTitle_erkaa_77",eU="_errorMessage_erkaa_84",Dr={pageLayout:zq,sidebarWrapper:qq,mainContent:Uq,container:Wq,header:Gq,headerLeft:Jq,title:Kq,subtitle:Yq,controlsContainer:Qq,errorContainer:Zq,errorTitle:Xq,errorMessage:eU},tU=()=>{const{currentCompany:t,currentUser:e}=ht(),{messageState:r,closeMessage:s,showError:n,showSuccess:a}=Ps(),i=(t==null?void 0:t.company_id)||"",[l,c]=S.useState(""),[d,u]=S.useState(new Set),[h,f]=S.useState(null),[p,_]=S.useState(!1),{invoices:v,loading:x,error:m,pagination:g,currentPage:y,itemsPerPage:w,selectedStoreId:b,activeFilter:C,invoiceDetail:j,detailLoading:I,refunding:k,setSelectedStoreId:E,changeDateRange:T,changePage:D,fetchInvoiceDetail:N}=Fx(i),{refundInvoicesWithJournal:A}=mz();S.useEffect(()=>{u(new Set),f(null)},[b]);const $=ye=>{v.find(xe=>xe.invoiceId===ye)&&(u(new Set([ye])),_(!0))},z=(t==null?void 0:t.stores)||[],H=v.filter(ye=>{if(!l)return!0;const P=l.toLowerCase();return ye.invoiceNumber.toLowerCase().includes(P)||ye.customerName.toLowerCase().includes(P)||ye.totalAmount.toString().includes(P)||ye.formatCurrency(ye.totalAmount).toLowerCase().includes(P)}),L=ye=>{const P=new Set(d);P.has(ye)?P.delete(ye):P.add(ye),u(P)},B=()=>{d.size===H.length?u(new Set):u(new Set(H.map(ye=>ye.invoiceId)))},O=ye=>{const P=h===ye?null:ye;f(P),P&&N(P)},M=Array.from(d).some(ye=>{const P=v.find(xe=>xe.invoiceId===ye);return(P==null?void 0:P.status)==="cancelled"}),R=Array.from(d).map(ye=>{const P=v.find(xe=>xe.invoiceId===ye);return P?{invoiceNumber:P.invoiceNumber,amount:P.totalAmount,currencySymbol:P.currencySymbol}:null}).filter(ye=>ye!==null),ie=()=>{_(!0)},Z=()=>{_(!1)},Ie=async ye=>{var P;if(!(e!=null&&e.user_id)||!i){n({title:"Refund Failed",message:"User information not available. Please log in again."});return}try{const xe=Array.from(d),je=await A({invoiceIds:xe,notes:ye,companyId:i,userId:e.user_id,invoices:v});_(!1),je.success?a({message:`Successfully refunded ${je.totalSucceeded} invoice${je.totalSucceeded>1?"s":""} and created ${je.journalSuccessCount} journal ${je.journalSuccessCount>1?"entries":"entry"}. Total amount: ${((P=v[0])==null?void 0:P.formatCurrency(je.totalAmountRefunded))||je.totalAmountRefunded}`,autoCloseDuration:3e3}):je.totalFailed===0&&je.journalFailCount>0?n({title:"Partial Success",message:`Successfully refunded ${je.totalSucceeded} invoice${je.totalSucceeded>1?"s":""}, but ${je.journalFailCount} journal ${je.journalFailCount>1?"entries":"entry"} failed to create.`}):n({title:"Partial Refund",message:`Successfully refunded ${je.totalSucceeded} invoice${je.totalSucceeded>1?"s":""}, but ${je.totalFailed} failed. ${je.journalSuccessCount>0?`Created ${je.journalSuccessCount} journal ${je.journalSuccessCount>1?"entries":"entry"}.`:""}`}),u(new Set)}catch(xe){_(!1),n({title:"Refund Error",message:xe instanceof Error?xe.message:"An unexpected error occurred"})}},Te=ye=>{const P=new Date;let xe,je=new Date(P);switch(ye){case"all":xe=new Date(P.getFullYear()-10,0,1);break;case"today":xe=new Date(P);break;case"yesterday":xe=new Date(P),xe.setDate(P.getDate()-1),je=new Date(xe);break;case"this-week":xe=new Date(P);const ne=P.getDay(),Ce=ne===0?-6:1-ne;xe.setDate(P.getDate()+Ce);break;case"this-month":xe=new Date(P.getFullYear(),P.getMonth(),1);break;case"last-month":xe=new Date(P.getFullYear(),P.getMonth()-1,1),je=new Date(P.getFullYear(),P.getMonth(),0);break;default:xe=new Date(P)}return{start:re.toDateOnly(xe),end:re.toDateOnly(je)}},Ke=[{id:"date",title:"Date Range",type:"sort",defaultExpanded:!0,selectedValues:C,options:[{value:"all",label:"All"},{value:"today",label:"Today"},{value:"yesterday",label:"Yesterday"},{value:"this-week",label:"This Week"},{value:"this-month",label:"This Month"},{value:"last-month",label:"Last Month"}],onSelect:ye=>{const{start:P,end:xe}=Te(ye);T(ye,P,xe)}}];return i?x&&v.length===0?o.jsxs(o.Fragment,{children:[o.jsx(Se,{activeItem:"product"}),o.jsx("div",{className:Dr.pageLayout,children:o.jsx(Me,{fullscreen:!0,size:"large"})})]}):m&&v.length===0?o.jsxs(o.Fragment,{children:[o.jsx(Se,{activeItem:"product"}),o.jsx("div",{className:Dr.pageLayout,children:o.jsxs("div",{className:Dr.errorContainer,children:[o.jsx("h2",{className:Dr.errorTitle,children:"Failed to Load Invoices"}),o.jsx("p",{className:Dr.errorMessage,children:m})]})})]}):o.jsxs(o.Fragment,{children:[o.jsx(Se,{activeItem:"product"}),o.jsxs("div",{className:Dr.pageLayout,children:[o.jsx("div",{className:Dr.sidebarWrapper,children:o.jsx(rf,{sections:Ke,width:240,topOffset:64})}),o.jsx("div",{className:Dr.mainContent,children:o.jsxs("div",{className:Dr.container,children:[o.jsx("div",{className:Dr.header,children:o.jsxs("div",{className:Dr.headerLeft,children:[o.jsx("h1",{className:Dr.title,children:"Invoices"}),o.jsx("p",{className:Dr.subtitle,children:"Manage billing and payment records"})]})}),o.jsx("div",{className:Dr.controlsContainer,children:o.jsx(ds,{stores:z,selectedStoreId:b,onStoreSelect:E,companyId:i,width:"280px"})}),o.jsx(Sz,{localSearchQuery:l,onSearchChange:c,selectedInvoicesCount:d.size,hasSelectedCancelledInvoice:M,onRefund:ie}),o.jsx(gq,{invoices:H,selectedInvoices:d,expandedInvoiceId:h,invoiceDetail:j,detailLoading:I,refunding:k,localSearchQuery:l,onToggleSelection:L,onSelectAll:B,onRowClick:O,onRefund:$}),g&&g.total_pages>1&&o.jsx(Sq,{pagination:g,currentPage:y,itemsPerPage:w,onPageChange:D}),o.jsx($e,{variant:r.variant,title:r.title,message:r.message,isOpen:r.isOpen,onClose:s}),o.jsx(Hq,{isOpen:p,selectedInvoices:R,onClose:Z,onConfirm:Ie,isRefunding:k})]})})]})]}):o.jsxs(o.Fragment,{children:[o.jsx(Se,{activeItem:"product"}),o.jsx("div",{className:Dr.pageLayout,children:o.jsx(Me,{fullscreen:!0,size:"large"})})]})};class rU{async getProducts(e,r,s=1,n=100,a){const i=se.getClient(),{data:l,error:c}=await i.rpc("get_inventory_page",{p_company_id:e,p_store_id:r,p_page:s,p_limit:n,p_search:a||null});if(c)throw new Error(c.message);return l}async getBaseCurrency(e){const r=se.getClient(),{data:s,error:n}=await r.rpc("get_base_currency",{p_company_id:e});if(n)throw new Error(n.message);return s&&s.base_currency?{symbol:s.base_currency.symbol||"",code:s.base_currency.currency_code||"VND"}:{symbol:"",code:"VND"}}}const ay=new rU,sU=(t,e)=>{const[r,s]=S.useState([]),[n,a]=S.useState(!0),[i,l]=S.useState(null),[c,d]=S.useState(""),[u,h]=S.useState(""),[f,p]=S.useState(1),[_,v]=S.useState(1),[x,m]=S.useState(0),g=async()=>{if(t)try{const{symbol:j}=await ay.getBaseCurrency(t);d(j)}catch(j){console.error("Failed to load base currency:",j)}},y=async(j=1)=>{if(!t||!e){a(!1);return}a(!0),l(null);try{const I=await ay.getProducts(t,e,j,20,u||void 0);if(I!=null&&I.success&&(I!=null&&I.data)){const E=(I.data.products||[]).map(T=>{var D,N;return{product_id:T.product_id,product_name:T.product_name,sku:T.sku,barcode:T.barcode,brand_name:T.brand_name,category_name:T.category_name,unit:T.unit,image_urls:T.image_urls||[],selling_price:((D=T.price)==null?void 0:D.selling)||0,quantity_available:((N=T.stock)==null?void 0:N.quantity_available)||0}});if(s(E),I.data.pagination){const T=I.data.pagination;m(T.total_count||T.total||0),v(T.total_pages||Math.ceil((T.total_count||T.total||0)/20)),p(j)}}else l("Failed to load products")}catch(I){l(I instanceof Error?I.message:"An error occurred")}finally{a(!1)}};S.useEffect(()=>{g()},[t]),S.useEffect(()=>{const j=setTimeout(()=>{y(1),p(1)},300);return()=>clearTimeout(j)},[t,e,u]);const w=j=>{j>=1&&j<=_&&y(j)};return{products:r,loading:n,error:i,currencySymbol:c,searchQuery:u,setSearchQuery:h,currentPage:f,totalPages:_,totalCount:x,goToPage:w,nextPage:()=>{f<_&&w(f+1)},prevPage:()=>{f>1&&w(f-1)},refresh:()=>y(f)}},nU="_pageLayout_rq3ne_7",aU="_message_rq3ne_17",oU="_loadingContainer_rq3ne_28",iU="_mainContainer_rq3ne_37",lU="_topSection_rq3ne_45",cU="_searchContainer_rq3ne_54",dU="_searchBox_rq3ne_63",uU="_searchIcon_rq3ne_68",hU="_searchInput_rq3ne_77",fU="_selectedItems_rq3ne_100",mU="_emptyCart_rq3ne_109",pU="_cartItem_rq3ne_117",gU="_cartItemHeader_rq3ne_127",_U="_cartItemNumber_rq3ne_133",yU="_deleteBtn_rq3ne_139",vU="_cartItemDetails_rq3ne_158",xU="_cartItemSku_rq3ne_164",bU="_cartItemName_rq3ne_169",wU="_cartItemFooter_rq3ne_178",SU="_quantityControl_rq3ne_184",jU="_quantityBtn_rq3ne_190",CU="_quantityInput_rq3ne_210",NU="_cartItemPrices_rq3ne_232",IU="_unitPrice_rq3ne_240",kU="_totalPrice_rq3ne_245",EU="_bottomBar_rq3ne_252",TU="_subtotalSection_rq3ne_262",LU="_subtotalItem_rq3ne_268",AU="_subtotalLabel_rq3ne_274",DU="_subtotalValue_rq3ne_280",MU="_subtotalAmount_rq3ne_286",RU="_productSection_rq3ne_293",PU="_productGrid_rq3ne_301",OU="_productItem_rq3ne_311",$U="_productImage_rq3ne_332",FU="_productDetails_rq3ne_346",BU="_productName_rq3ne_354",VU="_productPrice_rq3ne_364",HU="_productFooter_rq3ne_372",zU="_productPagination_rq3ne_383",qU="_paginationBtn_rq3ne_389",UU="_paginationText_rq3ne_414",WU="_completeBtn_rq3ne_422",ke={pageLayout:nU,message:aU,loadingContainer:oU,mainContainer:iU,topSection:lU,searchContainer:cU,searchBox:dU,searchIcon:uU,searchInput:hU,selectedItems:fU,emptyCart:mU,cartItem:pU,cartItemHeader:gU,cartItemNumber:_U,deleteBtn:yU,cartItemDetails:vU,cartItemSku:xU,cartItemName:bU,cartItemFooter:wU,quantityControl:SU,quantityBtn:jU,quantityInput:CU,cartItemPrices:NU,unitPrice:IU,totalPrice:kU,bottomBar:EU,subtotalSection:TU,subtotalItem:LU,subtotalLabel:AU,subtotalValue:DU,subtotalAmount:MU,productSection:RU,productGrid:PU,productItem:OU,productImage:$U,productDetails:FU,productName:BU,productPrice:VU,productFooter:HU,productPagination:zU,paginationBtn:qU,paginationText:UU,completeBtn:WU},GU=()=>{const{currentCompany:t,currentStore:e}=ht(),[r,s]=S.useState((e==null?void 0:e.store_id)||null),[n,a]=S.useState([]),i=b=>{s(b)},{products:l,loading:c,error:d,currencySymbol:u,currentPage:h,totalPages:f,nextPage:p,prevPage:_,searchQuery:v,setSearchQuery:x}=sU(t==null?void 0:t.company_id,r),m=b=>{if(n.find(j=>j.product_id===b.product_id))a(n.map(j=>j.product_id===b.product_id?{...j,quantity:j.quantity+1,total_price:(j.quantity+1)*j.unit_price}:j));else{const j={product_id:b.product_id,sku:b.sku,product_name:b.product_name,quantity:1,unit_price:b.selling_price,total_price:b.selling_price};a([...n,j])}},g=b=>{a(n.filter(C=>C.product_id!==b))},y=(b,C)=>{if(C<=0){g(b);return}a(n.map(j=>j.product_id===b?{...j,quantity:C,total_price:C*j.unit_price}:j))},w=n.reduce((b,C)=>b+C.total_price,0);return o.jsxs("div",{style:{height:"100vh",overflow:"hidden",display:"flex",flexDirection:"column"},children:[o.jsx(Se,{activeItem:"product"}),o.jsx("div",{className:ke.pageLayout,children:!t||!e?o.jsx("div",{className:ke.message,children:"Please select a company and store first"}):o.jsxs("div",{className:ke.mainContainer,children:[o.jsxs("div",{className:ke.topSection,children:[o.jsx("div",{className:ke.selectedItems,children:n.length===0?o.jsx("div",{className:ke.emptyCart,children:"No items selected"}):n.map((b,C)=>o.jsxs("div",{className:ke.cartItem,children:[o.jsxs("div",{className:ke.cartItemHeader,children:[o.jsx("span",{className:ke.cartItemNumber,children:C+1}),o.jsx("button",{className:ke.deleteBtn,onClick:()=>g(b.product_id),children:o.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z"})})})]}),o.jsxs("div",{className:ke.cartItemDetails,children:[o.jsx("div",{className:ke.cartItemSku,children:b.sku}),o.jsx("div",{className:ke.cartItemName,children:b.product_name})]}),o.jsxs("div",{className:ke.cartItemFooter,children:[o.jsxs("div",{className:ke.quantityControl,children:[o.jsx("button",{className:ke.quantityBtn,onClick:()=>y(b.product_id,b.quantity-1),children:o.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M19,13H5V11H19V13Z"})})}),o.jsx("input",{type:"number",className:ke.quantityInput,value:b.quantity,min:"1",onChange:j=>y(b.product_id,parseInt(j.target.value)||1)}),o.jsx("button",{className:ke.quantityBtn,onClick:()=>y(b.product_id,b.quantity+1),children:o.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"})})})]}),o.jsxs("div",{className:ke.cartItemPrices,children:[o.jsxs("div",{className:ke.unitPrice,children:[u,b.unit_price.toLocaleString()]}),o.jsxs("div",{className:ke.totalPrice,children:[u,b.total_price.toLocaleString()]})]})]})]},b.product_id))}),o.jsx("div",{className:ke.bottomBar,children:o.jsxs("div",{className:ke.subtotalSection,children:[o.jsxs("div",{className:ke.subtotalItem,children:[o.jsx("span",{className:ke.subtotalLabel,children:"Products"}),o.jsx("span",{className:ke.subtotalValue,children:n.length})]}),o.jsxs("div",{className:ke.subtotalItem,children:[o.jsx("span",{className:ke.subtotalLabel,children:"Sub-total"}),o.jsxs("span",{className:ke.subtotalAmount,children:[u,w.toLocaleString()]})]})]})})]}),o.jsxs("div",{className:ke.productSection,children:[o.jsxs("div",{className:ke.searchContainer,children:[o.jsxs("div",{className:ke.searchBox,children:[o.jsxs("svg",{className:ke.searchIcon,width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[o.jsx("circle",{cx:"11",cy:"11",r:"8",strokeWidth:"2"}),o.jsx("path",{d:"m21 21-4.35-4.35",strokeWidth:"2",strokeLinecap:"round"})]}),o.jsx("input",{type:"text",className:ke.searchInput,placeholder:"Search product",value:v,onChange:b=>x(b.target.value)})]}),o.jsx(ds,{stores:(t==null?void 0:t.stores)||[],selectedStoreId:r,onStoreSelect:i,companyId:t==null?void 0:t.company_id,width:"200px",maxHeight:"300px",showAllStoresOption:!1})]}),o.jsx("div",{className:ke.productGrid,children:c?o.jsx("div",{className:ke.loadingContainer,children:o.jsx(Me,{size:"large"})}):d?o.jsx("div",{className:ke.message,children:d}):l.length===0?o.jsx("div",{className:ke.message,children:"No products available"}):l.map(b=>o.jsxs("button",{className:ke.productItem,onClick:()=>m(b),children:[o.jsx("div",{className:ke.productImage,children:b.image_urls&&b.image_urls.length>0?o.jsx("img",{src:b.image_urls[0],alt:b.product_name}):o.jsx("div",{className:ke.imagePlaceholder})}),o.jsxs("div",{className:ke.productDetails,children:[o.jsx("h3",{className:ke.productName,children:b.product_name}),o.jsxs("p",{className:ke.productPrice,children:[u,b.selling_price.toLocaleString()]})]})]},b.product_id))}),o.jsxs("div",{className:ke.productFooter,children:[o.jsxs("div",{className:ke.productPagination,children:[o.jsx("button",{className:ke.paginationBtn,onClick:_,disabled:h===1,children:o.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M15.41,16.58L10.83,12L15.41,7.41L14,6L8,12L14,18L15.41,16.58Z"})})}),o.jsxs("span",{className:ke.paginationText,children:[h,"/",f]}),o.jsx("button",{className:ke.paginationBtn,onClick:p,disabled:h===f,children:o.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z"})})})]}),o.jsx("button",{className:ke.completeBtn,children:"COMPLETE"})]})]})]})})]})};let ua=class bc{constructor(e,r,s,n){this.companyId=e,this.storeId=r,this.date=s,this.transactionLines=n}get totalDebits(){return this.transactionLines.filter(e=>e.isDebit).reduce((e,r)=>e+r.amount,0)}get totalCredits(){return this.transactionLines.filter(e=>!e.isDebit).reduce((e,r)=>e+r.amount,0)}get debitCount(){return this.transactionLines.filter(e=>e.isDebit).length}get creditCount(){return this.transactionLines.filter(e=>!e.isDebit).length}get difference(){return this.totalDebits-this.totalCredits}get isBalanced(){return Math.abs(this.difference)<.01}canSubmit(){return this.isBalanced&&this.transactionLines.length>=2&&this.transactionLines.every(e=>e.isValid)}getCashLocationId(){const e=this.transactionLines.find(r=>r.cashLocationId!==null);return e?e.cashLocationId:null}hasCashLocation(){return this.getCashLocationId()!==null}addTransactionLine(e){return new bc(this.companyId,this.storeId,this.date,[...this.transactionLines,e])}updateTransactionLine(e,r){const s=[...this.transactionLines];return s[e]=r,new bc(this.companyId,this.storeId,this.date,s)}removeTransactionLine(e){const r=this.transactionLines.filter((s,n)=>n!==e);return new bc(this.companyId,this.storeId,this.date,r)}};class JU{async getAccounts(){const e=se.getClient(),{data:r,error:s}=await e.rpc("get_accounts");if(s)throw console.error("Error fetching accounts:",s),new Error(s.message);return r||[]}async getCashLocations(e,r){const s=se.getClient(),n={p_company_id:e};r&&(n.p_store_id=r);const{data:a,error:i}=await s.rpc("get_cash_locations",n);if(i)throw console.error("Error fetching cash locations:",i),new Error(i.message);return a||[]}async getCounterparties(e){const r=se.getClient(),{data:s,error:n}=await r.from("counterparties").select("counterparty_id, name, type, is_internal, linked_company_id, email, phone").eq("company_id",e).order("name");if(n)throw console.error("Error fetching counterparties:",n),new Error(n.message);return s||[]}async checkAccountMapping(e){const r=se.getClient(),{data:s,error:n}=await r.from("account_mappings").select("my_account_id, linked_account_id, direction").eq("my_company_id",e.companyId).eq("counterparty_id",e.counterpartyId).eq("my_account_id",e.accountId).maybeSingle();return n?(console.error("Error checking account mapping:",n),null):s}async getCounterpartyStores(e){const r=se.getClient(),{data:s,error:n}=await r.from("stores").select("store_id, store_name").eq("company_id",e).order("store_name");if(n)throw console.error("Error fetching counterparty stores:",n),new Error(n.message);return s||[]}async submitJournalEntry(e){var p;const r=se.getClient(),s=e.transactionLines.filter(_=>_.isDebit).reduce((_,v)=>_+v.amount,0),n=e.transactionLines.map(_=>{const v={account_id:_.accountId,description:_.description,debit:_.isDebit?_.amount.toString():"0",credit:_.isDebit?"0":_.amount.toString()};if(_.cashLocationId&&(v.cash={cash_location_id:_.cashLocationId}),_.counterpartyId){const x=new Date,m=_.issueDate?new Date(_.issueDate):x,g=_.dueDate?new Date(_.dueDate):new Date(x.getTime()+30*24*60*60*1e3);v.debt={counterparty_id:_.counterpartyId,direction:_.isDebit?"receivable":"payable",category:_.debtCategory||"other",original_amount:_.amount.toString(),interest_rate:(_.interestRate||0).toString(),interest_account_id:_.interestAccountId||"",interest_due_day:_.interestDueDay||0,issue_date:m.toISOString().split("T")[0],due_date:g.toISOString().split("T")[0],description:_.debtDescription||"",linkedCounterparty_store_id:_.counterpartyStoreId||"",linkedCounterparty_companyId:_.linkedCompanyId||""}}return v});let a;if(e.date instanceof Date)a=e.date;else{const _=new Date,[v,x,m]=e.date.split("-").map(Number);a=new Date(v,x-1,m,_.getHours(),_.getMinutes(),_.getSeconds())}const i=re.toRpcFormat(a),l=((p=e.transactionLines.find(_=>_.counterpartyId))==null?void 0:p.counterpartyId)||null,c=e.transactionLines.find(_=>_.counterpartyId&&_.linkedCompanyId),d=(c==null?void 0:c.counterpartyCashLocationId)||null,u={p_base_amount:s,p_company_id:e.companyId,p_created_by:e.createdBy,p_description:e.description,p_entry_date:i,p_lines:n,p_store_id:e.storeId,p_counterparty_id:l,p_if_cash_location_id:d};console.log("=== RPC Parameters ==="),console.log("p_lines:",JSON.stringify(n,null,2)),console.log("Full params:",JSON.stringify(u,null,2));const{data:h,error:f}=await r.rpc("insert_journal_with_everything",u);if(f){console.error("Error submitting journal entry:",f),console.error("Error details:",JSON.stringify(f,null,2));let _=f.message;throw _.includes(" ")||_.includes("credit")||_.includes("debit")?_="Invalid transaction line format. Please check debit and credit values.":(_.includes("")||_.includes(""))&&(_="Journal entry validation failed. Please check all required fields."),new Error(_)}return{journal_id:h}}}class KU{static fromJson(e){return{accountId:e.id,accountName:e.name,categoryTag:e.categoryTag,accountType:e.type,expenseNature:e.expenseNature}}static toJson(e){return{id:e.accountId,name:e.accountName,categoryTag:e.categoryTag,type:e.accountType,expenseNature:e.expenseNature}}}class YU{static fromJson(e){return{locationId:e.id,locationName:e.name,locationType:e.type,storeId:e.storeId,isCompanyWide:e.isCompanyWide}}static toJson(e){return{id:e.locationId,name:e.locationName,type:e.locationType,storeId:e.storeId,isCompanyWide:e.isCompanyWide}}}let QU=class{static fromJson(e){return{counterpartyId:e.counterparty_id||e.id,counterpartyName:e.name,type:e.type,isInternal:e.is_internal??e.isInternal??!1,email:e.email,phone:e.phone,linkedCompanyId:e.linked_company_id||e.linkedCompanyId||null}}static toJson(e){return{id:e.counterpartyId,name:e.counterpartyName,type:e.type,isInternal:e.isInternal,email:e.email,phone:e.phone,linkedCompanyId:e.linkedCompanyId}}};class Bx{constructor(){W(this,"dataSource");this.dataSource=new JU}async getAccounts(e){try{return(await this.dataSource.getAccounts()).map(KU.fromJson)}catch(r){return console.error("Repository error fetching accounts:",r),[]}}async getCashLocations(e,r){try{return(await this.dataSource.getCashLocations(e,r)).map(YU.fromJson)}catch(s){return console.error("Repository error fetching cash locations:",s),[]}}async getCounterparties(e){try{const r=await this.dataSource.getCounterparties(e);console.log("Raw counterparty data from datasource:",r);const s=r.map(QU.fromJson);return console.log("Mapped counterparty data:",s),s}catch(r){return console.error("Repository error fetching counterparties:",r),[]}}async checkAccountMapping(e,r,s){try{const n=await this.dataSource.checkAccountMapping({companyId:e,counterpartyId:r,accountId:s});return n?{myAccountId:n.my_account_id,linkedAccountId:n.linked_account_id,direction:n.direction}:null}catch(n){return console.error("Repository error checking account mapping:",n),null}}async getCounterpartyStores(e){try{return(await this.dataSource.getCounterpartyStores(e)).map(s=>({storeId:s.store_id,storeName:s.store_name}))}catch(r){return console.error("Repository error fetching counterparty stores:",r),[]}}async submitJournalEntry(e,r,s){try{const n=await this.dataSource.submitJournalEntry({companyId:e.companyId,storeId:e.storeId,date:e.date,createdBy:r,description:s||`Journal entry for ${e.date}`,transactionLines:e.transactionLines.map(a=>({isDebit:a.isDebit,accountId:a.accountId,amount:a.amount,description:a.description,cashLocationId:a.cashLocationId,counterpartyId:a.counterpartyId,counterpartyStoreId:a.counterpartyStoreId,debtCategory:a.debtCategory,interestRate:a.interestRate,interestAccountId:a.interestAccountId,interestDueDay:a.interestDueDay,issueDate:a.issueDate,dueDate:a.dueDate,debtDescription:a.debtDescription,linkedCompanyId:a.linkedCompanyId,counterpartyCashLocationId:a.counterpartyCashLocationId}))});return{success:!0,journalId:n==null?void 0:n.journal_id}}catch(n){return console.error("Repository error submitting journal entry:",n),{success:!1,error:n instanceof Error?n.message:"Failed to submit journal entry"}}}}class ii{static today(){const e=new Date,r=e.getFullYear(),s=String(e.getMonth()+1).padStart(2,"0"),n=String(e.getDate()).padStart(2,"0");return`${r}-${s}-${n}`}static toDateOnly(e){const r=e.getFullYear(),s=String(e.getMonth()+1).padStart(2,"0"),n=String(e.getDate()).padStart(2,"0");return`${r}-${s}-${n}`}static toRpcFormat(e){const[r,s,n]=e.split("-").map(Number);return new Date(Date.UTC(r,s-1,n,0,0,0,0)).toISOString().replace("T"," ").split(".")[0]}static isValid(e){if(!e||e.trim()===""||!/^\d{4}-\d{2}-\d{2}$/.test(e))return!1;const s=new Date(e);return!isNaN(s.getTime())}static formatDisplay(e){const r=new Date(e);return new Intl.DateTimeFormat("en-US",{year:"numeric",month:"long",day:"numeric"}).format(r)}static formatDisplayKo(e){const r=new Date(e);return new Intl.DateTimeFormat("ko-KR",{year:"numeric",month:"long",day:"numeric"}).format(r)}}const ra=new Bx,sr=er((t,e)=>({journalEntry:new ua("",null,ii.today(),[]),companyId:"",storeId:null,userId:"",accounts:[],cashLocations:[],counterparties:[],loading:!1,submitting:!1,error:null,setJournalEntry:r=>t({journalEntry:r}),setAccounts:r=>t({accounts:r}),setCashLocations:r=>t({cashLocations:r}),setCounterparties:r=>t({counterparties:r}),addTransactionLine:r=>{const n=e().journalEntry.addTransactionLine(r);t({journalEntry:n})},updateTransactionLine:(r,s)=>{const a=e().journalEntry.updateTransactionLine(r,s);t({journalEntry:a})},removeTransactionLine:r=>{const n=e().journalEntry.removeTransactionLine(r);t({journalEntry:n})},changeJournalDate:r=>{const s=e(),n=new ua(s.journalEntry.companyId,s.journalEntry.storeId,r,s.journalEntry.transactionLines);t({journalEntry:n})},resetJournalEntry:r=>{const s=e(),n=new ua(s.companyId,r,ii.today(),[]);t({journalEntry:n,storeId:r})},loadInitialData:async()=>{const r=e();t({loading:!0,error:null});try{const[s,n,a]=await Promise.all([ra.getAccounts(r.companyId),ra.getCashLocations(r.companyId,r.storeId),ra.getCounterparties(r.companyId)]);t({accounts:s,cashLocations:n,counterparties:a,loading:!1})}catch{t({loading:!1})}},submitJournalEntry:async r=>{const s=e();if(!s.journalEntry.canSubmit())return{success:!1,error:"Journal entry must be balanced with at least 2 transaction lines"};t({submitting:!0,error:null});try{const n=await ra.submitJournalEntry(s.journalEntry,s.userId,r);if(n.success){const a=new ua(s.companyId,s.storeId,ii.today(),[]);t({journalEntry:a,submitting:!1})}else t({submitting:!1,error:n.error});return n}catch(n){const a=n instanceof Error?n.message:"Failed to submit journal entry";return t({submitting:!1,error:a}),{success:!1,error:a}}},checkAccountMapping:async(r,s,n)=>{try{return await ra.checkAccountMapping(r,s,n)!==null}catch{return!1}},getCounterpartyStores:async r=>{try{return await ra.getCounterpartyStores(r)}catch{return[]}},getCounterpartyCashLocations:async(r,s)=>{try{return await ra.getCashLocations(r,s)}catch{return[]}},reset:()=>{const r=e();t({journalEntry:new ua(r.companyId,r.storeId,ii.today(),[]),loading:!1,submitting:!1,error:null})}})),ZU=(t,e,r)=>{const s=sr(b=>b.journalEntry),n=sr(b=>b.accounts),a=sr(b=>b.cashLocations),i=sr(b=>b.counterparties),l=sr(b=>b.loading),c=sr(b=>b.submitting),d=sr(b=>b.error),u=sr(b=>b.setJournalEntry),h=sr(b=>b.addTransactionLine),f=sr(b=>b.updateTransactionLine),p=sr(b=>b.removeTransactionLine),_=sr(b=>b.changeJournalDate),v=sr(b=>b.resetJournalEntry),x=sr(b=>b.submitJournalEntry),m=sr(b=>b.checkAccountMapping),g=sr(b=>b.getCounterpartyStores),y=sr(b=>b.getCounterpartyCashLocations),w=sr(b=>b.loadInitialData);return S.useEffect(()=>{sr.setState({companyId:t,storeId:e,userId:r,journalEntry:new ua(t,e,ii.today(),[])}),t&&w()},[t,e,r,w]),{journalEntry:s,accounts:n,cashLocations:a,counterparties:i,loading:l,submitting:c,error:d,setJournalEntry:u,addTransactionLine:h,updateTransactionLine:f,removeTransactionLine:p,changeJournalDate:_,resetJournalEntry:v,submitJournalEntry:x,checkAccountMapping:m,getCounterpartyStores:g,getCounterpartyCashLocations:y}};class Vx{constructor(e,r,s,n,a,i,l,c,d,u,h,f,p,_,v=null,x=null,m=null,g=null,y=null,w=null,b=null,C=null){this.isDebit=e,this.accountId=r,this.accountName=s,this.amount=n,this.description=a,this.categoryTag=i,this.cashLocationId=l,this.cashLocationName=c,this.cashLocationType=d,this.counterpartyId=u,this.counterpartyName=h,this.counterpartyStoreId=f,this.counterpartyStoreName=p,this.debtCategory=_,this.interestRate=v,this.interestAccountId=x,this.interestDueDay=m,this.issueDate=g,this.dueDate=y,this.debtDescription=w,this.linkedCompanyId=b,this.counterpartyCashLocationId=C}get typeDisplay(){return this.isDebit?"DEBIT":"CREDIT"}get isValid(){return!!(this.accountId&&this.amount>0)}}class XU{async getTransactions(e,r,s,n,a){const i=se.getClient(),l={p_company_id:e,p_date_from:s,p_date_to:n};r&&(l.p_store_id=r),a&&(l.p_account_id=a);const{data:c,error:d}=await i.rpc("get_transaction_history",l);if(d)throw console.error("Error fetching transaction history:",d),new Error(d.message);return c||[]}}class eW{constructor(e,r,s,n,a,i,l,c,d,u,h,f,p,_,v,x,m,g){this.journalId=e,this.journalNumber=r,this.entryDate=s,this.createdAt=n,this.description=a,this.journalType=i,this.isDraft=l,this.storeId=c,this.storeName=d,this.storeCode=u,this.createdBy=h,this.createdByName=f,this.currencyCode=p,this.currencySymbol=_,this.totalDebit=v,this.totalCredit=x,this.totalAmount=m,this.lines=g}get formattedDate(){return new Date(this.entryDate).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}get formattedTime(){return new Date(this.createdAt).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})}formatCurrency(e){return this.currencySymbol?`${this.currencySymbol==="W"?"":this.currencySymbol}${e.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})}`:e.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})}get sortedLines(){return[...this.lines].sort((e,r)=>e.isDebit&&!r.isDebit?-1:!e.isDebit&&r.isDebit?1:0)}}class Lm{static fromJson(e){const r=(e.lines||[]).map(a=>({lineId:a.line_id,accountId:a.account_id,accountName:a.account_name||"",accountType:a.account_type||"",debit:a.debit||0,credit:a.credit||0,isDebit:a.is_debit||!1,description:a.description||"",counterparty:a.counterparty||null,cashLocation:a.cash_location||null,displayLocation:a.display_location||"",displayCounterparty:a.display_counterparty||""})),s=e.entry_date?re.toLocal(e.entry_date).toISOString():"",n=e.created_at?re.toLocal(e.created_at).toISOString():"";return new eW(e.journal_id,e.journal_number,s,n,e.description||"",e.journal_type||"",e.is_draft||!1,e.store_id||null,e.store_name||null,e.store_code||null,e.created_by,e.created_by_name||"System",e.currency_code||"",e.currency_symbol||"",e.total_debit||0,e.total_credit||0,e.total_amount||0,r)}static toJson(e){return{journal_id:e.journalId,journal_number:e.journalNumber,entry_date:e.entryDate,created_at:e.createdAt,description:e.description,journal_type:e.journalType,is_draft:e.isDraft,store_id:e.storeId,store_name:e.storeName,store_code:e.storeCode,created_by:e.createdBy,created_by_name:e.createdByName,currency_code:e.currencyCode,currency_symbol:e.currencySymbol,total_debit:e.totalDebit,total_credit:e.totalCredit,total_amount:e.totalAmount,lines:e.lines.map(r=>({line_id:r.lineId,account_id:r.accountId,account_name:r.accountName,account_type:r.accountType,debit:r.debit,credit:r.credit,is_debit:r.isDebit,description:r.description,counterparty:r.counterparty,cash_location:r.cashLocation,display_location:r.displayLocation,display_counterparty:r.displayCounterparty}))}}static fromJsonArray(e){const r=e.map(s=>Lm.fromJson(s));return r.sort((s,n)=>new Date(n.createdAt).getTime()-new Date(s.createdAt).getTime()),r}}class tW{constructor(){W(this,"dataSource");this.dataSource=new XU}async getJournalEntries(e,r,s,n,a){try{const i=s?re.toRpcFormat(new Date(s+"T00:00:00")):"",l=n?re.toRpcFormat(new Date(n+"T23:59:59")):"",c=await this.dataSource.getTransactions(e,r,i,l,a);return{success:!0,data:Lm.fromJsonArray(c)}}catch(i){return console.error("Repository error fetching journal entries:",i),{success:!1,error:i instanceof Error?i.message:"Failed to fetch journal entries"}}}}class sf{static validateDateFormat(e){if(!e||e.trim()==="")return{field:"date",message:"Date is required"};if(!/^\d{4}-\d{2}-\d{2}$/.test(e))return{field:"date",message:"Invalid date format. Use YYYY-MM-DD"};const s=new Date(e);return isNaN(s.getTime())?{field:"date",message:"Invalid date"}:null}static validateDateRange(e,r){const s=this.validateDateFormat(e);if(s)return s;const n=this.validateDateFormat(r);if(n)return n;const a=new Date(e),i=new Date(r);if(a>i)return{field:"dateRange",message:"From date must be before or equal to To date"};const l=Math.floor((i.getTime()-a.getTime())/(1e3*60*60*24)),c=365;return l>c?{field:"dateRange",message:`Date range cannot exceed ${c} days`}:null}static validateStoreId(e){return e===null||e===""||/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e)?null:{field:"storeId",message:"Invalid store ID format"}}static validateAccountId(e){return e===null||e===""||/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e)?null:{field:"accountId",message:"Invalid account ID format"}}static validateCompanyId(e){return!e||e.trim()===""?{field:"companyId",message:"Company ID is required"}:/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(e)?null:{field:"companyId",message:"Invalid company ID format"}}static validateTransactionFilter(e,r,s,n,a){const i=[],l=this.validateCompanyId(e);l&&i.push(l);const c=this.validateStoreId(r);c&&i.push(c);const d=this.validateDateRange(s,n);if(d&&i.push(d),a!==void 0){const u=this.validateAccountId(a);u&&i.push(u)}return i}static validateJournalFilter(e,r,s,n){const a=[],i=this.validateCompanyId(e);i&&a.push(i);const l=this.validateStoreId(r);if(l&&a.push(l),s&&n){const c=this.validateDateRange(s,n);c&&a.push(c)}return a}}const rW=new tW,gn=er((t,e)=>({journalEntries:[],loading:!1,error:null,hasSearched:!1,currentStoreId:null,currentStartDate:null,currentEndDate:null,searchJournalEntries:async(r,s,n)=>{const a=e();t({loading:!0,error:null,hasSearched:!0});try{const i=a.companyId||"";if(!i){t({error:"No company selected",journalEntries:[],loading:!1});return}const l=sf.validateJournalFilter(i,r,s,n);if(l.length>0){t({error:l.map(d=>d.message).join(", "),journalEntries:[],loading:!1});return}const c=await rW.getJournalEntries(i,r,s,n,null);if(!c.success){t({error:c.error||"Failed to load journal entries",journalEntries:[],loading:!1});return}t({journalEntries:c.data||[],currentStoreId:r,currentStartDate:s,currentEndDate:n,loading:!1})}catch(i){t({error:i instanceof Error?i.message:"An unexpected error occurred",journalEntries:[],loading:!1})}},clearSearch:()=>{t({journalEntries:[],hasSearched:!1,error:null,currentStoreId:null,currentStartDate:null,currentEndDate:null})},setError:r=>{t({error:r})},reset:()=>{t({journalEntries:[],loading:!1,error:null,hasSearched:!1,currentStoreId:null,currentStartDate:null,currentEndDate:null})}})),Hx=t=>{const e=gn(c=>c.journalEntries),r=gn(c=>c.loading),s=gn(c=>c.error),n=gn(c=>c.hasSearched),a=gn(c=>c.searchJournalEntries),i=gn(c=>c.clearSearch),l=gn(c=>c.setError);return S.useEffect(()=>{t&&gn.setState({companyId:t})},[t]),{journalEntries:e,loading:r,error:s,hasSearched:n,searchJournalEntries:a,clearSearch:i,setError:l}},sW="_container_1wm8v_4",nW="_emptyState_1wm8v_13",aW="_loadingState_1wm8v_14",oW="_emptyIcon_1wm8v_19",iW="_emptyTitle_1wm8v_36",lW="_emptyText_1wm8v_43",cW="_tableWrapper_1wm8v_54",dW="_tableHeader_1wm8v_58",uW="_tableTitle_1wm8v_62",hW="_tableSubtitle_1wm8v_69",fW="_transactionTable_1wm8v_76",mW="_journalHeader_1wm8v_114",pW="_journalDate_1wm8v_127",gW="_journalTime_1wm8v_133",_W="_storeBadge_1wm8v_140",yW="_lineRow_1wm8v_153",vW="_alternate_1wm8v_158",xW="_accountCell_1wm8v_172",bW="_lineDescription_1wm8v_181",wW="_totalRow_1wm8v_187",SW="_totalLabel_1wm8v_200",jW="_amountCell_1wm8v_207",CW="_debitAmount_1wm8v_213",NW="_creditAmount_1wm8v_217",Qe={container:sW,emptyState:nW,loadingState:aW,emptyIcon:oW,emptyTitle:iW,emptyText:lW,tableWrapper:cW,tableHeader:dW,tableTitle:uW,tableSubtitle:hW,transactionTable:fW,journalHeader:mW,journalDate:pW,journalTime:gW,storeBadge:_W,lineRow:yW,alternate:vW,accountCell:xW,lineDescription:bW,totalRow:wW,totalLabel:SW,amountCell:jW,debitAmount:CW,creditAmount:NW},zx=({companyId:t,storeId:e})=>{const{journalEntries:r,loading:s,searchJournalEntries:n}=Hx(t),a=S.useMemo(()=>{const u=new Date,h=new Date;h.setDate(u.getDate()-30);const f=p=>{const _=p.getFullYear(),v=String(p.getMonth()+1).padStart(2,"0"),x=String(p.getDate()).padStart(2,"0");return`${_}-${v}-${x}`};return{fromDate:f(h),toDate:f(u)}},[]);S.useEffect(()=>{t&&n(e,a.fromDate,a.toDate)},[t,e,a.fromDate,a.toDate,n]);const i=()=>o.jsx("div",{className:Qe.loadingState,children:o.jsx(Me,{size:"large"})}),l=()=>o.jsxs("div",{className:Qe.emptyState,children:[o.jsx("div",{className:Qe.emptyIcon,children:o.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M3 3v18h18"}),o.jsx("path",{d:"M18 17V9"}),o.jsx("path",{d:"M13 17V5"}),o.jsx("path",{d:"M8 17v-3"})]})}),o.jsx("h3",{className:Qe.emptyTitle,children:"No Recent Transactions"}),o.jsx("p",{className:Qe.emptyText,children:"No transactions found in the last 30 days."})]}),c=u=>o.jsxs(Kr.Fragment,{children:[o.jsxs("tr",{className:Qe.journalHeader,children:[o.jsxs("td",{children:[o.jsx("div",{className:Qe.journalDate,children:u.formattedDate}),o.jsx("div",{className:Qe.journalTime,children:u.formattedTime})]}),o.jsx("td",{children:u.description||"-"}),o.jsx("td",{children:u.storeName?o.jsx("span",{className:Qe.storeBadge,children:u.storeName}):"All Stores"}),o.jsx("td",{children:u.createdByName}),o.jsx("td",{className:`${Qe.amountCell} ${Qe.debitAmount}`,children:u.formatCurrency(u.totalDebit)}),o.jsx("td",{className:`${Qe.amountCell} ${Qe.creditAmount}`,children:u.formatCurrency(u.totalCredit)})]}),u.sortedLines.map((h,f)=>{const p=f%2===1?Qe.alternate:"";let _=h.description||h.accountName;return h.displayCounterparty&&h.displayLocation?_=`${_}  ${h.displayCounterparty}  ${h.displayLocation}`:h.displayCounterparty?_=`${_}  ${h.displayCounterparty}`:h.displayLocation&&(_=`${_}  ${h.displayLocation}`),o.jsxs("tr",{className:`${Qe.lineRow} ${p}`,children:[o.jsx("td",{className:Qe.accountCell,children:o.jsx("strong",{children:h.accountName})}),o.jsx("td",{className:Qe.lineDescription,children:_}),o.jsx("td",{children:"-"}),o.jsx("td",{children:"-"}),o.jsx("td",{className:`${Qe.amountCell} ${Qe.debitAmount}`,children:h.debit>0?h.debit.toLocaleString("en-US"):"-"}),o.jsx("td",{className:`${Qe.amountCell} ${Qe.creditAmount}`,children:h.credit>0?h.credit.toLocaleString("en-US"):"-"})]},h.lineId)}),o.jsxs("tr",{className:Qe.totalRow,children:[o.jsx("td",{colSpan:4,className:Qe.totalLabel,children:"Total:"}),o.jsx("td",{className:`${Qe.amountCell} ${Qe.debitAmount}`,children:u.totalDebit>0?u.totalDebit.toLocaleString("en-US"):"-"}),o.jsx("td",{className:`${Qe.amountCell} ${Qe.creditAmount}`,children:u.totalCredit>0?u.totalCredit.toLocaleString("en-US"):"-"})]})]},u.journalId),d=()=>o.jsxs("div",{className:Qe.tableWrapper,children:[o.jsxs("div",{className:Qe.tableHeader,children:[o.jsx("h3",{className:Qe.tableTitle,children:"Recent Transactions (Last 30 Days)"}),o.jsxs("p",{className:Qe.tableSubtitle,children:["Found ",r.length," journal",r.length!==1?"s":""]})]}),o.jsxs("table",{className:Qe.transactionTable,children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{style:{width:"160px"},children:"DATE & TIME"}),o.jsx("th",{style:{width:"200px"},children:"DESCRIPTION"}),o.jsx("th",{style:{width:"120px"},children:"STORE"}),o.jsx("th",{style:{width:"120px"},children:"CREATED BY"}),o.jsx("th",{style:{width:"120px"},children:"DEBIT"}),o.jsx("th",{style:{width:"120px"},children:"CREDIT"})]})}),o.jsx("tbody",{children:r.map(c)})]})]});return o.jsxs("div",{className:Qe.container,children:[s&&i(),!s&&r.length===0&&l(),!s&&r.length>0&&d()]})},IW="_balanceSummaryCard_cuikk_6",kW="_balanceSummaryGrid_cuikk_14",EW="_balanceItem_cuikk_21",TW="_clickable_cuikk_30",LW="_balanceLabel_cuikk_40",AW="_balanceAmount_cuikk_48",DW="_debit_cuikk_55",MW="_credit_cuikk_59",RW="_difference_cuikk_63",PW="_unbalanced_cuikk_67",OW="_balanceCount_cuikk_71",$W="_balanceDivider_cuikk_76",FW="_descriptionCard_cuikk_83",BW="_descriptionLabel_cuikk_91",VW="_descriptionTextarea_cuikk_99",HW="_transactionSection_cuikk_122",zW="_emptyState_cuikk_127",qW="_emptyIcon_cuikk_135",UW="_emptyTitle_cuikk_142",WW="_emptyText_cuikk_149",GW="_transactionLineCard_cuikk_156",JW="_transactionLineHeader_cuikk_169",KW="_transactionLineType_cuikk_187",YW="_transactionLineAccount_cuikk_209",QW="_transactionLineAmount_cuikk_221",ZW="_transactionLineBody_cuikk_237",XW="_transactionLineDescription_cuikk_242",eG="_transactionLineTags_cuikk_251",tG="_transactionTag_cuikk_258",rG="_category_cuikk_268",sG="_cash_cuikk_273",nG="_counterparty_cuikk_278",aG="_transactionLineActions_cuikk_283",oG="_transactionActionBtn_cuikk_288",iG="_edit_cuikk_302",lG="_actionIcon_cuikk_318",cG="_actionsFooter_cuikk_324",dG="_addTransactionBtn_cuikk_330",uG="_submitBtn_cuikk_337",me={balanceSummaryCard:IW,balanceSummaryGrid:kW,balanceItem:EW,clickable:TW,balanceLabel:LW,balanceAmount:AW,debit:DW,credit:MW,difference:RW,unbalanced:PW,balanceCount:OW,balanceDivider:$W,descriptionCard:FW,descriptionLabel:BW,descriptionTextarea:VW,transactionSection:HW,emptyState:zW,emptyIcon:qW,emptyTitle:UW,emptyText:WW,transactionLineCard:GW,transactionLineHeader:JW,transactionLineType:KW,transactionLineAccount:YW,transactionLineAmount:QW,transactionLineBody:ZW,transactionLineDescription:XW,transactionLineTags:eG,transactionTag:tG,category:rG,cash:sG,counterparty:nG,transactionLineActions:aG,transactionActionBtn:oG,edit:iG,delete:"_delete_cuikk_310",actionIcon:lG,actionsFooter:cG,addTransactionBtn:dG,submitBtn:uG},hG=({journalEntry:t,companyId:e,selectedStoreId:r,submitting:s,onAddTransaction:n,onEditTransaction:a,onDeleteTransaction:i,onSubmit:l})=>{const c=()=>t.transactionLines.length===0?"Add transactions to submit":t.isBalanced?"Submit Journal Entry":"Balance debits and credits",d=()=>{n()},u=()=>{n()};return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:me.balanceSummaryCard,children:o.jsxs("div",{className:me.balanceSummaryGrid,children:[o.jsxs("div",{className:`${me.balanceItem} ${me.clickable}`,onClick:d,children:[o.jsx("div",{className:me.balanceLabel,children:"Debits"}),o.jsx("div",{className:`${me.balanceAmount} ${me.debit}`,children:rc(t.totalDebits)}),o.jsxs("div",{className:me.balanceCount,children:[t.debitCount," items"]})]}),o.jsx("div",{className:me.balanceDivider}),o.jsxs("div",{className:`${me.balanceItem} ${me.clickable}`,onClick:u,children:[o.jsx("div",{className:me.balanceLabel,children:"Credits"}),o.jsx("div",{className:`${me.balanceAmount} ${me.credit}`,children:rc(t.totalCredits)}),o.jsxs("div",{className:me.balanceCount,children:[t.creditCount," items"]})]}),o.jsx("div",{className:me.balanceDivider}),o.jsxs("div",{className:me.balanceItem,children:[o.jsx("div",{className:me.balanceLabel,children:"Difference"}),o.jsx("div",{className:`${me.balanceAmount} ${me.difference} ${t.isBalanced?"":me.unbalanced}`,children:rc(Math.abs(t.difference))}),o.jsx("div",{className:me.balanceCount,children:""})]})]})}),o.jsxs("div",{className:me.descriptionCard,children:[o.jsx("label",{className:me.descriptionLabel,htmlFor:"journalDescription",children:"Description (Optional)"}),o.jsx("textarea",{id:"journalDescription",className:me.descriptionTextarea,rows:2,placeholder:"Enter journal description..."})]}),o.jsxs("div",{className:me.transactionSection,children:[t.transactionLines.length===0?o.jsxs("div",{className:me.emptyState,children:[o.jsxs("svg",{className:me.emptyIcon,width:"120",height:"120",viewBox:"0 0 120 120",fill:"none",children:[o.jsx("circle",{cx:"60",cy:"60",r:"50",fill:"#F0F6FF"}),o.jsx("rect",{x:"35",y:"40",width:"50",height:"60",rx:"4",fill:"white",stroke:"#0064FF",strokeWidth:"2"}),o.jsx("rect",{x:"40",y:"35",width:"50",height:"60",rx:"4",fill:"white",stroke:"#0064FF",strokeWidth:"2"}),o.jsx("line",{x1:"48",y1:"45",x2:"75",y2:"45",stroke:"#E9ECEF",strokeWidth:"2",strokeLinecap:"round"}),o.jsx("line",{x1:"48",y1:"52",x2:"70",y2:"52",stroke:"#E9ECEF",strokeWidth:"2",strokeLinecap:"round"}),o.jsx("line",{x1:"48",y1:"59",x2:"72",y2:"59",stroke:"#E9ECEF",strokeWidth:"2",strokeLinecap:"round"}),o.jsx("circle",{cx:"60",cy:"75",r:"12",fill:"#0064FF"}),o.jsx("path",{d:"M56 75 H64 M60 71 V79",stroke:"white",strokeWidth:"2.5",strokeLinecap:"round"})]}),o.jsx("h3",{className:me.emptyTitle,children:"No transactions added"}),o.jsx("p",{className:me.emptyText,children:"Click Debits or Credits above to add transactions"})]}):o.jsx(o.Fragment,{children:t.transactionLines.map((h,f)=>o.jsxs("div",{className:me.transactionLineCard,children:[o.jsxs("div",{className:`${me.transactionLineHeader} ${h.isDebit?me.debit:me.credit}`,children:[o.jsx("div",{className:`${me.transactionLineType} ${h.isDebit?me.debit:me.credit}`,children:h.typeDisplay}),o.jsx("div",{className:me.transactionLineAccount,children:h.accountName||"No Account Selected"}),o.jsx("div",{className:`${me.transactionLineAmount} ${h.isDebit?me.debit:me.credit}`,children:rc(h.amount)})]}),o.jsxs("div",{className:me.transactionLineBody,children:[h.description&&o.jsxs("div",{className:me.transactionLineDescription,children:[o.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M14,10H19.5L14,4.5V10M5,3H15L21,9V19A2,2 0 0,1 19,21H5C3.89,21 3,20.1 3,19V5C3,3.89 3.89,3 5,3M9,12H16V14H9V12M9,16H14V18H9V16Z"})}),o.jsx("span",{children:h.description})]}),o.jsxs("div",{className:me.transactionLineTags,children:[h.categoryTag&&o.jsxs("div",{className:`${me.transactionTag} ${me.category}`,children:[o.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M17.63,5.84C17.27,5.33 16.67,5 16,5L5,5.01C3.9,5.01 3,5.9 3,7V17C3,18.1 3.9,19 5,19H16C16.67,19 17.27,18.67 17.63,18.16L22,12L17.63,5.84Z"})}),AD(h.categoryTag)]}),h.cashLocationName&&o.jsxs("div",{className:`${me.transactionTag} ${me.cash}`,children:[o.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M11,8C11,9.66 9.66,11 8,11C6.34,11 5,9.66 5,8C5,6.34 6.34,5 8,5C9.66,5 11,6.34 11,8M14,20H2V18C2,15.79 4.69,14 8,14C11.31,14 14,15.79 14,18V20M22,8V18H24V8H22M18,10V16H20V10H18M16,13V16H17V13H16Z"})}),h.cashLocationName]}),h.counterpartyName&&o.jsxs("div",{className:`${me.transactionTag} ${me.counterparty}`,children:[o.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4M12,6A6,6 0 0,0 6,12A6,6 0 0,0 12,18A6,6 0 0,0 18,12A6,6 0 0,0 12,6Z"})}),h.counterpartyName]})]}),o.jsxs("div",{className:me.transactionLineActions,children:[o.jsxs("button",{className:`${me.transactionActionBtn} ${me.edit}`,onClick:()=>a(f),children:[o.jsx("svg",{className:me.actionIcon,viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z"})}),"Edit"]}),o.jsxs("button",{className:`${me.transactionActionBtn} ${me.delete}`,onClick:()=>i(f),children:[o.jsx("svg",{className:me.actionIcon,viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z"})}),"Delete"]})]})]})]},f))}),o.jsxs("div",{className:me.actionsFooter,children:[o.jsxs(Ne,{variant:"outline",size:"lg",onClick:n,className:me.addTransactionBtn,children:[o.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor",style:{marginRight:"8px"},children:o.jsx("path",{d:"M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"})}),"Add Transaction"]}),o.jsx(Ne,{variant:"primary",size:"lg",onClick:l,disabled:!t.canSubmit(),loading:s,className:me.submitBtn,children:c()})]})]}),o.jsx(zx,{companyId:e,storeId:r})]})},fG="_backdrop_zr0q6_5",mG="_modal_zr0q6_16",pG="_modalHeader_zr0q6_55",gG="_modalTitle_zr0q6_63",_G="_closeButton_zr0q6_70",yG="_modalBody_zr0q6_88",vG="_modalDescription_zr0q6_94",xG="_selectorSpacing_zr0q6_106",bG="_modalFooter_zr0q6_110",wG="_cancelButton_zr0q6_118",SG="_confirmButton_zr0q6_135",fs={backdrop:fG,modal:mG,modalHeader:pG,modalTitle:gG,closeButton:_G,modalBody:yG,modalDescription:vG,selectorSpacing:xG,modalFooter:bG,cancelButton:wG,confirmButton:SG},jG=({isOpen:t,counterpartyName:e,linkedCompanyId:r,onGetCounterpartyStores:s,onGetCounterpartyCashLocations:n,onConfirm:a,onCancel:i})=>{const[l,c]=S.useState([]),[d,u]=S.useState([]),[h,f]=S.useState(""),[p,_]=S.useState(""),[v,x]=S.useState(""),[m,g]=S.useState(!1),[y,w]=S.useState(!1);S.useEffect(()=>{(async()=>{if(!(!t||!r||!s)){g(!0);try{const D=await s(r);c(D)}catch{c([])}finally{g(!1)}}})()},[t,r,s]),S.useEffect(()=>{(async()=>{if(!t||!r||!n){u([]),_("");return}w(!0);try{const D=await n(r,h||null);u(D)}catch{u([])}finally{w(!1)}})()},[t,r,h,n]),S.useEffect(()=>{t||(c([]),u([]),f(""),_(""),x(""))},[t]);const b=l.map(T=>({value:T.storeId,label:T.storeName})),C=d.map(T=>({value:T.locationId,label:T.locationName,description:T.locationType||void 0})),j=[{value:"note",label:"Note"},{value:"account",label:"Account"},{value:"loan",label:"Loan"},{value:"other",label:"Other"}],I=()=>{h&&p&&v&&a(h,p,v)},k=()=>{i()},E=h&&p&&v;return t?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:fs.backdrop,onClick:k}),o.jsxs("div",{className:fs.modal,children:[o.jsxs("div",{className:fs.modalHeader,children:[o.jsx("h3",{className:fs.modalTitle,children:"Select Counterparty Cash Location"}),o.jsx("button",{className:fs.closeButton,onClick:k,type:"button",children:o.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"})})})]}),o.jsxs("div",{className:fs.modalBody,children:[o.jsxs("p",{className:fs.modalDescription,children:["Select the store and cash location for ",o.jsx("strong",{children:e})]}),o.jsx(Ze,{label:"Counterparty Store",placeholder:m?"Loading stores...":"Select store",value:h,options:b,onChange:T=>{f(T),_("")},required:!0,searchable:!0,fullWidth:!0,emptyMessage:m?"Loading...":"No stores available",disabled:m}),o.jsx("div",{className:fs.selectorSpacing,children:o.jsx(Ze,{label:"Counterparty Cash Location",placeholder:y?"Loading locations...":"Select cash location",value:p,options:C,onChange:T=>_(T),required:!0,searchable:!0,fullWidth:!0,emptyMessage:y?"Loading...":"No cash locations available",disabled:y||!h})}),o.jsx("div",{className:fs.selectorSpacing,children:o.jsx(Ze,{label:"Debt Category",placeholder:"Select debt category",value:v,options:j,onChange:T=>x(T),required:!0,searchable:!1,fullWidth:!0,emptyMessage:"No categories available"})})]}),o.jsxs("div",{className:fs.modalFooter,children:[o.jsx("button",{className:fs.cancelButton,onClick:k,type:"button",children:"Cancel"}),o.jsx("button",{className:fs.confirmButton,onClick:I,disabled:!E,type:"button",children:"Confirm"})]})]})]}):null},CG=new Bx,sa=t=>({id:t,date:"",accountId:"",locationId:"",internalId:"",externalId:"",detail:"",debit:"",credit:"",counterpartyStoreId:"",counterpartyCashLocationId:"",debtCategory:""}),nr=er((t,e)=>({rows:[sa(1),sa(2)],nextId:3,submitting:!1,showMappingWarning:!1,mappingWarningMessage:"",showCashLocationModal:!1,selectedRowForModal:null,modalCounterpartyData:null,addRow:()=>{const r=e();t({rows:[...r.rows,sa(r.nextId)],nextId:r.nextId+1})},deleteRow:r=>{const s=e();s.rows.length<=2||t({rows:s.rows.filter(n=>n.id!==r)})},updateRowField:(r,s,n)=>{const a=e();t({rows:a.rows.map((i,l)=>{if(i.id===r){const c={...i,[s]:n};return s==="accountId"&&(c.locationId="",c.internalId="",c.externalId="",c.detail="",c.debit="",c.credit="",c.counterpartyStoreId="",c.counterpartyCashLocationId="",c.debtCategory=""),s==="internalId"&&n&&(c.externalId="",c.counterpartyStoreId="",c.counterpartyCashLocationId="",c.debtCategory=""),s==="externalId"&&n&&(c.internalId="",c.counterpartyStoreId="",c.counterpartyCashLocationId="",c.debtCategory=""),c}if(s==="date"&&n){if(r===1&&l===1&&!i.date)return{...i,date:n};if(r===2&&l===0&&!i.date)return{...i,date:n}}return i})})},clearCounterparty:(r,s)=>{e().updateRowField(r,s,"")},openCashLocationModal:(r,s)=>{t({selectedRowForModal:r,modalCounterpartyData:s,showCashLocationModal:!0})},closeCashLocationModal:()=>{t({showCashLocationModal:!1,selectedRowForModal:null,modalCounterpartyData:null})},confirmCashLocationModal:(r,s,n)=>{const a=e();a.selectedRowForModal!==null&&a.modalCounterpartyData&&t({rows:a.rows.map(i=>i.id===a.selectedRowForModal?{...i,internalId:a.modalCounterpartyData.counterpartyId,externalId:"",counterpartyStoreId:r,counterpartyCashLocationId:s,debtCategory:n}:i),showCashLocationModal:!1,selectedRowForModal:null,modalCounterpartyData:null})},showWarning:r=>{t({showMappingWarning:!0,mappingWarningMessage:r})},hideWarning:()=>{t({showMappingWarning:!1,mappingWarningMessage:""})},submitExcelEntry:async(r,s,n,a,i)=>{const l=e(),{isValid:c,error:d}=NG(l.rows,a);if(!c)return{success:!1,error:d};t({submitting:!0});try{const u=l.rows.map(p=>{const _=a.find(C=>C.accountId===p.accountId),v=parseFloat(p.debit.replace(/,/g,""))||0,x=parseFloat(p.credit.replace(/,/g,""))||0,m=v>0?v:x,g=v>0,y=p.internalId||p.externalId||null,w=y?i.find(C=>C.counterpartyId===y):null;let b=null;return y&&p.debtCategory&&(b=p.debtCategory),new Vx(g,p.accountId,(_==null?void 0:_.accountName)||"",m,p.detail||"",(_==null?void 0:_.categoryTag)||null,p.locationId||null,null,null,y,(w==null?void 0:w.counterpartyName)||null,p.counterpartyStoreId||null,null,b,null,null,null,p.date,null,null,(w==null?void 0:w.linkedCompanyId)||null,p.counterpartyCashLocationId||null)}),h=new ua(r,s,l.rows[0].date,u),f=await CG.submitJournalEntry(h,n,"Excel journal entry");return f.success?(t({rows:[sa(1),sa(2)],nextId:3,submitting:!1}),{success:!0}):(t({submitting:!1}),{success:!1,error:f.error})}catch(u){return t({submitting:!1}),{success:!1,error:u instanceof Error?u.message:"Failed to submit journal entry"}}},reset:()=>{t({rows:[sa(1),sa(2)],nextId:3,submitting:!1,showMappingWarning:!1,mappingWarningMessage:"",showCashLocationModal:!1,selectedRowForModal:null,modalCounterpartyData:null})}}));function NG(t,e){const r=t.reduce((a,i)=>{const l=parseFloat(i.debit.replace(/,/g,""))||0;return a+l},0),s=t.reduce((a,i)=>{const l=parseFloat(i.credit.replace(/,/g,""))||0;return a+l},0);if(r-s!==0)return{isValid:!1,error:"Debits and credits must be balanced"};for(const a of t){if(!a.date)return{isValid:!1,error:"All rows must have a date"};if(!a.accountId)return{isValid:!1,error:"All rows must have an account selected"};const i=e.find(h=>h.accountId===a.accountId);if(i&&i.accountName.toLowerCase()==="cash"&&!a.locationId)return{isValid:!1,error:"Cash accounts must have a location selected"};if(i&&i.categoryTag&&(i.categoryTag.toLowerCase()==="payable"||i.categoryTag.toLowerCase()==="receivable")&&!a.internalId&&!a.externalId)return{isValid:!1,error:"Payable/Receivable accounts must have a counterparty selected"};if(a.internalId&&!a.debtCategory)return{isValid:!1,error:"Internal counterparties must have a debt category selected"};const d=parseFloat(a.debit.replace(/,/g,""))||0,u=parseFloat(a.credit.replace(/,/g,""))||0;if(d===0&&u===0)return{isValid:!1,error:"Each row must have either a debit or credit value"}}return{isValid:!0}}const IG=()=>{const t=nr(y=>y.rows),e=nr(y=>y.nextId),r=nr(y=>y.submitting),s=nr(y=>y.showMappingWarning),n=nr(y=>y.mappingWarningMessage),a=nr(y=>y.showCashLocationModal),i=nr(y=>y.selectedRowForModal),l=nr(y=>y.modalCounterpartyData),c=nr(y=>y.addRow),d=nr(y=>y.deleteRow),u=nr(y=>y.updateRowField),h=nr(y=>y.clearCounterparty),f=nr(y=>y.openCashLocationModal),p=nr(y=>y.closeCashLocationModal),_=nr(y=>y.confirmCashLocationModal),v=nr(y=>y.showWarning),x=nr(y=>y.hideWarning),m=nr(y=>y.submitExcelEntry),g=nr(y=>y.reset);return{rows:t,nextId:e,submitting:r,showMappingWarning:s,mappingWarningMessage:n,showCashLocationModal:a,selectedRowForModal:i,modalCounterpartyData:l,addRow:c,deleteRow:d,updateRowField:u,clearCounterparty:h,openCashLocationModal:f,closeCashLocationModal:p,confirmCashLocationModal:_,showWarning:v,hideWarning:x,submitExcelEntry:m,reset:g}},kG="_container_1e585_5",EG="_table_1e585_9",TG="_selectorCell_1e585_73",LG="_disabled_1e585_78",AG="_counterpartyCell_1e585_87",DG="_clearButton_1e585_94",MG="_actionButtons_1e585_122",RG="_summary_1e585_132",PG="_summaryItem_1e585_137",OG="_summaryLabel_1e585_143",$G="_summaryValue_1e585_149",FG="_summarySuccess_1e585_155",BG="_summaryError_1e585_159",VG="_buttonGroup_1e585_164",HG="_addLineButton_1e585_169",zG="_submitButton_1e585_194",qG="_deleteButton_1e585_215",It={container:kG,table:EG,selectorCell:TG,disabled:LG,counterpartyCell:AG,clearButton:DG,actionButtons:MG,summary:RG,summaryItem:PG,summaryLabel:OG,summaryValue:$G,summarySuccess:FG,summaryError:BG,buttonGroup:VG,addLineButton:HG,submitButton:zG,deleteButton:qG},UG=({accounts:t,cashLocations:e,counterparties:r,companyId:s,selectedStoreId:n,userId:a,onCheckAccountMapping:i,onGetCounterpartyStores:l,onGetCounterpartyCashLocations:c,onSubmitSuccess:d,onSubmitError:u})=>{const{rows:h,submitting:f,showMappingWarning:p,mappingWarningMessage:_,showCashLocationModal:v,modalCounterpartyData:x,addRow:m,deleteRow:g,updateRowField:y,clearCounterparty:w,openCashLocationModal:b,closeCashLocationModal:C,confirmCashLocationModal:j,showWarning:I,hideWarning:k,submitExcelEntry:E,reset:T}=IG(),D=S.useRef({}),N=S.useRef({}),A=S.useRef({}),$=S.useRef({}),z=S.useRef({}),H=S.useRef({}),L=S.useRef({});S.useEffect(()=>{T()},[T]);const B=F=>t.find(Y=>Y.accountId===F),O=F=>{const Y=B(F);return Y&&Y.accountName.toLowerCase()==="cash"},M=F=>{const Y=B(F);if(!Y||!Y.categoryTag)return!1;const le=Y.categoryTag.toLowerCase();return le==="payable"||le==="receivable"},R=F=>{if(!F)return"";const le=F.replace(/[^\d.]/g,"").split(".");return le[0]=le[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),le.length>1?le[0]+"."+le[1]:le[0]},ie=()=>{const F=h.reduce((ve,ot)=>{const He=parseFloat(ot.debit.replace(/,/g,""))||0;return ve+He},0),Y=h.reduce((ve,ot)=>{const He=parseFloat(ot.credit.replace(/,/g,""))||0;return ve+He},0),le=F-Y;return{totalDebit:F,totalCredit:Y,difference:le}},{difference:Z}=ie(),Te=(()=>{if(Z!==0)return!1;for(const F of h){if(!F.date||!F.accountId||O(F.accountId)&&!F.locationId||M(F.accountId)&&!F.internalId&&!F.externalId)return!1;const Y=parseFloat(F.debit.replace(/,/g,""))||0,le=parseFloat(F.credit.replace(/,/g,""))||0;if(Y===0&&le===0)return!1}return!0})(),Ke=t.map(F=>({value:F.accountId,label:F.accountName||F.account_name||""})),ye=()=>h.map(F=>F.locationId).filter(F=>F),P=F=>{const Y=ye(),le=h.find(ve=>ve.id===F);return e.map(ve=>({value:ve.locationId,label:ve.locationName,disabled:Y.includes(ve.locationId)&&(le==null?void 0:le.locationId)!==ve.locationId}))},xe=F=>r.filter(le=>F?le.isInternal===!0:le.isInternal!==!0).map(le=>({value:le.counterpartyId,label:le.counterpartyName})),je=(F,Y,le)=>{const ve=F.replace(/[^\d.]/g,"");ve.split(".").length>2||y(Y,le,ve)},ne=async(F,Y)=>{var He;if(!i)return!0;const le=B(F),ve=r.find(Pt=>Pt.counterpartyId===Y);if(!(ve!=null&&ve.isInternal))return!0;const ot=(He=le==null?void 0:le.categoryTag)==null?void 0:He.toLowerCase();if(ot!=="payable"&&ot!=="receivable")return!0;try{return await i(s,Y,F)?!0:(I("This internal counterparty requires an account mapping to be set up first. Please configure the account mapping in the Account Mapping page before using this counterparty."),!1)}catch{return I("Error checking account mapping. Please try again."),!1}},Ce=async(F,Y,le)=>{if(Y==="internalId"&&le){const ve=h.find(ot=>ot.id===F);if(ve&&ve.accountId){if(!await ne(ve.accountId,le))return;const He=r.find(Pt=>Pt.counterpartyId===le);if(He!=null&&He.isInternal&&(He!=null&&He.linkedCompanyId)){b(F,{counterpartyId:le,counterpartyName:He.counterpartyName,linkedCompanyId:He.linkedCompanyId});return}}}y(F,Y,le)},Ue=(F,Y)=>{setTimeout(()=>{if(h.find(ve=>ve.id===F))if(O(Y)){const ve=D.current[F];ve&&(ve.focus(),ve.click())}else if(M(Y)){const ve=N.current[F];ve&&(ve.focus(),ve.click())}else{const ve=$.current[F];ve&&ve.focus()}},100)},J=F=>{setTimeout(()=>{if(!h.find(ve=>ve.id===F))return;const le=$.current[F];le&&le.focus()},100)},U=F=>{setTimeout(()=>{if(!h.find(ve=>ve.id===F))return;const le=$.current[F];le&&le.focus()},100)},ue=F=>{setTimeout(()=>{if(!h.find(ve=>ve.id===F))return;const le=$.current[F];le&&le.focus()},100)},ee=async()=>{if(!Te||f)return;const F=await E(s,n,a,t,r);F.success?d&&d():u&&u(F.error||"Failed to submit journal entry")};return o.jsxs("div",{className:It.container,children:[o.jsxs("table",{className:It.table,children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Date"}),o.jsx("th",{children:"Account"}),o.jsx("th",{children:"Location"}),o.jsx("th",{children:"Internal"}),o.jsx("th",{children:"External"}),o.jsx("th",{children:"Detail"}),o.jsx("th",{children:"Debit"}),o.jsx("th",{children:"Credit"}),o.jsx("th",{})]})}),o.jsx("tbody",{children:h.map(F=>o.jsxs("tr",{children:[o.jsx("td",{children:o.jsx("input",{type:"date",value:F.date,onChange:Y=>Ce(F.id,"date",Y.target.value)})}),o.jsx("td",{className:It.selectorCell,children:o.jsx(Ze,{ref:Y=>L.current[F.id]=Y,value:F.accountId,options:Ke,onChange:Y=>Ce(F.id,"accountId",Y),onSelect:Y=>Ue(F.id,Y),placeholder:"Select account...",searchable:!0,inline:!0,fullWidth:!0,emptyMessage:"No accounts available"})}),o.jsx("td",{className:`${It.selectorCell} ${O(F.accountId)?"":It.disabled}`,children:o.jsx(Ze,{ref:Y=>D.current[F.id]=Y,value:F.locationId,options:P(F.id),onChange:Y=>Ce(F.id,"locationId",Y),onSelect:()=>J(F.id),placeholder:"Select location...",searchable:!0,inline:!0,fullWidth:!0,disabled:!O(F.accountId),emptyMessage:"No locations available"})}),o.jsx("td",{className:`${It.selectorCell} ${!M(F.accountId)||F.externalId?It.disabled:""}`,children:o.jsxs("div",{className:It.counterpartyCell,children:[o.jsx(Ze,{ref:Y=>N.current[F.id]=Y,value:F.internalId,options:xe(!0),onChange:Y=>Ce(F.id,"internalId",Y),onSelect:()=>U(F.id),placeholder:"Select internal...",searchable:!0,inline:!0,fullWidth:!0,disabled:!M(F.accountId)||!!F.externalId,emptyMessage:"No internal counterparties"}),F.internalId&&o.jsx("button",{className:It.clearButton,onClick:()=>w(F.id,"internalId"),type:"button",children:o.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"})})})]})}),o.jsx("td",{className:`${It.selectorCell} ${!M(F.accountId)||F.internalId?It.disabled:""}`,children:o.jsxs("div",{className:It.counterpartyCell,children:[o.jsx(Ze,{ref:Y=>A.current[F.id]=Y,value:F.externalId,options:xe(!1),onChange:Y=>Ce(F.id,"externalId",Y),onSelect:()=>ue(F.id),placeholder:"Select external...",searchable:!0,inline:!0,fullWidth:!0,disabled:!M(F.accountId)||!!F.internalId,emptyMessage:"No external counterparties"}),F.externalId&&o.jsx("button",{className:It.clearButton,onClick:()=>w(F.id,"externalId"),type:"button",children:o.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"})})})]})}),o.jsx("td",{children:o.jsx("input",{ref:Y=>$.current[F.id]=Y,type:"text",value:F.detail,onChange:Y=>Ce(F.id,"detail",Y.target.value),onKeyDown:Y=>{if(Y.key==="Enter"){Y.preventDefault();const le=z.current[F.id];le&&(le.focus(),le.select())}},placeholder:"Enter detail..."})}),o.jsx("td",{children:o.jsx("input",{ref:Y=>z.current[F.id]=Y,type:"text",inputMode:"decimal",value:R(F.debit),onChange:Y=>je(Y.target.value,F.id,"debit"),onKeyDown:Y=>{if(Y.key==="Enter")if(Y.preventDefault(),!!F.debit&&parseFloat(F.debit.replace(/,/g,""))>0){const ve=h.findIndex(He=>He.id===F.id),ot=h[ve+1];if(ot){const He=L.current[ot.id];He&&(He.focus(),He.click())}else m(),setTimeout(()=>{const He=h[h.length-1].id+1,Pt=L.current[He];Pt&&(Pt.focus(),Pt.click())},100)}else{const ve=H.current[F.id];ve&&(ve.focus(),ve.select())}},disabled:!!F.credit&&parseFloat(F.credit.replace(/,/g,""))>0,placeholder:"0",style:{textAlign:"right"}})}),o.jsx("td",{children:o.jsx("input",{ref:Y=>H.current[F.id]=Y,type:"text",inputMode:"decimal",value:R(F.credit),onChange:Y=>je(Y.target.value,F.id,"credit"),disabled:!!F.debit&&parseFloat(F.debit.replace(/,/g,""))>0,onKeyDown:Y=>{if(Y.key==="Enter"){Y.preventDefault();const le=h.findIndex(ot=>ot.id===F.id),ve=h[le+1];if(ve){const ot=L.current[ve.id];ot&&(ot.focus(),ot.click())}else m(),setTimeout(()=>{const ot=h[h.length-1].id+1,He=L.current[ot];He&&(He.focus(),He.click())},100)}},placeholder:"0",style:{textAlign:"right"}})}),o.jsx("td",{children:o.jsx("button",{className:It.deleteButton,onClick:()=>g(F.id),disabled:h.length<=2,children:o.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"})})})})]},F.id))})]}),o.jsxs("div",{className:It.actionButtons,children:[o.jsx("div",{className:It.summary,children:o.jsxs("div",{className:It.summaryItem,children:[o.jsx("span",{className:It.summaryLabel,children:"Difference:"}),o.jsx("span",{className:`${It.summaryValue} ${Z!==0?It.summaryError:It.summarySuccess}`,children:R(Math.abs(Z).toString())})]})}),o.jsxs("div",{className:It.buttonGroup,children:[o.jsxs("button",{className:It.addLineButton,onClick:m,children:[o.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"})}),"Add Line"]}),o.jsx("button",{className:It.submitButton,disabled:!Te||f,onClick:ee,children:f?"Submitting...":"Submit"})]})]}),o.jsx($e,{variant:"warning",title:"Account Mapping Required",message:_,isOpen:p,onClose:k,onConfirm:k,confirmText:"OK",showCancelButton:!1}),x&&o.jsx(jG,{isOpen:v,counterpartyName:x.counterpartyName,linkedCompanyId:x.linkedCompanyId,onGetCounterpartyStores:l,onGetCounterpartyCashLocations:c,onConfirm:j,onCancel:C}),o.jsx(zx,{companyId:s,storeId:n})]})},WG="_transactionForm_1w5hm_7",GG="_formSection_1w5hm_13",JG="_formTitle_1w5hm_19",KG="_required_1w5hm_26",YG="_transactionTypeToggle_1w5hm_31",QG="_transactionTypeOption_1w5hm_39",ZG="_active_1w5hm_54",XG="_credit_1w5hm_71",eJ="_conditionalFields_1w5hm_236",tJ="_debtFields_1w5hm_243",rJ="_input_1w5hm_250",sJ="_dateInputWrapper_1w5hm_280",nJ="_dateClearButton_1w5hm_285",Be={transactionForm:WG,formSection:GG,formTitle:JG,required:KG,transactionTypeToggle:YG,transactionTypeOption:QG,active:ZG,credit:XG,conditionalFields:eJ,debtFields:tJ,input:rJ,dateInputWrapper:sJ,dateClearButton:nJ},aJ=({initialData:t,initialIsDebit:e,suggestedAmount:r})=>{var P,xe;const s=()=>{const je=new Date,ne=je.getFullYear(),Ce=String(je.getMonth()+1).padStart(2,"0"),Ue=String(je.getDate()).padStart(2,"0");return`${ne}-${Ce}-${Ue}`},[n,a]=S.useState((t==null?void 0:t.isDebit)??e),[i,l]=S.useState((t==null?void 0:t.accountId)??""),[c,d]=S.useState(t!=null&&t.amount?t.amount.toString():r?r.toString():""),[u,h]=S.useState((t==null?void 0:t.description)??""),[f,p]=S.useState((t==null?void 0:t.cashLocationId)??""),[_,v]=S.useState((t==null?void 0:t.counterpartyId)??""),[x,m]=S.useState([]),[g,y]=S.useState((t==null?void 0:t.counterpartyStoreId)??""),[w,b]=S.useState([]),[C,j]=S.useState((t==null?void 0:t.counterpartyCashLocationId)??""),[I,k]=S.useState(!1),[E,T]=S.useState(!1),[D,N]=S.useState((t==null?void 0:t.debtCategory)??""),[A,$]=S.useState(((P=t==null?void 0:t.interestRate)==null?void 0:P.toString())??"0"),[z,H]=S.useState((t==null?void 0:t.interestAccountId)??""),[L,B]=S.useState(((xe=t==null?void 0:t.interestDueDay)==null?void 0:xe.toString())??""),[O,M]=S.useState((t==null?void 0:t.issueDate)??s()),[R,ie]=S.useState((t==null?void 0:t.dueDate)??""),[Z,Ie]=S.useState((t==null?void 0:t.debtDescription)??"");return{isDebit:n,selectedAccountId:i,amount:c,description:u,selectedCashLocation:f,selectedCounterparty:_,counterpartyStores:x,selectedCounterpartyStore:g,counterpartyCashLocations:w,selectedCounterpartyCashLocation:C,loadingCounterpartyStores:I,loadingCounterpartyCashLocations:E,debtCategory:D,interestRate:A,interestAccountId:z,interestDueDay:L,issueDate:O,dueDate:R,debtDescription:Z,setIsDebit:a,setSelectedAccountId:l,setAmount:d,setDescription:h,setSelectedCashLocation:p,setSelectedCounterparty:v,setCounterpartyStores:m,setSelectedCounterpartyStore:y,setCounterpartyCashLocations:b,setSelectedCounterpartyCashLocation:j,setLoadingCounterpartyStores:k,setLoadingCounterpartyCashLocations:T,setDebtCategory:N,setInterestRate:$,setInterestAccountId:H,setInterestDueDay:B,setIssueDate:M,setDueDate:ie,setDebtDescription:Ie,formatAmountDisplay:je=>{if(!je)return"";const ne=parseFloat(je);return isNaN(ne)?je:ne.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:2})},handleAmountChange:je=>{const ne=je.replace(/[^\d.]/g,"");ne.split(".").length>2||d(ne)},handleAccountChange:je=>{l(je),p(""),v("")}}},oJ=({selectedCounterparty:t,counterparties:e,setCounterpartyStores:r,setSelectedCounterpartyStore:s,setCounterpartyCashLocations:n,setSelectedCounterpartyCashLocation:a,setLoadingCounterpartyStores:i,setLoadingCounterpartyCashLocations:l,selectedCounterpartyStore:c,onGetCounterpartyStores:d,onGetCounterpartyCashLocations:u})=>{const h=e.find(f=>f.counterpartyId===t)||null;return S.useEffect(()=>{(async()=>{if(!(h!=null&&h.isInternal)||!(h!=null&&h.linkedCompanyId)||!d){r([]),s(""),n([]),a("");return}i(!0);try{const p=await d(h.linkedCompanyId);r(p)}catch{r([])}finally{i(!1)}})()},[t,h==null?void 0:h.isInternal,h==null?void 0:h.linkedCompanyId,d,r,s,n,a,i]),S.useEffect(()=>{(async()=>{if(!(h!=null&&h.isInternal)||!(h!=null&&h.linkedCompanyId)||!u){n([]),a("");return}l(!0);try{const p=await u(h.linkedCompanyId,c||null);n(p)}catch{n([])}finally{l(!1)}})()},[t,h==null?void 0:h.linkedCompanyId,c,u,n,a,l]),{selectedCounterpartyData:h}},iJ=({selectedAccountId:t,selectedAccount:e,selectedCounterparty:r,selectedCounterpartyData:s,companyId:n,onCheckAccountMapping:a})=>{const[i,l]=S.useState("none"),[c,d]=S.useState(!1),u=async()=>{var p;if(!t||!r||!s||!a){l("none");return}if(!s.isInternal){l("none");return}const f=(p=e==null?void 0:e.categoryTag)==null?void 0:p.toLowerCase();if(f!=="payable"&&f!=="receivable"){l("none");return}l("checking");try{await a(n,r,t)?l("valid"):(l("invalid"),d(!0))}catch{l("invalid"),d(!0)}};return S.useEffect(()=>{u()},[t,r,e==null?void 0:e.categoryTag,s==null?void 0:s.isInternal,n,a]),{accountMappingStatus:i,showMappingWarning:c,setShowMappingWarning:d,handleMappingWarningClose:()=>{d(!1)}}},lJ=({isDebit:t,onSubmit:e,accounts:r,cashLocations:s,counterparties:n,companyId:a,suggestedAmount:i,initialData:l,disabledCashLocationId:c=null,onCheckAccountMapping:d,onGetCounterpartyStores:u,onGetCounterpartyCashLocations:h,onValidationChange:f})=>{const p=aJ({initialData:l,initialIsDebit:t,suggestedAmount:i}),{isDebit:_,selectedAccountId:v,amount:x,description:m,selectedCashLocation:g,selectedCounterparty:y,counterpartyStores:w,selectedCounterpartyStore:b,counterpartyCashLocations:C,selectedCounterpartyCashLocation:j,loadingCounterpartyStores:I,loadingCounterpartyCashLocations:k,debtCategory:E,interestRate:T,interestAccountId:D,interestDueDay:N,issueDate:A,dueDate:$,debtDescription:z,setIsDebit:H,setSelectedCashLocation:L,setSelectedCounterparty:B,setSelectedCounterpartyStore:O,setSelectedCounterpartyCashLocation:M,setDebtCategory:R,setInterestRate:ie,setInterestAccountId:Z,setInterestDueDay:Ie,setIssueDate:Te,setDueDate:Ke,setDebtDescription:ye,setCounterpartyStores:P,setCounterpartyCashLocations:xe,setLoadingCounterpartyStores:je,setLoadingCounterpartyCashLocations:ne,setDescription:Ce,formatAmountDisplay:Ue,handleAmountChange:J,handleAccountChange:U}=p,ue=r.find(te=>te.accountId===v)||null,{selectedCounterpartyData:ee}=oJ({selectedCounterparty:y,counterparties:n,setCounterpartyStores:P,setSelectedCounterpartyStore:O,setCounterpartyCashLocations:xe,setSelectedCounterpartyCashLocation:M,setLoadingCounterpartyStores:je,setLoadingCounterpartyCashLocations:ne,selectedCounterpartyStore:b,onGetCounterpartyStores:u,onGetCounterpartyCashLocations:h}),{accountMappingStatus:F,showMappingWarning:Y,handleMappingWarningClose:le}=iJ({selectedAccountId:v,selectedAccount:ue,selectedCounterparty:y,selectedCounterpartyData:ee,companyId:a,onCheckAccountMapping:d}),ve=te=>{switch(te==null?void 0:te.toLowerCase()){case"payable":return"rgba(239, 68, 68, 0.15)";case"receivable":return"rgba(59, 130, 246, 0.15)";case"contra_asset":return"rgba(107, 114, 128, 0.15)";case"cash":return"rgba(34, 197, 94, 0.15)";case"general":return"rgba(107, 114, 128, 0.15)";case"fixed_asset":return"rgba(168, 85, 247, 0.15)";case"equity":return"rgba(14, 165, 233, 0.15)";default:return"rgba(107, 114, 128, 0.15)"}},ot=te=>{switch(te==null?void 0:te.toLowerCase()){case"payable":return"rgb(239, 68, 68)";case"receivable":return"rgb(59, 130, 246)";case"contra_asset":return"rgb(107, 114, 128)";case"cash":return"rgb(34, 197, 94)";case"general":return"rgb(107, 114, 128)";case"fixed_asset":return"rgb(168, 85, 247)";case"equity":return"rgb(14, 165, 233)";default:return"rgb(107, 114, 128)"}},He=te=>te?te.replace(/_/g," ").replace(/\b\w/g,Vt=>Vt.toUpperCase()):"General",Pt=te=>{if(!te)return"??";const Vt=te.trim().split(" ");return Vt.length===1?te.substring(0,2).toUpperCase():Vt.slice(0,2).map(bs=>bs[0]).join("").toUpperCase()},Br=r.map(te=>({value:te.accountId,label:te.accountName,badge:Pt(te.accountName),description:te.categoryTag&&te.categoryTag.toLowerCase()!=="general"?He(te.categoryTag):void 0,descriptionBgColor:te.categoryTag?ve(te.categoryTag):void 0,descriptionColor:te.categoryTag?ot(te.categoryTag):void 0})),Ao=s.map(te=>({value:te.locationId,label:te.locationName,badge:Pt(te.locationName),description:te.locationType||void 0,disabled:c===te.locationId&&g!==te.locationId})),Do=n.map(te=>{let Vt="",bs,Js;return te.isInternal?(Vt="Internal Company",te.type&&(Vt+=`  ${te.type}`),bs="rgba(59, 130, 246, 0.1)",Js="rgba(59, 130, 246, 1)"):(Vt=te.type||"",Vt&&(bs="rgba(107, 114, 128, 0.1)",Js="rgba(107, 114, 128, 1)")),{value:te.counterpartyId,label:te.counterpartyName,badge:Pt(te.counterpartyName),description:Vt||void 0,descriptionBgColor:bs,descriptionColor:Js}}),Mo=()=>{if(!v||!x)return;const te=r.find(Js=>Js.accountId===v);if(!te)return;const Vt=parseFloat(x.replace(/,/g,""));if(isNaN(Vt)||Vt<=0)return;const bs={accountId:te.accountId,accountName:te.accountName,categoryTag:te.categoryTag,amount:Vt,description:m||void 0,isDebit:_,cashLocationId:g||void 0,counterpartyId:y||void 0,counterpartyStoreId:b||void 0,counterpartyCashLocationId:j||void 0,debtCategory:E||void 0,interestRate:T?parseFloat(T):void 0,interestAccountId:D||void 0,interestDueDay:N?parseInt(N):void 0,issueDate:A||void 0,dueDate:$||void 0,debtDescription:z||void 0};e(bs)},Er=(()=>{var Vt;if(!v||!x||parseFloat(x)<=0)return!1;const te=(Vt=ue==null?void 0:ue.categoryTag)==null?void 0:Vt.toLowerCase();return!((te==="payable"||te==="receivable")&&!y||ee!=null&&ee.isInternal&&(ee!=null&&ee.linkedCompanyId)&&(!b||!j))})();S.useEffect(()=>{f==null||f(Er)},[Er,f]);const Ro=[{value:"",label:"Select debt category"},{value:"note",label:"Note"},{value:"account",label:"Account"},{value:"loan",label:"Loan"},{value:"other",label:"Other"}],$d=()=>{if(!ue||!ue.categoryTag)return null;const{categoryTag:te}=ue,Vt=te==="receivable"||te==="payable",bs=w.map(cr=>({value:cr.storeId,label:cr.storeName,badge:Pt(cr.storeName)})),Js=C.map(cr=>({value:cr.locationId,label:cr.locationName,badge:Pt(cr.locationName),description:cr.locationType||void 0}));return o.jsxs("div",{className:Be.conditionalFields,children:[te==="cash"&&o.jsx(Ze,{label:"Cash Location",placeholder:"Select cash location",value:g,options:Ao,onChange:cr=>L(cr),required:!0,searchable:!0,showBadges:!1,fullWidth:!0,emptyMessage:"No cash locations found"}),Vt&&o.jsxs(o.Fragment,{children:[o.jsx(Ze,{label:"Counterparty",placeholder:"Select counterparty",value:y,options:Do,onChange:cr=>B(cr),required:!0,searchable:!0,showBadges:!1,showDescriptions:!0,fullWidth:!0,emptyMessage:"No counterparties found"}),(ee==null?void 0:ee.isInternal)&&F==="valid"&&o.jsxs("div",{style:{padding:"12px 16px",backgroundColor:"rgba(34, 197, 94, 0.1)",borderRadius:"8px",display:"flex",alignItems:"center",gap:"8px",marginTop:"12px"},children:[o.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",children:[o.jsx("circle",{cx:"10",cy:"10",r:"10",fill:"rgb(34, 197, 94)",opacity:"0.2"}),o.jsx("path",{d:"M6 10l3 3 5-5",stroke:"rgb(34, 197, 94)",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),o.jsx("span",{style:{color:"rgb(34, 197, 94)",fontSize:"14px",fontWeight:"500"},children:"Account mapping verified"})]}),(ee==null?void 0:ee.isInternal)&&(ee==null?void 0:ee.linkedCompanyId)&&o.jsx(Ze,{label:"Counterparty Store",placeholder:I?"Loading stores...":"Select counterparty store",value:b,options:bs,onChange:cr=>{O(cr),M("")},required:!0,searchable:!0,showBadges:!1,fullWidth:!0,emptyMessage:I?"Loading...":"No stores configured for this counterparty",disabled:I}),(ee==null?void 0:ee.isInternal)&&(ee==null?void 0:ee.linkedCompanyId)&&o.jsx(Ze,{label:"Counterparty Cash Location",placeholder:k?"Loading locations...":"Select counterparty cash location",value:j,options:Js,onChange:cr=>M(cr),required:!0,searchable:!0,showBadges:!1,fullWidth:!0,emptyMessage:k?"Loading...":"No cash locations found",disabled:k})]})]})};return o.jsxs("form",{className:Be.transactionForm,onSubmit:te=>{te.preventDefault(),Mo()},children:[o.jsxs("div",{className:Be.formSection,children:[o.jsx("div",{className:Be.formTitle,children:"Transaction Type"}),o.jsxs("div",{className:`${Be.transactionTypeToggle} ${_?"":Be.credit}`,children:[o.jsx("button",{type:"button",className:`${Be.transactionTypeOption} ${_?Be.active:""}`,onClick:()=>H(!0),children:"Debit"}),o.jsx("button",{type:"button",className:`${Be.transactionTypeOption} ${_?"":Be.active}`,onClick:()=>H(!1),children:"Credit"})]})]}),o.jsx(Ze,{label:"Account",placeholder:"Select account",value:v,options:Br,onChange:U,required:!0,searchable:!0,showBadges:!1,showDescriptions:!0,fullWidth:!0,emptyMessage:"No accounts found"}),$d(),o.jsxs("div",{className:Be.formSection,children:[o.jsxs("div",{className:Be.formTitle,children:["Amount ",o.jsx("span",{className:Be.required,children:"*"})]}),o.jsx("input",{type:"text",className:Be.input,placeholder:"Enter amount",value:Ue(x),onChange:te=>J(te.target.value)})]}),o.jsxs("div",{className:Be.formSection,children:[o.jsx("div",{className:Be.formTitle,children:"Description (Optional)"}),o.jsx("input",{type:"text",className:Be.input,placeholder:"Enter description",value:m,onChange:te=>Ce(te.target.value)})]}),(ue==null?void 0:ue.categoryTag)&&(ue.categoryTag==="payable"||ue.categoryTag==="receivable")&&y&&o.jsxs("div",{className:Be.debtFields,children:[o.jsx(Ze,{label:"Debt Category (Optional)",placeholder:"Select debt category",value:E,options:Ro,onChange:te=>R(te),required:!1,searchable:!1,showBadges:!1,fullWidth:!0,emptyMessage:"No categories available"}),o.jsxs("div",{className:Be.formSection,children:[o.jsx("div",{className:Be.formTitle,children:"Interest Rate (%) (Optional)"}),o.jsx("input",{type:"number",className:Be.input,placeholder:"Enter interest rate",value:T,onChange:te=>ie(te.target.value),min:"0",max:"100",step:"0.01"})]}),o.jsx(Ze,{label:"Interest Account (Optional)",placeholder:"Select interest account",value:D,options:Br,onChange:te=>Z(te),required:!1,searchable:!0,showBadges:!1,showDescriptions:!0,fullWidth:!0,emptyMessage:"No accounts found"}),o.jsxs("div",{className:Be.formSection,children:[o.jsx("div",{className:Be.formTitle,children:"Interest Due Day (Optional)"}),o.jsx("input",{type:"number",className:Be.input,placeholder:"Enter day (1-31)",value:N,onChange:te=>Ie(te.target.value),min:"1",max:"31",step:"1"})]}),o.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"},children:[o.jsxs("div",{className:Be.formSection,children:[o.jsx("div",{className:Be.formTitle,children:"Issue Date (Optional)"}),o.jsxs("div",{className:Be.dateInputWrapper,children:[o.jsx("input",{type:"date",className:Be.input,value:A,onChange:te=>Te(te.target.value)}),A&&o.jsx("button",{type:"button",className:Be.dateClearButton,onClick:()=>Te(""),"aria-label":"Clear issue date",children:o.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"})})})]})]}),o.jsxs("div",{className:Be.formSection,children:[o.jsx("div",{className:Be.formTitle,children:"Due Date (Optional)"}),o.jsxs("div",{className:Be.dateInputWrapper,children:[o.jsx("input",{type:"date",className:Be.input,value:$,onChange:te=>Ke(te.target.value)}),$&&o.jsx("button",{type:"button",className:Be.dateClearButton,onClick:()=>Ke(""),"aria-label":"Clear due date",children:o.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"})})})]})]})]}),o.jsxs("div",{className:Be.formSection,children:[o.jsx("div",{className:Be.formTitle,children:"Debt Description (Optional)"}),o.jsx("textarea",{className:Be.input,placeholder:"Enter debt description",value:z,onChange:te=>ye(te.target.value),rows:2,style:{resize:"vertical",fontFamily:"inherit"}})]})]}),o.jsx("button",{type:"submit",style:{display:"none"},disabled:!Er}),o.jsx($e,{variant:"warning",title:"Account Mapping Required",message:"This internal counterparty requires an account mapping to be set up first. Please configure the account mapping in the Account Mapping page before using this counterparty.",isOpen:Y,onClose:le,onConfirm:le,confirmText:"OK",showCancelButton:!1})]})},cJ="_modalOverlay_2brv3_3",dJ="_modal_2brv3_3",uJ="_modalHeader_2brv3_29",hJ="_modalTitle_2brv3_37",fJ="_modalClose_2brv3_44",mJ="_modalBody_2brv3_61",pJ="_modalFooter_2brv3_67",na={modalOverlay:cJ,modal:dJ,modalHeader:uJ,modalTitle:hJ,modalClose:fJ,modalBody:mJ,modalFooter:pJ},gJ=({isOpen:t,isEditMode:e,editingIndex:r,journalEntry:s,modalTransactionType:n,accounts:a,cashLocations:i,counterparties:l,companyId:c,selectedStoreId:d,isFormValid:u,onSubmit:h,onCancel:f,onCheckAccountMapping:p,onGetCounterpartyStores:_,onGetCounterpartyCashLocations:v,onValidationChange:x})=>{if(!t)return null;const m=e&&r!==null?s.transactionLines[r]:null,g=m?{accountId:m.accountId,accountName:m.accountName,categoryTag:m.categoryTag||void 0,amount:m.amount,description:m.description||void 0,isDebit:m.isDebit,cashLocationId:m.cashLocationId||void 0,counterpartyId:m.counterpartyId||void 0,counterpartyStoreId:m.counterpartyStoreId||void 0,counterpartyCashLocationId:m.counterpartyCashLocationId||void 0,debtCategory:m.debtCategory||void 0,interestRate:m.interestRate||void 0,interestAccountId:m.interestAccountId||void 0,interestDueDay:m.interestDueDay||void 0,issueDate:m.issueDate||void 0,dueDate:m.dueDate||void 0,debtDescription:m.debtDescription||void 0}:void 0,y=e&&m!=null&&m.cashLocationId?null:s.getCashLocationId(),w=()=>{const b=document.querySelector("form");if(b){const C=b.querySelector('button[type="submit"]');C==null||C.click()}};return o.jsx("div",{className:na.modalOverlay,onClick:f,children:o.jsxs("div",{className:na.modal,onClick:b=>b.stopPropagation(),children:[o.jsxs("div",{className:na.modalHeader,children:[o.jsx("h2",{className:na.modalTitle,children:e?"Edit Transaction":"Add Transaction"}),o.jsx("button",{className:na.modalClose,onClick:f,children:o.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"})})})]}),o.jsx("div",{className:na.modalBody,children:o.jsx(lJ,{isDebit:n==="debit",onSubmit:h,onCancel:f,accounts:a,cashLocations:i,counterparties:l,companyId:c,storeId:d,suggestedAmount:Math.abs(s.difference),initialData:g,isEditMode:e,disabledCashLocationId:y,onCheckAccountMapping:p,onGetCounterpartyStores:_,onGetCounterpartyCashLocations:v,onValidationChange:x})}),o.jsxs("div",{className:na.modalFooter,children:[o.jsx(Ne,{variant:"outline",size:"lg",onClick:f,children:"Cancel"}),o.jsx(Ne,{variant:"primary",size:"lg",disabled:!u,onClick:w,children:e?"Update":"Add"})]})]})})},_J="_pageLayout_1jpke_8",yJ="_container_1jpke_17",vJ="_header_1jpke_24",xJ="_title_1jpke_28",bJ="_subtitle_1jpke_35",wJ="_journalHeaderCard_1jpke_42",SJ="_journalDateInfo_1jpke_54",jJ="_journalDateIcon_1jpke_60",CJ="_journalDateText_1jpke_67",NJ="_journalCompanyInfo_1jpke_73",IJ="_journalCompanyIcon_1jpke_80",kJ="_journalCompanyText_1jpke_86",EJ="_storeSelectorCard_1jpke_97",TJ="_tabsContainer_1jpke_106",LJ="_tabsWrapper_1jpke_110",AJ="_tab_1jpke_106",DJ="_active_1jpke_140",MJ="_iconActive_1jpke_158",RJ="_tabIcon_1jpke_162",rt={pageLayout:_J,container:yJ,header:vJ,title:xJ,subtitle:bJ,journalHeaderCard:wJ,journalDateInfo:SJ,journalDateIcon:jJ,journalDateText:CJ,journalCompanyInfo:NJ,journalCompanyIcon:IJ,journalCompanyText:kJ,storeSelectorCard:EJ,tabsContainer:TJ,tabsWrapper:LJ,tab:AJ,active:DJ,iconActive:MJ,tabIcon:RJ},PJ=()=>{const{user:t}=dl(),{currentCompany:e,currentStore:r}=ht(),s=(e==null?void 0:e.company_id)||"",n=(e==null?void 0:e.stores)||[],[a,i]=S.useState((r==null?void 0:r.store_id)||null),{journalEntry:l,accounts:c,cashLocations:d,counterparties:u,loading:h,submitting:f,addTransactionLine:p,updateTransactionLine:_,removeTransactionLine:v,submitJournalEntry:x,resetJournalEntry:m,checkAccountMapping:g,getCounterpartyStores:y,getCounterpartyCashLocations:w}=ZU(s,a,(t==null?void 0:t.id)||""),[b,C]=S.useState(!1),[j,I]=S.useState("debit"),[k,E]=S.useState(null),[T,D]=S.useState("excel"),[N,A]=S.useState(!1),[$,z]=S.useState(!1),[H,L]=S.useState(!1),[B,O]=S.useState(!1),[M,R]=S.useState(""),ie=ne=>{i(ne),m(ne)};if(!e)return o.jsxs(o.Fragment,{children:[o.jsx(Se,{activeItem:"finance"}),o.jsx("div",{className:rt.pageLayout,children:o.jsx("div",{className:rt.container,children:o.jsxs("div",{className:rt.header,children:[o.jsx("h1",{className:rt.title,children:"Journal Input"}),o.jsx("p",{className:rt.subtitle,children:"Please select a company first"})]})})})]});const Z=()=>l.totalDebits<=l.totalCredits?"debit":"credit",Ie=()=>{E(null),A(!1),I(Z()),C(!0)},Te=ne=>{const Ce=ne.cashLocationId?d.find(U=>U.locationId===ne.cashLocationId):null,Ue=ne.counterpartyId?u.find(U=>U.counterpartyId===ne.counterpartyId):null,J=new Vx(ne.isDebit,ne.accountId,ne.accountName,ne.amount,ne.description||"",ne.categoryTag||null,ne.cashLocationId||null,(Ce==null?void 0:Ce.locationName)||null,(Ce==null?void 0:Ce.locationType)||null,ne.counterpartyId||null,(Ue==null?void 0:Ue.counterpartyName)||null,ne.counterpartyStoreId||null,null,ne.debtCategory||null,ne.interestRate||null,ne.interestAccountId||null,ne.interestDueDay||null,ne.issueDate||null,ne.dueDate||null,ne.debtDescription||null,(Ue==null?void 0:Ue.linkedCompanyId)||null,ne.counterpartyCashLocationId||null);k!==null?_(k,J):p(J),C(!1),E(null)},Ke=()=>{C(!1),E(null),A(!1)},ye=ne=>{E(ne),A(!1);const Ce=l.transactionLines[ne];I(Ce.isDebit?"debit":"credit"),C(!0)},P=ne=>{v(ne)},xe=()=>{if(!l.canSubmit()){z(!0);return}je()},je=async()=>{const ne=await x();ne.success?L(!0):(R(ne.error||"Failed to submit journal entry"),O(!0))};return h?o.jsxs(o.Fragment,{children:[o.jsx(Se,{activeItem:"finance"}),o.jsx("div",{className:rt.pageLayout,children:o.jsxs("div",{className:rt.container,children:[o.jsx("div",{className:rt.header,children:o.jsx("h1",{className:rt.title,children:"Journal Input"})}),o.jsx(Me,{fullscreen:!0})]})})]}):o.jsxs(o.Fragment,{children:[o.jsx(Se,{activeItem:"finance"}),o.jsx("div",{className:rt.pageLayout,children:o.jsxs("div",{className:rt.container,children:[o.jsxs("div",{className:rt.header,children:[o.jsx("h1",{className:rt.title,children:"Journal Entry"}),o.jsx("p",{className:rt.subtitle,children:"Create balanced financial transactions"})]}),o.jsxs("div",{className:rt.journalHeaderCard,children:[o.jsxs("div",{className:rt.journalDateInfo,children:[o.jsx("svg",{className:rt.journalDateIcon,viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M19,3H18V1H16V3H8V1H6V3H5A2,2 0 0,0 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5A2,2 0 0,0 19,3M19,19H5V8H19V19Z"})}),o.jsx("span",{className:rt.journalDateText,children:LD(l.date)})]}),o.jsxs("div",{className:rt.journalCompanyInfo,children:[o.jsx("svg",{className:rt.journalCompanyIcon,viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M12,7V3H2V21H22V7H12M6,19H4V17H6V19M6,15H4V13H6V15M6,11H4V9H6V11M6,7H4V5H6V7M10,19H8V17H10V19M10,15H8V13H10V15M10,11H8V9H10V11M10,7H8V5H10V7M20,19H18V17H20V19M20,15H18V13H20V15M20,11H18V9H20V11M16,19H14V17H16V19M16,15H14V13H16V15M16,11H14V9H16V11"})}),o.jsx("span",{className:rt.journalCompanyText,children:(e==null?void 0:e.company_name)||"Company"})]})]}),o.jsx("div",{className:rt.storeSelectorCard,children:o.jsx(ds,{stores:n,selectedStoreId:a,onStoreSelect:ie,companyId:s,showAllStoresOption:!1,width:"100%"})}),o.jsx("div",{className:rt.tabsContainer,children:o.jsxs("div",{className:`${rt.tabsWrapper} ${T==="icon"?rt.iconActive:""}`,children:[o.jsxs("button",{className:`${rt.tab} ${T==="excel"?rt.active:""}`,onClick:()=>D("excel"),children:[o.jsx("svg",{className:rt.tabIcon,viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20M12.9,14.5L15.8,19H14L12,15.6L10,19H8.2L11.1,14.5L8.2,10H10L12,13.4L14,10H15.8L12.9,14.5Z"})}),"Excel"]}),o.jsxs("button",{className:`${rt.tab} ${T==="icon"?rt.active:""}`,onClick:()=>D("icon"),children:[o.jsx("svg",{className:rt.tabIcon,viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M13,9H18.5L13,3.5V9M6,2H14L20,8V20A2,2 0 0,1 18,22H6C4.89,22 4,21.1 4,20V4C4,2.89 4.89,2 6,2M15,18V16H6V18H15M18,14V12H6V14H18Z"})}),"Icon"]})]})}),T==="icon"&&o.jsx(hG,{journalEntry:l,accounts:c,cashLocations:d,counterparties:u,companyId:s,selectedStoreId:a,submitting:f,onAddTransaction:Ie,onEditTransaction:ye,onDeleteTransaction:P,onSubmit:xe}),T==="excel"&&o.jsx(UG,{accounts:c,cashLocations:d,counterparties:u,companyId:s,selectedStoreId:a,userId:(t==null?void 0:t.id)||"",onCheckAccountMapping:g,onGetCounterpartyStores:y,onGetCounterpartyCashLocations:w,onSubmitSuccess:()=>L(!0),onSubmitError:ne=>{R(ne),O(!0)}})]})}),o.jsx(gJ,{isOpen:b,isEditMode:k!==null,editingIndex:k,journalEntry:l,modalTransactionType:j,accounts:c,cashLocations:d,counterparties:u,companyId:s,selectedStoreId:a,isFormValid:N,onSubmit:Te,onCancel:Ke,onCheckAccountMapping:g,onGetCounterpartyStores:y,onGetCounterpartyCashLocations:w,onValidationChange:A}),o.jsx($e,{variant:"warning",isOpen:$,onClose:()=>z(!1),message:"Journal entry must be balanced with at least 2 transaction lines",zIndex:1e4}),o.jsx($e,{variant:"success",isOpen:H,onClose:()=>L(!1),message:"Journal entry submitted successfully!",zIndex:1e4,autoCloseDuration:2e3}),o.jsx($e,{variant:"error",isOpen:B,onClose:()=>O(!1),message:M,zIndex:1e4})]})},OJ="_pageLayout_72uxe_7",$J="_container_72uxe_16",FJ="_header_72uxe_22",BJ="_title_72uxe_26",VJ="_subtitle_72uxe_33",HJ="_comingSoonCard_72uxe_39",zJ="_comingSoon_72uxe_39",qJ="_icon_72uxe_51",UJ="_comingSoonTitle_72uxe_63",WJ="_comingSoonText_72uxe_70",GJ="_features_72uxe_76",js={pageLayout:OJ,container:$J,header:FJ,title:BJ,subtitle:VJ,comingSoonCard:HJ,comingSoon:zJ,icon:qJ,comingSoonTitle:UJ,comingSoonText:WJ,features:GJ},JJ=()=>o.jsxs(o.Fragment,{children:[o.jsx(Se,{activeItem:"marketing"}),o.jsx("div",{className:js.pageLayout,children:o.jsxs("div",{className:js.container,children:[o.jsxs("div",{className:js.header,children:[o.jsx("h1",{className:js.title,children:"Marketing Plan"}),o.jsx("p",{className:js.subtitle,children:"Plan and track marketing campaigns"})]}),o.jsx("div",{className:js.comingSoonCard,children:o.jsxs("div",{className:js.comingSoon,children:[o.jsx("div",{className:js.icon,children:o.jsx("svg",{width:"64",height:"64",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M12,2L13.09,8.26L22,9L15.5,15.14L16.91,22L12,18.5L7.09,22L8.5,15.14L2,9L10.91,8.26L12,2Z"})})}),o.jsx("h2",{className:js.comingSoonTitle,children:"Marketing Plan Coming Soon"}),o.jsx("p",{className:js.comingSoonText,children:"The marketing plan feature is currently under development."}),o.jsxs("div",{className:js.features,children:[o.jsx("h3",{children:"Planned Features:"}),o.jsxs("ul",{children:[o.jsx("li",{children:" Campaign planning and tracking"}),o.jsx("li",{children:" Marketing analytics and insights"}),o.jsx("li",{children:" Target audience management"}),o.jsx("li",{children:" Budget allocation and ROI tracking"}),o.jsx("li",{children:" Campaign calendar and scheduling"})]})]})]})})]})})]});class KJ{async getOrders(e,r){const s=se.getClient(),{data:n,error:a}=await s.rpc("get_inventory_order_list",{p_company_id:e});if(a)throw console.error("Error fetching orders:",a),new Error(a.message);return(n==null?void 0:n.orders)||[]}async getCompanyCurrency(e){if(!e)return null;try{const r=se.getClient(),{data:s,error:n}=await r.from("companies").select("base_currency_id").eq("company_id",e).single();if(n||!s||!s.base_currency_id)return null;const{data:a,error:i}=await r.from("currency_types").select("currency_id, currency_code").eq("currency_id",s.base_currency_id).single();return i||!a?null:{currency_id:a.currency_id,currency_code:a.currency_code,currency_symbol:DD(a.currency_code)}}catch(r){return console.error("Error fetching company currency:",r),null}}}class YJ{constructor(e,r,s,n,a,i,l,c,d,u,h,f){this.orderId=e,this.orderNumber=r,this.orderDate=s,this.expectedDate=n,this.supplierName=a,this.itemCount=i,this.totalQuantity=l,this.totalAmount=c,this.status=d,this.currencySymbol=u,this.items=h,this.summary=f}get statusDisplay(){switch(this.status){case"pending":return"Pending";case"approved":return"Approved";case"received":return"Received";case"cancelled":return"Cancelled";case"partial":return"Partial";default:return this.status}}formatCurrency(e){return`${this.currencySymbol}${Math.round(e).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}`}get formattedDate(){const e=re.toLocal(this.orderDate);return re.formatCustom(e,{year:"numeric",month:"short",day:"numeric"},"en-US")}get formattedExpectedDate(){if(!this.expectedDate)return null;const e=re.toLocal(this.expectedDate);return re.formatCustom(e,{year:"numeric",month:"short",day:"numeric"},"en-US")}get isCancellable(){return this.status==="pending"||this.status==="approved"}get isReceivable(){return this.status==="approved"||this.status==="partial"}get receivingProgress(){return this.summary?{received:this.summary.total_received,total:this.summary.total_ordered,percentage:this.summary.completion_rate}:{received:0,total:0,percentage:0}}}let QJ=class qx{static fromJson(e,r="$"){var d,u;const s=((d=e.summary)==null?void 0:d.total_products)??(e.items?e.items.length:0),n=((u=e.summary)==null?void 0:u.total_ordered)??0,a=r,l=re.toLocal(e.order_date).toISOString(),c=e.expected_date?re.toLocal(e.expected_date).toISOString():null;return new YJ(e.order_id,e.order_number,l,c,e.supplier_name,s,n,e.total_amount,e.status,a,e.items,e.summary)}static toJson(e){return{order_id:e.orderId,order_number:e.orderNumber,order_date:e.orderDate,expected_date:e.expectedDate,supplier_name:e.supplierName,total_amount:e.totalAmount,status:e.status,items:e.items,summary:e.summary}}static fromJsonArray(e,r="$"){return e.map(s=>qx.fromJson(s,r))}};class ZJ{constructor(){W(this,"dataSource");this.dataSource=new KJ}async getOrders(e,r){try{const[s,n]=await Promise.all([this.dataSource.getCompanyCurrency(e),this.dataSource.getOrders(e,r)]),a=(s==null?void 0:s.currency_symbol)||"$";return{success:!0,data:QJ.fromJsonArray(n,a)}}catch(s){return console.error("Repository error fetching orders:",s),{success:!1,error:s instanceof Error?s.message:"Failed to fetch orders"}}}}const XJ=new ZJ,xt=er(t=>({orders:[],selectedOrder:null,currency:{symbol:"$",code:"USD"},activeTab:"new-order",searchQuery:"",selectedOrderIds:new Set,loading:!0,error:null,isCreatingOrder:!1,isCancellingOrder:!1,notification:{isOpen:!1,variant:"success",message:""},setActiveTab:e=>t({activeTab:e}),setSearchQuery:e=>t({searchQuery:e}),toggleOrderSelection:e=>t(r=>{const s=new Set(r.selectedOrderIds);return s.has(e)?s.delete(e):s.add(e),{selectedOrderIds:s}}),selectAllOrders:()=>t(e=>({selectedOrderIds:new Set(e.orders.map(r=>r.orderId))})),clearSelection:()=>t({selectedOrderIds:new Set}),setSelectedOrder:e=>t({selectedOrder:e}),showNotification:(e,r)=>t({notification:{isOpen:!0,variant:e,message:r}}),hideNotification:()=>t(e=>({notification:{...e.notification,isOpen:!1}})),setLoading:e=>t({loading:e}),setError:e=>t({error:e}),clearError:()=>t({error:null}),loadOrders:async(e,r)=>{t({loading:!0,error:null});try{const s=await XJ.getOrders(e,r);if(!s.success){t({error:s.error||"Failed to load orders",orders:[],loading:!1});return}const n=(s.data||[]).sort((a,i)=>{const l=new Date(a.orderDate);return new Date(i.orderDate).getTime()-l.getTime()});t({orders:n,loading:!1})}catch(s){t({error:s instanceof Error?s.message:"An unexpected error occurred",orders:[],loading:!1})}},createOrder:async e=>{t({isCreatingOrder:!0,error:null});try{return t({isCreatingOrder:!1}),{success:!1,error:"Order creation not yet implemented"}}catch(r){return t({isCreatingOrder:!1}),{success:!1,error:r instanceof Error?r.message:"An unexpected error occurred"}}},cancelOrder:async e=>{t({isCancellingOrder:!0,error:null});try{return t({isCancellingOrder:!1}),{success:!1,error:"Order cancellation not yet implemented"}}catch(r){return t({isCancellingOrder:!1}),{success:!1,error:r instanceof Error?r.message:"An unexpected error occurred"}}},refresh:async()=>{}})),eK=(t,e)=>{const r=xt(N=>N.orders),s=xt(N=>N.selectedOrder),n=xt(N=>N.currency),a=xt(N=>N.activeTab),i=xt(N=>N.searchQuery),l=xt(N=>N.selectedOrderIds),c=xt(N=>N.loading),d=xt(N=>N.error),u=xt(N=>N.isCreatingOrder),h=xt(N=>N.isCancellingOrder),f=xt(N=>N.notification),p=xt(N=>N.setActiveTab),_=xt(N=>N.setSearchQuery),v=xt(N=>N.toggleOrderSelection),x=xt(N=>N.selectAllOrders),m=xt(N=>N.clearSelection),g=xt(N=>N.setSelectedOrder),y=xt(N=>N.showNotification),w=xt(N=>N.hideNotification),b=xt(N=>N.setLoading),C=xt(N=>N.setError),j=xt(N=>N.clearError),I=xt(N=>N.loadOrders),k=xt(N=>N.createOrder),E=xt(N=>N.cancelOrder);S.useEffect(()=>{t&&I(t,e)},[t,e]);const T=S.useCallback(()=>{t&&I(t,e)},[t,e]);return{orders:i?r.filter(N=>N.orderNumber.toLowerCase().includes(i.toLowerCase())||N.supplierName.toLowerCase().includes(i.toLowerCase())):r,allOrders:r,selectedOrder:s,currency:n,activeTab:a,searchQuery:i,selectedOrderIds:l,loading:c,error:d,isCreatingOrder:u,isCancellingOrder:h,notification:f,setActiveTab:p,setSearchQuery:_,toggleOrderSelection:v,selectAllOrders:x,clearSelection:m,setSelectedOrder:g,showNotification:y,hideNotification:w,setLoading:b,setError:C,clearError:j,createOrder:k,cancelOrder:E,refresh:T}};class tK{async getSuppliers(e){const{data:r,error:s}=await se.getClient().from("counterparties").select("counterparty_id, name, email, phone, address, notes").eq("company_id",e).eq("type","Suppliers").eq("is_deleted",!1).order("name");if(s)throw console.error("Error fetching counterparties:",s),new Error(s.message);return r||[]}}class Am{static fromJson(e){return{counterparty_id:e.counterparty_id,name:e.name,email:e.email,phone:e.phone,address:e.address,notes:e.notes}}static fromJsonArray(e){return e.map(r=>Am.fromJson(r))}static toJson(e){return{counterparty_id:e.counterparty_id,name:e.name,email:e.email,phone:e.phone,address:e.address,notes:e.notes}}}class rK{constructor(){W(this,"dataSource");this.dataSource=new tK}async getSuppliers(e){try{const r=await this.dataSource.getSuppliers(e);return{success:!0,data:Am.fromJsonArray(r)}}catch(r){return console.error("Repository error fetching counterparties:",r),{success:!1,error:r instanceof Error?r.message:"Failed to fetch suppliers"}}}searchByName(e,r){if(!r||r.length<1)return e;const s=r.toLowerCase();return e.filter(n=>(n.name||"").toLowerCase().includes(s))}getById(e,r){return e.find(s=>s.counterparty_id===r)||null}}const sK=t=>{const[e,r]=S.useState([]),[s,n]=S.useState(!1),[a,i]=S.useState(null),l=new rK,c=S.useCallback(async()=>{if(t){n(!0),i(null);try{const d=await l.getSuppliers(t);if(!d.success){i(d.error||"Failed to fetch suppliers"),r([]);return}r(d.data||[])}catch(d){console.error("Error fetching counterparties:",d),i(d instanceof Error?d.message:"Failed to fetch suppliers"),r([])}finally{n(!1)}}},[t]);return S.useEffect(()=>{t?c():r([])},[t,c]),{counterparties:e,loading:s,error:a,refresh:c}};class nK{async getProductsByCompany(e){const{data:r,error:s}=await se.getClient().rpc("get_inventory_product_list_company",{p_company_id:e});if(s)throw console.error("Error fetching products:",s),new Error(s.message);if(!r||!r.success)throw new Error("Failed to fetch products");return{company:r.data.company||null,products:r.data.products||[],summary:r.data.summary||null}}}class Dm{static fromJson(e){var r,s,n,a;return{product_id:e.product_id,product_name:e.product_name,sku:e.sku,barcode:e.barcode,unit_of_measure:e.unit_of_measure,selling_price:((r=e.pricing)==null?void 0:r.selling_price)??0,quantity_on_hand:((s=e.total_stock_summary)==null?void 0:s.total_quantity_on_hand)??0,is_active:((n=e.status)==null?void 0:n.is_active)??!0,is_deleted:((a=e.status)==null?void 0:a.is_deleted)??!1}}static fromJsonArray(e){return e.map(r=>Dm.fromJson(r))}}class aK{constructor(){W(this,"dataSource");this.dataSource=new nK}async getProducts(e){var r,s,n,a;try{const i=await this.dataSource.getProductsByCompany(e),l=Dm.fromJsonArray(i.products),c=((s=(r=i.company)==null?void 0:r.currency)==null?void 0:s.symbol)||"",d=((a=(n=i.company)==null?void 0:n.currency)==null?void 0:a.code)||"KRW";return{success:!0,data:{products:l,currencySymbol:c,currencyCode:d}}}catch(i){return console.error("Repository error fetching products:",i),{success:!1,error:i instanceof Error?i.message:"Failed to fetch products"}}}async getActiveProducts(e){const r=await this.getProducts(e);if(!r.success||!r.data)return r;const s=r.data.products.filter(n=>n.is_active&&!n.is_deleted);return{success:!0,data:{...r.data,products:s}}}searchProducts(e,r){if(!r||r.length<1)return[];const s=r.toLowerCase();return e.filter(n=>{const a=(n.product_name||"").toLowerCase(),i=(n.sku||"").toLowerCase(),l=(n.barcode||"").toLowerCase();return a.includes(s)||i.includes(s)||l.includes(s)})}getProductById(e,r){return e.find(s=>s.product_id===r)||null}getProductBySKU(e,r){return e.find(s=>s.sku===r)||null}}const oK=t=>{const[e,r]=S.useState([]),[s,n]=S.useState(!1),[a,i]=S.useState(null),[l,c]=S.useState(""),d=new aK,u=S.useCallback(async()=>{if(t){n(!0),i(null);try{const v=await d.getProducts(t);if(!v.success){i(v.error||"Failed to fetch products"),r([]);return}v.data&&(r(v.data.products),c(v.data.currencySymbol))}catch(v){console.error("Error fetching products:",v),i(v instanceof Error?v.message:"Failed to fetch products"),r([])}finally{n(!1)}}},[t]);S.useEffect(()=>{t?u():(r([]),c(""))},[t,u]);const h=S.useCallback(()=>e.filter(v=>v.is_active&&!v.is_deleted),[e]),f=S.useCallback(v=>{const x=h();return d.searchProducts(x,v)},[e,h]),p=S.useCallback(v=>d.getProductById(e,v),[e]),_=S.useCallback(v=>d.getProductBySKU(e,v),[e]);return{products:e,loading:s,error:a,currencySymbol:l,refresh:u,getActiveProducts:h,searchProducts:f,getProductById:p,getProductBySKU:_}};class iK{static validateOrderDate(e){if(!e||e.trim()==="")return{field:"orderDate",message:"Order date is required"};const r=new Date(e);if(isNaN(r.getTime()))return{field:"orderDate",message:"Invalid order date format"};const s=new Date;return s.setFullYear(s.getFullYear()+1),r>s?{field:"orderDate",message:"Order date cannot be more than 1 year in the future"}:null}static validateCounterpartySupplier(e){return!e||e.trim()===""?{field:"supplier",message:"Please select a supplier"}:null}static validateSupplierInfo(e){const r=[];return(!e.name||e.name.trim()==="")&&r.push({field:"supplier.name",message:"Supplier name is required"}),e.email&&e.email.trim()!==""&&(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e.email)||r.push({field:"supplier.email",message:"Invalid email format"})),e.phone&&e.phone.trim()!==""&&(/^[\d\s\-\+\(\)]+$/.test(e.phone)||r.push({field:"supplier.phone",message:"Invalid phone format"})),r}static validateOrderItems(e){const r=[];return!e||e.length===0?(r.push({field:"items",message:"At least one product must be added to the order"}),r):(e.forEach((s,n)=>{(!s.quantity_ordered||s.quantity_ordered<=0)&&r.push({field:`items[${n}].quantity_ordered`,message:`Item "${s.product_name}": Quantity must be greater than 0`}),(s.unit_price===void 0||s.unit_price===null||s.unit_price<0)&&r.push({field:`items[${n}].unit_price`,message:`Item "${s.product_name}": Unit price must be 0 or greater`});const a=s.quantity_ordered*s.unit_price;Math.abs(s.total_amount-a)>.01&&r.push({field:`items[${n}].total_amount`,message:`Item "${s.product_name}": Total amount calculation mismatch`}),(!s.product_id||s.product_id.trim()==="")&&r.push({field:`items[${n}].product_id`,message:`Item "${s.product_name}": Missing product ID`})}),r)}static validateOrderForm(e,r,s,n,a){const i=[],l=this.validateOrderDate(e);if(l&&i.push(l),r==="counter-party"){const d=this.validateCounterpartySupplier(s);d&&i.push(d)}else if(r==="others")if(!n)i.push({field:"supplier",message:"Supplier information is required"});else{const d=this.validateSupplierInfo(n);i.push(...d)}const c=this.validateOrderItems(a);return i.push(...c),i}static isValidOrderForm(e,r,s,n,a){return this.validateOrderForm(e,r,s,n,a).length===0}}const Bu={name:"",contact:"",phone:"",email:"",address:"",bank_account:"",memo:""},ze=er((t,e)=>({orderDate:"",notes:"",supplierTab:"counter-party",selectedSupplier:null,supplierInfo:Bu,orderItems:[],isDropdownOpen:!1,searchTerm:"",showSuggestions:!1,searchResults:[],isCreating:!1,error:null,validationErrors:{},setOrderDate:r=>t({orderDate:r}),setNotes:r=>t({notes:r}),setSupplierTab:r=>{t(r==="others"?{supplierTab:r,selectedSupplier:null}:{supplierTab:r,supplierInfo:Bu})},setSelectedSupplier:r=>t({selectedSupplier:r}),setSupplierInfo:r=>t(s=>({supplierInfo:{...s.supplierInfo,...r}})),setOrderItems:r=>t({orderItems:r}),setIsDropdownOpen:r=>t({isDropdownOpen:r}),setSearchTerm:r=>t({searchTerm:r}),setShowSuggestions:r=>t({showSuggestions:r}),setSearchResults:r=>t({searchResults:r}),setIsCreating:r=>t({isCreating:r}),setError:r=>t({error:r}),setValidationErrors:r=>t({validationErrors:r}),clearErrors:()=>t({error:null,validationErrors:{}}),addOrderItem:r=>{const s=e();if(s.orderItems.find(a=>a.product_id===r.product_id))t({orderItems:s.orderItems.map(a=>a.product_id===r.product_id?{...a,quantity:a.quantity+1,subtotal:(a.quantity+1)*a.unit_price}:a)});else{const a={product_id:r.product_id,product_name:r.product_name,sku:r.sku||"",unit:r.unit_of_measure||"Unit",quantity:1,unit_price:r.selling_price||0,subtotal:r.selling_price||0};t({orderItems:[...s.orderItems,a]})}},updateOrderItemQuantity:(r,s)=>{const n=e();t({orderItems:n.orderItems.map(a=>a.product_id===r?{...a,quantity:s,subtotal:s*a.unit_price}:a)})},updateOrderItemPrice:(r,s)=>{const n=e();t({orderItems:n.orderItems.map(a=>a.product_id===r?{...a,unit_price:s,subtotal:a.quantity*s}:a)})},removeOrderItem:r=>{const s=e();t({orderItems:s.orderItems.filter(n=>n.product_id!==r)})},searchProducts:(r,s)=>{if(!r||r.length<1){t({searchResults:[],showSuggestions:!1});return}const n=r.toLowerCase(),a=s.filter(i=>i.product_name.toLowerCase().includes(n)||i.sku&&i.sku.toLowerCase().includes(n));t({searchResults:a.slice(0,10),showSuggestions:!0})},clearSearch:()=>{t({searchTerm:"",searchResults:[],showSuggestions:!1})},validateForm:()=>{var a;const r=e(),s=r.orderItems.map(i=>({product_id:i.product_id,product_name:i.product_name,sku:i.sku,barcode:void 0,quantity_ordered:i.quantity,quantity_received_total:void 0,quantity_remaining:void 0,unit_price:i.unit_price,total_amount:i.subtotal})),n=iK.validateOrderForm(r.orderDate,r.supplierTab,((a=r.selectedSupplier)==null?void 0:a.counterparty_id)||null,r.supplierTab==="others"?r.supplierInfo:null,s);if(n.length>0){const i={};return n.forEach(l=>{i[l.field]=l.message}),t({validationErrors:i}),!1}return t({validationErrors:{}}),!0},resetForm:()=>{const r=new Date,s=r.getFullYear(),n=String(r.getMonth()+1).padStart(2,"0"),a=String(r.getDate()).padStart(2,"0"),i=`${s}-${n}-${a}`;t({orderDate:i,notes:"",supplierTab:"counter-party",selectedSupplier:null,supplierInfo:Bu,orderItems:[],isDropdownOpen:!1,searchTerm:"",showSuggestions:!1,searchResults:[],error:null,validationErrors:{}})},getSummary:()=>{const r=e();return{items:r.orderItems.length,totalQuantity:r.orderItems.reduce((s,n)=>s+n.quantity,0),subtotal:r.orderItems.reduce((s,n)=>s+n.subtotal,0)}}})),lK=()=>{const t=ze(R=>R.orderDate),e=ze(R=>R.notes),r=ze(R=>R.supplierTab),s=ze(R=>R.selectedSupplier),n=ze(R=>R.supplierInfo),a=ze(R=>R.orderItems),i=ze(R=>R.isDropdownOpen),l=ze(R=>R.searchTerm),c=ze(R=>R.showSuggestions),d=ze(R=>R.searchResults),u=ze(R=>R.isCreating),h=ze(R=>R.error),f=ze(R=>R.validationErrors),p=ze(R=>R.setOrderDate),_=ze(R=>R.setNotes),v=ze(R=>R.setSupplierTab),x=ze(R=>R.setSelectedSupplier),m=ze(R=>R.setSupplierInfo),g=ze(R=>R.setOrderItems),y=ze(R=>R.setIsDropdownOpen),w=ze(R=>R.setSearchTerm),b=ze(R=>R.setShowSuggestions),C=ze(R=>R.setSearchResults),j=ze(R=>R.setIsCreating),I=ze(R=>R.setError),k=ze(R=>R.setValidationErrors),E=ze(R=>R.clearErrors),T=ze(R=>R.addOrderItem),D=ze(R=>R.updateOrderItemQuantity),N=ze(R=>R.updateOrderItemPrice),A=ze(R=>R.removeOrderItem),$=ze(R=>R.searchProducts),z=ze(R=>R.clearSearch),H=ze(R=>R.validateForm),L=ze(R=>R.resetForm),B=ze(R=>R.getSummary);S.useEffect(()=>{if(!t){const R=new Date,ie=R.getFullYear(),Z=String(R.getMonth()+1).padStart(2,"0"),Ie=String(R.getDate()).padStart(2,"0");p(`${ie}-${Z}-${Ie}`)}},[]);const O=B(),M=a.length>0&&H();return{orderDate:t,notes:e,supplierTab:r,selectedSupplier:s,supplierInfo:n,orderItems:a,isDropdownOpen:i,searchTerm:l,showSuggestions:c,searchResults:d,isCreating:u,error:h,validationErrors:f,summary:O,isValid:M,setOrderDate:p,setNotes:_,setSupplierTab:v,setSelectedSupplier:x,setSupplierInfo:m,setOrderItems:g,setIsDropdownOpen:y,setSearchTerm:w,setShowSuggestions:b,setSearchResults:C,setIsCreating:j,setError:I,setValidationErrors:k,clearErrors:E,addOrderItem:T,updateOrderItemQuantity:D,updateOrderItemPrice:N,removeOrderItem:A,searchProducts:$,clearSearch:z,validateForm:H,resetForm:L}},cK="_orderFormContainer_1wg52_7",dK="_orderFormMain_1wg52_13",uK="_formSection_1wg52_21",hK="_sectionTitle_1wg52_28",fK="_sectionHeader_1wg52_35",mK="_sectionActions_1wg52_42",pK="_formRow_1wg52_49",gK="_formGroup_1wg52_60",_K="_formLabel_1wg52_66",yK="_formInput_1wg52_74",vK="_supplierTabs_1wg52_102",xK="_supplierTab_1wg52_102",bK="_active_1wg52_127",wK="_supplierTabContent_1wg52_133",SK="_customDropdown_1wg52_149",jK="_dropdownHeader_1wg52_153",CK="_dropdownSelected_1wg52_169",NK="_dropdownArrow_1wg52_182",IK="_open_1wg52_188",kK="_dropdownList_1wg52_192",EK="_dropdownOption_1wg52_219",TK="_selected_1wg52_234",LK="_supplierInfo_1wg52_238",AK="_supplierName_1wg52_244",DK="_supplierDetail_1wg52_250",MK="_productSearch_1wg52_256",RK="_productSearchIcon_1wg52_261",PK="_productSearchInput_1wg52_270",OK="_searchSuggestions_1wg52_287",$K="_searchSuggestionItem_1wg52_303",FK="_searchSuggestionContent_1wg52_318",BK="_searchSuggestionName_1wg52_324",VK="_searchSuggestionDetails_1wg52_330",HK="_searchSuggestionSku_1wg52_337",zK="_searchSuggestionPrice_1wg52_341",qK="_searchNoResults_1wg52_346",UK="_productsTableContainer_1wg52_354",WK="_productsTable_1wg52_354",GK="_emptyMessage_1wg52_395",JK="_quantityInput_1wg52_403",KK="_priceInput_1wg52_404",YK="_subtotalCell_1wg52_436",QK="_btnDelete_1wg52_442",ZK="_orderSummary_1wg52_465",XK="_summaryTitle_1wg52_476",eY="_summaryItem_1wg52_483",tY="_summaryLabel_1wg52_491",rY="_summaryValue_1wg52_496",sY="_summaryDivider_1wg52_502",nY="_summaryTotal_1wg52_508",aY="_summaryTotalLabel_1wg52_514",oY="_summaryTotalValue_1wg52_520",iY="_currencyAmount_1wg52_526",lY="_formActions_1wg52_531",cY="_btnSecondary_1wg52_537",dY="_btnPrimary_1wg52_538",q={orderFormContainer:cK,orderFormMain:dK,formSection:uK,sectionTitle:hK,sectionHeader:fK,sectionActions:mK,formRow:pK,formGroup:gK,formLabel:_K,formInput:yK,supplierTabs:vK,supplierTab:xK,active:bK,supplierTabContent:wK,customDropdown:SK,dropdownHeader:jK,dropdownSelected:CK,dropdownArrow:NK,open:IK,dropdownList:kK,dropdownOption:EK,selected:TK,supplierInfo:LK,supplierName:AK,supplierDetail:DK,productSearch:MK,productSearchIcon:RK,productSearchInput:PK,searchSuggestions:OK,searchSuggestionItem:$K,searchSuggestionContent:FK,searchSuggestionName:BK,searchSuggestionDetails:VK,searchSuggestionSku:HK,searchSuggestionPrice:zK,searchNoResults:qK,productsTableContainer:UK,productsTable:WK,emptyMessage:GK,quantityInput:JK,priceInput:KK,subtotalCell:YK,btnDelete:QK,orderSummary:ZK,summaryTitle:XK,summaryItem:eY,summaryLabel:tY,summaryValue:rY,summaryDivider:sY,summaryTotal:nY,summaryTotalLabel:aY,summaryTotalValue:oY,currencyAmount:iY,formActions:lY,btnSecondary:cY,btnPrimary:dY},uY=({onCancel:t})=>{const{currentCompany:e}=ht(),{counterparties:r,loading:s,error:n}=sK((e==null?void 0:e.company_id)||null),{products:a,currencySymbol:i,error:l}=oK((e==null?void 0:e.company_id)||null),{messageState:c,closeMessage:d,showError:u}=Ps(),h=S.useRef(null),f=S.useRef(null),{orderDate:p,notes:_,supplierTab:v,selectedSupplier:x,supplierInfo:m,orderItems:g,isDropdownOpen:y,searchTerm:w,showSuggestions:b,searchResults:C,isCreating:j,validationErrors:I,summary:k,isValid:E,setOrderDate:T,setNotes:D,setSupplierTab:N,setSelectedSupplier:A,setSupplierInfo:$,setIsDropdownOpen:z,setSearchTerm:H,setShowSuggestions:L,addOrderItem:B,updateOrderItemQuantity:O,updateOrderItemPrice:M,removeOrderItem:R,searchProducts:ie,clearSearch:Z,validateForm:Ie,resetForm:Te}=lK();S.useEffect(()=>{l&&u({title:"Failed to Load Products",message:l})},[l,u]),S.useEffect(()=>{n&&u({title:"Failed to Load Suppliers",message:n})},[n,u]),S.useEffect(()=>{const J=U=>{h.current&&!h.current.contains(U.target)&&z(!1),f.current&&!f.current.contains(U.target)&&L(!1)};return(y||b)&&document.addEventListener("mousedown",J),()=>{document.removeEventListener("mousedown",J)}},[y,b,z,L]);const Ke=J=>{N(J)},ye=J=>{const U=J.target.value;H(U),ie(U,a)},P=J=>{B(J),Z()},xe=J=>Math.round(J).toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),je=(J,U)=>{const ue=parseInt(U.replace(/,/g,""))||0;O(J,ue)},ne=(J,U)=>{const ue=parseFloat(U.replace(/,/g,""))||0;M(J,ue)},Ce=async()=>{if(e){if(!Ie()){const J=Object.values(I).join(`
`);u({title:"Validation Failed",message:J});return}u({title:"Not Implemented",message:"Order creation is not yet implemented"})}},Ue=()=>{Te(),t&&t()};return o.jsxs("div",{className:q.orderFormContainer,children:[o.jsxs("div",{className:q.orderFormMain,children:[o.jsxs("div",{className:q.formSection,children:[o.jsx("h2",{className:q.sectionTitle,children:"Order Information"}),o.jsxs("div",{className:q.formRow,children:[o.jsxs("div",{className:q.formGroup,children:[o.jsx("label",{className:q.formLabel,children:"Order Date"}),o.jsx("input",{type:"date",className:q.formInput,value:p,onChange:J=>T(J.target.value)})]}),o.jsxs("div",{className:q.formGroup,children:[o.jsx("label",{className:q.formLabel,children:"Notes"}),o.jsx("textarea",{className:q.formInput,rows:1,placeholder:"Optional notes...",value:_,onChange:J=>D(J.target.value)})]})]})]}),o.jsxs("div",{className:q.formSection,children:[o.jsx("h2",{className:q.sectionTitle,children:"Supplier Details"}),o.jsxs("div",{className:q.supplierTabs,children:[o.jsx("button",{className:`${q.supplierTab} ${v==="counter-party"?q.active:""}`,onClick:()=>Ke("counter-party"),children:"Counter Party"}),o.jsx("button",{className:`${q.supplierTab} ${v==="others"?q.active:""}`,onClick:()=>Ke("others"),children:"Others"})]}),v==="counter-party"&&o.jsx("div",{className:q.supplierTabContent,children:o.jsx("div",{className:q.formRow,children:o.jsxs("div",{className:q.formGroup,style:{gridColumn:"1 / -1"},children:[o.jsx("label",{className:q.formLabel,children:"Select Supplier"}),o.jsxs("div",{className:q.customDropdown,ref:h,children:[o.jsxs("div",{className:q.dropdownHeader,onClick:()=>z(!y),children:[o.jsxs("div",{className:q.dropdownSelected,children:[o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("circle",{cx:"11",cy:"11",r:"8"}),o.jsx("path",{d:"m21 21-4.35-4.35"})]}),o.jsx("span",{children:x?x.name:"Choose a supplier..."})]}),o.jsx("svg",{className:`${q.dropdownArrow} ${y?q.open:""}`,width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("polyline",{points:"6 9 12 15 18 9"})})]}),y&&o.jsx("div",{className:q.dropdownList,children:s?o.jsx("div",{className:q.dropdownOption,children:o.jsx(Me,{size:"small"})}):r.length===0?o.jsx("div",{className:q.dropdownOption,children:o.jsx("span",{children:"No suppliers found"})}):r.map(J=>o.jsx("div",{className:`${q.dropdownOption} ${(x==null?void 0:x.counterparty_id)===J.counterparty_id?q.selected:""}`,onClick:()=>{A(J),z(!1)},children:o.jsxs("div",{className:q.supplierInfo,children:[o.jsx("div",{className:q.supplierName,children:J.name}),J.phone&&o.jsx("div",{className:q.supplierDetail,children:J.phone})]})},J.counterparty_id))})]})]})})}),v==="others"&&o.jsxs("div",{className:q.supplierTabContent,children:[o.jsxs("div",{className:q.formRow,children:[o.jsxs("div",{className:q.formGroup,children:[o.jsx("label",{className:q.formLabel,children:"Supplier Name"}),o.jsx("input",{type:"text",className:q.formInput,placeholder:"Enter supplier name",value:m.name,onChange:J=>$({name:J.target.value})})]}),o.jsxs("div",{className:q.formGroup,children:[o.jsx("label",{className:q.formLabel,children:"Contact Person"}),o.jsx("input",{type:"text",className:q.formInput,placeholder:"Enter contact name",value:m.contact,onChange:J=>$({contact:J.target.value})})]})]}),o.jsxs("div",{className:q.formRow,children:[o.jsxs("div",{className:q.formGroup,children:[o.jsx("label",{className:q.formLabel,children:"Phone"}),o.jsx("input",{type:"tel",className:q.formInput,placeholder:"Enter phone number",value:m.phone,onChange:J=>$({phone:J.target.value})})]}),o.jsxs("div",{className:q.formGroup,children:[o.jsx("label",{className:q.formLabel,children:"Email"}),o.jsx("input",{type:"email",className:q.formInput,placeholder:"Enter email address",value:m.email,onChange:J=>$({email:J.target.value})})]})]}),o.jsx("div",{className:q.formRow,children:o.jsxs("div",{className:q.formGroup,style:{gridColumn:"1 / -1"},children:[o.jsx("label",{className:q.formLabel,children:"Address"}),o.jsx("input",{type:"text",className:q.formInput,placeholder:"Enter supplier address",value:m.address,onChange:J=>$({address:J.target.value})})]})}),o.jsxs("div",{className:q.formRow,children:[o.jsxs("div",{className:q.formGroup,children:[o.jsx("label",{className:q.formLabel,children:"Bank Account"}),o.jsx("input",{type:"text",className:q.formInput,placeholder:"Enter bank account information",value:m.bank_account,onChange:J=>$({bank_account:J.target.value})})]}),o.jsxs("div",{className:q.formGroup,children:[o.jsx("label",{className:q.formLabel,children:"Memo"}),o.jsx("textarea",{className:q.formInput,rows:2,placeholder:"Enter any additional notes...",value:m.memo,onChange:J=>$({memo:J.target.value})})]})]})]})]}),o.jsxs("div",{className:q.formSection,children:[o.jsxs("div",{className:q.sectionHeader,children:[o.jsx("h2",{className:q.sectionTitle,children:"Order Items"}),o.jsxs("div",{className:q.sectionActions,children:[o.jsxs("div",{className:q.productSearch,ref:f,children:[o.jsxs("svg",{className:q.productSearchIcon,width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("circle",{cx:"11",cy:"11",r:"8"}),o.jsx("path",{d:"m21 21-4.35-4.35"})]}),o.jsx("input",{type:"text",placeholder:"Search products...",className:q.productSearchInput,value:w,onChange:ye}),b&&C.length>0&&o.jsx("div",{className:q.searchSuggestions,children:C.map(J=>{const U=J.selling_price||0,ue=J.quantity_on_hand||0;return o.jsx("div",{className:q.searchSuggestionItem,onClick:()=>P(J),children:o.jsxs("div",{className:q.searchSuggestionContent,children:[o.jsx("div",{className:q.searchSuggestionName,children:J.product_name}),o.jsxs("div",{className:q.searchSuggestionDetails,children:[o.jsxs("span",{className:q.searchSuggestionSku,children:["SKU: ",J.sku||"N/A"]}),o.jsxs("span",{children:["Stock: ",ue]}),o.jsxs("span",{className:q.searchSuggestionPrice,children:[i,xe(U)]})]})]})},J.product_id)})}),b&&w&&C.length===0&&o.jsx("div",{className:q.searchSuggestions,children:o.jsxs("div",{className:q.searchNoResults,children:['No products found matching "',w,'"']})})]}),o.jsxs("button",{className:q.btnSecondary,children:[o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),o.jsx("polyline",{points:"14 2 14 8 20 8"}),o.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),o.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"})]}),"Import Excel"]}),o.jsxs("button",{className:q.btnSecondary,children:[o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),o.jsx("polyline",{points:"7 10 12 15 17 10"}),o.jsx("line",{x1:"12",y1:"15",x2:"12",y2:"3"})]}),"Export Template & Product List"]})]})]}),o.jsx("div",{className:q.productsTableContainer,children:o.jsxs("table",{className:q.productsTable,children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:"Product Name"}),o.jsx("th",{children:"SKU"}),o.jsx("th",{children:"Unit"}),o.jsx("th",{children:"Quantity"}),o.jsx("th",{children:"Unit Price"}),o.jsx("th",{children:"Subtotal"}),o.jsx("th",{children:"Action"})]})}),o.jsx("tbody",{children:g.length===0?o.jsx("tr",{children:o.jsx("td",{colSpan:7,className:q.emptyMessage,children:"No items added yet. Search for products above to add them."})}):g.map(J=>o.jsxs("tr",{children:[o.jsx("td",{children:J.product_name}),o.jsx("td",{children:J.sku||"-"}),o.jsx("td",{children:J.unit}),o.jsx("td",{children:o.jsx("input",{type:"text",inputMode:"numeric",className:q.quantityInput,value:xe(J.quantity),onChange:U=>je(J.product_id,U.target.value)})}),o.jsx("td",{children:o.jsx("input",{type:"text",inputMode:"decimal",className:q.priceInput,value:xe(J.unit_price),onChange:U=>ne(J.product_id,U.target.value)})}),o.jsxs("td",{className:q.subtotalCell,children:[i,xe(J.subtotal)]}),o.jsx("td",{children:o.jsx("button",{className:q.btnDelete,onClick:()=>R(J.product_id),type:"button",children:o.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("path",{d:"M3 6h18M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})})})})]},J.product_id))})]})})]}),o.jsxs("div",{className:q.formActions,children:[o.jsx("button",{className:q.btnSecondary,onClick:Ue,disabled:j,children:"Cancel"}),o.jsx("button",{className:q.btnPrimary,onClick:Ce,disabled:!E||j,children:j?"Creating Order...":"Create Order"})]})]}),o.jsxs("div",{className:q.orderSummary,children:[o.jsx("h3",{className:q.summaryTitle,children:"Order Summary"}),o.jsxs("div",{className:q.summaryItem,children:[o.jsx("span",{className:q.summaryLabel,children:"Items"}),o.jsx("span",{className:q.summaryValue,children:k.items})]}),o.jsxs("div",{className:q.summaryItem,children:[o.jsx("span",{className:q.summaryLabel,children:"Total Quantity"}),o.jsx("span",{className:q.summaryValue,children:k.totalQuantity})]}),o.jsxs("div",{className:q.summaryItem,children:[o.jsx("span",{className:q.summaryLabel,children:"Subtotal"}),o.jsxs("span",{className:`${q.summaryValue} ${q.currencyAmount}`,children:[i,xe(k.subtotal)]})]}),o.jsx("div",{className:q.summaryDivider}),o.jsxs("div",{className:q.summaryTotal,children:[o.jsx("span",{className:q.summaryTotalLabel,children:"Total Amount"}),o.jsxs("span",{className:`${q.summaryTotalValue} ${q.currencyAmount}`,children:[i,xe(k.subtotal)]})]})]}),o.jsx($e,{variant:c.variant,title:c.title,message:c.message,isOpen:c.isOpen,onClose:d})]})},hY="_pageLayout_6g028_7",fY="_pageContainer_6g028_16",mY="_pageHeader_6g028_23",pY="_pageTitle_6g028_27",gY="_pageSubtitle_6g028_34",_Y="_tabsContainer_6g028_41",yY="_tabsNav_6g028_49",vY="_tabItem_6g028_55",xY="_active_6g028_75",bY="_tabIcon_6g028_81",wY="_tabBadge_6g028_85",SY="_tabContent_6g028_100",jY="_comingSoon_6g028_106",CY="_loadingSpinner_6g028_125",NY="_spinner_6g028_132",IY="_spin_6g028_132",kY="_errorState_6g028_147",EY="_errorMessage_6g028_152",TY="_retryButton_6g028_158",LY="_emptyState_6g028_176",AY="_emptyIcon_6g028_181",DY="_emptyTitle_6g028_188",MY="_emptyDescription_6g028_195",RY="_tableContainer_6g028_202",PY="_ordersTable_6g028_207",OY="_orderNumber_6g028_262",$Y="_currencyAmount_6g028_273",FY="_receivingProgress_6g028_280",BY="_progressText_6g028_286",VY="_progressBar_6g028_292",HY="_progressFill_6g028_302",zY="_progressPercentage_6g028_309",qY="_statusBadge_6g028_315",UY="_pending_6g028_324",WY="_approved_6g028_329",GY="_partial_6g028_334",JY="_received_6g028_339",KY="_cancelled_6g028_344",YY="_actionBtn_6g028_350",Je={pageLayout:hY,pageContainer:fY,pageHeader:mY,pageTitle:pY,pageSubtitle:gY,tabsContainer:_Y,tabsNav:yY,tabItem:vY,active:xY,tabIcon:bY,tabBadge:wY,tabContent:SY,comingSoon:jY,loadingSpinner:CY,spinner:NY,spin:IY,errorState:kY,errorMessage:EY,retryButton:TY,emptyState:LY,emptyIcon:AY,emptyTitle:DY,emptyDescription:MY,tableContainer:RY,ordersTable:PY,orderNumber:OY,currencyAmount:$Y,receivingProgress:FY,progressText:BY,progressBar:VY,progressFill:HY,progressPercentage:zY,statusBadge:qY,pending:UY,approved:WY,partial:GY,received:JY,cancelled:KY,actionBtn:YY},oy=t=>Math.round(t).toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),QY=()=>{const{currentCompany:t,currentStore:e}=ht(),{orders:r,activeTab:s,loading:n,error:a,setActiveTab:i,refresh:l}=eK((t==null?void 0:t.company_id)||"",(e==null?void 0:e.store_id)||null),{messageState:c,closeMessage:d,showError:u}=Ps();return S.useEffect(()=>{a&&u({title:"Failed to Load Orders",message:a,confirmText:"Retry",onConfirm:()=>{d(),l()}})},[a,u,d,l]),t?o.jsxs(o.Fragment,{children:[o.jsx(Se,{activeItem:"product"}),o.jsx("div",{className:Je.pageLayout,children:o.jsxs("div",{className:Je.pageContainer,children:[o.jsxs("div",{className:Je.pageHeader,children:[o.jsx("h1",{className:Je.pageTitle,children:"Purchase Orders"}),o.jsx("p",{className:Je.pageSubtitle,children:"Manage supplier orders and track deliveries"})]}),o.jsxs("div",{className:Je.tabsContainer,children:[o.jsxs("div",{className:Je.tabsNav,children:[o.jsxs("button",{className:`${Je.tabItem} ${s==="new-order"?Je.active:""}`,onClick:()=>i("new-order"),children:[o.jsxs("svg",{className:Je.tabIcon,width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),o.jsx("polyline",{points:"14 2 14 8 20 8"}),o.jsx("line",{x1:"12",y1:"18",x2:"12",y2:"12"}),o.jsx("line",{x1:"9",y1:"15",x2:"15",y2:"15"})]}),o.jsx("span",{children:"New Order"})]}),o.jsxs("button",{className:`${Je.tabItem} ${s==="order-list"?Je.active:""}`,onClick:()=>i("order-list"),children:[o.jsxs("svg",{className:Je.tabIcon,width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[o.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),o.jsx("line",{x1:"7",y1:"8",x2:"17",y2:"8"}),o.jsx("line",{x1:"7",y1:"12",x2:"17",y2:"12"}),o.jsx("line",{x1:"7",y1:"16",x2:"12",y2:"16"})]}),o.jsx("span",{children:"Order List"}),o.jsx("span",{className:Je.tabBadge,children:r.length})]})]}),s==="new-order"&&o.jsx("div",{className:Je.tabContent,children:o.jsx(uY,{onSuccess:()=>{l(),i("order-list")},onCancel:()=>i("order-list")})}),s==="order-list"&&o.jsx("div",{className:Je.tabContent,children:n?o.jsx(Me,{size:"large",fullscreen:!0}):r.length===0?o.jsxs("div",{className:Je.emptyState,children:[o.jsxs("svg",{className:Je.emptyIcon,width:"120",height:"120",viewBox:"0 0 120 120",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[o.jsx("circle",{cx:"60",cy:"60",r:"50",fill:"#F0F6FF"}),o.jsx("rect",{x:"35",y:"40",width:"50",height:"60",rx:"4",fill:"white",stroke:"#0064FF",strokeWidth:"2"}),o.jsx("rect",{x:"40",y:"35",width:"50",height:"60",rx:"4",fill:"white",stroke:"#0064FF",strokeWidth:"2"}),o.jsx("line",{x1:"48",y1:"45",x2:"75",y2:"45",stroke:"#E9ECEF",strokeWidth:"2",strokeLinecap:"round"}),o.jsx("line",{x1:"48",y1:"52",x2:"70",y2:"52",stroke:"#E9ECEF",strokeWidth:"2",strokeLinecap:"round"}),o.jsx("line",{x1:"48",y1:"59",x2:"72",y2:"59",stroke:"#E9ECEF",strokeWidth:"2",strokeLinecap:"round"}),o.jsx("circle",{cx:"60",cy:"75",r:"12",fill:"#0064FF"}),o.jsx("path",{d:"M56 75 L58 77 L64 71",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),o.jsx("h3",{className:Je.emptyTitle,children:"No Purchase Orders"}),o.jsx("p",{className:Je.emptyDescription,children:"You don't have any purchase orders yet"})]}):o.jsx("div",{className:Je.tableContainer,children:o.jsxs("table",{className:Je.ordersTable,children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{children:o.jsx("input",{type:"checkbox"})}),o.jsx("th",{children:"Order Number"}),o.jsx("th",{children:"Date"}),o.jsx("th",{children:"Supplier"}),o.jsx("th",{children:"Items"}),o.jsx("th",{children:"Total Amount"}),o.jsx("th",{children:"Receiving Status"}),o.jsx("th",{children:"Status"}),o.jsx("th",{children:"Action"})]})}),o.jsx("tbody",{children:r.map(h=>{const f=h.receivingProgress;return o.jsxs("tr",{children:[o.jsx("td",{children:o.jsx("input",{type:"checkbox","data-order-id":h.orderId})}),o.jsx("td",{children:o.jsx("span",{className:Je.orderNumber,children:h.orderNumber})}),o.jsx("td",{children:h.formattedDate}),o.jsx("td",{children:h.supplierName}),o.jsxs("td",{children:[h.itemCount," item",h.itemCount!==1?"s":""]}),o.jsx("td",{className:Je.currencyAmount,children:h.formatCurrency(h.totalAmount)}),o.jsx("td",{children:h.status!=="cancelled"?o.jsxs("div",{className:Je.receivingProgress,children:[o.jsxs("span",{className:Je.progressText,children:[oy(f.received),"/",oy(f.total)]}),f.total>0&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:Je.progressBar,children:o.jsx("div",{className:Je.progressFill,style:{width:`${f.percentage}%`}})}),o.jsxs("small",{className:Je.progressPercentage,children:["(",f.percentage,"%)"]})]})]}):"-"}),o.jsx("td",{children:o.jsx("span",{className:`${Je.statusBadge} ${Je[h.status]}`,children:h.statusDisplay})}),o.jsx("td",{children:o.jsx("button",{className:Je.actionBtn,"data-order-id":h.orderId,children:"View"})})]},h.orderId)})})]})})})]})]})}),o.jsx($e,{variant:c.variant,title:c.title,message:c.message,isOpen:c.isOpen,onClose:d,confirmText:c.confirmText,onConfirm:c.onConfirm})]}):o.jsxs(o.Fragment,{children:[o.jsx(Se,{activeItem:"product"}),o.jsx("div",{className:Je.pageLayout,children:o.jsx("div",{className:Je.pageContainer,children:o.jsx("div",{className:Je.emptyState,children:o.jsx("p",{children:"Please select a company to view orders"})})})})]})};class ZY{async getCurrentUserId(){var e;try{const{data:{session:r},error:s}=await se.getClient().auth.getSession();return s||!((e=r==null?void 0:r.user)!=null&&e.id)?(console.error("getCurrentUserId error:",s),null):r.user.id}catch(r){return console.error("getCurrentUserId error:",r),null}}async getOrders(e){var r;try{const{data:s,error:n}=await se.getClient().rpc("get_inventory_order_list",{p_company_id:e});if(n)throw console.error("getOrders RPC error:",n),n;return console.log(" RPC Response:",s),(r=s==null?void 0:s.orders)!=null&&r[0]&&(console.log(" First Order:",s.orders[0]),console.log(" First Order Progress Fields:",{total_items:s.orders[0].total_items,received_items:s.orders[0].received_items,remaining_items:s.orders[0].remaining_items})),s}catch(s){throw console.error("getOrders error:",s),s}}async submitReceive(e,r,s,n,a,i){try{const{data:l,error:c}=await se.getClient().rpc("inventory_order_receive",{p_company_id:e,p_store_id:r,p_order_id:s,p_user_id:n,p_items:a,p_notes:i||null});if(c)throw console.error("submitReceive RPC error:",c),c;return l}catch(l){throw console.error("submitReceive error:",l),l}}}class XY{constructor(e){W(this,"orderId");W(this,"orderNumber");W(this,"supplierName");W(this,"status");W(this,"orderDate");W(this,"totalItems");W(this,"receivedItems");W(this,"remainingItems");W(this,"items");this.orderId=e.orderId,this.orderNumber=e.orderNumber,this.supplierName=e.supplierName,this.status=e.status,this.orderDate=e.orderDate,this.totalItems=e.totalItems,this.receivedItems=e.receivedItems,this.remainingItems=e.remainingItems,this.items=e.items}get progressPercentage(){return this.totalItems===0?0:Math.round(this.receivedItems/this.totalItems*100)}get isReceivable(){return this.status==="pending"||this.status==="partial"}get displayName(){return`${this.orderNumber} - ${this.supplierName}`}}class eQ{constructor(e){W(this,"productId");W(this,"sku");W(this,"productName");W(this,"quantityOrdered");W(this,"quantityReceived");W(this,"quantityRemaining");W(this,"unit");this.productId=e.productId,this.sku=e.sku,this.productName=e.productName,this.quantityOrdered=e.quantityOrdered,this.quantityReceived=e.quantityReceived,this.quantityRemaining=e.quantityRemaining,this.unit=e.unit}get isFullyReceived(){return this.quantityReceived>=this.quantityOrdered}get progressPercentage(){return this.quantityOrdered===0?0:Math.round(this.quantityReceived/this.quantityOrdered*100)}canReceiveMore(e){return this.quantityReceived+e<=this.quantityOrdered}getDisplayName(){return`${this.productName} (${this.sku})`}}class Mm{static fromDTO(e){return new eQ({productId:e.product_id,sku:e.sku,productName:e.product_name,quantityOrdered:e.quantity_ordered||0,quantityReceived:e.quantity_received_total||0,quantityRemaining:(e.quantity_ordered||0)-(e.quantity_received_total||0),unit:""})}static toDTO(e){return{product_id:e.productId,sku:e.sku,product_name:e.productName,quantity_ordered:e.quantityOrdered,quantity_received_total:e.quantityReceived}}static fromDTOArray(e){return e.map(r=>Mm.fromDTO(r))}}class fd{static fromDTO(e){var s,n,a,i;const r=e.items?Mm.fromDTOArray(e.items):void 0;return new XY({orderId:e.order_id,orderNumber:e.order_number,supplierName:e.supplier_name,status:e.status,orderDate:re.toLocal(e.order_date),totalItems:((s=e.summary)==null?void 0:s.total_ordered)||0,receivedItems:((n=e.summary)==null?void 0:n.total_received)||0,remainingItems:(((a=e.summary)==null?void 0:a.total_ordered)||0)-(((i=e.summary)==null?void 0:i.total_received)||0),items:r})}static toDTO(e){var r;return{order_id:e.orderId,order_number:e.orderNumber,supplier_name:e.supplierName,status:e.status,order_date:re.toUtc(e.orderDate),summary:{total_products:((r=e.items)==null?void 0:r.length)||0,total_ordered:e.totalItems,total_received:e.receivedItems,completion_rate:e.progressPercentage||0}}}static fromDTOArray(e){return e.map(r=>fd.fromDTO(r))}static filterReceivableOrders(e){return e.filter(r=>r.isReceivable)}}class tQ{constructor(e){W(this,"success");W(this,"receiptNumber");W(this,"message");W(this,"receivedCount");W(this,"warnings");W(this,"error");this.success=e.success,this.receiptNumber=e.receiptNumber,this.message=e.message,this.receivedCount=e.receivedCount,this.warnings=e.warnings,this.error=e.error}get hasWarnings(){return!!this.warnings&&this.warnings.length>0}get displayMessage(){return this.success?this.message||"Products received successfully":this.error||"Failed to receive products"}}class rQ{static fromDTO(e){return new tQ({success:e.success,receiptNumber:e.receipt_number,message:e.message,receivedCount:e.received_count,warnings:e.warnings,error:e.success?void 0:e.message})}static toDTO(e){return{success:e.success,receipt_number:e.receiptNumber,message:e.message,received_count:e.receivedCount,warnings:e.warnings}}}class Ux{constructor(){W(this,"dataSource");this.dataSource=new ZY}async getOrders(e){try{const r=await this.dataSource.getOrders(e);if(!r||!r.orders)return{success:!0,data:[]};const s=fd.fromDTOArray(r.orders);return{success:!0,data:fd.filterReceivableOrders(s)}}catch(r){return{success:!1,error:r instanceof Error?r.message:"Failed to get orders"}}}async getOrderProducts(e,r){return{success:!0,data:[]}}async searchProducts(e,r){return{success:!0,data:[]}}async getCurrentUserId(){try{const e=await this.dataSource.getCurrentUserId();return e?{success:!0,data:e}:{success:!1,error:"User session not found. Please login again."}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Failed to get user ID"}}}async submitReceive(e,r,s,n,a,i){try{const l=a.map(u=>({product_id:u.productId,quantity_received:u.quantityReceived})),c=await this.dataSource.submitReceive(e,r,s,n,l,i);return{success:!0,data:rQ.fromDTO(c)}}catch(l){return{success:!1,error:l instanceof Error?l.message:"Failed to submit receive"}}}}const sQ=Object.freeze(Object.defineProperty({__proto__:null,ProductReceiveRepositoryImpl:Ux},Symbol.toStringTag,{value:"Module"}));class nQ{static validateScannedItem(e,r){const s=[];return e.count<=0&&s.push({field:"quantity",message:"Quantity must be greater than 0"}),e.count>r.quantityRemaining&&s.push({field:"quantity",message:`Cannot receive ${e.count} items. Only ${r.quantityRemaining} items remaining in order`}),e.sku!==r.sku&&s.push({field:"sku",message:"SKU mismatch"}),s}static validateSubmission(e,r,s){const n=[];if(!r)return n.push({field:"order",message:"No order selected. Please select an order first"}),n;if(r.isReceivable||n.push({field:"order",message:`Order status "${r.status}" is not receivable. Only pending or partial orders can receive products`}),e.length===0)return n.push({field:"items",message:"No items scanned. Please scan at least one product"}),n;for(const a of e){const i=s.find(c=>c.sku===a.sku);if(!i){n.push({field:`item_${a.sku}`,message:`Product ${a.sku} is not in this order`});continue}const l=this.validateScannedItem(a,i);n.push(...l)}return n}static validateSKUInput(e){const r=e.trim();return r?r.length<2?{field:"sku",message:"SKU must be at least 2 characters"}:/^[a-zA-Z0-9-_]+$/.test(r)?null:{field:"sku",message:"SKU contains invalid characters. Only letters, numbers, hyphens, and underscores are allowed"}:{field:"sku",message:"SKU cannot be empty"}}static validateQuantity(e,r){return e<=0?{field:"quantity",message:"Quantity must be greater than 0"}:Number.isInteger(e)?e>r?{field:"quantity",message:`Quantity cannot exceed ${r}`}:null:{field:"quantity",message:"Quantity must be a whole number"}}static isProductInOrder(e,r){return r.some(s=>s.sku===e)}static getRemainingQuantity(e,r){const s=r.find(n=>n.sku===e);return s?s.quantityRemaining:0}static isOrderFullyReceived(e){return e.every(r=>r.isFullyReceived)}static calculateTotalQuantity(e){return e.reduce((r,s)=>r+s.count,0)}static hasDuplicateSKUs(e){const r=e.map(n=>n.sku),s=new Set(r);return r.length!==s.size}}class aQ{constructor(e,r,s,n=1){W(this,"sku");W(this,"productId");W(this,"productName");W(this,"count");W(this,"scannedAt");W(this,"lastScannedAt");this.sku=e,this.productId=r,this.productName=s,this.count=n,this.scannedAt=new Date,this.lastScannedAt=new Date}incrementCount(){this.count++,this.lastScannedAt=new Date}decrementCount(){this.count>0&&(this.count--,this.lastScannedAt=new Date)}setCount(e){e>=0&&(this.count=e,this.lastScannedAt=new Date)}get displayName(){return`${this.productName} (${this.sku})`}get formattedTime(){const r=new Date().getTime()-this.lastScannedAt.getTime(),s=Math.floor(r/1e3);if(s<60)return"Just now";const n=Math.floor(s/60);return n<60?`${n}m ago`:`${Math.floor(n/60)}h ago`}}const iy=new Ux,Ft=er((t,e)=>({orders:[],selectedOrder:null,orderProducts:[],loadingOrders:!1,scannedItems:new Map,skuInput:"",autocompleteResults:[],showAutocomplete:!1,productSearchTerm:"",filteredProducts:[],submitting:!1,error:null,setSkuInput:r=>t({skuInput:r}),setShowAutocomplete:r=>t({showAutocomplete:r}),setProductSearchTerm:r=>{t({productSearchTerm:r});const s=e();if(!r.trim()){t({filteredProducts:s.orderProducts});return}const n=r.toLowerCase(),a=s.orderProducts.filter(i=>i.sku.toLowerCase().includes(n)||i.productName.toLowerCase().includes(n));t({filteredProducts:a})},setError:r=>t({error:r}),clearError:()=>t({error:null}),loadOrders:async r=>{if(!r){t({orders:[],selectedOrder:null,orderProducts:[]});return}t({loadingOrders:!0,error:null});try{const s=await iy.getOrders(r);if(!s.success){t({error:s.error||"Failed to load orders",orders:[],selectedOrder:null,orderProducts:[],loadingOrders:!1});return}const n=s.data||[];t({orders:n});const a=e();if(n.length>0){if(a.selectedOrder){const i=n.find(l=>{var c;return l.orderId===((c=a.selectedOrder)==null?void 0:c.orderId)});t(i?{selectedOrder:i,orderProducts:i.items||[],filteredProducts:i.items||[]}:{selectedOrder:n[0],orderProducts:n[0].items||[],filteredProducts:n[0].items||[]})}else t({selectedOrder:n[0],orderProducts:n[0].items||[],filteredProducts:n[0].items||[]});t({scannedItems:new Map,skuInput:"",productSearchTerm:""})}}catch(s){t({error:s instanceof Error?s.message:"An unexpected error occurred",orders:[],selectedOrder:null,orderProducts:[]})}finally{t({loadingOrders:!1})}},selectOrder:r=>{t({selectedOrder:r,orderProducts:r.items||[],filteredProducts:r.items||[],scannedItems:new Map,skuInput:"",productSearchTerm:"",error:null})},handleSkuInput:r=>{t({skuInput:r});const s=r.trim().toLowerCase();if(!s||s.length<1){t({showAutocomplete:!1,autocompleteResults:[]});return}let a=e().orderProducts.filter(i=>i.sku.toLowerCase().includes(s)||i.productName.toLowerCase().includes(s));a.sort((i,l)=>{const c=i.sku.toLowerCase().startsWith(s),d=l.sku.toLowerCase().startsWith(s);return c&&!d?-1:!c&&d?1:i.sku.localeCompare(l.sku)}),a=a.slice(0,10),t({autocompleteResults:a,showAutocomplete:a.length>0})},addScannedItem:r=>{const s=e(),n=new Map(s.scannedItems),a=n.get(r.sku);a?a.incrementCount():n.set(r.sku,new aQ(r.sku,r.productId,r.productName,1)),t({scannedItems:n,skuInput:"",showAutocomplete:!1,error:null})},updateScannedQuantity:(r,s)=>{const n=e(),a=new Map(n.scannedItems),i=a.get(r);i&&s>0?i.setCount(s):i&&s===0&&a.delete(r),t({scannedItems:a})},removeScannedItem:r=>{const s=e(),n=new Map(s.scannedItems);n.delete(r),t({scannedItems:n})},clearAllScanned:()=>{t({scannedItems:new Map,skuInput:"",error:null})},submitReceive:async(r,s,n)=>{const a=e(),i=Array.from(a.scannedItems.values()),l=nQ.validateSubmission(i,a.selectedOrder,a.orderProducts);if(l.length>0){const c=l[0].message;return t({error:c}),{success:!1,error:c}}if(!r||!s){const c="Company or Store is not selected";return t({error:c}),{success:!1,error:c}}if(!a.selectedOrder){const c="No order selected";return t({error:c}),{success:!1,error:c}}t({submitting:!0,error:null});try{const c=Array.from(a.scannedItems.values()).map(u=>({productId:u.productId,quantityReceived:u.count})),d=await iy.submitReceive(r,s,a.selectedOrder.orderId,n,c,null);if(!d.success){const u=d.error||"Failed to submit receive";return t({error:u,submitting:!1}),{success:!1,error:u}}return e().clearAllScanned(),await e().loadOrders(r),{success:!0,data:d.data}}catch(c){const d=c instanceof Error?c.message:"An unexpected error occurred";return t({error:d,submitting:!1}),{success:!1,error:d}}finally{t({submitting:!1})}}})),oQ=(t,e)=>{const r=Ft(T=>T.orders),s=Ft(T=>T.selectedOrder),n=Ft(T=>T.orderProducts),a=Ft(T=>T.loadingOrders),i=Ft(T=>T.scannedItems),l=Ft(T=>T.skuInput),c=Ft(T=>T.autocompleteResults),d=Ft(T=>T.showAutocomplete),u=Ft(T=>T.productSearchTerm),h=Ft(T=>T.filteredProducts),f=Ft(T=>T.submitting),p=Ft(T=>T.error),_=Ft(T=>T.selectOrder),v=Ft(T=>T.loadOrders),x=Ft(T=>T.handleSkuInput),m=Ft(T=>T.setShowAutocomplete),g=Ft(T=>T.setProductSearchTerm),y=Ft(T=>T.addScannedItem),w=Ft(T=>T.updateScannedQuantity),b=Ft(T=>T.removeScannedItem),C=Ft(T=>T.clearAllScanned),j=Ft(T=>T.submitReceive);S.useEffect(()=>{v(t)},[t,v]);const I=S.useCallback(async()=>{if(!t||!e)return{success:!1,error:"Company or Store is not selected"};const{ProductReceiveRepositoryImpl:T}=await dm(async()=>{const{ProductReceiveRepositoryImpl:$}=await Promise.resolve().then(()=>sQ);return{ProductReceiveRepositoryImpl:$}},void 0),N=await new T().getCurrentUserId();if(!N.success||!N.data)return{success:!1,error:N.error||"Failed to get user ID"};const A=N.data;return await j(t,e,A)},[t,e,j]),k=Array.from(i.values()).reduce((T,D)=>T+D.count,0),E=Array.from(i.values());return{orders:r,selectedOrder:s,selectOrder:_,loadingOrders:a,orderProducts:n,filteredProducts:h,productSearchTerm:u,setProductSearchTerm:g,scannedItems:E,totalScannedCount:k,skuInput:l,handleSkuInput:x,autocompleteResults:c,showAutocomplete:d,setShowAutocomplete:m,addScannedItem:y,updateScannedQuantity:w,removeScannedItem:b,clearAllScanned:C,submitReceive:I,submitting:f,error:p}},iQ="_selector_1pwab_1",lQ="_button_1pwab_7",cQ="_open_1pwab_27",dQ="_icon_1pwab_33",uQ="_label_1pwab_40",hQ="_dropdown_1pwab_50",fQ="_dropdownMenu_1pwab_58",mQ="_option_1pwab_72",pQ="_selected_1pwab_85",gQ="_optionContent_1pwab_89",_Q="_optionText_1pwab_96",yQ="_optionMeta_1pwab_102",vQ="_checkmark_1pwab_107",Kt={selector:iQ,button:lQ,open:cQ,icon:dQ,label:uQ,dropdown:hQ,dropdownMenu:fQ,option:mQ,selected:pQ,optionContent:gQ,optionText:_Q,optionMeta:yQ,checkmark:vQ},xQ=({orders:t,selectedOrder:e,onSelectOrder:r,loading:s=!1})=>{const[n,a]=S.useState(!1),i=S.useRef(null);S.useEffect(()=>{const u=h=>{i.current&&!i.current.contains(h.target)&&a(!1)};return document.addEventListener("click",u),()=>document.removeEventListener("click",u)},[]);const l=u=>{r(u),a(!1)};if(s)return o.jsx("div",{className:Kt.selector,children:o.jsxs("div",{className:Kt.button,children:[o.jsx(Me,{size:"small"}),o.jsx("span",{className:Kt.label,style:{marginLeft:"8px"},children:"Loading..."})]})});if(t.length===0)return o.jsx("div",{className:Kt.selector,children:o.jsx("div",{className:Kt.button,children:o.jsx("span",{className:Kt.label,children:"No receivable orders"})})});const c=n?`${Kt.button} ${Kt.open}`:Kt.button,d=u=>{const h=Kt.option;return(e==null?void 0:e.orderId)===u?`${h} ${Kt.selected}`:h};return o.jsxs("div",{className:Kt.selector,ref:i,children:[o.jsxs("div",{className:c,onClick:()=>a(!n),children:[o.jsx("svg",{className:Kt.icon,fill:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{d:"M19,3H5A2,2 0 0,0 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5A2,2 0 0,0 19,3M19,19H5V5H19V19M17,17H7V15H17V17M17,13H7V11H17V13M17,9H7V7H17V9Z"})}),o.jsx("span",{className:Kt.label,children:e?e.displayName:"Select Order..."}),o.jsx("svg",{className:Kt.dropdown,fill:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{d:"M7,10L12,15L17,10H7Z"})})]}),n&&o.jsx("div",{className:Kt.dropdownMenu,children:t.map(u=>o.jsxs("div",{className:d(u.orderId),onClick:()=>l(u),children:[o.jsxs("div",{className:Kt.optionContent,children:[o.jsx("span",{className:Kt.optionText,children:u.displayName}),o.jsxs("span",{className:Kt.optionMeta,children:[u.receivedItems,"/",u.totalItems," received"]})]}),(e==null?void 0:e.orderId)===u.orderId&&o.jsx("svg",{className:Kt.checkmark,fill:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{d:"M9,20.42L2.79,14.21L5.62,11.38L9,14.77L18.88,4.88L21.71,7.71L9,20.42Z"})})]},u.orderId))})]})},bQ="_pageLayout_4s1x1_2",wQ="_container_4s1x1_11",SQ="_header_4s1x1_17",jQ="_title_4s1x1_21",CQ="_subtitle_4s1x1_28",NQ="_controls_4s1x1_34",IQ="_emptyState_4s1x1_58",kQ="_placeholder_4s1x1_59",EQ="_placeholderIcon_4s1x1_67",TQ="_content_4s1x1_79",LQ="_rightColumn_4s1x1_85",AQ="_scannerCard_4s1x1_91",DQ="_scannedCard_4s1x1_92",MQ="_sectionTitle_4s1x1_99",RQ="_skuInputWrapper_4s1x1_106",PQ="_skuInput_4s1x1_106",OQ="_autocomplete_4s1x1_125",$Q="_autocompleteItem_4s1x1_139",FQ="_productName_4s1x1_155",BQ="_productSku_4s1x1_162",VQ="_productStock_4s1x1_168",HQ="_scannedHeader_4s1x1_173",zQ="_badge_4s1x1_180",qQ="_emptyScanned_4s1x1_189",UQ="_scannedList_4s1x1_197",WQ="_scannedItem_4s1x1_203",GQ="_itemInfo_4s1x1_213",JQ="_itemName_4s1x1_217",KQ="_itemSku_4s1x1_224",YQ="_itemActions_4s1x1_230",QQ="_quantityControls_4s1x1_236",ZQ="_qtyBtn_4s1x1_245",XQ="_qty_4s1x1_245",eZ="_removeBtn_4s1x1_271",tZ="_actions_4s1x1_292",rZ="_btnSecondary_4s1x1_299",sZ="_btnPrimary_4s1x1_300",nZ="_orderDetailsCard_4s1x1_338",aZ="_orderSummary_4s1x1_345",oZ="_orderTitle_4s1x1_349",iZ="_progressContainer_4s1x1_356",lZ="_progressRing_4s1x1_362",cZ="_progressRingCircle_4s1x1_373",dZ="_progressRingProgress_4s1x1_379",uZ="_progressRingText_4s1x1_387",hZ="_progressStats_4s1x1_397",fZ="_progressStat_4s1x1_397",mZ="_progressStatLabel_4s1x1_410",pZ="_progressStatValue_4s1x1_415",gZ="_productListSection_4s1x1_421",_Z="_productListTitle_4s1x1_425",yZ="_productSearch_4s1x1_432",vZ="_productList_4s1x1_421",xZ="_productItem_4s1x1_451",bZ="_productItemHeader_4s1x1_465",wZ="_productItemName_4s1x1_472",SZ="_productItemProgress_4s1x1_478",jZ="_productItemSku_4s1x1_483",ae={pageLayout:bQ,container:wQ,header:SQ,title:jQ,subtitle:CQ,controls:NQ,emptyState:IQ,placeholder:kQ,placeholderIcon:EQ,content:TQ,rightColumn:LQ,scannerCard:AQ,scannedCard:DQ,sectionTitle:MQ,skuInputWrapper:RQ,skuInput:PQ,autocomplete:OQ,autocompleteItem:$Q,productName:FQ,productSku:BQ,productStock:VQ,scannedHeader:HQ,badge:zQ,emptyScanned:qQ,scannedList:UQ,scannedItem:WQ,itemInfo:GQ,itemName:JQ,itemSku:KQ,itemActions:YQ,quantityControls:QQ,qtyBtn:ZQ,qty:XQ,removeBtn:eZ,actions:tZ,btnSecondary:rZ,btnPrimary:sZ,orderDetailsCard:nZ,orderSummary:aZ,orderTitle:oZ,progressContainer:iZ,progressRing:lZ,progressRingCircle:cZ,progressRingProgress:dZ,progressRingText:uZ,progressStats:hZ,progressStat:fZ,progressStatLabel:mZ,progressStatValue:pZ,productListSection:gZ,productListTitle:_Z,productSearch:yZ,productList:vZ,productItem:xZ,productItemHeader:bZ,productItemName:wZ,productItemProgress:SZ,productItemSku:jZ},CZ=()=>{var B;const{currentCompany:t,currentStore:e,setCurrentStore:r}=ht(),{messageState:s,closeMessage:n,showError:a,showSuccess:i}=Ps(),{orders:l,selectedOrder:c,selectOrder:d,loadingOrders:u,filteredProducts:h,productSearchTerm:f,setProductSearchTerm:p,scannedItems:_,skuInput:v,handleSkuInput:x,autocompleteResults:m,showAutocomplete:g,setShowAutocomplete:y,addScannedItem:w,updateScannedQuantity:b,removeScannedItem:C,clearAllScanned:j,submitReceive:I,submitting:k,error:E}=oQ((t==null?void 0:t.company_id)||"",(e==null?void 0:e.store_id)||null),T=async()=>{(await I()).success&&i({message:"Products received successfully!",autoCloseDuration:2e3})};S.useEffect(()=>{E&&a({message:E})},[E,a]);const D=(c==null?void 0:c.totalItems)||0,N=(c==null?void 0:c.receivedItems)||0,A=(c==null?void 0:c.remainingItems)||0,$=D>0?Math.round(N/D*100):0;console.log(" Progress Debug:",{selectedOrder:c,totalItems:D,receivedItems:N,remainingItems:A,progressPercentage:$,orderItems:((B=c==null?void 0:c.items)==null?void 0:B.length)||0});const z=28,H=2*Math.PI*z,L=H-$/100*H;return t?o.jsxs(o.Fragment,{children:[o.jsx(Se,{activeItem:"product"}),o.jsx("div",{className:ae.pageLayout,children:o.jsxs("div",{className:ae.container,children:[o.jsxs("div",{className:ae.header,children:[o.jsx("h1",{className:ae.title,children:"Product Receive"}),o.jsx("p",{className:ae.subtitle,children:"Scan and receive products from purchase orders"})]}),o.jsxs("div",{className:ae.controls,children:[o.jsx(ds,{stores:t.stores||[],selectedStoreId:(e==null?void 0:e.store_id)||null,onStoreSelect:O=>{var M;if(O){const R=(M=t.stores)==null?void 0:M.find(ie=>ie.store_id===O);r(R||null)}else r(null)},showAllStoresOption:!1}),o.jsx(xQ,{orders:l,selectedOrder:c,onSelectOrder:d,loading:u})]}),u?o.jsx(Me,{size:"large",fullscreen:!0}):c?o.jsxs("div",{className:ae.content,children:[o.jsxs("div",{className:ae.orderDetailsCard,children:[o.jsxs("div",{className:ae.orderSummary,children:[o.jsx("h2",{className:ae.orderTitle,children:"Order Progress"}),o.jsxs("div",{className:ae.progressContainer,children:[o.jsxs("div",{className:ae.progressRing,children:[o.jsxs("svg",{width:"60",height:"60",children:[o.jsx("circle",{className:ae.progressRingCircle,cx:"30",cy:"30",r:z}),o.jsx("circle",{className:ae.progressRingProgress,cx:"30",cy:"30",r:z,strokeDasharray:H,strokeDashoffset:L})]}),o.jsxs("div",{className:ae.progressRingText,children:[$,"%"]})]}),o.jsxs("div",{className:ae.progressStats,children:[o.jsxs("div",{className:ae.progressStat,children:[o.jsx("span",{className:ae.progressStatLabel,children:"Received"}),o.jsx("span",{className:ae.progressStatValue,children:N})]}),o.jsxs("div",{className:ae.progressStat,children:[o.jsx("span",{className:ae.progressStatLabel,children:"Remaining"}),o.jsx("span",{className:ae.progressStatValue,children:A})]}),o.jsxs("div",{className:ae.progressStat,children:[o.jsx("span",{className:ae.progressStatLabel,children:"Total"}),o.jsx("span",{className:ae.progressStatValue,children:D})]})]})]})]}),o.jsxs("div",{className:ae.productListSection,children:[o.jsx("h3",{className:ae.productListTitle,children:"Products in Order"}),o.jsx("input",{type:"text",placeholder:"Search products...",value:f,onChange:O=>p(O.target.value),className:ae.productSearch}),o.jsx("div",{className:ae.productList,children:h.map(O=>{const M=O.quantityOrdered>0?Math.round(O.quantityReceived/O.quantityOrdered*100):0;return o.jsxs("div",{className:ae.productItem,children:[o.jsxs("div",{className:ae.productItemHeader,children:[o.jsx("span",{className:ae.productItemName,children:O.productName}),o.jsxs("span",{className:ae.productItemProgress,style:{color:M===100?"var(--toss-green-500)":"var(--text-secondary)"},children:[O.quantityReceived,"/",O.quantityOrdered]})]}),o.jsx("div",{className:ae.productItemSku,children:O.sku})]},O.productId)})})]})]}),o.jsxs("div",{className:ae.rightColumn,children:[o.jsxs("div",{className:ae.scannerCard,children:[o.jsx("h2",{className:ae.sectionTitle,children:"Scan Product"}),o.jsxs("div",{className:ae.skuInputWrapper,children:[o.jsx("input",{type:"text",value:v,onChange:O=>x(O.target.value),onFocus:()=>v&&y(!0),placeholder:"Scan or type SKU / Product name",className:ae.skuInput,autoFocus:!0}),g&&m.length>0&&o.jsx("div",{className:ae.autocomplete,children:m.map(O=>o.jsxs("div",{className:ae.autocompleteItem,onClick:()=>{w(O),y(!1)},children:[o.jsxs("div",{children:[o.jsx("div",{className:ae.productName,children:O.productName}),o.jsx("div",{className:ae.productSku,children:O.sku})]}),o.jsxs("div",{className:ae.productStock,children:["Remaining: ",O.quantityRemaining]})]},O.productId))})]})]}),o.jsxs("div",{className:ae.scannedCard,children:[o.jsxs("div",{className:ae.scannedHeader,children:[o.jsx("h2",{className:ae.sectionTitle,children:"Scanned Items"}),o.jsxs("span",{className:ae.badge,children:[_.length," items"]})]}),_.length===0?o.jsx("div",{className:ae.emptyScanned,children:"No items scanned yet"}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:ae.scannedList,children:_.map(O=>o.jsxs("div",{className:ae.scannedItem,children:[o.jsxs("div",{className:ae.itemInfo,children:[o.jsx("div",{className:ae.itemName,children:O.productName}),o.jsx("div",{className:ae.itemSku,children:O.sku})]}),o.jsxs("div",{className:ae.itemActions,children:[o.jsxs("div",{className:ae.quantityControls,children:[o.jsx("button",{onClick:()=>b(O.sku,O.count-1),className:ae.qtyBtn,children:"-"}),o.jsx("span",{className:ae.qty,children:O.count}),o.jsx("button",{onClick:()=>b(O.sku,O.count+1),className:ae.qtyBtn,children:"+"})]}),o.jsx("button",{onClick:()=>C(O.sku),className:ae.removeBtn,children:""})]})]},O.sku))}),o.jsxs("div",{className:ae.actions,children:[o.jsx("button",{onClick:j,className:ae.btnSecondary,disabled:k,children:"Clear All"}),o.jsx("button",{onClick:T,className:ae.btnPrimary,disabled:k||_.length===0,children:k?o.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[o.jsx(Me,{size:"small"}),o.jsx("span",{children:"Submitting..."})]}):"Submit Receive"})]})]})]})]})]}):o.jsxs("div",{className:ae.placeholder,children:[o.jsx("div",{className:ae.placeholderIcon,children:o.jsx("svg",{fill:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{d:"M19,3H5A2,2 0 0,0 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5A2,2 0 0,0 19,3M19,19H5V5H19V19Z"})})}),o.jsx("h3",{children:"Select a Purchase Order"}),o.jsx("p",{children:"Choose an order above to begin receiving products"})]})]})}),o.jsx($e,{variant:s.variant,message:s.message,title:s.title,isOpen:s.isOpen,onClose:n,confirmText:s.confirmText,onConfirm:s.onConfirm,autoCloseDuration:s.autoCloseDuration})]}):o.jsxs(o.Fragment,{children:[o.jsx(Se,{activeItem:"product"}),o.jsx("div",{className:ae.pageLayout,children:o.jsx("div",{className:ae.container,children:o.jsx("div",{className:ae.emptyState,children:o.jsx("p",{children:"Please select a company to receive products"})})})})]})};class NZ{async getStores(e){const{data:r,error:s}=await se.getClient().from("stores").select("store_id, store_name, store_address, store_phone, huddle_time, payment_time, allowed_distance").eq("company_id",e).eq("is_deleted",!1).order("created_at",{ascending:!1});if(s)throw new Error(`Failed to fetch stores: ${s.message}`);return r||[]}async createStore(e,r,s,n){const a={company_id:e,store_name:r,store_address:s||null,store_phone:n||null,created_at:re.nowUtc(),updated_at:re.nowUtc(),is_deleted:!1},{data:i,error:l}=await se.getClient().from("stores").insert(a).select();if(l)throw new Error(`Failed to create store: ${l.message}`);return i}async deleteStore(e){const{error:r}=await se.getClient().from("stores").update({is_deleted:!0,updated_at:re.nowUtc()}).eq("store_id",e);if(r)throw new Error(`Failed to delete store: ${r.message}`)}}class IZ{constructor(e,r,s,n,a,i,l=null,c=null,d=null){this.storeId=e,this.companyId=r,this.storeName=s,this.address=n,this.phone=a,this.isActive=i,this.huddleTime=l,this.paymentTime=c,this.allowedDistance=d}get displayName(){return this.storeName}}class kZ{static fromJson(e){return new IZ(e.store_id,e.company_id,e.store_name,e.store_address,e.store_phone,!e.is_deleted,e.huddle_time,e.payment_time,e.allowed_distance)}static toJson(e){return{store_id:e.storeId,company_id:e.companyId,store_name:e.storeName,store_address:e.address,store_phone:e.phone,is_deleted:!e.isActive,huddle_time:e.huddleTime,payment_time:e.paymentTime,allowed_distance:e.allowedDistance}}static toCreateJson(e,r,s,n){return{company_id:e,store_name:r,store_address:s||null,store_phone:n||null,is_deleted:!1}}}class EZ{constructor(){W(this,"dataSource",new NZ)}async getStores(e){try{return{success:!0,data:(await this.dataSource.getStores(e)).map(n=>kZ.fromJson(n))}}catch(r){return console.error("StoreRepository.getStores error:",r),{success:!1,error:r instanceof Error?r.message:"Failed to fetch stores"}}}async createStore(e,r,s,n){try{return await this.dataSource.createStore(e,r,s,n),{success:!0}}catch(a){return console.error("StoreRepository.createStore error:",a),{success:!1,error:a instanceof Error?a.message:"Failed to create store"}}}async deleteStore(e){try{return await this.dataSource.deleteStore(e),{success:!0}}catch(r){return console.error("StoreRepository.deleteStore error:",r),{success:!1,error:r instanceof Error?r.message:"Failed to delete store"}}}}class TZ{static validateStoreName(e){return!e||!e.trim()?{field:"storeName",message:"Store name is required"}:e.trim().length<2?{field:"storeName",message:"Store name must be at least 2 characters"}:e.trim().length>100?{field:"storeName",message:"Store name must not exceed 100 characters"}:null}static validatePhone(e){return!e||!e.trim()?null:/^[0-9\-+() ]+$/.test(e)?e.replace(/[^0-9]/g,"").length<8?{field:"phone",message:"Phone number must contain at least 8 digits"}:null:{field:"phone",message:"Invalid phone number format. Use numbers, spaces, hyphens, or parentheses."}}static validateAddress(e){return!e||!e.trim()?null:e.trim().length>255?{field:"address",message:"Address must not exceed 255 characters"}:null}static validateCreateStore(e,r,s){const n=[],a=this.validateStoreName(e);a&&n.push(a);const i=this.validateAddress(r);i&&n.push(i);const l=this.validatePhone(s);return l&&n.push(l),n}static validateHuddleTime(e){return e===null?null:e<0?{field:"huddleTime",message:"Huddle time cannot be negative"}:e>1440?{field:"huddleTime",message:"Huddle time cannot exceed 24 hours (1440 minutes)"}:null}static validatePaymentTime(e){return e===null?null:e<0?{field:"paymentTime",message:"Payment time cannot be negative"}:e>1440?{field:"paymentTime",message:"Payment time cannot exceed 24 hours (1440 minutes)"}:null}static validateAllowedDistance(e){return e===null?null:e<0?{field:"allowedDistance",message:"Allowed distance cannot be negative"}:e>1e4?{field:"allowedDistance",message:"Allowed distance cannot exceed 10,000 meters (10km)"}:null}}const LZ=t=>{const[e,r]=S.useState([]),[s,n]=S.useState(!0),a=new EZ,i=S.useCallback(async()=>{if(!t)return;n(!0);const d=await a.getStores(t);d.success&&r(d.data||[]),n(!1)},[t]);S.useEffect(()=>{i()},[i]);const l=S.useCallback(async(d,u,h)=>{const f=TZ.validateCreateStore(d,u,h);if(f.length>0)return{success:!1,error:f[0].message};const p=await a.createStore(t,d,u,h);return p.success&&await i(),p},[t,i]),c=S.useCallback(async d=>{const u=await a.deleteStore(d);return u.success&&await i(),u},[i]);return{stores:e,loading:s,create:l,remove:c}},AZ=er(t=>({showAddModal:!1,showDeleteModal:!1,deleteStoreId:"",newName:"",newAddress:"",newPhone:"",setShowAddModal:e=>t({showAddModal:e}),setShowDeleteModal:e=>t({showDeleteModal:e}),setDeleteStoreId:e=>t({deleteStoreId:e}),setNewName:e=>t({newName:e}),setNewAddress:e=>t({newAddress:e}),setNewPhone:e=>t({newPhone:e}),resetForm:()=>t({newName:"",newAddress:"",newPhone:""}),closeAllModals:()=>t({showAddModal:!1,showDeleteModal:!1,deleteStoreId:""})})),DZ="_pageLayout_1owhu_3",MZ="_pageContent_1owhu_12",RZ="_pageHeader_1owhu_19",PZ="_pageHeaderContent_1owhu_26",OZ="_pageTitle_1owhu_30",$Z="_pageSubtitle_1owhu_37",FZ="_addStoreBtn_1owhu_45",BZ="_storesContainer_1owhu_67",VZ="_storesGrid_1owhu_71",HZ="_storeCard_1owhu_78",zZ="_storeCardHeader_1owhu_96",qZ="_storeName_1owhu_100",UZ="_storeDetail_1owhu_107",WZ="_storeActions_1owhu_115",GZ="_storeActionBtn_1owhu_125",JZ="_emptyState_1owhu_152",KZ="_emptyStateIcon_1owhu_160",YZ="_emptyStateTitle_1owhu_167",QZ="_emptyStateText_1owhu_174",ZZ="_modalOverlay_1owhu_181",XZ="_modalContent_1owhu_195",eX="_deleteModal_1owhu_207",tX="_modalHeader_1owhu_211",rX="_modalTitle_1owhu_218",sX="_modalClose_1owhu_225",nX="_modalBody_1owhu_238",aX="_formGroup_1owhu_243",oX="_formLabel_1owhu_247",iX="_required_1owhu_255",lX="_optional_1owhu_259",cX="_formInput_1owhu_266",dX="_modalFooter_1owhu_290",uX="_modalBtnCancel_1owhu_296",hX="_modalBtnSave_1owhu_297",fX="_modalBtnDelete_1owhu_298",mX="_deleteConfirmIcon_1owhu_353",pX="_deleteConfirmTitle_1owhu_365",gX="_deleteConfirmText_1owhu_373",de={pageLayout:DZ,pageContent:MZ,pageHeader:RZ,pageHeaderContent:PZ,pageTitle:OZ,pageSubtitle:$Z,addStoreBtn:FZ,storesContainer:BZ,storesGrid:VZ,storeCard:HZ,storeCardHeader:zZ,storeName:qZ,storeDetail:UZ,storeActions:WZ,storeActionBtn:GZ,delete:"_delete_1owhu_144",emptyState:JZ,emptyStateIcon:KZ,emptyStateTitle:YZ,emptyStateText:QZ,modalOverlay:ZZ,modalContent:XZ,deleteModal:eX,modalHeader:tX,modalTitle:rX,modalClose:sX,modalBody:nX,formGroup:aX,formLabel:oX,required:iX,optional:lX,formInput:cX,modalFooter:dX,modalBtnCancel:uX,modalBtnSave:hX,modalBtnDelete:fX,deleteConfirmIcon:mX,deleteConfirmTitle:pX,deleteConfirmText:gX},_X=()=>{const{currentCompany:t}=ht(),{stores:e,loading:r,create:s,remove:n}=LZ((t==null?void 0:t.company_id)||""),{messageState:a,closeMessage:i,showError:l,showSuccess:c}=Ps(),{showAddModal:d,setShowAddModal:u,showDeleteModal:h,setShowDeleteModal:f,deleteStoreId:p,setDeleteStoreId:_,newName:v,setNewName:x,newAddress:m,setNewAddress:g,newPhone:y,setNewPhone:w,resetForm:b}=AZ(),C=async()=>{const k=await s(v,m||null,y||null);k.success?(u(!1),b(),c({title:"Store Created",message:`Store "${v}" has been successfully created.`,autoCloseDuration:3e3})):l({title:"Failed to Create Store",message:k.error||"An unexpected error occurred while creating the store."})},j=k=>{_(k),f(!0)},I=async()=>{if(p){const k=await n(p);k.success?(f(!1),_(""),c({title:"Store Deleted",message:"The store has been successfully deleted.",autoCloseDuration:3e3})):l({title:"Failed to Delete Store",message:k.error||"An unexpected error occurred while deleting the store."})}};return r?o.jsxs(o.Fragment,{children:[o.jsx(Se,{activeItem:"setting"}),o.jsx("div",{className:de.pageLayout,children:o.jsx("div",{className:de.pageContent,children:o.jsx(Me,{size:"large",fullscreen:!0})})})]}):t?o.jsxs(o.Fragment,{children:[o.jsx(Se,{activeItem:"setting"}),o.jsx("div",{className:de.pageLayout,children:o.jsxs("main",{className:de.pageContent,children:[o.jsxs("div",{className:de.pageHeader,children:[o.jsxs("div",{className:de.pageHeaderContent,children:[o.jsx("h1",{className:de.pageTitle,children:"Store Setting"}),o.jsx("p",{className:de.pageSubtitle,children:"Manage your store configuration and settings"})]}),o.jsxs("button",{className:de.addStoreBtn,onClick:()=>u(!0),children:[o.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M19 13H13V19H11V13H5V11H11V5H13V11H19V13Z"})}),"Add Store"]})]}),o.jsx("div",{className:de.storesContainer,children:e.length===0?o.jsxs("div",{className:de.emptyState,children:[o.jsxs("svg",{className:de.emptyStateIcon,width:"120",height:"120",viewBox:"0 0 120 120",fill:"none",children:[o.jsx("circle",{cx:"60",cy:"60",r:"50",fill:"#F0F6FF"}),o.jsx("rect",{x:"35",y:"45",width:"50",height:"45",rx:"2",fill:"white",stroke:"#0064FF",strokeWidth:"2"}),o.jsx("path",{d:"M30 45 L35 40 L85 40 L90 45 Z",fill:"#0064FF"}),o.jsx("rect",{x:"52",y:"65",width:"16",height:"25",rx:"1",fill:"#E9ECEF"}),o.jsx("rect",{x:"40",y:"52",width:"10",height:"8",rx:"1",fill:"#E9ECEF"}),o.jsx("rect",{x:"70",y:"52",width:"10",height:"8",rx:"1",fill:"#E9ECEF"}),o.jsx("circle",{cx:"60",cy:"25",r:"12",fill:"#0064FF"}),o.jsx("path",{d:"M56 25 L58 27 L64 21",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),o.jsx("h3",{className:de.emptyStateTitle,children:"No Stores Yet"}),o.jsx("p",{className:de.emptyStateText,children:'Click "Add Store" to create your first store location.'})]}):o.jsx("div",{className:de.storesGrid,children:e.map(k=>o.jsxs("div",{className:de.storeCard,children:[o.jsx("div",{className:de.storeActions,children:o.jsx("button",{className:`${de.storeActionBtn} ${de.delete}`,onClick:()=>j(k.storeId),title:"Delete",children:o.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"})})})}),o.jsxs("div",{className:de.storeCardHeader,children:[o.jsx("h3",{className:de.storeName,children:k.storeName}),k.address&&o.jsxs("div",{className:de.storeDetail,children:["Address: ",k.address]}),k.phone&&o.jsxs("div",{className:de.storeDetail,children:["Phone: ",k.phone]}),k.huddleTime&&o.jsxs("div",{className:de.storeDetail,children:["Huddle Time: ",k.huddleTime," minutes"]}),k.paymentTime&&o.jsxs("div",{className:de.storeDetail,children:["Payment Time: ",k.paymentTime," minutes"]}),k.allowedDistance&&o.jsxs("div",{className:de.storeDetail,children:["Allowed Distance: ",k.allowedDistance," meters"]})]})]},k.storeId))})})]})}),d&&o.jsx("div",{className:de.modalOverlay,onClick:()=>u(!1),children:o.jsxs("div",{className:de.modalContent,onClick:k=>k.stopPropagation(),children:[o.jsxs("div",{className:de.modalHeader,children:[o.jsx("h2",{className:de.modalTitle,children:"Add New Store"}),o.jsx("button",{className:de.modalClose,onClick:()=>u(!1),children:o.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M19 6.41L17.59 5L12 10.59L6.41 5L5 6.41L10.59 12L5 17.59L6.41 19L12 13.41L17.59 19L19 17.59L13.41 12L19 6.41Z"})})})]}),o.jsxs("div",{className:de.modalBody,children:[o.jsxs("div",{className:de.formGroup,children:[o.jsxs("label",{className:de.formLabel,children:["Store Name ",o.jsx("span",{className:de.required,children:"*"})]}),o.jsx("input",{type:"text",className:de.formInput,placeholder:"Enter store name",value:v,onChange:k=>x(k.target.value)})]}),o.jsxs("div",{className:de.formGroup,children:[o.jsxs("label",{className:de.formLabel,children:["Store Address ",o.jsx("span",{className:de.optional,children:"(Optional)"})]}),o.jsx("input",{type:"text",className:de.formInput,placeholder:"Enter store address",value:m,onChange:k=>g(k.target.value)})]}),o.jsxs("div",{className:de.formGroup,children:[o.jsxs("label",{className:de.formLabel,children:["Store Phone ",o.jsx("span",{className:de.optional,children:"(Optional)"})]}),o.jsx("input",{type:"tel",className:de.formInput,placeholder:"Enter phone number",value:y,onChange:k=>w(k.target.value)})]})]}),o.jsxs("div",{className:de.modalFooter,children:[o.jsx("button",{className:de.modalBtnCancel,onClick:()=>u(!1),children:"Cancel"}),o.jsx("button",{className:de.modalBtnSave,onClick:C,disabled:!v.trim(),children:"Create Store"})]})]})}),h&&o.jsx("div",{className:de.modalOverlay,onClick:()=>f(!1),children:o.jsxs("div",{className:`${de.modalContent} ${de.deleteModal}`,onClick:k=>k.stopPropagation(),children:[o.jsxs("div",{className:de.modalHeader,children:[o.jsx("h2",{className:de.modalTitle,children:"Delete Store"}),o.jsx("button",{className:de.modalClose,onClick:()=>f(!1),children:o.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M19 6.41L17.59 5L12 10.59L6.41 5L5 6.41L10.59 12L5 17.59L6.41 19L12 13.41L17.59 19L19 17.59L13.41 12L19 6.41Z"})})})]}),o.jsxs("div",{className:de.modalBody,children:[o.jsx("div",{className:de.deleteConfirmIcon,children:o.jsx("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"})})}),o.jsx("p",{className:de.deleteConfirmTitle,children:"Are you sure you want to delete this store?"}),o.jsx("p",{className:de.deleteConfirmText,children:"This action cannot be undone. The store will be permanently removed from your system."})]}),o.jsxs("div",{className:de.modalFooter,children:[o.jsx("button",{className:de.modalBtnCancel,onClick:()=>f(!1),children:"Cancel"}),o.jsx("button",{className:de.modalBtnDelete,onClick:I,children:"Yes, Delete Store"})]})]})}),o.jsx($e,{variant:a.variant,title:a.title,message:a.message,isOpen:a.isOpen,onClose:i,confirmText:a.confirmText,autoCloseDuration:a.autoCloseDuration,closeOnBackdropClick:a.closeOnBackdropClick})]}):o.jsxs(o.Fragment,{children:[o.jsx(Se,{activeItem:"setting"}),o.jsx("div",{className:de.pageLayout,children:o.jsx("div",{className:de.pageContent,children:o.jsx("p",{children:"Select a company to manage stores"})})})]})},yX="_container_pbqg3_3",vX="_comingSoonWrapper_pbqg3_12",xX="_starIcon_pbqg3_29",bX="_title_pbqg3_48",wX="_description_pbqg3_56",Ko={container:yX,comingSoonWrapper:vX,starIcon:xX,title:bX,description:wX},SX=()=>o.jsxs(o.Fragment,{children:[o.jsx(Se,{activeItem:"product"}),o.jsx("div",{className:Ko.container,children:o.jsxs("div",{className:Ko.comingSoonWrapper,children:[o.jsx("div",{className:Ko.starIcon,children:o.jsx("svg",{width:"120",height:"120",viewBox:"0 0 24 24",fill:"currentColor",children:o.jsx("path",{d:"M12,17.27L18.18,21L16.54,13.97L22,9.24L14.81,8.62L12,2L9.19,8.62L2,9.24L7.45,13.97L5.82,21L12,17.27Z"})})}),o.jsx("h1",{className:Ko.title,children:"Tracking Coming Soon"}),o.jsx("p",{className:Ko.description,children:"The tracking feature is currently under development."})]})})]}),jX="_filterContainer_m5uqg_3",CX="_filterHeader_m5uqg_13",NX="_filterTitle_m5uqg_21",IX="_filterContent_m5uqg_35",kX="_filterRow_m5uqg_39",EX="_filterField_m5uqg_47",TX="_filterLabel_m5uqg_55",LX="_dateInput_m5uqg_63",AX="_filterActions_m5uqg_86",Wr={filterContainer:jX,filterHeader:CX,filterTitle:NX,filterContent:IX,filterRow:kX,filterField:EX,filterLabel:TX,dateInput:LX,filterActions:AX},ly=()=>{const t=new Date,e=new Date(t.getFullYear(),t.getMonth(),1);return re.toDateOnly(e)},cy=()=>{const t=new Date,e=new Date(t.getFullYear(),t.getMonth()+1,0);return re.toDateOnly(e)},DX=({onSearch:t,onClear:e})=>{const{currentCompany:r}=ht(),s=(r==null?void 0:r.stores)||[],{messageState:n,closeMessage:a,showWarning:i}=Ps(),[l,c]=S.useState(null),[d,u]=S.useState(ly()),[h,f]=S.useState(cy()),p=()=>{const v=sf.validateDateRange(d,h);if(v){i({title:"Invalid Date Range",message:v.message,confirmText:"OK"});return}if(l){const x=sf.validateStoreId(l);if(x){i({title:"Invalid Store",message:x.message,confirmText:"OK"});return}}t({storeId:l,fromDate:d,toDate:h})},_=()=>{c(null),u(ly()),f(cy()),e()};return o.jsxs("div",{className:Wr.filterContainer,children:[o.jsx("div",{className:Wr.filterHeader,children:o.jsxs("div",{className:Wr.filterTitle,children:[o.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:o.jsx("polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"})}),o.jsx("span",{children:"Search Transactions"})]})}),o.jsxs("div",{className:Wr.filterContent,children:[o.jsxs("div",{className:Wr.filterRow,children:[o.jsxs("div",{className:Wr.filterField,children:[o.jsx("label",{className:Wr.filterLabel,children:"STORE"}),o.jsx(ds,{stores:s,selectedStoreId:l,onStoreSelect:c,showAllStoresOption:!0,width:"100%"})]}),o.jsxs("div",{className:Wr.filterField,children:[o.jsx("label",{className:Wr.filterLabel,children:"FROM DATE"}),o.jsx("input",{type:"date",className:Wr.dateInput,value:d,onChange:v=>u(v.target.value)})]}),o.jsxs("div",{className:Wr.filterField,children:[o.jsx("label",{className:Wr.filterLabel,children:"TO DATE"}),o.jsx("input",{type:"date",className:Wr.dateInput,value:h,onChange:v=>f(v.target.value)})]})]}),o.jsxs("div",{className:Wr.filterActions,children:[o.jsx(Ne,{onClick:_,variant:"secondary",children:"Clear All"}),o.jsxs(Ne,{onClick:p,variant:"primary",children:[o.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("circle",{cx:"11",cy:"11",r:"8"}),o.jsx("path",{d:"m21 21-4.35-4.35"})]}),"Search"]})]})]}),o.jsx($e,{variant:n.variant,title:n.title,message:n.message,isOpen:n.isOpen,onClose:a,confirmText:n.confirmText||"OK"})]})},MX="_pageLayout_at10i_4",RX="_container_at10i_13",PX="_pageHeader_at10i_19",OX="_title_at10i_23",$X="_subtitle_at10i_30",FX="_contentCard_at10i_37",BX="_emptyState_at10i_46",VX="_loadingState_at10i_47",HX="_emptyIcon_at10i_52",zX="_emptyTitle_at10i_69",qX="_emptyText_at10i_76",UX="_tableWrapper_at10i_87",WX="_tableHeader_at10i_91",GX="_tableTitle_at10i_95",JX="_tableSubtitle_at10i_102",KX="_transactionTable_at10i_109",YX="_journalHeader_at10i_147",QX="_journalDate_at10i_160",ZX="_journalTime_at10i_166",XX="_storeBadge_at10i_173",eee="_lineRow_at10i_186",tee="_alternate_at10i_191",ree="_accountCell_at10i_205",see="_lineDescription_at10i_214",nee="_totalRow_at10i_220",aee="_totalLabel_at10i_233",oee="_amountCell_at10i_240",iee="_debitAmount_at10i_246",lee="_creditAmount_at10i_250",Oe={pageLayout:MX,container:RX,pageHeader:PX,title:OX,subtitle:$X,contentCard:FX,emptyState:BX,loadingState:VX,emptyIcon:HX,emptyTitle:zX,emptyText:qX,tableWrapper:UX,tableHeader:WX,tableTitle:GX,tableSubtitle:JX,transactionTable:KX,journalHeader:YX,journalDate:QX,journalTime:ZX,storeBadge:XX,lineRow:eee,alternate:tee,accountCell:ree,lineDescription:see,totalRow:nee,totalLabel:aee,amountCell:oee,debitAmount:iee,creditAmount:lee},dy=()=>{const{currentCompany:t}=ht(),e=(t==null?void 0:t.company_id)||"",{messageState:r,closeMessage:s,showError:n}=Ps(),{journalEntries:a,loading:i,error:l,hasSearched:c,searchJournalEntries:d,clearSearch:u}=Hx(e);S.useEffect(()=>{l&&n({title:"Failed to Load Transactions",message:l,confirmText:"OK"})},[l,n]);const h=g=>{d(g.storeId,g.fromDate||null,g.toDate||null)},f=()=>{u()},p=()=>o.jsxs("div",{className:Oe.emptyState,children:[o.jsx("div",{className:Oe.emptyIcon,children:o.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("circle",{cx:"11",cy:"11",r:"8"}),o.jsx("path",{d:"m21 21-4.35-4.35"})]})}),o.jsx("h3",{className:Oe.emptyTitle,children:"Search Transactions"}),o.jsx("p",{className:Oe.emptyText,children:"Select filters and click Search to view transaction history"})]}),_=()=>o.jsx("div",{className:Oe.loadingState,children:o.jsx(Me,{size:"large"})}),v=()=>o.jsxs("div",{className:Oe.emptyState,children:[o.jsx("div",{className:Oe.emptyIcon,children:o.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[o.jsx("path",{d:"M3 3v18h18"}),o.jsx("path",{d:"M18 17V9"}),o.jsx("path",{d:"M13 17V5"}),o.jsx("path",{d:"M8 17v-3"})]})}),o.jsx("h3",{className:Oe.emptyTitle,children:"No Transactions Found"}),o.jsx("p",{className:Oe.emptyText,children:"No transactions found for the selected period. Try adjusting your search filters."})]}),x=g=>o.jsxs(Kr.Fragment,{children:[o.jsxs("tr",{className:Oe.journalHeader,children:[o.jsxs("td",{children:[o.jsx("div",{className:Oe.journalDate,children:g.formattedDate}),o.jsx("div",{className:Oe.journalTime,children:g.formattedTime})]}),o.jsx("td",{children:g.description||"-"}),o.jsx("td",{children:g.storeName?o.jsx("span",{className:Oe.storeBadge,children:g.storeName}):"All Stores"}),o.jsx("td",{children:g.createdByName}),o.jsx("td",{className:`${Oe.amountCell} ${Oe.debitAmount}`,children:g.formatCurrency(g.totalDebit)}),o.jsx("td",{className:`${Oe.amountCell} ${Oe.creditAmount}`,children:g.formatCurrency(g.totalCredit)})]}),g.sortedLines.map((y,w)=>{const b=w%2===1?Oe.alternate:"";let C=y.description||y.accountName;return y.displayCounterparty&&y.displayLocation?C=`${C}  ${y.displayCounterparty}  ${y.displayLocation}`:y.displayCounterparty?C=`${C}  ${y.displayCounterparty}`:y.displayLocation&&(C=`${C}  ${y.displayLocation}`),o.jsxs("tr",{className:`${Oe.lineRow} ${b}`,children:[o.jsx("td",{className:Oe.accountCell,children:o.jsx("strong",{children:y.accountName})}),o.jsx("td",{className:Oe.lineDescription,children:C}),o.jsx("td",{children:"-"}),o.jsx("td",{children:"-"}),o.jsx("td",{className:`${Oe.amountCell} ${Oe.debitAmount}`,children:y.debit>0?y.debit.toLocaleString("en-US"):"-"}),o.jsx("td",{className:`${Oe.amountCell} ${Oe.creditAmount}`,children:y.credit>0?y.credit.toLocaleString("en-US"):"-"})]},y.lineId)}),o.jsxs("tr",{className:Oe.totalRow,children:[o.jsx("td",{colSpan:4,className:Oe.totalLabel,children:"Total:"}),o.jsx("td",{className:`${Oe.amountCell} ${Oe.debitAmount}`,children:g.totalDebit>0?g.totalDebit.toLocaleString("en-US"):"-"}),o.jsx("td",{className:`${Oe.amountCell} ${Oe.creditAmount}`,children:g.totalCredit>0?g.totalCredit.toLocaleString("en-US"):"-"})]})]},g.journalId),m=()=>o.jsxs("div",{className:Oe.tableWrapper,children:[o.jsxs("div",{className:Oe.tableHeader,children:[o.jsx("h3",{className:Oe.tableTitle,children:"Transaction History"}),o.jsxs("p",{className:Oe.tableSubtitle,children:["Found ",a.length," journal",a.length!==1?"s":""]})]}),o.jsxs("table",{className:Oe.transactionTable,children:[o.jsx("thead",{children:o.jsxs("tr",{children:[o.jsx("th",{style:{width:"160px"},children:"DATE & TIME"}),o.jsx("th",{style:{width:"200px"},children:"DESCRIPTION"}),o.jsx("th",{style:{width:"120px"},children:"STORE"}),o.jsx("th",{style:{width:"120px"},children:"CREATED BY"}),o.jsx("th",{style:{width:"120px"},children:"DEBIT"}),o.jsx("th",{style:{width:"120px"},children:"CREDIT"})]})}),o.jsx("tbody",{children:a.map(x)})]})]});return o.jsxs(o.Fragment,{children:[o.jsx(Se,{activeItem:"finance"}),o.jsx("div",{className:Oe.pageLayout,children:o.jsxs("div",{className:Oe.container,children:[o.jsxs("div",{className:Oe.pageHeader,children:[o.jsx("h1",{className:Oe.title,children:"Transaction History"}),o.jsx("p",{className:Oe.subtitle,children:"View all transactions"})]}),o.jsx(DX,{onSearch:h,onClear:f}),o.jsxs("div",{className:Oe.contentCard,children:[i&&_(),!i&&!c&&p(),!i&&c&&a.length===0&&v(),!i&&c&&a.length>0&&m()]})]})}),o.jsx($e,{variant:r.variant,title:r.title,message:r.message,isOpen:r.isOpen,onClose:s,confirmText:r.confirmText||"OK"})]})},cee=()=>o.jsxs(mS,{children:[o.jsx(mt,{path:"/login",element:o.jsx(Dg,{children:o.jsx(iI,{})})}),o.jsx(mt,{path:"/register",element:o.jsx(Dg,{children:o.jsx(NI,{})})}),o.jsx(mt,{path:"/dashboard",element:o.jsx($t,{children:o.jsx(jT,{})})}),o.jsx(mt,{path:"/product/inventory",element:o.jsx($t,{requiredFeatureId:"ced86713-e046-457a-b3c9-775304b31557",children:o.jsx(dz,{})})}),o.jsx(mt,{path:"/product/invoice",element:o.jsx($t,{requiredFeatureId:"b5affc71-32e5-481b-932a-77a743253ddc",children:o.jsx(tU,{})})}),o.jsx(mt,{path:"/product/create-invoice",element:o.jsx($t,{requiredFeatureId:"5f622ea0-ede7-4b24-a203-92d5c9f31a6b",children:o.jsx(GU,{})})}),o.jsx(mt,{path:"/product/order",element:o.jsx($t,{requiredFeatureId:"5f622ea0-ede7-4b24-a203-92d5c9f31a6b",children:o.jsx(QY,{})})}),o.jsx(mt,{path:"/product/product-receive",element:o.jsx($t,{requiredFeatureId:"ced86713-e046-457a-b3c9-775304b31557",children:o.jsx(CZ,{})})}),o.jsx(mt,{path:"/product/tracking",element:o.jsx($t,{requiredFeatureId:"98cc610a-9dff-4276-91f2-d900cdf00ba7",children:o.jsx(SX,{})})}),o.jsx(mt,{path:"/finance/journal-input",element:o.jsx($t,{requiredFeatureId:"58fddce6-6b45-4735-8c59-9d80ccc1928e",children:o.jsx(PJ,{})})}),o.jsx(mt,{path:"/finance/balance-sheet",element:o.jsx($t,{requiredFeatureId:"bdd46e64-5a59-4001-b70f-b9f4b23da33d",children:o.jsx(TD,{})})}),o.jsx(mt,{path:"/finance/income-statement",element:o.jsx($t,{requiredFeatureId:"247a7896-ea5c-49b7-afec-94b500093cd4",children:o.jsx(OF,{})})}),o.jsx(mt,{path:"/finance/cash-ending",element:o.jsx($t,{requiredFeatureId:"582171a8-6a92-42e7-99ed-f8233169a652",children:o.jsx(F3,{})})}),o.jsx(mt,{path:"/finance/transaction-history",element:o.jsx($t,{requiredFeatureId:"7e1fd11a-f632-427d-aefc-8b3dd6734faa",children:o.jsx(dy,{})})}),o.jsx(mt,{path:"/transactions",element:o.jsx($t,{requiredFeatureId:"7e1fd11a-f632-427d-aefc-8b3dd6734faa",children:o.jsx(dy,{})})}),o.jsx(mt,{path:"/employee/employee-setting",element:o.jsx($t,{requiredFeatureId:"4a0c90b6-7099-4d76-88b2-783302e1248f",children:o.jsx(d9,{})})}),o.jsx(mt,{path:"/employee/schedule",element:o.jsx($t,{requiredFeatureId:"eaf85f06-b708-4c29-b35f-d39d234d1b60",children:o.jsx(yP,{})})}),o.jsx(mt,{path:"/employee/schedule/:storeId",element:o.jsx($t,{requiredFeatureId:"eaf85f06-b708-4c29-b35f-d39d234d1b60",children:o.jsx(OO,{})})}),o.jsx(mt,{path:"/employee/salary",element:o.jsx($t,{requiredFeatureId:"4a0c90b6-7099-4d76-88b2-783302e1248f",children:o.jsx(F8,{})})}),o.jsx(mt,{path:"/marketing/marketing-plan",element:o.jsx($t,{requiredFeatureId:"069fc24c-915b-43a0-8c27-6872badfc4a1",children:o.jsx(JJ,{})})}),o.jsx(mt,{path:"/settings/account-mapping",element:o.jsx($t,{requiredFeatureId:"6e527ba2-9421-4243-a0f9-2497f5ed9772",children:o.jsx(bA,{})})}),o.jsx(mt,{path:"/settings/counterparty",element:o.jsx($t,{requiredFeatureId:"57b2972a-d2d4-478e-ab10-83e1f429b94b",children:o.jsx(ZM,{})})}),o.jsx(mt,{path:"/settings/currency",element:o.jsx($t,{requiredFeatureId:"95310d59-24ae-4d8b-9474-c536ed8b0584",children:o.jsx(NR,{})})}),o.jsx(mt,{path:"/settings/store-setting",element:o.jsx($t,{requiredFeatureId:"7b767def-41bb-420c-a548-807e4336e738",children:o.jsx(_X,{})})}),o.jsx(mt,{path:"/",element:o.jsx(Wi,{to:"/login",replace:!0})}),o.jsx(mt,{path:"*",element:o.jsx(Wi,{to:"/login",replace:!0})})]}),dee=()=>o.jsx(WC,{children:o.jsx(FC,{children:o.jsx(cee,{})})});Vu.createRoot(document.getElementById("root")).render(o.jsx(Kr.StrictMode,{children:o.jsx(_S,{children:o.jsx(dee,{})})}));export{fee as c,Kx as g};
